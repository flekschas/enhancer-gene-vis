(this["webpackJsonpenhancer-promoter-vis"]=this["webpackJsonpenhancer-promoter-vis"]||[]).push([[0],{210:function(t,e,i){t.exports=i(323)},304:function(t,e,i){},317:function(t,e,i){},318:function(t,e,i){},320:function(t,e,i){},323:function(t,e,i){"use strict";i.r(e);var o=i(63),a=i(0),n=i.n(a),r=i(15),s=i.n(r),l=i(12),c=i(96),h=i(20),u=i(192),d=i(380),p=i(386),f=i(369),m=i(366),g=Object(m.a)((function(t){return{backdrop:{zIndex:t.zIndex.drawer+1,color:"#bbb",backgroundColor:"#fff"}}})),v=function(){var t=g();return n.a.createElement("div",{className:"full-wh"},n.a.createElement(p.a,{className:t.backdrop,open:!0},n.a.createElement(f.a,{color:"inherit"})))},b=(i(304),function(){return n.a.createElement("div",{className:"full-wh app-error"},n.a.createElement("span",null,"Failed to initialize!"))}),y=i(51),x=i.n(y),w=i(117),k=i(19),C=i(374),S=i(381),O=i(377),_=i(373),T=i(376),E=i(389),M=i(388),A=i(378),R=i(327),I=i(370),j=i(372),P=i(387),F=i(384),D=i(390),N=i(379),z=i(375),L=i(328),H=i(189),G=i.n(H),B=i(73),W=i(382),V=i(383),X=i(391),U=i(118),Y=i(153),J=i.n(Y);var K=Object(m.a)((function(t){return{inputRoot:{background:"white !important",borderTopLeftRadius:0,borderTopRightRadius:0,"&::before":{borderBottomWidth:0,boxShadow:"0 1px 0 0 rgba(0, 0, 0, 0)",transition:"boxShadow 0.2s ease"},"&:hover::before":{borderBottomWidth:0,boxShadow:"0 1px 0 0 rgba(0, 0, 0, 1)"}},focused:{boxShadow:"0 1px 0 0 rgba(0, 0, 0, 1)"},input:{height:35,padding:"6px 0 6px"},textFieldRoot:{"& .MuiFormLabel-root":{color:"black",fontWeight:"bold",transform:"translate(12px, 24px) scale(1.25)"},"& .MuiInputLabel-shrink":{fontWeight:"normal"}}}})),Q=function(){var t=Object(w.a)(x.a.mark((function t(e,i){var o,a,n;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!==typeof e){t.next=5;break}return t.next=3,fetch("".concat(e,"&ac=").concat(i||""));case 3:return o=t.sent,t.abrupt("return",o.json());case 5:return t.next=7,fetch("".concat(e.url,"&ac=").concat(i||""));case 7:return a=t.sent,t.next=10,a.json();case 10:return n=t.sent,t.abrupt("return",n.map((function(t){return t.type=e.type,t})));case 12:case"end":return t.stop()}}),t)})));return function(e,i){return t.apply(this,arguments)}}();function q(t){return n.a.createElement(U.a,Object.assign({viewBox:"0 0 16 16"},t),n.a.createElement("path",{d:"M5.03 14.378A7.33 7.33 0 003.423 16h2.42a7.762 7.762 0 011.281-.774 13.241 13.241 0 01-1.863-1.016c-.078.054-.156.11-.233.168zM5.766 0l.219.174a8.754 8.754 0 001.636.92l.024.008c.797.24 1.507.627 2.023.933.325.18.674.4 1.024.66 1.825 1.363 2.79 3.22 2.79 5.367 0 2.062-.962 3.89-2.782 5.286-.061.048-.125.094-.186.139a10.45 10.45 0 00-1.895-.955 8.17 8.17 0 001.69-1.162h-3.92a6.191 6.191 0 01-1.199-1.15h6.093a4.054 4.054 0 00.603-1.747H3.839c.072.656.307 1.239.636 1.747h.011c.282.438.628.822.991 1.15H5.47l.74.584c.831.588 1.573.893 1.636.92a9.358 9.358 0 012.847 1.504A7.38 7.38 0 0112.3 16H9.879l-.759-.5a7.876 7.876 0 00-1.256-.594 11.833 11.833 0 01-2.07-1.04l.017-.009c-1.567-.999-3.571-2.851-3.571-5.794 0-2.149.964-4.005 2.79-5.367.076-.058.154-.113.231-.167.495.32 1.143.698 1.863 1.015a7.677 7.677 0 00-1.296.786c-.043.032-.083.066-.125.098h3.318c.535.336.999.727 1.364 1.149H4.598a4.215 4.215 0 00-.721 1.748h7.97l-.038-.195a3.527 3.527 0 00-.306-.904 4.417 4.417 0 00-.378-.65l-.01-.007a5.793 5.793 0 00-1.081-1.13l-.14-.109a7.236 7.236 0 00-.722-.48l-.031-.02a7.942 7.942 0 00-1.276-.607 10.278 10.278 0 01-1.257-.57C5.728 2.218 4.31 1.364 3.281 0h2.486zm6.267 0a7.808 7.808 0 01-1.743 1.707A10.443 10.443 0 008.396.752 8.592 8.592 0 009.592 0h2.442z"}))}function Z(t){return n.a.createElement(I.a,{key:t.option.geneName,container:!0,direction:"row",alignItems:"center"},n.a.createElement(q,{fontSize:"small"}),n.a.createElement("span",null,t.option.geneName))}function $(t){return n.a.createElement(I.a,{key:t.option.geneName,container:!0,direction:"row",alignItems:"center"},n.a.createElement(J.a,{fontSize:"small"}),n.a.createElement("span",null,t.option.geneName))}function tt(t){return"gene"===t.option.type?n.a.createElement(Z,{option:t.option}):"variant"===t.option.type?n.a.createElement($,{option:t.option}):n.a.createElement("div",null,t.option.geneName)}function et(t){var e=Object(a.useState)(!1),i=Object(l.a)(e,2),o=i[0],r=i[1],s=Object(a.useState)([]),c=Object(l.a)(s,2),h=c[0],u=c[1],d=Object(a.useState)(t.inputValue),p=Object(l.a)(d,2),m=p[0],g=p[1],v=function(t,e){var i=Object(a.useState)(t),o=Object(l.a)(i,2),n=o[0],r=o[1];return Object(a.useEffect)((function(){var i=setTimeout((function(){r(t)}),e);return function(){clearTimeout(i)}}),[t,e]),n}(m,250),b=o&&0===h.length,y=K(),x=Object(B.a)({},y);delete x.textFieldRoot,Object(a.useEffect)((function(){var e=!0;if(o){u([]);var i=Array.isArray(t.searchUrl)?t.searchUrl.map((function(t){return Q(t,v)})):Q(t.searchUrl,v);return Promise.all(i).then((function(t){e&&u(t.flat())})),function(){e=!1}}}),[t.searchUrl,o,v]),Object(a.useEffect)((function(){o||u([])}),[o]);var w=t.multiple&&!Array.isArray(t.value)?[t.value]:t.value,k=w&&0===h.length?w:h;return k=Array.isArray(k)?k:[k],n.a.createElement(V.a,{classes:t.larger?x:{},multiple:t.multiple,onChange:function(e,i){t.onChange(i)},value:w,onInputChange:function(t,e){t&&g(e)},fullWidth:t.fullWidth,style:{width:t.fullWidth?"auto":t.width},open:o,onOpen:function(){r(!0)},onClose:function(){r(!1)},getOptionSelected:function(t,e){return t.geneName===e.geneName},getOptionLabel:function(t){return t?t.geneName:""},options:k,loading:b,renderInput:function(e){return n.a.createElement(W.a,Object.assign({},e,{className:t.larger?y.textFieldRoot:"",id:t.id,label:t.label,variant:t.variant,size:t.size,InputProps:Object(B.a)(Object(B.a)({},e.InputProps),{},{endAdornment:n.a.createElement(n.a.Fragment,null,b?n.a.createElement(f.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment)})}))},renderOption:function(t){return n.a.createElement(tt,{option:t})},renderTags:function(t,e){return t.map((function(t,i){return n.a.createElement(X.a,Object.assign({icon:"gene"===t.type?n.a.createElement(q,null):n.a.createElement(J.a,null),key:t.geneName,label:t.geneName},e({index:i})))}))}})}et.defaultProps={fullWidth:!0,id:"",label:"",multiple:!1,onChange:h.c,size:"small",value:null,variant:"outlined",width:"10rem"};var it=i(69),ot=i(125),at=i.n(ot),nt=function(t,e){return t[0]<=e[0]&&t[1]>=e[1]},rt=function(t,e){var i=Math.max(2,Math.ceil(Math.sqrt(e.length))),o=new Float32Array(4*Math.pow(i,2));return e.forEach((function(t,e){o[4*e]=t[0],o[4*e+1]=t[1],o[4*e+2]=t[2],o[4*e+3]=t[3]})),[t.Texture.fromBuffer(o,i,i),i]},st=function(t,e,i,o,a){for(var n=i-e,r=Math.sign(n),s=Math.abs(n),l=2*a,c=Math.ceil(s/l),h=0;h<c;h++)t.moveTo(e+h*l*r,o),t.lineTo(e+(h*l+a)*r,o)},lt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.c;return e(at.a.parse(window.location.search)[t])},ct=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h.c,o=at.a.parse(window.location.search),a=at.a.stringify(Object(B.a)(Object(B.a)({},o),{},Object(it.a)({},t,i(e))),{strict:!1}),n="".concat(window.location.origin).concat(window.location.pathname,"?").concat(a);window.history.pushState({path:n},"",n)},ht=function(t,e){var i;if(t.indexOf&&t.indexOf(":")>=0){var o=t.split(":"),a=Object(l.a)(o,2),n=a[0],r=a[1];i=e.chrPositions[n].pos+ +r}else i=+t;return i};var ut=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=i.encoder,n=i.decoder,r=Object(a.useState)(void 0===lt(t,n)?e:lt(t,n)),s=Object(l.a)(r,2),c=s[0],h=s[1],u=Object(a.useCallback)((function(e){h(e),ct(t,e,o)}),[t,o]);return ct(t,c,o),[c,u]};function dt(t){var e=Object(a.useRef)();return Object(a.useEffect)((function(){e.current=t})),e.current}var pt=["#c76526","#dca237","#eee462","#469b76","#3170ad","#6fb2e4","#000000","#999999"],ft=["#a65420","#b7872e","#9f9841","#3a8162","#295d90","#4a7798","#000000","#666666"],mt=["#f6e5db","#f9f0de","#fcfbe5","#e0eee8","#dde7f1","#e7f2fb","#d5d5d5","#ffffff"],gt="https://higlass.io/api/v1/suggest/?d=OHJakQICQD6gTD7skx4EWA",vt="https://resgen.io/api/v1/suggest/?d=VF5-RDXWTxidGMJU7FeaxA",bt={categoryField:10,axisShowGroupSeparator:!0,axisNoGroupColor:!1,groups:[{label:"Mononuclear Phagocytes",categories:["THP1_LPS_4hr-Engreitz","THP_pmaLPS_ATAC_6h","CD14-positive_monocyte_treated_with_LPS_4h-Novakovic2016","CD14-positive_monocyte_treated_with_BG_1h-Novakovic2016","CD14-positive_monocyte_treated_with_RPMI_d6-Novakovic2016","THP1-Engreitz","THP_pmaLPS_ATAC_96h","CD14-positive_monocyte_treated_with_BG_d1-Novakovic2016","THP_pmaLPS_ATAC_72h","THP-1_monocyte-VanBortle2017","CD14-positive_monocyte_treated_with_LPS_d1-Novakovic2016","CD14-positive_monocyte-ENCODE","THP_pmaLPS_ATAC_2h","dendritic_cell_treated_with_Lipopolysaccharide_0_ng-mL_for_0_hour-Garber2017","CD14-positive_monocyte_treated_with_RPMI_1h-Novakovic2016","U937_LPS_4hr-Engreitz","CD14-positive_monocyte-Novakovic2016","dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_6_hour-Garber2017","CD14-positive_monocyte_treated_with_BG_4h-Novakovic2016","THP_pmaLPS_ATAC_0h","HAP1","THP-1_macrophage-VanBortle2017","dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_1_hour-Garber2017","U937-Engreitz","CD14-positive_monocyte_treated_with_RPMI_d1-Novakovic2016","CD14-positive_monocyte_treated_with_RPMI_4h-Novakovic2016","CD14-positive_monocyte_treated_with_LPS_d6-Novakovic2016","CD14-positive_monocyte_treated_with_LPS_1h-Novakovic2016","THP_pmaLPS_ATAC_24h","THP_pmaLPS_ATAC_1h","dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_2_hour-Garber2017","CD14-positive_monocyte_treated_with_BG_d6-Novakovic2016","dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_30_minute-Garber2017","THP_pmaLPS_ATAC_120h","dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_4_hour-Garber2017","THP_pmaLPS_ATAC_48h","CD14-positive_monocytes-Roadmap","THP_pmaLPS_ATAC_12h"]},{label:"B Cells",categories:["Karpas-422-ENCODE","BJAB-Engreitz","BJAB_anti-IgM_anti-CD40_4hr-Engreitz","B_cell-ENCODE","OCI-LY7-ENCODE","GM12878-Roadmap","MM.1S-ENCODE","CD19-positive_B_cell-Roadmap","CD8-positive_alpha-beta_T_cell-ENCODE"]},{label:"T Cells",categories:["Jurkat_anti-CD3_PMA_4hr-Engreitz","Jurkat-Engreitz","CD3-positive_T_cell-Roadmap","CD4-positive_helper_T_cell-ENCODE","CD8-positive_alpha-beta_T_cell-Corces2016","thymus_fetal-Roadmap","CD4-positive_helper_T_cell-Corces2016","T-cell-ENCODE"]},{label:"Other haematopoietic cells",categories:["spleen-ENCODE","K562-Roadmap","CD56-positive_natural_killer_cells-Roadmap","erythroblast-Corces2016","CD34-positive_mobilized-Roadmap","megakaryocyte-erythroid_progenitor-Corces2016","natural_killer_cell-Corces2016","IMR90-Roadmap"]},{label:"Fibroblasts",categories:["foreskin_fibroblast-Roadmap","fibroblast_of_dermis-Roadmap","fibroblast_of_arm-ENCODE","astrocyte-ENCODE","fibroblast_of_lung-Roadmap"]},{label:"Epithelial",categories:["small_intestine_fetal-Roadmap","epithelial_cell_of_prostate-ENCODE","HCT116-ENCODE","MCF-7-ENCODE","adrenal_gland_fetal-ENCODE","H7","keratinocyte-Roadmap","MCF10A-Ji2017","pancreas-Roadmap","mammary_epithelial_cell-Roadmap","stomach-Roadmap","LoVo","A549_treated_with_ethanol_0.02_percent_for_1_hour-Roadmap","PC-9-ENCODE","H1-hESC-Roadmap","thyroid_gland-ENCODE","HT29","MDA-MB-231","iPS_DF_19.11_Cell_Line-Roadmap","large_intestine_fetal-Roadmap","Panc1-ENCODE","adrenal_gland-ENCODE","MCF10A_treated_with_TAM24hr-Ji2017","trophoblast_cell-ENCODE","H1_BMP4_Derived_Trophoblast_Cultured_Cells-Roadmap","uterus-ENCODE","body_of_pancreas-ENCODE","stomach_fetal-Roadmap","H9-Roadmap","transverse_colon-ENCODE","H1_BMP4_Derived_Mesendoderm_Cultured_Cells-Roadmap","breast_epithelium-ENCODE","induced_pluripotent_stem_cell-ENCODE","LNCAP","H1_Derived_Mesenchymal_Stem_Cells-Roadmap","ovary-Roadmap","sigmoid_colon-ENCODE","skeletal_muscle_myoblast-Roadmap","bipolar_neuron_from_iPSC-ENCODE","coronary_artery_smooth_muscle_cell-Miller2016","SK-N-SH-ENCODE","muscle_of_trunk_fetal-Roadmap"]},{label:"Other",categories:["adipose_tissue-ENCODE","HeLa-S3-Roadmap","hepatocyte-ENCODE","heart_ventricle-ENCODE","spinal_cord_fetal-ENCODE","coronary_artery-ENCODE","HepG2-Roadmap","muscle_of_leg_fetal-Roadmap","gastrocnemius_medialis-ENCODE","brite_adipose-Loft2014","placenta-Roadmap","liver-ENCODE","A673-ENCODE","white_adipose-Loft2014","cardiac_muscle_cell-ENCODE","osteoblast-ENCODE","H1_Derived_Neuronal_Progenitor_Cultured_Cells-Roadmap","endothelial_cell_of_umbilical_vein-Roadmap","NCCIT","myotube_originated_from_skeletal_muscle_myoblast-Roadmap","psoas_muscle-Roadmap","endothelial_cell_of_umbilical_vein_vegf_stim_4_hours-zhang2013","endothelial_cell_of_umbilical_vein_vegf_stim_12_hours-zhang2013"]}]},yt={editable:!1,trackSourceServers:["//higlass.io/api/v1"],views:[{uid:"context",genomePositionSearchBox:{autocompleteServer:"//higlass.io/api/v1",autocompleteId:"OHJakQICQD6gTD7skx4EWA",chromInfoServer:"//higlass.io/api/v1",chromInfoId:"hg19",visible:!0},chromInfoPath:"//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv",tracks:{top:[{type:"combined",uid:"chroms-viewport",height:12,contents:[{type:"horizontal-chromosome-labels",options:{color:"#999999",stroke:"white",fontSize:10,fontIsLeftAligned:!0,showMousePosition:!1,mousePositionColor:"#000000"},tilesetUid:"ADfY_RtsQR6oKOMyrq6qhw",height:12,server:"https://resgen.io/api/v1",uid:"chroms"},{uid:"viewport-details-chroms",type:"viewport-projection-horizontal",fromViewUid:"details",height:12,options:{projectionFillColor:"#cc0078",projectionStrokeColor:"#cc0078",projectionFillOpacity:.3,projectionStrokeOpacity:.3,strokeWidth:1}}]},{type:"combined",uid:"genes-tss-viewport",height:50,contents:[{type:"horizontal-gene-annotations",uid:"genes",height:50,server:"https://resgen.io/api/v1",tilesetUid:"NCifnbrKQu6j-ohVWJLoJw",options:{fontSize:9,plusStrandColor:"black",minusStrandColor:"black",geneAnnotationHeight:12,geneLabelPosition:"outside",geneStrandSpacing:2}},{type:"tss",uid:"tss",height:50,server:"https://resgen.io/api/v1",tilesetUid:"VMZDLKrtQDmJMSjg7Ds4yA",options:{fontSize:9,plusStrandColor:"black",minusStrandColor:"black",geneAnnotationHeight:12,geneLabelPosition:"outside",geneStrandSpacing:2}},{uid:"viewport-details-genes",type:"viewport-projection-horizontal",fromViewUid:"details",height:50,options:{projectionFillColor:"#cc0078",projectionStrokeColor:"#cc0078",projectionFillOpacity:.3,projectionStrokeOpacity:.3,strokeWidth:1}}]},{type:"point-annotation",uid:"ibd-snps",server:"https://resgen.io/api/v1",tilesetUid:"VF5-RDXWTxidGMJU7FeaxA",height:36,options:{axisPositionHorizontal:"right",markColor:"black",markColorFocus:"#cc0078",markSize:2,markOpacity:.33,markOpacityFocus:.66,valueColumn:7,focusRegion:[1761419571,1761419621],name:"IBD SNPs",toolTip:{name:{field:3},value:{field:6,numDecimals:2},other:[{label:"Post. Prob.",field:7,numDecimals:2}]}}},{type:"stacked-bar",server:"https://resgen.io/api/v1",tilesetUid:"GOxTKzoLSsuw0BaG6eBrXw",height:96,uid:"stacked-bars",options:{binSize:4,axisAlign:"right",axisPositionHorizontal:"right",labelPosition:"hidden",markColor:"black",markColorFocus:"#cc0078",markSize:4,markOpacity:.33,arcStyle:"indicator",indicatorStyle:"category-rect",labelColor:"black",trackBorderWidth:0,trackBorderColor:"black",geneField:6,importanceField:7,importanceDomain:[0,1],focusRegion:[1761419571,1761419621],name:"By Celltype",stratification:bt}},{type:"stratified-bed",server:"https://resgen.io/api/v1",tilesetUid:"GOxTKzoLSsuw0BaG6eBrXw",height:403,uid:"indicatorByCellTypes",options:{axisAlign:"right",labelPosition:"hidden",markColor:"black",markColorHighlight:"#bf0071",markColorDehighlight:"#bbbbbb",markSize:4,markMinWidth:4,markHeight:3,rowHeight:3,markOpacity:.33,arcStyle:"indicator",indicatorStyle:"category-rect",labelColor:"black",geneField:6,importanceField:7,importanceDomain:[0,1],name:"By Celltype",axisPositionHorizontal:"right",stratification:bt}}]},overlays:[{uid:"region-focus",includes:["chroms","genes-tss-viewport","ibd-snps","stacked-bars","indicatorByCellTypes"],options:{extent:[[1761419596,1761419597]],minWidth:3,fill:"#cc0078",fillOpacity:.05,strokeWidth:0,outline:"#cc0078",outlineOpacity:.33,outlineWidth:1,outlinePos:["left","right"]}},{uid:"gene-focus",includes:["genes-tss-viewport"],options:{extent:[],minWidth:3,fill:"#cc0078",fillOpacity:.25,stroke:"#cc0078",strokeWidth:0,outlineWidth:0}},{uid:"tss-overlays",includes:["chroms","genes-tss-viewport","ibd-snps","stacked-bars","indicatorByCellTypes"],options:{extent:[],minWidth:1,fill:"black",fillOpacity:.05,strokeWidth:0,outline:"black",outlineOpacity:.1,outlineWidth:1,outlinePos:["left"]}}],metaTracks:[{uid:"tss-overlays-meta",type:"annotation-overlay",overlaysTrack:"tss-overlays",options:{annotationTracks:["tss"]}}],layout:{w:12,h:12,x:0,y:0},initialXDomain:[1761366260,1761603836],initialYDomain:[1761366260,1761603836]}]},xt={zoomFixed:!1,editable:!1,trackSourceServers:["//higlass.io/api/v1"],views:[{uid:"details",chromInfoPath:"//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv",tracks:{top:[{uid:"chroms",type:"horizontal-chromosome-labels",server:"https://resgen.io/api/v1",tilesetUid:"ADfY_RtsQR6oKOMyrq6qhw",height:12,options:{color:"#999999",stroke:"white",fontSize:10,fontIsLeftAligned:!0,showMousePosition:!1,mousePositionColor:"#000000"}},{uid:"genes",type:"horizontal-gene-annotations",server:"https://resgen.io/api/v1",tilesetUid:"NCifnbrKQu6j-ohVWJLoJw",height:48,options:{fontSize:9,plusStrandColor:"black",minusStrandColor:"black",geneAnnotationHeight:12,geneLabelPosition:"outside",geneStrandSpacing:2}},{uid:"ibd-snps",type:"point-annotation",server:"https://resgen.io/api/v1",tilesetUid:"VF5-RDXWTxidGMJU7FeaxA",height:132,options:{axisPositionHorizontal:"right",markColor:"black",markColorFocus:"#cc0078",markSize:2,markOpacity:.33,markOpacityFocus:.66,valueColumn:7,focusRegion:[1761419571,1761419621],name:"IBD SNPs",toolTip:{name:{field:3},value:{field:6,numDecimals:2},other:[{label:"Post. Prob.",field:7,numDecimals:2}]}}},{uid:"dna-accessibility",type:"ridge-plot",server:"https://resgen.io/api/v1",tilesetUid:"Uz1_tEABQf-uzktblvBKSQ",height:2364,options:{name:"DNA Accessibility",labelPosition:"outerBottom",labelShowResolution:!1,labelShowAssembly:!1,markArea:!0,markColor:"#444444",markResolution:256,valueScaling:"exponential",colorRange:["#ffffff","#000000"],rowHeight:24,rowPadding:-6,rowNormalization:!0,rowSelections:[120,36,54,20,80,35,101,49,44,23,30,66,5,26,15,105,57,56,74,84,79,93,106,107,34,28,25,55,121,94,58,69,67,63,126,71,72,47,11,46,39,113,29,60,45,76,21,103,129,13,128,90,104,32,109,27,9,130,95,86,53,73,50,48,78,14,92,124,31,114,64,88,12,10,38,68,3,111,70,22,61,98,6,123,118,43,37,65,81,62,33,1,24,122,83,75,112,40,97,16,117,87,19,125,7,102,116,77,8,17,82,115,89,119,18,4,108,59,127,91,0,100,85,110,99,2,96,51,41,52,42],rowIdToCategory:{fn:"replace",args:[".accessibility",""]},rowCategories:bt.groups.reduce((function(t,e,i){var o={label:e.label,color:e.axisLabelColor,background:e.axisLabelBackground,index:i};return e.categories.forEach((function(e){t[e]=o})),t}),{}),showRowLabels:!0,rowLabelSize:10}}]},overlays:[{uid:"region-focus",includes:["chroms","genes","ibd-snps","dna-accessibility"],options:{extent:[],minWidth:3,fill:"#cc0078",fillOpacity:.05,strokeWidth:0,outline:"#cc0078",outlineOpacity:.33,outlineWidth:1,outlinePos:["left","right"]}}],layout:{w:12,h:12,x:0,y:0},initialXDomain:[1761419096,1761420097],initialYDomain:[1761419096,1761420097]}]},wt=(i(316),i(317),Object(m.a)((function(t){return{root:{position:"absolute",display:"flex",top:0,right:0,bottom:0,left:0},appBar:{width:"calc(100% - ".concat(240,"px)"),marginLeft:240,color:t.palette.common.black,backgroundColor:t.palette.common.white,boxShadow:"0 1px 0 0 ".concat(t.palette.grey[300])},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},textInput:{minWidth:"100%"},toolbar:t.mixins.toolbar,content:{display:"flex",flexDirection:"column",flexGrow:1,padding:t.spacing(1),backgroundColor:"white"},higlass:{display:"flex",flexGrow:1},higlassPrimary:{flexGrow:1},higlassSecondary:{width:"20rem"},higlassTitleBarFontSize:{fontSize:"0.8rem"},higlassEnhancersTitleBar:{position:"relative",margin:"-8px 0 0 -8px",padding:"4px 0 4px 8px",background:t.palette.grey[100]},higlassDnaAccessibilityTitleBar:{margin:"-8px -8px 0 0",padding:"4px 8px 4px 0",background:t.palette.grey[100]},higlassSeparator:{width:1,margin:"-8px 0",background:t.palette.grey[300]},toolbarExtra:{paddingLeft:0,paddingRight:0,alignItems:"flex-end"}}}))),kt=function(t){return t?t.replace(":","."):t},Ct=function(t){return t?t.replace(".",":"):t},St=function(t,e,i){return function(o){var a=Object(k.a)(o.views[0].initialXDomain),n=function(t){return t.views[0].overlays[1]&&t.views[0].overlays[1].options.extent&&t.views[0].overlays[1].options.extent.length?Object(k.a)(t.views[0].overlays[1].options.extent[0]):null}(o),r=function(t){return t.views[0].tracks.top[2].options.focusRegion?Object(k.a)(t.views[0].tracks.top[2].options.focusRegion):null}(o);return Number.isNaN(+t)||(a[0]=t),Number.isNaN(+e)||(a[1]=e),n&&!i&&(a[0]=n[0]-1e5,a[1]=n[1]+1e5),r&&!i&&(a[0]=Math.min(a[0],r[0]-1e5),a[1]=Math.max(a[1],r[1]+1e5)),o.views[0].initialXDomain=a,o}},Ot=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(i){if(Number.isNaN(+t)||null===t)e.forEach((function(t){delete i.views[0].tracks.top[t].options.focusRegion})),i.views[0].overlays[0].options.extent=[];else{var o=[t-.5,t+.5];e.forEach((function(t){i.views[0].tracks.top[t].options.focusRegion=o})),i.views[0].overlays[0].options.extent=[o]}return i}},_t=function(t){return function(e){return e.views[0].tracks.top[2].options.valueColumn="pValue"===t?7:8,e}},Tt=function(t){var e=ut("gene",""),i=Object(l.a)(e,2),o=i[0],r=i[1],s=ut("variant","rs1250566"),u=Object(l.a)(s,2),d=u[0],p=u[1],f=ut("hide-unfocused"),m=Object(l.a)(f,2),g=m[0],v=m[1],b=ut("matrix-coloring","solid"),y=Object(l.a)(b,2),H=y[0],B=y[1],W=ut("varient-scale","pValue"),V=Object(l.a)(W,2),X=V[0],U=V[1],Y=ut("access-labels","indicator"),J=Object(l.a)(Y,2),K=J[0],Q=J[1],q=ut("start",t.chromInfo.absToChr(1761366260).slice(0,2).join(":"),{encoder:kt,decoder:Ct}),Z=Object(l.a)(q,2),$=Z[0],tt=Z[1],it=ut("end",t.chromInfo.absToChr(1761603836).slice(0,2).join(":"),{encoder:kt,decoder:Ct}),ot=Object(l.a)(it,2),at=ot[0],nt=ot[1],rt=Object(a.useState)(null),st=Object(l.a)(rt,2),lt=st[0],ct=st[1],pt=Object(a.useState)(null),ft=Object(l.a)(pt,2),mt=ft[0],bt=ft[1],Tt=dt(lt),Et=dt(mt),Mt=Object(a.useRef)(null),At=Object(a.useRef)(null),Rt=Object(a.useMemo)((function(){var t=[];return lt&&lt===Tt&&t.push(lt),mt&&mt===Et&&t.push(mt),lt&&lt!==Tt&&t.push(lt),mt&&mt!==Et&&t.push(mt),t}),[lt,mt]),It=Object(a.useMemo)((function(){return lt?ht("".concat(lt.chr,":").concat(lt.txStart),t.chromInfo):null}),[lt,t.chromInfo]),jt=Object(a.useMemo)((function(){return lt?ht("".concat(lt.chr,":").concat(lt.txEnd),t.chromInfo):null}),[lt,t.chromInfo]),Pt=Object(a.useMemo)((function(){return mt?ht("".concat(mt.chr,":").concat(mt.txStart),t.chromInfo):null}),[mt,t.chromInfo]),Ft=Object(a.useMemo)((function(){return ht($,t.chromInfo)}),[$,t.chromInfo]),Dt=Object(a.useMemo)((function(){return ht(at,t.chromInfo)}),[at,t.chromInfo]),Nt=Object(a.useMemo)((function(){return Object(h.i)((e=lt?lt.geneName:null,i=It,o=jt,function(t){var a=t.views[0].tracks.top.length;return e?(t.views[0].tracks.top[a-1].options.focusGene=e,t.views[0].overlays[1].options.extent=[[i,o]]):(delete t.views[0].tracks.top[a-1].options.focusGene,delete t.views[0].overlays[1].options.extent),t}),Ot(Pt,[2,4]),function(t){return function(e){return e.views[0].tracks.top[4].options.focusStyle="true"===t?"filtering":"highlighting",e.views[0].tracks.top[4].options.stratification.axisNoGroupColor="true"!==t,e}}(g),(t=H,function(e){return e.views[0].tracks.top[4].options.opacityEncoding=t,e}),_t(X),St(Ft,Dt))(Object(h.b)(yt));var t,e,i,o}),[lt,It,jt,Pt,g,H,X]),zt=Object(a.useMemo)((function(){return Object(h.i)(Ot(Pt,[2]),_t(X),(t=K,function(e){return e.views[0].tracks.top[3].options.showRowLabels=!(!t||"hidden"===t)&&t,e}),St(Pt?Pt-2500:Ft,Pt?Pt+2500:Dt,!0))(Object(h.b)(xt));var t}),[Pt,X,K,t.chromInfo]),Lt=Object(a.useMemo)((function(){return Object(h.d)($)&&$.indexOf(":")>=0?t.chromInfo.chrToAbs([$.split(":")[0],+$.split(":")[1]]):+$}),[$,t.chromInfo]),Ht=Object(a.useMemo)((function(){return Object(h.d)(at)&&at.indexOf(":")>=0?t.chromInfo.chrToAbs([at.split(":")[0],+at.split(":")[1]]):+at}),[at,t.chromInfo]),Gt=function(){r(""),ct(null)},Bt=function(){p(""),bt(null)},Wt=function(t){t?(p(t.geneName),bt(t)):Bt()},Vt=function(t){"gene-annotation"===t.type?(r(t.payload.name),ct({chr:t.payload.fields[0],txStart:t.payload.fields[1],txEnd:t.payload.fields[2],geneName:t.payload.name,type:"gene"})):"snp"===t.type&&(p(t.payload.name),bt({chr:t.payload.fields[0],txStart:t.payload.fields[1],txEnd:t.payload.fields[2],geneName:t.payload.name,score:t.payload.importance,type:"variant"}))},Xt=Object(h.a)((function(e){var i=e.xDomain.map((function(e){return t.chromInfo.absToChr(e).slice(0,2).join(":")})),o=Object(l.a)(i,2),a=o[0],n=o[1];tt(a),nt(n)}),250);Object(a.useEffect)((function(){Object(w.a)(x.a.mark((function t(){var e,i,a,n;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!o||lt){t.next=10;break}return t.next=3,fetch("".concat(gt,"&ac=").concat(o));case 3:return e=t.sent,t.next=6,e.json();case 6:i=t.sent,i[0].type="gene",(s=i[0])?(r(s.geneName),ct(s)):Gt();case 10:if(!d||mt){t.next=20;break}return t.next=13,fetch("".concat(vt,"&ac=").concat(d));case 13:return a=t.sent,t.next=16,a.json();case 16:n=t.sent,n[0].type="variant",Wt(n[0]);case 20:case"end":return t.stop()}var s}),t)})))()}),[]);var Ut=Object(a.useCallback)((function(t){null!==t&&(Mt.current=t.api,t.api.on("click",Vt),t.api.on("location",Xt,"context"))}),[]),Yt=Object(a.useCallback)((function(t){null!==t&&(At.current=t.api)}),[]),Jt=wt();return n.a.createElement("div",{className:Jt.root},n.a.createElement(_.a,null),n.a.createElement(C.a,{position:"fixed",className:Jt.appBar},n.a.createElement(z.a,{classes:{root:Jt.toolbarExtra}},n.a.createElement(M.a,{fullWidth:!0},n.a.createElement(et,{label:n.a.createElement(I.a,{container:!0,direction:"row",alignItems:"center"},n.a.createElement(G.a,{fontSize:"small"}),n.a.createElement("span",{style:{marginLeft:3}},"Gene or Variant")),searchUrl:[{url:gt,type:"gene"},{url:vt,type:"variant"}],onChange:function(t){if(t.length){var e={};t.slice(t.length-2).forEach((function(t){switch(t.type){case"gene":e.gene=t,o!==t.geneName&&(r(t.geneName),ct(t));break;case"variant":e.variant=t,d!==t.geneName&&(p(t.geneName),bt(t));break;default:console.warn("Unknown focus element",t)}})),o&&!e.gene&&Gt(),d&&!e.variant&&Bt()}else Gt(),Bt()},value:Rt,variant:"filled",larger:!0,fullWidth:!0,multiple:!0})))),n.a.createElement(E.a,{className:Jt.drawer,variant:"permanent",classes:{paper:Jt.drawerPaper},anchor:"left"},n.a.createElement("div",{className:Jt.toolbar}),n.a.createElement(T.a,null),n.a.createElement(S.a,{m:1},n.a.createElement(S.a,{m:0},n.a.createElement(M.a,{variant:"outlined",margin:"dense",fullWidth:!0},n.a.createElement(j.a,{htmlFor:"x-domain-start"},"Region Start"),n.a.createElement(P.a,{id:"x-domain-start",label:"Region Start",onChange:function(t){tt(t.target.value)},value:$}))),n.a.createElement(S.a,{m:0},n.a.createElement(M.a,{variant:"outlined",margin:"dense",fullWidth:!0},n.a.createElement(j.a,{htmlFor:"x-domain-end"},"Region End"),n.a.createElement(P.a,{id:"x-domain-end",label:"Region End",onChange:function(t){nt(t.target.value)},value:at}))),n.a.createElement(S.a,{m:0},n.a.createElement(O.a,{variant:"contained",margin:"dense",onClick:function(t){if(Mt.current){var e=Object(h.b)(Nt),i=Object(k.a)(e.views[0].initialXDomain);Number.isNaN(+Lt)||(i[0]=Lt),Number.isNaN(+Ht)||(i[1]=Ht),Mt.current.zoomTo("context",i[0],i[1],i[0],i[1],2e3)}},fullWidth:!0,disableElevation:!0},"Go"))),n.a.createElement(T.a,null),n.a.createElement(S.a,{m:1},n.a.createElement(A.a,{control:n.a.createElement(N.a,{checked:"true"===g,onChange:function(t){v(t.target.checked.toString())},name:"hideUnfocused"}),label:"Hide unfocused"})),n.a.createElement(S.a,{m:1},n.a.createElement(M.a,{component:"fieldset"},n.a.createElement(R.a,{component:"legend"},"Variant y-scale"),n.a.createElement(D.a,{"aria-label":"variantYScale",name:"variantYScale",value:X,onChange:function(t){U(t.target.value)}},n.a.createElement(A.a,{label:"p-value",control:n.a.createElement(F.a,{size:"small"}),value:"pValue"}),n.a.createElement(A.a,{label:"Posterior probability",control:n.a.createElement(F.a,{size:"small"}),value:"posteriorProbability"})))),n.a.createElement(S.a,{m:1},n.a.createElement(M.a,{component:"fieldset"},n.a.createElement(R.a,{component:"legend"},"Matrix coloring"),n.a.createElement(D.a,{"aria-label":"matrixColoring",name:"matrixColoring",value:H,onChange:function(t){B(t.target.value)}},n.a.createElement(A.a,{label:"Solid",control:n.a.createElement(F.a,{size:"small"}),value:"solid"}),n.a.createElement(A.a,{label:"Number of predictions",control:n.a.createElement(F.a,{size:"small"}),value:"frequency"}),n.a.createElement(A.a,{label:"Highest prediction score",control:n.a.createElement(F.a,{size:"small"}),value:"highestImportance"}),n.a.createElement(A.a,{label:"Prediction score of the closest TSS interaction",control:n.a.createElement(F.a,{size:"small"}),value:"closestImportance"})))),n.a.createElement(S.a,{m:1},n.a.createElement(M.a,{component:"fieldset"},n.a.createElement(R.a,{component:"legend"},"DNA accessibility labels"),n.a.createElement(D.a,{"aria-label":"dnaAccessLabels",name:"dnaAccessLabels",value:K,onChange:function(t){Q(t.target.value)}},n.a.createElement(A.a,{label:"Indicator",control:n.a.createElement(F.a,{size:"small"}),value:"indicator"}),n.a.createElement(A.a,{label:"Text",control:n.a.createElement(F.a,{size:"small"}),value:"text"}),n.a.createElement(A.a,{label:"Hidden",control:n.a.createElement(F.a,{size:"small"}),value:"hidden"}))))),n.a.createElement("main",{className:Jt.content},n.a.createElement("div",{className:Jt.toolbar}),n.a.createElement("div",{className:Jt.higlass},n.a.createElement(I.a,{container:!0,direction:"column",className:Jt.higlassPrimary},n.a.createElement(I.a,{item:!0,className:Jt.higlassEnhancersTitleBar},n.a.createElement(L.a,{align:"center",className:Jt.higlassTitleBarFontSize,noWrap:!0},n.a.createElement("strong",null,"Predicted Enhancers"))),n.a.createElement(I.a,{item:!0,className:Jt.higlassPrimary},n.a.createElement(c.HiGlassComponent,{ref:Ut,viewConfig:Nt,options:{sizeMode:"bounded"}}))),n.a.createElement("div",{className:Jt.higlassSeparator}),n.a.createElement(I.a,{container:!0,direction:"column",className:Jt.higlassSecondary},n.a.createElement(I.a,{item:!0,className:Jt.higlassDnaAccessibilityTitleBar},n.a.createElement(L.a,{align:"center",className:Jt.higlassTitleBarFontSize,noWrap:!0},n.a.createElement("strong",null,"DNA Accessibility"))),n.a.createElement(I.a,{item:!0,className:Jt.higlassPrimary},n.a.createElement(c.HiGlassComponent,{ref:Yt,viewConfig:zt,options:{sizeMode:"scroll",pixelPreciseMarginPadding:!0,containerPaddingX:0,containerPaddingY:0,viewMarginTop:0,viewMarginBottom:0,viewMarginLeft:0,viewMarginRight:0,viewPaddingTop:0,viewPaddingBottom:0,viewPaddingLeft:0,viewPaddingRight:16}}))))))},Et=function(t,e){return function(i){return function(o){return t(o)?n.a.createElement(e,o):n.a.createElement(i,o)}}},Mt=(i(318),Object(u.a)({palette:{primary:{main:"#000"},secondary:{main:"#000"}}})),At=function(){var t=Object(a.useState)(null),e=Object(l.a)(t,2),i=e[0],o=e[1];Object(a.useEffect)((function(){Object(c.ChromosomeInfo)("https://s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv").then((function(t){void 0===t.totalLength?o(!1):o(t)})).catch((function(){o(!1)}))}),[]);var r=Object(h.i)(Et((function(){return null===i}),v),Et((function(){return!1===i}),b))(Tt);return n.a.createElement("div",{className:"App"},n.a.createElement(d.a,{theme:Mt},n.a.createElement(r,{chromInfo:i})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Rt=i(27),It=i(28),jt=i(29);function Pt(t){if(!(this instanceof Pt?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var e=t.services.pubSub,i=function(){function t(i,o){var a=this;Object(It.a)(this,t);var n=i.definition,r=i.getTrackObject,s=i.onNewTilesLoaded;this.animate=s,this.options=o,this.overlaysTrack=r(n.overlaysTrack),this.overlaysTrack?(this.annotationTrackIds=new Set,this.annotationTracks=n.options.annotationTracks.map((function(t){var e=r(t);return e?a.annotationTrackIds.add(e.uuid):console.warn("Child track (uid: ".concat(t,") not found")),e})).filter((function(t){return t})),this.annotationDrawnHandlerBound=this.annotationDrawnHandler.bind(this),this.drawnAnnotations=new Map,this.tracksDrawingTiles=new Set,this.pubSubs=[],this.annotationTracks.forEach((function(t){t.subscribe("annotationDrawn",a.annotationDrawnHandlerBound)})),this.pubSubs.push(e.subscribe("TiledPixiTrack.tilesDrawnEnd",this.tilesDrawnEndHandler.bind(this)))):console.warn("Overlays track (uid: ".concat(n.overlaysTrack,") not found"))}return Object(jt.a)(t,[{key:"annotationDrawnHandler",value:function(t){var e=t.xStartAbs,i=t.xEndAbs,o=t.data;this.drawnAnnotations.set(o.uid,[e,i])}},{key:"remove",value:function(){var t=this;this.pubSubs.forEach(e.unsubscribe),this.pubSubs=void 0,this.annotationTracks.forEach((function(e){e.unsubscribe("annotationDrawn",t.annotationDrawnHandlerBound)}))}},{key:"tilesDrawnEndHandler",value:function(t){var e=t.uuid;this.annotationTrackIds.has(e)&&(this.tracksDrawingTiles.add(e),this.tracksDrawingTiles.size%this.annotationTracks.length||this.updateOverlays())}},{key:"updateOverlays",value:function(){this.overlaysTrack.options.extent=Array.from(this.drawnAnnotations.values()),this.overlaysTrack.draw(),this.tracksDrawingTiles.clear()}}]),t}(),o=arguments.length,a=new Array(o>1?o-1:0),n=1;n<o;n++)a[n-1]=arguments[n];return Object(Rt.a)(i,a)}Pt.config={type:"annotation-overlay",availableOptions:["annotationTracks"],defaultOptions:{annotationTracks:[]}};var Ft=Pt,Dt=i(30),Nt=i(22),zt=i(37),Lt=i(38),Ht=Float32Array.BYTES_PER_ELEMENT,Gt="precision mediump float;\n\n  attribute vec2 aPrevPosition;\n  attribute vec2 aCurrPosition;\n  attribute vec2 aNextPosition;\n  attribute float aOffsetSign;\n  attribute float aColorIndex;\n\n  uniform sampler2D uAreaColorTex;\n  uniform float uAreaColorTexRes;\n  uniform mat3 projectionMatrix;\n  uniform mat3 translationMatrix;\n\n  uniform vec4 uLineColor;\n  uniform vec4 uNaNColor;\n  uniform float uWidth;\n  uniform int uMiter;\n\n  varying vec4 vColor;\n\n  void main(void)\n  {\n    mat3 model = projectionMatrix * translationMatrix;\n\n    if (aColorIndex <= -0.5) {\n      // Render line\n      vColor = vec4(uLineColor.rgb, 1.0);\n\n      vec4 prevGlPos = vec4((model * vec3(aPrevPosition, 1.0)).xy, 0.0, 1.0);\n      vec4 currGlPos = vec4((model * vec3(aCurrPosition, 1.0)).xy, 0.0, 1.0);\n      vec4 nextGlPos = vec4((model * vec3(aNextPosition, 1.0)).xy, 0.0, 1.0);\n\n      // Calculate the direction\n      vec2 dir = vec2(0.0);\n\n      if (currGlPos == prevGlPos) {\n        // start point uses (next - current)\n        dir = normalize(nextGlPos.xy - currGlPos.xy);\n      }\n      else if (currGlPos == nextGlPos) {\n        // end point uses (current - previous)\n        dir = normalize(currGlPos.xy - prevGlPos.xy);\n      }\n      else {\n        // somewhere in middle, needs a join:\n        // get directions from (C - B) and (B - A)\n        vec2 dirA = normalize((currGlPos.xy - prevGlPos.xy));\n        if (uMiter == 1) {\n          vec2 dirB = normalize((nextGlPos.xy - currGlPos.xy));\n          // now compute the miter join normal and length\n          vec2 tangent = normalize(dirA + dirB);\n          vec2 perp = vec2(-dirA.y, dirA.x);\n          vec2 miter = vec2(-tangent.y, tangent.x);\n          dir = tangent;\n        } else {\n          dir = dirA;\n        }\n      }\n\n      float width = (projectionMatrix * vec3(uWidth, 0.0, 0.0)).x / 2.0;\n\n      vec2 normal = vec2(-dir.y, dir.x) * width;\n      // normal.x /= aspectRatio;\n      vec4 offset = vec4(normal * aOffsetSign, 0.0, 0.0);\n      gl_Position = currGlPos + offset;\n    } else {\n      // Render area\n      float colorRowIndex = aColorIndex / uAreaColorTexRes;\n\n      vec2 colorTexIndex = vec2(\n        (aColorIndex / uAreaColorTexRes) - colorRowIndex,\n        colorRowIndex / uAreaColorTexRes\n      );\n      vColor = texture2D(uAreaColorTex, colorTexIndex);\n\n      gl_Position = vec4((model * vec3(aCurrPosition, 1.0)).xy, 0.0, 1.0);\n    }\n  }\n",Bt="precision mediump float;\n\n  varying vec4 vColor;\n\n  void main() {\n    gl_FragColor = vColor;\n  }\n",Wt=Array(127).fill().map((function(t,e){var i=.5*(1-e/127)+.5;return[i,i,i,1]})),Vt=function(t){return Object.values(t).reduce((function(t,e){return Math.max(t,e.tileData.maxNonZero)}),-1/0)},Xt=function(t){return Object.values(t)[0].tileData.coarseShape[0]},Ut=function(t){return Object(h.f)(Object.values(t).map((function(t){return t.tileData.maxValueByRow})))},Yt=function(t,e,i){var o=(i.domain()[1]-i.domain()[0])/(e.domain()[1]-e.domain()[0]),a=e.domain().map(i)[0];t.scale.x=o,t.position.x=-a*o},Jt=function(t,e,i){return e.length/t/4/(1+i)-2},Kt=function t(e){if(!(this instanceof t?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var i=e.libraries.PIXI,o=e.libraries.d3Format.format,a=e.libraries.d3Scale.scaleLinear,n=e.services.tileProxy,r=function(t){var e=Math.max(2,Math.ceil(Math.sqrt(t.length))),o=new Float32Array(4*Math.pow(e,2));return t.forEach((function(t,e){o[4*e]=t[0],o[4*e+1]=t[1],o[4*e+2]=t[2],o[4*e+3]=t[3]})),[i.Texture.fromBuffer(o,e,e),e]},s=function(t){Object(zt.a)(c,t);var s=Object(Lt.a)(c);function c(t,e){var i;return Object(It.a)(this,c),(i=s.call(this,t,e)).updateOptions(),i}return Object(jt.a)(c,[{key:"initTile",value:function(t){this.coarsifyTileValues(t)}},{key:"destroyTile",value:function(){}},{key:"binsPerTile",value:function(){return this.tilesetInfo.bins_per_dimension||256}},{key:"getTilePosAndDimensions",value:function(t,e,i){var o=i||this.binsPerTile();if(this.tilesetInfo.resolutions){var a=this.tilesetInfo.resolutions.map((function(t){return+t})).sort((function(t,e){return e-t}))[t],n=a*o,r=n;return{tileX:a*o*e[0],tileY:a*o*e[1],tileWidth:n,tileHeight:r}}var s=e[0],l=e[1],c=this.tilesetInfo.min_pos[0],h=this.options.reverseYAxis?-this.tilesetInfo.max_pos[1]:this.tilesetInfo.min_pos[1],u=this.tilesetInfo.max_width/Math.pow(2,t),d=this.tilesetInfo.max_width/Math.pow(2,t);return{tileX:c+s*u,tileY:h+l*d,tileWidth:u,tileHeight:d}}},{key:"updateOptions",value:function(){var t=this;switch(this.selectRowsAggregationMode=this.options.selectRowsAggregationMode||"mean",this.selectRowsAggregationMode){case"max":this.selectRowsAggregationFn=h.e;break;case"min":this.selectRowsAggregationFn=h.h;break;case"sum":this.selectRowsAggregationFn=h.j;break;case"mean":default:this.selectRowsAggregationFn=h.g}this.markArea=!!this.options.markArea,this.markAreaColor="grays",this.markColor=e.utils.colorToHex(this.options.markColor||"black"),this.markColorRgbNorm=this.options.markColor?e.utils.colorToRgba(this.options.markColor).slice(0,3).map((function(t){return Math.min(1,Math.max(0,t/255))})):[0,0,0];var i=r(Object(k.a)(Wt)),o=Object(l.a)(i,2);this.markColorTex=o[0],this.markColorTexRes=o[1],this.markNumColors=Wt.length,this.markOpacity=Number.isNaN(+this.options.markOpacity)?1:Math.min(1,Math.max(0,+this.options.markOpacity)),this.markSize=this.options.markSize||2;var a=this.markResolution;this.markResolution=Math.max(1,Math.min(256,this.options.markResolution||64));var n=this.rowHeight;this.rowHeight=Number.isNaN(+this.options.rowHeight)?"auto":+this.options.rowHeight;var s=this.rowPadding;this.rowPadding="auto"===this.rowHeight?0:this.options.rowPadding||0;var c=this.rowNormalization;this.rowNormalization=this.options.rowNormalization||!1;var u=this.rowSelections;this.rowSelections=this.options.rowSelections||this.rowSelections||[],a===this.markResolution&&u===this.rowSelections||this.updateTiles(),n===this.rowHeight&&s===this.rowPadding&&c===this.rowNormalization||this.updateScales();var d=this.showRowLabels;this.showRowLabels=this.options.showRowLabels,d!==this.showRowLabels&&(this.updateRowLabels(d),this.drawLabel()),this.rowLabelAlign=this.options.rowLabelAlign||"left",this.rowLabelSize=this.options.rowLabelSize||12,this.rowCategories=this.options.rowCategories||{},this.rowIdToCategory=function(t){return t.substring(0,t.length-14)},this.rowIdToCategory=this.options.rowIdToCategory?function(e){return e[t.options.rowIdToCategory.fn].apply(e,Object(k.a)(t.options.rowIdToCategory.args))}:h.c}},{key:"removeRowLabels",value:function(){for(;this.pAxis.children.length;)this.pAxis.removeChildAt(0);this.rowLabels&&(this.rowLabels.forEach((function(t){t.destroy()})),this.rowLabels=void 0)}},{key:"updateRowLabels",value:function(t){var o=this;if(this.tilesetInfo&&this.tilesetInfo.row_infos){var a=this.rowSelections.length?this.rowSelections.map((function(t){return void 0===o.tilesetInfo.row_infos[t]?"?":o.rowIdToCategory(o.tilesetInfo.row_infos[t].id)})):this.tilesetInfo.row_infos.map((function(t){var e=t.id;return o.rowIdToCategory(e)}));this.removeRowLabels(),"indicator"===this.showRowLabels?this.rowLabels=a.map((function(t){var a=new i.Sprite(i.Texture.WHITE);return a.width=o.rowLabelSize/2,a.height=o.rowLabelSize,a.tint=o.rowCategories[t]?e.utils.colorToHex(o.rowCategories[t].axisLabelColor||pt[o.rowCategories[t].index%pt.length]):8421504,a})):this.showRowLabels&&(this.rowLabels=a.map((function(t){return new i.Text(t,{fontSize:o.rowLabelSize,align:"right"===o.rowLabelAlign?"right":"left",fill:o.rowCategories[t]?e.utils.colorToHex(o.rowCategories[t].axisLabelColor||ft[o.rowCategories[t].index%ft.length]):8421504})})))}}},{key:"drawLabel",value:function(){var t=this;if(this.showRowLabels){if(this.showRowLabels&&!this.rowLabels&&this.updateRowLabels(),this.rowLabels){var e=Object(l.a)(this.dimensions,1)[0],i=Object(l.a)(this.position,2),o=i[0],a=i[1];this.pAxis.position.x="right"===this.axisAlign?o+e:o,this.pAxis.position.y=a,this.pAxis.clear();var n=0,r="right"===this.axisAlign?-3:3,s=this.getRowHeight(),c=Object(l.a)(s,2)[1],h=c/2;this.rowLabels.forEach((function(e,i){e.x=r,e.y=n-t.rowPadding+h,e.anchor.x="right"===t.axisAlign?1:0,e.anchor.y=.5,n+=c,t.pAxis.addChild(e)}))}}else if(this.rowLabels)for(;this.pAxis.children.length;)this.pAxis.removeChildAt(0)}},{key:"rerender",value:function(t){this.options=t,this.updateOptions(),this.updateExistingGraphics()}},{key:"hasFetchedTiles",value:function(){return Object.values(this.fetchedTiles).length}},{key:"coarsifyTileValues",value:function(t){var e=this.getTilePosAndDimensions(t.tileData.zoomLevel,t.tileData.tilePos),i=e.tileX,o=e.tileWidth,a=Object(l.a)(t.tileData.shape,1)[0],n=Math.floor(256/this.markResolution),r=o/this.markResolution,s=r/2;t.tileData.binXPos=Array(this.markResolution).fill();for(var c=0;c<=this.markResolution;c++)t.tileData.binXPos[c]=i+r*c+s;t.tileData.valuesByRow=Array(a).fill().map((function(){return[]})),t.tileData.maxValueByRow=Array(a).fill(-1/0);for(var u=0;u<a;u++)for(var d=0;d<256;d+=n){var p=Object(h.g)(t.tileData.dense.subarray(256*u+d,256*u+d+n));t.tileData.valuesByRow[u].push(p),t.tileData.maxValueByRow[u]=p>t.tileData.maxValueByRow[u]?p:t.tileData.maxValueByRow[u]}this.rowSelections.length&&(t.tileData.valuesByRow=this.rowSelections.map((function(e){return t.tileData.valuesByRow[e]})).filter(h.c),t.tileData.maxValueByRow=this.rowSelections.map((function(e){return t.tileData.maxValueByRow[e]})).filter(h.c)),t.tileData.coarseShape=[t.tileData.valuesByRow.length,this.markResolution]}},{key:"updateTiles",value:function(){Object.values(this.fetchedTiles).forEach(this.coarsifyTileValues.bind(this))}},{key:"updateScales",value:function(){var t=this,e=Object.values(this.fetchedTiles);if(e.length){Object(l.a)(this.dimensions,2)[1];var i=Xt(e),o=this.getRowHeight(),n=Object(l.a)(o,1)[0],r=this.getTrackHeight(i,n),s=Vt(this.fetchedTiles);if(this.valueScale=a().domain([0,s]).range([n,0]),this.colorIndexScale=a().domain([0,s]).range([0,this.markNumColors]).clamp(!0),this.rowNormalization){var c=Ut(this.fetchedTiles);this.rowValueScales={},this.rowColorIndexScales={};for(var h=0;h<i;h++)this.rowValueScales[h]=a().domain([0,c[h]]).range([n,0]),this.rowColorIndexScales[h]=a().domain([0,c[h]]).range([0,this.markNumColors]).clamp(!0);this.valueScaleByRow=function(e,i){return Number.isNaN(e)?n:t.rowValueScales[i](e)},this.colorIndexScaleByRow=function(e,i){return Number.isNaN(e)?-2:t.rowColorIndexScales[i](e)}}else this.valueScaleByRow=function(e,i){return Number.isNaN(e)?n:t.valueScale(e)},this.colorIndexScaleByRow=function(e,i){return Number.isNaN(e)?-2:t.colorIndexScale(e)};this.rowScale=a().domain([0,i]).range([0,r+this.rowPadding])}}},{key:"tilesToData",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.markArea,a=i.maxRows,n=void 0===a?1/0:a,r=i.rowHeight;if(!t.length)return[];var s=Math.min(n,Xt(t)),l=Array(s).fill().map((function(){return[]})),c=Array(s).fill().map((function(){return[]})),u=Array(s).fill().map((function(){return[]}));t.forEach((function(t){t.tileData.valuesByRow.forEach((function(i,a){a>=n||i.forEach((function(i,n){var s=e._xScale(t.tileData.binXPos[n]),h=e.rowScale(a),d=h+e.valueScaleByRow(i,a);l[a].push(s,d,s,d),c[a].push(-1,-1),u[a].push(1,-1),o&&(l[a].push(s,d,s,h+r),c[a].push(e.colorIndexScaleByRow(i,a),0),u[a].push(0,0))}))}))}));for(var d=o?8:4,p=o?4:2,f=0;f<s;f++){var m,g,v,b,y,x;if((m=l[f]).unshift.apply(m,Object(k.a)(l[f].slice(0,d))),f>0)(y=c[f]).unshift.apply(y,Object(k.a)(c[f].slice(0,p))),(x=u[f]).unshift.apply(x,Object(k.a)(u[f].slice(0,p)));(g=l[f]).push.apply(g,Object(k.a)(l[f].slice(-d))),(v=c[f]).push.apply(v,Object(k.a)(c[f].slice(-p))),(b=u[f]).push.apply(b,Object(k.a)(u[f].slice(-p)))}return[new Float32Array(l.flatMap(h.c)),new Float32Array(c.flatMap(h.c)),new Float32Array(u.flatMap(h.c))]}},{key:"toLineIndices",value:function(t,e,i){var o=i?12:6,a=i?4:2,n=new Uint32Array((e-1)*t*o),r=0;if(i)for(var s=0;s<t;s++)for(var l=0;l<e-1;l++){var c=s*(e+2)*a+l*a,h=c+1,u=c+2,d=c+3,p=c+4,f=c+5,m=c+6,g=c+7,v=r*o;n[v]=u,n[v+1]=d,n[v+2]=m,n[v+3]=m,n[v+4]=d,n[v+5]=g,n[v+6]=c,n[v+7]=h,n[v+8]=p,n[v+9]=p,n[v+10]=h,n[v+11]=f,r++}else for(var b=0;b<t;b++)for(var y=0;y<e-1;y++){var x=b*(e+2)*a+y*a,w=x+1,k=x+2,C=x+3,S=r*o;n[S]=x,n[S+1]=w,n[S+2]=k,n[S+3]=k,n[S+4]=w,n[S+5]=C,r++}return n}},{key:"getRowHeight",value:function(t){var e=Object(l.a)(this.dimensions,2)[1];return"auto"===this.rowHeight?[Math.floor(e/t),Math.floor(e/t)]:[this.rowHeight,this.rowHeight+this.rowPadding]}},{key:"getTrackHeight",value:function(t,e){var i=Object(l.a)(this.dimensions,2)[1];return"auto"===this.rowHeight?i:e*t+this.rowPadding*(t-1)}},{key:"renderLines",value:function(){this.drawnAtScale=a().domain(Object(k.a)(this.xScale().domain())).range(Object(k.a)(this.xScale().range()));var t=Object.values(this.fetchedTiles),e=Xt(t),o=this.getRowHeight(e),n=Object(l.a)(o,1)[0],r=this.tilesToData(t,{maxRows:e,markArea:this.markArea,rowHeight:n}),s=Object(l.a)(r,3),c=s[0],h=s[1],u=s[2],d=Jt(e,c,this.markArea),p=this.toLineIndices(e,d,this.markArea),f=new i.UniformGroup({uLineColor:[].concat(Object(k.a)(this.markColorRgbNorm),[1]),uNaNColor:[1,1,1,1],uAreaColorTex:this.markColorTex,uAreaColorTexRes:this.markColorTexRes,uWidth:.25,uMiter:1}),m=i.Shader.from(Gt,Bt,f),g=new i.Geometry,v=this.markArea?4:2;g.addAttribute("aPrevPosition",c,2,!1,i.TYPES.FLOAT,2*Ht,0),g.addAttribute("aCurrPosition",c,2,!1,i.TYPES.FLOAT,2*Ht,2*Ht*v),g.addAttribute("aNextPosition",c,2,!1,i.TYPES.FLOAT,2*Ht,2*Ht*v*2),g.addAttribute("aOffsetSign",u,1),g.addAttribute("aColorIndex",h,1),g.addIndex(p);var b=new i.Mesh(g,m),y=new i.Graphics;y.addChild(b),this.pMain.x=this.position[0],this.lineGraphics&&(this.pMain.removeChild(this.lineGraphics),this.lineGraphics.destroy()),this.pMain.addChild(y),this.lineGraphics=y,Yt(this.lineGraphics,this._xScale,this.drawnAtScale),this.draw(),this.animate()}},{key:"updateExistingGraphics",value:function(){this.hasFetchedTiles()&&(this.updateScales(),this.renderLines())}},{key:"setPosition",value:function(t){Object(Dt.a)(Object(Nt.a)(c.prototype),"setPosition",this).call(this,t);var e=Object(l.a)(this.position,2);this.pMain.position.x=e[0],this.pMain.position.y=e[1]}},{key:"zoomed",value:function(t,e){this.xScale(t),this.yScale(e),this.lineGraphics&&Yt(this.lineGraphics,t,this.drawnAtScale),this.refreshTiles(),this.draw()}},{key:"getVisibleData",value:function(t,e){var i=this,a=this.calculateZoomLevel(),r=Xt(this.fetchedTiles),s=this.getRowHeight(r),c=Object(l.a)(s,2)[1],h=n.calculateTileWidth(this.tilesetInfo,a,this.tilesetInfo.tile_size),u=this._xScale.invert(t)/h,d=this.tilesetInfo.tile_size*(u-Math.floor(u)),p=Math.floor(Math.max(0,(e+this.rowPadding)/c)),f=this.rowSelections[p],m=this.tileToLocalId([a,Math.floor(u)]),g=this.fetchedTiles[m],v="",b="<em>unknown</em>";if(g){this.tilesetInfo.shape||(d=g.tileData.dense.length*(u-Math.floor(u)));var y=null;if(y=this.tilesetInfo.shape?Array.isArray(f)&&"client"===this.options.selectRowsAggregationMethod?f.map((function(t){return i.tilesetInfo.shape[0]*t+Math.floor(d)})):f&&"client"===this.options.selectRowsAggregationMethod?this.tilesetInfo.shape[0]*f+Math.floor(d):this.tilesetInfo.shape[0]*p+Math.floor(d):g.tileData.dense.length*p+Math.floor(d),Array.isArray(y)){var x=y.map((function(t){return g.tileData.dense[t]}));v=b=o(".3f")(this.selectRowsAggregationFn(x)),v+="<br/>",v+="".concat(y.length,"-item ").concat(this.options.selectRowsAggregationMode)}else v=b=o(".3f")(g.tileData.dense[y]),Array.isArray(f)&&(b+="<br/>",b+="".concat(f.length,"-item ").concat(this.options.selectRowsAggregationMode))}if(this.tilesetInfo.row_infos){var w="";void 0!==f?w=this.tilesetInfo.row_infos[f]:p&&(w=this.tilesetInfo.row_infos[p]);var k="object"===typeof w?this.rowIdToCategory(w.id):w,C=this.rowCategories[k]?this.rowCategories[k].axisLabelColor||ft[this.rowCategories[k].index%ft.length]:"#666666",S=this.rowCategories[k]?this.rowCategories[k].axisLabelColor||mt[this.rowCategories[k].index%mt.length]:"#ffffff";return'<div style="margin: -0.25rem; padding: 0 0.25rem; background: '.concat(S,'"><strong style="color: ').concat(C,';">').concat(k,":</strong> ").concat(b,"</div>")}return v}},{key:"getMouseOverHtml",value:function(t,e){return this.tilesetInfo?this.getVisibleData(t,e):""}}]),c}(e.tracks.HorizontalLine1DPixiTrack),c=arguments.length,u=new Array(c>1?c-1:0),d=1;d<c;d++)u[d-1]=arguments[d];return Object(Rt.a)(s,u)};Kt.config={type:"ridge-plot",datatype:["multivec"],orientation:"1d",name:"RidgePlot"};var Qt=Kt,qt=i(43),Zt=i(190),$t=i.n(Zt),te="\n  precision mediump float;\n  attribute vec2 aPosition;\n  attribute float aOpacity;\n  attribute float aHighlight;\n\n  uniform mat3 projectionMatrix;\n  uniform mat3 translationMatrix;\n  uniform float uPointSize;\n\n  varying float vHighlight;\n  varying float vOpacity;\n\n  void main(void)\n  {\n    vHighlight = aHighlight;\n    vOpacity = aOpacity;\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n    gl_PointSize = uPointSize;\n  }\n",ee="\n  precision mediump float;\n\n  uniform vec4 uColor;\n  uniform vec4 uColorHighlight;\n\n  varying float vHighlight;\n  varying float vOpacity;\n\n  void main() {\n    float isNotFocused = 1.0 - vHighlight;\n\n    float r = uColor.r * isNotFocused + uColorHighlight.r * vHighlight;\n    float g = uColor.g * isNotFocused + uColorHighlight.g * vHighlight;\n    float b = uColor.b * isNotFocused + uColorHighlight.b * vHighlight;\n\n    gl_FragColor = vec4(r, g, b, 1.0) * vOpacity;\n  }\n",ie=function(t){return[t.cX-t.widthHalf,t.y,t.cX+t.widthHalf,t.y,t.cX+t.widthHalf,t.y+t.height,t.cX-t.widthHalf,t.y+t.height]},oe=function(t,e){var i=4*e;return[i,i+1,i+2,i+2,i+3,i]},ae=function(t){return[t.opacity,t.opacity,t.opacity,t.opacity]},ne=function(t){return[t.highlight,t.highlight,t.highlight,t.highlight]},re=function(t){return t.tileData.length&&void 0!==t.tileData[0].yStart},se=function(t){return t.xEnd-t.xStart},le=function(t){return Math.abs(t.xStart+(t.xEnd-t.xStart)/2-(t.yStart+(t.yEnd-t.yStart)/2))},ce=function(t){return t.xStart},he=function(t){return t.xStart+(t.xEnd-t.xStart)/2},ue=function(t){return t.xEnd},de=function(t){return t.yStart+(t.yEnd-t.yStart)/2},pe=function(t){return Object.values(t).reduce((function(t,e){return Math.max(t,e.tileData.reduce((function(t,e){return Math.max(t,e.width)}),0))}),0)},fe=function(t,e,i){var o=(i.domain()[1]-i.domain()[0])/(e.domain()[1]-e.domain()[0]),a=e.domain().map(i)[0];t.scale.x=o,t.position.x=-a*o},me=function(t){return"".concat(t.fields[0],":").concat(t.fields[1],"-").concat(t.fields[2])},ge=function t(e){if(!(this instanceof t?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var i=e.libraries.PIXI,o=e.libraries.d3Scale,a=o.scaleLinear,n=o.scaleLog,r=e.services.tileProxy,s=n().domain([1,10]).range([.1,1]).clamp(!0),c=function(t){Object(zt.a)(n,t);var o=Object(Lt.a)(n);function n(t,e){var i;return Object(It.a)(this,n),(i=o.call(this,t,e)).updateOptions(),i}return Object(jt.a)(n,[{key:"initTile",value:function(t){var e=re(t),i=e?le:se,o=e?he:ce,a=e?de:ue,n=[];t.tileData.forEach((function(t,e){t.width=i(t),t.start=o(t),t.end=a(t),t.regionId=me(t),t.isLeftToRight=t.start<t.end,n.push([t.xStart,t.xEnd,e])})),t.intervalTree=$t()(n)}},{key:"updateStratificationOption",value:function(){var t=this;if(!this.options.stratification)return this.categoryField=void 0,this.categoryToGroup=void 0,this.groupToColor=void 0,this.numGroups=0,this.numCategories=0,void(this.groupLabels=[]);this.categoryField=this.options.stratification.categoryField,this.getCategory=function(e){return e.fields[t.categoryField].toLowerCase()},this.categoryToGroup=new Map,this.categoryToY=new Map,this.yToCategory=new Map,this.groupToColor=new Map,this.numGroups=this.options.stratification.groups.length,this.groupSizes=this.options.stratification.groups.map((function(t){return t.categories.length})),this.numCategories=this.groupSizes.reduce((function(t,e){return t+e}),0),this.groupLabels=this.options.stratification.groups.map((function(t,e){return t.label||"Group ".concat(e)}));var o=0;this.options.stratification.groups.forEach((function(i,a){t.groupToColor.set(a,[e.utils.colorToHex(i.color||pt[a%pt.length]),e.utils.colorToHex(i.backgroundColor||mt[a%pt.length])]),i.categories.forEach((function(e,i){var n=e.toLowerCase();t.categoryToGroup.set(n,a),t.categoryToY.set(n,o+i),t.yToCategory.set(o+i,n)})),o+=i.categories.length})),this.groupLabelsPixiText=this.groupLabels.map((function(o,a){return new i.Text(o,{fontSize:t.labelSize,align:"right"===t.axisAlign?"right":"left",fill:e.utils.colorToHex(t.options.stratification.groups[a].axisLabelColor||ft[a%ft.length])})}))}},{key:"updateOptions",value:function(){var t=this;switch(this.axisAlign=this.options.axisAlign||"left",this.labelColor=e.utils.colorToHex(this.options.labelColor||"black"),this.labelSize=this.options.labelSize||12,this.markColor=e.utils.colorToHex(this.options.markColor||"black"),this.markColorRgbNorm=this.options.markColor?e.utils.colorToRgba(this.options.markColor).slice(0,3).map((function(t){return Math.min(1,Math.max(0,t/255))})):[0,0,0],this.markOpacity=Number.isNaN(+this.options.markOpacity)?1:Math.min(1,Math.max(0,+this.options.markOpacity)),this.markSize=this.options.markSize||2,this.markMinWidth=this.options.markMinWidth||this.markSize,this.markHeight=this.options.markHeight||this.markSize,this.rowHeight=this.options.rowHeight||this.markHeight,this.markColorHighlight=e.utils.colorToHex(this.options.markColorHighlight||"red"),this.markColorHighlightRgbNorm=this.options.markColorHighlight?e.utils.colorToRgba(this.options.markColorHighlight).slice(0,3).map((function(t){return Math.min(1,Math.max(0,t/255))})):[1,0,0],this.markColorDehighlight=e.utils.colorToHex(this.options.markColorDehighlight||"#999999"),this.markColorDehighlightRgbNorm=this.options.markColorDehighlight?e.utils.colorToRgba(this.options.markColorDehighlight).slice(0,3).map((function(t){return Math.min(1,Math.max(0,t/255))})):[.6,.6,.6],this.markOpacityFocus=Number.isNaN(+this.options.markOpacityFocus)?this.markOpacity:Math.min(1,Math.max(0,+this.options.markOpacityFocus)),this.getImportance=this.options.importanceField?function(e){return+e.fields[t.options.importanceField]}:function(t){return t.width},this.opacityEncoding=this.options.opacityEncoding||"solid",this.opacityEncoding){case"frequency":this.opacityScale=function(){return.1};break;case"highestImportance":case"closestImportance":var i=this.options.importanceDomain||[1e3,1],o=a().domain(i).range([1,10]);this.opacityScale=function(t){return s(o(t))};break;case"solid":default:this.opacityScale=function(){return 1}}this.focusRegion=this.options.focusRegion?this.options.focusRegion:[1/0,1/0],this.getRegion=this.options.focusRegion?function(t){return[t.xStart,t.xEnd]}:void 0,this.focusGene=this.options.focusGene?this.options.focusGene.toLowerCase():void 0,this.getGene=this.options.geneField?function(e){return e.fields[t.options.geneField].toLowerCase()}:void 0,this.focusStyle=this.options.focusStyle?this.options.focusStyle.toLowerCase():void 0,this.minImportance=this.options.minImportance||0,this.updateStratificationOption()}},{key:"rerender",value:function(t){this.options=t,this.updateOptions(),this.updateExistingGraphics()}},{key:"hasFetchedTiles",value:function(){return Object.values(this.fetchedTiles).length}},{key:"updateScales",value:function(){if(Object.values(this.fetchedTiles).length){var t=Object(l.a)(this.dimensions,2)[1];this.maxWidth=pe(this.fetchedTiles),this.heightScale=a().domain([0,this.maxWidth]).range([Math.min(12,t/10),t]),this.categoryHeightScale=a().domain([0,this.numCategories]).range([0,this.numCategories*this.rowHeight]),this.valueScale=a().domain([0,this.maxWidth]).range([t,0]),this.valueScaleInverted=a().domain([0,this.maxWidth]).range([0,t])}}},{key:"itemToIndicatorCategory",value:function(t,e){return{cX:this._xScale(t.start),y:this.categoryHeightScale(this.categoryToY.get(this.getCategory(t))),opacity:this.opacityScale(this.getImportance(t)),highlight:e&&t.__focus,widthHalf:Math.max(this.markMinWidth/2,Math.abs(this._xScale(t.xStart)-this._xScale(t.xEnd))/2),height:this.markHeight,__item:t}}},{key:"isItemInFocus",value:function(){var t=this;return this.getGene&&this.focusGene&&this.getRegion&&this.focusRegion?function(e){return e.__focus=t.getGene(e)===t.focusGene&&nt(t.getRegion(e),t.focusRegion),e.__focus}:this.getGene&&this.focusGene?function(e){return e.__focus=t.getGene(e)===t.focusGene,e.__focus}:this.getRegion&&this.focusRegion?function(e){return e.__focus=nt(t.getRegion(e),t.focusRegion),e.__focus}:function(t){return t.__focus=!1,!0}}},{key:"itemToIndicatorReducer",value:function(t,e){return"highlighting"===this.focusStyle?function(i,o){return t(o),e(i,o),i}:function(i,o){return t(o)&&e(i,o),i}}},{key:"renderIndicatorPoints",value:function(){var t=this;this.drawnAtScale=a().domain(Object(k.a)(this.xScale().domain())).range(Object(k.a)(this.xScale().range()));var e=!("highlighting"!==this.focusStyle||!(this.focusGene&&this.getGene||this.focusRegion&&this.getRegion)),o=[],n=function(i,o){return i.push(t.itemToIndicatorCategory(o,e))};"highestImportance"===this.opacityEncoding?(o={},n=function(i,o){if(i[o.regionId]){var a=t.getImportance(i[o.regionId].__item);t.getImportance(o)>a&&(i[o.regionId]=t.itemToIndicatorCategory(o,e))}else i[o.regionId]=t.itemToIndicatorCategory(o,e)}):"closestImportance"===this.opacityEncoding&&(o={},n=function(i,o){(!i[o.regionId]||o.width<i[o.regionId].__item.width)&&(i[o.regionId]=t.itemToIndicatorCategory(o,e))});var r=this.isItemInFocus(),s=this.itemToIndicatorReducer(r,n),l=Object.values(this.fetchedTiles).flatMap((function(t){return Object.values(t.tileData.reduce(s,o))})),c=new Float32Array(l.flatMap(ie)),h=new Uint16Array(l.flatMap(oe)),u=new Float32Array(l.flatMap(ae)),d=new Float32Array(l.flatMap(ne)),p=new i.UniformGroup({uColor:[].concat(e?Object(k.a)(this.markColorDehighlightRgbNorm):Object(k.a)(this.markColorRgbNorm),[this.markOpacity]),uColorHighlight:[].concat(Object(k.a)(this.markColorHighlightRgbNorm),[this.markOpacity]),uHighlighting:e}),f=i.Shader.from(te,ee,p),m=new i.Geometry;m.addAttribute("aPosition",c,2),m.addAttribute("aOpacity",u,1),m.addAttribute("aHighlight",d,1),m.addIndex(h);var g=new i.Mesh(m,f),v=new i.Graphics;v.addChild(g),this.pMain.x=this.position[0],this.indicatorPointGraphics&&this.pMain.removeChild(this.indicatorPointGraphics),this.pMain.addChild(v),this.indicatorPointGraphics=v,fe(this.indicatorPointGraphics,this._xScale,this.drawnAtScale),this.draw(),this.animate()}},{key:"renderIndicatorCategoryAxis",value:function(){var t=this,e=Object(l.a)(this.dimensions,1)[0],i=Object(l.a)(this.position,2),o=i[0],a=i[1];this.pAxis.position.x="right"===this.axisAlign?o+e:o,this.pAxis.position.y=a,this.pAxis.clear();var n=0,r=0,s="right"===this.axisAlign?-5:5,c="right"===this.axisAlign?-e:e,h="right"===this.axisAlign?-3:3,u=this.pAxis.children.length;this.pAxis.lineStyle(1,0,1,0),this.groupLabelsPixiText.forEach((function(e,i){var o=t.categoryHeightScale(t.groupSizes[i]);r+=o,e.x=h,e.y=n+o/2,e.anchor.x="right"===t.axisAlign?1:0,e.anchor.y=.5,"highlighting"===t.options.focusStyle?t.pAxis.beginFill(16777215,.66):t.pAxis.beginFill(t.groupToColor.get(i)[1],.66),t.pAxis.lineStyle(0),"right"===t.axisAlign?t.pAxis.drawRect(e.x-e.width,e.y-e.height/2,e.width,e.height):t.pAxis.drawRect(e.x,e.y-e.height/2,e.width,e.height),t.pAxis.endFill(),u<i+1&&t.pAxis.addChild(e),t.pAxis.lineStyle(1,0,1,0),t.pAxis.moveTo(0,n),t.pAxis.lineTo(s,n),t.options.stratification.axisShowGroupSeparator&&st(t.pAxis,0,c,n,5),n=r})),this.pAxis.moveTo(0,0),this.pAxis.lineTo(0,r),this.pAxis.lineTo(s,r),this.options.stratification.axisShowGroupSeparator&&st(this.pAxis,0,c,r,5)}},{key:"updateIndicators",value:function(){this.renderIndicatorCategoryAxis(this.valueScaleInverted),this.renderIndicatorPoints()}},{key:"updateExistingGraphics",value:function(){this.hasFetchedTiles()&&(this.updateScales(),this.updateIndicators())}},{key:"drawTile",value:function(t,e){var i=this;if(t.graphics.clear(),!this.options.stratification.axisNoGroupColor){var o=0,a=0;this.groupSizes.forEach((function(e,n){a+=i.categoryHeightScale(e),t.graphics.beginFill(i.groupToColor.get(n)[1]),t.graphics.drawRect(0,o,i.dimensions[0],Math.abs(a-o)),o=a})),t.graphics.endFill()}}},{key:"getMouseOverHtml",value:function(t,e){var i=this;if(!this.tilesetInfo)return"";var o=this.calculateZoomLevel(),a=r.calculateTileWidth(this.tilesetInfo,o,this.tilesetInfo.tile_size),n=this.tileToLocalId([o,Math.floor(this._xScale.invert(t)/a)]),s=this.fetchedTiles[n];if(!s)return"";var c,h=this.yToCategory.get(Math.floor(this.categoryHeightScale.invert(e))),u=this._xScale.invert(t-1),d=this._xScale.invert(t+1);if(s.intervalTree.queryInterval(u,d,(function(t){var e=s.tileData[t[2]];return i.getCategory(e)===h&&(c=e,!0)})),c){var p=this.groupToColor.get(this.categoryToGroup.get(h)),f=Object(l.a)(p,2),m=f[0],g=f[1],v="#".concat(m.toString(16)),b="#".concat(g.toString(16)),y=this.getImportance(c).toFixed(2);return'<div style="margin: -0.25rem; padding: 0 0.25rem; background: '.concat(b,'"><strong style="color: ').concat(v,';">').concat(h,":</strong> ").concat(y,"</div>")}return""}},{key:"setPosition",value:function(t){Object(Dt.a)(Object(Nt.a)(n.prototype),"setPosition",this).call(this,t);var e=Object(l.a)(this.position,2);this.pMain.position.x=e[0],this.pMain.position.y=e[1]}},{key:"zoomed",value:function(t,e){this.xScale(t),this.yScale(e),this.indicatorPointGraphics&&fe(this.indicatorPointGraphics,t,this.drawnAtScale),this.refreshTiles(),this.draw()}},{key:"exportSVG",value:function(){var t=this,e=null,i=null,o=Object(Dt.a)(Object(Nt.a)(n.prototype),"superSVG",this).call(this),a=Object(l.a)(o,2);i=a[0],e=a[1],i.setAttribute("class","exported-arcs-track");var r=document.createElement("g");return e.appendChild(r),r.setAttribute("transform","translate(".concat(this.position[0],",").concat(this.position[1],")")),this.visibleAndFetchedTiles().forEach((function(e){t.polys=[],t.drawTile(e,!0);var i,o=Object(qt.a)(t.polys);try{for(o.s();!(i=o.n()).done;){var a=i.value,n=a.polyStr,s=a.opacity,l=document.createElement("path");l.setAttribute("fill","transparent"),l.setAttribute("opacity",s),l.setAttribute("d",n),r.appendChild(l)}}catch(c){o.e(c)}finally{o.f()}})),[i,e]}}]),n}(e.tracks.HorizontalLine1DPixiTrack),h=arguments.length,u=new Array(h>1?h-1:0),d=1;d<h;d++)u[d-1]=arguments[d];return Object(Rt.a)(c,u)};ge.config={type:"stratified-bed",datatype:["arcs","bedlike"],orientation:"1d",name:"Arcs1D",thumbnail:(new DOMParser).parseFromString('<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5"><path d="M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268" fill="none" stroke="currentColor"/><path d="M10.5 3.5v12" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-dasharray="1,2,0,0"/><path d="M5.5 13.5V6" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-width=".9969299999999999" stroke-dasharray="1.71,3.43,0,0"/><path d="M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z" fill="currentColor"/><path d="M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z" fill="currentColor"/></svg>',"text/xml").documentElement,availableOptions:["arcStyle","flip1D","labelPosition","labelColor","labelTextOpacity","labelBackgroundOpacity","trackBorderWidth","trackBorderColor"],defaultOptions:{arcStyle:"ellipse",flip1D:"no",labelColor:"black",labelPosition:"hidden",trackBorderWidth:0,trackBorderColor:"black"},optionsInfo:{arcStyle:{name:"Arc Style",inlineOptions:{circle:{name:"Circle",value:"circle"},ellipse:{name:"Ellipse",value:"ellipse"}}}}};var ve=ge,be="\n  precision mediump float;\n  attribute vec2 aPosition;\n  attribute float aOpacity;\n  attribute float aFocused;\n\n  uniform mat3 projectionMatrix;\n  uniform mat3 translationMatrix;\n  uniform float uPointSize;\n  uniform vec4 uColor;\n  uniform vec4 uColorFocused;\n\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vOpacity;\n  varying float vFocused;\n\n  void main(void)\n  {\n    vColor = uColor;\n    vColorFocused = uColorFocused;\n    vOpacity = aOpacity;\n    vFocused = aFocused;\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n    gl_PointSize = uPointSize;\n  }\n",ye="\n  #ifdef GL_OES_standard_derivatives\n  #extension GL_OES_standard_derivatives : enable\n  #endif\n\n  precision mediump float;\n\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vOpacity;\n  varying float vFocused;\n\n  void main() {\n    float r = 0.0, delta = 0.0, alpha = 1.0;\n    vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n    r = dot(cxy, cxy);\n\n    #ifdef GL_OES_standard_derivatives\n      delta = fwidth(r);\n      alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n    #endif\n\n    gl_FragColor = vec4(vColor.rgb, alpha * vColor.a);\n  }\n",xe="\n  precision mediump float;\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vOpacity;\n  varying float vFocused;\n\n  void main() {\n    float isNotFocused = 1.0 - vFocused;\n\n    float r = vColor.r * isNotFocused + vColorFocused.r * vFocused;\n    float g = vColor.g * isNotFocused + vColorFocused.g * vFocused;\n    float b = vColor.b * isNotFocused + vColorFocused.b * vFocused;\n\n    gl_FragColor = vec4(r, g, b, 1.0) * vOpacity;\n  }\n",we=["#c76526","#dca237","#eee462","#469b76","#3170ad","#6fb2e4","#000000","#999999"],ke=["#a65420","#b7872e","#9f9841","#3a8162","#295d90","#4a7798","#000000","#666666"],Ce=["#f6e5db","#f9f0de","#fcfbe5","#e0eee8","#dde7f1","#e7f2fb","#d5d5d5","#ffffff"],Se=function(t){return t.tileData.length&&void 0!==t.tileData[0].yStart},Oe=function(t){return t.xEnd-t.xStart},_e=function(t){return Math.abs(t.xStart+(t.xEnd-t.xStart)/2-(t.yStart+(t.yEnd-t.yStart)/2))},Te=function(t){return t.xStart},Ee=function(t){return t.xStart+(t.xEnd-t.xStart)/2},Me=function(t){return t.xEnd},Ae=function(t){return t.yStart+(t.yEnd-t.yStart)/2},Re=function(t){return Object.values(t).reduce((function(t,e){return Math.max(t,e.tileData.reduce((function(t,e){return Math.max(t,e.width)}),0))}),0)},Ie=function(t,e,i){var o=(i.domain()[1]-i.domain()[0])/(e.domain()[1]-e.domain()[0]),a=e.domain().map(i)[0];t.scale.x=o,t.position.x=-a*o},je=function t(e){if(!(this instanceof t?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var i=e.libraries.PIXI,o=e.libraries.d3Scale,a=o.scaleLinear,n=o.scaleLog,r=n().domain([1,10]).range([.1,1]).clamp(!0),s=function(t){Object(zt.a)(n,t);var o=Object(Lt.a)(n);function n(t,e){var i;return Object(It.a)(this,n),(i=o.call(this,t,e)).updateOptions(),i}return Object(jt.a)(n,[{key:"initTile",value:function(t){var e=Se(t),i=e?_e:Oe,o=e?Ee:Te,a=e?Ae:Me;t.tileData.forEach((function(t){t.width=i(t),t.start=o(t),t.end=a(t),t.isLeftToRight=t.start<t.end}))}},{key:"updateTileWidthHistogram",value:function(t){var e=Math.max(this.dimensions[1]/this.pointSize),i=this.maxWidth/e,o=0;t.widthHistogramLeft=new Uint32Array(e),t.widthHistogramRight=new Uint32Array(e),t.tileData.forEach((function(e){var a=Math.round(e.width/i);e.histPos=e.isLeftToRight?t.widthHistogramRight[a]++:t.widthHistogramLeft[a]++,o=o>e.histPos?o:e.histPos})),t.widthHistogramMax=o}},{key:"updateWidthHistograms",value:function(){Object.values(this.fetchedTiles).forEach(this.updateTileWidthHistogram.bind(this))}},{key:"updateStratificationOption",value:function(){var t=this;if(!this.options.stratification)return this.categoryField=void 0,this.categoryToGroup=void 0,this.groupToColor=void 0,this.numGroups=0,this.numCategories=0,void(this.groupLabels=[]);this.categoryField=this.options.stratification.categoryField,this.categoryToGroup=new Map,this.categoryToY=new Map,this.groupToColor=new Map,this.numGroups=this.options.stratification.groups.length,this.groupSizes=this.options.stratification.groups.map((function(t){return t.categories.length})),this.numCategories=this.groupSizes.reduce((function(t,e){return t+e}),0),this.groupLabels=this.options.stratification.groups.map((function(t,e){return t.label||"Group ".concat(e)}));var o=0;this.options.stratification.groups.forEach((function(i,a){t.groupToColor.set(a,[e.utils.colorToHex(i.color||we[a%we.length]),e.utils.colorToHex(i.backgroundColor||Ce[a%we.length])]),i.categories.forEach((function(e,i){t.categoryToGroup.set(e.toLowerCase(),a),t.categoryToY.set(e.toLowerCase(),o+i)})),o+=i.categories.length})),this.groupLabelsPixiText=this.groupLabels.map((function(o,a){return new i.Text(o,{fontSize:t.labelSize,align:"right"===t.axisAlign?"right":"left",fill:e.utils.colorToHex(t.options.stratification.groups[a].axisLabelColor||ke[a%ke.length])})}))}},{key:"updateOptions",value:function(){var t=this;this.axisAlign=this.options.axisAlign||"left",this.labelColor=e.utils.colorToHex(this.options.labelColor||"black"),this.labelSize=this.options.labelSize||12,this.markColor=e.utils.colorToHex(this.options.markColor||"black"),this.markColorRgbNorm=this.options.markColor?e.utils.colorToRgba(this.options.markColor).slice(0,3).map((function(t){return Math.min(1,Math.max(0,t/255))})):[0,0,0],this.markOpacity=Number.isNaN(+this.options.markOpacity)?1:Math.min(1,Math.max(0,+this.options.markOpacity)),this.markSize=this.options.markSize||2,this.markColorFocus=e.utils.colorToHex(this.options.markColorFocus||"red"),this.markColorFocusRgbNorm=this.options.markColorFocus?e.utils.colorToRgba(this.options.markColorFocus).slice(0,3).map((function(t){return Math.min(1,Math.max(0,t/255))})):[1,0,0],this.markOpacityFocus=Number.isNaN(+this.options.markOpacityFocus)?this.markOpacity:Math.min(1,Math.max(0,+this.options.markOpacityFocus)),this.markSizeFocus=this.options.markSizeFocus||this.markSize,this.strokeColor=this.markColor||e.utils.colorToHex(this.options.strokeColor||"black"),this.strokeWidth=this.options.strokeWidth||this.markSize,this.getImportance=this.options.importanceField?function(e){return+e.fields[t.options.importanceField]}:function(t){return t.width};var i=this.options.importanceDomain||[1e3,1],o=a().domain(i).range([1,10]);this.opacityScale=function(t){return r(o(t))},this.focusRegion=this.options.focusRegion?this.options.focusRegion:[1/0,1/0],this.focusGene=this.options.focusGene?this.options.focusGene.toLowerCase():void 0,this.getGene=this.options.geneField?function(e){return e.fields[t.options.geneField].toLowerCase()}:void 0,this.minImportance=this.options.minImportance||0,this.updateStratificationOption(),this.updateWidthHistograms()}},{key:"rerender",value:function(t){this.options=t,this.updateOptions(),this.updateExistingGraphics()}},{key:"updateScales",value:function(){if(Object.values(this.fetchedTiles).length){var t=Object(l.a)(this.dimensions,2)[1],e=this.markSize/2;this.maxWidth=Re(this.fetchedTiles),this.heightScale=a().domain([0,this.maxWidth]).range([Math.min(12,t/10),t]),this.fullHeightScale=a().domain([this.maxWidth,0]).range([Math.min(e,t/10),Math.max(t-e,9*t/10)]),this.fullHeightScaleInverted=a().domain([0,this.maxWidth]).range([Math.min(e,t/10),Math.max(t-e,9*t/10)]),this.incomingHeightScale=a().domain([0,this.maxWidth]).range([t/2,t]),this.outgoingHeightScale=a().domain([0,this.maxWidth]).range([t/2,0]),this.categoryHeightScale=a().domain([0,this.numCategories]).range([0,this.numCategories*this.markSize]),this.valueScale=a().domain([0,this.maxWidth]).range([t,0]),this.valueScaleInverted=a().domain([0,this.maxWidth]).range([0,t])}}},{key:"itemToIndicatorDiverging",value:function(t){return{startX:this._xScale(t.start),endX:this._xScale(t.end),startY:this.outgoingHeightScale(t.width),endY:this.incomingHeightScale(t.width),opacity:this.opacityScale(this.getImportance(t)),size:this.markSize}}},{key:"itemToIndicatorStart",value:function(t){return{x:this._xScale(t.start),y:this.fullHeightScale(t.width),opacity:this.opacityScale(this.getImportance(t)),size:this.markSize}}},{key:"itemToIndicatorEnd",value:function(t){return{x:this._xScale(t.end),y:this.fullHeightScaleInverted(t.width),opacity:this.opacityScale(this.getImportance(t)),size:this.markSize}}},{key:"itemToIndicatorCategory",value:function(t){return{cX:this._xScale(t.start),cY:this.categoryHeightScale(this.categoryToY.get(t.fields[this.categoryField].toLowerCase())),wHalf:Math.max(this.markSize/2,Math.abs(this._xScale(t.xStart)-this._xScale(t.xEnd))/2),opacity:this.opacityScale(this.getImportance(t)),focused:t.xStart<=this.focusRegion[1]&&t.xEnd>=this.focusRegion[0],size:this.markSize,sizeHalf:this.markSize/2}}},{key:"itemToIndicatorReducer",value:function(t){var e=this;return this.getGene&&this.focusGene?function(i,o){return e.getGene(o)===e.focusGene&&i.push(t(o)),i}:function(e,i){return e.push(t(i)),e}}},{key:"renderIndicatorPoints",value:function(t,e,o,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=r.vertexShader,l=void 0===s?be:s,c=r.fragmentShader,h=void 0===c?ye:c,u=r.drawTriangles,d=void 0!==u&&u;this.drawnAtScale=a().domain(Object(k.a)(this.xScale().domain())).range(Object(k.a)(this.xScale().range()));var p=Object.values(this.fetchedTiles).flatMap((function(e){return e.tileData.reduce(t,[])})),f=new Float32Array(p.flatMap(e)),m=new Float32Array(p.flatMap(o)),g=new Float32Array(p.flatMap(n)),v=new i.UniformGroup({uPointSize:this.markSize,uColor:[].concat(Object(k.a)(this.markColorRgbNorm),[this.markOpacity]),uColorFocused:[].concat(Object(k.a)(this.markColorFocusRgbNorm),[this.markOpacity])}),b=i.Shader.from(l,h,v),y=new i.Geometry;y.addAttribute("aPosition",f,2),y.addAttribute("aOpacity",m,1),y.addAttribute("aFocused",g,1);var x=new i.Mesh(y,b,new i.State,d?i.DRAW_MODES.TRIANGLES:i.DRAW_MODES.POINTS),w=new i.Graphics;w.addChild(x),this.pMain.x=this.position[0],this.indicatorPointGraphics&&this.pMain.removeChild(this.indicatorPointGraphics),this.pMain.addChild(w),this.indicatorPointGraphics=w,Ie(this.indicatorPointGraphics,this._xScale,this.drawnAtScale),this.draw(),this.animate()}},{key:"renderIndicatorDistanceAxis",value:function(t){this.drawAxis(t)}},{key:"renderIndicatorCategoryAxis",value:function(){var t=this,e=Object(l.a)(this.dimensions,1)[0],i=Object(l.a)(this.position,2),o=i[0],a=i[1];this.pAxis.position.x="right"===this.axisAlign?o+e:o,this.pAxis.position.y=a,this.pAxis.clear();var n=0,r=0,s="right"===this.axisAlign?-5:5,c="right"===this.axisAlign?-e:e,h="right"===this.axisAlign?-3:3,u=this.pAxis.children.length;this.pAxis.lineStyle(1,0,1,0),this.groupLabelsPixiText.forEach((function(e,i){var o=t.categoryHeightScale(t.groupSizes[i]);r+=o,e.x=h,e.y=n+o/2,e.anchor.x="right"===t.axisAlign?1:0,e.anchor.y=.5,u<i+1&&t.pAxis.addChild(e),t.pAxis.moveTo(0,n),t.pAxis.lineTo(s,n),t.options.stratification.axisShowGroupSeparator&&st(t.pAxis,0,c,n,5),n=r})),this.pAxis.moveTo(0,0),this.pAxis.lineTo(0,r),this.pAxis.lineTo(s,r),this.options.stratification.axisShowGroupSeparator&&st(this.pAxis,0,c,r,5)}},{key:"updateIndicators",value:function(){var t=this.itemToIndicatorDiverging.bind(this),e=function(t){return[t.startX,t.startY,t.endX,t.endY]},i=function(t){return t.opacity},o=function(t){return t.focused},a=ye,n=!1;"category"===this.options.indicatorStyle?(t=this.itemToIndicatorCategory.bind(this),e=function(t){return[t.cX,t.cY]},a=xe,this.renderIndicatorCategoryAxis(this.valueScaleInverted)):"category-rect"===this.options.indicatorStyle?(t=this.itemToIndicatorCategory.bind(this),e=function(t){return[t.cX-t.wHalf,t.cY,t.cX+t.wHalf,t.cY,t.cX+t.wHalf,t.cY+t.size,t.cX+t.wHalf,t.cY+t.size,t.cX-t.wHalf,t.cY+t.size,t.cX-t.wHalf,t.cY]},i=function(t){return[t.opacity,t.opacity,t.opacity,t.opacity,t.opacity,t.opacity]},o=function(t){return[t.focused,t.focused,t.focused,t.focused,t.focused,t.focused]},a=xe,n=!0,this.renderIndicatorCategoryAxis(this.valueScaleInverted)):"start-only"===this.options.indicatorStyle?(t=this.itemToIndicatorStart.bind(this),e=function(t){return[t.x,t.y]},this.renderIndicatorDistanceAxis(this.valueScale)):"end-only"===this.options.indicatorStyle&&(t=this.itemToIndicatorEnd.bind(this),e=function(t){return[t.x,t.y]},this.renderIndicatorDistanceAxis(this.valueScaleInverted)),t=this.itemToIndicatorReducer(t),this.renderIndicatorPoints(t,e,i,o,{fragmentShader:a,drawTriangles:n})}},{key:"updateExistingGraphics",value:function(){this.updateScales(),this.updateWidthHistograms(),"indicator"===this.options.arcStyle&&this.updateIndicators()}},{key:"drawTile",value:function(t,e){var i=this;if(t.graphics.clear(),t.tileData.length){if("indicator"===this.options.arcStyle){var o=Object(l.a)(this.dimensions,2),a=o[0],n=o[1];if(this.options.indicatorStyle.startsWith("category")){if(!this.options.stratification.axisNoGroupColor){var r=0,s=0;this.groupSizes.forEach((function(e,o){s+=i.categoryHeightScale(e),t.graphics.beginFill(i.groupToColor.get(o)[1]),t.graphics.drawRect(0,r,a,Math.abs(s-r)),r=s})),t.graphics.endFill()}}else{var c=Math.round(n/2)-.5;"start-only"===this.options.indicatorStyle?c=n-.5:"end-only"===this.options.indicatorStyle&&(c=.5),t.graphics.lineStyle(1,0,.2),t.graphics.moveTo(0,c),t.graphics.lineTo(a,c)}}for(var h=0;h<t.tileData.length;h++){var u=t.tileData[h];"circle"===this.options.arcStyle?this.drawCircle(t.graphics,u,e):"indicator"===this.options.arcStyle||this.drawEllipse(t.graphics,u,e)}}}},{key:"drawIndicator",value:function(t,e){var i=this._xScale(e.start),o=this._xScale(e.end),a=this.outgoingHeightScale(e.width),n=this.incomingHeightScale(e.width),r=this.opacityScale(this.getImportance(e));t.lineStyle(0,0,0),t.beginFill(4033753,r),t.drawCircle(i,a,this.pointSize),t.endFill(),t.beginFill(12680613,r),t.drawCircle(o,n,this.pointSize),t.endFill(),e.start<=this.focusRegion[1]&&e.end>=this.focusRegion[0]&&(e.start>=this.focusRegion[0]||e.end<=this.focusRegion[1])&&(t.lineStyle(this.pointSize,12680613,r),t.moveTo(i,n),t.lineTo(o,n),t.endFill())}},{key:"drawCircle",value:function(t,e,i,o){var n=this._xScale(e.start),r=this._xScale(e.end),s=Object(l.a)(this.dimensions,2),c=s[0],h=s[1],u=Object(l.a)(this.position,2)[1],d=(r-n)/2,p=(r-n)/2,f=(p*p+d*d)/(2*d),m=(n+r)/2,g=h-d+f,v="";o&&(v+="M".concat(n,",").concat(u+h)),t.moveTo(n,u+h);var b=Math.max(0,n),y=Math.min(c,r),x=this.markColor,w=this.markSize,k=this.markOpacity;e.start<=this.focusRegion[1]&&e.end>=this.focusRegion[0]&&(e.start>=this.focusRegion[0]||e.end<=this.focusRegion[1])&&(x=this.markColorFocus,w=this.markSizeFocus,k=this.markOpacityFocus),t.lineStyle(w,x,k);var C=Math.acos(Math.min(Math.max(-(b-m)/f,-1),1)),S=Math.acos(Math.min(Math.max(-(y-m)/f,-1),1));this.options.flip&&(g=0,S=-Math.PI,t.moveTo(n,0),o&&(v+="M".concat(n,",0")));for(var O=a().domain([0,9]).range([C,S]),_=0;_<10;_++){var T=m-f*Math.cos(O(_)),E=g-f*Math.sin(O(_));t.lineTo(T,E),o&&(v+="L".concat(T,",").concat(E))}o&&this.polys.push({polyStr:v,opacity:k})}},{key:"drawEllipse",value:function(t,e,i,o,n){var r=this._xScale(e.start),s=this._xScale(e.end),c=Object(l.a)(this.dimensions,2)[1],h=this.heightScale(e.width),u=s-r,d=u/2,p=(r+s)/2,f=c,m=Math.PI,g="";n&&(g+="M".concat(r,",").concat(c)),t.moveTo(r,c),this.options.flip&&(f=0,m=-Math.PI,t.moveTo(r,0),n&&(g+="M".concat(r,",0")));var v=this.markColor,b=this.markSize,y=this.markOpacity;e.start<=this.focusRegion[1]&&e.end>=this.focusRegion[0]&&(e.start>=this.focusRegion[0]||e.end<=this.focusRegion[1])&&(v=this.markColorFocus,b=this.markSizeFocus,y=this.markOpacityFocus),t.lineStyle(b,v,y);for(var x=10*Math.round(Math.abs(u)/200),w=a().domain([0,x-1]).range([0,m]),k=0;k<x;k++){var C=p-d*Math.cos(w(k)),S=f-h*Math.sin(w(k));t.lineTo(C,S),n&&(g+="L".concat(C,",").concat(S))}n&&this.polys.push({polyStr:g,opacity:y})}},{key:"getMouseOverHtml",value:function(){}},{key:"setPosition",value:function(t){Object(Dt.a)(Object(Nt.a)(n.prototype),"setPosition",this).call(this,t);var e=Object(l.a)(this.position,2);this.pMain.position.x=e[0],this.pMain.position.y=e[1]}},{key:"zoomed",value:function(t,e){this.xScale(t),this.yScale(e),this.indicatorPointGraphics&&Ie(this.indicatorPointGraphics,t,this.drawnAtScale),this.refreshTiles(),this.draw()}},{key:"exportSVG",value:function(){var t=this,e=null,i=null,o=Object(Dt.a)(Object(Nt.a)(n.prototype),"superSVG",this).call(this),a=Object(l.a)(o,2);i=a[0],e=a[1],i.setAttribute("class","exported-arcs-track");var r=document.createElement("g");e.appendChild(r),r.setAttribute("transform","translate(".concat(this.position[0],",").concat(this.position[1],")"));var s=this.options.strokeColor?this.options.strokeColor:"blue",c=this.options.strokeWidth?this.options.strokeWidth:2;return this.visibleAndFetchedTiles().forEach((function(e){t.polys=[],t.drawTile(e,!0);var i,o=Object(qt.a)(t.polys);try{for(o.s();!(i=o.n()).done;){var a=i.value,n=a.polyStr,l=a.opacity,h=document.createElement("path");h.setAttribute("fill","transparent"),h.setAttribute("stroke",s),h.setAttribute("stroke-width",c),h.setAttribute("opacity",l),h.setAttribute("d",n),r.appendChild(h)}}catch(u){o.e(u)}finally{o.f()}})),[i,e]}}]),n}(e.tracks.HorizontalLine1DPixiTrack),c=arguments.length,h=new Array(c>1?c-1:0),u=1;u<c;u++)h[u-1]=arguments[u];return Object(Rt.a)(s,h)};je.config={type:"1d-arcs",datatype:["arcs","bedlike"],orientation:"1d",name:"Arcs1D",thumbnail:(new DOMParser).parseFromString('<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5"><path d="M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268" fill="none" stroke="currentColor"/><path d="M10.5 3.5v12" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-dasharray="1,2,0,0"/><path d="M5.5 13.5V6" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-width=".9969299999999999" stroke-dasharray="1.71,3.43,0,0"/><path d="M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z" fill="currentColor"/><path d="M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z" fill="currentColor"/></svg>',"text/xml").documentElement,availableOptions:["arcStyle","flip1D","labelPosition","labelColor","labelTextOpacity","labelBackgroundOpacity","strokeColor","strokeWidth","trackBorderWidth","trackBorderColor"],defaultOptions:{arcStyle:"ellipse",flip1D:"no",labelColor:"black",labelPosition:"hidden",strokeColor:"black",strokeWidth:1,trackBorderWidth:0,trackBorderColor:"black"},optionsInfo:{arcStyle:{name:"Arc Style",inlineOptions:{circle:{name:"Circle",value:"circle"},ellipse:{name:"Ellipse",value:"ellipse"}}}}};var Pe=je,Fe=function t(e){if(!(this instanceof t?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var i=e.libraries.d3Array.range,o=e.libraries.d3Scale.scaleBand,a=e.services.tileProxy,n=e.utils.colorToHex,r=function(t){Object(zt.a)(r,t);var e=Object(Lt.a)(r);function r(){return Object(It.a)(this,r),e.apply(this,arguments)}return Object(jt.a)(r,[{key:"setValueScale",value:function(){if(this.valueScale=null,this.options&&this.options.valueColumn){var t=this.options.colorEncodingRange?+this.options.colorEncodingRange[0]:this.minVisibleValueInTiles(+this.options.valueColumn),e=this.options.colorEncodingRange?+this.options.colorEncodingRange[1]:this.maxVisibleValueInTiles(+this.options.valueColumn);if(this.options.valueColumn){var i=this.makeValueScale(t,this.calculateMedianVisibleValue(+this.options.valueColumn),e,2),o=Object(l.a)(i,1);this.valueScale=o[0]}}}},{key:"finalDotYPos",value:function(t,e){return Math.max(e,Math.min(this.dimensions[1]-e,t))}},{key:"drawPoly",value:function(t,e,i,o){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n=[e,o,i,o,i,this.dimensions[1],e,this.dimensions[1]],r=Math.max(2,i-e),s=r*(1+2*a);return t.rectGraphics.drawCircle(e,this.finalDotYPos(o,r),s),n}},{key:"renderRows",value:function(t,e,a,r,s,l){var c=this,h=+t.tileId.split(".")[0];this.initialize();for(var u=o().domain(i(a)).range([r,s]).paddingInner(0),d=this.options.focusRegion||[1/0,1/0],p=[],f=[],m=0;m<e.length;m++){for(var g=0;g<e[m].length;g++){var v=e[m][g].value,b=v.fields,y=+v.chrOffset,x=+b[1]+y,w=+b[2]+y,k=u(m)+u.step()/2;this.valueScale&&(k=this.valueScale(+b[+this.options.valueColumn-1]));var C=k,S=this._xScale(x),O=this._xScale(w);if(!(h in this.drawnRects)||!(v.uid in this.drawnRects[h])){this.drawnRects[h]||(this.drawnRects[h]={});var _=[S,O,C,v,x,w];x<=d[1]&&w>=d[0]?f.push(_):p.push(_)}}t.rectGraphics.lineStyle(0),t.rectGraphics.beginFill(16777215),p.forEach((function(e){c.drawPoly(t,e[0],e[1],e[2],!0)}));var T=this.options.markColor||"black",E=this.options.fillOpacity||.3;t.rectGraphics.lineStyle(1,n(T),E),t.rectGraphics.beginFill(n(T),E),p.forEach((function(e){var i=c.drawPoly(t,e[0],e[1],e[2]);c.drawnRects[h][e[4].uid]=[i,{start:e[4],end:e[5],value:e[3],tile:t,fill:l},t.tileId]})),T=this.options.markColorFocus||"red",E=this.options.markOpacityFocus||.6,t.rectGraphics.lineStyle(1,n(T),E),t.rectGraphics.beginFill(n(T),E),f.forEach((function(e){var i=c.drawPoly(t,e[0],e[1],e[2]);c.drawnRects[h][e[4].uid]=[i,{start:e[4],end:e[5],value:e[3],tile:t,fill:l},t.tileId]})),t.rectGraphics.endFill()}t.rectGraphics.interactive=!0,t.rectGraphics.buttonMode=!0,t.rectGraphics.mouseup=function(t){c.hoveringSnp&&c.pubSub.publish("app.click",{type:"snp",event:t,payload:c.hoveringSnp})}}},{key:"getMouseOverHtml",value:function(t,e){var i=this;if(this.hoveringSnp=void 0,!this.tilesetInfo||!this.options.toolTip)return"";var o=this.calculateZoomLevel(),n=a.calculateTileWidth(this.tilesetInfo,o,this.tilesetInfo.tile_size),r=this._xScale.invert(t)/n,s=Math.floor(r),l=this.tileToLocalId([o,s]),c=this.fetchedTiles[l];if(!c)return"";var h=3;if(c.tileData.forEach((function(e){var o=Math.abs(i._xScale(e.xStart)-t);o<h&&(i.hoveringSnp=e,h=o)})),!this.hoveringSnp)return"";var u=this.finalDotYPos(this.valueScale(this.hoveringSnp.importance),2);if(Math.abs(u-(e-1))>6)return"";var d=this.hoveringSnp.fields[this.options.toolTip.name.field],p=(+this.hoveringSnp.fields[this.options.toolTip.value.field]).toFixed(this.options.toolTip.value.numDecimals||2),f="";return this.options.toolTip.other&&(this.options.toolTip.other.forEach((function(t){var e=t.label||"",o=(+i.hoveringSnp.fields[t.field]).toFixed(t.numDecimals||2);f+="".concat(e,": ").concat(o,";")})),f=" (".concat(f.substr(0,f.length-1),")")),"<div><strong>".concat(d,":</strong> ").concat(p).concat(f,"</div>")}},{key:"exportSVG",value:function(){var t=this,e=null,i=null,o=Object(Dt.a)(Object(Nt.a)(r.prototype),"superSVG",this).call(this),a=Object(l.a)(o,2);i=a[0],e=a[1],i.setAttribute("class","exported-arcs-track");var n=document.createElement("g");e.appendChild(n),n.setAttribute("transform","translate(".concat(this.position[0],",").concat(this.position[1],")"));var s=this.options.strokeColor?this.options.strokeColor:"blue",c=this.options.strokeWidth?this.options.strokeWidth:2;return this.visibleAndFetchedTiles().forEach((function(e){t.polys=[],t.drawTile(e,!0);var i,o=Object(qt.a)(t.polys);try{for(o.s();!(i=o.n()).done;){var a=i.value,r=a.polyStr,l=a.opacity,h=document.createElement("path");h.setAttribute("fill","transparent"),h.setAttribute("stroke",s),h.setAttribute("stroke-width",c),h.setAttribute("opacity",l),h.setAttribute("d",r),n.appendChild(h)}}catch(u){o.e(u)}finally{o.f()}})),[i,e]}}]),r}(e.tracks.BedLikeTrack),s=arguments.length,c=new Array(s>1?s-1:0),h=1;h<s;h++)c[h-1]=arguments[h];return Object(Rt.a)(r,c)};Fe.config={type:"point-annotation",datatype:["arcs","bedlike"],orientation:"1d",name:"Arcs1D",thumbnail:(new DOMParser).parseFromString('<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5"><path d="M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268" fill="none" stroke="currentColor"/><path d="M10.5 3.5v12" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-dasharray="1,2,0,0"/><path d="M5.5 13.5V6" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-width=".9969299999999999" stroke-dasharray="1.71,3.43,0,0"/><path d="M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z" fill="currentColor"/><path d="M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z" fill="currentColor"/></svg>',"text/xml").documentElement,availableOptions:["arcStyle","flip1D","labelPosition","labelColor","labelTextOpacity","labelBackgroundOpacity","strokeColor","strokeWidth","trackBorderWidth","trackBorderColor"],defaultOptions:{arcStyle:"ellipse",flip1D:"no",labelColor:"black",labelPosition:"hidden",strokeColor:"black",strokeWidth:1,trackBorderWidth:0,trackBorderColor:"black"},optionsInfo:{arcStyle:{name:"Arc Style",inlineOptions:{circle:{name:"Circle",value:"circle"},ellipse:{name:"Ellipse",value:"ellipse"}}}}};var De=Fe,Ne="\nprecision mediump float;\nattribute vec2 aPosition;\nattribute float aColorIdx;\nattribute float aFocused;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform sampler2D uColorMapTex;\nuniform float uColorMapTexRes;\nuniform sampler2D uColorMapFocusTex;\nuniform float uColorMapFocusTexRes;\n\nvarying vec4 vColor;\nvarying vec4 vColorFocused;\nvarying float vFocused;\n\nvoid main(void)\n{\n  // Half a texel (i.e., pixel in texture coordinates)\n  float eps = 0.5 / uColorMapTexRes;\n  float colorRowIndex = floor((aColorIdx + eps) / uColorMapTexRes);\n  vec2 colorTexIndex = vec2(\n    (aColorIdx / uColorMapTexRes) - colorRowIndex + eps,\n    (colorRowIndex / uColorMapTexRes) + eps\n  );\n  vColor = texture2D(uColorMapTex, colorTexIndex);\n\n  float eps2 = 0.5 / uColorMapFocusTexRes;\n  float colorRowIndex2 = floor((aColorIdx + eps2) / uColorMapFocusTexRes);\n  vec2 colorTexIndex2 = vec2(\n    (aColorIdx / uColorMapFocusTexRes) - colorRowIndex2 + eps2,\n    (colorRowIndex2 / uColorMapFocusTexRes) + eps2\n  );\n  vColorFocused = texture2D(uColorMapFocusTex, colorTexIndex2);\n\n  vFocused = aFocused;\n\n  gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n}\n",ze="\n  precision mediump float;\n\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vFocused;\n\n  void main() {\n    float isNotFocused = 1.0 - vFocused;\n\n    float r = vColor.r * isNotFocused + vColorFocused.r * vFocused;\n    float g = vColor.g * isNotFocused + vColorFocused.g * vFocused;\n    float b = vColor.b * isNotFocused + vColorFocused.b * vFocused;\n\n    gl_FragColor = vec4(r, g, b, 1.0);\n  }\n",Le=["#c76526","#dca237","#eee462","#469b76","#3170ad","#6fb2e4","#000000","#999999"],He=["#a65420","#b7872e","#9f9841","#3a8162","#295d90","#4a7798","#000000","#666666"],Ge=["#f6e5db","#f9f0de","#fcfbe5","#e0eee8","#dde7f1","#e7f2fb","#d5d5d5","#ffffff"],Be=function(t){return t.tileData.length&&void 0!==t.tileData[0].yStart},We=function(t){return t.xStart},Ve=function(t){return t.xStart+(t.xEnd-t.xStart)/2},Xe=function(t){return t.xEnd},Ue=function(t){return t.yStart+(t.yEnd-t.yStart)/2},Ye=function(t){return t.reduce((function(t,e){return Math.max(t,e.histogramMax)}),0)},Je=function(t,e,i){var o=(i.domain()[1]-i.domain()[0])/(e.domain()[1]-e.domain()[0]),a=e.domain().map(i)[0];t.scale.x=o,t.position.x=-a*o},Ke=function(t){return[t.xStart,t.yStart,t.xEnd,t.yStart,t.xEnd,t.yEnd,t.xStart,t.yStart,t.xStart,t.yEnd,t.xEnd,t.yEnd]},Qe=function(t){return[t.colorIdx,t.colorIdx,t.colorIdx,t.colorIdx,t.colorIdx,t.colorIdx]},qe=function(t){return[t.focused,t.focused,t.focused,t.focused,t.focused,t.focused]},Ze=function t(e){if(!(this instanceof t?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var i=e.libraries.PIXI,o=e.libraries.d3Scale,a=o.scaleLinear,n=o.scaleLog,r=e.services.tileProxy,s=e.utils.colorToHex,c=n().domain([1,10]).range([.1,1]).clamp(!0),h=function(t){return e.utils.colorToRgba(t).slice(0,3).map((function(t){return Math.min(1,Math.max(0,t/255))}))},u=function(t){Object(zt.a)(o,t);var e=Object(Lt.a)(o);function o(t,i){var a;return Object(It.a)(this,o),(a=e.call(this,t,i)).updateOptions(),a}return Object(jt.a)(o,[{key:"initTile",value:function(t){var e=Be(t),i=e?Ve:We,o=e?Ue:Xe;t.tileData.forEach((function(t){t.start=i(t),t.end=o(t),t.isLeftToRight=t.start<t.end})),t.histogramMax=0,this.updateTileFocusMap(t)}},{key:"updateTileHistogram",value:function(t){var e=this,i=this.getTilePosAndDimensions(t.tileData.zoomLevel,t.tileData.tilePos),o=i.tileX,a=i.tileWidth/this.numBins;t.binXPos=new Float32Array(this.numBins+1),t.histogram1d=new Float32Array(this.numBins),t.histogram2d=new Float32Array(this.numBins*this.numGroups),t.histogram2dNumPred=new Uint8Array(this.numBins*this.numGroups);for(var n=0,r=0;r<=this.numBins;r++)t.binXPos[r]=o+a*r;var s=new Map;t.tileData.forEach((function(i){for(var r=e.categoryToGroup.get(i.fields[e.categoryField].toLowerCase()),l=e.numBins-1,c=Math.max(0,Math.min(l,Math.round((i.xStart-o)/a))),h=Math.max(0,Math.min(l,Math.round((i.xEnd-o)/a))),u=Math.abs(h-c),d=e.getImportance(i),p=e.getCategory(i),f=r*e.numBins,m=0;m<=u;m++){var g=c+m,v=f+g,b=s.get(p)||{};b[g]||(b[g]=b[g]||d>0,t.histogram2dNumPred[v]+=b[g],s.set(p,b)),t.histogram2d[v]+=d,t.histogram1d[g]+=d,n=Math.max(n,t.histogram1d[g])}})),t.histogramMax=n}},{key:"updateHistograms",value:function(){Object.values(this.fetchedTiles).forEach(this.updateTileHistogram.bind(this))}},{key:"updateTileFocusMap",value:function(t){t.focusMap=new Float32Array(this.numBins);var e=this.getTilePosAndDimensions(t.tileData.zoomLevel,t.tileData.tilePos),i=e.tileX,o=e.tileWidth;if(i<=this.focusRegion[1]&&i+o>=this.focusRegion[0])for(var a=o/this.numBins,n=Math.max(0,Math.round((this.focusRegion[0]-i)/a)),r=Math.min(this.numBins-1,Math.round((this.focusRegion[1]-i)/a)),s=Math.abs(r-n),l=0;l<=s;l++)t.focusMap[l]=1}},{key:"updateFocusMap",value:function(){Object.values(this.fetchedTiles).forEach(this.updateTileFocusMap.bind(this))}},{key:"updateStratificationOption",value:function(){var t=this;if(!this.options.stratification)return this.categoryField=void 0,this.categoryToGroup=void 0,this.groupToColor=void 0,this.numGroups=0,this.numCategories=0,void(this.groupLabels=[]);this.categoryField=this.options.stratification.categoryField,this.getCategory=function(e){return e.fields[t.categoryField].toLowerCase()},this.categoryToGroup=new Map,this.categoryToY=new Map,this.groupToColor=new Map,this.numGroups=this.options.stratification.groups.length,this.groupSizes=this.options.stratification.groups.map((function(t){return t.categories.length})),this.numCategories=this.groupSizes.reduce((function(t,e){return t+e}),0),this.groupLabels=this.options.stratification.groups.map((function(t,e){return t.label||"Group ".concat(e)}));var e=0;this.options.stratification.groups.forEach((function(i,o){t.groupToColor.set(o,[s(i.color||Le[o%Le.length]),s(i.backgroundColor||Ge[o%Ge.length])]),i.categories.forEach((function(i,a){t.categoryToGroup.set(i.toLowerCase(),o),t.categoryToY.set(i.toLowerCase(),e+a)})),e+=i.categories.length})),this.groupLabelsPixiText=this.groupLabels.map((function(e,o){return new i.Text(e,{fontSize:t.labelSize,align:"right"===t.axisAlign?"right":"left",fill:s(t.options.stratification.groups[o].axisLabelColor||He[o%He.length])})}))}},{key:"updateOptions",value:function(){var t=this;this.axisAlign=this.options.axisAlign||"left",this.labelColor=s(this.options.labelColor||"black"),this.labelSize=this.options.labelSize||12,this.colorMap=this.options.colorMap||[].concat(Le),this.colorMapRgbNorm=this.colorMap.map(h);var e=rt(i,this.colorMapRgbNorm),o=Object(l.a)(e,2);this.colorMapTex=o[0],this.colorMapTexRes=o[1],this.colorMapFocus=this.options.colorMapFocus||[].concat(He),this.colorMapFocusRgbNorm=this.colorMapFocus.map(h);var n=rt(i,this.colorMapFocusRgbNorm),r=Object(l.a)(n,2);this.colorMapFocusTex=r[0],this.colorMapFocusTexRes=r[1],this.markColor=s(this.options.markColor||"black"),this.markColorRgbNorm=this.options.markColor?h(this.options.markColor):[0,0,0],this.markOpacity=Number.isNaN(+this.options.markOpacity)?1:Math.min(1,Math.max(0,+this.options.markOpacity)),this.markSize=this.options.markSize||2,this.markColorFocus=s(this.options.markColorFocus||"red"),this.markColorFocusRgbNorm=this.options.markColorFocus?h(this.options.markColorFocus):[1,0,0],this.markOpacityFocus=Number.isNaN(+this.options.markOpacityFocus)?this.markOpacity:Math.min(1,Math.max(0,+this.options.markOpacityFocus)),this.markSizeFocus=this.options.markSizeFocus||this.markSize,this.binSize=this.options.binSize||8,this.numBins=this.tilesetInfo?Math.round(this.tilesetInfo.tile_size/this.binSize):1024/this.binSize,this.getImportance=this.options.importanceField?function(e){return+e.fields[t.options.importanceField]}:function(){return 1};var u=this.options.importanceDomain||[1e3,1],d=a().domain(u).range([1,10]);this.opacityScale=function(t){return c(d(t))},this.focusRegion=this.options.focusRegion?this.options.focusRegion:[1/0,1/0],this.focusGene=this.options.focusGene?this.options.focusGene.toLowerCase():void 0,this.getGene=this.options.geneField?function(e){return e.fields[t.options.geneField].toLowerCase()}:void 0,this.minImportance=this.options.minImportance||0,this.updateStratificationOption(),this.updateFocusMap(),this.updateHistograms(),this.updateScales()}},{key:"refreshTiles",value:function(){for(var t,e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];if((t=Object(Dt.a)(Object(Nt.a)(o.prototype),"refreshTiles",this)).call.apply(t,[this].concat(i)),this.tilesetInfo){var n=this.numBins;this.numBins=Math.round(this.tilesetInfo.tile_size/this.binSize),n!==this.numBins&&(this.updateHistograms(),this.updateScales())}}},{key:"rerender",value:function(t){this.options=t,this.updateOptions(),this.updateExistingGraphics()}},{key:"updateScales",value:function(){var t=Object.values(this.fetchedTiles);if(t.length){var e=Object(l.a)(this.dimensions,2)[1];this.histMax=Ye(t),this.heightScale=a().domain([0,this.histMax]).range([e,0]),this.valueScale=this.heightScale,this.valueScaleInverted=a().domain([0,this.histMax]).range([0,e])}}},{key:"itemToPoint",value:function(t){return{xStart:this._xScale(t.start),xEnd:this._xScale(t.start),yStart:this.heightScale(this.categoryToY.get(t.fields[this.categoryField].toLowerCase())),yEnd:function(){},opacity:this.opacityScale(this.getImportance(t)),focused:t.xStart<=this.focusRegion[1]&&t.xEnd>=this.focusRegion[0]}}},{key:"histToSegments",value:function(t){for(var e=[],i=0;i<this.numBins;i++){var o=0;if(t.histogram1d[i]>0)for(var a=0;a<this.numGroups;a++){var n=t.histogram2d[a*this.numBins+i];n&&(e.push({xStart:this._xScale(t.binXPos[i]),xEnd:this._xScale(t.binXPos[i+1]),yStart:this.heightScale(o),yEnd:this.heightScale(o+n),colorIdx:a%this.colorMap.length,focused:t.focusMap[i]}),o+=n)}}return e}},{key:"renderStackedBars",value:function(){this.drawnAtScale=a().domain(Object(k.a)(this.xScale().domain())).range(Object(k.a)(this.xScale().range()));var t=Object.values(this.fetchedTiles).flatMap(this.histToSegments.bind(this)),e=new Float32Array(t.flatMap(Ke)),o=new Float32Array(t.flatMap(Qe)),n=new Float32Array(t.flatMap(qe)),r=new i.UniformGroup({uColorMapTex:this.colorMapTex,uColorMapTexRes:this.colorMapTexRes,uColorMapFocus:this.colorMapFocusTex,uColorMapFocusTexRes:this.colorMapFocusTexRes}),s=i.Shader.from(Ne,ze,r),l=new i.Geometry;l.addAttribute("aPosition",e,2),l.addAttribute("aColorIdx",o,1),l.addAttribute("aFocused",n,1);var c=new i.Mesh(l,s,new i.State,i.DRAW_MODES.TRIANGLES),h=new i.Graphics;h.addChild(c),this.pMain.x=this.position[0],this.indicatorPointGraphics&&this.pMain.removeChild(this.indicatorPointGraphics),this.pMain.addChild(h),this.indicatorPointGraphics=h,Je(this.indicatorPointGraphics,this._xScale,this.drawnAtScale),this.draw(),this.animate()}},{key:"renderTrack",value:function(){this.drawAxis(this.valueScaleInverted),this.renderStackedBars()}},{key:"hasFetchedTiles",value:function(){return Object.values(this.fetchedTiles).length}},{key:"updateExistingGraphics",value:function(){this.hasFetchedTiles()&&(this.updateHistograms(),this.updateScales(),this.renderTrack())}},{key:"getMouseOverHtml",value:function(t,e){if(!this.tilesetInfo)return"";var i=this.calculateZoomLevel(),o=r.calculateTileWidth(this.tilesetInfo,i,this.tilesetInfo.tile_size),a=this._xScale.invert(t)/o,n=Math.floor(a),s=this.tileToLocalId([i,n]),c=this.fetchedTiles[s];if(!c)return"";for(var h=a-n,u=Math.floor(this.numBins*h),d=[],p=[],f=0,m=0,g=0;g<this.numGroups;g++){m+=c.histogram2d[g*this.numBins+u];var v=c.histogram2dNumPred[g*this.numBins+u];p.push(v),f+=v,d.push(m)}var b=this.heightScale.invert(e),y=d.findIndex((function(t){return t>b}));if(y>=0){var x=this.groupToColor.get(y),w=Object(l.a)(x,2),k=w[0],C=w[1],S="#".concat(k.toString(16)),O="#".concat(C.toString(16)),_=c.histogram2dNumPred[y*this.numBins+u];return'<div style="margin: -0.25rem; padding: 0 0.25rem; background: '.concat(O,'"><strong style="color: ').concat(S,';">').concat(this.groupLabels[y],":</strong> ").concat(_," of ").concat(f," samples</div>")}return""}},{key:"setPosition",value:function(t){Object(Dt.a)(Object(Nt.a)(o.prototype),"setPosition",this).call(this,t);var e=Object(l.a)(this.position,2);this.pMain.position.x=e[0],this.pMain.position.y=e[1]}},{key:"zoomed",value:function(t,e){this.xScale(t),this.yScale(e),this.indicatorPointGraphics&&Je(this.indicatorPointGraphics,t,this.drawnAtScale),this.refreshTiles(),this.draw()}},{key:"exportSVG",value:function(){var t=this,e=null,i=null,a=Object(Dt.a)(Object(Nt.a)(o.prototype),"superSVG",this).call(this),n=Object(l.a)(a,2);i=n[0],e=n[1],i.setAttribute("class","exported-arcs-track");var r=document.createElement("g");e.appendChild(r),r.setAttribute("transform","translate(".concat(this.position[0],",").concat(this.position[1],")"));var s=this.options.strokeColor?this.options.strokeColor:"blue",c=this.options.strokeWidth?this.options.strokeWidth:2;return this.visibleAndFetchedTiles().forEach((function(e){t.polys=[],t.drawTile(e,!0);var i,o=Object(qt.a)(t.polys);try{for(o.s();!(i=o.n()).done;){var a=i.value,n=a.polyStr,l=a.opacity,h=document.createElement("path");h.setAttribute("fill","transparent"),h.setAttribute("stroke",s),h.setAttribute("stroke-width",c),h.setAttribute("opacity",l),h.setAttribute("d",n),r.appendChild(h)}}catch(u){o.e(u)}finally{o.f()}})),[i,e]}}]),o}(e.tracks.HorizontalLine1DPixiTrack),d=arguments.length,p=new Array(d>1?d-1:0),f=1;f<d;f++)p[f-1]=arguments[f];return Object(Rt.a)(u,p)};Ze.config={type:"stacked-bar",datatype:["bedlike"],orientation:"1d",name:"Arcs1D",thumbnail:(new DOMParser).parseFromString('<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5"><path d="M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268" fill="none" stroke="currentColor"/><path d="M10.5 3.5v12" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-dasharray="1,2,0,0"/><path d="M5.5 13.5V6" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-width=".9969299999999999" stroke-dasharray="1.71,3.43,0,0"/><path d="M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z" fill="currentColor"/><path d="M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z" fill="currentColor"/></svg>',"text/xml").documentElement,availableOptions:["arcStyle","flip1D","labelPosition","labelColor","labelTextOpacity","labelBackgroundOpacity","strokeColor","strokeWidth","trackBorderWidth","trackBorderColor"],defaultOptions:{arcStyle:"ellipse",flip1D:"no",labelColor:"black",labelPosition:"hidden",strokeColor:"black",strokeWidth:1,trackBorderWidth:0,trackBorderColor:"black"},optionsInfo:{arcStyle:{name:"Arc Style",inlineOptions:{circle:{name:"Circle",value:"circle"},ellipse:{name:"Ellipse",value:"ellipse"}}}}};var $e=Ze,ti=i(191);function ei(t){if(!(this instanceof ei?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var e=function(t){Object(zt.a)(i,t);var e=Object(Lt.a)(i);function i(t,o){var a;Object(It.a)(this,i),a=e.call(this,t,o);var n=Object(ti.a)(),r=n.publish,s=n.subscribe,l=n.unsubscribe;return a.publish=r,a.subscribe=s,a.unsubscribe=l,a}return Object(jt.a)(i,[{key:"drawPoly",value:function(t,e,i,o){var a=[e,o,i,o,i,this.dimensions[1],e,this.dimensions[1]],n=1,r=2;return t.rectGraphics.drawCircle(e,this.finalDotYPos(o,n),r),a}},{key:"renderRows",value:function(t,e,i,o,a,n){var r=this,s=+t.tileId.split(".")[0];this.initialize();for(var l=this.options.focusRegion||[1/0,1/0],c=[],h=[],u=0;u<e.length;u++){for(var d=0;d<e[u].length;d++){var p=e[u][d].value,f=p.fields,m=+p.chrOffset,g=+f[1]+m,v=+f[2]+m,b=this._xScale(g),y=this._xScale(v);if(!(s in this.drawnRects)||!(p.uid in this.drawnRects[s])){this.drawnRects[s]||(this.drawnRects[s]={});var x={xStartScreen:b,xEndScreen:y,xStartAbs:g,xEndAbs:v,data:p};g<=l[1]&&v>=l[0]?h.push(x):c.push(x)}}c.forEach((function(t){r.publish("annotationDrawn",t)}))}}},{key:"rerender",value:function(){this.draw(),this.pubSub.publish("TiledPixiTrack.tilesDrawnEnd",{uuid:this.uuid})}},{key:"getMouseOverHtml",value:function(){return""}}]),i}(t.tracks.BedLikeTrack),i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return Object(Rt.a)(e,o)}ei.config={type:"tss",datatype:["bedlike"]};var ii=ei;i(320);Object(o.a)({track:Qt,config:Qt.config}),Object(o.a)({track:Pe,config:Pe.config}),Object(o.a)({track:ve,config:ve.config}),Object(o.a)({track:De,config:De.config}),Object(o.a)({track:$e,config:$e.config}),Object(o.a)({track:ii,config:ii.config}),Object(o.a)({track:Ft,config:Ft.config,isMetaTrack:!0}),s.a.render(n.a.createElement(At,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[210,1,2]]]);
//# sourceMappingURL=main.5d76cf30.chunk.js.map