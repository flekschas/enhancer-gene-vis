(this["webpackJsonpenhancer-gene-vis"]=this["webpackJsonpenhancer-gene-vis"]||[]).push([[0],{313:function(t,e,i){t.exports=i(427)},407:function(t,e,i){},419:function(t,e,i){},421:function(t,e,i){},422:function(t,e,i){},424:function(t,e,i){},427:function(t,e,i){"use strict";i.r(e);var a=i(72),n=i(0),o=i.n(n),r=i(15),s=i.n(r),l=i(10),c=i(106),u=i(19),h=i(230),d=i(483),p=i(468),m=i(470),g=i(466),f=Object(g.a)((function(t){return{backdrop:{zIndex:t.zIndex.drawer+1,color:"#bbb",backgroundColor:"#fff"}}})),v=function(){var t=f();return o.a.createElement("div",{className:"full-wh"},o.a.createElement(p.a,{className:t.backdrop,open:!0},o.a.createElement(m.a,{color:"inherit"})))},b=(i(407),function(){return o.a.createElement("div",{className:"full-wh app-error"},o.a.createElement("span",null,"Failed to initialize!"))}),x=i(24),y=i.n(x),w=i(70),k=i(16),C=i(478),E=i(484),S=i(476),O=i(477),T=i(480),A=i(490),M=i(428),_=i(488),j=i(474),R=i(429),I=i(472),N=i(431),L=i(471),z=i(435),P=i(489),D=i(475),F=i(491),H=i(481),G=i(479),B=i(235),W=i(430),V=i(139),q=i.n(V),U=i(181),X=i.n(U),Y=i(110),J=i.n(Y),Z=i(36),K=i.n(Z),Q=i(37),$=i.n(Q),tt=i(227),et=i.n(tt),it=i(482),at=i(34),nt=i(39),ot=i(487),rt=i(178),st=i.n(rt),lt=i(177),ct=i.n(lt),ut=i(176),ht=i.n(ut),dt=i(473);function pt(t,e){var i=Object(n.useState)(t),a=Object(l.a)(i,2),o=a[0],r=a[1];return Object(n.useEffect)((function(){var i=setTimeout((function(){r(t)}),e);return function(){clearTimeout(i)}}),[t,e]),o}var mt=Object(g.a)((function(t){return{root:{position:"relative"},checkbox:{marginTop:-4,marginBottom:-4},checkboxLabel:{fontSize:"0.9rem",marginLeft:-4},nestedCheckbox:{marginLeft:4}}}));function gt(t){var e=t.options,i=void 0===e?[]:e,a=t.groupColorsDark,r=void 0===a?[]:a,s=t.groupColorsLight,c=void 0===s?[]:s,u=Object(n.useState)({}),h=Object(l.a)(u,2),d=h[0],p=h[1],m=Object(n.useState)({}),g=Object(l.a)(m,2),f=g[0],v=g[1],b=Object(n.useState)({}),x=Object(l.a)(b,2),y=x[0],w=x[1],C=Object(n.useState)(""),E=Object(l.a)(C,2),S=E[0],O=E[1],T=pt(S,250),A=mt(),M=Object(n.useMemo)((function(){return i.length>0&&i[0].options}),[i]),R=Object(n.useMemo)((function(){return M?i.reduce((function(t,e){return t[e.name]=e.options,t}),{}):null}),[M,i]),N=Object(n.useMemo)((function(){return M?Object(k.a)(i.flatMap((function(t){return t.options}))):i}),[M,i]);Object(n.useEffect)((function(){if(""!==T){var t=T.toLowerCase();w(N.reduce((function(e,i){return i.toLowerCase().indexOf(t)>=0&&(e[i]=!0),e}),{}))}else w({})}),[N,T]);var z=Object(n.useCallback)((function(t){var e=Object(nt.a)({},f);R[t.target.name].forEach((function(i){e[i]=t.target.checked})),p(Object(nt.a)(Object(nt.a)({},d),{},Object(at.a)({},t.target.name,t.target.checked))),v(e)}),[R,f,d]),D=Object(n.useCallback)((function(t){v(Object(nt.a)(Object(nt.a)({},f),{},Object(at.a)({},t.target.name,t.target.checked)))}),[f]),F=Object(n.useCallback)((function(t){O(t.target.value)}),[]),H=""===T;return o.a.createElement("div",{className:A.root},o.a.createElement(_.a,{variant:"outlined",margin:"dense",fullWidth:!0},o.a.createElement(L.a,{htmlFor:"filter"},o.a.createElement(I.a,{container:!0,direction:"row",alignItems:"center"},o.a.createElement(ht.a,{fontSize:"small"}),o.a.createElement("span",{style:{marginLeft:3}},"Filter"))),o.a.createElement(P.a,{id:"filter",label:o.a.createElement(I.a,{container:!0,direction:"row",alignItems:"center"},o.a.createElement(ht.a,{fontSize:"small"}),o.a.createElement("span",{style:{marginLeft:3}},"Filter")),onChange:F,value:S})),M&&o.a.createElement(dt.a,null,i.map((function(t,e){return o.a.createElement(o.a.Fragment,{key:t.name},o.a.createElement(j.a,{className:A.checkbox,control:o.a.createElement(ot.a,{style:{color:(d[t.name]?r[e%r.length]:c[e%c.length])||"inherit"},icon:o.a.createElement(ct.a,{fontSize:"small"}),checkedIcon:o.a.createElement(st.a,{fontSize:"small"}),checked:!!d[t.name],onChange:z,name:t.name}),label:o.a.createElement(W.a,{className:A.checkboxLabel,noWrap:!0,style:{color:r[e%r.length]||"inherit"}},o.a.createElement("strong",null,t.name)," ",o.a.createElement("span",null,"(",t.options.filter((function(t){return H||y[t]})).length,")"))}),t.options.filter((function(t){return H||y[t]})).map((function(t){return o.a.createElement(j.a,{key:t,className:"".concat(A.checkbox," ").concat(A.nestedCheckbox),control:o.a.createElement(ot.a,{style:{color:(f[t]?r[e%r.length]:c[e%c.length])||"inherit"},icon:o.a.createElement(ct.a,{fontSize:"small"}),checkedIcon:o.a.createElement(st.a,{fontSize:"small"}),checked:!!f[t],onChange:D,name:t}),label:o.a.createElement(W.a,{className:A.checkboxLabel,noWrap:!0,style:{color:r[e%r.length]||"inherit"}},t)})})))}))))}var ft=i(30),vt=i(49),bt=i(179),xt=1e-6,yt=["#c76526","#6fb2e4","#eee462","#469b76","#3170ad","#dca237","#000000","#999999"],wt=["#a65420","#4a7798","#999026","#3a8162","#295d90","#b7872e","#000000","#666666"],kt=["#f6e5db","#e7f2fb","#f2eda9","#e0eee8","#dde7f1","#f5e4c4","#d5d5d5","#ffffff"],Ct="https://higlass.io/api/v1/suggest/?d=OHJakQICQD6gTD7skx4EWA",Et="https://resgen.io/api/v1/suggest/?d=VF5-RDXWTxidGMJU7FeaxA",St={categoryField:10,axisShowGroupSeparator:!0,axisNoGroupColor:!1,groups:[{label:"Mononuclear Phagocytes",categories:["THP1_LPS_4hr-Engreitz","THP_pmaLPS_ATAC_6h","CD14-positive_monocyte_treated_with_LPS_4h-Novakovic2016","CD14-positive_monocyte_treated_with_BG_1h-Novakovic2016","CD14-positive_monocyte_treated_with_RPMI_d6-Novakovic2016","THP1-Engreitz","THP_pmaLPS_ATAC_96h","CD14-positive_monocyte_treated_with_BG_d1-Novakovic2016","THP_pmaLPS_ATAC_72h","THP-1_monocyte-VanBortle2017","CD14-positive_monocyte_treated_with_LPS_d1-Novakovic2016","CD14-positive_monocyte-ENCODE","THP_pmaLPS_ATAC_2h","dendritic_cell_treated_with_Lipopolysaccharide_0_ng-mL_for_0_hour-Garber2017","CD14-positive_monocyte_treated_with_RPMI_1h-Novakovic2016","U937_LPS_4hr-Engreitz","CD14-positive_monocyte-Novakovic2016","dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_6_hour-Garber2017","CD14-positive_monocyte_treated_with_BG_4h-Novakovic2016","THP_pmaLPS_ATAC_0h","HAP1","THP-1_macrophage-VanBortle2017","dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_1_hour-Garber2017","U937-Engreitz","CD14-positive_monocyte_treated_with_RPMI_d1-Novakovic2016","CD14-positive_monocyte_treated_with_RPMI_4h-Novakovic2016","CD14-positive_monocyte_treated_with_LPS_d6-Novakovic2016","CD14-positive_monocyte_treated_with_LPS_1h-Novakovic2016","THP_pmaLPS_ATAC_24h","THP_pmaLPS_ATAC_1h","dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_2_hour-Garber2017","CD14-positive_monocyte_treated_with_BG_d6-Novakovic2016","dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_30_minute-Garber2017","THP_pmaLPS_ATAC_120h","dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_4_hour-Garber2017","THP_pmaLPS_ATAC_48h","CD14-positive_monocytes-Roadmap","THP_pmaLPS_ATAC_12h"]},{label:"B Cells",categories:["Karpas-422-ENCODE","BJAB-Engreitz","BJAB_anti-IgM_anti-CD40_4hr-Engreitz","B_cell-ENCODE","OCI-LY7-ENCODE","GM12878-Roadmap","MM.1S-ENCODE","CD19-positive_B_cell-Roadmap","CD8-positive_alpha-beta_T_cell-ENCODE"]},{label:"T Cells",categories:["Jurkat_anti-CD3_PMA_4hr-Engreitz","Jurkat-Engreitz","CD3-positive_T_cell-Roadmap","CD4-positive_helper_T_cell-ENCODE","CD8-positive_alpha-beta_T_cell-Corces2016","thymus_fetal-Roadmap","CD4-positive_helper_T_cell-Corces2016","T-cell-ENCODE"]},{label:"Other haematopoietic cells",categories:["spleen-ENCODE","K562-Roadmap","CD56-positive_natural_killer_cells-Roadmap","erythroblast-Corces2016","CD34-positive_mobilized-Roadmap","megakaryocyte-erythroid_progenitor-Corces2016","natural_killer_cell-Corces2016","IMR90-Roadmap"]},{label:"Fibroblasts",categories:["foreskin_fibroblast-Roadmap","fibroblast_of_dermis-Roadmap","fibroblast_of_arm-ENCODE","astrocyte-ENCODE","fibroblast_of_lung-Roadmap"]},{label:"Epithelial",categories:["small_intestine_fetal-Roadmap","epithelial_cell_of_prostate-ENCODE","HCT116-ENCODE","MCF-7-ENCODE","adrenal_gland_fetal-ENCODE","H7","keratinocyte-Roadmap","MCF10A-Ji2017","pancreas-Roadmap","mammary_epithelial_cell-Roadmap","stomach-Roadmap","LoVo","A549_treated_with_ethanol_0.02_percent_for_1_hour-Roadmap","PC-9-ENCODE","H1-hESC-Roadmap","thyroid_gland-ENCODE","HT29","MDA-MB-231","iPS_DF_19.11_Cell_Line-Roadmap","large_intestine_fetal-Roadmap","Panc1-ENCODE","adrenal_gland-ENCODE","MCF10A_treated_with_TAM24hr-Ji2017","trophoblast_cell-ENCODE","H1_BMP4_Derived_Trophoblast_Cultured_Cells-Roadmap","uterus-ENCODE","body_of_pancreas-ENCODE","stomach_fetal-Roadmap","H9-Roadmap","transverse_colon-ENCODE","H1_BMP4_Derived_Mesendoderm_Cultured_Cells-Roadmap","breast_epithelium-ENCODE","induced_pluripotent_stem_cell-ENCODE","LNCAP","H1_Derived_Mesenchymal_Stem_Cells-Roadmap","ovary-Roadmap","sigmoid_colon-ENCODE","skeletal_muscle_myoblast-Roadmap","bipolar_neuron_from_iPSC-ENCODE","coronary_artery_smooth_muscle_cell-Miller2016","SK-N-SH-ENCODE","muscle_of_trunk_fetal-Roadmap"]},{label:"Other",categories:["adipose_tissue-ENCODE","HeLa-S3-Roadmap","hepatocyte-ENCODE","heart_ventricle-ENCODE","spinal_cord_fetal-ENCODE","coronary_artery-ENCODE","HepG2-Roadmap","muscle_of_leg_fetal-Roadmap","gastrocnemius_medialis-ENCODE","brite_adipose-Loft2014","placenta-Roadmap","liver-ENCODE","A673-ENCODE","white_adipose-Loft2014","cardiac_muscle_cell-ENCODE","osteoblast-ENCODE","H1_Derived_Neuronal_Progenitor_Cultured_Cells-Roadmap","endothelial_cell_of_umbilical_vein-Roadmap","NCCIT","myotube_originated_from_skeletal_muscle_myoblast-Roadmap","psoas_muscle-Roadmap","endothelial_cell_of_umbilical_vein_vegf_stim_4_hours-zhang2013","endothelial_cell_of_umbilical_vein_vegf_stim_12_hours-zhang2013"]}]},Ot={editable:!1,trackSourceServers:["//higlass.io/api/v1"],views:[{uid:"context",genomePositionSearchBox:{autocompleteServer:"//higlass.io/api/v1",autocompleteId:"OHJakQICQD6gTD7skx4EWA",chromInfoServer:"//higlass.io/api/v1",chromInfoId:"hg19",visible:!0},chromInfoPath:"//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv",tracks:{top:[{type:"combined",uid:"chroms-viewport",height:12,contents:[{type:"horizontal-chromosome-labels",options:{color:"#999999",stroke:"white",fontSize:10,fontIsLeftAligned:!0,showMousePosition:!1,mousePositionColor:"#000000"},tilesetUid:"ADfY_RtsQR6oKOMyrq6qhw",height:12,server:"https://resgen.io/api/v1",uid:"chroms"},{uid:"viewport-details-chroms",type:"viewport-projection-horizontal",fromViewUid:"details",height:12,options:{projectionFillColor:"#cc0078",projectionStrokeColor:"#cc0078",projectionFillOpacity:.3,projectionStrokeOpacity:.3,strokeWidth:1}}]},{type:"combined",uid:"genes-tss-viewport",height:48,contents:[{type:"horizontal-gene-annotations",uid:"genes",height:48,server:"https://resgen.io/api/v1",tilesetUid:"NCifnbrKQu6j-ohVWJLoJw",options:{fontSize:9,plusStrandColor:"black",minusStrandColor:"black",geneAnnotationHeight:10,geneLabelPosition:"outside",geneStrandSpacing:.5,showMousePosition:!0,showGlobalMousePosition:!0,mousePositionColor:"black"}},{type:"tss",uid:"tss",height:48,server:"https://resgen.io/api/v1",tilesetUid:"VMZDLKrtQDmJMSjg7Ds4yA",options:{fontSize:9,plusStrandColor:"black",minusStrandColor:"black",geneAnnotationHeight:12,geneLabelPosition:"outside",geneStrandSpacing:2}},{uid:"viewport-details-genes",type:"viewport-projection-horizontal",fromViewUid:"details",height:48,options:{projectionFillColor:"#cc0078",projectionStrokeColor:"#cc0078",projectionFillOpacity:.3,projectionStrokeOpacity:.3,strokeWidth:1}}]},{type:"point-annotation",uid:"ibd-snps",server:"https://resgen.io/api/v1",tilesetUid:"VF5-RDXWTxidGMJU7FeaxA",height:32,options:{axisPositionHorizontal:"right",markColor:"black",markColorFocus:"#cc0078",markSize:2,markOpacity:.33,markOpacityFocus:.66,valueColumn:7,focusRegion:[1761419571,1761419621],name:"IBD Variants",labelPosition:"topLeft",labelColor:"#757575",showMousePosition:!0,showGlobalMousePosition:!0,mousePositionColor:"black",toolTip:{name:{field:3},value:{field:6,numDecimals:2},other:[{label:"Post. Prob.",field:7,numDecimals:2}]}}},{type:"stacked-bar",server:"https://resgen.io/api/v1",tilesetUid:"GOxTKzoLSsuw0BaG6eBrXw",height:72,uid:"stacked-bars",options:{binSize:4,axisAlign:"right",axisPositionHorizontal:"right",labelPosition:"hidden",markColor:"black",markColorFocus:"#cc0078",markSize:4,markOpacity:.33,arcStyle:"indicator",indicatorStyle:"category-rect",labelColor:"black",trackBorderWidth:0,trackBorderColor:"black",geneField:6,importanceField:7,importanceDomain:[0,1],focusRegion:[1761419571,1761419621],name:"By Celltype",stratification:St,showMousePosition:!0,showGlobalMousePosition:!0,mousePositionColor:"black"}},{type:"stratified-bed",server:"https://resgen.io/api/v1",tilesetUid:"GOxTKzoLSsuw0BaG6eBrXw",height:413,uid:"indicatorByCellTypes",options:{axisAlign:"right",legendAlign:"left",labelPosition:"hidden",markColor:"black",markColorHighlight:"#bf0071",markColorDehighlight:"#bbbbbb",markSize:4,markMinWidth:4,markHeight:3,rowHeight:3,markOpacity:.33,arcStyle:"indicator",indicatorStyle:"category-rect",labelColor:"black",geneField:6,importanceField:7,importanceDomain:[0,1],name:"By Celltype",axisPositionHorizontal:"right",stratification:St,showMousePosition:!0,showGlobalMousePosition:!0,mousePositionColor:"black"}}]},overlays:[{uid:"region-focus",includes:["chroms-viewport","genes-tss-viewport","ibd-snps","stacked-bars","indicatorByCellTypes"],options:{extent:[[1761419596,1761419597]],minWidth:3,fill:"#cc0078",fillOpacity:.05,strokeWidth:0,outline:"#cc0078",outlineOpacity:.33,outlineWidth:1,outlinePos:["left","right"]}},{uid:"gene-focus",includes:["genes-tss-viewport"],options:{extent:[],minWidth:3,fill:"#cc0078",fillOpacity:.25,stroke:"#cc0078",strokeWidth:0,outlineWidth:0}},{uid:"tss-overlays",includes:["chroms","genes-tss-viewport","ibd-snps","stacked-bars","indicatorByCellTypes"],options:{extent:[],minWidth:1,fill:"black",fillOpacity:.05,strokeWidth:0,outline:"black",outlineOpacity:.1,outlineWidth:1,outlinePos:["left"]}}],metaTracks:[{uid:"tss-overlays-meta",type:"annotation-overlay",overlaysTrack:"tss-overlays",options:{annotationTracks:["tss"]}}],layout:{w:12,h:12,x:0,y:0},initialXDomain:[1761366260,1761603836],initialYDomain:[1761366260,1761603836]}]},Tt={zoomFixed:!1,editable:!1,trackSourceServers:["//higlass.io/api/v1"],views:[{uid:"details",chromInfoPath:"//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv",tracks:{top:[{uid:"chroms",type:"horizontal-chromosome-labels",server:"https://resgen.io/api/v1",tilesetUid:"ADfY_RtsQR6oKOMyrq6qhw",height:17,options:{color:"#999999",stroke:"white",fontSize:10,fontIsLeftAligned:!0,showMousePosition:!1,mousePositionColor:"#000000"}},{uid:"genes",type:"horizontal-gene-annotations",server:"https://resgen.io/api/v1",tilesetUid:"NCifnbrKQu6j-ohVWJLoJw",height:48,options:{fontSize:9,plusStrandColor:"black",minusStrandColor:"black",geneAnnotationHeight:10,geneLabelPosition:"outside",geneStrandSpacing:.5,showMousePosition:!0,showGlobalMousePosition:!0,mousePositionColor:"black"}},{uid:"ibd-snps",type:"point-annotation",server:"https://resgen.io/api/v1",tilesetUid:"VF5-RDXWTxidGMJU7FeaxA",height:32,options:{axisPositionHorizontal:"right",markColor:"black",markColorFocus:"#cc0078",markSize:2,markOpacity:.33,markOpacityFocus:.66,valueColumn:7,focusRegion:[1761419571,1761419621],name:"IBD Variants",labelPosition:"topLeft",labelColor:"#757575",showMousePosition:!0,showGlobalMousePosition:!0,mousePositionColor:"black",toolTip:{name:{field:3},value:{field:6,numDecimals:2},other:[{label:"Post. Prob.",field:7,numDecimals:2}]}}},{uid:"dna-accessibility",type:"ridge-plot",server:"https://resgen.io/api/v1",tilesetUid:"Uz1_tEABQf-uzktblvBKSQ",height:2364,options:{name:"DNA Accessibility",labelPosition:"outerBottom",labelShowResolution:!1,labelShowAssembly:!1,markArea:!0,markColor:"#444444",markResolution:256,valueScaling:"exponential",colorRange:["#ffffff","#000000"],rowHeight:24,rowPadding:-6,rowNormalization:!0,rowSelections:[120,36,54,20,80,35,101,49,44,23,30,66,5,26,15,105,57,56,74,84,79,93,106,107,34,28,25,55,121,94,58,69,67,63,126,71,72,47,11,46,39,113,29,60,45,76,21,103,129,13,128,90,104,32,109,27,9,130,95,86,53,73,50,48,78,14,92,124,31,114,64,88,12,10,38,68,3,111,70,22,61,98,6,123,118,43,37,65,81,62,33,1,24,122,83,75,112,40,97,16,117,87,19,125,7,102,116,77,8,17,82,115,89,119,18,4,108,59,127,91,0,100,85,110,99,2,96,51,41,52,42],rowIdToCategory:{fn:"replace",args:[".accessibility",""]},rowCategories:St.groups.reduce((function(t,e,i){var a={label:e.label,color:e.axisLabelColor,background:e.axisLabelBackground,index:i};return e.categories.forEach((function(e){t[e]=a})),t}),{}),showRowLabels:!0,rowLabelSize:10,showMousePosition:!0,showGlobalMousePosition:!0,mousePositionColor:"black"}}]},overlays:[{uid:"region-focus",includes:["chroms","genes","ibd-snps","dna-accessibility"],options:{extent:[],minWidth:3,fill:"#cc0078",fillOpacity:.05,strokeWidth:0,outline:"#cc0078",outlineOpacity:.33,outlineWidth:1,outlinePos:["left","right"]}}],layout:{w:12,h:12,x:0,y:0},initialXDomain:[1761419096,1761420097],initialYDomain:[1761419096,1761420097]}]},At=i(138),Mt=i.n(At),_t=function(t,e){return t[0]<=e[0]&&t[1]>=e[1]},jt=function(t,e){var i=Math.max(2,Math.ceil(Math.sqrt(e.length))),a=new Float32Array(4*Math.pow(i,2));return e.forEach((function(t,e){a[4*e]=t[0],a[4*e+1]=t[1],a[4*e+2]=t[2],a[4*e+3]=t[3]})),[t.Texture.fromBuffer(a,i,i),i]},Rt=function(t,e,i,a,n){for(var o=i-e,r=Math.sign(o),s=Math.abs(o),l=2*n,c=Math.ceil(s/l),u=0;u<c;u++)t.moveTo(e+u*l*r,a),t.lineTo(e+(u*l+n)*r,a)},It=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.c;return e(Mt.a.parse(window.location.search)[t])},Nt=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.c,a=Mt.a.parse(window.location.search),n=Mt.a.stringify(Object(nt.a)(Object(nt.a)({},a),{},Object(at.a)({},t,i(e))),{strict:!1}),o="".concat(window.location.origin).concat(window.location.pathname,"?").concat(n);window.history.pushState({path:o},"",o)},Lt=function(t,e){var i;if(t.indexOf&&t.indexOf(":")>=0){var a=t.split(":"),n=Object(l.a)(a,2),o=n[0],r=n[1];i=e.chrPositions[o].pos+ +r}else i=+t;return i},zt=function(t,e,i){var a=t.toFixed(e);if(!i){for(;"0"===a[a.length-1];)a=a.substring(0,a.length-1);"."===a[a.length-1]&&(a=a.substring(0,a.length-1))}return a},Pt=function(){var t=[],e=null,i=1,a=[0,1],n=a[1]-a[0],o=[],r=!1,s=0,l=function(t,e){return t+e},c=function(){return e||i},u=function(){n=a[1]-a[0];var e=o.reduce(l,0);i=(n-e)/t.length,s=e+t.length*c()},h=function(e){var i=t.indexOf(e);if(-1!==i)return i*c()+o.slice(0,i+r).reduce(l,0)};return h.domain=function(e){return e?(t=Object(k.a)(e),u(),h):t},h.range=function(t){return t?(a=Object(k.a)(t),u(),h):a},h.bandwidth=function(){return c()},h.fixedBandwidth=function(t){return t?(e=t,u(),h):t},h.totalWidth=function(){return s},h.rangeSize=function(){return n},h.paddingInner=function(t){return t?(o=t,u(),h):o},h.paddingInnerZeroBased=function(t){return t?(r=t,u(),h):r},h};function Dt(t){var e=Object(n.useRef)();return Object(n.useEffect)((function(){e.current=t})),e.current}i(419);var Ft=Object(g.a)((function(t){return{root:{color:t.palette.grey[300],minHeight:"6rem"},plot:{position:"relative",flexGrow:1},plotSvg:{width:"100%",height:"100%"}}})),Ht=kt.map((function(t,e){return Object(g.a)((function(i){return{arrow:{color:t},tooltip:{color:wt[e],backgroundColor:t,boxShadow:"0 0 3px 0 rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(0, 0, 0, 0.05)","& .value":{color:"white",background:wt[e],padding:"0 0.25em",borderRadius:"0.25rem"}}}}))})),Gt=Ot.views[0].tracks.top[3],Bt=Gt.server,Wt=Gt.tilesetUid,Vt=function(){var t=Object(w.a)(y.a.mark((function t(e){var i;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(Bt,"/tiles/?d=").concat(e));case 2:return i=t.sent,t.abrupt("return",i.json());case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),qt={},Ut={};St.groups.forEach((function(t,e){qt[t.label]={name:t.label,size:t.categories.length,index:e},t.categories.forEach((function(e,i){Ut[e]={category:qt[t.label],index:i}}))}));var Xt=function(t){return t.max_width/Math.pow(2,t.max_zoom)},Yt=function(t,e){return t.filter((function(t){return e>=t.xStart&&e<=t.xEnd}))},Jt=function(t,e,i){var a=Math.pow(e,2),n=t.map((function(t){return{y:i(t.value),data:t}})).sort((function(t,e){return t.y-e.y})),o=null,r=null;function s(t,e){for(var i=o;i;){if(a-.001>Math.pow(i.x-t,2)+Math.pow(i.y-e,2))return!0;i=i.next}return!1}var l,c=Object(ft.a)(n);try{for(c.s();!(l=c.n()).done;){for(var u=l.value;o&&o.y<u.y-a;)o=o.next;if(s(u.x=0,u.y)){var h=o;u.x=1/0;do{var d=h.x+Math.sqrt(a-Math.pow(h.y-u.y,2));d<u.x&&!s(d,u.y)&&(u.x=d),h=h.next}while(h)}u.next=null,null===o?o=r=u:r=r.next=u}}catch(p){c.e(p)}finally{c.f()}return n},Zt=function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=a.geneCellEncoding,r=void 0===n?"distribution":n,s=a.prevGeneCellEncoding,c=a.genePadding,h=void 0!==c&&c,d=a.openTooltip,p=void 0===d?u.c:d,m=a.closeTooltip,g=void 0===m?u.c:m,f=a.tooltipClasses,v=void 0===f?[]:f,b=a.position,x=void 0===b?"":b,y=a.variant,w=void 0===y?null:y;if(e&&i){var C=Object(vt.e)(t),E=60,S=60,O=1,T=.5,A=36,M=3,_=1,j=6,R=[0,20],I=Object.values(qt).length*A+E+S;C.attr("viewbox","0 0 ".concat(e," ").concat(I)).attr("height",I);var N=Object.values(i.categoryAggregation).reduce((function(t,e){return Math.max(t,e.numEnhancers)}),0),L=Object(vt.d)().domain([1,N]).range([2,A]).clamp(!0),z=Object(vt.c)().domain([0,1]).range([0,A]).clamp(!0),P=Object(vt.c)().domain([0,1]).range([1,10]).clamp(!0),D=Object(vt.d)().domain([1,10]).range([A-O-_,O+_]),F=function(t){return D(P(t))},H=e/2-A,G=Math.floor(H/A),B=i.genesUpstreamByDist.slice(0,G).reverse(),W=i.genesDownstreamByDist.slice(0,G),V=[].concat(Object(k.a)(B),Object(k.a)(W)).reduce((function(t,e){return[Math.min(t[0],e.relDistance),Math.max(t[1],e.relDistance)]}),[1/0,0]),q=Object(l.a)(V,2),U=q[0],X=q[1],Y=Object(vt.c)().domain([U,X]).range(R),J=h?B.map((function(t){return Math.round(Y(t.relDistance))})):[],Z=Pt().domain(B.map((function(t){return t.name}))).range([0,e/2-A/2]).paddingInner(J),K=h?W.map((function(t){return Math.round(Y(t.relDistance))})):[],Q=Pt().domain(W.map((function(t){return t.name}))).range([0,e/2-A/2]).paddingInner(K).paddingInnerZeroBased(!0),$=Math.min(Z.bandwidth(),Q.bandwidth());Z.fixedBandwidth($),Q.fixedBandwidth($);var tt=Math.max(0,Z.rangeSize()-Z.totalWidth()),et=Math.min(B.reduce((function(t,e){return Math.min(t,e.absDistance)}),1/0),W.reduce((function(t,e){return Math.min(t,e.absDistance)}),1/0)),it=Math.max(B.reduce((function(t,e){return Math.max(t,e.absDistance)}),0),W.reduce((function(t,e){return Math.max(t,e.absDistance)}),0)),at=Object(vt.c)().domain([et,it]).range([2,S]),nt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.isRightAligned,a=void 0!==i&&i;t.attr("fill",(function(t,e){return wt[e%wt.length]})).selectAll("circle").data((function(t){return Jt(t,2*O+T,F)})).join("circle").attr("cx",(function(t){return a?Z.bandwidth()-(t.x+2*_):t.x+O+_})).attr("cy",(function(t){return t.y})).attr("r",O)},ot=function(t){var e=Object.values(t[0].samplesByCategory).reduce((function(t,e){return Math.max(t,e.size)}),0);return Math.ceil(Math.sqrt(e*$/A))},rt=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.instanceCache,n=void 0===a?{}:a,o=i.onMouseEnter,r=void 0===o?u.c:o,s=i.onMouseLeave,l=void 0===s?u.c:s,c=i.tooltipTitleGetter,h=void 0===c?null:c,d=$/e,m=function(t){return t%e*d},f=function(t){return Math.floor(t/e)*d};n.current=t.attr("fill",(function(t,e){return wt[e%wt.length]})).selectAll("rect").data((function(t){return t}),(function(t){return"".concat(t.gene,"|").concat(t.sample)})).join("rect").attr("x",(function(t){return m(Ut[t.sample].index)})).attr("y",(function(t){return f(Ut[t.sample].index)})).attr("width",d).attr("height",d).on("mouseenter",(function(t,e){var i=t.target.getBoundingClientRect(),a=h&&h(e)||e.value.toFixed(3);p(i.x+i.width/2,i.y,a,{arrow:!0,placement:"top",classes:v[qt[e.sampleCategory].index%v.length]}),r(e)})).on("mouseleave",(function(t){g(),l(t)}))},st=function(t){return o.a.createElement(o.a.Fragment,null,"The enhancer overlapping ",o.a.createElement("strong",null,x),w?" (".concat(w,")"):""," is predicted to regulate"," ",o.a.createElement("strong",null,t.gene)," in sample ",o.a.createElement("strong",null,t.sample)," with a score of ",o.a.createElement("strong",{className:"value"},t.value.toFixed(3)),".")},lt={upstream:{current:null},downstream:{current:null}},ct=function(t){var e=function(e){return e.sample===t.sample?1:.2};lt.upstream.current.attr("opacity",e),lt.downstream.current.attr("opacity",e)},ut=function(){lt.upstream.current.attr("opacity",1),lt.downstream.current.attr("opacity",1)},ht=function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=a.cellWidth,o=void 0===n?A:n,r=a.fillColor,s=void 0===r?kt:r,l=a.textColor,c=void 0===l?wt:l,u=a.showText,h=void 0===u||u,d=a.showZero,m=void 0===d||d,f=a.showTooltip,b=void 0!==f&&f,x=a.tooltipTitleGetter,y=void 0===x?null:x,w=t.selectAll(".bg").data((function(t){return[t]})).join("rect").attr("class","bg").attr("fill",(function(t){return s[t.row%s.length]})).attr("x",(function(t){return(o-e(i(t)))/2})).attr("y",(function(t){return(A-e(i(t)))/2})).attr("width",(function(t){return e(i(t))})).attr("height",(function(t){return e(i(t))})).attr("opacity",(function(t){return+(i(t)>0)}));b?w.on("mouseenter",(function(t,e){var a=t.target.getBoundingClientRect(),n=y&&y(e)||i(e);p(a.x+a.width/2,a.y,n,{arrow:!0,placement:"top",classes:v[e.row%v.length]})})).on("mouseleave",(function(){g()})):w.on("mouseenter",null).on("mouseleave",null),h&&t.selectAll(".box-text").data((function(t){return[t]})).join("text").attr("class","box-text").attr("fill",(function(t){return c[t.row%c.length]})).attr("style","font-size: 12px; font-weight: bold;").attr("dominant-baseline","middle").attr("text-anchor","middle").attr("x",o/2).attr("y",A/2).attr("opacity",(function(t){return+(i(t)>0||m)})).text((function(t){return i(t)}))},dt=function(t){return o.a.createElement(o.a.Fragment,null,o.a.createElement("strong",{className:"value"},t.length)," out of ",t.size," ",o.a.createElement("em",null,Object.values(qt)[t.row].name)," samples have predicted enhancer activity.")},pt=C.select("#enhancers").attr("transform","translate(".concat(e/2-A/2,", 0)")),mt=pt.selectAll(".enhancer-gene-aggregate").data(Object.values(i.categoryAggregation).map((function(t,e){return t.row=e,t})),(function(t){return t.category.name})).join("g").attr("class","enhancer-gene-aggregate").attr("transform",(function(t,e){return"translate(0, ".concat(e*A+E,")")}));ht(mt,L,(function(t){return t.numEnhancers})),C.select("#enhancers").selectAll(".enhancer-box-border").data(Object.values(qt),(function(t){return t.name})).join("rect").attr("class","enhancer-box-border").attr("fill","none").attr("stroke",(function(t,e){return kt[e%kt.length]})).attr("stroke-width","1").attr("x",0).attr("y",(function(t,e){return e*A+E})).attr("width",A).attr("height",A);var gt=C.select("#genes-upstream").selectAll(".gene-upstream").data(B,(function(t){return t.name})).join("g").attr("class","gene-upstream").attr("transform",(function(t){return"translate(".concat(tt+Z(t.name),", 0)")})),ft=Z.bandwidth()/2,bt=E-M;gt.selectAll(".gene-upstream-label").data((function(t){return[t]})).join("text").attr("class","gene-label gene-upstream-label").attr("style","font-size: 9px;").attr("transform","translate(".concat(ft,",").concat(bt,") rotate(-90)")).attr("fill","black").attr("dominant-baseline","middle").text((function(t){return t.name}));var xt=gt.selectAll(".gene-upstream-cell").data((function(t){return Object.values(t.samplesByCategory).map((function(t,e){return t.row=e,t}))}),(function(t){return t.name})).join("g").attr("class","gene-upstream-cell").attr("transform",(function(t,e){return"translate(0, ".concat(e*A+E,")")}));switch(r!==s&&xt.selectAll("*").remove(),r){case"distribution":nt(xt,{isRightAligned:!0});break;case"array":rt(xt,ot(B),{tooltipTitleGetter:st,instanceCache:lt.upstream,onMouseEnter:ct,onMouseLeave:ut});break;case"number":case"percent":default:var Ct="percent"===r?z:L,Et="percent"===r?function(t){return t.length/t.size}:function(t){return t.length};ht(xt,Ct,Et,{showText:!1,cellWidth:Z.bandwidth(),fillColor:yt,showTooltip:!0,tooltipTitleGetter:dt})}gt.selectAll(".gene-upstream-border").data(Object.values(qt),(function(t){return t.name})).join("rect").attr("class","gene-upstream-border").attr("fill","none").attr("stroke",(function(t,e){return kt[e%kt.length]})).attr("stroke-width","1").attr("x",0).attr("y",(function(t,e){return e*A+E})).attr("width",Z.bandwidth()).attr("height",A),gt.selectAll(".gene-upstream-distance-bar").data((function(t){return[t]})).join("rect").attr("class","gene-upstream-distance-bar").attr("fill","#bbbbbb").attr("x",Z.bandwidth()/2-j/2).attr("y",Object.values(qt).length*A+E).attr("width",j).attr("height",(function(t){return at(t.absDistance)})),C.select("#genes-downstream").attr("transform","translate(".concat(e/2+A/2,", 0)"));var St=C.select("#genes-downstream").selectAll(".gene-downstream").data(W,(function(t){return t.name})).join("g").attr("class","gene-downstream").attr("transform",(function(t){return"translate(".concat(Q(t.name),", 0)")}));St.selectAll(".gene-downstream-label").data((function(t){return[t]})).join("text").attr("class","gene-label gene-downstream-label").attr("style","font-size: 9px;").attr("transform","translate(".concat(ft,",").concat(bt,") rotate(-90)")).attr("fill","black").attr("dominant-baseline","middle").text((function(t){return t.name}));var Ot=St.selectAll(".gene-downstream-cell").data((function(t){return Object.values(t.samplesByCategory).map((function(t,e){return t.row=e,t}))}),(function(t){return t.name})).join("g").attr("class","gene-downstream-cell").attr("transform",(function(t,e){return"translate(0, ".concat(e*A+E,")")}));switch(r!==s&&Ot.selectAll("*").remove(),r){case"distribution":nt(Ot);break;case"array":rt(Ot,ot(W),{tooltipTitleGetter:st,instanceCache:lt.downstream,onMouseEnter:ct,onMouseLeave:ut});break;case"number":case"percent":default:var Tt="percent"===r?z:L,At="percent"===r?function(t){return t.length/t.size}:function(t){return t.length};ht(Ot,Tt,At,{showText:!1,cellWidth:Q.bandwidth(),fillColor:yt,showTooltip:!0,tooltipTitleGetter:dt})}St.selectAll(".gene-downstream-border").data(Object.values(qt),(function(t){return t.name})).join("rect").attr("class","gene-downstream-border").attr("fill","none").attr("stroke",(function(t,e){return kt[e%kt.length]})).attr("stroke-width","1").attr("x",0).attr("y",(function(t,e){return e*A+E})).attr("width",Q.bandwidth()).attr("height",A),St.selectAll(".gene-downstream-distance-bar").data((function(t){return[t]})).join("rect").attr("class","gene-downstream-distance-bar").attr("fill","#bbbbbb").attr("x",Q.bandwidth()/2-j/2).attr("y",Object.values(qt).length*A+E).attr("width",j).attr("height",(function(t){return at(t.absDistance)}));var Mt=Math.ceil((it-et)/1e5),_t=Math.ceil(Mt/4),jt=Mt<=1?[et,it]:Array(4).fill().map((function(t,e){return 1e5*Math.ceil(et/1e5)+e*(1e5*_t)}));C.select("#gene-distance-axis").attr("transform","translate(0, ".concat(Object.values(qt).length*A+E,")")).call(Object(vt.a)(at).tickSize(e).tickFormat((function(t){var e=(t/1e5).toFixed(0);return this.parentNode.nextSibling?e:"".concat(e," kbps distance to enhancer")})).tickValues(jt)).call((function(t){return t.select(".domain").remove()})).call((function(t){return t.selectAll(".tick line").attr("stroke","#bbbbbb").attr("stroke-width",.5).attr("stroke-dasharray","4,4")})).call((function(t){return t.selectAll(".tick text").attr("fill","#bbbbbb").attr("x",e/2).attr("dy",1).attr("text-anchor","middle").attr("dominant-baseline","hanging")}))}},Kt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.geneCellEncoding,i=t.position,a=t.relPosition,r=t.fullPosition,s=t.genePadding,c=t.openTooltip,u=t.closeTooltip,h=t.styles,d=t.svgRef,p=t.variant,g=Object(n.useState)(null),f=Object(l.a)(g,2),v=f[0],b=f[1],x=Object(n.useState)(null),k=Object(l.a)(x,2),C=k[0],E=k[1],S=Object(n.useState)(null),O=Object(l.a)(S,2),T=O[0],A=O[1],M=Object(n.useState)(null),_=Object(l.a)(M,2),j=_[0],R=_[1],N=Object(n.useState)(null),L=Object(l.a)(N,2),z=L[0],P=L[1],D=Dt(z),F=Dt(e);Object(n.useEffect)((function(){var t=!0;if(null!==i&&null!==j){var e=Xt(j),a=Math.floor(i/e),n="".concat(Wt,".").concat(j.max_zoom,".").concat(a);return A(!0),Vt(n).then((function(e){t&&(A(!1),E(Yt(e[n],i)))})),function(){t=!1}}}),[i,j]);var H=Object(n.useCallback)((function(t){b(t),d.current=t}),[d]),G=Object(n.useMemo)((function(){return!!j}),[j]),B=Object(n.useMemo)((function(){if(C){var t=0,e=1/0,i=0,n={},o={};Object.entries(qt).forEach((function(t){var e=Object(l.a)(t,2),i=e[0],a=e[1];o[i]={category:a,numEnhancers:0}}));var r=function(t,e){return t.absDistance-e.absDistance},s=new bt.a([],r),c=new bt.a([],r);C.forEach((function(r){var l=r.fields[6];if(!n[l]){var u=+r.fields[4],h=u-a,d=h>0,p=Math.abs(h);n[l]={name:l,position:u,absDistance:p,isDownstream:d,samplesByCategory:{}},Object.values(qt).forEach((function(t){var e=t.name,i=t.size;n[l].samplesByCategory[e]=[],n[l].samplesByCategory[e].size=i})),e=Math.min(e,p),i=Math.max(i,p),d?c.push(n[l]):s.push(n[l])}var m=r.fields[10];n[l].samplesByCategory[Ut[m].category.name].push({gene:l,sample:m,sampleCategory:Ut[m].category.name,value:r.importance}),t=Math.max(t,r.importance),o[Ut[m].category.name].numEnhancers++}));for(var u=[];c.length;)u.push(c.pop());for(var h=[];s.length;)h.push(s.pop());return u.forEach((function(t,e){var i=u[e-1];t.relDistance=t.position-(i&&i.position||a)})),h.forEach((function(t,e){var i=u[e-1];t.relDistance=(i&&i.position||a)-t.position})),{minAbsDistance:e,maxAbsDistance:i,maxScore:t,genes:n,genesDownstreamByDist:u,genesUpstreamByDist:h,categoryAggregation:o}}}),[C]);Object(n.useEffect)((function(){Object(w.a)(y.a.mark((function t(){var e,i;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(Bt,"/tileset_info/?d=").concat(Wt));case 2:return e=t.sent,t.next=5,e.json();case 5:(i=t.sent)[Wt]&&R(i[Wt]);case 7:case"end":return t.stop()}}),t)})))()}),[]);var W=Ft();Object(n.useLayoutEffect)((function(){if(v){var t=function(){return window.requestAnimationFrame((function(){var t=v.getBoundingClientRect().width;t!==D&&P(t)}))};return t(),window.addEventListener("resize",t),window.addEventListener("orientationchange",t),function(){window.removeEventListener("resize",t),window.removeEventListener("orientationchange",t)}}}),[v]);for(var V=[],q=0;q<Ht.length;q++)V.push(Ht[q]());return Object(n.useEffect)((function(){Zt(v,z,B,{geneCellEncoding:e,prevGeneCellEncoding:F,genePadding:s,openTooltip:c,closeTooltip:u,classes:W,tooltipClasses:V,position:r,variant:p})}),[v,z,B,e,s,c,u]),o.a.createElement(I.a,{className:W.root,container:!0,justify:"center",alignItems:"center",style:h},G&&!T?o.a.createElement(I.a,{item:!0,className:W.plot},o.a.createElement("svg",{ref:H,className:W.plotSvg},o.a.createElement("g",{id:"enhancers"}),o.a.createElement("g",{id:"gene-distance-axis"}),o.a.createElement("g",{id:"genes-upstream"}),o.a.createElement("g",{id:"genes-downstream"}))):o.a.createElement(m.a,{color:"inherit"}))};Kt.defaultProps={geneCellEncoding:"distribution",position:null,relPosition:null,fullPosition:null,variant:null,genePadding:!1,openTooltip:u.c,closeTooltip:u.c,styles:{},svgRef:{}};var Qt=Kt,$t=Object(g.a)((function(t){return{logo:{height:"100%",padding:"0.1em",alignItems:"center",fontSize:"1em",lineHeight:"1em",fontWeight:"bold"},logoAbc:{fontSize:"2.75em",letterSpacing:"-0.075rem",paddingRight:"0.125em",fontWeight:900},logoEnhancer:{alignItems:"flex-start"}}})),te=function(t){var e=$t();return o.a.createElement(I.a,{container:!0,className:e.logo,style:t.styles},o.a.createElement(I.a,{item:!0,className:e.logoAbc},"ABC"),o.a.createElement(I.a,{item:!0},o.a.createElement(I.a,{container:!0,direction:"column",className:e.logoEnhancer},o.a.createElement(I.a,{item:!0},"Enhancer-Gene"),o.a.createElement(I.a,{item:!0},"Connections"))))};te.defaultProps={styles:{}};var ee=te,ie=i(485),ae=i(486),ne=i(492),oe=i(130),re=i(180),se=i.n(re),le=Object(g.a)((function(t){return{inputRoot:{background:"white !important",borderTopLeftRadius:0,borderTopRightRadius:0,"&::before":{borderBottomWidth:0,boxShadow:"0 1px 0 0 rgba(0, 0, 0, 0)",transition:"boxShadow 0.2s ease"},"&:hover::before":{borderBottomWidth:0,boxShadow:"0 1px 0 0 rgba(0, 0, 0, 1)"}},focused:{boxShadow:"0 1px 0 0 rgba(0, 0, 0, 1)"},input:{height:35,padding:"6px 0 6px"},textFieldRoot:{"& .MuiFormLabel-root":{color:"black",fontWeight:"bold",transform:"translate(12px, 21px) scale(1.25)"},"& .MuiInputLabel-shrink":{fontWeight:"normal"}}}})),ce=function(){var t=Object(w.a)(y.a.mark((function t(e,i){var a,n,o;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!==typeof e){t.next=5;break}return t.next=3,fetch("".concat(e,"&ac=").concat(i||""));case 3:return a=t.sent,t.abrupt("return",a.json());case 5:return t.next=7,fetch("".concat(e.url,"&ac=").concat(i||""));case 7:return n=t.sent,t.next=10,n.json();case 10:return o=t.sent,t.abrupt("return",o.map((function(t){return t.type=e.type,t})));case 12:case"end":return t.stop()}}),t)})));return function(e,i){return t.apply(this,arguments)}}();function ue(t){return o.a.createElement(oe.a,Object.assign({viewBox:"0 0 16 16"},t),o.a.createElement("path",{d:"M5.03 14.378A7.33 7.33 0 003.423 16h2.42a7.762 7.762 0 011.281-.774 13.241 13.241 0 01-1.863-1.016c-.078.054-.156.11-.233.168zM5.766 0l.219.174a8.754 8.754 0 001.636.92l.024.008c.797.24 1.507.627 2.023.933.325.18.674.4 1.024.66 1.825 1.363 2.79 3.22 2.79 5.367 0 2.062-.962 3.89-2.782 5.286-.061.048-.125.094-.186.139a10.45 10.45 0 00-1.895-.955 8.17 8.17 0 001.69-1.162h-3.92a6.191 6.191 0 01-1.199-1.15h6.093a4.054 4.054 0 00.603-1.747H3.839c.072.656.307 1.239.636 1.747h.011c.282.438.628.822.991 1.15H5.47l.74.584c.831.588 1.573.893 1.636.92a9.358 9.358 0 012.847 1.504A7.38 7.38 0 0112.3 16H9.879l-.759-.5a7.876 7.876 0 00-1.256-.594 11.833 11.833 0 01-2.07-1.04l.017-.009c-1.567-.999-3.571-2.851-3.571-5.794 0-2.149.964-4.005 2.79-5.367.076-.058.154-.113.231-.167.495.32 1.143.698 1.863 1.015a7.677 7.677 0 00-1.296.786c-.043.032-.083.066-.125.098h3.318c.535.336.999.727 1.364 1.149H4.598a4.215 4.215 0 00-.721 1.748h7.97l-.038-.195a3.527 3.527 0 00-.306-.904 4.417 4.417 0 00-.378-.65l-.01-.007a5.793 5.793 0 00-1.081-1.13l-.14-.109a7.236 7.236 0 00-.722-.48l-.031-.02a7.942 7.942 0 00-1.276-.607 10.278 10.278 0 01-1.257-.57C5.728 2.218 4.31 1.364 3.281 0h2.486zm6.267 0a7.808 7.808 0 01-1.743 1.707A10.443 10.443 0 008.396.752 8.592 8.592 0 009.592 0h2.442z"}))}function he(t){return o.a.createElement(I.a,{key:t.option.geneName,container:!0,direction:"row",alignItems:"center"},o.a.createElement(ue,{fontSize:"small"}),o.a.createElement("span",null,t.option.geneName))}function de(t){return o.a.createElement(I.a,{key:t.option.geneName,container:!0,direction:"row",alignItems:"center"},o.a.createElement(se.a,{fontSize:"small"}),o.a.createElement("span",null,t.option.geneName))}function pe(t){return"gene"===t.option.type?o.a.createElement(he,{option:t.option}):"variant"===t.option.type?o.a.createElement(de,{option:t.option}):o.a.createElement("div",null,t.option.geneName)}function me(t){var e=Object(n.useState)(!1),i=Object(l.a)(e,2),a=i[0],r=i[1],s=Object(n.useState)([]),c=Object(l.a)(s,2),h=c[0],d=c[1],p=Object(n.useState)(t.inputValue),g=Object(l.a)(p,2),f=g[0],v=g[1],b=pt(f,250),x=a&&0===h.length,y=le(),w=Object(nt.a)({},y);delete w.textFieldRoot;var k=t.customSearch,C=t.searchUrl;Object(n.useEffect)((function(){var t=!0;if(a){d([]);var e=Array.isArray(C)?C.map((function(t){return ce(t,b)})):[ce(C,b)];return k&&e.push(k(b)),Promise.all(e).then((function(e){t&&d(e.flat().filter(u.c))})),function(){t=!1}}}),[C,k,a,b]),Object(n.useEffect)((function(){a||d([])}),[a]);var E=t.multiple&&!Array.isArray(t.value)?[t.value]:t.value,S=E&&0===h.length?E:h;return S=Array.isArray(S)?S:[S],o.a.createElement(ae.a,{classes:t.larger?w:{},multiple:t.multiple,onChange:function(e,i){t.onChange(i)},value:E,onInputChange:function(t,e){t&&v(e)},fullWidth:t.fullWidth,style:{width:t.fullWidth?"auto":t.width},open:a,onOpen:function(){r(!0)},onClose:function(){r(!1)},getOptionSelected:function(t,e){return t.geneName===e.geneName},getOptionLabel:function(t){return t?t.geneName:""},options:S,loading:x,renderInput:function(e){return o.a.createElement(ie.a,Object.assign({},e,{className:t.larger?y.textFieldRoot:"",id:t.id,label:t.label,variant:t.variant,size:t.size,InputProps:Object(nt.a)(Object(nt.a)({},e.InputProps),{},{endAdornment:o.a.createElement(o.a.Fragment,null,x?o.a.createElement(m.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment)})}))},renderOption:function(t){return o.a.createElement(pe,{option:t})},renderTags:function(t,e){return t.map((function(t,i){return o.a.createElement(ne.a,Object.assign({icon:"gene"===t.type?o.a.createElement(ue,null):o.a.createElement(se.a,null),key:t.geneName,label:t.geneName},e({index:i})))}))}})}me.defaultProps={fullWidth:!0,id:"",label:"",multiple:!1,onChange:u.c,size:"small",value:null,variant:"outlined",width:"10rem"};var ge=Object(g.a)((function(t){return{note:{color:t.palette.grey[400],marginTop:"1em"},showTutorial:{minWidth:"10.5rem",marginRight:"0.5rem"},startExploring:{minWidth:"10.5rem",marginLeft:"0.5rem",color:"white",background:"#cc0078 linear-gradient(45deg, #cc0078 30%, #cc0066 90%)",boxShadow:"0 1px 6px 1px rgba(255, 76, 151, .3)","&:hover":{boxShadow:"0 1px 6px 1px rgba(255, 76, 151, .5)",background:"#d90080 linear-gradient(45deg, #d90080 30%, #d9006c 90%)"},"&:focus":{boxShadow:"0 1px 6px 1px rgba(255, 76, 151, .5)"}}}})),fe=function(t){var e=Object(n.useState)(!1),i=Object(l.a)(e,2),a=i[0],r=i[1],s=ge();return a?o.a.createElement(o.a.Fragment,null,o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement(W.a,{align:"center"},o.a.createElement(S.a,{className:s.startExploring,onClick:t.infoCloseHandler,variant:"contained",disableElevation:!0},"Start Exploring!")),o.a.createElement(W.a,{align:"center",className:s.note},o.a.createElement("em",null,'You can reopen this tutorial by clicking on "ABC Enhancer-Gene Connections" in the upper left corner!'))):o.a.createElement(o.a.Fragment,null,o.a.createElement(W.a,{id:"info-title",align:"center",variant:"h5",component:"h2",noWrap:!0},o.a.createElement(ee,{styles:{width:"auto"}})),o.a.createElement("p",{id:"info-description"},"This web application visualizes genome-wide enhancer-gene interactions that were predicted with the ",o.a.createElement("em",null,"Activity-By-Contact")," (ABC) model. You can interactively browse the entire human genome and filter enhancers by gene and containing variant."),o.a.createElement("p",null,"For information regarding the ABC model please refer to our initial publication:"," ",o.a.createElement("a",{href:"https://www.nature.com/articles/s41588-019-0538-0",target:"_blank",rel:"noopener noreferrer"},"Fulco et al., Activity-by-contact model of enhancer\u2013promoter regulation from thousands of CRISPR perturbations,"," ",o.a.createElement("em",null,"Nature Genetics")," (2019)"),"."),o.a.createElement(W.a,{align:"center"},o.a.createElement(S.a,{className:s.showTutorial,onClick:function(){return r(!0)},variant:"contained",disableElevation:!0},"Show Tutorial"),o.a.createElement(S.a,{className:s.startExploring,onClick:t.infoCloseHandler,variant:"contained",disableElevation:!0},"Start Exploring!")))};var ve=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.encoder,o=i.decoder,r=Object(n.useState)(void 0===It(t,o)?e:It(t,o)),s=Object(l.a)(r,2),c=s[0],u=s[1],h=Object(n.useCallback)((function(e){u(e),Nt(t,e,a)}),[t,a]);return Nt(t,c,a),[c,h]},be=(i(420),i(421),St.groups.map((function(t){return{name:t.label,options:t.categories}}))),xe=Object(g.a)((function(t){return{black:{color:"black"},gray:{color:t.palette.grey[400]},pink:{color:"#cc0078"},root:{position:"absolute",display:"flex",top:0,right:0,bottom:0,left:0},h1:{height:"100%",margin:"0",padding:"0",fontSize:"1rem",lineHeight:"1rem",fontWeight:"bold"},modal:{display:"flex",alignItems:"center",justifyContent:"center",padding:"4rem"},paper:{backgroundColor:t.palette.background.paper,borderRadius:"0.25rem",boxShadow:t.shadows[4],maxWidth:"60rem",maxHeight:"calc(100vh - 8rem)",overflow:"auto",padding:t.spacing(2,4),outline:0,"&>h2":{display:"flex",justifyContent:"center",margin:t.spacing(2,0,3)},"&>p":{fontSize:"1.125em"}},iconRadio:{padding:t.spacing(.5,0),marginLeft:-t.spacing(1)/2,"& .MuiFormControlLabel-label":{lineHeight:1.2}},iconRadioActive:{color:"black"},iconRadioLegend:{margin:t.spacing(2,0,.25,0)},appBar:{width:"calc(100% - ".concat(240,"px)"),marginLeft:240,color:t.palette.common.black,backgroundColor:t.palette.common.white,boxShadow:"0 1px 0 0 ".concat(t.palette.grey[300])},drawer:{width:240,flexShrink:0},drawerGrid:{height:"100%"},drawerPaper:{width:240},settings:{position:"relative",flexGrow:1},globalSettingsTitle:{padding:"3px 8px 4px 8px",margin:0,"& h6":{fontSize:"0.8rem",fontWeight:"bold"}},settingsContent:{position:"absolute",top:0,right:0,bottom:0,left:0,overflow:"hidden auto"},textInput:{minWidth:"100%"},toolbar:t.mixins.toolbar,content:{display:"flex",flexDirection:"column",flexGrow:1,padding:t.spacing(1),backgroundColor:"white"},grow:{flexGrow:1},fullWidthHeight:{position:"absolute",top:0,right:0,bottom:0,left:0},higlass:{display:"flex",flexGrow:1},higlassEnhancerContainer:{flexWrap:"nowrap",minHeight:"100%"},higlassEnhancer:{flexGrow:1,margin:"-8px 0 -8px -8px"},higlassDnaAccessibility:{width:"20rem",margin:"-8px -8px -8px 0"},titleBar:{position:"relative",padding:"2px",fontSize:"0.8rem",background:t.palette.grey[100]},titleBarText:{fontSize:"0.8rem"},titleBarContainer:{width:"auto"},titleBarTitle:{padding:"0 2px",fontWeight:900},titleBarIcon:{color:t.palette.grey[400],"&:hover":{color:"black"}},titleBarIconActive:{color:"black","&:hover":{color:"black"}},titleBarHelpPopeover:{maxWidth:"20rem",padding:"0.5rem",fontSize:"0.8rem","&+p":{paddingTop:0}},infoBarTitle:{display:"block",color:t.palette.grey[800],fontSize:"0.8rem",fontWeight:"bold","&::after":{content:":"}},panZoomTip:{fontSize:"0.8rem",color:t.palette.grey[600],opacity:1,animation:"0.75s ease 2s 1 running forwards fadeout","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none",userSelect:"none","&.show":{opacity:1,animation:""}},panZoomTipActive:{fontWeight:"bold",fontSize:"0.8rem",color:"#cc0078",opacity:1,animation:"0.75s ease 2s 1 running forwards fadeout","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none",userSelect:"none","&.show":{opacity:1,animation:""}},higlassEnhancerInfoBar:{display:"flex",flexDirection:"column",justifyContent:"flex-end",minHeight:"min-content",padding:"0 4px",color:t.palette.grey[600],borderTop:"1px solid ".concat(t.palette.grey[300]),"&:first-child":{borderTop:0},"& >*:first-child":{paddingTop:2},"& >*:last-child":{paddingBottom:2,borderBottom:"1px dotted ".concat(t.palette.grey[300])}},higlassEnhancerGenePlot:{minHeight:"6rem"},higlassEnhancerGenePlotPlaceholder:{minHeight:"6rem",fontStyle:"italic",color:t.palette.grey[600],background:t.palette.grey[100]},enhancerGeneTooltip:{position:"fixed",zIndex:10,width:1,height:1,background:"black",fontWeight:"normal",pointerEvents:"none","& strong":{fontWeight:"bold"}},dnaAccessibilityInfoBar:{color:t.palette.grey[600],padding:"2px 4px",borderBottom:"1px dotted ".concat(t.palette.grey[300])},dnaAccessibilityInfoBarRegion:{display:"flex",justifyContent:"space-between"},higlassSeparator:{zIndex:1,margin:"-".concat(t.spacing(1),"px 0"),width:1,background:t.palette.grey[300]},titleBarMiddle:{position:"relative",flexGrow:1,height:"100%"},titleBarMiddleContent:{height:"100%"},toolbarExtra:{paddingLeft:0,paddingRight:0,alignItems:"flex-end"},globalSettingsFirstBox:{margin:t.spacing(0,1,1,1)}}})),ye=function(t){return t?t.replace(":","."):t},we=function(t){return t?t.replace(".",":"):t},ke=function(t){return t.views[0].overlays[1]&&t.views[0].overlays[1].options.extent&&t.views[0].overlays[1].options.extent.length?Object(k.a)(t.views[0].overlays[1].options.extent[0]):null},Ce=function(t){return t.views[0].tracks.top[2].options.focusRegion?Object(k.a)(t.views[0].tracks.top[2].options.focusRegion):null},Ee=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.force,n=void 0!==a&&a;return function(i){var a=!0===n||Object(u.d)(n)&&n(),o=Object(k.a)(i.views[0].initialXDomain),r=ke(i),s=Ce(i);return Number.isNaN(+t)||(o[0]=t),Number.isNaN(+e)||(o[1]=e),r&&!a&&(o[0]=r[0]-1e5,o[1]=r[1]+1e5),s&&!a&&(o[0]=Math.min(o[0],s[0]-1e5),o[1]=Math.max(o[1],s[1]+1e5)),i.views[0].initialXDomain=o,i}},Se=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(i){if(Number.isNaN(+t)||null===t)e.forEach((function(t){delete i.views[0].tracks.top[t].options.focusRegion})),i.views[0].overlays[0].options.extent=[];else{var a=[t-.5,t+.5];e.forEach((function(t){i.views[0].tracks.top[t].options.focusRegion=a})),i.views[0].overlays[0].options.extent=[a]}return i}},Oe=function(t){return function(e){return e.views[0].tracks.top[2].options.valueColumn="pValue"===t?7:8,e}},Te=function(t){var e=Object(u.k)(t,"\n",4),i=t.lastIndexOf("\n"),a=+t.substring(t.indexOf('width="')+7,t.indexOf("px",t.indexOf('width="')+7)),n=+t.substring(t.indexOf('height="')+8,t.indexOf("px",t.indexOf('height="')+8));return{core:t.substring(e+1,i),width:a,height:n}},Ae=function(){var t=Object(w.a)(y.a.mark((function t(e){var i;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",void 0);case 2:if(!(i=e.match(/^chr(\d+):(\d)+$/))||!(+i[1]>0&&+i[1]<23||"x"===+i[1].toLowerCase()||"y"===+i[1].toLowerCase())){t.next=5;break}return t.abrupt("return",[{chr:"chr".concat(i[1]),txStart:+i[2],txEnd:+i[2]+1,score:0,geneName:e,type:"nucleotide"}]);case 5:return t.abrupt("return",void 0);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Me=function(t){return void 0===t?void 0:"true"===t},_e=function(t){var e=ve("i",!0,{decoder:Me}),i=Object(l.a)(e,2),a=i[0],r=i[1],s=ve("g",""),h=Object(l.a)(s,2),d=h[0],m=h[1],g=ve("v","rs1250566"),f=Object(l.a)(g,2),v=f[0],b=f[1],x=ve("hide-unfocused",!1,{decoder:Me}),V=Object(l.a)(x,2),U=V[0],Y=V[1],Z=ve("mc","solid"),Q=Object(l.a)(Z,2),tt=Q[0],at=Q[1],nt=ve("vs","pValue"),ot=Object(l.a)(nt,2),rt=ot[0],st=ot[1],lt=ve("al","indicator"),ct=Object(l.a)(lt,2),ut=ct[0],ht=ct[1],dt=ve("s",t.chromInfo.absToChr(1761366260).slice(0,2).join(":"),{encoder:ye,decoder:we}),mt=Object(l.a)(dt,2),ft=mt[0],vt=mt[1],bt=ve("e",t.chromInfo.absToChr(1761603836).slice(0,2).join(":"),{encoder:ye,decoder:we}),xt=Object(l.a)(bt,2),yt=xt[0],St=xt[1],At=ve("erd",!0,{decoder:Me}),Mt=Object(l.a)(At,2),_t=Mt[0],jt=Mt[1],Rt=ve("egd",!0,{decoder:Me}),It=Object(l.a)(Rt,2),Nt=It[0],Pt=It[1],Ft=ve("ad",!0,{decoder:Me}),Ht=Object(l.a)(Ft,2),Gt=Ht[0],Bt=Ht[1],Wt=ve("gp",!0,{decoder:Me}),Vt=Object(l.a)(Wt,2),qt=Vt[0],Ut=Vt[1],Xt=ve("gce","distribution"),Yt=Object(l.a)(Xt,2),Jt=Yt[0],Zt=Yt[1],Kt=Object(n.useState)(null),$t=Object(l.a)(Kt,2),te=$t[0],ie=$t[1],ae=Object(n.useState)(null),ne=Object(l.a)(ae,2),oe=ne[0],re=ne[1],se=Dt(te),le=Dt(oe),ce=Object(n.useRef)(null),ue=Object(n.useRef)(!1),he=Object(n.useRef)(null),de=Object(n.useRef)(null),pe=Object(n.useState)(null),ge=Object(l.a)(pe,2),ke=ge[0],Ce=ge[1],_e=Object(n.useState)(null),je=Object(l.a)(_e,2),Re=je[0],Ie=je[1],Ne=Object(n.useState)(null),Le=Object(l.a)(Ne,2),ze=Le[0],Pe=Le[1],De=Object(n.useState)(null),Fe=Object(l.a)(De,2),He=Fe[0],Ge=Fe[1],Be=Object(n.useState)(null),We=Object(l.a)(Be,2),Ve=We[0],qe=We[1],Ue=Object(n.useState)({show:!1,title:"",x:0,y:0,arrow:!0,placement:"bottom",classes:{}}),Xe=Object(l.a)(Ue,2),Ye=Xe[0],Je=Xe[1],Ze=Object(n.useState)(!1),Ke=Object(l.a)(Ze,2),Qe=Ke[0],$e=Ke[1],ti=Object(n.useState)(!1),ei=Object(l.a)(ti,2),ii=ei[0],ai=ei[1],ni=Object(n.useRef)(null),oi=Object(n.useRef)(null),ri=Object(n.useMemo)((function(){var t=[];return te&&te===se&&t.push(te),oe&&oe===le&&t.push(oe),te&&te!==se&&t.push(te),oe&&oe!==le&&t.push(oe),t}),[te,oe]),si=Object(n.useMemo)((function(){return te?Lt("".concat(te.chr,":").concat(te.txStart),t.chromInfo):null}),[te,t.chromInfo]),li=Object(n.useMemo)((function(){return te?Lt("".concat(te.chr,":").concat(te.txEnd),t.chromInfo):null}),[te,t.chromInfo]),ci=Object(n.useMemo)((function(){return oe?Lt("".concat(oe.chr,":").concat(oe.txStart),t.chromInfo):null}),[oe,t.chromInfo]),ui=Object(n.useMemo)((function(){return oe?+oe.txStart:null}),[oe]),hi=Object(n.useMemo)((function(){return oe?"".concat(oe.chr,":").concat(oe.txStart):null}),[oe]),di=Object(n.useMemo)((function(){return Lt(ft,t.chromInfo)}),[ft,t.chromInfo]),pi=Object(n.useMemo)((function(){return Lt(yt,t.chromInfo)}),[yt,t.chromInfo]),mi=pt(di,500),gi=pt(pi,500),fi=Object(n.useCallback)((function(){return!!oi.current&&(oi.current=!1,!0)}),[]),vi=Object(n.useMemo)((function(){return Object(u.l)((e=te?te.geneName:null,i=si,a=li,function(t){var n=t.views[0].tracks.top.length;return e?(t.views[0].tracks.top[n-1].options.focusGene=e,t.views[0].overlays[1].options.extent=[[i,a]]):(delete t.views[0].tracks.top[n-1].options.focusGene,delete t.views[0].overlays[1].options.extent),t}),Se(ci,[2,4]),function(t){return function(e){return e.views[0].tracks.top[4].options.focusStyle=t?"filtering":"highlighting",e.views[0].tracks.top[4].options.stratification.axisNoGroupColor=!t,e}}(U),(t=tt,function(e){return e.views[0].tracks.top[4].options.opacityEncoding=t,e}),Oe(rt),Ee(di,pi,{force:fi}))(Object(u.b)(Ot));var t,e,i,a}),[te,si,li,ci,U,tt,rt]),bi=Object(n.useMemo)((function(){return vi.views[0].tracks.top.reduce((function(t,e){return t+e.height}),0)}),[vi]),xi=Object(n.useMemo)((function(){return Object(u.l)(Se(ci,[2]),Oe(rt),(t=ut,function(e){return e.views[0].tracks.top[3].options.showRowLabels=!(!t||"hidden"===t)&&t,e}),Ee.apply(void 0,Object(k.a)(function(){var t=pi-di,e=di+t/2;if(ci)return t<5e3&&Math.abs(e-ci)<1e3?[di,pi]:[ci-2500,ci+2500];if(si&&li){var i=si+(li-si)/2;return t<5e3&&e>si&&e<li?[di,pi]:[i-2500,i+2500]}return[di,pi]}()).concat([{force:!0}])))(Object(u.b)(Tt));var t}),[ci,si,li,mi,gi,rt,ut,t.chromInfo]),yi=Object(n.useMemo)((function(){return ci?5:Math.round((pi-di)/1e3)}),[ci,di,pi]),wi=Object(n.useMemo)((function(){return Object(u.f)(ft)&&ft.indexOf(":")>=0?t.chromInfo.chrToAbs([ft.split(":")[0],+ft.split(":")[1]]):+ft}),[ft,t.chromInfo]),ki=Object(n.useMemo)((function(){return Object(u.f)(yt)&&yt.indexOf(":")>=0?t.chromInfo.chrToAbs([yt.split(":")[0],+yt.split(":")[1]]):+yt}),[yt,t.chromInfo]),Ci=Object(n.useMemo)((function(){return ii?"higlass-block focus":"higlass-block"}),[ii]),Ei=function(){m(""),ie(null)},Si=function(){b(""),re(null)},Oi=function(t){t?(b(t.geneName),re(t)):Si()},Ti=function(t){return function(){st(t)}},Ai=function(t){return function(){at(t)}},Mi=function(t){return function(){ht(t)}},_i=function(t){return function(){Zt(t)}},ji=function(t){"gene-annotation"===t.type?(m(t.payload.name),oi.current=!0,ie({chr:t.payload.fields[0],txStart:t.payload.fields[1],txEnd:t.payload.fields[2],geneName:t.payload.name,type:"gene"})):"snp"===t.type?(b(t.payload.name),oi.current=!0,re({chr:t.payload.fields[0],txStart:t.payload.fields[1],txEnd:t.payload.fields[2],geneName:t.payload.name,score:t.payload.importance,type:"variant"})):"annotation"===t.type&&console.log("clicked on annotation",t.payload)},Ri=Object(u.a)((function(e){var i=e.xDomain.map((function(e){return t.chromInfo.absToChr(e).slice(0,2).join(":")})),a=Object(l.a)(i,2),n=a[0],o=a[1];vt(n),St(o)}),250);Object(n.useEffect)((function(){Object(w.a)(y.a.mark((function t(){var e,i,a,n;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!d||te){t.next=10;break}return t.next=3,fetch("".concat(Ct,"&ac=").concat(d));case 3:return e=t.sent,t.next=6,e.json();case 6:i=t.sent,i[0].type="gene",(o=i[0])?(m(o.geneName),ie(o)):Ei();case 10:if(!v||oe){t.next=20;break}return t.next=13,fetch("".concat(Et,"&ac=").concat(v));case 13:return a=t.sent,t.next=16,a.json();case 16:n=t.sent,n[0].type="variant",Oi(n[0]);case 20:case"end":return t.stop()}var o}),t)})))()}),[]);var Ii=Object(n.useCallback)((function(t){Object(u.e)(t.target,ni.current)||ai(!1),ue.current=!1}),[]);Object(n.useEffect)((function(){window.addEventListener("mouseup",Ii),window.addEventListener("blur",Ii)}),[]);var Ni=Object(n.useCallback)((function(){ue.current=!0}),[]),Li=Object(n.useCallback)((function(t){null!==t&&(ce.current=t.api,t.api.on("click",ji),t.api.on("location",Ri,"context"),ce.current.getComponent().element.addEventListener("mousedown",Ni))}),[]),zi=Object(n.useCallback)((function(t){null!==t&&(he.current=t.api)}),[]),Pi=Boolean(ke),Di=Pi?"simple-popover":void 0,Fi=Boolean(Re),Hi=Pi?"simple-popover":void 0,Gi=Boolean(ze),Bi=Pi?"simple-popover":void 0,Wi=Boolean(He),Vi=Pi?"simple-popover":void 0,qi=Boolean(Ve),Ui=Pi?"simple-popover":void 0,Xi=function(){r(!1)},Yi=Object(n.useCallback)((function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=a.arrow,o=void 0!==n&&n,r=a.placement,s=void 0===r?"bottom":r,l=a.classes,c=void 0===l?{}:l;Je({show:!0,x:t,y:e,title:i,arrow:o,placement:s,classes:c})}),[]),Ji=Object(n.useCallback)((function(){Je({show:!1,title:"",x:0,y:0,arrow:!0,placement:"bottom",classes:{}})}),[]),Zi=Object(n.useCallback)((function(){ai(!0)}),[]),Ki=Object(n.useCallback)((function(){ue.current||ai(!1)}),[ue]),Qi=Object(n.useCallback)((function(){$e(!0)}),[]),$i=Object(n.useCallback)((function(){$e(!1)}),[]),ta=function(t,e,i){var a=Te(t),n=a.core,o=a.width,r=a.height,s=Te(e),c=s.core,u=s.width,h=s.height,d=function(t){var e=t.indexOf(">"),i=t.lastIndexOf("</svg>"),a=t.substring(t.indexOf('viewbox="')+9,t.indexOf('"',t.indexOf('viewbox="')+9)).split(" ").slice(2),n=Object(l.a)(a,2),o=n[0],r=n[1];return{core:t.substring(e+1,i),width:+o,height:+r}}(i),p=d.core,m=d.height,g=vi.views[0].tracks.top.reduce((function(t,e){return t+e.height}),0),f=xi.views[0].tracks.top.reduce((function(t,e){return t+e.height}),0),v='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg\n    xmlns:xlink="http://www.w3.org/1999/xlink"\n    xmlns="http://www.w3.org/2000/svg" version="1.1" width="_WIDTH_px" height="_HEIGHT_px">\n    <g id="enhancer-plot">\n    _ENHANCER_\n    </g>\n    <g id="enhancer-gene-plot" transform="translate(0, _ENHANCER_GENE_Y_)">\n    _ENHANCER_GENE_\n    </g>\n    <g id="dna-accessibility-plot" transform="translate(_DNA_ACCESS_X_, 0)">\n    _DNA_ACCESS_\n    </g>\n</svg>';return v=(v=(v=(v=(v=(v=(v=v.replace("_WIDTH_",o+u+24)).replace("_HEIGHT_",Math.max(r+m+24,h,g+m+24,f))).replace("_ENHANCER_",n)).replace("_ENHANCER_GENE_Y_",r+24)).replace("_ENHANCER_GENE_",p)).replace("_DNA_ACCESS_X_",o+24)).replace("_DNA_ACCESS_",c)},ea=xe(),ia=_t?ea.titleBarIconActive:ea.titleBarIcon,aa=Gi?ea.titleBarIconActive:ea.titleBarIcon,na=Nt?ea.titleBarIconActive:ea.titleBarIcon,oa=Wi?ea.titleBarIconActive:ea.titleBarIcon,ra=Gt?ea.titleBarIconActive:ea.titleBarIcon,sa=qi?ea.titleBarIconActive:ea.titleBarIcon;return o.a.createElement("div",{className:ea.root},o.a.createElement(O.a,null),o.a.createElement(C.a,{position:"fixed",className:ea.appBar},o.a.createElement(G.a,{classes:{root:ea.toolbarExtra}},o.a.createElement(_.a,{fullWidth:!0},o.a.createElement(me,{label:o.a.createElement(I.a,{container:!0,direction:"row",alignItems:"center"},o.a.createElement(et.a,{fontSize:"small"}),o.a.createElement("span",{style:{marginLeft:3}},"Gene or Variant")),customSearch:Ae,searchUrl:[{url:Ct,type:"gene"},{url:Et,type:"variant"}],onChange:function(t){if(t.length){var e={};t.slice(t.length-2).forEach((function(t){switch(t.type){case"gene":e.gene=t,d!==t.geneName&&(m(t.geneName),ie(t));break;case"variant":e.variant=t,v!==t.geneName&&(b(t.geneName),re(t));break;default:console.warn("Unknown focus element",t)}})),d&&!e.gene&&Ei(),v&&!e.variant&&Si()}else Ei(),Si()},value:ri,variant:"filled",larger:!0,fullWidth:!0,multiple:!0})))),o.a.createElement(A.a,{className:ea.drawer,variant:"permanent",classes:{paper:ea.drawerPaper},anchor:"left"},o.a.createElement(I.a,{container:!0,direction:"column",className:ea.drawerGrid},o.a.createElement(I.a,{item:!0},o.a.createElement(B.a,{className:ea.toolbar,style:{width:"100%"}},o.a.createElement("h1",{className:ea.h1,onClick:function(){r(!0)}},o.a.createElement(ee,null))),o.a.createElement(T.a,null)),o.a.createElement(I.a,{container:!0,item:!0,className:ea.grow,direction:"column"},o.a.createElement(I.a,{item:!0},o.a.createElement(E.a,{className:ea.globalSettingsTitle},o.a.createElement(W.a,{variant:"subtitle2",component:"h6"},"Genomic Region:")),o.a.createElement(E.a,{className:ea.globalSettingsFirstBox},o.a.createElement(E.a,{m:0},o.a.createElement(_.a,{variant:"outlined",margin:"dense",fullWidth:!0},o.a.createElement(L.a,{htmlFor:"x-domain-start"},"Start"),o.a.createElement(P.a,{id:"x-domain-start",label:"Start",onChange:function(t){vt(t.target.value)},value:ft}))),o.a.createElement(E.a,{m:0},o.a.createElement(_.a,{variant:"outlined",margin:"dense",fullWidth:!0},o.a.createElement(L.a,{htmlFor:"x-domain-end"},"End"),o.a.createElement(P.a,{id:"x-domain-end",label:"End",onChange:function(t){St(t.target.value)},value:yt}))),o.a.createElement(E.a,{m:0},o.a.createElement(S.a,{variant:"contained",margin:"dense",onClick:function(t){if(ce.current){var e=Object(u.b)(vi),i=Object(k.a)(e.views[0].initialXDomain);Number.isNaN(+wi)||(i[0]=wi),Number.isNaN(+ki)||(i[1]=ki),ce.current.zoomTo("context",i[0],i[1],i[0],i[1],2e3)}},fullWidth:!0,disableElevation:!0},"Go"))),o.a.createElement(T.a,null),o.a.createElement(E.a,{className:ea.globalSettingsFirstBox},o.a.createElement(E.a,{className:ea.globalSettingsTitle},o.a.createElement(W.a,{variant:"subtitle2",component:"h6"},"Variants:")),o.a.createElement(E.a,{m:0},o.a.createElement(S.a,{variant:"contained",margin:"dense",fullWidth:!0,disableElevation:!0,startIcon:o.a.createElement(J.a,null)},"Load or Adjust"))),o.a.createElement(T.a,null)),o.a.createElement(I.a,{item:!0,className:ea.settings},o.a.createElement(E.a,{m:0,className:ea.settingsContent},o.a.createElement(E.a,{className:ea.globalSettingsTitle},o.a.createElement(W.a,{variant:"subtitle2",component:"h6"},"Samples:")),o.a.createElement(E.a,{className:ea.globalSettingsFirstBox},o.a.createElement(gt,{options:be,groupColorsDark:wt,groupColorsLight:kt})))),o.a.createElement(I.a,{item:!0},o.a.createElement(T.a,null),o.a.createElement(E.a,{m:1},o.a.createElement(S.a,{variant:"contained",margin:"dense",onClick:function(){var t,e=ta(ce.current.exportAsSvg(),he.current.exportAsSvg(),(t=de.current,(new window.XMLSerializer).serializeToString(t)));!function(t,e){var i="string"===typeof e?new Blob([e],{type:"application/octet-stream"}):e;if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(i,t);else{var a=window.document.createElement("a");a.href=window.URL.createObjectURL(i),a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(a.href)}}("abc-enhancers.svg",new Blob([e],{type:"image/svg+xml"}))},fullWidth:!0,disableElevation:!0},"Export as SVG")))))),o.a.createElement("main",{className:ea.content},o.a.createElement("div",{className:ea.toolbar}),o.a.createElement("div",{className:ea.higlass},o.a.createElement(I.a,{container:!0,direction:"column",className:ea.higlassEnhancer},o.a.createElement(I.a,{item:!0,className:ea.titleBar,container:!0,justify:"space-between",alignItems:"center",wrap:"nowrap"},o.a.createElement(I.a,{item:!0,container:!0,wrap:"nowrap",alignItems:"center",className:ea.titleBarContainer},o.a.createElement(W.a,{component:"h3",className:"".concat(ea.titleBarText," ").concat(ea.titleBarTitle),noWrap:!0},"ABC Enhancers:")),o.a.createElement(I.a,{item:!0,className:ea.titleBarMiddle},o.a.createElement("div",{className:"full-wh"},o.a.createElement(I.a,{container:!0,justify:"center",alignItems:"center",wrap:"nowrap",className:ea.titleBarMiddleContent},ii?o.a.createElement(W.a,{component:"div",className:"".concat(ea.panZoomTipActive," ").concat(Qe?"show":""),noWrap:!0},"You can now pan & zoom the plot! Click outside the plot to deactivate pan & zoom!"):o.a.createElement(W.a,{component:"span",className:"".concat(ea.panZoomTip," ").concat(Qe?"show":""),noWrap:!0},"Click inside the plot below to activate pan & zoom!")))),o.a.createElement(I.a,{item:!0},o.a.createElement(N.a,{"aria-label":"help","aria-describedby":Di,className:ea.titleBarIcon,size:"small",onClick:function(t){Ce(t.currentTarget)}},o.a.createElement(X.a,{fontSize:"inherit"})),o.a.createElement(D.a,{id:Di,open:Pi,anchorEl:ke,onClose:function(){Ce(null)},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},o.a.createElement(W.a,{className:ea.titleBarHelpPopeover},"This panel visualizes the predicted enhancers by sample type as a matrix-like track. Each rectangle representes an enhancer. Promoter regions are indicated by translucent light gray overlays."),o.a.createElement(W.a,{className:ea.titleBarHelpPopeover}," ","You can filter enhancers via their target gene or by variant (the dot plot below the gene annotations). Click on a variant or gene to select it. Selections are shown in pink/red.")))),o.a.createElement(I.a,{item:!0,className:ea.grow,style:{position:"relative"}},o.a.createElement("div",{className:ea.fullWidthHeight,style:{overflow:"auto"}},o.a.createElement(I.a,{container:!0,direction:"column",className:ea.higlassEnhancerContainer},o.a.createElement(I.a,{item:!0,className:ea.higlassEnhancerInfoBar},o.a.createElement(I.a,{container:!0,justify:"space-between",alignItems:"center",wrap:"nowrap"},o.a.createElement(W.a,{component:"h4",className:ea.infoBarTitle,noWrap:!0},"Enhancer Regions"),o.a.createElement(I.a,{item:!0},o.a.createElement(I.a,{container:!0,alignItems:"center",wrap:"nowrap"},o.a.createElement(N.a,{"aria-label":"details",className:ia,size:"small",onClick:function(){jt(!_t)}},o.a.createElement(q.a,{fontSize:"inherit"})),o.a.createElement(N.a,{"aria-label":"settings","aria-describedby":Bi,className:aa,size:"small",onClick:function(t){Pe(t.currentTarget)}},o.a.createElement(J.a,{fontSize:"inherit"})),o.a.createElement(D.a,{id:Bi,open:Gi,anchorEl:ze,onClose:function(){Pe(null)},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},o.a.createElement(E.a,{m:1},o.a.createElement(j.a,{control:o.a.createElement(H.a,{checked:U,onChange:function(t){Y(t.target.checked)},name:"hideUnfocused"}),label:"Hide unfocused enhancer regions"})),o.a.createElement(E.a,{m:1},o.a.createElement(_.a,{component:"fieldset"},o.a.createElement(R.a,{component:"legend",className:ea.iconRadioLegend},"Variant y-scale"),o.a.createElement(F.a,{"aria-label":"variantYScale",name:"variantYScale",value:rt},o.a.createElement(j.a,{label:"p-value",value:"pValue",className:ea.iconRadio,control:o.a.createElement(N.a,{size:"small",onClick:Ti("pValue")},"pValue"===rt?o.a.createElement(K.a,{className:ea.iconRadioActive,fontSize:"inherit"}):o.a.createElement($.a,{fontSize:"inherit"}))}),o.a.createElement(j.a,{label:"Posterior probability",value:"posteriorProbability",className:ea.iconRadio,control:o.a.createElement(N.a,{size:"small",onClick:Ti("posteriorProbability")},"posteriorProbability"===rt?o.a.createElement(K.a,{className:ea.iconRadioActive,fontSize:"inherit"}):o.a.createElement($.a,{fontSize:"inherit"}))})))),o.a.createElement(E.a,{m:1},o.a.createElement(_.a,{component:"fieldset"},o.a.createElement(R.a,{component:"legend",className:ea.iconRadioLegend},"Matrix coloring"),o.a.createElement(F.a,{"aria-label":"matrixColoring",name:"matrixColoring",value:tt},o.a.createElement(j.a,{label:"Solid",value:"solid",className:ea.iconRadio,control:o.a.createElement(N.a,{size:"small",onClick:Ai("solid")},"solid"===tt?o.a.createElement(K.a,{className:ea.iconRadioActive,fontSize:"inherit"}):o.a.createElement($.a,{fontSize:"inherit"}))}),o.a.createElement(j.a,{label:"Number of predictions",value:"frequency",className:ea.iconRadio,control:o.a.createElement(N.a,{size:"small",onClick:Ai("frequency")},"frequency"===tt?o.a.createElement(K.a,{className:ea.iconRadioActive,fontSize:"inherit"}):o.a.createElement($.a,{fontSize:"inherit"}))}),o.a.createElement(j.a,{label:"Highest prediction score",value:"highestImportance",className:ea.iconRadio,control:o.a.createElement(N.a,{size:"small",onClick:Ai("highestImportance")},"highestImportance"===tt?o.a.createElement(K.a,{className:ea.iconRadioActive,fontSize:"inherit"}):o.a.createElement($.a,{fontSize:"inherit"}))}),o.a.createElement(j.a,{label:"Prediction score of the closest connection",value:"closestImportance",className:ea.iconRadio,control:o.a.createElement(N.a,{size:"small",onClick:Ai("closestImportance")},"closestImportance"===tt?o.a.createElement(K.a,{className:ea.iconRadioActive,fontSize:"inherit"}):o.a.createElement($.a,{fontSize:"inherit"}))})))))))),_t&&d&&v&&o.a.createElement(W.a,{className:ea.titleBarText,noWrap:!0},o.a.createElement("span",{className:ea.pink},"\u25a0")," Enhancers containing ",o.a.createElement("em",null,v)," and predicted to regulate ",o.a.createElement("em",null,d)),_t&&d&&!v&&o.a.createElement(W.a,{className:ea.titleBarText,noWrap:!0},o.a.createElement("span",{className:ea.pink},"\u25a0")," Enhancers predicted to regulate ",o.a.createElement("em",null,d)),_t&&!d&&v&&o.a.createElement(W.a,{className:ea.titleBarText,noWrap:!0},o.a.createElement("span",{className:ea.pink},"\u25a0")," Enhancers containing ",o.a.createElement("em",null,v)),_t&&(d||v?o.a.createElement(W.a,{className:ea.titleBarText,noWrap:!0},o.a.createElement("span",{className:ea.gray},"\u25a0")," All other predicted enhancers"):o.a.createElement(W.a,{className:ea.titleBarText,noWrap:!0},o.a.createElement("span",{className:ea.black},"\u25a0")," All predicted enhancers"))),o.a.createElement(I.a,{item:!0,className:ea.grow,onMouseEnter:Qi,onMouseLeave:$i,ref:ni,style:{height:"".concat(bi,"px")}},o.a.createElement(c.HiGlassComponent,{ref:Li,viewConfig:vi,options:{sizeMode:"bounded",globalMousePosition:!0}}),o.a.createElement("div",{className:Ci,onMouseDown:Ni,onFocus:Zi,onBlur:Ki,tabIndex:"0"})),o.a.createElement(I.a,{item:!0,className:ea.higlassEnhancerInfoBar},o.a.createElement(I.a,{container:!0,justify:"space-between",alignItems:"center",wrap:"nowrap"},o.a.createElement(W.a,{component:"h4",className:ea.infoBarTitle,noWrap:!0},"Enhancer-Gene Connections"),o.a.createElement(I.a,{item:!0},o.a.createElement(I.a,{container:!0,alignItems:"center",wrap:"nowrap"},o.a.createElement(N.a,{"aria-label":"details",className:na,size:"small",onClick:function(){Pt(!Nt)}},o.a.createElement(q.a,{fontSize:"inherit"})),o.a.createElement(N.a,{"aria-label":"settings","aria-describedby":Vi,className:oa,size:"small",onClick:function(t){Ge(t.currentTarget)}},o.a.createElement(J.a,{fontSize:"inherit"})),o.a.createElement(D.a,{id:Vi,open:Wi,anchorEl:He,onClose:function(){Ge(null)},anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"right"}},o.a.createElement(E.a,{m:1},o.a.createElement(j.a,{control:o.a.createElement(H.a,{checked:qt,onChange:function(t){Ut(t.target.checked)},name:"true"}),label:"Gene padding"})),o.a.createElement(E.a,{m:1},o.a.createElement(_.a,{component:"fieldset"},o.a.createElement(R.a,{component:"legend",className:ea.iconRadioLegend},"Gene Cell Encoding"),o.a.createElement(F.a,{"aria-label":"geneCellEncoding",name:"geneCellEncoding",value:Jt},o.a.createElement(j.a,{label:"Number of predictions",value:"number",className:ea.iconRadio,control:o.a.createElement(N.a,{size:"small",onClick:_i("number")},"number"===Jt?o.a.createElement(K.a,{className:ea.iconRadioActive,fontSize:"inherit"}):o.a.createElement($.a,{fontSize:"inherit"}))}),o.a.createElement(j.a,{label:"Percentage of samples with predictions",value:"percent",className:ea.iconRadio,control:o.a.createElement(N.a,{size:"small",onClick:_i("percent")},"percent"===Jt?o.a.createElement(K.a,{className:ea.iconRadioActive,fontSize:"inherit"}):o.a.createElement($.a,{fontSize:"inherit"}))}),o.a.createElement(j.a,{label:"Distribution by prediction score",value:"distribution",className:ea.iconRadio,control:o.a.createElement(N.a,{size:"small",onClick:_i("distribution")},"distribution"===Jt?o.a.createElement(K.a,{className:ea.iconRadioActive,fontSize:"inherit"}):o.a.createElement($.a,{fontSize:"inherit"}))}),o.a.createElement(j.a,{label:"Sample array",value:"array",className:ea.iconRadio,control:o.a.createElement(N.a,{size:"small",onClick:_i("array")},"array"===Jt?o.a.createElement(K.a,{className:ea.iconRadioActive,fontSize:"inherit"}):o.a.createElement($.a,{fontSize:"inherit"}))})))))))),Nt&&v&&o.a.createElement(W.a,{className:ea.titleBarText},"Enhancer region overlapping ",o.a.createElement("em",null,v)," and its predicted connections to upstream (left) and downstream (right) genes.")),o.a.createElement(I.a,{item:!0,className:ea.higlassEnhancerGenePlot},v?o.a.createElement(Qt,{geneCellEncoding:Jt,position:ci,relPosition:ui,fullPosition:hi,variant:v,genePadding:qt,openTooltip:Yi,closeTooltip:Ji,svgRef:de}):o.a.createElement(I.a,{container:!0,justify:"center",alignItems:"center",className:ea.higlassEnhancerGenePlotPlaceholder},o.a.createElement(W.a,null,"Select a variant to see details"))))))),o.a.createElement("div",{className:ea.higlassSeparator}),o.a.createElement(I.a,{container:!0,direction:"column",className:ea.higlassDnaAccessibility},o.a.createElement(I.a,{item:!0,className:ea.titleBar,container:!0,justify:"space-between",alignItems:"center",wrap:"nowrap"},o.a.createElement(I.a,{item:!0,container:!0,alignItems:"center",wrap:"nowrap"},o.a.createElement(W.a,{component:"h3",className:"".concat(ea.titleBarText," ").concat(ea.titleBarTitle),noWrap:!0},"DNA Accessibility:")),o.a.createElement(I.a,{item:!0},o.a.createElement(N.a,{"aria-label":"help","aria-describedby":Hi,className:ea.titleBarIcon,size:"small",onClick:function(t){Ie(t.currentTarget)}},o.a.createElement(X.a,{fontSize:"inherit"})),o.a.createElement(D.a,{id:Hi,open:Fi,anchorEl:Re,onClose:function(){Ie(null)},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},o.a.createElement(W.a,{className:ea.titleBarHelpPopeover},"This panel visualizes the DNA accessibility of all 131 samples. Each track is individually normalized. Mouse over a track to see the underlying value. To focus on a specific locus specify a focus variant.")))),o.a.createElement(I.a,{item:!0,container:!0,direction:"column",className:ea.grow},o.a.createElement(I.a,{item:!0,className:ea.dnaAccessibilityInfoBar},o.a.createElement(I.a,{container:!0,justify:"space-between",alignItems:"center",wrap:"nowrap"},o.a.createElement(W.a,{component:"h4",className:ea.infoBarTitle,noWrap:!0},"ATAC & DNase-Seq"),o.a.createElement(I.a,{item:!0},o.a.createElement(I.a,{container:!0,alignItems:"center",wrap:"nowrap"},o.a.createElement(N.a,{"aria-label":"details",className:ra,size:"small",onClick:function(){Bt(!Gt)}},o.a.createElement(q.a,{fontSize:"inherit"})),o.a.createElement(N.a,{"aria-label":"settings","aria-describedby":Ui,className:sa,size:"small",onClick:function(t){qe(t.currentTarget)}},o.a.createElement(J.a,{fontSize:"inherit"})),o.a.createElement(D.a,{id:Ui,open:qi,anchorEl:Ve,onClose:function(){qe(null)},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}}," ",o.a.createElement(E.a,{m:1},o.a.createElement(_.a,{component:"fieldset"},o.a.createElement(R.a,{component:"legend",className:ea.iconRadioLegend},"Labels"),o.a.createElement(F.a,{"aria-label":"dnaAccessLabels",name:"dnaAccessLabels",value:ut},o.a.createElement(j.a,{label:"Indicator",value:"indicator",className:ea.iconRadio,control:o.a.createElement(N.a,{size:"small",onClick:Mi("indicator")},"indicator"===ut?o.a.createElement(K.a,{className:ea.iconRadioActive,fontSize:"inherit"}):o.a.createElement($.a,{fontSize:"inherit"}))}),o.a.createElement(j.a,{label:"Text",value:"text",className:ea.iconRadio,control:o.a.createElement(N.a,{size:"small",onClick:Mi("text")},"text"===ut?o.a.createElement(K.a,{className:ea.iconRadioActive,fontSize:"inherit"}):o.a.createElement($.a,{fontSize:"inherit"}))}),o.a.createElement(j.a,{label:"Hidden",value:"hidden",className:ea.iconRadio,control:o.a.createElement(N.a,{size:"small",onClick:Mi("hidden")},"hidden"===ut?o.a.createElement(K.a,{className:ea.iconRadioActive,fontSize:"inherit"}):o.a.createElement($.a,{fontSize:"inherit"}))})))))))),Gt&&o.a.createElement("div",{className:ea.dnaAccessibilityInfoBarRegion},o.a.createElement("span",null,"\u251c"),o.a.createElement(W.a,{align:"center",className:ea.titleBarText,noWrap:!0},zt(yi,1)," ",o.a.createElement("abbr",{title:"kilo base pairs"},"kbp")),o.a.createElement("span",null,"\u2524"))),o.a.createElement(I.a,{item:!0,className:ea.grow},o.a.createElement(c.HiGlassComponent,{ref:zi,viewConfig:xi,options:{sizeMode:"scroll",pixelPreciseMarginPadding:!0,containerPaddingX:0,containerPaddingY:0,viewMarginTop:0,viewMarginBottom:0,viewMarginLeft:0,viewMarginRight:0,viewPaddingTop:0,viewPaddingBottom:0,viewPaddingLeft:0,viewPaddingRight:16,globalMousePosition:!0}}))))),o.a.createElement(it.a,{open:Ye.show,title:Ye.title,arrow:Ye.arrow,placement:Ye.placement,classes:Ye.classes},o.a.createElement("div",{className:ea.enhancerGeneTooltip,style:{top:Ye.y,left:Ye.x}}))),o.a.createElement(z.a,{"aria-labelledby":"info-title","aria-describedby":"info-description",className:ea.modal,open:a,onClose:Xi,closeAfterTransition:!0,BackdropComponent:p.a,BackdropProps:{timeout:250}},o.a.createElement(M.a,{in:a},o.a.createElement("div",{className:ea.paper},o.a.createElement(fe,{infoCloseHandler:Xi})))))},je=function(t,e){return function(i){return function(a){return t(a)?o.a.createElement(e,a):o.a.createElement(i,a)}}},Re=(i(422),Object(h.a)({palette:{primary:{main:"#000"},secondary:{main:"#000"}}})),Ie=function(){var t=Object(n.useState)(null),e=Object(l.a)(t,2),i=e[0],a=e[1];Object(n.useEffect)((function(){Object(c.ChromosomeInfo)("https://s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv").then((function(t){void 0===t.totalLength?a(!1):a(t)})).catch((function(){a(!1)}))}),[]);var r=Object(u.l)(je((function(){return null===i}),v),je((function(){return!1===i}),b))(_e);return o.a.createElement("div",{className:"App"},o.a.createElement(d.a,{theme:Re},o.a.createElement(r,{chromInfo:i})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ne=i(33),Le=i(27),ze=i(28);function Pe(t){if(!(this instanceof Pe?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var e=t.services.pubSub,i=function(){function t(e,i){var a=this;Object(Le.a)(this,t);var n=e.definition,o=e.getTrackObject,r=e.onNewTilesLoaded;this.animate=r,this.options=i,this.overlaysTrack=o(n.overlaysTrack),this.overlaysTrack?(this.annotationTrackIds=new Set,this.annotationTracks=n.options.annotationTracks.map((function(t){var e=o(t);return e?a.annotationTrackIds.add(e.uuid):console.warn("Child track (uid: ".concat(t,") not found")),e})).filter((function(t){return t})),this.annotationDrawnHandlerBound=this.annotationDrawnHandler.bind(this),this.tilesDrawnEndHandlerBound=this.tilesDrawnEndHandler.bind(this),this.drawnAnnotations=new Map,this.tracksDrawingTiles=new Set,this.pubSubs=[],this.annotationTracks.forEach((function(t){t.subscribe("annotationDrawn",a.annotationDrawnHandlerBound),t.subscribe("tilesDrawn",a.tilesDrawnEndHandlerBound)}))):console.warn("Overlays track (uid: ".concat(n.overlaysTrack,") not found"))}return Object(ze.a)(t,[{key:"annotationDrawnHandler",value:function(t){var e=t.xStartAbs,i=t.xEndAbs,a=t.data;this.drawnAnnotations.set(a.uid,[e,i])}},{key:"remove",value:function(){var t=this;this.pubSubs.forEach(e.unsubscribe),this.pubSubs=void 0,this.annotationTracks.forEach((function(e){e.unsubscribe("annotationDrawn",t.annotationDrawnHandlerBound)}))}},{key:"tilesDrawnEndHandler",value:function(t){var e=t.uuid;this.annotationTrackIds.has(e)&&(this.tracksDrawingTiles.add(e),this.tracksDrawingTiles.size%this.annotationTracks.length||this.updateOverlays())}},{key:"updateOverlays",value:function(){this.overlaysTrack.options.extent=Array.from(this.drawnAnnotations.values()),this.overlaysTrack.draw(),this.tracksDrawingTiles.clear()}}]),t}(),a=arguments.length,n=new Array(a>1?a-1:0),o=1;o<a;o++)n[o-1]=arguments[o];return Object(Ne.a)(i,n)}Pe.config={type:"annotation-overlay",availableOptions:["annotationTracks"],defaultOptions:{annotationTracks:[]}};var De=Pe,Fe=i(25),He=i(22),Ge=i(43),Be=i(44),We=Float32Array.BYTES_PER_ELEMENT,Ve="precision mediump float;\n\n  attribute vec2 aPrevPosition;\n  attribute vec2 aCurrPosition;\n  attribute vec2 aNextPosition;\n  attribute float aOffsetSign;\n  attribute float aColorIndex;\n\n  uniform sampler2D uAreaColorTex;\n  uniform float uAreaColorTexRes;\n  uniform mat3 projectionMatrix;\n  uniform mat3 translationMatrix;\n\n  uniform vec4 uLineColor;\n  uniform vec4 uNaNColor;\n  uniform float uWidth;\n  uniform int uMiter;\n\n  varying vec4 vColor;\n\n  void main(void)\n  {\n    mat3 model = projectionMatrix * translationMatrix;\n\n    if (aColorIndex <= -0.5) {\n      // Render line\n      vColor = vec4(uLineColor.rgb, 1.0);\n\n      vec4 prevGlPos = vec4((model * vec3(aPrevPosition, 1.0)).xy, 0.0, 1.0);\n      vec4 currGlPos = vec4((model * vec3(aCurrPosition, 1.0)).xy, 0.0, 1.0);\n      vec4 nextGlPos = vec4((model * vec3(aNextPosition, 1.0)).xy, 0.0, 1.0);\n\n      // Calculate the direction\n      vec2 dir = vec2(0.0);\n\n      if (currGlPos == prevGlPos) {\n        // start point uses (next - current)\n        dir = normalize(nextGlPos.xy - currGlPos.xy);\n      }\n      else if (currGlPos == nextGlPos) {\n        // end point uses (current - previous)\n        dir = normalize(currGlPos.xy - prevGlPos.xy);\n      }\n      else {\n        // somewhere in middle, needs a join:\n        // get directions from (C - B) and (B - A)\n        vec2 dirA = normalize((currGlPos.xy - prevGlPos.xy));\n        if (uMiter == 1) {\n          vec2 dirB = normalize((nextGlPos.xy - currGlPos.xy));\n          // now compute the miter join normal and length\n          vec2 tangent = normalize(dirA + dirB);\n          vec2 perp = vec2(-dirA.y, dirA.x);\n          vec2 miter = vec2(-tangent.y, tangent.x);\n          dir = tangent;\n        } else {\n          dir = dirA;\n        }\n      }\n\n      float width = (projectionMatrix * vec3(uWidth, 0.0, 0.0)).x / 2.0;\n\n      vec2 normal = vec2(-dir.y, dir.x) * width;\n      // normal.x /= aspectRatio;\n      vec4 offset = vec4(normal * aOffsetSign, 0.0, 0.0);\n      gl_Position = currGlPos + offset;\n    } else {\n      // Render area\n      float colorRowIndex = aColorIndex / uAreaColorTexRes;\n\n      vec2 colorTexIndex = vec2(\n        (aColorIndex / uAreaColorTexRes) - colorRowIndex,\n        colorRowIndex / uAreaColorTexRes\n      );\n      vColor = texture2D(uAreaColorTex, colorTexIndex);\n\n      gl_Position = vec4((model * vec3(aCurrPosition, 1.0)).xy, 0.0, 1.0);\n    }\n  }\n",qe="precision mediump float;\n\n  varying vec4 vColor;\n\n  void main() {\n    gl_FragColor = vColor;\n  }\n",Ue=Array(127).fill().map((function(t,e){var i=.5*(1-e/127)+.5;return[i,i,i,1]})),Xe=function(t){return Object.values(t).reduce((function(t,e){return Math.max(t,e.tileData.maxNonZero)}),-1/0)},Ye=function(t){return Object.values(t)[0].tileData.coarseShape[0]},Je=function(t){return Object(u.h)(Object.values(t).map((function(t){return t.tileData.maxValueByRow})))},Ze=function(t,e,i){var a=(i.domain()[1]-i.domain()[0])/(e.domain()[1]-e.domain()[0]),n=e.domain().map(i)[0];t.scale.x=a,t.position.x=-n*a},Ke=function(t,e,i){return e.length/t/4/(1+i)-2},Qe=function t(e){if(!(this instanceof t?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var i=e.libraries.PIXI,a=e.libraries.d3Format.format,n=e.libraries.d3Scale.scaleLinear,o=e.services.tileProxy,r=function(t){var e=Math.max(2,Math.ceil(Math.sqrt(t.length))),a=new Float32Array(4*Math.pow(e,2));return t.forEach((function(t,e){a[4*e]=t[0],a[4*e+1]=t[1],a[4*e+2]=t[2],a[4*e+3]=t[3]})),[i.Texture.fromBuffer(a,e,e),e]},s=function(t){Object(Ge.a)(c,t);var s=Object(Be.a)(c);function c(t,e){var a;return Object(Le.a)(this,c),(a=s.call(this,t,e)).updateOptions(),a.pLoading=new i.Graphics,a.pLoading.position.x=0,a.pLoading.position.y=0,a.pMasked.addChild(a.pLoading),a.loadIndicator=new i.Text("Loading data...",{fontSize:a.labelSize||10,fill:8421504}),a.pLoading.addChild(a.loadIndicator),a}return Object(ze.a)(c,[{key:"initTile",value:function(t){this.coarsifyTileValues(t)}},{key:"destroyTile",value:function(){}},{key:"binsPerTile",value:function(){return this.tilesetInfo.bins_per_dimension||256}},{key:"getTilePosAndDimensions",value:function(t,e,i){var a=i||this.binsPerTile();if(this.tilesetInfo.resolutions){var n=this.tilesetInfo.resolutions.map((function(t){return+t})).sort((function(t,e){return e-t}))[t],o=n*a,r=o;return{tileX:n*a*e[0],tileY:n*a*e[1],tileWidth:o,tileHeight:r}}var s=e[0],l=e[1],c=this.tilesetInfo.min_pos[0],u=this.options.reverseYAxis?-this.tilesetInfo.max_pos[1]:this.tilesetInfo.min_pos[1],h=this.tilesetInfo.max_width/Math.pow(2,t),d=this.tilesetInfo.max_width/Math.pow(2,t);return{tileX:c+s*h,tileY:u+l*d,tileWidth:h,tileHeight:d}}},{key:"updateOptions",value:function(){var t=this;switch(this.selectRowsAggregationMode=this.options.selectRowsAggregationMode||"mean",this.selectRowsAggregationMode){case"max":this.selectRowsAggregationFn=u.g;break;case"min":this.selectRowsAggregationFn=u.j;break;case"sum":this.selectRowsAggregationFn=u.m;break;case"mean":default:this.selectRowsAggregationFn=u.i}this.markArea=!!this.options.markArea,this.markAreaColor="grays",this.markColor=e.utils.colorToHex(this.options.markColor||"black"),this.markColorRgbNorm=this.options.markColor?e.utils.colorToRgba(this.options.markColor).slice(0,3).map((function(t){return Math.min(1,Math.max(0,t/255))})):[0,0,0];var i=r(Object(k.a)(Ue)),a=Object(l.a)(i,2);this.markColorTex=a[0],this.markColorTexRes=a[1],this.markNumColors=Ue.length,this.markOpacity=Number.isNaN(+this.options.markOpacity)?1:Math.min(1,Math.max(0,+this.options.markOpacity)),this.markSize=this.options.markSize||2;var n=this.markResolution;this.markResolution=Math.max(1,Math.min(256,this.options.markResolution||64));var o=this.rowHeight;this.rowHeight=Number.isNaN(+this.options.rowHeight)?"auto":+this.options.rowHeight;var s=this.rowPadding;this.rowPadding="auto"===this.rowHeight?0:this.options.rowPadding||0;var c=this.rowNormalization;this.rowNormalization=this.options.rowNormalization||!1;var h=this.rowSelections;this.rowSelections=this.options.rowSelections||this.rowSelections||[],n===this.markResolution&&h===this.rowSelections||this.updateTiles(),o===this.rowHeight&&s===this.rowPadding&&c===this.rowNormalization||this.updateScales();var d=this.showRowLabels;this.showRowLabels=this.options.showRowLabels,d!==this.showRowLabels&&(this.updateRowLabels(d),this.drawLabel()),this.rowLabelAlign=this.options.rowLabelAlign||"left",this.rowLabelSize=this.options.rowLabelSize||12,this.rowCategories=this.options.rowCategories||{},this.rowIdToCategory=function(t){return t.substring(0,t.length-14)},this.rowIdToCategory=this.options.rowIdToCategory?function(e){return e[t.options.rowIdToCategory.fn].apply(e,Object(k.a)(t.options.rowIdToCategory.args))}:u.c}},{key:"removeRowLabels",value:function(){for(;this.pAxis.children.length;)this.pAxis.removeChildAt(0);this.rowLabels&&(this.rowLabels.forEach((function(t){t.destroy()})),this.rowLabels=void 0)}},{key:"updateRowLabels",value:function(t){var a=this;if(this.tilesetInfo&&this.tilesetInfo.row_infos){var n=this.rowSelections.length?this.rowSelections.map((function(t){return void 0===a.tilesetInfo.row_infos[t]?"?":a.rowIdToCategory(a.tilesetInfo.row_infos[t].id)})):this.tilesetInfo.row_infos.map((function(t){var e=t.id;return a.rowIdToCategory(e)}));this.removeRowLabels(),"indicator"===this.showRowLabels?this.rowLabels=n.map((function(t){var n=new i.Sprite(i.Texture.WHITE);return n.width=a.rowLabelSize/2,n.height=a.rowLabelSize,n.tint=a.rowCategories[t]?e.utils.colorToHex(a.rowCategories[t].axisLabelColor||yt[a.rowCategories[t].index%yt.length]):8421504,n})):this.showRowLabels&&(this.rowLabels=n.map((function(t){return new i.Text(t,{fontSize:a.rowLabelSize,align:"right"===a.rowLabelAlign?"right":"left",fill:a.rowCategories[t]?e.utils.colorToHex(a.rowCategories[t].axisLabelColor||wt[a.rowCategories[t].index%wt.length]):8421504})})))}}},{key:"drawLabel",value:function(){var t=this;if(this.showRowLabels){if(this.showRowLabels&&!this.rowLabels&&this.updateRowLabels(),this.rowLabels){var e=Object(l.a)(this.dimensions,1)[0],i=Object(l.a)(this.position,2),a=i[0],n=i[1];this.pAxis.position.x="right"===this.axisAlign?a+e:a,this.pAxis.position.y=n,this.pAxis.clear();var o=0,r="right"===this.axisAlign?-3:3,s=this.getRowHeight(),c=Object(l.a)(s,2)[1],u=c/2;this.rowLabels.forEach((function(e,i){e.x=r,e.y=o-t.rowPadding+u,e.anchor.x="right"===t.axisAlign?1:0,e.anchor.y=.5,o+=c,t.pAxis.addChild(e)}))}}else if(this.rowLabels)for(;this.pAxis.children.length;)this.pAxis.removeChildAt(0)}},{key:"rerender",value:function(t){this.options=t,this.updateOptions(),this.updateExistingGraphics()}},{key:"hasFetchedTiles",value:function(){return Object.values(this.fetchedTiles).length}},{key:"coarsifyTileValues",value:function(t){var e=this.getTilePosAndDimensions(t.tileData.zoomLevel,t.tileData.tilePos),i=e.tileX,a=e.tileWidth,n=Object(l.a)(t.tileData.shape,1)[0],o=Math.floor(256/this.markResolution),r=a/this.markResolution,s=r/2;t.tileData.binXPos=Array(this.markResolution).fill();for(var c=0;c<=this.markResolution;c++)t.tileData.binXPos[c]=i+r*c+s;t.tileData.valuesByRow=Array(n).fill().map((function(){return[]})),t.tileData.maxValueByRow=Array(n).fill(-1/0);for(var h=0;h<n;h++)for(var d=0;d<256;d+=o){var p=Object(u.i)(t.tileData.dense.subarray(256*h+d,256*h+d+o));t.tileData.valuesByRow[h].push(p),t.tileData.maxValueByRow[h]=p>t.tileData.maxValueByRow[h]?p:t.tileData.maxValueByRow[h]}this.rowSelections.length&&(t.tileData.valuesByRow=this.rowSelections.map((function(e){return t.tileData.valuesByRow[e]})).filter(u.c),t.tileData.maxValueByRow=this.rowSelections.map((function(e){return t.tileData.maxValueByRow[e]})).filter(u.c)),t.tileData.coarseShape=[t.tileData.valuesByRow.length,this.markResolution]}},{key:"updateTiles",value:function(){Object.values(this.fetchedTiles).forEach(this.coarsifyTileValues.bind(this))}},{key:"updateScales",value:function(){var t=this,e=Object.values(this.fetchedTiles);if(e.length){var i=Ye(e),a=this.getRowHeight(),o=Object(l.a)(a,1)[0],r=this.getTrackHeight(i,o),s=Xe(this.fetchedTiles);if(this.valueScale=n().domain([0,s]).range([o,0]),this.colorIndexScale=n().domain([0,s]).range([0,this.markNumColors]).clamp(!0),this.rowNormalization){var c=Je(this.fetchedTiles);this.rowValueScales={},this.rowColorIndexScales={};for(var u=0;u<i;u++)this.rowValueScales[u]=n().domain([0,c[u]]).range([o,0]),this.rowColorIndexScales[u]=n().domain([0,c[u]]).range([0,this.markNumColors]).clamp(!0);this.valueScaleByRow=function(e,i){return Number.isNaN(e)?o:t.rowValueScales[i](e)},this.colorIndexScaleByRow=function(e,i){return Number.isNaN(e)?-2:t.rowColorIndexScales[i](e)}}else this.valueScaleByRow=function(e,i){return Number.isNaN(e)?o:t.valueScale(e)},this.colorIndexScaleByRow=function(e,i){return Number.isNaN(e)?-2:t.colorIndexScale(e)};this.rowScale=n().domain([0,i]).range([0,r+this.rowPadding])}}},{key:"tilesToData",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=i.markArea,n=i.maxRows,o=void 0===n?1/0:n,r=i.rowHeight;if(!t.length)return[];var s=Math.min(o,Ye(t)),l=Array(s).fill().map((function(){return[]})),c=Array(s).fill().map((function(){return[]})),h=Array(s).fill().map((function(){return[]}));t.forEach((function(t){t.tileData.valuesByRow.forEach((function(i,n){n>=o||i.forEach((function(i,o){var s=e._xScale(t.tileData.binXPos[o]),u=e.rowScale(n),d=u+e.valueScaleByRow(i,n);l[n].push(s,d,s,d),c[n].push(-1,-1),h[n].push(1,-1),a&&(l[n].push(s,d,s,u+r),c[n].push(e.colorIndexScaleByRow(i,n),0),h[n].push(0,0))}))}))}));for(var d=a?8:4,p=a?4:2,m=0;m<s;m++){var g,f,v,b,x,y;if((g=l[m]).unshift.apply(g,Object(k.a)(l[m].slice(0,d))),m>0)(x=c[m]).unshift.apply(x,Object(k.a)(c[m].slice(0,p))),(y=h[m]).unshift.apply(y,Object(k.a)(h[m].slice(0,p)));(f=l[m]).push.apply(f,Object(k.a)(l[m].slice(-d))),(v=c[m]).push.apply(v,Object(k.a)(c[m].slice(-p))),(b=h[m]).push.apply(b,Object(k.a)(h[m].slice(-p)))}return[new Float32Array(l.flatMap(u.c)),new Float32Array(c.flatMap(u.c)),new Float32Array(h.flatMap(u.c))]}},{key:"toLineIndices",value:function(t,e,i){var a=i?12:6,n=i?4:2,o=new Uint32Array((e-1)*t*a),r=0;if(i)for(var s=0;s<t;s++)for(var l=0;l<e-1;l++){var c=s*(e+2)*n+l*n,u=c+1,h=c+2,d=c+3,p=c+4,m=c+5,g=c+6,f=c+7,v=r*a;o[v]=h,o[v+1]=d,o[v+2]=g,o[v+3]=g,o[v+4]=d,o[v+5]=f,o[v+6]=c,o[v+7]=u,o[v+8]=p,o[v+9]=p,o[v+10]=u,o[v+11]=m,r++}else for(var b=0;b<t;b++)for(var x=0;x<e-1;x++){var y=b*(e+2)*n+x*n,w=y+1,k=y+2,C=y+3,E=r*a;o[E]=y,o[E+1]=w,o[E+2]=k,o[E+3]=k,o[E+4]=w,o[E+5]=C,r++}return o}},{key:"getRowHeight",value:function(t){var e=Object(l.a)(this.dimensions,2)[1];return"auto"===this.rowHeight?[Math.floor(e/t),Math.floor(e/t)]:[this.rowHeight,this.rowHeight+this.rowPadding]}},{key:"getTrackHeight",value:function(t,e){var i=Object(l.a)(this.dimensions,2)[1];return"auto"===this.rowHeight?i:e*t+this.rowPadding*(t-1)}},{key:"renderLines",value:function(){this.drawnAtScale=n().domain(Object(k.a)(this.xScale().domain())).range(Object(k.a)(this.xScale().range()));var t=Object.values(this.fetchedTiles),e=Ye(t),a=this.getRowHeight(e),o=Object(l.a)(a,1)[0],r=this.tilesToData(t,{maxRows:e,markArea:this.markArea,rowHeight:o}),s=Object(l.a)(r,3),c=s[0],u=s[1],h=s[2],d=Ke(e,c,this.markArea),p=this.toLineIndices(e,d,this.markArea),m=new i.UniformGroup({uLineColor:[].concat(Object(k.a)(this.markColorRgbNorm),[1]),uNaNColor:[1,1,1,1],uAreaColorTex:this.markColorTex,uAreaColorTexRes:this.markColorTexRes,uWidth:.25,uMiter:1}),g=i.Shader.from(Ve,qe,m),f=new i.Geometry,v=this.markArea?4:2;f.addAttribute("aPrevPosition",c,2,!1,i.TYPES.FLOAT,2*We,0),f.addAttribute("aCurrPosition",c,2,!1,i.TYPES.FLOAT,2*We,2*We*v),f.addAttribute("aNextPosition",c,2,!1,i.TYPES.FLOAT,2*We,2*We*v*2),f.addAttribute("aOffsetSign",h,1),f.addAttribute("aColorIndex",u,1),f.addIndex(p);var b=new i.Mesh(f,g),x=new i.Graphics;x.addChild(b),this.pMain.x=this.position[0],this.lineGraphics&&(this.pMain.removeChild(this.lineGraphics),this.lineGraphics.destroy()),this.pMain.addChild(x),this.lineGraphics=x,Ze(this.lineGraphics,this._xScale,this.drawnAtScale),this.draw(),this.animate()}},{key:"updateExistingGraphics",value:function(){this.updateLoadIndicator(),this.hasFetchedTiles()&&(this.updateScales(),this.renderLines())}},{key:"updateLoadIndicator",value:function(){var t=Object(l.a)(this.position,2),e=t[0],i=t[1];this.pLoading.position.x=e+6,this.pLoading.position.y=i+6,this.fetching.size?this.pLoading.addChild(this.loadIndicator):this.pLoading.removeChild(this.loadIndicator)}},{key:"refreshTiles",value:function(){Object(Fe.a)(Object(He.a)(c.prototype),"refreshTiles",this).call(this),this.updateLoadIndicator()}},{key:"setPosition",value:function(t){Object(Fe.a)(Object(He.a)(c.prototype),"setPosition",this).call(this,t);var e=Object(l.a)(this.position,2);this.pMain.position.x=e[0],this.pMain.position.y=e[1]}},{key:"zoomed",value:function(t,e){this.xScale(t),this.yScale(e),this.lineGraphics&&Ze(this.lineGraphics,t,this.drawnAtScale),this.refreshTiles(),this.draw()}},{key:"getVisibleData",value:function(t,e){var i=this;if(!this.hasFetchedTiles())return"";var n=this.calculateZoomLevel(),r=Ye(this.fetchedTiles),s=this.getRowHeight(r),c=Object(l.a)(s,2)[1],u=o.calculateTileWidth(this.tilesetInfo,n,this.tilesetInfo.tile_size),h=this._xScale.invert(t)/u,d=this.tilesetInfo.tile_size*(h-Math.floor(h)),p=Math.floor(Math.max(0,(e+this.rowPadding)/c)),m=this.rowSelections[p],g=this.tileToLocalId([n,Math.floor(h)]),f=this.fetchedTiles[g],v="",b="<em>unknown</em>";if(f){this.tilesetInfo.shape||(d=f.tileData.dense.length*(h-Math.floor(h)));var x=null;if(x=this.tilesetInfo.shape?Array.isArray(m)&&"client"===this.options.selectRowsAggregationMethod?m.map((function(t){return i.tilesetInfo.shape[0]*t+Math.floor(d)})):m&&"client"===this.options.selectRowsAggregationMethod?this.tilesetInfo.shape[0]*m+Math.floor(d):this.tilesetInfo.shape[0]*p+Math.floor(d):f.tileData.dense.length*p+Math.floor(d),Array.isArray(x)){var y=x.map((function(t){return f.tileData.dense[t]}));v=b=a(".3f")(this.selectRowsAggregationFn(y)),v+="<br/>",v+="".concat(x.length,"-item ").concat(this.options.selectRowsAggregationMode)}else v=b=a(".3f")(f.tileData.dense[x]),Array.isArray(m)&&(b+="<br/>",b+="".concat(m.length,"-item ").concat(this.options.selectRowsAggregationMode))}if(this.tilesetInfo.row_infos){var w="";void 0!==m?w=this.tilesetInfo.row_infos[m]:p&&(w=this.tilesetInfo.row_infos[p]);var k="object"===typeof w?this.rowIdToCategory(w.id):w,C=this.rowCategories[k]?this.rowCategories[k].axisLabelColor||wt[this.rowCategories[k].index%wt.length]:"#666666",E=this.rowCategories[k]?this.rowCategories[k].axisLabelColor||kt[this.rowCategories[k].index%kt.length]:"#ffffff";return'<div style="margin: -0.25rem; padding: 0 0.25rem; background: '.concat(E,'"><strong style="color: ').concat(C,';">').concat(k,":</strong> ").concat(b,"</div>")}return v}},{key:"getMouseOverHtml",value:function(t,e){return this.tilesetInfo?this.getVisibleData(t,e):""}},{key:"exportSVG",value:function(){var t="http://www.w3.org/2000/svg",e=null,i=null,a=Object(Fe.a)(Object(He.a)(c.prototype),"exportSVG",this).call(this),n=Object(l.a)(a,2);i=n[0],e=n[1],i.setAttribute("class","ridge-plot-track");var o=document.createElement("g");e.appendChild(o),o.setAttribute("transform","translate(".concat(this.position[0],", ").concat(this.position[1],")"));var r=Object.values(this.fetchedTiles),s=Ye(r),u=this.getRowHeight(s),h=Object(l.a)(u,1)[0],d=this.markArea?8:4,p=this.tilesToData(r,{maxRows:s,markArea:this.markArea,rowHeight:h}),m=Object(l.a)(p,1)[0],g=Object(vt.b)().x((function(t){return t[0]})).y((function(t){return t[1]})),f=m.length/s,v=function(t){for(var e=[],i=d,a=t.length-d,n=i;n<a;n+=d)e.push([t[n],t[n+1]]);return e},b=this.markArea?this.options.colorRange&&this.options.colorRange[0]||"#ffffff":"none";if(this.markArea&&this.options.colorRange){var x=this.options.colorRange.length,y=document.createElementNS(t,"defs"),w=document.createElementNS(t,"linearGradient");w.setAttribute("id","RidgePlotGradient"),w.setAttribute("x1","0"),w.setAttribute("y1","1"),w.setAttribute("x2","0"),w.setAttribute("y2","0"),this.options.colorRange.forEach((function(e,i){var a=document.createElementNS(t,"stop");a.setAttribute("offset","".concat(Math.round(i/(x-1)*100),"%")),a.setAttribute("stop-color",e),w.appendChild(a)})),y.appendChild(w),i.insertBefore(y,i.firstChild),b="url(#RidgePlotGradient)"}for(var k=0;k<s;k++){var C=v(m.subarray(k*f,(k+1)*f)),E=document.createElement("path"),S=g(C),O=this.rowScale(k)+this.valueScaleByRow(0,k),T=S.indexOf(","),A=+S.substring(1,T),M=+S.substring(T+1,S.indexOf("L")),_=(S="M".concat(A-1,",").concat(O,"L").concat(A-1,",").concat(M,"L").concat(S.substring(1))).lastIndexOf(","),j=+S.substring(S.lastIndexOf("L")+1,_),R=+S.substring(_+1);S+="L".concat(j+1,",").concat(R,"L").concat(j+1,",").concat(O),E.setAttribute("d",S),E.setAttribute("fill",b),E.setAttribute("stroke",this.options.markColor||"black"),E.setAttribute("stroke-width",(this.options.markSize||2)/8),o.appendChild(E)}return[i,e]}}]),c}(e.tracks.HorizontalLine1DPixiTrack),c=arguments.length,h=new Array(c>1?c-1:0),d=1;d<c;d++)h[d-1]=arguments[d];return Object(Ne.a)(s,h)};Qe.config={type:"ridge-plot",datatype:["multivec"],orientation:"1d",name:"RidgePlot"};var $e=Qe,ti=i(228),ei=i.n(ti),ii="\n  precision mediump float;\n  attribute vec2 aPosition;\n  attribute float aOpacity;\n  attribute float aHighlight;\n\n  uniform mat3 projectionMatrix;\n  uniform mat3 translationMatrix;\n  uniform float uPointSize;\n\n  varying float vHighlight;\n  varying float vOpacity;\n\n  void main(void)\n  {\n    vHighlight = aHighlight;\n    vOpacity = aOpacity;\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n    gl_PointSize = uPointSize;\n  }\n",ai="\n  precision mediump float;\n\n  uniform vec4 uColor;\n  uniform vec4 uColorHighlight;\n\n  varying float vHighlight;\n  varying float vOpacity;\n\n  void main() {\n    float isNotFocused = 1.0 - vHighlight;\n\n    float r = uColor.r * isNotFocused + uColorHighlight.r * vHighlight;\n    float g = uColor.g * isNotFocused + uColorHighlight.g * vHighlight;\n    float b = uColor.b * isNotFocused + uColorHighlight.b * vHighlight;\n\n    gl_FragColor = vec4(r, g, b, 1.0) * vOpacity;\n  }\n",ni=function(t){return[t.cX-t.widthHalf,t.y,t.cX+t.widthHalf,t.y,t.cX+t.widthHalf,t.y+t.height,t.cX-t.widthHalf,t.y+t.height]},oi=function(t,e){var i=4*e;return[i,i+1,i+2,i+2,i+3,i]},ri=function(t){return[t.opacity,t.opacity,t.opacity,t.opacity]},si=function(t){return[t.highlight,t.highlight,t.highlight,t.highlight]},li=function(t){return Math.abs(+t.fields[1]+(+t.fields[2]-+t.fields[1])/2-(+t.fields[4]+(+t.fields[4]-+t.fields[5])/2))},ci=function(t){return Object.values(t).reduce((function(t,e){return Math.max(t,e.tileData.reduce((function(t,e){return Math.max(t,e.distance)}),0))}),0)},ui=function(t,e,i){var a=(i.domain()[1]-i.domain()[0])/(e.domain()[1]-e.domain()[0]),n=e.domain().map(i)[0];t.scale.x=a,t.position.x=-n*a},hi=function(t){return"".concat(t.fields[0],":").concat(t.fields[1],"-").concat(t.fields[2])},di=function t(e){if(!(this instanceof t?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var i=e.libraries.PIXI,a=e.libraries.d3Scale,n=a.scaleLinear,o=a.scaleLog,r=e.services.tileProxy,s=e.configs.MAX_CLICK_DELAY,c=o().domain([1,10]).range([.1,1]).clamp(!0),u=function(t){Object(Ge.a)(o,t);var a=Object(Be.a)(o);function o(t,e){var n;Object(Le.a)(this,o),(n=a.call(this,t,e)).pLegend=new i.Graphics,n.pMasked.addChild(n.pLegend),n.legendMin=1/0,n.legendMax=-1/0,n.bg=new i.Sprite(i.Texture.WHITE);var r=Object(l.a)(n.dimensions,2);n.bg.width=r[0],n.bg.height=r[1],n.bg.interactive=!0,n.bg.interactiveChildren=!1,n.bg.alpha=0;var c=performance.now();return n.bg.mousedown=function(){c=performance.now()},n.bg.mouseup=function(t){performance.now()-c<s&&n.clickHandler(t)},n.updateOptions(),n.pLoading=new i.Graphics,n.pLoading.position.x=0,n.pLoading.position.y=0,n.pMasked.addChild(n.pLoading),n.loadIndicator=new i.Text("Loading data...",{fontSize:n.labelSize||10,fill:8421504}),n.pLoading.addChild(n.loadIndicator),n}return Object(ze.a)(o,[{key:"initTile",value:function(t){var e=[];t.tileData.forEach((function(t,i){t.distance=li(t)||-1,t.cX=t.xStart+(t.xEnd-t.xStart)/2,t.regionId=hi(t),t.isLeftToRight=t.xStart<t.xEnd,e.push([t.xStart,t.xEnd,i])})),t.intervalTree=ei()(e)}},{key:"updateStratificationOption",value:function(){var t=this;if(!this.options.stratification)return this.categoryField=void 0,this.categoryToGroup=void 0,this.groupToColor=void 0,this.numGroups=0,this.numCategories=0,void(this.groupLabels=[]);this.categoryField=this.options.stratification.categoryField,this.getCategory=function(e){return e.fields[t.categoryField].toLowerCase()},this.categoryToGroup=new Map,this.categoryToY=new Map,this.yToCategory=new Map,this.groupToColor=new Map,this.numGroups=this.options.stratification.groups.length,this.groupSizes=this.options.stratification.groups.map((function(t){return t.categories.length})),this.numCategories=this.groupSizes.reduce((function(t,e){return t+e}),0),this.groupLabels=this.options.stratification.groups.map((function(t,e){return t.label||"Group ".concat(e)}));var a=0;this.options.stratification.groups.forEach((function(i,n){t.groupToColor.set(n,[e.utils.colorToHex(i.color||yt[n%yt.length]),e.utils.colorToHex(i.backgroundColor||kt[n%yt.length])]),i.categories.forEach((function(e,i){var o=e.toLowerCase();t.categoryToGroup.set(o,n),t.categoryToY.set(o,a+i),t.yToCategory.set(a+i,o)})),a+=i.categories.length})),this.groupLabelsPixiText=this.groupLabels.map((function(a,n){return new i.Text(a,{fontSize:t.labelSize,align:"right"===t.axisAlign?"right":"left",fill:e.utils.colorToHex(t.options.stratification.groups[n].axisLabelColor||wt[n%wt.length])})}))}},{key:"updateOptions",value:function(){var t=this;switch(this.axisAlign=this.options.axisAlign||"left",this.labelColor=e.utils.colorToHex(this.options.labelColor||"black"),this.labelSize=this.options.labelSize||12,this.markColor=e.utils.colorToHex(this.options.markColor||"black"),this.markColorRgbNorm=this.options.markColor?e.utils.colorToRgba(this.options.markColor).slice(0,3).map((function(t){return Math.min(1,Math.max(0,t/255))})):[0,0,0],this.markOpacity=Number.isNaN(+this.options.markOpacity)?1:Math.min(1,Math.max(0,+this.options.markOpacity)),this.markSize=this.options.markSize||2,this.markMinWidth=this.options.markMinWidth||this.markSize,this.markHeight=this.options.markHeight||this.markSize,this.rowHeight=this.options.rowHeight||this.markHeight,this.markColorHighlight=e.utils.colorToHex(this.options.markColorHighlight||"red"),this.markColorHighlightRgbNorm=this.options.markColorHighlight?e.utils.colorToRgba(this.options.markColorHighlight).slice(0,3).map((function(t){return Math.min(1,Math.max(0,t/255))})):[1,0,0],this.markColorDehighlight=e.utils.colorToHex(this.options.markColorDehighlight||"#999999"),this.markColorDehighlightRgbNorm=this.options.markColorDehighlight?e.utils.colorToRgba(this.options.markColorDehighlight).slice(0,3).map((function(t){return Math.min(1,Math.max(0,t/255))})):[.6,.6,.6],this.markOpacityFocus=Number.isNaN(+this.options.markOpacityFocus)?this.markOpacity:Math.min(1,Math.max(0,+this.options.markOpacityFocus)),this.getImportance=this.options.importanceField?function(e){return+e.fields[t.options.importanceField]}:function(t){return t.distance},this.opacityEncoding=this.options.opacityEncoding||"solid",this.opacityEncoding){case"frequency":this.opacityScale=function(){return.1};break;case"highestImportance":case"closestImportance":var i=this.options.importanceDomain||[1,1e3],a=n().domain(i).range([1,10]);this.opacityScale=function(t){return c(a(t))};break;case"solid":default:this.opacityScale=function(){return 1}}this.focusRegion=this.options.focusRegion?this.options.focusRegion:[1/0,1/0],this.getRegion=this.options.focusRegion?function(t){return[t.xStart,t.xEnd]}:void 0,this.focusGene=this.options.focusGene?this.options.focusGene.toLowerCase():void 0,this.getGene=this.options.geneField?function(e){return e.fields[t.options.geneField].toLowerCase()}:void 0,this.focusStyle=this.options.focusStyle?this.options.focusStyle.toLowerCase():void 0,this.minImportance=this.options.minImportance||0,this.updateStratificationOption()}},{key:"rerender",value:function(t){this.options=t,this.updateOptions(),this.updateExistingGraphics()}},{key:"hasFetchedTiles",value:function(){return Object.values(this.fetchedTiles).length}},{key:"updateScales",value:function(){if(Object.values(this.fetchedTiles).length){var t=Object(l.a)(this.dimensions,2)[1];this.maxDist=ci(this.fetchedTiles),this.heightScale=n().domain([0,this.maxDist]).range([Math.min(12,t/10),t]),this.categoryHeightScale=n().domain([0,this.numCategories]).range([0,this.numCategories*this.rowHeight]),this.valueScale=n().domain([0,this.maxDist]).range([t,0]),this.valueScaleInverted=n().domain([0,this.maxDist]).range([0,t])}}},{key:"itemToIndicatorCategory",value:function(t,e){return{cX:this._xScale(t.cX),y:this.categoryHeightScale(this.categoryToY.get(this.getCategory(t))),opacity:this.opacityScale(this.getImportance(t)),highlight:e&&t.__focus,widthHalf:Math.max(this.markMinWidth/2,Math.abs(this._xScale(t.xStart)-this._xScale(t.xEnd))/2),height:this.markHeight,__item:t}}},{key:"isItemInFocus",value:function(){var t=this;return this.getGene&&this.focusGene&&this.getRegion&&this.focusRegion?function(e){return e.__focus=t.getGene(e)===t.focusGene&&_t(t.getRegion(e),t.focusRegion),e.__focus}:this.getGene&&this.focusGene?function(e){return e.__focus=t.getGene(e)===t.focusGene,e.__focus}:this.getRegion&&this.focusRegion?function(e){return e.__focus=_t(t.getRegion(e),t.focusRegion),e.__focus}:function(t){return t.__focus=!1,!0}}},{key:"itemToIndicatorReducer",value:function(t,e){return"highlighting"===this.focusStyle?function(i,a){return t(a),e(i,a),i}:function(i,a){return t(a)&&e(i,a),i}}},{key:"getPoints",value:function(t){var e=this,i=[],a=function(i,a){return i.push(e.itemToIndicatorCategory(a,t))};"highestImportance"===this.opacityEncoding?(i={},a=function(i,a){if(i[a.regionId]){var n=e.getImportance(i[a.regionId].__item);e.getImportance(a)>n&&(i[a.regionId]=e.itemToIndicatorCategory(a,t))}else i[a.regionId]=e.itemToIndicatorCategory(a,t)}):"closestImportance"===this.opacityEncoding&&(i={},a=function(i,a){(!i[a.regionId]||a.distance<i[a.regionId].__item.distance)&&(i[a.regionId]=e.itemToIndicatorCategory(a,t))});var n=this.isItemInFocus(),o=this.itemToIndicatorReducer(n,a);return Object.values(this.fetchedTiles).flatMap((function(t){return Object.values(t.tileData.reduce(o,i))}))}},{key:"renderIndicatorPoints",value:function(){this.drawnAtScale=n().domain(Object(k.a)(this.xScale().domain())).range(Object(k.a)(this.xScale().range()));var t=!("highlighting"!==this.focusStyle||!(this.focusGene&&this.getGene||this.focusRegion&&this.getRegion)),e=this.getPoints(t),a=new Float32Array(e.flatMap(ni)),o=new Uint16Array(e.flatMap(oi)),r=new Float32Array(e.flatMap(ri)),s=new Float32Array(e.flatMap(si)),c=new i.UniformGroup({uColor:[].concat(t?Object(k.a)(this.markColorDehighlightRgbNorm):Object(k.a)(this.markColorRgbNorm),[this.markOpacity]),uColorHighlight:[].concat(Object(k.a)(this.markColorHighlightRgbNorm),[this.markOpacity]),uHighlighting:t}),u=i.Shader.from(ii,ai,c),h=new i.Geometry;h.addAttribute("aPosition",a,2),h.addAttribute("aOpacity",r,1),h.addAttribute("aHighlight",s,1),h.addIndex(o);var d=new i.Mesh(h,u),p=new i.Graphics;p.addChild(this.bg),p.addChild(d);var m=Object(l.a)(this.dimensions,2);this.bg.width=m[0],this.bg.height=m[1],this.pMain.x=this.position[0],this.indicatorPointGraphics&&(this.indicatorPointGraphics.removeChild(this.bg),this.pMain.removeChild(this.indicatorPointGraphics)),this.pMain.addChild(p),this.indicatorPointGraphics=p,ui(this.indicatorPointGraphics,this._xScale,this.drawnAtScale),this.draw(),this.animate()}},{key:"renderIndicatorCategoryAxis",value:function(){var t=this,e=Object(l.a)(this.dimensions,1)[0],i=Object(l.a)(this.position,2),a=i[0],n=i[1];this.pAxis.position.x="right"===this.axisAlign?a+e:a,this.pAxis.position.y=n,this.pAxis.clear();var o=0,r=0,s="right"===this.axisAlign?-5:5,c="right"===this.axisAlign?-e:e,u="right"===this.axisAlign?-3:3,h=this.pAxis.children.length;this.pAxis.lineStyle(1,0,1,0),this.groupLabelsPixiText.forEach((function(e,i){var a=t.categoryHeightScale(t.groupSizes[i]);r+=a,e.x=u,e.y=o+a/2,e.anchor.x="right"===t.axisAlign?1:0,e.anchor.y=.5,"highlighting"===t.options.focusStyle?t.pAxis.beginFill(16777215,.66):t.pAxis.beginFill(t.groupToColor.get(i)[1],.66),t.pAxis.lineStyle(0),"right"===t.axisAlign?t.pAxis.drawRect(e.x-e.width,e.y-e.height/2,e.width,e.height):t.pAxis.drawRect(e.x,e.y-e.height/2,e.width,e.height),t.pAxis.endFill(),h<i+1&&t.pAxis.addChild(e),t.pAxis.lineStyle(1,0,1,0),t.pAxis.moveTo(0,o),t.pAxis.lineTo(s,o),t.options.stratification.axisShowGroupSeparator&&Rt(t.pAxis,0,c,o,5),o=r})),this.pAxis.moveTo(0,0),this.pAxis.lineTo(0,r),this.pAxis.lineTo(s,r),this.options.stratification.axisShowGroupSeparator&&Rt(this.pAxis,0,c,r,5)}},{key:"renderIndicatorLegend",value:function(){if(this.pLegend.clear(),-1===this.opacityEncoding.indexOf("Importance"))return this.legendMinText&&(this.pLegend.removeChild(this.legendMinText),this.legendMinText.destroy(),this.legendMinText=void 0),void(this.legendMaxText&&(this.pLegend.removeChild(this.legendMaxText),this.legendMaxText.destroy(),this.legendMaxText=void 0));var t=Object(l.a)(this.dimensions,1)[0],e=Object(l.a)(this.position,2),a=e[0],n=e[1],o=this.categoryHeightScale.range(),r=Object(l.a)(o,2)[1],s="right"===this.options.legendAlign,c=!("highlighting"!==this.focusStyle||!(this.focusGene&&this.getGene||this.focusRegion&&this.getRegion));this.pLegend.position.x=s?a+t:a;var u=this.options.importanceDomain||[1,1e3],h=Object(l.a)(u,2),d=h[0],p=h[1];Math.abs(d-this.legendMin)>xt&&(this.legendMinText&&(this.pLegend.removeChild(this.legendMinText),this.legendMinText.destroy()),this.legendMinText=new i.Text(zt(d,3),{fontSize:this.labelSize,align:s?"right":"left",fill:8421504}),this.legendMinText.x=0,this.legendMinText.y=3,this.legendMinText.anchor.x=s?1:0,this.pLegend.addChild(this.legendMinText)),Math.abs(p-this.legendMax)>xt&&(this.legendMaxText&&(this.pLegend.removeChild(this.legendMaxText),this.legendMaxText.destroy()),this.legendMaxText=new i.Text(zt(p,3),{fontSize:this.labelSize,align:s?"right":"left",fill:8421504}),this.legendMaxText.x=0,this.legendMaxText.y=3,this.legendMaxText.anchor.x=s?1:0,this.pLegend.addChild(this.legendMaxText));var m=this.legendMinText.getBounds().width,g=this.legendMaxText.getBounds().width,f=s?-(g+42+6):m+12,v=18+6*c/2;this.pLegend.beginFill(16777215),this.pLegend.lineStyle(1,13421772),s?(this.legendMinText.x=f-6,this.pLegend.drawRoundedRect(-(42+m+g+18+.5),0,42+m+g+18,v,3)):(this.legendMaxText.x=f+42+12,this.pLegend.drawRoundedRect(.5,0,42+m+g+18,18+6*c/2,3)),this.pLegend.endFill(),this.pLegend.lineStyle(0);for(var b=0;b<5;b++){var x=this.opacityScale(d+b/4*p);this.pLegend.beginFill(this.markColor,x),this.pLegend.drawRect(9*b+f,3+3*!c,6,6),this.pLegend.endFill(),c&&(this.pLegend.beginFill(this.markColorHighlight,x),this.pLegend.drawRect(9*b+f,12,6,6),this.pLegend.endFill())}s?(this.legendMinText.x=f-6,this.legendMaxText.x=-3):(this.legendMinText.x=3,this.legendMaxText.x=f+42+6),this.pLegend.position.y=n+r-6-v}},{key:"updateIndicators",value:function(){this.renderIndicatorCategoryAxis(),this.renderIndicatorLegend(),this.renderIndicatorPoints()}},{key:"updateLoadIndicator",value:function(){var t=Object(l.a)(this.position,2),e=t[0],i=t[1];this.pLoading.position.x=e+6,this.pLoading.position.y=i+6,this.fetching.size?this.pLoading.addChild(this.loadIndicator):this.pLoading.removeChild(this.loadIndicator)}},{key:"updateExistingGraphics",value:function(){this.updateLoadIndicator(),this.hasFetchedTiles()&&(this.updateScales(),this.updateIndicators())}},{key:"drawTile",value:function(t){var e=this;if(t.graphics.clear(),this.updateLoadIndicator(),!this.options.stratification.axisNoGroupColor){var i=0,a=0;this.groupSizes.forEach((function(n,o){a+=e.categoryHeightScale(n),t.graphics.beginFill(e.groupToColor.get(o)[1]),t.graphics.drawRect(0,i,e.dimensions[0],Math.abs(a-i)),i=a})),t.graphics.endFill()}}},{key:"getElementAtPosition",value:function(t,e){var i=this;if(this.tilesetInfo){var a=this.calculateZoomLevel(),n=r.calculateTileWidth(this.tilesetInfo,a,this.tilesetInfo.tile_size),o=this.tileToLocalId([a,Math.floor(this._xScale.invert(t)/n)]),s=this.fetchedTiles[o];if(s){var l,c=this.yToCategory.get(Math.floor(this.categoryHeightScale.invert(e))),u=this._xScale.invert(t-1),h=this._xScale.invert(t+1);return s.intervalTree.queryInterval(u,h,(function(t){var e=s.tileData[t[2]];return i.getCategory(e)===c&&(l=e,!0)})),{item:l,category:c,tileId:o}}}}},{key:"getMouseOverHtml",value:function(t,e){var i=this.getElementAtPosition(t,e);if(!i)return"";var a=i.item,n=i.category;if(a){var o=this.groupToColor.get(this.categoryToGroup.get(n)),r=Object(l.a)(o,2),s=r[0],c=r[1],u="#".concat(s.toString(16)),h="#".concat(c.toString(16)),d=this.getImportance(a).toFixed(2);return'<div style="margin: -0.25rem; padding: 0 0.25rem; background: '.concat(h,'"><strong style="color: ').concat(u,';">').concat(n,":</strong> ").concat(d,"</div>")}return""}},{key:"clickHandler",value:function(t){var e=Object(l.a)(this.position,2),i=e[0],a=e[1],n=t.data.global.x-i,o=t.data.global.y-a,r=this.getElementAtPosition(n,o);r&&this.pubSub.publish("app.click",{type:"annotation",event:t,payload:r})}},{key:"setPosition",value:function(t){Object(Fe.a)(Object(He.a)(o.prototype),"setPosition",this).call(this,t);var e=Object(l.a)(this.position,2);this.pMain.position.x=e[0],this.pMain.position.y=e[1]}},{key:"zoomed",value:function(t,e){this.xScale(t),this.yScale(e),this.indicatorPointGraphics&&ui(this.indicatorPointGraphics,t,this.drawnAtScale),this.refreshTiles(),this.draw()}},{key:"refreshTiles",value:function(){Object(Fe.a)(Object(He.a)(o.prototype),"refreshTiles",this).call(this),this.updateLoadIndicator()}},{key:"renderIndicatorCategoryAxisAsSvg",value:function(){var t=this,e=document.createElement("g");e.setAttribute("id","axis");var i=Object(l.a)(this.dimensions,1)[0],a=Object(l.a)(this.position,2),n=a[0],o=a[1];this.pAxis.position.x="right"===this.axisAlign?n+i:n,this.pAxis.position.y=o,e.setAttribute("transform","translate(".concat(this.pAxis.position.x,", ").concat(this.pAxis.position.y,")"));var r=0,s=0,c="right"===this.axisAlign?-5:5,u="right"===this.axisAlign?-i:i,h="right"===this.axisAlign?-3:3,d=function(t,e,i,a,n,o){var r=document.createElement("rect");return r.setAttribute("x",t),r.setAttribute("y",e),r.setAttribute("width",i),r.setAttribute("height",a),r.setAttribute("fill",n),r.setAttribute("fill-opacity",o),r.setAttribute("stroke-width",0),r},p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.stroke,i=void 0===e?"#000000":e,a=t.strokeWidth,n=void 0===a?1:a,o=t.strokeDasharray,r=void 0===o?null:o;return function(t,e,a,o){var s=document.createElement("line");return s.setAttribute("x1",t),s.setAttribute("y1",e),s.setAttribute("x2",a),s.setAttribute("y2",o),s.setAttribute("stroke",i),s.setAttribute("stroke-width",n),r&&s.setAttribute("stroke-dasharray",r),s}},m=p({strokeDasharray:"5"}),g="highlighting"===this.options.focusStyle;return this.groupLabelsPixiText.forEach((function(i,a){var n=t.categoryHeightScale(t.groupSizes[a]);s+=n,i.x=h,i.y=r+n/2;var o=g?"#ffffff":"#".concat(t.groupToColor.get(a)[1].toString(16));"right"===t.axisAlign?e.appendChild(d(i.x-i.width,i.y-i.height/4,i.width,i.height,o,.66)):e.appendChild(d(i.x,i.y-i.height/4,i.width,i.height,o,.66)),e.appendChild(function(t){var e=document.createElement("text");return e.setAttribute("x",t.x),e.setAttribute("y",t.y+t.height/4),e.setAttribute("fill",t._style._fill),e.setAttribute("text-anchor","right"===t._style._align?"end":"start"),e.setAttribute("style","font: ".concat(t._font,";")),e.textContent=t.text,e}(i)),e.appendChild(p()(0,r,c,r)),t.options.stratification.axisShowGroupSeparator&&e.appendChild(m(0,r,u,r)),r=s})),e.appendChild(p()(0,0,0,s)),this.options.stratification.axisShowGroupSeparator&&e.appendChild(m(0,s,u,s)),e}},{key:"exportSVG",value:function(){var t=null,e=null,i=Object(Fe.a)(Object(He.a)(o.prototype),"superSVG",this).call(this),a=Object(l.a)(i,2);e=a[0],t=a[1],e.setAttribute("class","exported-stratified-bed-track");var n=document.createElement("g");t.appendChild(n),n.setAttribute("transform","translate(".concat(this.position[0],",").concat(this.position[1],")"));var r=!("highlighting"!==this.focusStyle||!(this.focusGene&&this.getGene||this.focusRegion&&this.getRegion)),s=this.getPoints(r),c=r?this.options.markColorDehighlight||"#999999":this.options.markColor||"black",u=this.options.markColorHighlight||"red";return s.forEach((function(t,e){var i=t.cX,a=t.y,o=t.widthHalf,r=t.opacity,s=t.highlight,l=t.height,h=document.createElement("rect");h.setAttribute("x",i-o),h.setAttribute("y",a),h.setAttribute("width",2*o),h.setAttribute("height",l),h.setAttribute("fill",s?u:c),h.setAttribute("fill-opacity",r),h.setAttribute("stroke-width",0),n.appendChild(h)})),e.appendChild(this.renderIndicatorCategoryAxisAsSvg()),[e,t]}}]),o}(e.tracks.HorizontalLine1DPixiTrack),h=arguments.length,d=new Array(h>1?h-1:0),p=1;p<h;p++)d[p-1]=arguments[p];return Object(Ne.a)(u,d)};di.config={type:"stratified-bed",datatype:["arcs","bedlike"],orientation:"1d",name:"Arcs1D",thumbnail:(new DOMParser).parseFromString('<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5"><path d="M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268" fill="none" stroke="currentColor"/><path d="M10.5 3.5v12" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-dasharray="1,2,0,0"/><path d="M5.5 13.5V6" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-width=".9969299999999999" stroke-dasharray="1.71,3.43,0,0"/><path d="M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z" fill="currentColor"/><path d="M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z" fill="currentColor"/></svg>',"text/xml").documentElement,availableOptions:["arcStyle","flip1D","labelPosition","labelColor","labelTextOpacity","labelBackgroundOpacity","trackBorderWidth","trackBorderColor"],defaultOptions:{arcStyle:"ellipse",flip1D:"no",labelColor:"black",labelPosition:"hidden",trackBorderWidth:0,trackBorderColor:"black"},optionsInfo:{arcStyle:{name:"Arc Style",inlineOptions:{circle:{name:"Circle",value:"circle"},ellipse:{name:"Ellipse",value:"ellipse"}}}}};var pi=di,mi="\n  precision mediump float;\n  attribute vec2 aPosition;\n  attribute float aOpacity;\n  attribute float aFocused;\n\n  uniform mat3 projectionMatrix;\n  uniform mat3 translationMatrix;\n  uniform float uPointSize;\n  uniform vec4 uColor;\n  uniform vec4 uColorFocused;\n\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vOpacity;\n  varying float vFocused;\n\n  void main(void)\n  {\n    vColor = uColor;\n    vColorFocused = uColorFocused;\n    vOpacity = aOpacity;\n    vFocused = aFocused;\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n    gl_PointSize = uPointSize;\n  }\n",gi="\n  #ifdef GL_OES_standard_derivatives\n  #extension GL_OES_standard_derivatives : enable\n  #endif\n\n  precision mediump float;\n\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vOpacity;\n  varying float vFocused;\n\n  void main() {\n    float r = 0.0, delta = 0.0, alpha = 1.0;\n    vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n    r = dot(cxy, cxy);\n\n    #ifdef GL_OES_standard_derivatives\n      delta = fwidth(r);\n      alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n    #endif\n\n    gl_FragColor = vec4(vColor.rgb, alpha * vColor.a);\n  }\n",fi="\n  precision mediump float;\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vOpacity;\n  varying float vFocused;\n\n  void main() {\n    float isNotFocused = 1.0 - vFocused;\n\n    float r = vColor.r * isNotFocused + vColorFocused.r * vFocused;\n    float g = vColor.g * isNotFocused + vColorFocused.g * vFocused;\n    float b = vColor.b * isNotFocused + vColorFocused.b * vFocused;\n\n    gl_FragColor = vec4(r, g, b, 1.0) * vOpacity;\n  }\n",vi=["#c76526","#dca237","#eee462","#469b76","#3170ad","#6fb2e4","#000000","#999999"],bi=["#a65420","#b7872e","#9f9841","#3a8162","#295d90","#4a7798","#000000","#666666"],xi=["#f6e5db","#f9f0de","#fcfbe5","#e0eee8","#dde7f1","#e7f2fb","#d5d5d5","#ffffff"],yi=function(t){return t.tileData.length&&void 0!==t.tileData[0].yStart},wi=function(t){return t.xEnd-t.xStart},ki=function(t){return Math.abs(t.xStart+(t.xEnd-t.xStart)/2-(t.yStart+(t.yEnd-t.yStart)/2))},Ci=function(t){return t.xStart},Ei=function(t){return t.xStart+(t.xEnd-t.xStart)/2},Si=function(t){return t.xEnd},Oi=function(t){return t.yStart+(t.yEnd-t.yStart)/2},Ti=function(t){return Object.values(t).reduce((function(t,e){return Math.max(t,e.tileData.reduce((function(t,e){return Math.max(t,e.width)}),0))}),0)},Ai=function(t,e,i){var a=(i.domain()[1]-i.domain()[0])/(e.domain()[1]-e.domain()[0]),n=e.domain().map(i)[0];t.scale.x=a,t.position.x=-n*a},Mi=function t(e){if(!(this instanceof t?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var i=e.libraries.PIXI,a=e.libraries.d3Scale,n=a.scaleLinear,o=a.scaleLog,r=o().domain([1,10]).range([.1,1]).clamp(!0),s=function(t){Object(Ge.a)(o,t);var a=Object(Be.a)(o);function o(t,e){var i;return Object(Le.a)(this,o),(i=a.call(this,t,e)).updateOptions(),i}return Object(ze.a)(o,[{key:"initTile",value:function(t){var e=yi(t),i=e?ki:wi,a=e?Ei:Ci,n=e?Oi:Si;t.tileData.forEach((function(t){t.width=i(t),t.start=a(t),t.end=n(t),t.isLeftToRight=t.start<t.end}))}},{key:"updateTileWidthHistogram",value:function(t){var e=Math.max(this.dimensions[1]/this.pointSize),i=this.maxWidth/e,a=0;t.widthHistogramLeft=new Uint32Array(e),t.widthHistogramRight=new Uint32Array(e),t.tileData.forEach((function(e){var n=Math.round(e.width/i);e.histPos=e.isLeftToRight?t.widthHistogramRight[n]++:t.widthHistogramLeft[n]++,a=a>e.histPos?a:e.histPos})),t.widthHistogramMax=a}},{key:"updateWidthHistograms",value:function(){Object.values(this.fetchedTiles).forEach(this.updateTileWidthHistogram.bind(this))}},{key:"updateStratificationOption",value:function(){var t=this;if(!this.options.stratification)return this.categoryField=void 0,this.categoryToGroup=void 0,this.groupToColor=void 0,this.numGroups=0,this.numCategories=0,void(this.groupLabels=[]);this.categoryField=this.options.stratification.categoryField,this.categoryToGroup=new Map,this.categoryToY=new Map,this.groupToColor=new Map,this.numGroups=this.options.stratification.groups.length,this.groupSizes=this.options.stratification.groups.map((function(t){return t.categories.length})),this.numCategories=this.groupSizes.reduce((function(t,e){return t+e}),0),this.groupLabels=this.options.stratification.groups.map((function(t,e){return t.label||"Group ".concat(e)}));var a=0;this.options.stratification.groups.forEach((function(i,n){t.groupToColor.set(n,[e.utils.colorToHex(i.color||vi[n%vi.length]),e.utils.colorToHex(i.backgroundColor||xi[n%vi.length])]),i.categories.forEach((function(e,i){t.categoryToGroup.set(e.toLowerCase(),n),t.categoryToY.set(e.toLowerCase(),a+i)})),a+=i.categories.length})),this.groupLabelsPixiText=this.groupLabels.map((function(a,n){return new i.Text(a,{fontSize:t.labelSize,align:"right"===t.axisAlign?"right":"left",fill:e.utils.colorToHex(t.options.stratification.groups[n].axisLabelColor||bi[n%bi.length])})}))}},{key:"updateOptions",value:function(){var t=this;this.axisAlign=this.options.axisAlign||"left",this.labelColor=e.utils.colorToHex(this.options.labelColor||"black"),this.labelSize=this.options.labelSize||12,this.markColor=e.utils.colorToHex(this.options.markColor||"black"),this.markColorRgbNorm=this.options.markColor?e.utils.colorToRgba(this.options.markColor).slice(0,3).map((function(t){return Math.min(1,Math.max(0,t/255))})):[0,0,0],this.markOpacity=Number.isNaN(+this.options.markOpacity)?1:Math.min(1,Math.max(0,+this.options.markOpacity)),this.markSize=this.options.markSize||2,this.markColorFocus=e.utils.colorToHex(this.options.markColorFocus||"red"),this.markColorFocusRgbNorm=this.options.markColorFocus?e.utils.colorToRgba(this.options.markColorFocus).slice(0,3).map((function(t){return Math.min(1,Math.max(0,t/255))})):[1,0,0],this.markOpacityFocus=Number.isNaN(+this.options.markOpacityFocus)?this.markOpacity:Math.min(1,Math.max(0,+this.options.markOpacityFocus)),this.markSizeFocus=this.options.markSizeFocus||this.markSize,this.strokeColor=this.markColor||e.utils.colorToHex(this.options.strokeColor||"black"),this.strokeWidth=this.options.strokeWidth||this.markSize,this.getImportance=this.options.importanceField?function(e){return+e.fields[t.options.importanceField]}:function(t){return t.width};var i=this.options.importanceDomain||[1e3,1],a=n().domain(i).range([1,10]);this.opacityScale=function(t){return r(a(t))},this.focusRegion=this.options.focusRegion?this.options.focusRegion:[1/0,1/0],this.focusGene=this.options.focusGene?this.options.focusGene.toLowerCase():void 0,this.getGene=this.options.geneField?function(e){return e.fields[t.options.geneField].toLowerCase()}:void 0,this.minImportance=this.options.minImportance||0,this.updateStratificationOption(),this.updateWidthHistograms()}},{key:"rerender",value:function(t){this.options=t,this.updateOptions(),this.updateExistingGraphics()}},{key:"updateScales",value:function(){if(Object.values(this.fetchedTiles).length){var t=Object(l.a)(this.dimensions,2)[1],e=this.markSize/2;this.maxWidth=Ti(this.fetchedTiles),this.heightScale=n().domain([0,this.maxWidth]).range([Math.min(12,t/10),t]),this.fullHeightScale=n().domain([this.maxWidth,0]).range([Math.min(e,t/10),Math.max(t-e,9*t/10)]),this.fullHeightScaleInverted=n().domain([0,this.maxWidth]).range([Math.min(e,t/10),Math.max(t-e,9*t/10)]),this.incomingHeightScale=n().domain([0,this.maxWidth]).range([t/2,t]),this.outgoingHeightScale=n().domain([0,this.maxWidth]).range([t/2,0]),this.categoryHeightScale=n().domain([0,this.numCategories]).range([0,this.numCategories*this.markSize]),this.valueScale=n().domain([0,this.maxWidth]).range([t,0]),this.valueScaleInverted=n().domain([0,this.maxWidth]).range([0,t])}}},{key:"itemToIndicatorDiverging",value:function(t){return{startX:this._xScale(t.start),endX:this._xScale(t.end),startY:this.outgoingHeightScale(t.width),endY:this.incomingHeightScale(t.width),opacity:this.opacityScale(this.getImportance(t)),size:this.markSize}}},{key:"itemToIndicatorStart",value:function(t){return{x:this._xScale(t.start),y:this.fullHeightScale(t.width),opacity:this.opacityScale(this.getImportance(t)),size:this.markSize}}},{key:"itemToIndicatorEnd",value:function(t){return{x:this._xScale(t.end),y:this.fullHeightScaleInverted(t.width),opacity:this.opacityScale(this.getImportance(t)),size:this.markSize}}},{key:"itemToIndicatorCategory",value:function(t){return{cX:this._xScale(t.start),cY:this.categoryHeightScale(this.categoryToY.get(t.fields[this.categoryField].toLowerCase())),wHalf:Math.max(this.markSize/2,Math.abs(this._xScale(t.xStart)-this._xScale(t.xEnd))/2),opacity:this.opacityScale(this.getImportance(t)),focused:t.xStart<=this.focusRegion[1]&&t.xEnd>=this.focusRegion[0],size:this.markSize,sizeHalf:this.markSize/2}}},{key:"itemToIndicatorReducer",value:function(t){var e=this;return this.getGene&&this.focusGene?function(i,a){return e.getGene(a)===e.focusGene&&i.push(t(a)),i}:function(e,i){return e.push(t(i)),e}}},{key:"renderIndicatorPoints",value:function(t,e,a,o){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=r.vertexShader,l=void 0===s?mi:s,c=r.fragmentShader,u=void 0===c?gi:c,h=r.drawTriangles,d=void 0!==h&&h;this.drawnAtScale=n().domain(Object(k.a)(this.xScale().domain())).range(Object(k.a)(this.xScale().range()));var p=Object.values(this.fetchedTiles).flatMap((function(e){return e.tileData.reduce(t,[])})),m=new Float32Array(p.flatMap(e)),g=new Float32Array(p.flatMap(a)),f=new Float32Array(p.flatMap(o)),v=new i.UniformGroup({uPointSize:this.markSize,uColor:[].concat(Object(k.a)(this.markColorRgbNorm),[this.markOpacity]),uColorFocused:[].concat(Object(k.a)(this.markColorFocusRgbNorm),[this.markOpacity])}),b=i.Shader.from(l,u,v),x=new i.Geometry;x.addAttribute("aPosition",m,2),x.addAttribute("aOpacity",g,1),x.addAttribute("aFocused",f,1);var y=new i.Mesh(x,b,new i.State,d?i.DRAW_MODES.TRIANGLES:i.DRAW_MODES.POINTS),w=new i.Graphics;w.addChild(y),this.pMain.x=this.position[0],this.indicatorPointGraphics&&this.pMain.removeChild(this.indicatorPointGraphics),this.pMain.addChild(w),this.indicatorPointGraphics=w,Ai(this.indicatorPointGraphics,this._xScale,this.drawnAtScale),this.draw(),this.animate()}},{key:"renderIndicatorDistanceAxis",value:function(t){this.drawAxis(t)}},{key:"renderIndicatorCategoryAxis",value:function(){var t=this,e=Object(l.a)(this.dimensions,1)[0],i=Object(l.a)(this.position,2),a=i[0],n=i[1];this.pAxis.position.x="right"===this.axisAlign?a+e:a,this.pAxis.position.y=n,this.pAxis.clear();var o=0,r=0,s="right"===this.axisAlign?-5:5,c="right"===this.axisAlign?-e:e,u="right"===this.axisAlign?-3:3,h=this.pAxis.children.length;this.pAxis.lineStyle(1,0,1,0),this.groupLabelsPixiText.forEach((function(e,i){var a=t.categoryHeightScale(t.groupSizes[i]);r+=a,e.x=u,e.y=o+a/2,e.anchor.x="right"===t.axisAlign?1:0,e.anchor.y=.5,h<i+1&&t.pAxis.addChild(e),t.pAxis.moveTo(0,o),t.pAxis.lineTo(s,o),t.options.stratification.axisShowGroupSeparator&&Rt(t.pAxis,0,c,o,5),o=r})),this.pAxis.moveTo(0,0),this.pAxis.lineTo(0,r),this.pAxis.lineTo(s,r),this.options.stratification.axisShowGroupSeparator&&Rt(this.pAxis,0,c,r,5)}},{key:"updateIndicators",value:function(){var t=this.itemToIndicatorDiverging.bind(this),e=function(t){return[t.startX,t.startY,t.endX,t.endY]},i=function(t){return t.opacity},a=function(t){return t.focused},n=gi,o=!1;"category"===this.options.indicatorStyle?(t=this.itemToIndicatorCategory.bind(this),e=function(t){return[t.cX,t.cY]},n=fi,this.renderIndicatorCategoryAxis(this.valueScaleInverted)):"category-rect"===this.options.indicatorStyle?(t=this.itemToIndicatorCategory.bind(this),e=function(t){return[t.cX-t.wHalf,t.cY,t.cX+t.wHalf,t.cY,t.cX+t.wHalf,t.cY+t.size,t.cX+t.wHalf,t.cY+t.size,t.cX-t.wHalf,t.cY+t.size,t.cX-t.wHalf,t.cY]},i=function(t){return[t.opacity,t.opacity,t.opacity,t.opacity,t.opacity,t.opacity]},a=function(t){return[t.focused,t.focused,t.focused,t.focused,t.focused,t.focused]},n=fi,o=!0,this.renderIndicatorCategoryAxis(this.valueScaleInverted)):"start-only"===this.options.indicatorStyle?(t=this.itemToIndicatorStart.bind(this),e=function(t){return[t.x,t.y]},this.renderIndicatorDistanceAxis(this.valueScale)):"end-only"===this.options.indicatorStyle&&(t=this.itemToIndicatorEnd.bind(this),e=function(t){return[t.x,t.y]},this.renderIndicatorDistanceAxis(this.valueScaleInverted)),t=this.itemToIndicatorReducer(t),this.renderIndicatorPoints(t,e,i,a,{fragmentShader:n,drawTriangles:o})}},{key:"updateExistingGraphics",value:function(){this.updateScales(),this.updateWidthHistograms(),"indicator"===this.options.arcStyle&&this.updateIndicators()}},{key:"drawTile",value:function(t,e){var i=this;if(t.graphics.clear(),t.tileData.length){if("indicator"===this.options.arcStyle){var a=Object(l.a)(this.dimensions,2),n=a[0],o=a[1];if(this.options.indicatorStyle.startsWith("category")){if(!this.options.stratification.axisNoGroupColor){var r=0,s=0;this.groupSizes.forEach((function(e,a){s+=i.categoryHeightScale(e),t.graphics.beginFill(i.groupToColor.get(a)[1]),t.graphics.drawRect(0,r,n,Math.abs(s-r)),r=s})),t.graphics.endFill()}}else{var c=Math.round(o/2)-.5;"start-only"===this.options.indicatorStyle?c=o-.5:"end-only"===this.options.indicatorStyle&&(c=.5),t.graphics.lineStyle(1,0,.2),t.graphics.moveTo(0,c),t.graphics.lineTo(n,c)}}for(var u=0;u<t.tileData.length;u++){var h=t.tileData[u];"circle"===this.options.arcStyle?this.drawCircle(t.graphics,h,e):"indicator"===this.options.arcStyle||this.drawEllipse(t.graphics,h,e)}}}},{key:"drawIndicator",value:function(t,e){var i=this._xScale(e.start),a=this._xScale(e.end),n=this.outgoingHeightScale(e.width),o=this.incomingHeightScale(e.width),r=this.opacityScale(this.getImportance(e));t.lineStyle(0,0,0),t.beginFill(4033753,r),t.drawCircle(i,n,this.pointSize),t.endFill(),t.beginFill(12680613,r),t.drawCircle(a,o,this.pointSize),t.endFill(),e.start<=this.focusRegion[1]&&e.end>=this.focusRegion[0]&&(e.start>=this.focusRegion[0]||e.end<=this.focusRegion[1])&&(t.lineStyle(this.pointSize,12680613,r),t.moveTo(i,o),t.lineTo(a,o),t.endFill())}},{key:"drawCircle",value:function(t,e,i,a){var o=this._xScale(e.start),r=this._xScale(e.end),s=Object(l.a)(this.dimensions,2),c=s[0],u=s[1],h=Object(l.a)(this.position,2)[1],d=(r-o)/2,p=(r-o)/2,m=(p*p+d*d)/(2*d),g=(o+r)/2,f=u-d+m,v="";a&&(v+="M".concat(o,",").concat(h+u)),t.moveTo(o,h+u);var b=Math.max(0,o),x=Math.min(c,r),y=this.markColor,w=this.markSize,k=this.markOpacity;e.start<=this.focusRegion[1]&&e.end>=this.focusRegion[0]&&(e.start>=this.focusRegion[0]||e.end<=this.focusRegion[1])&&(y=this.markColorFocus,w=this.markSizeFocus,k=this.markOpacityFocus),t.lineStyle(w,y,k);var C=Math.acos(Math.min(Math.max(-(b-g)/m,-1),1)),E=Math.acos(Math.min(Math.max(-(x-g)/m,-1),1));this.options.flip&&(f=0,E=-Math.PI,t.moveTo(o,0),a&&(v+="M".concat(o,",0")));for(var S=n().domain([0,9]).range([C,E]),O=0;O<10;O++){var T=g-m*Math.cos(S(O)),A=f-m*Math.sin(S(O));t.lineTo(T,A),a&&(v+="L".concat(T,",").concat(A))}a&&this.polys.push({polyStr:v,opacity:k})}},{key:"drawEllipse",value:function(t,e,i,a,o){var r=this._xScale(e.start),s=this._xScale(e.end),c=Object(l.a)(this.dimensions,2)[1],u=this.heightScale(e.width),h=s-r,d=h/2,p=(r+s)/2,m=c,g=Math.PI,f="";o&&(f+="M".concat(r,",").concat(c)),t.moveTo(r,c),this.options.flip&&(m=0,g=-Math.PI,t.moveTo(r,0),o&&(f+="M".concat(r,",0")));var v=this.markColor,b=this.markSize,x=this.markOpacity;e.start<=this.focusRegion[1]&&e.end>=this.focusRegion[0]&&(e.start>=this.focusRegion[0]||e.end<=this.focusRegion[1])&&(v=this.markColorFocus,b=this.markSizeFocus,x=this.markOpacityFocus),t.lineStyle(b,v,x);for(var y=10*Math.round(Math.abs(h)/200),w=n().domain([0,y-1]).range([0,g]),k=0;k<y;k++){var C=p-d*Math.cos(w(k)),E=m-u*Math.sin(w(k));t.lineTo(C,E),o&&(f+="L".concat(C,",").concat(E))}o&&this.polys.push({polyStr:f,opacity:x})}},{key:"getMouseOverHtml",value:function(){}},{key:"setPosition",value:function(t){Object(Fe.a)(Object(He.a)(o.prototype),"setPosition",this).call(this,t);var e=Object(l.a)(this.position,2);this.pMain.position.x=e[0],this.pMain.position.y=e[1]}},{key:"zoomed",value:function(t,e){this.xScale(t),this.yScale(e),this.indicatorPointGraphics&&Ai(this.indicatorPointGraphics,t,this.drawnAtScale),this.refreshTiles(),this.draw()}},{key:"exportSVG",value:function(){var t=this,e=null,i=null,a=Object(Fe.a)(Object(He.a)(o.prototype),"superSVG",this).call(this),n=Object(l.a)(a,2);i=n[0],e=n[1],i.setAttribute("class","exported-arcs-track");var r=document.createElement("g");e.appendChild(r),r.setAttribute("transform","translate(".concat(this.position[0],",").concat(this.position[1],")"));var s=this.options.strokeColor?this.options.strokeColor:"blue",c=this.options.strokeWidth?this.options.strokeWidth:2;return this.visibleAndFetchedTiles().forEach((function(e){t.polys=[],t.drawTile(e,!0);var i,a=Object(ft.a)(t.polys);try{for(a.s();!(i=a.n()).done;){var n=i.value,o=n.polyStr,l=n.opacity,u=document.createElement("path");u.setAttribute("fill","transparent"),u.setAttribute("stroke",s),u.setAttribute("stroke-width",c),u.setAttribute("opacity",l),u.setAttribute("d",o),r.appendChild(u)}}catch(h){a.e(h)}finally{a.f()}})),[i,e]}}]),o}(e.tracks.HorizontalLine1DPixiTrack),c=arguments.length,u=new Array(c>1?c-1:0),h=1;h<c;h++)u[h-1]=arguments[h];return Object(Ne.a)(s,u)};Mi.config={type:"1d-arcs",datatype:["arcs","bedlike"],orientation:"1d",name:"Arcs1D",thumbnail:(new DOMParser).parseFromString('<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5"><path d="M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268" fill="none" stroke="currentColor"/><path d="M10.5 3.5v12" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-dasharray="1,2,0,0"/><path d="M5.5 13.5V6" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-width=".9969299999999999" stroke-dasharray="1.71,3.43,0,0"/><path d="M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z" fill="currentColor"/><path d="M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z" fill="currentColor"/></svg>',"text/xml").documentElement,availableOptions:["arcStyle","flip1D","labelPosition","labelColor","labelTextOpacity","labelBackgroundOpacity","strokeColor","strokeWidth","trackBorderWidth","trackBorderColor"],defaultOptions:{arcStyle:"ellipse",flip1D:"no",labelColor:"black",labelPosition:"hidden",strokeColor:"black",strokeWidth:1,trackBorderWidth:0,trackBorderColor:"black"},optionsInfo:{arcStyle:{name:"Arc Style",inlineOptions:{circle:{name:"Circle",value:"circle"},ellipse:{name:"Ellipse",value:"ellipse"}}}}};var _i=Mi,ji=function t(e){if(!(this instanceof t?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var i=e.libraries.d3Array.range,a=e.libraries.d3Scale.scaleBand,n=e.services.tileProxy,o=e.utils.colorToHex,r=function(t){Object(Ge.a)(r,t);var e=Object(Be.a)(r);function r(){return Object(Le.a)(this,r),e.apply(this,arguments)}return Object(ze.a)(r,[{key:"setValueScale",value:function(){if(this.valueScale=null,this.options&&this.options.valueColumn){var t=this.options.colorEncodingRange?+this.options.colorEncodingRange[0]:this.minVisibleValueInTiles(+this.options.valueColumn),e=this.options.colorEncodingRange?+this.options.colorEncodingRange[1]:this.maxVisibleValueInTiles(+this.options.valueColumn);if(this.options.valueColumn){var i=this.makeValueScale(t,this.calculateMedianVisibleValue(+this.options.valueColumn),e,2),a=Object(l.a)(i,1);this.valueScale=a[0]}}}},{key:"finalDotYPos",value:function(t,e){return Math.max(e,Math.min(this.dimensions[1]-e,t))}},{key:"drawPoly",value:function(t,e,i,a){var n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=[e,a,i,a,i,this.dimensions[1],e,this.dimensions[1]],r=Math.max(2,i-e),s=r*(1+2*n);return t.rectGraphics.drawCircle(e,this.finalDotYPos(a,r),s),o}},{key:"renderRows",value:function(t,e,n,r,s,l){var c=this,u=+t.tileId.split(".")[0];this.initialize();for(var h=a().domain(i(n)).range([r,s]).paddingInner(0),d=this.options.focusRegion||[1/0,1/0],p=[],m=[],g=0;g<e.length;g++){for(var f=0;f<e[g].length;f++){var v=e[g][f].value,b=v.fields,x=+v.chrOffset,y=+b[1]+x,w=+b[2]+x,k=h(g)+h.step()/2;this.valueScale&&(k=this.valueScale(+b[+this.options.valueColumn-1]));var C=k,E=this._xScale(y),S=this._xScale(w);if(!(u in this.drawnRects)||!(v.uid in this.drawnRects[u])){this.drawnRects[u]||(this.drawnRects[u]={});var O=[E,S,C,v,y,w];y<=d[1]&&w>=d[0]?m.push(O):p.push(O)}}t.rectGraphics.lineStyle(0),t.rectGraphics.beginFill(16777215),p.forEach((function(e){c.drawPoly(t,e[0],e[1],e[2],!0)}));var T=this.options.markColor||"black",A=this.options.fillOpacity||.3;t.rectGraphics.lineStyle(1,o(T),A),t.rectGraphics.beginFill(o(T),A),p.forEach((function(e){var i=c.drawPoly(t,e[0],e[1],e[2]);c.drawnRects[u][e[4].uid]=[i,{start:e[4],end:e[5],value:e[3],tile:t,fill:l},t.tileId]})),T=this.options.markColorFocus||"red",A=this.options.markOpacityFocus||.6,t.rectGraphics.lineStyle(1,o(T),A),t.rectGraphics.beginFill(o(T),A),m.forEach((function(e){var i=c.drawPoly(t,e[0],e[1],e[2]);c.drawnRects[u][e[4].uid]=[i,{start:e[4],end:e[5],value:e[3],tile:t,fill:l},t.tileId]})),t.rectGraphics.endFill()}return t.rectGraphics.interactive=!0,t.rectGraphics.buttonMode=!0,t.rectGraphics.mouseup=function(t){c.hoveringSnp&&c.pubSub.publish("app.click",{type:"snp",event:t,payload:c.hoveringSnp})},[p,m]}},{key:"getMouseOverHtml",value:function(t,e){var i=this;if(this.hoveringSnp=void 0,!this.tilesetInfo||!this.options.toolTip||!this.valueScale)return"";var a=this.calculateZoomLevel(),o=n.calculateTileWidth(this.tilesetInfo,a,this.tilesetInfo.tile_size),r=this._xScale.invert(t)/o,s=Math.floor(r),l=this.tileToLocalId([a,s]),c=this.fetchedTiles[l];if(!c)return"";var u=3;if(c.tileData.forEach((function(e){var a=Math.abs(i._xScale(e.xStart)-t);a<u&&(i.hoveringSnp=e,u=a)})),!this.hoveringSnp)return"";var h=this.finalDotYPos(this.valueScale(this.hoveringSnp.importance),2);if(Math.abs(h-(e-1))>6)return"";var d=this.hoveringSnp.fields[this.options.toolTip.name.field],p=(+this.hoveringSnp.fields[this.options.toolTip.value.field]).toFixed(this.options.toolTip.value.numDecimals||2),m="";return this.options.toolTip.other&&(this.options.toolTip.other.forEach((function(t){var e=t.label||"",a=(+i.hoveringSnp.fields[t.field]).toFixed(t.numDecimals||2);m+="".concat(e,": ").concat(a,";")})),m=" (".concat(m.substr(0,m.length-1),")")),"<div><strong>".concat(d,":</strong> ").concat(p).concat(m,"</div>")}},{key:"exportSVG",value:function(){var t=this,e=null,i=null,a=Object(Fe.a)(Object(He.a)(r.prototype),"exportSVG",this).call(this),n=Object(l.a)(a,2);i=n[0],e=n[1],i.setAttribute("class","exported-snp-track");var o=document.createElement("g");e.appendChild(o),o.setAttribute("transform","translate(".concat(this.position[0],",").concat(this.position[1],")")),this.visibleAndFetchedTiles().filter((function(t){return t.plusStrandRows})).forEach((function(e){var i=t.renderRows(e,e.plusStrandRows,e.plusStrandRows.length,0,t.dimensions[1],"blue"),a=Object(l.a)(i,2),n=a[0],r=a[1];n.forEach((function(e){var i=document.createElement("circle");i.setAttribute("fill",t.options.markColor||"black"),i.setAttribute("stroke-width",0),i.setAttribute("opacity",t.options.markOpacity||.33),i.setAttribute("r",t.options.markSize),i.setAttribute("cx",e[0]),i.setAttribute("cy",e[2]),o.appendChild(i)})),r.forEach((function(e){var i=document.createElement("circle");i.setAttribute("fill",t.options.markColorFocus||"red"),i.setAttribute("stroke-width",0),i.setAttribute("opacity",t.options.markOpacityFocus||.66),i.setAttribute("r",t.options.markSize+1),i.setAttribute("cx",e[0]),i.setAttribute("cy",e[2]),o.appendChild(i)}))}));var s=document.createElement("g");if(s.setAttribute("id","axis"),i.appendChild(s),s.setAttribute("transform","translate(".concat(this.axis.pAxis.position.x,", ").concat(this.axis.pAxis.position.y,")")),"left"===this.options.axisPositionHorizontal||"top"===this.options.axisPositionVertical){var c=this.axis.exportAxisLeftSVG(this.valueScale,this.dimensions[1]);s.appendChild(c)}else if("right"===this.options.axisPositionHorizontal||"bottom"===this.options.axisPositionVertical){var u=this.axis.exportAxisRightSVG(this.valueScale,this.dimensions[1]);s.appendChild(u)}return[i,e]}}]),r}(e.tracks.BedLikeTrack),s=arguments.length,c=new Array(s>1?s-1:0),u=1;u<s;u++)c[u-1]=arguments[u];return Object(Ne.a)(r,c)};ji.config={type:"point-annotation",datatype:["arcs","bedlike"],orientation:"1d",name:"Arcs1D",thumbnail:(new DOMParser).parseFromString('<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5"><path d="M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268" fill="none" stroke="currentColor"/><path d="M10.5 3.5v12" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-dasharray="1,2,0,0"/><path d="M5.5 13.5V6" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-width=".9969299999999999" stroke-dasharray="1.71,3.43,0,0"/><path d="M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z" fill="currentColor"/><path d="M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z" fill="currentColor"/></svg>',"text/xml").documentElement,availableOptions:["arcStyle","flip1D","labelPosition","labelColor","labelTextOpacity","labelBackgroundOpacity","strokeColor","strokeWidth","trackBorderWidth","trackBorderColor"],defaultOptions:{arcStyle:"ellipse",flip1D:"no",labelColor:"black",labelPosition:"hidden",strokeColor:"black",strokeWidth:1,trackBorderWidth:0,trackBorderColor:"black"},optionsInfo:{arcStyle:{name:"Arc Style",inlineOptions:{circle:{name:"Circle",value:"circle"},ellipse:{name:"Ellipse",value:"ellipse"}}}}};var Ri=ji,Ii="\nprecision mediump float;\nattribute vec2 aPosition;\nattribute float aColorIdx;\nattribute float aFocused;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform sampler2D uColorMapTex;\nuniform float uColorMapTexRes;\nuniform sampler2D uColorMapFocusTex;\nuniform float uColorMapFocusTexRes;\n\nvarying vec4 vColor;\nvarying vec4 vColorFocused;\nvarying float vFocused;\n\nvoid main(void)\n{\n  // Half a texel (i.e., pixel in texture coordinates)\n  float eps = 0.5 / uColorMapTexRes;\n  float colorRowIndex = floor((aColorIdx + eps) / uColorMapTexRes);\n  vec2 colorTexIndex = vec2(\n    (aColorIdx / uColorMapTexRes) - colorRowIndex + eps,\n    (colorRowIndex / uColorMapTexRes) + eps\n  );\n  vColor = texture2D(uColorMapTex, colorTexIndex);\n\n  float eps2 = 0.5 / uColorMapFocusTexRes;\n  float colorRowIndex2 = floor((aColorIdx + eps2) / uColorMapFocusTexRes);\n  vec2 colorTexIndex2 = vec2(\n    (aColorIdx / uColorMapFocusTexRes) - colorRowIndex2 + eps2,\n    (colorRowIndex2 / uColorMapFocusTexRes) + eps2\n  );\n  vColorFocused = texture2D(uColorMapFocusTex, colorTexIndex2);\n\n  vFocused = aFocused;\n\n  gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n}\n",Ni="\n  precision mediump float;\n\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vFocused;\n\n  void main() {\n    float isNotFocused = 1.0 - vFocused;\n\n    float r = vColor.r * isNotFocused + vColorFocused.r * vFocused;\n    float g = vColor.g * isNotFocused + vColorFocused.g * vFocused;\n    float b = vColor.b * isNotFocused + vColorFocused.b * vFocused;\n\n    gl_FragColor = vec4(r, g, b, 1.0);\n  }\n",Li=function(t){return t.tileData.length&&void 0!==t.tileData[0].yStart},zi=function(t){return t.xStart},Pi=function(t){return t.xStart+(t.xEnd-t.xStart)/2},Di=function(t){return t.xEnd},Fi=function(t){return t.yStart+(t.yEnd-t.yStart)/2},Hi=function(t){return t.reduce((function(t,e){return Math.max(t,e.histogramMax)}),0)},Gi=function(t,e,i){var a=(i.domain()[1]-i.domain()[0])/(e.domain()[1]-e.domain()[0]),n=e.domain().map(i)[0];t.scale.x=a,t.position.x=-n*a},Bi=function(t){return[t.xStart,t.yStart,t.xEnd,t.yStart,t.xEnd,t.yEnd,t.xStart,t.yStart,t.xStart,t.yEnd,t.xEnd,t.yEnd]},Wi=function(t){return[t.colorIdx,t.colorIdx,t.colorIdx,t.colorIdx,t.colorIdx,t.colorIdx]},Vi=function(t){return[t.focused,t.focused,t.focused,t.focused,t.focused,t.focused]},qi=function t(e){if(!(this instanceof t?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var i=e.libraries.PIXI,a=e.libraries.d3Scale,n=a.scaleLinear,o=a.scaleLog,r=e.services.tileProxy,s=e.utils.colorToHex,c=o().domain([1,10]).range([.1,1]).clamp(!0),u=function(t){return e.utils.colorToRgba(t).slice(0,3).map((function(t){return Math.min(1,Math.max(0,t/255))}))},h=function(t){Object(Ge.a)(a,t);var e=Object(Be.a)(a);function a(t,n){var o;return Object(Le.a)(this,a),(o=e.call(this,t,n)).updateOptions(),o.pLoading=new i.Graphics,o.pLoading.position.x=0,o.pLoading.position.y=0,o.pMasked.addChild(o.pLoading),o.loadIndicator=new i.Text("Loading data...",{fontSize:o.labelSize||10,fill:8421504}),o.pLoading.addChild(o.loadIndicator),o}return Object(ze.a)(a,[{key:"initTile",value:function(t){var e=Li(t),i=e?Pi:zi,a=e?Fi:Di;t.tileData.forEach((function(t){t.start=i(t),t.end=a(t),t.isLeftToRight=t.start<t.end})),t.histogramMax=0,this.updateTileFocusMap(t)}},{key:"updateTileHistogram",value:function(t){var e=this,i=this.getTilePosAndDimensions(t.tileData.zoomLevel,t.tileData.tilePos),a=i.tileX,n=i.tileWidth/this.numBins;t.binXPos=new Float32Array(this.numBins+1),t.histogram1d=new Float32Array(this.numBins),t.histogram2d=new Float32Array(this.numBins*this.numGroups),t.histogram2dNumPred=new Uint8Array(this.numBins*this.numGroups);for(var o=0,r=0;r<=this.numBins;r++)t.binXPos[r]=a+n*r;var s=new Map;t.tileData.forEach((function(i){for(var r=e.categoryToGroup.get(i.fields[e.categoryField].toLowerCase()),l=e.numBins-1,c=Math.max(0,Math.min(l,Math.round((i.xStart-a)/n))),u=Math.max(0,Math.min(l,Math.round((i.xEnd-a)/n))),h=Math.abs(u-c),d=e.getImportance(i),p=e.getCategory(i),m=r*e.numBins,g=0;g<=h;g++){var f=c+g,v=m+f,b=s.get(p)||{};b[f]||(b[f]=b[f]||d>0,t.histogram2dNumPred[v]+=b[f],s.set(p,b)),t.histogram2d[v]+=d,t.histogram1d[f]+=d,o=Math.max(o,t.histogram1d[f])}})),t.histogramMax=o}},{key:"updateHistograms",value:function(){Object.values(this.fetchedTiles).forEach(this.updateTileHistogram.bind(this))}},{key:"updateTileFocusMap",value:function(t){t.focusMap=new Float32Array(this.numBins);var e=this.getTilePosAndDimensions(t.tileData.zoomLevel,t.tileData.tilePos),i=e.tileX,a=e.tileWidth;if(i<=this.focusRegion[1]&&i+a>=this.focusRegion[0])for(var n=a/this.numBins,o=Math.max(0,Math.round((this.focusRegion[0]-i)/n)),r=Math.min(this.numBins-1,Math.round((this.focusRegion[1]-i)/n)),s=Math.abs(r-o),l=0;l<=s;l++)t.focusMap[l]=1}},{key:"updateFocusMap",value:function(){Object.values(this.fetchedTiles).forEach(this.updateTileFocusMap.bind(this))}},{key:"updateStratificationOption",value:function(){var t=this;if(!this.options.stratification)return this.categoryField=void 0,this.categoryToGroup=void 0,this.groupToColor=void 0,this.numGroups=0,this.numCategories=0,void(this.groupLabels=[]);this.categoryField=this.options.stratification.categoryField,this.getCategory=function(e){return e.fields[t.categoryField].toLowerCase()},this.categoryToGroup=new Map,this.categoryToY=new Map,this.groupToColor=new Map,this.numGroups=this.options.stratification.groups.length,this.groupSizes=this.options.stratification.groups.map((function(t){return t.categories.length})),this.numCategories=this.groupSizes.reduce((function(t,e){return t+e}),0),this.groupLabels=this.options.stratification.groups.map((function(t,e){return t.label||"Group ".concat(e)}));var e=0;this.options.stratification.groups.forEach((function(i,a){t.groupToColor.set(a,[s(i.color||yt[a%yt.length]),s(i.backgroundColor||kt[a%kt.length])]),i.categories.forEach((function(i,n){t.categoryToGroup.set(i.toLowerCase(),a),t.categoryToY.set(i.toLowerCase(),e+n)})),e+=i.categories.length})),this.groupLabelsPixiText=this.groupLabels.map((function(e,a){return new i.Text(e,{fontSize:t.labelSize,align:"right"===t.axisAlign?"right":"left",fill:s(t.options.stratification.groups[a].axisLabelColor||wt[a%wt.length])})}))}},{key:"updateOptions",value:function(){var t=this;this.axisAlign=this.options.axisAlign||"left",this.labelColor=s(this.options.labelColor||"black"),this.labelSize=this.options.labelSize||12,this.colorMap=this.options.colorMap||Object(k.a)(yt),this.colorMapRgbNorm=this.colorMap.map(u);var e=jt(i,this.colorMapRgbNorm),a=Object(l.a)(e,2);this.colorMapTex=a[0],this.colorMapTexRes=a[1],this.colorMapFocus=this.options.colorMapFocus||Object(k.a)(wt),this.colorMapFocusRgbNorm=this.colorMapFocus.map(u);var o=jt(i,this.colorMapFocusRgbNorm),r=Object(l.a)(o,2);this.colorMapFocusTex=r[0],this.colorMapFocusTexRes=r[1],this.markColor=s(this.options.markColor||"black"),this.markColorRgbNorm=this.options.markColor?u(this.options.markColor):[0,0,0],this.markOpacity=Number.isNaN(+this.options.markOpacity)?1:Math.min(1,Math.max(0,+this.options.markOpacity)),this.markSize=this.options.markSize||2,this.markColorFocus=s(this.options.markColorFocus||"red"),this.markColorFocusRgbNorm=this.options.markColorFocus?u(this.options.markColorFocus):[1,0,0],this.markOpacityFocus=Number.isNaN(+this.options.markOpacityFocus)?this.markOpacity:Math.min(1,Math.max(0,+this.options.markOpacityFocus)),this.markSizeFocus=this.options.markSizeFocus||this.markSize,this.binSize=this.options.binSize||8,this.numBins=this.tilesetInfo?Math.round(this.tilesetInfo.tile_size/this.binSize):1024/this.binSize,this.getImportance=this.options.importanceField?function(e){return+e.fields[t.options.importanceField]}:function(){return 1};var h=this.options.importanceDomain||[1e3,1],d=n().domain(h).range([1,10]);this.opacityScale=function(t){return c(d(t))},this.focusRegion=this.options.focusRegion?this.options.focusRegion:[1/0,1/0],this.focusGene=this.options.focusGene?this.options.focusGene.toLowerCase():void 0,this.getGene=this.options.geneField?function(e){return e.fields[t.options.geneField].toLowerCase()}:void 0,this.minImportance=this.options.minImportance||0,this.updateStratificationOption(),this.updateFocusMap(),this.updateHistograms(),this.updateScales()}},{key:"updateLoadIndicator",value:function(){var t=Object(l.a)(this.position,2),e=t[0],i=t[1];this.pLoading.position.x=e+6,this.pLoading.position.y=i+6,this.fetching.size?this.pLoading.addChild(this.loadIndicator):this.pLoading.removeChild(this.loadIndicator)}},{key:"refreshTiles",value:function(){for(var t,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];if((t=Object(Fe.a)(Object(He.a)(a.prototype),"refreshTiles",this)).call.apply(t,[this].concat(i)),this.updateLoadIndicator(),this.tilesetInfo){var o=this.numBins;this.numBins=Math.round(this.tilesetInfo.tile_size/this.binSize),o!==this.numBins&&(this.updateHistograms(),this.updateScales())}}},{key:"rerender",value:function(t){this.options=t,this.updateOptions(),this.updateExistingGraphics()}},{key:"updateScales",value:function(){var t=Object.values(this.fetchedTiles);if(t.length){var e=Object(l.a)(this.dimensions,2)[1];this.histMax=Hi(t),this.heightScale=n().domain([0,this.histMax]).range([e,0]),this.valueScale=this.heightScale,this.valueScaleInverted=n().domain([0,this.histMax]).range([0,e])}}},{key:"itemToPoint",value:function(t){return{xStart:this._xScale(t.start),xEnd:this._xScale(t.start),yStart:this.heightScale(this.categoryToY.get(t.fields[this.categoryField].toLowerCase())),yEnd:function(){},opacity:this.opacityScale(this.getImportance(t)),focused:t.xStart<=this.focusRegion[1]&&t.xEnd>=this.focusRegion[0]}}},{key:"histToSegments",value:function(t){for(var e=[],i=0;i<this.numBins;i++){var a=0;if(t.histogram1d[i]>0)for(var n=0;n<this.numGroups;n++){var o=t.histogram2d[n*this.numBins+i];o&&(e.push({xStart:this._xScale(t.binXPos[i]),xEnd:this._xScale(t.binXPos[i+1]),yStart:this.heightScale(a),yEnd:this.heightScale(a+o),colorIdx:n%this.colorMap.length,focused:t.focusMap[i]}),a+=o)}}return e}},{key:"renderStackedBars",value:function(){this.drawnAtScale=n().domain(Object(k.a)(this.xScale().domain())).range(Object(k.a)(this.xScale().range()));var t=Object.values(this.fetchedTiles).flatMap(this.histToSegments.bind(this)),e=new Float32Array(t.flatMap(Bi)),a=new Float32Array(t.flatMap(Wi)),o=new Float32Array(t.flatMap(Vi)),r=new i.UniformGroup({uColorMapTex:this.colorMapTex,uColorMapTexRes:this.colorMapTexRes,uColorMapFocus:this.colorMapFocusTex,uColorMapFocusTexRes:this.colorMapFocusTexRes}),s=i.Shader.from(Ii,Ni,r),l=new i.Geometry;l.addAttribute("aPosition",e,2),l.addAttribute("aColorIdx",a,1),l.addAttribute("aFocused",o,1);var c=new i.Mesh(l,s,new i.State,i.DRAW_MODES.TRIANGLES),u=new i.Graphics;u.addChild(c),this.pMain.x=this.position[0],this.indicatorPointGraphics&&this.pMain.removeChild(this.indicatorPointGraphics),this.pMain.addChild(u),this.indicatorPointGraphics=u,Gi(this.indicatorPointGraphics,this._xScale,this.drawnAtScale),this.draw(),this.animate()}},{key:"renderTrack",value:function(){this.drawAxis(this.valueScaleInverted),this.renderStackedBars()}},{key:"hasFetchedTiles",value:function(){return Object.values(this.fetchedTiles).length}},{key:"updateExistingGraphics",value:function(){this.updateLoadIndicator(),this.hasFetchedTiles()&&(this.updateHistograms(),this.updateScales(),this.renderTrack())}},{key:"getMouseOverHtml",value:function(t,e){if(!this.tilesetInfo)return"";var i=this.calculateZoomLevel(),a=r.calculateTileWidth(this.tilesetInfo,i,this.tilesetInfo.tile_size),n=this._xScale.invert(t)/a,o=Math.floor(n),s=this.tileToLocalId([i,o]),c=this.fetchedTiles[s];if(!c)return"";for(var u=n-o,h=Math.floor(this.numBins*u),d=[],p=[],m=0,g=0,f=0;f<this.numGroups;f++){g+=c.histogram2d[f*this.numBins+h];var v=c.histogram2dNumPred[f*this.numBins+h];p.push(v),m+=v,d.push(g)}var b=this.heightScale.invert(e),x=d.findIndex((function(t){return t>b}));if(x>=0){var y=this.groupToColor.get(x),w=Object(l.a)(y,2),k=w[0],C=w[1],E="#".concat(k.toString(16)),S="#".concat(C.toString(16)),O=c.histogram2dNumPred[x*this.numBins+h];return'<div style="margin: -0.25rem; padding: 0 0.25rem; background: '.concat(S,'"><strong style="color: ').concat(E,';">').concat(this.groupLabels[x],":</strong> ").concat(O," of ").concat(m," samples</div>")}return""}},{key:"setPosition",value:function(t){Object(Fe.a)(Object(He.a)(a.prototype),"setPosition",this).call(this,t);var e=Object(l.a)(this.position,2);this.pMain.position.x=e[0],this.pMain.position.y=e[1]}},{key:"zoomed",value:function(t,e){this.xScale(t),this.yScale(e),this.indicatorPointGraphics&&Gi(this.indicatorPointGraphics,t,this.drawnAtScale),this.refreshTiles(),this.draw()}},{key:"exportSVG",value:function(){var t=this,e=null,i=null,n=Object(Fe.a)(Object(He.a)(a.prototype),"superSVG",this).call(this),o=Object(l.a)(n,2);i=o[0],e=o[1],i.setAttribute("class","exported-stacked-bar-track");var r=document.createElement("g");e.appendChild(r),r.setAttribute("transform","translate(".concat(this.position[0],",").concat(this.position[1],")")),Object.values(this.fetchedTiles).flatMap(this.histToSegments.bind(this)).forEach((function(e){var i=e.xStart,a=e.xEnd,n=e.yStart,o=e.yEnd,s=e.colorIdx,l=document.createElement("rect");l.setAttribute("x",a),l.setAttribute("y",o),l.setAttribute("width",Math.abs(a-i)),l.setAttribute("height",Math.abs(o-n)),l.setAttribute("fill",t.colorMap[s]),l.setAttribute("stroke-width",0),r.appendChild(l)}));var s=document.createElement("g");if(s.setAttribute("id","axis"),i.appendChild(s),s.setAttribute("transform","translate(".concat(this.axis.pAxis.position.x,", ").concat(this.axis.pAxis.position.y,")")),"left"===this.options.axisPositionHorizontal||"top"===this.options.axisPositionVertical){var c=this.axis.exportAxisLeftSVG(this.valueScale,this.dimensions[1]);s.appendChild(c)}else if("right"===this.options.axisPositionHorizontal||"bottom"===this.options.axisPositionVertical){var u=this.axis.exportAxisRightSVG(this.valueScale,this.dimensions[1]);s.appendChild(u)}return[i,e]}}]),a}(e.tracks.HorizontalLine1DPixiTrack),d=arguments.length,p=new Array(d>1?d-1:0),m=1;m<d;m++)p[m-1]=arguments[m];return Object(Ne.a)(h,p)};qi.config={type:"stacked-bar",datatype:["bedlike"],orientation:"1d",name:"Advanced Stacked Bars Track",thumbnail:(new DOMParser).parseFromString('<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5"><path d="M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268" fill="none" stroke="currentColor"/><path d="M10.5 3.5v12" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-dasharray="1,2,0,0"/><path d="M5.5 13.5V6" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-width=".9969299999999999" stroke-dasharray="1.71,3.43,0,0"/><path d="M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z" fill="currentColor"/><path d="M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z" fill="currentColor"/></svg>',"text/xml").documentElement,availableOptions:["arcStyle","flip1D","labelPosition","labelColor","labelTextOpacity","labelBackgroundOpacity","strokeColor","strokeWidth","trackBorderWidth","trackBorderColor"],defaultOptions:{arcStyle:"ellipse",flip1D:"no",labelColor:"black",labelPosition:"hidden",strokeColor:"black",strokeWidth:1,trackBorderWidth:0,trackBorderColor:"black"},optionsInfo:{arcStyle:{name:"Arc Style",inlineOptions:{circle:{name:"Circle",value:"circle"},ellipse:{name:"Ellipse",value:"ellipse"}}}}};var Ui=qi,Xi=i(229);function Yi(t){if(!(this instanceof Yi?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var e=function(t){Object(Ge.a)(i,t);var e=Object(Be.a)(i);function i(t,a){var n;Object(Le.a)(this,i),n=e.call(this,t,a);var o=Object(Xi.a)(),r=o.publish,s=o.subscribe,l=o.unsubscribe;return n.publish=r,n.subscribe=s,n.unsubscribe=l,n}return Object(ze.a)(i,[{key:"drawPoly",value:function(t,e,i,a){var n=[e,a,i,a,i,this.dimensions[1],e,this.dimensions[1]],o=1,r=2;return t.rectGraphics.drawCircle(e,this.finalDotYPos(a,o),r),n}},{key:"renderRows",value:function(t,e,i,a,n,o){var r=this,s=+t.tileId.split(".")[0];this.initialize();for(var l=this.options.focusRegion||[1/0,1/0],c=[],u=[],h=0;h<e.length;h++){for(var d=0;d<e[h].length;d++){var p=e[h][d].value,m=p.fields,g=+p.chrOffset,f=+m[1]+g,v=+m[2]+g,b=this._xScale(f),x=this._xScale(v);if(!(s in this.drawnRects)||!(p.uid in this.drawnRects[s])){this.drawnRects[s]||(this.drawnRects[s]={});var y={xStartScreen:b,xEndScreen:x,xStartAbs:f,xEndAbs:v,data:p};f<=l[1]&&v>=l[0]?u.push(y):c.push(y)}}c.forEach((function(t){r.publish("annotationDrawn",t)}))}}},{key:"rerender",value:function(){this.draw(),this.publish("tilesDrawn",{uuid:this.uuid})}},{key:"updateExistingGraphics",value:function(){Object(Fe.a)(Object(He.a)(i.prototype),"updateExistingGraphics",this).call(this),this.publish("tilesDrawn",{uuid:this.uuid})}},{key:"getMouseOverHtml",value:function(){return""}}]),i}(t.tracks.BedLikeTrack),i=arguments.length,a=new Array(i>1?i-1:0),n=1;n<i;n++)a[n-1]=arguments[n];return Object(Ne.a)(e,a)}Yi.config={type:"tss",datatype:["bedlike"]};var Ji=Yi;i(424);Object(a.a)({track:$e,config:$e.config}),Object(a.a)({track:_i,config:_i.config}),Object(a.a)({track:pi,config:pi.config}),Object(a.a)({track:Ri,config:Ri.config}),Object(a.a)({track:Ui,config:Ui.config}),Object(a.a)({track:Ji,config:Ji.config}),Object(a.a)({track:De,config:De.config,isMetaTrack:!0}),s.a.render(o.a.createElement(Ie,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[313,1,2]]]);
//# sourceMappingURL=main.cdd3b186.chunk.js.map