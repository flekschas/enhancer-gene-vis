{"version":3,"sources":["images/enhancer-view-1.png","images/enhancer-view-2.png","images/enhancer-view-3.png","images/enhancer-view-4.png","images/enhancer-view-5.png","images/gene-view-1.png","images/gene-view-2.png","AppInitializing.js","AppError.js","ChromInfoProvider.js","use-debounce.js","CheckboxList.js","Logo.js","FileInput.js","utils.js","local-bed-data-server.js","use-query-string.js","constants.js","view-config.js","state.js","VariantsSettings.js","Welcome.js","ModalProvider.js","AppSidebar.js","SearchField.js","use-previous.js","AppTopbar.js","EnhancerRegionsInfo.js","EnhancerRegionsHelp.js","EnhancerRegionsSettings.js","TitleBar.js","EnhancerRegions.js","EnhancerGenesInfo.js","EnhancerGenesHelp.js","AntSwitch.js","EnhancerGenesSettings.js","TooltipProvider.js","EnhancerGenesPlot.js","EnhancerGenes.js","DnaAccessibilityInfo.js","DnaAccessibilityHelp.js","DnaAccessibilitySettings.js","DnaAccessibility.js","AppMain.js","with-either.js","App.js","serviceWorker.js","annotation-overlay-meta-track.js","ridge-plot-track.js","stratified-bed-track.js","snp-track.js","stacked-bar-track.js","tss-track.js","local-bed-data-fetcher.js","index.js"],"names":["module","exports","useStyles","makeStyles","theme","backdrop","zIndex","drawer","color","backgroundColor","AppInitializing","classes","className","Backdrop","open","CircularProgress","ChromInfoContext","createContext","ChromInfoProvider","children","chromInfo","Provider","value","useChromInfo","context","React","useContext","undefined","Error","useDebounce","delay","useState","debouncedValue","setDebouncedValue","useEffect","handler","setTimeout","clearTimeout","root","position","filterBar","top","content","right","left","bottom","background","checkbox","marginTop","marginBottom","checkboxLabel","fontSize","marginLeft","nestedCheckbox","visible","transition","transform","height","invisible","Option","memo","filterState","name","stateWithName","group","stateWithGroup","colorCheckbox","colorText","filter","useRecoilValue","useRecoilState","state","setState","groupState","setGroupState","nameLowerCase","useMemo","toLowerCase","changeHandler","useCallback","event","currState","checked","target","currGroupState","newGroupState","n","N","length","includes","FormControlLabel","key","control","Checkbox","style","icon","checkedIcon","onChange","label","Typography","noWrap","OptionGroup","NestedCheckboxList","optionWithName","optionGroupWithGroup","filterLabel","groupedOptions","optionToGroup","groupColors","groupColorsDark","globalFilter","setGlobalFilter","setFilter","filterDb","filterChangeHandler","filterBarBg","FormControl","variant","margin","fullWidth","InputLabel","htmlFor","Grid","container","direction","alignItems","OutlinedInput","id","FormGroup","map","i","Fragment","options","option","logo","padding","lineHeight","fontWeight","logoAbc","letterSpacing","paddingRight","logoEnhancer","Logo","props","styles","item","defaultProps","FileInput","forwardRef","ref","clearHandler","onClear","accept","Icon","InsertDriveFileIcon","otherProps","file","setFile","localChangeHandler","fileList","files","clearFile","ButtonGroup","Button","component","disableElevation","startIcon","type","hidden","disabled","onClick","createColorTexture","PIXI","colors","colorTexRes","Math","max","ceil","sqrt","rgba","Float32Array","forEach","Texture","fromBuffer","dashedXLineTo","graphics","xStart","xEnd","y","dashSize","diff","sign","width","abs","stepSize","numSteps","moveTo","lineTo","getQueryStringValue","decoder","identity","queryString","parse","window","location","search","setQueryStringValue","encoder","values","newQsValue","stringify","strict","url","origin","pathname","history","pushState","path","toAbsPosition","absPosition","indexOf","split","chrom","pos","chrPositions","toFixed","number","decimals","forced","string","substring","scaleBand","domain","fixedBandwidth","bandwidth","range","rangeSize","paddingInner","paddingInnerZeroBased","totalWidth","sum","a","b","getBandwidth","update","totalPaddingInner","reduce","scale","v","idx","slice","newDomain","newRange","newFixedBandwidth","newPaddingInner","newPaddingInnerZeroBased","booleanQueryStringDecoder","isChrRange","chrRange","match","chrPosUrlDecoder","chrPos","replace","chrPosUrlEncoder","chrPosAdd","chrRangePosUrlDecoder","chrRangePos","start","end","chrRangePosEncoder","chrPosEncoder","lengthOperator","startChrom","startPos","endChrom","endPos","join","chrRangePosUrlEncoder","header","columnImportance","tree","IntervalTree","text","lines","fields","chromOffset","startAbs","endAbs","insert","chrOffset","importance","uid","createLocalBedDataServer","tilesetInfo","whenIndex","loadFile","subscriptionTile","globalPubSub","subscribe","fileId","z","x","requestId","then","index","tileWidth","max_width","results","publish","subscriptionTilesetInfo","destroy","unsubscribe","useRecoilQueryString","atom","setValue","newValue","useRecoilQueryStringSyncher","EPS","DEFAULT_COLOR_MAP","DEFAULT_COLOR_MAP_DARK","DEFAULT_COLOR_MAP_LIGHT","GENE_SEARCH_URL","VARIANT_SEARCH_URL","EG_TILE_UID","DEFAULT_STRATIFICATION","categoryField","axisShowGroupSeparator","axisNoGroupColor","groups","categories","GROUPED_SAMPLE_OPTIONS","SAMPLE_TO_GROUP","sampleToGroup","SAMPLES","flatMap","SAMPLE_IDX","idxs","sample","VARIANT_TRACK_ABBR_TO_SERVER","rg","hg","VARIANT_TRACK_SERVER_TO_ABBR","Object","entries","abbr","DEFAULT_VARIANT_TRACK_SERVER_ABBR","DEFAULT_VARIANT_TRACK_DEF","axisPositionHorizontal","markColor","markColorFocus","markSize","markOpacity","markOpacityFocus","valueColumn","labelPosition","labelColor","labelOpacity","showMousePosition","showGlobalMousePosition","mousePositionColor","toolTip","field","numDecimals","other","LOCAL_BED_TILESET_INFO_HG19","zoom_step","max_length","assembly","chrom_names","chrom_sizes","tile_size","max_zoom","min_pos","max_pos","version","coordSystem","DEFAULT_VIEW_CONFIG_ENHANCER","editable","trackSourceServers","views","genomePositionSearchBox","autocompleteServer","autocompleteId","chromInfoServer","chromInfoId","chromInfoPath","tracks","contents","stroke","fontIsLeftAligned","tilesetUid","server","fromViewUid","projectionFillColor","projectionStrokeColor","projectionFillOpacity","projectionStrokeOpacity","strokeWidth","plusStrandColor","minusStrandColor","geneAnnotationHeight","geneLabelPosition","geneStrandSpacing","maxPerTile","focusRegion","strokeColor","strokeOpacity","arcStyle","startField","endField","set","binSize","axisAlign","offsetField","importanceField","importanceDomain","stratification","legendAlign","markColorHighlight","markColorDehighlight","markMinWidth","markHeight","rowHeight","indicatorStyle","geneField","overlays","extent","minWidth","fill","fillOpacity","outline","outlineOpacity","outlineWidth","outlinePos","metaTracks","overlaysTrack","annotationTracks","layout","w","h","initialXDomain","initialYDomain","DEFAULT_DNA_ACCESSIBILITY_ROW_SELECTION","DEFAULT_DNA_ACCESSIBILITY_ROW_CATEGORIES","row","category","axisLabelColor","axisLabelBackground","DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY","zoomFixed","labelShowResolution","labelShowAssembly","markArea","markResolution","valueScaling","colorRange","rowPadding","rowNormalization","rowSelections","rowIdToCategory","fn","args","rowCategories","showRowLabels","rowLabelSize","IGNORED_FOCUS_ELEMENTS","Set","getFocusGeneRegion","viewConfig","getFocusVariantRegion","track","updateViewConfigVariantTracks","variantTrackConfigs","trackConfig","variantTrack","deepClone","push","data","updateViewConfigFocusRegion","region","trackIdxs","Array","isArray","trackIdx","childTrack","setFocusRegion","updateViewConfigVariantYScale","yScale","updateViewConfigXDomain","newXDomainStart","newXDomainEnd","force","_force","isFunction","xDomain","focusGeneRegion","focusVariantRegion","Number","isNaN","min","getDefault","initialValue","qVal","showWelcomeDecoder","excluded","s","_s","add","has","customBooleanQueryStringDecoder","variantTracksEncoder","serverAbbr","pValCol","columnPvalue","pProbCol","columnPosteriorProbability","sampleFilterState","default","sampleSelectionState","selector","get","sampleWithName","selectedSamplesState","memoize","sampleGroupWithGroup","sampleGroupSelectionSizesState","sizes","variantTracksState","showVariantsSettingsState","showWelcomeState","dnaAccessLabelStyleState","dnaAccessRowNormState","dnaAccessLabelShowInfoState","focusGeneState","focusGeneOptionState","focusRegionState","focusRegionOptionState","chrStart","txStart","chrEnd","txEnd","geneName","variantYScaleState","enhancerRegionsHideUnfocusedState","enhancerRegionsColorEncodingState","enhancerRegionsShowInfoState","enhancerGenesShowInfoState","enhancerGenesPaddingState","enhancerGenesCellEncodingState","enhancerGenesSvgState","higlassEnhancerRegionsState","higlassDnaAccessState","xDomainStartWithAssembly","totalLength","absToChr","xDomainEndWithAssembly","xDomainStartAbsWithAssembly","xDomainStart","xDomainEndAbsWithAssembly","xDomainEnd","focusGeneStartWithAssembly","focusGeneOption","chr","focusGeneEndWithAssembly","focusRegionAbsWithAssembly","focusRegionOption","focusRegionRelState","NaN","focusRegionStrState","dnaAccessXDomainWithAssembly","focusRegionAbs","focusGeneStart","focusGeneEnd","xDomainStartAbs","xDomainEndAbs","interval","enhancerViewRange","enhancerViewCenter","focusRegionCenter","midPos","getDnaAccessXDomain","useFocusGene","useFocusRegion","useDnaAccessShowInfos","useXDomainStartWithAssembly","useXDomainEndWithAssembly","useEnhancerRegionsShowInfos","useEnhancerGenesShowInfos","note","palette","grey","title","buttonNormal","buttonActive","boxShadow","trackList","useStylesTrackConfig","grow","flex","separator","marginRight","propInput","useStylesTooltipVisible","arrow","tooltip","useStylesTooltipHidden","display","TrackConfig","config","propertyChangeHandler","property","isRemote","Boolean","isLocal","whatever","classesTooltipVisible","classesTooltipHidden","Tooltip","placement","TextField","size","step","VariantsSettings","closeHandler","variantTracks","setVariantTracks","setFocusRegionOption","tmpVariantTracks","setTmpVariantTracks","changed","setChanged","variantTrackServers","useRef","currVariantTracks","current","changeTmpVariantTracks","newTrackConfig","currTmpVariantTracks","newTmpVariantTracks","saveHandler","newVariantTracks","servers","some","currFocusRegion","isString","currFocusRegionOption","align","href","rel","variantTrackConfig","justifyContent","spacing","showIntro","startExploring","introTitle","textTransform","introHeadline","introSubHeadline","introStartExploring","figure","Welcome","openIntroHandler","closeIntroHandler","showWelcome","src","imgEnhancerView1","alt","imgEnhancerView2","imgEnhancerView3","imgEnhancerView4","imgEnhancerView5","IconButton","imgGeneView1","imgGeneView2","ModalContext","paper","borderRadius","shadows","maxWidth","maxHeight","overflow","ModalProvider","Component","setComponent","customCloseHandler","setCustomCloseHandler","customProps","setCustomProps","showModal","newComponent","newCustomCloseHandler","newCustomProps","Modal","aria-labelledby","aria-describedby","onClose","closeAfterTransition","BackdropComponent","BackdropProps","timeout","Fade","in","h1","flexShrink","drawerGrid","drawerPaper","settings","flexGrow","globalSettingsTitle","settingsContent","toolbar","mixins","titleBar","titleBarText","titleBarContainer","titleBarTitle","titleBarIcon","titleBarIconActive","globalSettingsFirstBox","extractCoreFromHiGlassSvg","svg","fifthLn","nthIndexOf","lastLn","lastIndexOf","core","AppSidebar","useShowModal","setXDomainStart","setXDomainEnd","setShowWelcome","showVariantsSettings","setShowVariantsSettings","higlassEnhancerRegions","higlassDnaAccess","enhancerGenesSvg","userChangedDomain","setUserChangedDomain","numericalXDomainStart","chrToAbs","numericalXDomainEnd","xDomainStartChangeHandler","xDomainEndChangeHandler","curr","closeWelcome","openWelcome","openWelcomeIntro","closeVariantsSettings","openVariantsSettings","mergeSvgs","enhancerSvg","dnaAccessSvg","enhancerGeneSvg","enhancerSvgCore","enhancerWidth","enhancerHeight","dnaAccessSvgCore","dnaAccessWidth","dnaAccessHeight","firstSvgClosingBracket","lastSvgOpeningBracket","extractCoreFromStringifiedSvg","enhancerGeneSvgCore","enhancerGeneHeight","actualEnhancerHeight","actualDnaAccessHeight","mergedSvg","Drawer","anchor","ButtonBase","Divider","Box","m","getViewConfig","zoomTo","CheckboxList","exportAsSvg","XMLSerializer","serializeToString","filename","stringOrBlob","blob","Blob","navigator","msSaveOrOpenBlob","msSaveBlob","elem","document","createElement","URL","createObjectURL","download","body","appendChild","click","removeChild","revokeObjectURL","console","warn","inputRoot","borderTopLeftRadius","borderTopRightRadius","borderBottomWidth","focused","input","textFieldRoot","fetchJsonFromUrl","query","fetch","response","json","result","GeneIcon","SvgIcon","viewBox","d","GeneOption","VariantOption","RegionOption","getIcon","SearchField","setOpen","setOptions","inputValue","searchQuery","setSearchQuery","debouncedSearchQuery","loading","autocompleteClasses","customSearch","searchUrl","active","whenResults","Promise","all","flat","multiple","autocompleteOptions","Autocomplete","larger","onInputChange","newInputValue","onOpen","getOptionSelected","_value","getOptionLabel","renderInput","params","InputProps","endAdornment","renderOption","renderTags","getTagProps","Chip","usePrevious","appBar","common","black","white","toolbarExtra","paddingLeft","locationSearch","startChr","endChr","AppTopbar","focusGene","setFocusGene","setFocusGeneOption","prevFocusGeneOption","prevFocusRegionOption","focusOptions","_focusOptions","clearFocusGene","clearFocusRegion","AppBar","Toolbar","newOptions","newFocusElements","newOption","gene","gray","pink","EnhancerRegionsInfo","showInfo","iconRadioLegend","variantYScale","setVariantYScale","hideUnfocused","setHideUnfocused","colorEncoding","setColorEncoding","hideUnfocusedChangeHandler","changeVariantYScale","changeColorEncoding","Switch","FormLabel","RadioGroup","aria-label","iconRadio","iconRadioActive","bar","iconActive","popeover","paddingTop","info","borderBottom","TitleBar","Info","Help","Settings","useShowInfo","popoverDirection","setShowInfo","helpAnchorEl","setHelpAnchorEl","settingsAnchorEl","setSettingsAnchorEl","infoToggleHandler","show","helpOpenHandler","currentTarget","helpCloseHandler","settingsOpenHandler","settingsCloseHandler","helpId","settingsId","anchorOriginVertical","transformOriginVertical","helpOpen","settingsOpen","iconInfoClass","iconHelpClass","iconSettingsClass","wrap","Popover","anchorEl","anchorOrigin","vertical","horizontal","transformOrigin","fullWidthHeight","higlassContainer","minHeight","panZoomTip","textAlign","opacity","animation","userSelect","panZoomTipNormal","panZoomTipNormalHover","panZoomTipActive","panZoomTipActiveHover","EnhancerRegion","useSetRecoilState","setHiglass","sampleGroupSelectionSizes","selectedSamples","higlassMouseOver","setHiglassMouseOver","higlassFocus","setHiglassFocus","higlassApi","higlassRangeSelection","higlassListeners","higlassContainerRef","higlassEnhancerClickSelection","higlassMouseDown","higlassNumMouseOver","higlassNumFocus","higlassNumFocusMouseOut","shouldSkipUpdatingXDomain","numSamples","pipe","focusStyle","updateViewConfigFocusStyle","coloring","opacityEncoding","updateViewConfigFilter","matrixTrack","updateViewConfigMatrixHeight","viewConfigHeight","higlassBlockClasses","higlassClickHandler","payload","score","higlassLocationChangeHandlerDb","debounce","absPos","higlassRangeSelectionHandler","dataRange","windowMouseDownClearHandler","e","isParentOf","addEventListener","removeEventListener","higlassMouseDownHandler","higlassInitHandler","higlassInstance","api","setRangeSelectionToInt","on","getComponent","element","keydownHandler","activeElement","tagName","preventDefault","altKey","activateTool","keyupHandler","off","EnhancerRegionsHelp","EnhancerRegionsSettings","onMouseEnter","onMouseLeave","onMouseDown","onFocus","onBlur","tabIndex","sizeMode","globalMousePosition","verticalAlign","placeholder","fontStyle","small","medium","large","focusRegionStr","cellEncoding","justify","AntSwitch","withStyles","switchBase","primary","main","borderColor","thumb","border","switch","EnhancerGenesSettings","setCellEncoding","setPadding","changeCellEncoding","TooltipContext","pointerEvents","TooltipProvider","localState","setLocalState","showTooltip","plot","plotSvg","useTooltipStyles","uuid","fetchTiles","tileIds","tileId","samples","j","dodge","radius","radius2","circles","sort","head","tail","intersects","next","Infinity","EnhancerGenesPlot","useShowTooltip","sampleSelection","geneCellEncoding","absRange","relPosition","strPosition","genePadding","plotEl","setPlotEl","tile","setTile","isLoadingTile","setIsLoadingTile","setTilesetInfo","setWidth","prevWidth","prevGeneCellEncoding","absStart","absEnd","regionLength","minTileSize","getMinTileSize","zoomOutLevel","log2","zoomLevel","tileSize","tileXPosStart","floor","tileXPosEnd","ids","xPos","tiles","filterIntervalsByRange","plotElRef","node","isInit","maxScore","minAbsDistance","maxAbsDistance","genes","categoryAggregation","numEnhancers","distComparator","absDistance","genesUpstreamByDist","TinyQueue","genesDownstreamByDist","entry","relGenePos","distance","isDownstream","samplesByCategory","sampleCat","sampleObj","sampleCategory","maxScoreSample","genesDownstreamByDistArr","pop","genesUpstreamByDistArr","prevGene","relDistance","useLayoutEffect","measure","requestAnimationFrame","currWidth","getBoundingClientRect","tooltipClasses","select","paddingBottom","circleRadius","circlePadding","geneLabelPadding","beeswarmPadding","distanceBarWidth","distPaddingRange","attr","maxCatgorySize","cat","categorySizeScale","scaleLog","clamp","percentScale","scaleLinear","scoreScale","circleYScalePre","circleYScalePost","circleYScale","geneContainerWidth","maxGenes","genesUpstream","reverse","genesDownstream","minMax","minRelDistance","maxRelDistance","paddingScale","genesUpstreamPadding","round","genesUpstreamScale","genesDownstreamPadding","genesDownstreamScale","genesUpstreamLeftPad","minVisibleAbsDist","minDist","maxVisibleAbsDist","maxDist","distanceHeightScale","plotBeeswarm","selection","isRightAligned","selectAll","getArrayNumCols","maxSize","plotArray","numCols","instanceCache","tooltipTitleGetter","cellSize","indexToX","indexToY","bBox","arrayTooltipTitleGetter","geneArrayInstances","upstream","downstream","geneArrayInstanceMouseEnterHandler","dHovering","geneArrayInstanceMouseLeaveHandler","plotBox","valueScale","valueGetter","cellWidth","fillColor","forceMaxSize","textColor","showText","showZero","showTooltipOnMouseEnter","sizeGetter","bg","enhancerTooltipTitleGetter","boxTooltipTitleGetter","boxScoreTooltipTitleGetter","replaceAll","enhancerG","enhancerGCellG","genesUpstreamG","geneLabelX","geneLabelY","genesUpstreamGCellG","remove","genesDownstreamG","genesDownstreamGCellG","distRange","distStep","tickValues","call","axisRight","tickSize","tickFormat","this","parentNode","nextSibling","g","plotEnhancerGeneConnections","EnhancerGenes","EnhancerGenesInfo","EnhancerGenesHelp","DnaAccessibilityInfo","xDomainAbs","dnaAccessibilityRegionSize","DnaAccessibilityHelp","DnaAccessibilitySettings","dnaAccessLabelStyle","setDnaAccessLabelStyle","dnaAccessRowNorm","setDnaAccessRowNorm","changeDnaAccessLabelStyle","DnaAccessibility","setHiglassDnaAccess","labelStyle","rowNorm","xDomainAbsDb","labels","updateViewConfigDnaAccessRowNorm","rowId","pixelPreciseMarginPadding","containerPaddingX","containerPaddingY","viewMarginTop","viewMarginBottom","viewMarginLeft","viewMarginRight","viewPaddingTop","viewPaddingBottom","viewPaddingLeft","viewPaddingRight","enhancerWrapper","enhancer","overflowY","enhancerRegions","enhancerGenes","dnaAccessibility","AppMain","useXDomainStartWithAssemblySyncher","useXDomainEndWithAssemblySyncher","focusGeneChangeHandler","focusRegionChangeHandler","r","CssBaseline","withEither","ifEitherFn","EitherComponent","createMuiTheme","secondary","App","setChromInfo","ChromosomeInfo","_chromInfo","catch","Main","AppError","ThemeProvider","hostname","createAnnotationOverlayMetaTrack","HGC","pubSub","services","AnnotationOverlayMetaTrack","definition","getTrackObject","animate","onNewTilesLoaded","annotationTrackIds","tilesDrawnEndHandlerBound","tilesDrawnEndHandler","bind","drawnAnnotations","Map","tracksDrawingTiles","pubSubs","annotationsDrawnHandlerBound","annotations","xStartAbs","xEndAbs","updateOverlays","from","draw","clear","availableOptions","defaultOptions","FLOAT_BYTES","BYTES_PER_ELEMENT","VS","FS","COLORMAP_GRAYS","getMax","fetchedTiles","maxValue","tileData","maxNonZero","getNumRows","coarseShape","getRowMaxs","maxVector","maxValueByRow","scaleGraphics","xScale","drawnAtScale","tileK","posOffset","getNumPointsPerRow","numRows","positions","createRidgePlotTrack","libraries","format","d3Format","d3Scale","tileProxy","RidgePlotTrack","updateOptions","pLoading","Graphics","pMasked","addChild","loadIndicator","Text","labelSize","coarsifyTileValues","bins_per_dimension","tilePos","binsPerTileIn","binsPerTile","resolutions","chosenResolution","tileHeight","tileX","tileY","xTilePos","yTilePos","minX","minY","reverseYAxis","selectRowsAggregationMode","selectRowsAggregationFn","maxNan","minNan","sumNan","meanNan","markAreaColor","utils","colorToHex","markColorRgbNorm","colorToRgba","markColorTex","markColorTexRes","markNumColors","oldMarkResolution","TILE_SIZE","oldRowHeight","oldRowPadding","oldRowNormalization","oldRowSelections","oldShowRowLabels","updateTiles","updateRowLabels","drawLabel","updateScales","rowLabelAlign","pAxis","removeChildAt","rowLabels","rowLabel","row_infos","rowIndex","removeRowLabels","indicator","Sprite","WHITE","tint","dimensions","yStart","xLabelOffset","getRowHeight","rowStepHeight","rowStepYCenter","updateExistingGraphics","getTilePosAndDimensions","shape","binSizePx","binSizeBp","binSizeBpHalf","binXPos","valuesByRow","meanValue","dense","subarray","rowIdx","actualTrackHeight","getTrackHeight","globalMax","colorIndexScale","rowMaxs","rowValueScales","rowColorIndexScales","valueScaleByRow","colorIndexScaleByRow","rowScale","maxRows","positionsByRow","colorIndicesByRow","offsetSignsByRow","_xScale","size2d","size1d","unshift","numPointsPerRow","verticesPerLine","verticesPerPoint","indices","Uint32Array","k","p1a","p1b","p1c","p1d","p2a","p2b","p2c","p2d","indexOffset","visibleTrackHeight","tilesToData","colorIndices","offsetSigns","toLineIndices","uniforms","UniformGroup","uLineColor","uNaNColor","uAreaColorTex","uAreaColorTexRes","uWidth","uMiter","shader","Shader","geometry","Geometry","numVerticesPoint","addAttribute","TYPES","FLOAT","addIndex","mesh","Mesh","newGraphics","pMain","lineGraphics","updateLoadIndicator","hasFetchedTiles","renderLines","fetching","newPosition","newXScale","newYScale","refreshTiles","trackX","trackY","calculateZoomLevel","calculateTileWidth","invert","posInTileX","rowSelection","tileToLocalId","fetchedTile","colIndex","selectRowsAggregationMethod","rowI","rowInfo","getVisibleData","svgns","base","setAttribute","output","stride","createLine","line","posPerRow","posToPoints","arr","numColors","defs","createElementNS","linearGradient","stop","insertBefore","firstChild","l","y0","firstComma","firstX","firstY","lastComma","lastX","lastY","HorizontalLine1DPixiTrack","datatype","orientation","pointToPosition","pt","cX","widthHalf","pointToIndex","pointToOpacity","pointToHighlight","highlight","getItemDistance","getMaxDistance","maxDistItem","scaleScalableGraphics","getRegionId","createStratifiedBedTrack","MAX_CLICK_DELAY","configs","opacityLogScale","StratifiedBedTrack","pLegend","legendMin","legendMax","interactive","interactiveChildren","alpha","mousedownTime","performance","now","mousedown","mouseup","clickHandler","intervalTree","regionId","isLeftToRight","categoryToGroup","groupToColor","numGroups","numCategories","groupLabels","getCategory","categoryToY","yToCategory","groupSizes","valueFilter","filteredGroups","groupSize","groupLabelsPixiText","markColorHighlightRgbNorm","markColorDehighlightRgbNorm","filterSet","include","filterField","itemFilter","getImportance","opacityScale","opacityLinearScale","getRegion","getGene","minImportance","updateStratificationOption","heightScale","categoryHeightScale","valueScaleInverted","isHighlighting","__focus","__item","focusFilterFn","addFn","filteredItems","reducerVar","accumulator","itemToIndicatorCategory","i1","isItemInFocus","dataToPoint","itemToIndicatorReducer","points","getPoints","Uint16Array","opacities","highlights","uColor","uColorHighlight","uHighlighting","indicatorPointGraphics","yEnd","xTickOffset","xTickEnd","numAxisLabels","lineStyle","labelPixiText","beginFill","drawRect","endFill","legendMinText","legendMaxText","minValue","minTextWidth","getBounds","maxTextWidth","offset","rectHeight","drawRoundedRect","renderIndicatorCategoryAxis","renderIndicatorLegend","renderIndicatorPoints","updateIndicators","relX","relY","foundItem","xAbsLo","xAbsHi","getElementAtPosition","colorHex","toString","bgHex","offsetX","offsetY","global","gAxis","createRect","f","o","strokeDasharray","x1","y1","x2","y2","createDashedLine","pixiText","t","_style","_fill","_align","_font","textContent","createText","colorHighlight","renderIndicatorCategoryAxisAsSvg","thumbnail","DOMParser","parseFromString","documentElement","flip1D","trackBorderWidth","trackBorderColor","optionsInfo","inlineOptions","circle","ellipse","createSnpTrack","d3Array","SnpTrack","colorEncodingRange","minVisibleValueInTiles","maxVisibleValueInTiles","makeValueScale","calculateMedianVisibleValue","xStartPos","xEndPos","rectY","doubleRadius","drawnPoly","anchorRadius","rectGraphics","drawCircle","finalDotYPos","rows","startY","endY","initialize","circleDraws","circleFocusDraws","td","geneInfo","yMiddle","drawnRects","circleDraw","drawPoly","buttonMode","hoveringSnp","relTilePos","dist","itemY","MAX_RADIUS","otherStr","substr","visibleAndFetchedTiles","plusStrandRows","renderRows","focusedCircles","c","axis","axisPositionVertical","gDrawnAxis","exportAxisLeftSVG","exportAxisRightSVG","BedLikeTrack","getHistMax","histMax","histogramMax","segmentToPosition","segment","segmentToColorIdx","colorIdx","segmentToFocused","createStackedBarTrack","toRgbNorm","StackedBarTrack","updateTileFocusMap","numBins","histogram1d","histogram2d","histogram2dNumPred","Uint8Array","categoryBinHash","maxBinId","binStart","getStart","binEnd","getEnd","bin","histIdx","binHash","updateTileHistogram","focusMap","numFilteredGroups","colorMap","colorMapRgbNorm","colorMapTex","colorMapTexRes","colorMapFocus","colorMapFocusRgbNorm","colorMapFocusTex","colorMapFocusTexRes","markColorFocusRgbNorm","markSizeFocus","getOffset","chromOffsets","updateFocusMap","updateHistograms","chroms","chromSizes","offsets","cumSum","brgs","computeChromOffets","oldNumBins","segments","cumHeight","histToSegments","colorIdxs","uColorMapTex","uColorMapTexRes","uColorMapFocus","uColorMapFocusTexRes","State","DRAW_MODES","TRIANGLES","drawAxis","renderStackedBars","renderTrack","relPos","rowCumSum","rowNumPred","totalPred","numPred","relYPos","findIndex","createTssTrack","TssTrack","createPubSub","collectAnnotationsBound","collectAnnotations","minusStrandRows","sortedIdxs","sortedValues","xStartScreen","xEndScreen","isFocused","sortedIndex","splice","allAnnotations","tileAnnotations","concat","LocalCsvDataFetcher","createRandomId","random","LocalBedDataFetcherClass","dataConfig","callback","tilesetInfoLoading","tilesetInfoData","resolve","reject","timeoutId","loadHandler","register","dataFetcher","createLocalBedDataFetcher","pluginType","isMetaTrack","ReactDOM","render","getElementById","serviceWorker","ready","registration","unregister","error","message"],"mappings":"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A,uBACA,iFACA,sBACA,kCACA,wBAGJ,CACEvO,MAAO,UACPuO,WAAY,CACV,oBACA,gBACA,uCACA,gBACA,iBACA,kBACA,eACA,+BACA,0CAGJ,CACEvO,MAAO,UACPuO,WAAY,CACV,mCACA,kBACA,8BACA,oCACA,4CACA,uBACA,wCACA,kBAGJ,CACEvO,MAAO,6BACPuO,WAAY,CACV,gBACA,eACA,6CACA,0BACA,kCACA,gDACA,iCACA,kBAGJ,CACEvO,MAAO,cACPuO,WAAY,CACV,8BACA,+BACA,2BACA,mBACA,+BAGJ,CACEvO,MAAO,aACPuO,WAAY,CACV,gCACA,qCACA,gBACA,eACA,6BACA,KACA,uBACA,gBACA,mBACA,kCACA,kBACA,OACA,4DACA,cACA,kBACA,uBACA,OACA,aACA,iCACA,gCACA,eACA,uBACA,qCACA,0BACA,qDACA,gBACA,0BACA,wBACA,aACA,0BACA,qDACA,2BACA,uCACA,QACA,4CACA,gBACA,uBACA,mCACA,kCACA,gDACA,iBACA,kCAGJ,CACEvO,MAAO,QACPuO,WAAY,CACV,wBACA,kBACA,oBACA,yBACA,2BACA,yBACA,gBACA,8BACA,gCACA,yBACA,mBACA,eACA,cACA,yBACA,6BACA,oBACA,wDACA,6CACA,QACA,2DACA,uBACA,iEACA,sEAMKC,GAAyBN,GAAuBI,OAAOvM,KAClE,SAACjE,GAAD,MAAY,CACVF,KAAME,EAAMkC,MACZkC,QAASpE,EAAMyQ,eAINE,GAAkBD,GAAuBpF,QACpD,SAACsF,EAAe5Q,GAId,OAHAA,EAAMoE,QAAQiD,SAAQ,SAAChD,GACrBuM,EAAcvM,GAAUrE,EAAMF,QAEzB8Q,IAET,IAGWC,GAAUH,GAAuBI,SAAQ,SAAC9Q,GAAD,OAAWA,EAAMoE,WAE1D2M,GAAaF,GAAQvF,QAAO,SAAC0F,EAAMC,EAAQxF,GAEtD,OADAuF,EAAKC,GAAUxF,EACRuF,IACN,IAOUE,GAA+B,CAC1CC,GAAI,2BACJC,GAAI,6BAGOC,GAA+BC,OAAOC,QACjDL,IACA5F,QAAO,SAACrH,EAAD,GAA0B,IAAD,mB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QACNC,YAAa,IACbhC,YAAa,EACbiC,QAAS,QACTC,eAAgB,GAChBC,aAAc,EACdC,WAAY,CAAC,WAInBC,WAAY,CACV,CACE/I,IAAK,oBACL5H,KAAM,qBACN4Q,cAAe,eACf/S,QAAS,CACPgT,iBAAkB,CAAC,UAIzBC,OAAQ,CACNC,EAAG,GACHC,EAAG,GACH1I,EAAG,EACHjH,EAAG,GAEL4P,eAAgB,CAnbgB,WACF,YAmb9BC,eAAgB,CApbgB,WACF,eAwbvBC,GAA0C,CACrD,IACA,GACA,GACA,GACA,GACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,EACA,GACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,IACA,IACA,GACA,GACA,GACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,IACA,IACA,GACA,IACA,GACA,IACA,GACA,IACA,GACA,EACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,IACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,EACA,IACA,GACA,GACA,GACA,GACA,EACA,IACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,EACA,GACA,IACA,GACA,GACA,IACA,GACA,GACA,GACA,IACA,GACA,GACA,IACA,EACA,IACA,IACA,GACA,EACA,GACA,GACA,IACA,GACA,IACA,GACA,EACA,IACA,GACA,IACA,GACA,EACA,IACA,GACA,IACA,GACA,EACA,GACA,GACA,GACA,GACA,IAGWC,GAA2CvH,GAAuBI,OAAOlF,QACpF,SAACsM,EAAK5X,EAAOgP,GACX,IAAM6I,EAAW,CACf3V,MAAOlC,EAAMkC,MACb1F,MAAOwD,EAAM8X,eACbhZ,WAAYkB,EAAM+X,oBAClB/I,SAKF,OAHAhP,EAAMyQ,WAAWpJ,SAAQ,SAAC4J,GACxB2G,EAAI3G,GAAU4G,KAETD,IAET,IAGWI,GAAwC,CACnDC,WAAW,EACXxE,UAAU,EACVC,mBA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","file":"static/js/main.057de69f.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/enhancer-view-2.5240166b.png\";","module.exports = __webpack_public_path__ + \"static/media/enhancer-view-3.bf2e34ef.png\";","module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/enhancer-view-5.cf1c5548.png\";","module.exports = __webpack_public_path__ + \"static/media/gene-view-1.0cd2047f.png\";","module.exports = __webpack_public_path__ + \"static/media/gene-view-2.a8614234.png\";","import React from 'react';\nimport Backdrop from '@material-ui/core/Backdrop';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme) => ({\n  backdrop: {\n    zIndex: theme.zIndex.drawer + 1,\n    color: '#bbb',\n    backgroundColor: '#fff',\n  },\n}));\n\nconst AppInitializing = () => {\n  const classes = useStyles();\n\n  return (\n    <div className=\"full-wh\">\n      <Backdrop className={classes.backdrop} open={true}>\n        <CircularProgress color=\"inherit\" />\n      </Backdrop>\n    </div>\n  );\n};\n\nexport default AppInitializing;\n","import React from 'react';\nimport './AppError.css';\n\nconst AppInitializing = () => (\n  <div className=\"full-wh app-error\">\n    <span>Failed to initialize!</span>\n  </div>\n);\n\nexport default AppInitializing;\n","import React, { createContext } from 'react';\n\nconst ChromInfoContext = createContext();\n\nexport default function ChromInfoProvider({ children, chromInfo }) {\n  return (\n    <ChromInfoContext.Provider value={chromInfo}>\n      {children}\n    </ChromInfoContext.Provider>\n  );\n}\n\nfunction useChromInfo() {\n  const context = React.useContext(ChromInfoContext);\n  if (context === undefined) {\n    throw new Error('useChromInfo must be used within a ChromInfoContext');\n  }\n  return context;\n}\n\nexport { useChromInfo };\n","import { useState, useEffect } from 'react';\n\nexport default function useDebounce(value, delay) {\n  const [debouncedValue, setDebouncedValue] = useState(value);\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n\n  return debouncedValue;\n}\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useRecoilState, useRecoilValue } from 'recoil';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport CheckBoxIcon from '@material-ui/icons/CheckBox';\nimport CheckBoxOutlineBlankIcon from '@material-ui/icons/CheckBoxOutlineBlank';\nimport IndeterminateCheckBoxIcon from '@material-ui/icons/IndeterminateCheckBox';\nimport FilterListIcon from '@material-ui/icons/FilterList';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport Grid from '@material-ui/core/Grid';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport useDebounce from './use-debounce';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    position: 'relative',\n  },\n  filterBar: {\n    position: 'sticky',\n    zIndex: 1,\n    top: '8px',\n    '&:before': {\n      content: '\"\"',\n      position: 'absolute',\n      zIndex: 0,\n      top: '-9px',\n      right: '-8px',\n      left: '-8px',\n      bottom: 0,\n      background: 'white',\n    },\n  },\n  checkbox: {\n    marginTop: -6,\n    marginBottom: -6,\n  },\n  checkboxLabel: {\n    fontSize: '0.8rem',\n    marginLeft: -6,\n  },\n  nestedCheckbox: {\n    marginLeft: 4,\n  },\n  visible: {\n    transition: '.3s ease transform, .3s ease height',\n    transform: 'scale(1, 1)',\n    height: '1.625rem',\n  },\n  invisible: {\n    transition: '.3s ease transform, .3s ease height',\n    transform: 'scale(1, 0)',\n    height: '0rem',\n  },\n}));\n\nconst Option = React.memo(function Option({\n  filterState,\n  name,\n  stateWithName,\n  group,\n  stateWithGroup,\n  colorCheckbox,\n  colorText,\n}) {\n  const filter = useRecoilValue(filterState);\n  const [state, setState] = useRecoilState(stateWithName(name));\n  const [groupState, setGroupState] = useRecoilState(stateWithGroup(group));\n  const nameLowerCase = useMemo(() => name.toLowerCase(), [name]);\n\n  const changeHandler = useCallback(\n    (event) => {\n      setState((currState) => ({\n        ...currState,\n        checked: event.target.checked,\n      }));\n      setGroupState((currGroupState) => {\n        const newGroupState = {\n          ...currGroupState,\n          n: currGroupState.n + (event.target.checked ? 1 : -1),\n        };\n        switch (newGroupState.n) {\n          case currGroupState.N:\n            newGroupState.checked = true;\n            break;\n          case 0:\n            newGroupState.checked = false;\n            break;\n          default:\n            newGroupState.checked = undefined;\n            break;\n        }\n        return newGroupState;\n      });\n    },\n    [setState, setGroupState]\n  );\n\n  useEffect(() => {\n    if (groupState.checked === true) {\n      setState((currState) => ({\n        ...currState,\n        checked: true,\n      }));\n    } else if (groupState.checked === false) {\n      setState((currState) => ({\n        ...currState,\n        checked: false,\n      }));\n    }\n  }, [groupState, setState]);\n\n  useEffect(() => {\n    setState((currState) => ({\n      ...currState,\n      visible: !filter.length || nameLowerCase.includes(filter),\n    }));\n  }, [filter, nameLowerCase, setState]);\n\n  const classes = useStyles();\n\n  return (\n    <div className={state.visible ? classes.visible : classes.invisible}>\n      <FormControlLabel\n        key={name}\n        className={`${classes.checkbox} ${classes.nestedCheckbox}`}\n        control={\n          <Checkbox\n            style={{\n              color: colorCheckbox,\n            }}\n            icon={<CheckBoxOutlineBlankIcon fontSize=\"small\" />}\n            checkedIcon={<CheckBoxIcon fontSize=\"small\" />}\n            checked={state.checked}\n            onChange={changeHandler}\n            name={name}\n          />\n        }\n        label={\n          <Typography\n            className={classes.checkboxLabel}\n            noWrap\n            style={{\n              color: colorText,\n            }}\n          >\n            {name}\n          </Typography>\n        }\n      />\n    </div>\n  );\n});\n\nconst OptionGroup = React.memo(function OptionGroup({\n  group,\n  stateWithGroup,\n  colorCheckbox,\n  colorText,\n}) {\n  const [state, setState] = useRecoilState(stateWithGroup(group));\n\n  const changeHandler = useCallback(\n    (event) => {\n      setState((currState) => ({\n        ...currState,\n        checked: event.target.checked,\n        n: event.target.checked ? currState.N : 0,\n      }));\n    },\n    [setState]\n  );\n\n  const classes = useStyles();\n\n  return (\n    <FormControlLabel\n      className={classes.checkbox}\n      control={\n        <Checkbox\n          style={{ color: colorCheckbox }}\n          icon={\n            state.checked === false ? (\n              <CheckBoxOutlineBlankIcon fontSize=\"small\" />\n            ) : (\n              <IndeterminateCheckBoxIcon fontSize=\"small\" />\n            )\n          }\n          checkedIcon={<CheckBoxIcon fontSize=\"small\" />}\n          checked={state.checked === true}\n          onChange={changeHandler}\n          name={group.name}\n        />\n      }\n      label={\n        <Typography\n          className={classes.checkboxLabel}\n          noWrap\n          style={{ color: colorText }}\n        >\n          <strong>{group.name}</strong>{' '}\n          <span>\n            ({state.n}/{state.N})\n          </span>\n        </Typography>\n      }\n    />\n  );\n});\n\nconst NestedCheckboxList = React.memo(function NestedCheckboxList({\n  filterState,\n  optionWithName,\n  optionGroupWithGroup,\n  filterLabel = 'Filter',\n  groupedOptions = [],\n  optionToGroup = {},\n  groupColors = [],\n  groupColorsDark = [],\n}) {\n  const [globalFilter, setGlobalFilter] = useRecoilState(filterState);\n  const [filter, setFilter] = useState(globalFilter);\n  const filterDb = useDebounce(filter, 350);\n\n  const filterChangeHandler = useCallback(\n    (event) => {\n      setFilter(event.target.value.toLowerCase());\n    },\n    [setFilter]\n  );\n\n  useEffect(() => {\n    setGlobalFilter(filterDb);\n  }, [filterDb, setGlobalFilter]);\n\n  const classes = useStyles();\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.filterBarBg} />\n      <FormControl\n        className={classes.filterBar}\n        variant=\"outlined\"\n        margin=\"dense\"\n        fullWidth\n      >\n        <InputLabel htmlFor=\"filter\">\n          <Grid container direction=\"row\" alignItems=\"center\">\n            <FilterListIcon fontSize=\"small\" />\n            <span style={{ marginLeft: 3 }}>{filterLabel}</span>\n          </Grid>\n        </InputLabel>\n        <OutlinedInput\n          id=\"filter\"\n          label={\n            <Grid container direction=\"row\" alignItems=\"center\">\n              <FilterListIcon fontSize=\"small\" />\n              <span style={{ marginLeft: 3 }}>{filterLabel}</span>\n            </Grid>\n          }\n          onChange={filterChangeHandler}\n          value={filter}\n        />\n      </FormControl>\n      <FormGroup>\n        {groupedOptions.map((group, i) => (\n          <React.Fragment key={group.name}>\n            <OptionGroup\n              key={group.name}\n              group={group}\n              stateWithGroup={optionGroupWithGroup}\n              colorCheckbox={groupColors[i % groupColors.length] || 'inherit'}\n              colorText={\n                groupColorsDark[i % groupColorsDark.length] || 'inherit'\n              }\n            />\n            {group.options.map((option) => (\n              <Option\n                filterState={filterState}\n                key={option}\n                name={option}\n                stateWithName={optionWithName}\n                group={group}\n                stateWithGroup={optionGroupWithGroup}\n                colorCheckbox={groupColors[i % groupColors.length] || 'inherit'}\n                colorText={\n                  groupColorsDark[i % groupColorsDark.length] || 'inherit'\n                }\n              />\n            ))}\n          </React.Fragment>\n        ))}\n      </FormGroup>\n    </div>\n  );\n});\n\nexport default NestedCheckboxList;\n","import PropTypes from 'prop-types';\nimport React from 'react';\n\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme) => ({\n  logo: {\n    height: '100%',\n    padding: '0.1em',\n    alignItems: 'center',\n    fontSize: '1em',\n    lineHeight: '1em',\n    fontWeight: 'bold',\n  },\n  logoAbc: {\n    fontSize: '2.75em',\n    letterSpacing: '-0.075rem',\n    paddingRight: '0.125em',\n    fontWeight: 900,\n  },\n  logoEnhancer: {\n    alignItems: 'flex-start',\n  },\n}));\n\nconst Logo = (props) => {\n  const classes = useStyles();\n\n  return (\n    <Grid container className={classes.logo} style={props.styles}>\n      <Grid item className={classes.logoAbc}>\n        ABC\n      </Grid>\n      <Grid item>\n        <Grid container direction=\"column\" className={classes.logoEnhancer}>\n          <Grid item>Enhancer-Gene</Grid>\n          <Grid item>Connections</Grid>\n        </Grid>\n      </Grid>\n    </Grid>\n  );\n};\n\nLogo.defaultProps = {\n  styles: {},\n};\n\nLogo.propTypes = {\n  styles: PropTypes.object,\n};\n\nexport default Logo;\n","import React, { useCallback, useState } from 'react';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport ClearIcon from '@material-ui/icons/Clear';\nimport InsertDriveFileIcon from '@material-ui/icons/InsertDriveFile';\n\nconst FileInput = React.memo(\n  React.forwardRef(function FileInput(props, ref) {\n    const {\n      onChange: changeHandler,\n      onClear: clearHandler,\n      className = '',\n      label = 'Select',\n      accept = '*',\n      color = 'default',\n      Icon = InsertDriveFileIcon,\n    } = props;\n\n    // We will spread any other props onto the root component. However, some\n    // props can mess things up so we will remove them in the following lines\n    const otherProps = { ...props };\n    delete otherProps.onChange;\n    delete otherProps.onClear;\n    delete otherProps.className;\n    delete otherProps.file;\n    delete otherProps.label;\n    delete otherProps.accept;\n    delete otherProps.color;\n    delete otherProps.Icon;\n\n    const [file, setFile] = useState(props.file || null);\n\n    const localChangeHandler = useCallback(\n      (event) => {\n        const fileList = event.target.files;\n        setFile(fileList[0]);\n        if (changeHandler) changeHandler(fileList[0], event);\n      },\n      [changeHandler]\n    );\n\n    const clearFile = useCallback(() => {\n      setFile(null);\n      if (clearHandler) clearHandler();\n    }, [clearHandler]);\n\n    return (\n      <ButtonGroup {...otherProps} className=\"r\" ref={ref}>\n        <Button\n          variant={file ? 'outlined' : 'contained'}\n          component=\"label\"\n          className={className}\n          color={color}\n          disableElevation\n          startIcon={<Icon />}\n        >\n          <input\n            accept={accept}\n            type=\"file\"\n            onChange={localChangeHandler}\n            hidden\n          />\n          {file ? file.name : label}\n        </Button>\n        <Button\n          variant=\"contained\"\n          disabled={!file}\n          onClick={clearFile}\n          disableElevation\n        >\n          <ClearIcon fontSize=\"inherit\" />\n        </Button>\n      </ButtonGroup>\n    );\n  })\n);\n\nexport default FileInput;\n","import { identity } from '@flekschas/utils';\nimport queryString from 'query-string';\n\nexport const contains = (a, b) => a[0] <= b[0] && a[1] >= b[1];\n\nexport const createColorTexture = (PIXI, colors) => {\n  const colorTexRes = Math.max(2, Math.ceil(Math.sqrt(colors.length)));\n  const rgba = new Float32Array(colorTexRes ** 2 * 4);\n  colors.forEach((color, i) => {\n    // eslint-disable-next-line prefer-destructuring\n    rgba[i * 4] = color[0]; // r\n    // eslint-disable-next-line prefer-destructuring\n    rgba[i * 4 + 1] = color[1]; // g\n    // eslint-disable-next-line prefer-destructuring\n    rgba[i * 4 + 2] = color[2]; // b\n    // eslint-disable-next-line prefer-destructuring\n    rgba[i * 4 + 3] = color[3]; // a\n  });\n\n  return [PIXI.Texture.fromBuffer(rgba, colorTexRes, colorTexRes), colorTexRes];\n};\n\nexport const dashedXLineTo = (graphics, xStart, xEnd, y, dashSize) => {\n  const diff = xEnd - xStart;\n  const direction = Math.sign(diff);\n  const width = Math.abs(diff);\n  const stepSize = dashSize * 2;\n  const numSteps = Math.ceil(width / stepSize);\n  for (let i = 0; i < numSteps; i++) {\n    graphics.moveTo(xStart + i * stepSize * direction, y);\n    graphics.lineTo(xStart + (i * stepSize + dashSize) * direction, y);\n  }\n};\n\nexport const download = (filename, stringOrBlob) => {\n  const blob =\n    typeof stringOrBlob === 'string'\n      ? new Blob([stringOrBlob], { type: 'application/octet-stream' })\n      : stringOrBlob;\n  if (window.navigator.msSaveOrOpenBlob) {\n    window.navigator.msSaveBlob(blob, filename);\n  } else {\n    const elem = window.document.createElement('a');\n    elem.href = window.URL.createObjectURL(blob);\n    elem.download = filename;\n    document.body.appendChild(elem);\n    elem.click();\n    document.body.removeChild(elem);\n    URL.revokeObjectURL(elem.href);\n  }\n};\n\nexport const getQueryStringValue = (key, decoder = identity) =>\n  decoder(queryString.parse(window.location.search)[key]);\n\nexport const setQueryStringValue = (key, value, encoder = identity) => {\n  const values = queryString.parse(window.location.search);\n  const newQsValue = queryString.stringify(\n    {\n      ...values,\n      [key]: encoder(value),\n    },\n    { strict: false }\n  );\n  const url = `${window.location.origin}${window.location.pathname}?${newQsValue}`;\n  window.history.pushState({ path: url }, '', url);\n};\n\nexport const toAbsPosition = (position, chromInfo) => {\n  let absPosition;\n  if (position.indexOf && position.indexOf(':') >= 0) {\n    const [chrom, pos] = position.split(':');\n    absPosition = chromInfo.chrPositions[chrom].pos + +pos;\n  } else {\n    absPosition = +position;\n  }\n  return absPosition;\n};\n\nexport const toFixed = (number, decimals, forced) => {\n  let string = number.toFixed(decimals);\n  if (!forced) {\n    while (string[string.length - 1] === '0') {\n      string = string.substring(0, string.length - 1);\n    }\n    if (string[string.length - 1] === '.') {\n      string = string.substring(0, string.length - 1);\n    }\n  }\n  return string;\n};\n\nexport const scaleBand = () => {\n  let domain = [];\n  let fixedBandwidth = null;\n  let bandwidth = 1;\n  let range = [0, 1];\n  let rangeSize = range[1] - range[0];\n  let paddingInner = [];\n  // If `true` the padding will begin before the first bar!\n  let paddingInnerZeroBased = false;\n  let totalWidth = 0;\n\n  const sum = (a, b) => a + b;\n  const getBandwidth = () => fixedBandwidth || bandwidth;\n\n  const update = () => {\n    rangeSize = range[1] - range[0];\n\n    const totalPaddingInner = paddingInner.reduce(sum, 0);\n    bandwidth = (rangeSize - totalPaddingInner) / domain.length;\n    totalWidth = totalPaddingInner + domain.length * getBandwidth();\n  };\n\n  const scale = (v) => {\n    const idx = domain.indexOf(v);\n\n    if (idx === -1) return undefined;\n\n    return (\n      idx * getBandwidth() +\n      paddingInner.slice(0, idx + paddingInnerZeroBased).reduce(sum, 0)\n    );\n  };\n\n  scale.domain = (newDomain) => {\n    if (newDomain) {\n      domain = [...newDomain];\n      update();\n      return scale;\n    }\n\n    return domain;\n  };\n\n  scale.range = (newRange) => {\n    if (newRange) {\n      range = [...newRange];\n      update();\n      return scale;\n    }\n\n    return range;\n  };\n\n  scale.bandwidth = () => getBandwidth();\n\n  scale.fixedBandwidth = (newFixedBandwidth) => {\n    if (newFixedBandwidth) {\n      fixedBandwidth = newFixedBandwidth;\n      update();\n      return scale;\n    }\n\n    return newFixedBandwidth;\n  };\n\n  scale.totalWidth = () => totalWidth;\n\n  scale.rangeSize = () => rangeSize;\n\n  scale.paddingInner = (newPaddingInner) => {\n    if (newPaddingInner) {\n      paddingInner = newPaddingInner;\n      update();\n      return scale;\n    }\n\n    return paddingInner;\n  };\n\n  scale.paddingInnerZeroBased = (newPaddingInnerZeroBased) => {\n    if (newPaddingInnerZeroBased) {\n      paddingInnerZeroBased = newPaddingInnerZeroBased;\n      update();\n      return scale;\n    }\n\n    return paddingInnerZeroBased;\n  };\n\n  return scale;\n};\n\nexport const stringifySvg = (svg) =>\n  new window.XMLSerializer().serializeToString(svg);\n\nexport const booleanQueryStringDecoder = (v) =>\n  v === undefined ? undefined : v === 'true';\n\nexport const customBooleanQueryStringDecoder = (excluded = []) => {\n  const s = excluded.reduce((_s, v) => {\n    _s.add(v);\n    return _s;\n  }, new Set());\n  return (v) => {\n    if (v === undefined || s.has(v)) return v;\n    return v === 'true';\n  };\n};\n\nexport const isChrRange = (chrRange) =>\n  chrRange.match(/^chr(\\d+)[:.](\\d+)(([-~+])(\\d+))?(-chr(\\d+)[:.](\\d+))?$/);\n\nexport const getIntervalCenter = (interval) =>\n  interval[0] + (interval[1] - interval[0]) / 2;\n\nexport const chrPosUrlDecoder = (chrPos) =>\n  chrPos ? chrPos.replace('.', ':') : chrPos;\n\nexport const chrPosUrlEncoder = (chrPos) =>\n  chrPos ? chrPos.replace(':', '.') : chrPos;\n\nexport const chrPosAdd = (chrPos, value) => {\n  if (!chrPos) return chrPos;\n\n  const [chrom, pos] = chrPos.split(':');\n\n  return `${chrom}:${+pos + +value}`;\n};\n\nexport const chrRangePosUrlDecoder = (chrRangePos) => {\n  if (!chrRangePos) return chrRangePos;\n\n  let [start, end] = chrRangePos.split('-');\n  let range = null;\n\n  [start, range] = chrPosUrlDecoder(start).split('~');\n\n  if (end) {\n    end = chrPosUrlDecoder(end);\n  } else if (range) {\n    end = chrPosAdd(start, range);\n  } else {\n    end = chrPosAdd(start, 1);\n  }\n\n  return [start, end];\n};\n\nexport const chrRangePosEncoder = (\n  chrRangePos,\n  chrPosEncoder = identity,\n  lengthOperator = '+'\n) => {\n  if (!chrRangePos) return chrRangePos;\n\n  const [startChrom, startPos] = chrRangePos[0].split(':');\n  const [endChrom, endPos] = chrRangePos[1].split(':');\n\n  if (startChrom === endChrom) {\n    const length = Math.abs(+endPos - +startPos);\n\n    if (length < 2) return chrPosEncoder(chrRangePos[0]);\n\n    if (length < 100000)\n      return `${chrPosEncoder(chrRangePos[0])}${lengthOperator}${length}`;\n\n    return `${chrPosEncoder(chrRangePos[0])}-${endPos}`;\n  }\n\n  return chrRangePos.map(chrPosEncoder).join('-');\n};\n\nexport const chrRangePosUrlEncoder = (chrRangePos) =>\n  chrRangePosEncoder(chrRangePos, chrPosUrlEncoder, '~');\n","import { globalPubSub } from 'pub-sub-es';\nimport IntervalTree from '@flatten-js/interval-tree';\n\nimport { toAbsPosition } from './utils';\n\nasync function loadFile(\n  file,\n  chromInfo,\n  { header = true, columnImportance = 7 } = {}\n) {\n  const tree = new IntervalTree();\n  const text = await file.text();\n  const lines = text.split(/\\r\\n|\\n/);\n  for (let i = +header; i < lines.length; i++) {\n    const fields = lines[i].split('\\t');\n    const chromOffset = toAbsPosition(`${fields[0]}:0`, chromInfo);\n    const startAbs = toAbsPosition(`${fields[0]}:${fields[1]}`, chromInfo);\n    const endAbs = toAbsPosition(`${fields[0]}:${fields[2]}`, chromInfo);\n    tree.insert([startAbs, endAbs], {\n      chrOffset: chromOffset,\n      xStart: startAbs,\n      xEnd: endAbs,\n      importance: +fields[columnImportance],\n      uid: `${file.name}-${i}`,\n      name: fields[3],\n      fields,\n    });\n  }\n  return tree;\n}\n\nconst createLocalBedDataServer = (\n  file,\n  id,\n  chromInfo,\n  tilesetInfo,\n  options\n) => {\n  const whenIndex = loadFile(file, chromInfo, options);\n\n  const requestTileHandler = ({ fileId, z, x, requestId }) => {\n    if (fileId !== id) return;\n    whenIndex.then((index) => {\n      const tileWidth = tilesetInfo.max_width / 2 ** z;\n      const start = tileWidth * x;\n      const end = start + tileWidth;\n      const results = index.search([start, end]);\n      globalPubSub.publish(`localBed:tile:${requestId}`, results);\n    });\n  };\n\n  const requestTilesetInfoHandler = ({ fileId, requestId }) => {\n    if (fileId !== id) return;\n    globalPubSub.publish(`localBed:tilesetInfo:${requestId}`, tilesetInfo);\n  };\n\n  const subscriptionTile = globalPubSub.subscribe(\n    'localBed:requestTile',\n    requestTileHandler\n  );\n\n  const subscriptionTilesetInfo = globalPubSub.subscribe(\n    'localBed:requestTilesetInfo',\n    requestTilesetInfoHandler\n  );\n\n  const destroy = () => {\n    globalPubSub.unsubscribe(subscriptionTile);\n    globalPubSub.unsubscribe(subscriptionTilesetInfo);\n  };\n\n  return {\n    destroy,\n  };\n};\n\nexport default createLocalBedDataServer;\n","import { useCallback, useMemo, useState } from 'react';\nimport { useRecoilState, useRecoilValue } from 'recoil';\n\nimport { getQueryStringValue, setQueryStringValue } from './utils';\n\nexport default function useQueryStringWithReactState(\n  key,\n  initialValue,\n  { encoder, decoder } = {}\n) {\n  const _initialValue =\n    getQueryStringValue(key, decoder) === undefined\n      ? initialValue\n      : getQueryStringValue(key, decoder);\n\n  const [value, setValue] = useState(_initialValue);\n\n  const onSetValue = useCallback(\n    (newValue) => {\n      setValue(newValue);\n      setQueryStringValue(key, newValue, encoder);\n    },\n    [key, encoder]\n  );\n\n  // Set initial value\n  setQueryStringValue(key, value, encoder);\n\n  return [value, onSetValue];\n}\n\nexport function useRecoilQueryString(key, atom, encoder) {\n  const [value, setValue] = useRecoilState(atom);\n\n  const onSetValue = useCallback(\n    (newValue) => {\n      setValue(newValue);\n      setQueryStringValue(key, newValue, encoder);\n    },\n    [key, encoder, setValue]\n  );\n\n  return [value, onSetValue];\n}\n\nexport function useRecoilQueryStringSyncher(key, atom, encoder) {\n  const value = useRecoilValue(atom);\n\n  useMemo(() => {\n    setQueryStringValue(key, value, encoder);\n  }, [key, encoder, value]);\n}\n","export const DRAWER_WIDTH = 240;\n\nexport const EPS = 1e-6;\n\nexport const SVG_SKELETON = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg\n    xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n    xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"_WIDTH_px\" height=\"_HEIGHT_px\">\n    <g id=\"enhancer-plot\">\n    _ENHANCER_\n    </g>\n    <g id=\"enhancer-gene-plot\" transform=\"translate(0, _ENHANCER_GENE_Y_)\">\n    _ENHANCER_GENE_\n    </g>\n    <g id=\"dna-accessibility-plot\" transform=\"translate(_DNA_ACCESS_X_, 0)\">\n    _DNA_ACCESS_\n    </g>\n</svg>`;\n\nexport const DEFAULT_COLOR_MAP = [\n  // '#c17da5', // pink\n  '#c76526', // red\n  '#6fb2e4', // light blue\n  '#eee462', // yellow\n  '#469b76', // green\n  '#3170ad', // dark blue\n  '#dca237', // orange\n  '#000000', // black\n  '#999999', // gray\n];\n\nexport const DEFAULT_COLOR_MAP_DARK = [\n  // '#a1688a', // pink\n  '#a65420', // red\n  '#4a7798', // light blue\n  '#999026', // yellow\n  '#3a8162', // green\n  '#295d90', // dark blue\n  '#b7872e', // orange\n  '#000000', // black\n  '#666666', // gray\n];\n\nexport const DEFAULT_COLOR_MAP_LIGHT = [\n  // '#f5e9f0', // pink\n  '#f6e5db', // red\n  '#e7f2fb', // light blue\n  '#f2eda9', // yellow\n  '#e0eee8', // green\n  '#dde7f1', // dark blue\n  '#f5e4c4', // orange\n  '#d5d5d5', // black\n  '#ffffff', // gray\n];\n\nexport const GENE_SEARCH_URL =\n  'https://higlass.io/api/v1/suggest/?d=OHJakQICQD6gTD7skx4EWA';\n\nexport const VARIANT_SEARCH_URL =\n  'https://resgen.io/api/v1/suggest/?d=VF5-RDXWTxidGMJU7FeaxA';\n\n// const EG_TILE_UID = 'GOxTKzoLSsuw0BaG6eBrXw'; // V2\nconst EG_TILE_UID = 'e3lpYv5LSIiik7CFtuAMTw'; // V3\n\nconst EG_TILE_V3 = EG_TILE_UID === 'e3lpYv5LSIiik7CFtuAMTw';\n\nexport const BIOSAMPLE_COLUMN = EG_TILE_V3 ? 6 : 10;\nexport const GENE_NAME_COLUMN = EG_TILE_V3 ? 3 : 6;\nexport const ABC_SCORE_COLUMN = EG_TILE_V3 ? 5 : 7;\nexport const ENHANCER_START_COLUMN = 1; // V2 & V3\nexport const TSS_CHROM_COLUMN = EG_TILE_V3 ? 0 : 3;\nexport const TSS_START_COLUMN = 4; // V2 & V3\nexport const TSS_END_COLUMN = EG_TILE_V3 ? 4 : 5;\n\nexport const DEFAULT_STRATIFICATION = {\n  categoryField: BIOSAMPLE_COLUMN,\n  axisShowGroupSeparator: true,\n  axisNoGroupColor: false,\n  groups: [\n    {\n      label: 'Mononuclear Phagocytes',\n      categories: [\n        'THP1_LPS_4hr-Engreitz',\n        'THP_pmaLPS_ATAC_6h',\n        'CD14-positive_monocyte_treated_with_LPS_4h-Novakovic2016',\n        'CD14-positive_monocyte_treated_with_BG_1h-Novakovic2016',\n        'CD14-positive_monocyte_treated_with_RPMI_d6-Novakovic2016',\n        'THP1-Engreitz',\n        'THP_pmaLPS_ATAC_96h',\n        'CD14-positive_monocyte_treated_with_BG_d1-Novakovic2016',\n        'THP_pmaLPS_ATAC_72h',\n        'THP-1_monocyte-VanBortle2017',\n        'CD14-positive_monocyte_treated_with_LPS_d1-Novakovic2016',\n        'CD14-positive_monocyte-ENCODE',\n        'THP_pmaLPS_ATAC_2h',\n        'dendritic_cell_treated_with_Lipopolysaccharide_0_ng-mL_for_0_hour-Garber2017',\n        'CD14-positive_monocyte_treated_with_RPMI_1h-Novakovic2016',\n        'U937_LPS_4hr-Engreitz',\n        'CD14-positive_monocyte-Novakovic2016',\n        'dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_6_hour-Garber2017',\n        'CD14-positive_monocyte_treated_with_BG_4h-Novakovic2016',\n        'THP_pmaLPS_ATAC_0h',\n        'HAP1',\n        'THP-1_macrophage-VanBortle2017',\n        'dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_1_hour-Garber2017',\n        'U937-Engreitz',\n        'CD14-positive_monocyte_treated_with_RPMI_d1-Novakovic2016',\n        'CD14-positive_monocyte_treated_with_RPMI_4h-Novakovic2016',\n        'CD14-positive_monocyte_treated_with_LPS_d6-Novakovic2016',\n        'CD14-positive_monocyte_treated_with_LPS_1h-Novakovic2016',\n        'THP_pmaLPS_ATAC_24h',\n        'THP_pmaLPS_ATAC_1h',\n        'dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_2_hour-Garber2017',\n        'CD14-positive_monocyte_treated_with_BG_d6-Novakovic2016',\n        'dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_30_minute-Garber2017',\n        'THP_pmaLPS_ATAC_120h',\n        'dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_4_hour-Garber2017',\n        'THP_pmaLPS_ATAC_48h',\n        'CD14-positive_monocytes-Roadmap',\n        'THP_pmaLPS_ATAC_12h', // monoctye\n      ],\n    },\n    {\n      label: 'B Cells',\n      categories: [\n        'Karpas-422-ENCODE', // b-cell cell line\n        'BJAB-Engreitz',\n        'BJAB_anti-IgM_anti-CD40_4hr-Engreitz',\n        'B_cell-ENCODE',\n        'OCI-LY7-ENCODE',\n        'GM12878-Roadmap',\n        'MM.1S-ENCODE',\n        'CD19-positive_B_cell-Roadmap',\n        'CD8-positive_alpha-beta_T_cell-ENCODE',\n      ],\n    },\n    {\n      label: 'T Cells',\n      categories: [\n        'Jurkat_anti-CD3_PMA_4hr-Engreitz', // t-cell\n        'Jurkat-Engreitz',\n        'CD3-positive_T_cell-Roadmap',\n        'CD4-positive_helper_T_cell-ENCODE',\n        'CD8-positive_alpha-beta_T_cell-Corces2016',\n        'thymus_fetal-Roadmap',\n        'CD4-positive_helper_T_cell-Corces2016',\n        'T-cell-ENCODE',\n      ],\n    },\n    {\n      label: 'Other haematopoietic cells',\n      categories: [\n        'spleen-ENCODE',\n        'K562-Roadmap',\n        'CD56-positive_natural_killer_cells-Roadmap',\n        'erythroblast-Corces2016',\n        'CD34-positive_mobilized-Roadmap',\n        'megakaryocyte-erythroid_progenitor-Corces2016',\n        'natural_killer_cell-Corces2016',\n        'IMR90-Roadmap',\n      ],\n    },\n    {\n      label: 'Fibroblasts',\n      categories: [\n        'foreskin_fibroblast-Roadmap',\n        'fibroblast_of_dermis-Roadmap',\n        'fibroblast_of_arm-ENCODE',\n        'astrocyte-ENCODE',\n        'fibroblast_of_lung-Roadmap',\n      ],\n    },\n    {\n      label: 'Epithelial',\n      categories: [\n        'small_intestine_fetal-Roadmap',\n        'epithelial_cell_of_prostate-ENCODE',\n        'HCT116-ENCODE',\n        'MCF-7-ENCODE',\n        'adrenal_gland_fetal-ENCODE',\n        'H7',\n        'keratinocyte-Roadmap',\n        'MCF10A-Ji2017',\n        'pancreas-Roadmap',\n        'mammary_epithelial_cell-Roadmap',\n        'stomach-Roadmap',\n        'LoVo',\n        'A549_treated_with_ethanol_0.02_percent_for_1_hour-Roadmap',\n        'PC-9-ENCODE',\n        'H1-hESC-Roadmap',\n        'thyroid_gland-ENCODE',\n        'HT29',\n        'MDA-MB-231',\n        'iPS_DF_19.11_Cell_Line-Roadmap',\n        'large_intestine_fetal-Roadmap',\n        'Panc1-ENCODE',\n        'adrenal_gland-ENCODE',\n        'MCF10A_treated_with_TAM24hr-Ji2017',\n        'trophoblast_cell-ENCODE',\n        'H1_BMP4_Derived_Trophoblast_Cultured_Cells-Roadmap',\n        'uterus-ENCODE',\n        'body_of_pancreas-ENCODE',\n        'stomach_fetal-Roadmap',\n        'H9-Roadmap',\n        'transverse_colon-ENCODE',\n        'H1_BMP4_Derived_Mesendoderm_Cultured_Cells-Roadmap',\n        'breast_epithelium-ENCODE',\n        'induced_pluripotent_stem_cell-ENCODE',\n        'LNCAP',\n        'H1_Derived_Mesenchymal_Stem_Cells-Roadmap',\n        'ovary-Roadmap',\n        'sigmoid_colon-ENCODE',\n        'skeletal_muscle_myoblast-Roadmap',\n        'bipolar_neuron_from_iPSC-ENCODE',\n        'coronary_artery_smooth_muscle_cell-Miller2016',\n        'SK-N-SH-ENCODE',\n        'muscle_of_trunk_fetal-Roadmap',\n      ],\n    },\n    {\n      label: 'Other',\n      categories: [\n        'adipose_tissue-ENCODE',\n        'HeLa-S3-Roadmap',\n        'hepatocyte-ENCODE',\n        'heart_ventricle-ENCODE',\n        'spinal_cord_fetal-ENCODE',\n        'coronary_artery-ENCODE',\n        'HepG2-Roadmap',\n        'muscle_of_leg_fetal-Roadmap',\n        'gastrocnemius_medialis-ENCODE',\n        'brite_adipose-Loft2014',\n        'placenta-Roadmap',\n        'liver-ENCODE',\n        'A673-ENCODE',\n        'white_adipose-Loft2014',\n        'cardiac_muscle_cell-ENCODE',\n        'osteoblast-ENCODE',\n        'H1_Derived_Neuronal_Progenitor_Cultured_Cells-Roadmap',\n        'endothelial_cell_of_umbilical_vein-Roadmap',\n        'NCCIT',\n        'myotube_originated_from_skeletal_muscle_myoblast-Roadmap',\n        'psoas_muscle-Roadmap',\n        'endothelial_cell_of_umbilical_vein_vegf_stim_4_hours-zhang2013',\n        'endothelial_cell_of_umbilical_vein_vegf_stim_12_hours-zhang2013',\n      ],\n    },\n  ],\n};\n\nexport const GROUPED_SAMPLE_OPTIONS = DEFAULT_STRATIFICATION.groups.map(\n  (group) => ({\n    name: group.label,\n    options: group.categories,\n  })\n);\n\nexport const SAMPLE_TO_GROUP = GROUPED_SAMPLE_OPTIONS.reduce(\n  (sampleToGroup, group) => {\n    group.options.forEach((option) => {\n      sampleToGroup[option] = group.name;\n    });\n    return sampleToGroup;\n  },\n  {}\n);\n\nexport const SAMPLES = GROUPED_SAMPLE_OPTIONS.flatMap((group) => group.options);\n\nexport const SAMPLE_IDX = SAMPLES.reduce((idxs, sample, idx) => {\n  idxs[sample] = idx;\n  return idxs;\n}, {});\n\nexport const DEFAULT_X_DOMAIN_START = 1761366260;\nexport const DEFAULT_X_DOMAIN_END = 1761603836;\n\nexport const DEFAULT_VARIANT_TRACK_SERVER = 'https://resgen.io/api/v1';\n\nexport const VARIANT_TRACK_ABBR_TO_SERVER = {\n  rg: 'https://resgen.io/api/v1',\n  hg: 'https://higlass.io/api/v1',\n};\n\nexport const VARIANT_TRACK_SERVER_TO_ABBR = Object.entries(\n  VARIANT_TRACK_ABBR_TO_SERVER\n).reduce((map, [abbr, server]) => {\n  map[server] = abbr;\n  return map;\n}, {});\n\nexport const DEFAULT_VARIANT_TRACK_SERVER_ABBR =\n  VARIANT_TRACK_SERVER_TO_ABBR[DEFAULT_VARIANT_TRACK_SERVER];\n\nexport const DEFAULT_VARIANT_TRACK_PVAL_COL = 7;\n\nexport const DEFAULT_VARIANT_TRACK_PPROB_COL = 8;\n\nexport const DEFAULT_VARIANT_TRACKS = [\n  {\n    server: 'https://resgen.io/api/v1',\n    tilesetUid: 'VF5-RDXWTxidGMJU7FeaxA',\n    columnPvalue: 7,\n    columnPosteriorProbability: 8,\n    markColor: 'black',\n    label: 'IBD Variants',\n  },\n];\n\nexport const DEFAULT_VARIANT_TRACK_DEF = {\n  type: 'point-annotation',\n  height: 32,\n  options: {\n    axisPositionHorizontal: 'right',\n    markColor: 'black',\n    markColorFocus: '#cc0078',\n    markSize: 2,\n    markOpacity: 0.33,\n    markOpacityFocus: 0.66,\n    valueColumn: 7,\n    name: 'Variants',\n    labelPosition: 'topLeft',\n    labelColor: 'black',\n    labelOpacity: 0.33,\n    showMousePosition: true,\n    showGlobalMousePosition: true,\n    mousePositionColor: 'black',\n    toolTip: {\n      name: {\n        field: 3,\n      },\n      value: {\n        field: 6,\n        numDecimals: 2,\n      },\n      other: [\n        {\n          label: 'Post. Prob.',\n          field: 7,\n          numDecimals: 2,\n        },\n      ],\n    },\n  },\n};\n\nexport const LOCAL_BED_TILESET_INFO_HG19 = {\n  zoom_step: 1,\n  max_length: 3137161265,\n  assembly: 'hg19',\n  chrom_names:\n    'chr1\\tchr2\\tchr3\\tchr4\\tchr5\\tchr6\\tchr7\\tchr8\\tchr9\\tchr10\\tchr11\\tchr12\\tchr13\\tchr14\\tchr15\\tchr16\\tchr17\\tchr18\\tchr19\\tchr20\\tchr21\\tchr22\\tchrX\\tchrY\\tchrM\\tchr6_ssto_hap7\\tchr6_mcf_hap5\\tchr6_cox_hap2\\tchr6_mann_hap4\\tchr6_apd_hap1\\tchr6_qbl_hap6\\tchr6_dbb_hap3\\tchr17_ctg5_hap1\\tchr4_ctg9_hap1\\tchr1_gl000192_random\\tchrUn_gl000225\\tchr4_gl000194_random\\tchr4_gl000193_random\\tchr9_gl000200_random\\tchrUn_gl000222\\tchrUn_gl000212\\tchr7_gl000195_random\\tchrUn_gl000223\\tchrUn_gl000224\\tchrUn_gl000219\\tchr17_gl000205_random\\tchrUn_gl000215\\tchrUn_gl000216\\tchrUn_gl000217\\tchr9_gl000199_random\\tchrUn_gl000211\\tchrUn_gl000213\\tchrUn_gl000220\\tchrUn_gl000218\\tchr19_gl000209_random\\tchrUn_gl000221\\tchrUn_gl000214\\tchrUn_gl000228\\tchrUn_gl000227\\tchr1_gl000191_random\\tchr19_gl000208_random\\tchr9_gl000198_random\\tchr17_gl000204_random\\tchrUn_gl000233\\tchrUn_gl000237\\tchrUn_gl000230\\tchrUn_gl000242\\tchrUn_gl000243\\tchrUn_gl000241\\tchrUn_gl000236\\tchrUn_gl000240\\tchr17_gl000206_random\\tchrUn_gl000232\\tchrUn_gl000234\\tchr11_gl000202_random\\tchrUn_gl000238\\tchrUn_gl000244\\tchrUn_gl000248\\tchr8_gl000196_random\\tchrUn_gl000249\\tchrUn_gl000246\\tchr17_gl000203_random\\tchr8_gl000197_random\\tchrUn_gl000245\\tchrUn_gl000247\\tchr9_gl000201_random\\tchrUn_gl000235\\tchrUn_gl000239\\tchr21_gl000210_random\\tchrUn_gl000231\\tchrUn_gl000229\\tchrUn_gl000226\\tchr18_gl000207_random',\n  chrom_sizes:\n    '249250621\\t243199373\\t198022430\\t191154276\\t180915260\\t171115067\\t159138663\\t146364022\\t141213431\\t135534747\\t135006516\\t133851895\\t115169878\\t107349540\\t102531392\\t90354753\\t81195210\\t78077248\\t59128983\\t63025520\\t48129895\\t51304566\\t155270560\\t59373566\\t16571\\t4928567\\t4833398\\t4795371\\t4683263\\t4622290\\t4611984\\t4610396\\t1680828\\t590426\\t547496\\t211173\\t191469\\t189789\\t187035\\t186861\\t186858\\t182896\\t180455\\t179693\\t179198\\t174588\\t172545\\t172294\\t172149\\t169874\\t166566\\t164239\\t161802\\t161147\\t159169\\t155397\\t137718\\t129120\\t128374\\t106433\\t92689\\t90085\\t81310\\t45941\\t45867\\t43691\\t43523\\t43341\\t42152\\t41934\\t41933\\t41001\\t40652\\t40531\\t40103\\t39939\\t39929\\t39786\\t38914\\t38502\\t38154\\t37498\\t37175\\t36651\\t36422\\t36148\\t34474\\t33824\\t27682\\t27386\\t19913\\t15008\\t4262',\n  tile_size: 1024.0,\n  max_zoom: 22,\n  max_width: 4294967296.0,\n  min_pos: [1],\n  max_pos: [3137161265],\n  header:\n    'chrom1\\tstart1\\tend1\\tchrom2\\tstart2\\tend2\\ttargetGene\\tscore\\tstrand1\\tstrand2\\tcellType',\n  version: 2,\n  coordSystem: '',\n};\n\nexport const DEFAULT_VIEW_CONFIG_ENHANCER = {\n  editable: false,\n  trackSourceServers: ['//higlass.io/api/v1'],\n  views: [\n    {\n      uid: 'context',\n      genomePositionSearchBox: {\n        autocompleteServer: '//higlass.io/api/v1',\n        autocompleteId: 'OHJakQICQD6gTD7skx4EWA',\n        chromInfoServer: '//higlass.io/api/v1',\n        chromInfoId: 'hg19',\n        visible: true,\n      },\n      chromInfoPath: '//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv',\n      tracks: {\n        top: [\n          {\n            type: 'combined',\n            uid: 'chroms-viewport',\n            height: 12,\n            contents: [\n              {\n                type: 'horizontal-chromosome-labels',\n                options: {\n                  // tickPositions: 'ends',\n                  color: '#999999',\n                  stroke: 'white',\n                  fontSize: 10,\n                  fontIsLeftAligned: true,\n                  showMousePosition: false,\n                  mousePositionColor: '#000000',\n                },\n                tilesetUid: 'ADfY_RtsQR6oKOMyrq6qhw',\n                height: 12,\n                server: 'https://resgen.io/api/v1',\n                uid: 'chroms',\n              },\n              {\n                uid: 'viewport-details-chroms',\n                type: 'viewport-projection-horizontal',\n                fromViewUid: 'details',\n                height: 12,\n                options: {\n                  projectionFillColor: '#cc0078',\n                  projectionStrokeColor: '#cc0078',\n                  projectionFillOpacity: 0.3,\n                  projectionStrokeOpacity: 0.3,\n                  strokeWidth: 1,\n                },\n              },\n            ],\n          },\n          {\n            type: 'combined',\n            uid: 'genes-tss-viewport',\n            height: 48,\n            contents: [\n              {\n                type: 'horizontal-gene-annotations',\n                uid: 'genes',\n                height: 48,\n                server: 'https://resgen.io/api/v1',\n                tilesetUid: 'NCifnbrKQu6j-ohVWJLoJw',\n                options: {\n                  fontSize: 9,\n                  plusStrandColor: 'black',\n                  minusStrandColor: 'black',\n                  geneAnnotationHeight: 10,\n                  geneLabelPosition: 'outside',\n                  geneStrandSpacing: 0.5,\n                  showMousePosition: true,\n                  showGlobalMousePosition: true,\n                  mousePositionColor: 'black',\n                },\n              },\n              {\n                type: 'tss',\n                uid: 'tss',\n                height: 48,\n                // server: 'http://localhost:9876/api/v1',\n                // tilesetUid: 'RefSeqCurated170308bedCollapsedGeneBoundsTSS500bp',\n                server: 'https://resgen.io/api/v1',\n                // tilesetUid: 'VMZDLKrtQDmJMSjg7Ds4yA',\n                tilesetUid: 'QRtec09sQjuVmUaB_uUFEw', // with scores for prioritization\n                options: {\n                  fontSize: 9,\n                  plusStrandColor: 'black',\n                  minusStrandColor: 'black',\n                  geneAnnotationHeight: 12,\n                  geneLabelPosition: 'outside',\n                  geneStrandSpacing: 2,\n                  maxPerTile: 25,\n                },\n              },\n              {\n                uid: 'viewport-details-genes',\n                type: 'viewport-projection-horizontal',\n                fromViewUid: 'details',\n                height: 48,\n                options: {\n                  projectionFillColor: '#cc0078',\n                  projectionStrokeColor: '#cc0078',\n                  projectionFillOpacity: 0.3,\n                  projectionStrokeOpacity: 0.3,\n                  strokeWidth: 1,\n                },\n              },\n            ],\n          },\n          {\n            type: 'combined',\n            uid: 'variants',\n            height: 32,\n            contents: [\n              {\n                type: 'point-annotation',\n                uid: 'ibd-snps',\n                // server: 'http://localhost:9876/api/v1',\n                // tilesetUid: 'IBDCombinedset1-2variantonly-pval',\n                server: 'https://resgen.io/api/v1',\n                tilesetUid: 'VF5-RDXWTxidGMJU7FeaxA',\n                height: 32,\n                options: {\n                  axisPositionHorizontal: 'right',\n                  markColor: 'black',\n                  markColorFocus: '#cc0078',\n                  markSize: 2,\n                  markOpacity: 0.33,\n                  markOpacityFocus: 0.66,\n                  // axisPositionHorizontal: 'right',\n                  valueColumn: 7,\n                  focusRegion: [\n                    1680373143 + 81046453 - 25,\n                    1680373143 + 81046453 + 25,\n                  ],\n                  name: 'IBD Variants',\n                  labelPosition: 'topLeft',\n                  labelColor: '#757575',\n                  showMousePosition: true,\n                  showGlobalMousePosition: true,\n                  mousePositionColor: 'black',\n                  toolTip: {\n                    name: {\n                      field: 3,\n                    },\n                    value: {\n                      field: 6,\n                      numDecimals: 2,\n                    },\n                    other: [\n                      {\n                        label: 'Post. Prob.',\n                        field: 7,\n                        numDecimals: 2,\n                      },\n                    ],\n                  },\n                },\n              },\n            ],\n          },\n          {\n            type: 'combined',\n            uid: 'arcs-stacked-bars',\n            height: 72,\n            contents: [\n              {\n                type: '1d-arcs',\n                uid: 'arcs',\n                server: 'https://resgen.io/api/v1',\n                tilesetUid: EG_TILE_UID,\n                height: 72,\n                options: {\n                  labelPosition: 'hidden',\n                  strokeColor: '#808080',\n                  strokeWidth: 1,\n                  strokeOpacity: 0.05,\n                  arcStyle: 'circle',\n                  startField: ENHANCER_START_COLUMN,\n                  endField: TSS_START_COLUMN,\n                  filter: {\n                    set: SAMPLES,\n                    field: BIOSAMPLE_COLUMN,\n                  },\n                },\n              },\n              {\n                type: 'stacked-bar',\n                // server: 'http://localhost:9876/api/v1',\n                // tilesetUid: 'AllPredictionsAvgHiCABC0015minus150ForABCPaperV2hg19beddb',\n                // tilesetUid:\n                //   'AllPredictionsAvgHiCABC0015minus150ForABCPaperV3txtsimplifiedgzhg19beddb',\n                server: 'https://resgen.io/api/v1',\n                // tilesetUid: 'P0Ng5fhvQWeO7dlpx0FknA', // all chroms\n                // tilesetUid: 'PGXLE50tQyOayNXKUnX4fQ', // just chr10\n                // tilesetUid: 'AaJojHeORzKyiag1pSlAag', // bed\n                tilesetUid: EG_TILE_UID,\n                height: 72,\n                uid: 'stacked-bars',\n                options: {\n                  binSize: 4,\n                  axisAlign: 'right',\n                  axisPositionHorizontal: 'right',\n                  labelPosition: 'topLeft',\n                  markColor: 'black',\n                  markColorFocus: '#cc0078',\n                  markSize: 4,\n                  markOpacity: 0.33,\n                  labelColor: 'black',\n                  offsetField: TSS_CHROM_COLUMN,\n                  startField: TSS_START_COLUMN,\n                  endField: TSS_END_COLUMN,\n                  importanceField: ABC_SCORE_COLUMN,\n                  importanceDomain: [0, 1],\n                  focusRegion: [\n                    1680373143 + 81046453 - 25,\n                    1680373143 + 81046453 + 25,\n                  ],\n                  name: 'Enhancer regions',\n                  stratification: DEFAULT_STRATIFICATION,\n                  showMousePosition: true,\n                  showGlobalMousePosition: true,\n                  mousePositionColor: 'black',\n                },\n              },\n            ],\n          },\n          {\n            type: 'stratified-bed',\n            // server: 'http://localhost:9876/api/v1',\n            // tilesetUid: 'AllPredictionsAvgHiCABC0015minus150ForABCPaperV2hg19beddb',\n            // tilesetUid:\n            //   'AllPredictionsAvgHiCABC0015minus150ForABCPaperV3txtsimplifiedgzhg19beddb',\n            server: 'https://resgen.io/api/v1',\n            // tilesetUid: 'P0Ng5fhvQWeO7dlpx0FknA', // all chroms\n            // tilesetUid: 'PGXLE50tQyOayNXKUnX4fQ', // just chr10\n            // tilesetUid: 'AaJojHeORzKyiag1pSlAag', // bed\n            tilesetUid: EG_TILE_UID,\n            height: 413,\n            uid: 'indicatorByCellTypes',\n            options: {\n              axisAlign: 'right',\n              legendAlign: 'left',\n              labelPosition: 'hidden',\n              markColor: 'black',\n              markColorHighlight: '#bf0071',\n              markColorDehighlight: '#bbbbbb',\n              markSize: 4,\n              markMinWidth: 4,\n              markHeight: 3,\n              rowHeight: 3,\n              markOpacity: 0.33,\n              arcStyle: 'indicator',\n              indicatorStyle: 'category-rect',\n              labelColor: 'black',\n              geneField: GENE_NAME_COLUMN,\n              importanceField: ABC_SCORE_COLUMN,\n              importanceDomain: [0, 1],\n              // focusRegion: [\n              //   1680373143 + 81046453 - 25,\n              //   1680373143 + 81046453 + 25,\n              // ],\n              name: 'By Celltype',\n              axisPositionHorizontal: 'right',\n              stratification: DEFAULT_STRATIFICATION,\n              showMousePosition: true,\n              showGlobalMousePosition: true,\n              mousePositionColor: 'black',\n            },\n          },\n        ],\n      },\n      overlays: [\n        {\n          uid: 'region-focus',\n          includes: [\n            'genes-tss-viewport',\n            'variants',\n            'arcs-stacked-bars',\n            'indicatorByCellTypes',\n          ],\n          options: {\n            extent: [[1680373143 + 81046453, 1680373143 + 81046454]],\n            minWidth: 3,\n            fill: '#cc0078',\n            fillOpacity: 0.05,\n            strokeWidth: 0,\n            outline: '#cc0078',\n            outlineOpacity: 0.33,\n            outlineWidth: 1,\n            outlinePos: ['left', 'right'],\n          },\n        },\n        {\n          uid: 'gene-focus',\n          includes: ['genes-tss-viewport'],\n          options: {\n            extent: [],\n            minWidth: 3,\n            fill: '#cc0078',\n            fillOpacity: 0.25,\n            stroke: '#cc0078',\n            strokeWidth: 0,\n            outlineWidth: 0,\n          },\n        },\n        {\n          uid: 'tss-overlays',\n          includes: [\n            'chroms',\n            'genes-tss-viewport',\n            'variants',\n            'arcs-stacked-bars',\n            'indicatorByCellTypes',\n          ],\n          options: {\n            extent: [],\n            minWidth: 1,\n            fill: 'black',\n            fillOpacity: 0.05,\n            strokeWidth: 0,\n            outline: 'black',\n            outlineOpacity: 0.1,\n            outlineWidth: 1,\n            outlinePos: ['left'],\n          },\n        },\n      ],\n      metaTracks: [\n        {\n          uid: 'tss-overlays-meta',\n          type: 'annotation-overlay',\n          overlaysTrack: 'tss-overlays',\n          options: {\n            annotationTracks: ['tss'],\n          },\n        },\n      ],\n      layout: {\n        w: 12,\n        h: 12,\n        x: 0,\n        y: 0,\n      },\n      initialXDomain: [DEFAULT_X_DOMAIN_START, DEFAULT_X_DOMAIN_END],\n      initialYDomain: [DEFAULT_X_DOMAIN_START, DEFAULT_X_DOMAIN_END],\n    },\n  ],\n};\n\nexport const DEFAULT_DNA_ACCESSIBILITY_ROW_SELECTION = [\n  120,\n  36,\n  54,\n  20,\n  80,\n  35,\n  101,\n  49,\n  44,\n  23,\n  30,\n  66,\n  5,\n  26,\n  15,\n  105,\n  57,\n  56,\n  74,\n  84,\n  79,\n  93,\n  106,\n  107,\n  34,\n  28,\n  25,\n  55,\n  121,\n  94,\n  58,\n  69,\n  67,\n  63,\n  126,\n  71,\n  72,\n  47,\n  11,\n  46,\n  39,\n  113,\n  29,\n  60,\n  45,\n  76,\n  21,\n  103,\n  129,\n  13,\n  128,\n  90,\n  104,\n  32,\n  109,\n  27,\n  9,\n  130,\n  95,\n  86,\n  53,\n  73,\n  50,\n  48,\n  78,\n  14,\n  92,\n  124,\n  31,\n  114,\n  64,\n  88,\n  12,\n  10,\n  38,\n  68,\n  3,\n  111,\n  70,\n  22,\n  61,\n  98,\n  6,\n  123,\n  118,\n  43,\n  37,\n  65,\n  81,\n  62,\n  33,\n  1,\n  24,\n  122,\n  83,\n  75,\n  112,\n  40,\n  97,\n  16,\n  117,\n  87,\n  19,\n  125,\n  7,\n  102,\n  116,\n  77,\n  8,\n  17,\n  82,\n  115,\n  89,\n  119,\n  18,\n  4,\n  108,\n  59,\n  127,\n  91,\n  0,\n  100,\n  85,\n  110,\n  99,\n  2,\n  96,\n  51,\n  41,\n  52,\n  42,\n];\n\nexport const DEFAULT_DNA_ACCESSIBILITY_ROW_CATEGORIES = DEFAULT_STRATIFICATION.groups.reduce(\n  (row, group, index) => {\n    const category = {\n      label: group.label,\n      color: group.axisLabelColor,\n      background: group.axisLabelBackground,\n      index,\n    };\n    group.categories.forEach((sample) => {\n      row[sample] = category;\n    });\n    return row;\n  },\n  {}\n);\n\nexport const DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY = {\n  zoomFixed: false,\n  editable: false,\n  trackSourceServers: ['//higlass.io/api/v1'],\n  views: [\n    {\n      uid: 'details',\n      chromInfoPath: '//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv',\n      tracks: {\n        top: [\n          {\n            uid: 'chroms',\n            type: 'horizontal-chromosome-labels',\n            server: 'https://resgen.io/api/v1',\n            tilesetUid: 'ADfY_RtsQR6oKOMyrq6qhw',\n            height: 17,\n            options: {\n              // tickPositions: 'ends',\n              color: '#999999',\n              stroke: 'white',\n              fontSize: 10,\n              fontIsLeftAligned: true,\n              showMousePosition: false,\n              mousePositionColor: '#000000',\n            },\n          },\n          {\n            uid: 'genes',\n            type: 'horizontal-gene-annotations',\n            server: 'https://resgen.io/api/v1',\n            tilesetUid: 'NCifnbrKQu6j-ohVWJLoJw',\n            height: 48,\n            options: {\n              fontSize: 9,\n              plusStrandColor: 'black',\n              minusStrandColor: 'black',\n              geneAnnotationHeight: 10,\n              geneLabelPosition: 'outside',\n              geneStrandSpacing: 0.5,\n              showMousePosition: true,\n              showGlobalMousePosition: true,\n              mousePositionColor: 'black',\n            },\n          },\n          {\n            type: 'combined',\n            uid: 'variants',\n            height: 32,\n            contents: [\n              {\n                type: 'point-annotation',\n                uid: 'ibd-snps',\n                // server: 'http://localhost:9876/api/v1',\n                // tilesetUid: 'IBDCombinedset1-2variantonly-pval',\n                server: 'https://resgen.io/api/v1',\n                tilesetUid: 'VF5-RDXWTxidGMJU7FeaxA',\n                height: 32,\n                options: {\n                  axisPositionHorizontal: 'right',\n                  markColor: 'black',\n                  markColorFocus: '#cc0078',\n                  markSize: 2,\n                  markOpacity: 0.33,\n                  markOpacityFocus: 0.66,\n                  // axisPositionHorizontal: 'right',\n                  valueColumn: 7,\n                  focusRegion: [\n                    1680373143 + 81046453 - 25,\n                    1680373143 + 81046453 + 25,\n                  ],\n                  name: 'IBD Variants',\n                  labelPosition: 'topLeft',\n                  labelColor: '#757575',\n                  showMousePosition: true,\n                  showGlobalMousePosition: true,\n                  mousePositionColor: 'black',\n                  toolTip: {\n                    name: {\n                      field: 3,\n                    },\n                    value: {\n                      field: 6,\n                      numDecimals: 2,\n                    },\n                    other: [\n                      {\n                        label: 'Post. Prob.',\n                        field: 7,\n                        numDecimals: 2,\n                      },\n                    ],\n                  },\n                },\n              },\n            ],\n          },\n          {\n            uid: 'dna-accessibility',\n            type: 'ridge-plot',\n            // server: 'http://localhost:9876/api/v1',\n            // tilesetUid: 'test',\n            server: 'https://resgen.io/api/v1',\n            tilesetUid: 'Uz1_tEABQf-uzktblvBKSQ',\n            // height: 403,\n            height: 131 * (24 - 6) + 6,\n            options: {\n              name: 'DNA Accessibility',\n              labelPosition: 'outerBottom',\n              labelShowResolution: false,\n              labelShowAssembly: false,\n              markArea: true,\n              markColor: '#444444',\n              markResolution: 256,\n              valueScaling: 'exponential',\n              colorRange: ['#ffffff', '#000000'],\n              rowHeight: 24,\n              rowPadding: -6,\n              rowNormalization: true,\n              rowSelections: DEFAULT_DNA_ACCESSIBILITY_ROW_SELECTION,\n              rowIdToCategory: {\n                fn: 'replace',\n                args: ['.accessibility', ''],\n              },\n              rowCategories: DEFAULT_DNA_ACCESSIBILITY_ROW_CATEGORIES,\n              showRowLabels: true,\n              rowLabelSize: 10,\n              showMousePosition: true,\n              showGlobalMousePosition: true,\n              mousePositionColor: 'black',\n            },\n          },\n        ],\n      },\n      overlays: [\n        {\n          uid: 'region-focus',\n          includes: ['genes', 'variants', 'dna-accessibility'],\n          options: {\n            extent: [],\n            minWidth: 3,\n            fill: '#cc0078',\n            fillOpacity: 0.05,\n            strokeWidth: 0,\n            outline: '#cc0078',\n            outlineOpacity: 0.33,\n            outlineWidth: 1,\n            outlinePos: ['left', 'right'],\n          },\n        },\n      ],\n      layout: {\n        w: 12,\n        h: 12,\n        x: 0,\n        y: 0,\n      },\n      initialXDomain: [\n        1680373143 + 81046453 - 500,\n        1680373143 + 81046454 + 500,\n      ],\n      initialYDomain: [\n        1680373143 + 81046453 - 500,\n        1680373143 + 81046454 + 500,\n      ],\n    },\n  ],\n};\n\nexport const IGNORED_FOCUS_ELEMENTS = new Set(['input', 'textarea']);\n\nexport const HIGLASS_PAN_ZOOM = 'panZoom';\n\nexport const HIGLASS_SELECT = 'select';\n","import { deepClone, isFunction } from '@flekschas/utils';\n\nimport { getIntervalCenter } from './utils';\n\nimport { DEFAULT_VARIANT_TRACK_DEF } from './constants';\n\nconst getFocusGeneRegion = (viewConfig) => {\n  return viewConfig.views[0].overlays[1] &&\n    viewConfig.views[0].overlays[1].options.extent &&\n    viewConfig.views[0].overlays[1].options.extent.length\n    ? [...viewConfig.views[0].overlays[1].options.extent[0]]\n    : null;\n};\n\nconst getFocusVariantRegion = (viewConfig) => {\n  const track = viewConfig.views[0].tracks.top[2];\n  let focusRegion = null;\n\n  if (track.type === 'combined') {\n    if (!track.contents[0]) return focusRegion;\n    focusRegion = track.contents[0].options.focusRegion;\n  } else {\n    focusRegion = track.options.focusRegion;\n  }\n\n  return focusRegion ? [...focusRegion] : focusRegion;\n};\n\nexport const updateViewConfigVariantTracks = (variantTrackConfigs) => (\n  viewConfig\n) => {\n  const track = viewConfig.views[0].tracks.top[2];\n\n  if (track.type === 'combined') {\n    track.contents = variantTrackConfigs.reduce((tracks, trackConfig) => {\n      const variantTrack = deepClone(DEFAULT_VARIANT_TRACK_DEF);\n      if (trackConfig.server && trackConfig.tilesetUid) {\n        variantTrack.server = trackConfig.server;\n        variantTrack.tilesetUid = trackConfig.tilesetUid;\n        variantTrack.uid = `variants-${trackConfig.tilesetUid}`;\n        if (trackConfig.label) {\n          variantTrack.options.name = trackConfig.label;\n        } else {\n          // Lets rely on the tileset name\n          delete variantTrack.options.name;\n        }\n        tracks.push(variantTrack);\n      } else if (trackConfig.file) {\n        variantTrack.data = { type: 'localBed', id: trackConfig.file.name };\n        variantTrack.uid = `variants-${trackConfig.file.name}`;\n        variantTrack.options.name = trackConfig.label || 'Variants';\n        tracks.push(variantTrack);\n      }\n      return tracks;\n    }, []);\n\n    track.height = (track.contents.length > 0) * 32;\n  }\n\n  return viewConfig;\n};\n\nexport const updateViewConfigFocusRegion = (region, trackIdxs = []) => (\n  viewConfig\n) => {\n  const delFocusRegion = (track, focusRegion) => {\n    if (track.type === 'combined') {\n      track.contents.forEach((childTrack) => {\n        delete childTrack.options.focusRegion;\n      });\n    } else {\n      delete track.options.focusRegion;\n    }\n  };\n\n  const setFocusRegion = (track, focusRegion) => {\n    if (track.type === 'combined') {\n      track.contents.forEach((childTrack) => {\n        childTrack.options.focusRegion = focusRegion;\n      });\n    } else {\n      track.options.focusRegion = focusRegion;\n    }\n  };\n\n  if (!Array.isArray(region) || region === null) {\n    trackIdxs.forEach((trackIdx) => {\n      delFocusRegion(viewConfig.views[0].tracks.top[trackIdx]);\n    });\n    viewConfig.views[0].overlays[0].options.extent = [];\n  } else {\n    const focusRegion = [region[0] - 0.5, region[1] - 0.5];\n\n    trackIdxs.forEach((trackIdx) => {\n      setFocusRegion(viewConfig.views[0].tracks.top[trackIdx], focusRegion);\n    });\n\n    viewConfig.views[0].overlays[0].options.extent = [focusRegion];\n  }\n\n  return viewConfig;\n};\n\nexport const updateViewConfigVariantYScale = (yScale) => (viewConfig) => {\n  const track = viewConfig.views[0].tracks.top[2];\n\n  if (track.type === 'combined') {\n    track.contents.forEach((childTrack) => {\n      childTrack.options.valueColumn = yScale === 'pValue' ? 7 : 8;\n    });\n  } else {\n    track.options.valueColumn = yScale === 'pValue' ? 7 : 8;\n  }\n\n  return viewConfig;\n};\n\nexport const updateViewConfigXDomain = (\n  newXDomainStart,\n  newXDomainEnd,\n  { force = false } = {}\n) => (viewConfig) => {\n  const _force = force === true || (isFunction(force) && force());\n\n  const xDomain = [...viewConfig.views[0].initialXDomain];\n  const focusGeneRegion = getFocusGeneRegion(viewConfig);\n  const focusVariantRegion = getFocusVariantRegion(viewConfig);\n\n  if (!Number.isNaN(+newXDomainStart)) {\n    xDomain[0] = newXDomainStart;\n  }\n  if (!Number.isNaN(+newXDomainEnd)) {\n    xDomain[1] = newXDomainEnd;\n  }\n\n  if (focusGeneRegion && !_force) {\n    xDomain[0] = focusGeneRegion[0] - 100000;\n    xDomain[1] = focusGeneRegion[1] + 100000;\n  }\n\n  if (focusVariantRegion && !_force) {\n    xDomain[0] = Math.min(xDomain[0], focusVariantRegion[0] - 100000);\n    xDomain[1] = Math.max(xDomain[1], focusVariantRegion[1] + 100000);\n  }\n\n  viewConfig.views[0].initialXDomain = xDomain;\n\n  return viewConfig;\n};\n\nexport const updateViewConfigFocusGene = (gene, start, end) => (viewConfig) => {\n  const n = viewConfig.views[0].tracks.top.length;\n\n  if (gene) {\n    viewConfig.views[0].tracks.top[n - 1].options.focusGene = gene;\n    viewConfig.views[0].overlays[1].options.extent = [[start, end]];\n  } else {\n    delete viewConfig.views[0].tracks.top[n - 1].options.focusGene;\n    delete viewConfig.views[0].overlays[1].options.extent;\n  }\n\n  return viewConfig;\n};\n\nexport const getDnaAccessXDomain = (\n  focusRegionAbs,\n  focusGeneStart,\n  focusGeneEnd,\n  xDomainStartAbs,\n  xDomainEndAbs\n) => {\n  const enhancerViewRange = xDomainEndAbs - xDomainStartAbs;\n  const enhancerViewCenter = xDomainStartAbs + enhancerViewRange / 2;\n\n  if (focusRegionAbs) {\n    const focusRegionCenter = getIntervalCenter(focusRegionAbs);\n    if (\n      enhancerViewRange < 5000 &&\n      Math.abs(enhancerViewCenter - focusRegionCenter) < 1000\n    ) {\n      return [xDomainStartAbs, xDomainEndAbs];\n    }\n    return [focusRegionAbs[0] - 2500, focusRegionAbs[1] + 2500];\n  }\n\n  if (focusGeneStart && focusGeneEnd) {\n    const midPos = focusGeneStart + (focusGeneEnd - focusGeneStart) / 2;\n\n    if (\n      enhancerViewRange < 5000 &&\n      enhancerViewCenter > focusGeneStart &&\n      enhancerViewCenter < focusGeneEnd\n    ) {\n      return [xDomainStartAbs, xDomainEndAbs];\n    }\n\n    return [midPos - 2500, midPos + 2500];\n  }\n\n  return [xDomainStartAbs, xDomainEndAbs];\n};\n","import { atom, selector } from 'recoil';\nimport { memoize } from 'lodash-es';\nimport { deepClone, identity } from '@flekschas/utils';\n\nimport {\n  useRecoilQueryString,\n  useRecoilQueryStringSyncher,\n} from './use-query-string';\n\nimport {\n  booleanQueryStringDecoder,\n  customBooleanQueryStringDecoder,\n  getQueryStringValue,\n  toAbsPosition,\n  isChrRange,\n  chrPosUrlDecoder,\n  chrPosUrlEncoder,\n  chrRangePosUrlDecoder,\n  chrRangePosUrlEncoder,\n  chrRangePosEncoder,\n} from './utils';\n\nimport {\n  DEFAULT_X_DOMAIN_START,\n  DEFAULT_X_DOMAIN_END,\n  DEFAULT_VARIANT_TRACKS,\n  DEFAULT_VARIANT_TRACK_SERVER_ABBR,\n  DEFAULT_VARIANT_TRACK_PVAL_COL,\n  DEFAULT_VARIANT_TRACK_PPROB_COL,\n  VARIANT_TRACK_ABBR_TO_SERVER,\n  VARIANT_TRACK_SERVER_TO_ABBR,\n  GROUPED_SAMPLE_OPTIONS,\n  SAMPLES,\n} from './constants';\n\nimport { getDnaAccessXDomain } from './view-config';\n\nconst getDefault = (key, initialValue, decoder) => {\n  const qVal = getQueryStringValue(key, decoder);\n  return qVal === undefined ? initialValue : qVal;\n};\n\nconst showWelcomeDecoder = customBooleanQueryStringDecoder(['intro']);\n\nconst variantTracksDecoder = (v) => {\n  if (!v) return undefined;\n\n  // tilesetId:rg:7:8\n  const [\n    tilesetUid,\n    serverAbbr = DEFAULT_VARIANT_TRACK_SERVER_ABBR,\n    columnPvalue = DEFAULT_VARIANT_TRACK_PVAL_COL,\n    columnPosteriorProbability = DEFAULT_VARIANT_TRACK_PPROB_COL,\n  ] = v.split(':');\n\n  const server = VARIANT_TRACK_ABBR_TO_SERVER[serverAbbr];\n\n  if (tilesetUid === undefined) return tilesetUid;\n\n  return [\n    {\n      server,\n      tilesetUid,\n      columnPvalue,\n      columnPosteriorProbability,\n      markColor: 'black',\n    },\n  ];\n};\n\nconst variantTracksEncoder = (v) => {\n  if (!v || !Array.isArray(v) || v.length > 1) return '';\n\n  const { tilesetUid } = v[0];\n  const serverAbbr =\n    VARIANT_TRACK_SERVER_TO_ABBR[v[0].server] ===\n    DEFAULT_VARIANT_TRACK_SERVER_ABBR\n      ? null\n      : VARIANT_TRACK_SERVER_TO_ABBR[v[0].server];\n  const pValCol =\n    v[0].columnPvalue === DEFAULT_VARIANT_TRACK_PVAL_COL\n      ? null\n      : v[0].columnPvalue;\n  const pProbCol =\n    v[0].columnPosteriorProbability === DEFAULT_VARIANT_TRACK_PPROB_COL\n      ? null\n      : v[0].columnPosteriorProbability;\n\n  if (!tilesetUid || serverAbbr === undefined) return '';\n\n  return [tilesetUid, serverAbbr, pValCol, pProbCol].filter(identity).join(':');\n};\n\n// Atoms\nexport const sampleFilterState = atom({\n  key: 'sampleFilterState',\n  default: '',\n});\n\nexport const sampleSelectionState = selector({\n  key: 'sampleSelection',\n  get: ({ get }) => SAMPLES.map((name) => get(sampleWithName(name)).checked),\n});\n\nexport const selectedSamplesState = selector({\n  key: 'selectedSamples',\n  get: ({ get }) => SAMPLES.filter((name) => get(sampleWithName(name)).checked),\n});\n\nexport const sampleWithName = memoize((name) =>\n  atom({\n    key: `sample-${name}`,\n    default: {\n      checked: true,\n      visible: true,\n    },\n  })\n);\n\nexport const sampleGroupWithGroup = memoize(\n  (group) =>\n    atom({\n      key: `sampleGroup-${group.name}`,\n      default: {\n        checked: true,\n        visible: true,\n        n: group.options.length,\n        N: group.options.length,\n      },\n    }),\n  (group) => group.name\n);\n\nexport const sampleGroupSelectionSizesState = selector({\n  key: 'sampleGroupSelectionSizes',\n  get: ({ get }) =>\n    GROUPED_SAMPLE_OPTIONS.reduce((sizes, group) => {\n      sizes[group.name] = get(sampleGroupWithGroup(group)).n;\n      return sizes;\n    }, {}),\n});\n\nexport const variantTracksState = atom({\n  key: 'variantTracks',\n  default: getDefault(\n    'vt',\n    deepClone(DEFAULT_VARIANT_TRACKS),\n    variantTracksDecoder\n  ),\n});\n\nexport const showVariantsSettingsState = atom({\n  key: 'showVariantsSettings',\n  default: false,\n});\n\nexport const showWelcomeState = atom({\n  key: 'showWelcome',\n  default: getDefault('w', true, showWelcomeDecoder),\n});\n\nexport const dnaAccessLabelStyleState = atom({\n  key: 'dnaAccessLabelStyle',\n  default: getDefault('dal', 'indicator'),\n});\n\nexport const dnaAccessRowNormState = atom({\n  key: 'dnaAccessRowNorm',\n  default: getDefault('darn', true, booleanQueryStringDecoder),\n});\n\nexport const dnaAccessLabelShowInfoState = atom({\n  key: 'dnaAccessLabelShowInfos',\n  default: getDefault('dai', true, booleanQueryStringDecoder),\n});\n\nexport const focusGeneState = atom({\n  key: 'focusGene',\n  default: getDefault('g', ''),\n});\n\nexport const focusGeneOptionState = atom({\n  key: 'focusGeneOption',\n  default: null,\n});\n\nexport const focusRegionState = atom({\n  key: `focusRegion`,\n  default: getDefault('f', 'rs1250566', (v) =>\n    v && isChrRange(v) ? chrRangePosUrlDecoder(v) : v\n  ),\n});\n\nexport const focusRegionOptionState = atom({\n  key: `focusRegionOption`,\n  default: getDefault('f', null, (v) => {\n    if (!v || !isChrRange(v)) return null;\n\n    const [start, end] = chrRangePosUrlDecoder(v);\n\n    if (!start || !end) return null;\n\n    const [chrStart, txStart] = start.split(':');\n    const [chrEnd, txEnd] = end.split(':');\n\n    return {\n      chrStart,\n      chrEnd,\n      txStart: +txStart,\n      txEnd: +txEnd,\n      geneName: chrRangePosEncoder([start, end]),\n      type: 'region',\n    };\n  }),\n});\n\nexport const variantYScaleState = atom({\n  key: 'variantYScale',\n  default: getDefault('vy', 'pValue'),\n});\n\nexport const enhancerRegionsHideUnfocusedState = atom({\n  key: 'enhancerRegionsHideUnfocused',\n  default: getDefault('erhu', false, booleanQueryStringDecoder),\n});\n\nexport const enhancerRegionsColorEncodingState = atom({\n  key: 'enhancerRegionsColorEncoding',\n  default: getDefault('erc', 'solid'),\n});\n\nexport const enhancerRegionsShowInfoState = atom({\n  key: 'enhancerRegionsShowInfos',\n  default: getDefault('eri', true, booleanQueryStringDecoder),\n});\n\nexport const enhancerGenesShowInfoState = atom({\n  key: 'enhancerGenesShowInfos',\n  default: getDefault('egi', true, booleanQueryStringDecoder),\n});\n\nexport const enhancerGenesPaddingState = atom({\n  key: 'enhancerGenesPadding',\n  default: getDefault('egp', false, booleanQueryStringDecoder),\n});\n\nexport const enhancerGenesCellEncodingState = atom({\n  key: 'enhancerGenesCellEncoding',\n  default: getDefault('egce', 'max-score'),\n});\n\nexport const enhancerGenesSvgState = atom({\n  key: 'enhancerGenesSvg',\n  default: null,\n});\nexport const higlassEnhancerRegionsState = atom({\n  key: 'higlassEnhancerRegions',\n  default: null,\n});\n\nexport const higlassDnaAccessState = atom({\n  key: 'higlassDnaAccess',\n  default: null,\n});\n\n// Dynamic state\nexport const xDomainStartWithAssembly = memoize(\n  (chromInfo) =>\n    atom({\n      key: `xDomainStart-${chromInfo.totalLength}`,\n      default: getDefault(\n        'xs',\n        chromInfo.absToChr(DEFAULT_X_DOMAIN_START).slice(0, 2).join(':'),\n        chrPosUrlDecoder\n      ),\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\nexport const xDomainEndWithAssembly = memoize(\n  (chromInfo) =>\n    atom({\n      key: `xDomainEnd-${chromInfo.totalLength}`,\n      default: getDefault(\n        'xe',\n        chromInfo.absToChr(DEFAULT_X_DOMAIN_END).slice(0, 2).join(':'),\n        chrPosUrlDecoder\n      ),\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\n// Derived state\nexport const xDomainStartAbsWithAssembly = memoize(\n  (chromInfo) =>\n    selector({\n      key: `xDomainStartAbs-${chromInfo.totalLength}`,\n      get: ({ get }) => {\n        const xDomainStart = get(xDomainStartWithAssembly(chromInfo));\n        return toAbsPosition(xDomainStart, chromInfo);\n      },\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\nexport const xDomainEndAbsWithAssembly = memoize(\n  (chromInfo) =>\n    selector({\n      key: `xDomainEndAbs-${chromInfo.totalLength}`,\n      get: ({ get }) => {\n        const xDomainEnd = get(xDomainEndWithAssembly(chromInfo));\n        return toAbsPosition(xDomainEnd, chromInfo);\n      },\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\nexport const focusGeneStartWithAssembly = memoize(\n  (chromInfo) =>\n    selector({\n      key: `focusGeneStart-${chromInfo.totalLength}`,\n      get: ({ get }) => {\n        const focusGeneOption = get(focusGeneOptionState);\n        return focusGeneOption\n          ? toAbsPosition(\n              `${focusGeneOption.chr}:${focusGeneOption.txStart}`,\n              chromInfo\n            )\n          : null;\n      },\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\nexport const focusGeneEndWithAssembly = memoize(\n  (chromInfo) =>\n    selector({\n      key: `focusGeneEnd-${chromInfo.totalLength}`,\n      get: ({ get }) => {\n        const focusGeneOption = get(focusGeneOptionState);\n        return focusGeneOption\n          ? toAbsPosition(\n              `${focusGeneOption.chr}:${focusGeneOption.txEnd}`,\n              chromInfo\n            )\n          : null;\n      },\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\nexport const focusRegionAbsWithAssembly = memoize(\n  (chromInfo) =>\n    selector({\n      key: `focusRegionAbs-${chromInfo.totalLength}`,\n      get: ({ get }) => {\n        const focusRegionOption = get(focusRegionOptionState);\n\n        if (!focusRegionOption) return null;\n\n        if (focusRegionOption.chrStart)\n          return [\n            toAbsPosition(\n              `${focusRegionOption.chrStart}:${focusRegionOption.txStart}`,\n              chromInfo\n            ),\n            toAbsPosition(\n              `${focusRegionOption.chrEnd}:${focusRegionOption.txEnd}`,\n              chromInfo\n            ),\n          ];\n\n        const startAbs = toAbsPosition(\n          `${focusRegionOption.chr}:${focusRegionOption.txStart}`,\n          chromInfo\n        );\n\n        return [startAbs, startAbs + 1];\n      },\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\nexport const focusRegionRelState = selector({\n  key: 'focusVariantRel',\n  get: ({ get }) => {\n    const focusRegionOption = get(focusRegionOptionState);\n\n    if (!focusRegionOption) return null;\n\n    if (\n      focusRegionOption.chrStart &&\n      focusRegionOption.chrEnd &&\n      focusRegionOption.chrStart !== focusRegionOption.chrEnd\n    )\n      // The relative position doesn't exist because the selected region\n      // stretches across chromsomes\n      return Number.NaN;\n\n    if (focusRegionOption.chrStart) {\n      return (\n        +focusRegionOption.txStart +\n        (+focusRegionOption.txEnd - +focusRegionOption.txStart) / 2\n      );\n    }\n\n    return +focusRegionOption.txStart;\n  },\n});\n\nexport const focusRegionStrState = selector({\n  key: 'focusRegionStr',\n  get: ({ get }) => {\n    const focusRegionOption = get(focusRegionOptionState);\n\n    if (!focusRegionOption) return null;\n\n    const chrRange = focusRegionOption.chrStart\n      ? [\n          `${focusRegionOption.chrStart}:${focusRegionOption.txStart}`,\n          `${focusRegionOption.chrEnd}:${focusRegionOption.txEnd}`,\n        ]\n      : [\n          `${focusRegionOption.chr}:${focusRegionOption.txStart}`,\n          `${focusRegionOption.chr}:${focusRegionOption.txEnd}`,\n        ];\n\n    return chrRangePosEncoder(chrRange);\n  },\n});\n\nexport const dnaAccessXDomainWithAssembly = memoize(\n  (chromInfo) =>\n    selector({\n      key: 'dnaAccessXDomain',\n      get: ({ get }) => {\n        const focusRegionAbs = get(focusRegionAbsWithAssembly(chromInfo));\n        const focusGeneStart = get(focusGeneStartWithAssembly(chromInfo));\n        const focusGeneEnd = get(focusGeneEndWithAssembly(chromInfo));\n        const xDomainStartAbs = get(xDomainStartAbsWithAssembly(chromInfo));\n        const xDomainEndAbs = get(xDomainEndAbsWithAssembly(chromInfo));\n\n        return getDnaAccessXDomain(\n          focusRegionAbs,\n          focusGeneStart,\n          focusGeneEnd,\n          xDomainStartAbs,\n          xDomainEndAbs\n        );\n      },\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\n/*\n Predefined Hooks\n */\nexport const useVariantTracks = () =>\n  useRecoilQueryString('vt', variantTracksState, variantTracksEncoder);\nexport const useVariantTracksSyncher = () =>\n  useRecoilQueryStringSyncher('vt', variantTracksState, variantTracksEncoder);\n\nexport const useShowWelcome = () => useRecoilQueryString('w', showWelcomeState);\nexport const useShowWelcomeSyncher = () =>\n  useRecoilQueryStringSyncher('w', showWelcomeState);\n\nexport const useFocusGene = () => useRecoilQueryString('g', focusGeneState);\nexport const useFocusGeneSyncher = () =>\n  useRecoilQueryStringSyncher('g', focusGeneState);\n\nexport const useFocusRegion = (chromInfo) =>\n  useRecoilQueryString('f', focusRegionState, (v) =>\n    Array.isArray(v) ? chrRangePosUrlEncoder(v) : v\n  );\nexport const useFocusRegionSyncher = (chromInfo) =>\n  useRecoilQueryStringSyncher('f', focusRegionState, (v) =>\n    Array.isArray(v) ? chrRangePosUrlEncoder(v) : v\n  );\n\nexport const useDnaAccessLabelStyle = () =>\n  useRecoilQueryString('dal', dnaAccessLabelStyleState);\nexport const useDnaAccessLabelStyleSyncher = () =>\n  useRecoilQueryStringSyncher('dal', dnaAccessLabelStyleState);\n\nexport const useDnaAccessRowNorm = () =>\n  useRecoilQueryString('darn', dnaAccessRowNormState);\nexport const useDnaAccessRowNormSyncher = () =>\n  useRecoilQueryStringSyncher('darn', dnaAccessRowNormState);\n\nexport const useDnaAccessShowInfos = () =>\n  useRecoilQueryString('dai', dnaAccessLabelShowInfoState);\nexport const useDnaAccessShowInfosSyncher = () =>\n  useRecoilQueryStringSyncher('dai', dnaAccessLabelShowInfoState);\n\nexport const useXDomainStartWithAssembly = (chromInfo) =>\n  useRecoilQueryString(\n    's',\n    xDomainStartWithAssembly(chromInfo),\n    chrPosUrlEncoder\n  );\nexport const useXDomainStartWithAssemblySyncher = (chromInfo) =>\n  useRecoilQueryStringSyncher(\n    's',\n    xDomainStartWithAssembly(chromInfo),\n    chrPosUrlEncoder\n  );\n\nexport const useXDomainEndWithAssembly = (chromInfo) =>\n  useRecoilQueryString(\n    'e',\n    xDomainEndWithAssembly(chromInfo),\n    chrPosUrlEncoder\n  );\nexport const useXDomainEndWithAssemblySyncher = (chromInfo) =>\n  useRecoilQueryStringSyncher(\n    'e',\n    xDomainEndWithAssembly(chromInfo),\n    chrPosUrlEncoder\n  );\n\nexport const useEnhancerRegionsShowInfos = () =>\n  useRecoilQueryString('eri', enhancerRegionsShowInfoState);\nexport const useEnhancerRegionsShowInfosSyncher = () =>\n  useRecoilQueryStringSyncher('eri', enhancerRegionsShowInfoState);\n\nexport const useEnhancerRegionsHideUnfocused = () =>\n  useRecoilQueryString('eri', enhancerRegionsHideUnfocusedState);\nexport const useEnhancerRegionsHideUnfocusedSyncher = () =>\n  useRecoilQueryStringSyncher('eri', enhancerRegionsHideUnfocusedState);\n\nexport const useEnhancerRegionsColorEncoding = () =>\n  useRecoilQueryString('eri', enhancerRegionsColorEncodingState);\nexport const useEnhancerRegionsColorEncodingSyncher = () =>\n  useRecoilQueryStringSyncher('eri', enhancerRegionsColorEncodingState);\n\nexport const useEnhancerGenesShowInfos = () =>\n  useRecoilQueryString('egi', enhancerGenesShowInfoState);\nexport const useEnhancerGenesShowInfosSyncher = () =>\n  useRecoilQueryStringSyncher('egi', enhancerGenesShowInfoState);\n\nexport const useEnhancerGenesPadding = () =>\n  useRecoilQueryString('egp', enhancerGenesPaddingState);\nexport const useEnhancerGenesPaddingSyncher = () =>\n  useRecoilQueryStringSyncher('egp', enhancerGenesPaddingState);\n\nexport const useEnhancerGenesCellEncoding = () =>\n  useRecoilQueryString('egce', enhancerGenesCellEncodingState);\nexport const useEnhancerGenesCellEncodingSyncher = () =>\n  useRecoilQueryStringSyncher('egce', enhancerGenesCellEncodingState);\n\nexport const useVariantYScale = () =>\n  useRecoilQueryString('vs', variantYScaleState);\nexport const useVariantYScaleSyncher = () =>\n  useRecoilQueryStringSyncher('vs', variantYScaleState);\n","import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { useRecoilState } from 'recoil';\nimport { deepClone, isString } from '@flekschas/utils';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport TextField from '@material-ui/core/TextField';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport FileInput from './FileInput';\nimport { useChromInfo } from './ChromInfoProvider';\nimport createLocalBedDataServer from './local-bed-data-server';\n\nimport {\n  focusRegionOptionState,\n  useFocusRegion,\n  useVariantTracks,\n} from './state';\n\nimport { LOCAL_BED_TILESET_INFO_HG19 } from './constants';\n\nimport { chrRangePosEncoder } from './utils';\n\nconst useStyles = makeStyles((theme) => ({\n  note: {\n    color: theme.palette.grey['400'],\n    marginTop: '1em',\n  },\n  title: {\n    fontSize: '1.5rem',\n    fontWeight: 700,\n    margin: '0.5rem 0 0 0',\n  },\n  buttonNormal: {\n    minWidth: '10.5rem',\n    margin: '0 0.5rem',\n  },\n  buttonActive: {\n    minWidth: '10.5rem',\n    marginLeft: '0.5rem',\n    color: 'white',\n    background: '#cc0078 linear-gradient(45deg, #cc0078 30%, #cc0066 90%)',\n    boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .3)',\n    '&:hover': {\n      boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .5)',\n      background: '#d90080 linear-gradient(45deg, #d90080 30%, #d9006c 90%)',\n    },\n    '&:focus': {\n      boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .5)',\n    },\n  },\n  trackList: {\n    margin: '16px 0',\n  },\n}));\n\nconst useStylesTrackConfig = makeStyles((theme) => ({\n  icon: {\n    color: theme.palette.grey['400'],\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  grow: {\n    flex: 1,\n  },\n  separator: {\n    padding: '0 8px',\n  },\n  server: {\n    flex: 1,\n    marginRight: '2px',\n  },\n  tilesetUid: {\n    flex: 1,\n    marginLeft: '2px',\n  },\n  propInput: {\n    flex: 1,\n    marginLeft: '2px',\n    marginRight: '2px',\n    '&:first-child': {\n      marginLeft: 0,\n    },\n    '&:last-child': {\n      marginRight: 0,\n    },\n  },\n}));\n\nconst useStylesTooltipVisible = makeStyles((theme) => ({\n  arrow: {\n    color: 'black',\n  },\n  tooltip: {\n    backgroundColor: 'black',\n  },\n}));\n\nconst useStylesTooltipHidden = makeStyles((theme) => ({\n  tooltip: {\n    display: 'none',\n  },\n}));\n\nconst TrackConfig = React.memo(function TrackConfig({ config, onChange }) {\n  const [state, setState] = useState(config);\n\n  const propertyChangeHandler = (property) => (event) => {\n    // eslint-disable-next-line prefer-destructuring\n    const value = event.target.value;\n    setState((currState) => ({\n      ...currState,\n      [property]: value,\n    }));\n  };\n\n  const serverChangeHandler = (event) => {\n    const server = event.target.value;\n    setState((currState) => ({\n      ...currState,\n      server,\n      file: undefined,\n    }));\n  };\n\n  const tilesetUidChangeHandler = (event) => {\n    const tilesetUid = event.target.value;\n    setState((currState) => ({\n      ...currState,\n      tilesetUid,\n      file: undefined,\n    }));\n  };\n\n  const fileChangeHandler = (file) => {\n    setState((currState) => ({\n      ...currState,\n      file,\n      server: undefined,\n      tilesetUid: undefined,\n    }));\n  };\n\n  const fileClearHandler = () => {\n    setState((currState) => ({\n      ...currState,\n      file: undefined,\n    }));\n  };\n\n  useEffect(() => {\n    if (state !== config) onChange(state);\n  }, [onChange, state, config]);\n\n  const isRemote = Boolean(state.server || state.tilesetUid);\n  const isLocal = Boolean(state.whatever);\n\n  const classes = useStylesTrackConfig();\n  const classesTooltipVisible = useStylesTooltipVisible();\n  const classesTooltipHidden = useStylesTooltipHidden();\n\n  return (\n    <React.Fragment>\n      <Grid alignItems=\"center\" container>\n        <Grid className={classes.grow} item>\n          <Grid alignItems=\"center\" container>\n            <Tooltip\n              classes={isLocal ? classesTooltipVisible : classesTooltipHidden}\n              title=\"Setting a server will clear the file!\"\n              placement=\"top\"\n              arrow\n            >\n              <TextField\n                label=\"Server URL\"\n                variant=\"outlined\"\n                size=\"small\"\n                value={state.server || ''}\n                onChange={serverChangeHandler}\n                className={classes.server}\n              />\n            </Tooltip>\n            <Tooltip\n              classes={isLocal ? classesTooltipVisible : classesTooltipHidden}\n              title=\"Setting a tileset ID will clear the file!\"\n              placement=\"top\"\n              arrow\n            >\n              <TextField\n                label=\"Tileset ID\"\n                variant=\"outlined\"\n                size=\"small\"\n                value={state.tilesetUid || ''}\n                onChange={tilesetUidChangeHandler}\n                className={classes.tilesetUid}\n              />\n            </Tooltip>\n          </Grid>\n        </Grid>\n        <Grid item>\n          <Typography className={classes.separator}>or</Typography>\n        </Grid>\n        <Grid item>\n          <Tooltip\n            classes={isRemote ? classesTooltipVisible : classesTooltipHidden}\n            title=\"Selecting a file will clear the server and tileset ID!\"\n            placement=\"top\"\n            arrow\n          >\n            <FileInput\n              file={state.file}\n              onChange={fileChangeHandler}\n              onClear={fileClearHandler}\n            />\n          </Tooltip>\n        </Grid>\n      </Grid>\n      <Grid alignItems=\"center\" container>\n        <TextField\n          label=\"Name\"\n          variant=\"outlined\"\n          margin=\"normal\"\n          size=\"small\"\n          value={state.label || ''}\n          onChange={propertyChangeHandler('label')}\n          className={classes.propInput}\n        />\n        <TextField\n          label=\"Column P-Value\"\n          variant=\"outlined\"\n          margin=\"normal\"\n          size=\"small\"\n          type=\"number\"\n          min=\"1\"\n          step=\"1\"\n          value={state.columnPvalue || 7}\n          onChange={propertyChangeHandler('columnPvalue')}\n          className={classes.propInput}\n        />\n        <TextField\n          label=\"Column Post. Prob\"\n          variant=\"outlined\"\n          margin=\"normal\"\n          size=\"small\"\n          type=\"number\"\n          min=\"1\"\n          step=\"1\"\n          value={state.columnPosteriorProbability || 8}\n          onChange={propertyChangeHandler('columnPosteriorProbability')}\n          className={classes.propInput}\n        />\n      </Grid>\n    </React.Fragment>\n  );\n});\n\nconst VariantsSettings = React.memo(function VariantsSettings({\n  closeHandler,\n}) {\n  const chromInfo = useChromInfo();\n\n  const setFocusRegion = useFocusRegion()[1];\n  const [variantTracks, setVariantTracks] = useVariantTracks();\n\n  const [focusRegionOption, setFocusRegionOption] = useRecoilState(\n    focusRegionOptionState\n  );\n\n  const [tmpVariantTracks, setTmpVariantTracks] = useState(() =>\n    deepClone(variantTracks)\n  );\n  const [changed, setChanged] = useState(false);\n  const variantTrackServers = useRef([]);\n  const currVariantTracks = useRef(variantTracks);\n\n  useEffect(() => {\n    currVariantTracks.current = variantTracks;\n  }, [variantTracks]);\n\n  const changeTmpVariantTracks = useCallback(\n    (i) => (newTrackConfig) => {\n      setTmpVariantTracks((currTmpVariantTracks) => {\n        const newTmpVariantTracks = [...currTmpVariantTracks];\n        newTmpVariantTracks[i] = newTrackConfig;\n        return newTmpVariantTracks;\n      });\n      setChanged(true);\n    },\n    []\n  );\n\n  const saveHandler = useCallback(() => {\n    const newVariantTracks = deepClone(tmpVariantTracks);\n\n    // Destroy old servers\n    variantTrackServers.current.forEach((server) => {\n      server.destroy();\n    });\n\n    // Create new servers\n    variantTrackServers.current = newVariantTracks.reduce(\n      (servers, trackConfig) => {\n        if (trackConfig.file) {\n          const tilesetInfo = {\n            ...LOCAL_BED_TILESET_INFO_HG19,\n            name: trackConfig.file,\n          };\n          servers.push(\n            createLocalBedDataServer(\n              trackConfig.file,\n              trackConfig.file.name,\n              chromInfo,\n              tilesetInfo,\n              {\n                header: true,\n                columnImportance: 7,\n              }\n            )\n          );\n        }\n        return servers;\n      },\n      []\n    );\n    setVariantTracks(newVariantTracks);\n    if (\n      newVariantTracks.some(\n        (newTrackConfig, i) =>\n          newTrackConfig.server !== currVariantTracks.current[i].server\n      ) ||\n      newVariantTracks.some(\n        (newTrackConfig, i) =>\n          newTrackConfig.tilesetUid !== currVariantTracks.current[i].tilesetUid\n      ) ||\n      newVariantTracks.some(\n        (newTrackConfig, i) =>\n          newTrackConfig.file !== currVariantTracks.current[i].file\n      )\n    ) {\n      setFocusRegion((currFocusRegion) => {\n        if (isString(currFocusRegion)) {\n          return [\n            `${focusRegionOption.chrStart}:${focusRegionOption.txStart}`,\n            `${focusRegionOption.chrEnd}:${focusRegionOption.txEnd}`,\n          ];\n        }\n        return currFocusRegion;\n      });\n      setFocusRegionOption((currFocusRegionOption) => {\n        if (currFocusRegionOption.chr) {\n          return {\n            chrStart: currFocusRegionOption.chr,\n            chrEnd: currFocusRegionOption.chr,\n            txStart: currFocusRegionOption.txStart,\n            txEnd: currFocusRegionOption.txEnd,\n            geneName: chrRangePosEncoder([\n              `${currFocusRegionOption.chr}:${currFocusRegionOption.txStart}`,\n              `${currFocusRegionOption.chr}:${currFocusRegionOption.txEnd}`,\n            ]),\n            type: 'region',\n          };\n        }\n        return currFocusRegionOption;\n      });\n    }\n    closeHandler();\n  }, [\n    chromInfo,\n    tmpVariantTracks,\n    closeHandler,\n    focusRegionOption,\n    setVariantTracks,\n    setFocusRegion,\n    setFocusRegionOption,\n  ]);\n\n  const classes = useStyles();\n\n  return (\n    <React.Fragment>\n      <Typography\n        id=\"title\"\n        align=\"center\"\n        variant=\"h5\"\n        component=\"h2\"\n        noWrap\n        className={classes.title}\n      >\n        Variant Track\n      </Typography>\n      <p id=\"description\">\n        Variants can be loaded from a remote{' '}\n        <code>\n          <a\n            href=\"https://docs.higlass.io/data_preparation.html#bed-files\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            .beddb\n          </a>\n        </code>{' '}\n        or a local <code>.bed</code> file. To access a remote file, please enter\n        the URL of the{' '}\n        <a\n          href=\"https://docs.higlass.io/higlass_server.html\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          HiGlass server\n        </a>{' '}\n        and the track ID. To access a local file please select it with via the\n        file selection.\n      </p>\n      <div className={classes.trackList}>\n        {tmpVariantTracks.map((variantTrackConfig, i) => (\n          <TrackConfig\n            key={i}\n            config={variantTrackConfig}\n            onChange={changeTmpVariantTracks(i)}\n          />\n        ))}\n      </div>\n      <Typography align=\"center\">\n        <Button\n          className={classes.buttonNormal}\n          onClick={closeHandler}\n          variant=\"contained\"\n          disableElevation\n        >\n          Cancel\n        </Button>\n        <Button\n          className={changed ? classes.buttonActive : classes.buttonNormal}\n          onClick={changed ? saveHandler : closeHandler}\n          variant=\"contained\"\n          disableElevation\n        >\n          {changed ? 'Save' : 'Okay'}\n        </Button>\n      </Typography>\n    </React.Fragment>\n  );\n});\n\nexport default VariantsSettings;\n","import Button from '@material-ui/core/Button';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\nimport React from 'react';\nimport { useRecoilValue } from 'recoil';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport Logo from './Logo';\n\nimport { showWelcomeState } from './state';\n\nimport imgEnhancerView1 from './images/enhancer-view-1.png';\nimport imgEnhancerView2 from './images/enhancer-view-2.png';\nimport imgEnhancerView3 from './images/enhancer-view-3.png';\nimport imgEnhancerView4 from './images/enhancer-view-4.png';\nimport imgEnhancerView5 from './images/enhancer-view-5.png';\nimport imgGeneView1 from './images/gene-view-1.png';\nimport imgGeneView2 from './images/gene-view-2.png';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    '&>p': {\n      fontSize: '1.125em',\n    },\n  },\n  title: {\n    display: 'flex',\n    justifyContent: 'center',\n    margin: theme.spacing(2, 0, 3),\n  },\n  note: {\n    color: theme.palette.grey['400'],\n    marginTop: '1em',\n  },\n  icon: {\n    color: theme.palette.grey['400'],\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  showIntro: {\n    minWidth: '10.5rem',\n    marginRight: '0.5rem',\n  },\n  startExploring: {\n    minWidth: '10.5rem',\n    marginLeft: '0.5rem',\n    color: 'white',\n    background: '#cc0078 linear-gradient(45deg, #cc0078 30%, #cc0066 90%)',\n    boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .3)',\n    '&:hover': {\n      boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .5)',\n      background: '#d90080 linear-gradient(45deg, #d90080 30%, #d9006c 90%)',\n    },\n    '&:focus': {\n      boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .5)',\n    },\n  },\n  introTitle: {\n    fontSize: '2.75em',\n    letterSpacing: '-0.075rem',\n    fontWeight: 900,\n    textTransform: 'uppercase',\n    '&+h3': {\n      marginTop: 16,\n    },\n  },\n  introHeadline: {\n    fontSize: '1.5em',\n    fontWeight: 700,\n    margin: theme.spacing(6, 0, 2, 0),\n  },\n  introSubHeadline: {\n    fontSize: '1.125em',\n    fontWeight: 700,\n    margin: theme.spacing(2, 0, 1, 0),\n  },\n  introStartExploring: {\n    margin: theme.spacing(4, 0, 2, 0),\n  },\n  figure: {\n    margin: theme.spacing(4, 6),\n    '& img': {\n      width: '100%',\n      height: 'auto',\n    },\n  },\n}));\n\nconst Welcome = React.memo(function Welcome({\n  closeHandler,\n  openIntroHandler,\n  closeIntroHandler,\n}) {\n  const showWelcome = useRecoilValue(showWelcomeState);\n\n  const classes = useStyles();\n\n  if (showWelcome === 'intro')\n    return (\n      <div className={classes.root}>\n        <Typography\n          id=\"intro-title\"\n          align=\"center\"\n          variant=\"h2\"\n          component=\"h2\"\n          noWrap\n          className={classes.introTitle}\n        >\n          Introduction\n        </Typography>\n        <Typography\n          id=\"intro-enhancer-view\"\n          align=\"center\"\n          variant=\"h3\"\n          component=\"h3\"\n          noWrap\n          className={classes.introHeadline}\n        >\n          1. Enhancer-Centered View\n        </Typography>\n        <p>\n          The goal of this web application is to provide a visual interface to\n          enhancer-gene connections predicted by the{' '}\n          <em>Activity-By-Contact</em> (ABC) model. Enhancers are genomic\n          regions that have the ability to regulate the activity of nearby\n          genes. One way to visualize this regulatory connection is by drawing\n          an arc between the enhancer region and the gene as follows:\n        </p>\n        <figure className={classes.figure}>\n          <img src={imgEnhancerView1} alt=\"Enhancer-Gene Connection Overview\" />\n        </figure>\n        <p>\n          However, enhancers are not always active in every cell type or state.\n          Hence, in reality the looks more like below where <em>Enhancer 1</em>{' '}\n          is entirely inactive in <em>Sample 1</em> while <em>Sample 2</em> is\n          inactive in <em>Sample 3</em>.\n        </p>\n        <figure className={classes.figure}>\n          <img\n            src={imgEnhancerView2}\n            alt=\"Enhancer-Gene Connection By Sample\"\n          />\n        </figure>\n        <p>\n          Since we have predicted enhancer-gene connections across 131 samples,\n          showing all arcs at once or having a separate arc track for each\n          sample is not very effective visually. In other words, it would either\n          be hard to differentiate samples in case we show all arcs in one track\n          or it would be impossible to get a complete overview due the vertical\n          space consumption if we showed a separate arc track for each sample.\n        </p>\n        <p>\n          Therefore, we separately visualize the distribution of outgoing and\n          incoming arcs as shown below. Each sample is represented by a row and\n          an active enhancer region (outgoing arc) is displayed as a rectangle.\n          For the regulated genes, we are drawing a bar that encodes the number\n          of enhancers (i.e., incoming arcs) regulating this gene as the height.\n        </p>\n        <figure className={classes.figure}>\n          <img\n            src={imgEnhancerView3}\n            alt=\"Optimized Enhancer-Gene Connection Representation\"\n          />\n        </figure>\n        <p>\n          While we loose some details (no worries, we will bring those details\n          back), this representation is visually much more scalable. To make\n          this visualization more effective we can sort similar samples into\n          groups and add color to help distinguish between the different sample\n          groups.\n        </p>\n        <figure className={classes.figure}>\n          <img\n            src={imgEnhancerView4}\n            alt=\"Sample-Grouped Enhancer-Gene Connection Representation\"\n          />\n        </figure>\n        <p>\n          As mentioned above, by separetly visualizing the distribution of\n          enhancer regions and the distribution of sample groups regulating\n          genes, we are loosing the information which enhancer region regulates\n          which gene. We're going to bring this information back by allowing you\n          to focus on specific regions and sample groups. For instance, in the\n          following example we focused on <em>Gene 2</em>, which will\n          subsequently highlight all enhancers regulating this gene (shown in\n          pink) and also bring back the arcs to hint at enhancers outside the\n          current field of view.\n        </p>\n        <figure className={classes.figure}>\n          <img\n            src={imgEnhancerView5}\n            alt=\"Focused Enhancer-Gene Connection Representation\"\n          />\n        </figure>\n        <p>\n          In the application there are two ways to enable focusing. First, you\n          can click on one of the following visual elements: a gene, a variant,\n          or an enhancer region. To select a custom focus region you can also\n          brush on the genomic position track. Second, you can search for and\n          enter a gene (e.g., PPIF), variant (e.g., rs1250566), or custom region\n          (e.g., chr1:1-chr2:2, chr10:81230693-80993117, or\n          chr10:81230693+10000) in the search bar at the top.\n        </p>\n        <Typography\n          id=\"intro-enhancer-view-sample-filtering\"\n          align=\"center\"\n          variant=\"h4\"\n          component=\"h4\"\n          noWrap\n          className={classes.introSubHeadline}\n        >\n          Sample Filtering\n        </Typography>\n        <p>\n          In addition to focusing on certain enhancer-gene connections, you can\n          also filter out samples using the list on the side bar. Note that the\n          filtering will be applied to all visualizations including the\n          Gene-Centered View and the DNA Accessibility View.\n        </p>\n        <Typography\n          id=\"intro-enhancer-view-genetic-variations\"\n          align=\"center\"\n          variant=\"h4\"\n          component=\"h4\"\n          noWrap\n          className={classes.introSubHeadline}\n        >\n          Custom Genetic Variations\n        </Typography>\n        <p>\n          To identify critical enhancers, our application includes a track for\n          displaying genetic point variations, e.g., disease risk variants.\n          These variants are visualized as points that are position either by\n          their associated p-value or posterior probability along the y-axis. By\n          default, we show <abbr title=\"\">IBD</abbr>\n          -associated variants but you can load your variants if you like by\n          clicking on <em>Edit Variants</em> in the side bar. There are two\n          options for loading custom variants. You can either specify the URL of\n          a{' '}\n          <a\n            href=\"https://docs.higlass.io/higlass_server.html\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            HiGlass server\n          </a>{' '}\n          (which is the underlying genome browser toolkit we are using) and\n          tileset UUID of your{' '}\n          <a\n            href=\"https://docs.higlass.io/data_preparation.html#bed-files\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            <code>.beddb</code> track\n          </a>\n          . Or you can load a local\n          <a\n            href=\"https://bedtools.readthedocs.io/en/latest/content/general-usage.html#bed-format\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            <code>.bed</code> file\n          </a>{' '}\n          from your computer. Make sure to specify the correct column number for\n          the p-value and posterior probability!\n        </p>\n        <p>\n          <strong>Experimental:</strong> If you want to share a view with a\n          custom variant track with your colleagues can either setup your own\n          HiGlass server or you can use{' '}\n          <a href=\"https://resgen.io\" target=\"_blank\" rel=\"noopener noreferrer\">\n            Resgen.io\n          </a>\n          &mdash;a service for hosting and visualizing genomic data.\n        </p>\n        <Typography\n          id=\"intro-enhancer-view-settings\"\n          align=\"center\"\n          variant=\"h4\"\n          component=\"h4\"\n          noWrap\n          className={classes.introSubHeadline}\n        >\n          Settings\n        </Typography>\n        <p>\n          Finally, you can adjust the color encoding of the rectangles\n          representing enhancer regions via the settings menu (click on{' '}\n          <IconButton size=\"small\" className={classes.icon}>\n            <SettingsIcon fontSize=\"inherit\" />\n          </IconButton>\n          ). By default (<em>Solid</em>) we render rectangles in a solid color\n          whenever a region is predicted to regulate at least one gene.\n          Alternatively you can choose to encode number of regulated genes as\n          the color (<em>Number of predictions</em>). In this case, darker\n          rectangles hint at enhancers that regulate many genes. Additionally,\n          you can also color rectangles by the highest ABC prediction score (\n          <em>Highest prediction score</em>) or the ABC prediction score of the\n          connection to the closest gene (<em>Closest prediction score</em>).\n        </p>\n        <Typography\n          id=\"intro-gene-view\"\n          align=\"center\"\n          variant=\"h3\"\n          component=\"h3\"\n          noWrap\n          className={classes.introHeadline}\n        >\n          2. Gene-Centered View\n        </Typography>\n        <p>\n          Sometimes it can be insightful to gain an overview of all upstream and\n          downstream genes that are regulated by a specific enhancer region.\n          That's what this view is for. In the tabular layout, each row\n          corresponds to a sample group and the columns represent the genes\n          ordered by distance to the enhancer region, which is shown as the\n          center column. Hence, genes to the left are upstream of the enhancer\n          and genes to the right are downstream. The number of genes/columns is\n          limited by the available screen space. For instance, consider the\n          following situation, where the numbers in the cells indicate the\n          number of enhancer-gene connections across the three sample groups.\n        </p>\n        <figure className={classes.figure}>\n          <img src={imgGeneView1} alt=\"Gene-Centered View Setup\" />\n        </figure>\n        <p>\n          To make this view more effective, the cells encode the percentage of\n          samples within a sample group that contain a predicted enhancer-gene\n          connection as the rectangle area.\n        </p>\n        <figure className={classes.figure}>\n          <img src={imgGeneView2} alt=\"Gene-Centered View Visualization\" />\n        </figure>\n        <p>\n          For instance, in the example above, <em>Group A&mdash;Gene 2</em> is\n          the largest rectangle because three out of four sample from{' '}\n          <em>Group A</em> regulate <em>Gene 2</em>. On the other hand,{' '}\n          <em>Group C&mdash;Gene 3</em> is the smallest rectangle because only\n          one out of 5 samples from <em>Group C</em> regulate <em>Gene 3</em>.\n        </p>\n        <p>\n          For more detais on which exact sample contains a prediction you can\n          mouse over a cell.\n        </p>\n        <Typography\n          id=\"intro-gene-view-settings\"\n          align=\"center\"\n          variant=\"h4\"\n          component=\"h4\"\n          noWrap\n          className={classes.introSubHeadline}\n        >\n          Settings\n        </Typography>\n        <p>\n          This view offers a couple of additional cell encoding to provide\n          different perspectives of the gene regulation landscape of a specific\n          enhancer. The rectangle size can also encode the absolute number of\n          predicted enhancer-gene connections by sample group (\n          <em>Abs. number of predictions</em>).\n        </p>\n        <p>\n          Additionally, you can look at the distribution of enhancer-gene\n          connections by their ABC prediction score as a{' '}\n          <a\n            href=\"https://flowingdata.com/2016/09/08/beeswarm-plot-in-r-to-show-distributions/\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            bee swarm plot\n          </a>\n          (<em>Distribution by prediction score</em>). With this setting, each\n          enhancer-gene connection is represented as a small dot and positioned\n          on the cell's y-axis by it's ABC prediction score. The closer the dot\n          is placed to the top of the cell the higher the prediction score. The\n          dots' x position is determined by the number of other dots with a\n          similar prediction score. In other words the more dots stack along a\n          cell's x-axis the more enhancer-gene Connections have the same\n          prediction score.\n        </p>\n        <p>\n          The final visual encoding (<em>Sample array</em>) visualizes\n          enhancer-gene connections as filled cells within an invisible grid\n          where each sample has a fixed position across all genes. Think of a\n          microarray or well plate where each sample allocates a fixed well and\n          lights up when this samples contains a enhancer-gene connection. The\n          benefit of this encoding is that it allows you to quickly scan cross a\n          row to see of the focused enhancer is regulating other genes in the\n          same sample. You can even mouse over a well in the array view and it\n          highlight the well across the entire row.\n        </p>\n        <Typography\n          id=\"intro-dna-accessibility-view\"\n          align=\"center\"\n          variant=\"h3\"\n          component=\"h3\"\n          noWrap\n          className={classes.introHeadline}\n        >\n          3. DNA Accessibility View\n        </Typography>\n        <p>\n          Since the ABC model relies on the DNaseI hypersensitivy, we provide\n          an accompanying view of the DNA accessibility across all samples for\n          quick visual debugging of predicted enhancer regions. The DNase- or\n          ATAC-seq measurements, are visualized as a vertically-stacked list of\n          line charts. Each row corresponds to a sample and the order of samples\n          is the same as in the <em>Enhancer-Centered View</em>. By default,\n          each row is individually normalized to focus on shape similarities\n          rather than the absolute magnitude (i.e., read count). This behavior\n          can be adjusted view the settings.\n        </p>\n        <Typography align=\"center\" className={classes.introStartExploring}>\n          <Button\n            className={classes.showIntro}\n            onClick={closeIntroHandler}\n            variant=\"contained\"\n            disableElevation\n          >\n            Back\n          </Button>\n          <Button\n            className={classes.startExploring}\n            onClick={closeHandler}\n            variant=\"contained\"\n            disableElevation\n          >\n            Start Exploring!\n          </Button>\n        </Typography>\n        <Typography align=\"center\" className={classes.note}>\n          <em>\n            You can reopen this tutorial by clicking on \"ABC Enhancer-Gene\n            Connections\" in the upper left corner!\n          </em>\n        </Typography>\n      </div>\n    );\n\n  return (\n    <div className={classes.root}>\n      <Typography\n        id=\"title\"\n        align=\"center\"\n        variant=\"h5\"\n        component=\"h2\"\n        noWrap\n        className={classes.title}\n      >\n        <Logo\n          styles={{\n            width: 'auto',\n          }}\n        />\n      </Typography>\n      <p id=\"description\">\n        This web application visualizes genome-wide enhancer-gene connections\n        predicted with the <em>Activity-By-Contact</em> (ABC) model. You can\n        interactively browse the entire human genome (hg19), filter enhancers by\n        region, gene, or sample, and link enhancers to genetic risk variants.\n      </p>\n      <p>\n        For more background information please refer to our publication:{' '}\n        <a\n          href=\"https://www.nature.com/articles/s41586-021-03446-x\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          Nasser et al., Genome-wide enhancer maps link risk variants to disease\n          genes, <em>Nature</em> (2021)\n        </a>\n        .\n      </p>\n      <p>\n        For more information about the visualizations, please click on{' '}\n        <em>Show Introduction</em>. If you find a bug or have ideas for\n        improvements, please don't hesitate{' '}\n        <a\n          href=\"https://github.com/flekschas/enhancer-gene-vis/issues\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          open an issue on GitHub\n        </a>{' '}\n        or ping{' '}\n        <a\n          href=\"https://twitter.com/flekschas/\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          @flekschas\n        </a>\n        .\n      </p>\n      <Typography align=\"center\">\n        <Button\n          className={classes.showIntro}\n          onClick={openIntroHandler}\n          variant=\"contained\"\n          disableElevation\n        >\n          Show Introduction\n        </Button>\n        <Button\n          className={classes.startExploring}\n          onClick={closeHandler}\n          variant=\"contained\"\n          disableElevation\n        >\n          Start Exploring!\n        </Button>\n      </Typography>\n    </div>\n  );\n});\n\nexport default Welcome;\n","import React, { createContext, useCallback, useState } from 'react';\nimport Backdrop from '@material-ui/core/Backdrop';\nimport Fade from '@material-ui/core/Fade';\nimport Modal from '@material-ui/core/Modal';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst ModalContext = createContext();\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: '4rem',\n  },\n  paper: {\n    backgroundColor: theme.palette.background.paper,\n    borderRadius: '0.25rem',\n    boxShadow: theme.shadows[4],\n    maxWidth: '60rem',\n    maxHeight: 'calc(100vh - 8rem)',\n    overflow: 'auto',\n    padding: theme.spacing(2, 4),\n    outline: 0,\n  },\n}));\n\nexport default function ModalProvider({ children }) {\n  const [Component, setComponent] = useState(null);\n  const [customCloseHandler, setCustomCloseHandler] = useState(null);\n  const [customProps, setCustomProps] = useState(null);\n\n  const showModal = useCallback(\n    (\n      newComponent = null,\n      newCustomCloseHandler = null,\n      newCustomProps = {}\n    ) => {\n      setComponent(newComponent);\n      setCustomCloseHandler(() => newCustomCloseHandler);\n      setCustomProps(newCustomProps);\n    },\n    []\n  );\n\n  const closeHandler = useCallback(() => {\n    setComponent(null);\n    setCustomCloseHandler(null);\n  }, []);\n\n  const classes = useStyles();\n\n  const open = Boolean(Component);\n\n  return (\n    <ModalContext.Provider value={showModal}>\n      {children}\n      <Modal\n        aria-labelledby=\"modal-title\"\n        aria-describedby=\"modal-description\"\n        className={classes.root}\n        open={open}\n        onClose={customCloseHandler || closeHandler}\n        closeAfterTransition\n        BackdropComponent={Backdrop}\n        BackdropProps={{\n          timeout: 250,\n        }}\n      >\n        <Fade in={open}>\n          <div className={classes.paper}>\n            {open && (\n              <Component\n                {...customProps}\n                closeHandler={customCloseHandler || closeHandler}\n              />\n            )}\n          </div>\n        </Fade>\n      </Modal>\n    </ModalContext.Provider>\n  );\n}\n\nfunction useShowModal() {\n  const context = React.useContext(ModalContext);\n  if (context === undefined) {\n    throw new Error('useShowModal must be used within a ModalContext');\n  }\n  return context;\n}\n\nexport { useShowModal };\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useRecoilState, useRecoilValue } from 'recoil';\nimport { isString, nthIndexOf } from '@flekschas/utils';\n\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport Divider from '@material-ui/core/Divider';\nimport Drawer from '@material-ui/core/Drawer';\nimport FormControl from '@material-ui/core/FormControl';\nimport Grid from '@material-ui/core/Grid';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\nimport ButtonBase from '@material-ui/core/ButtonBase';\nimport { makeStyles } from '@material-ui/core/styles';\nimport SettingsIcon from '@material-ui/icons/Settings';\n\nimport CheckboxList from './CheckboxList';\nimport Logo from './Logo';\nimport VariantsSettings from './VariantsSettings';\nimport Welcome from './Welcome';\nimport { useChromInfo } from './ChromInfoProvider';\nimport { useShowModal } from './ModalProvider';\n\nimport {\n  enhancerGenesSvgState,\n  higlassEnhancerRegionsState,\n  higlassDnaAccessState,\n  sampleFilterState,\n  sampleWithName,\n  sampleGroupWithGroup,\n  showVariantsSettingsState,\n  useXDomainStartWithAssembly,\n  useXDomainEndWithAssembly,\n  useShowWelcome,\n} from './state';\n\nimport { download, stringifySvg } from './utils';\n\nimport {\n  DEFAULT_COLOR_MAP_DARK,\n  DEFAULT_COLOR_MAP,\n  DEFAULT_VIEW_CONFIG_ENHANCER,\n  DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY,\n  SVG_SKELETON,\n  DRAWER_WIDTH,\n  GROUPED_SAMPLE_OPTIONS,\n  SAMPLE_TO_GROUP,\n} from './constants';\n\nconst useStyles = makeStyles((theme) => ({\n  h1: {\n    height: '100%',\n    margin: '0',\n    padding: '0',\n    fontSize: '1rem',\n    lineHeight: '1rem',\n    fontWeight: 'bold',\n  },\n  drawer: {\n    width: DRAWER_WIDTH,\n    flexShrink: 0,\n  },\n  drawerGrid: {\n    height: '100%',\n  },\n  drawerPaper: {\n    width: DRAWER_WIDTH,\n  },\n  settings: {\n    position: 'relative',\n    flexGrow: 1,\n  },\n  globalSettingsTitle: {\n    padding: '3px 8px 4px 8px',\n    margin: 0,\n    '& h6': {\n      fontSize: '0.8rem',\n      fontWeight: 'bold',\n    },\n  },\n  settingsContent: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    overflow: 'hidden auto',\n  },\n  toolbar: theme.mixins.toolbar,\n  grow: {\n    flexGrow: 1,\n  },\n  titleBar: {\n    position: 'relative',\n    padding: '2px',\n    fontSize: '0.8rem',\n    background: theme.palette.grey['100'],\n  },\n  titleBarText: {\n    fontSize: '0.8rem',\n  },\n  titleBarContainer: {\n    width: 'auto',\n  },\n  titleBarTitle: {\n    padding: '0 2px',\n    fontWeight: 900,\n  },\n  titleBarIcon: {\n    color: theme.palette.grey['400'],\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  titleBarIconActive: {\n    color: 'black',\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  globalSettingsFirstBox: {\n    margin: theme.spacing(0, 1, 1, 1),\n  },\n}));\n\nconst extractCoreFromHiGlassSvg = (svg) => {\n  const fifthLn = nthIndexOf(svg, '\\n', 4);\n  const lastLn = svg.lastIndexOf('\\n');\n  const width = +svg.substring(\n    svg.indexOf('width=\"') + 7,\n    svg.indexOf('px', svg.indexOf('width=\"') + 7)\n  );\n  const height = +svg.substring(\n    svg.indexOf('height=\"') + 8,\n    svg.indexOf('px', svg.indexOf('height=\"') + 8)\n  );\n  return {\n    core: svg.substring(fifthLn + 1, lastLn),\n    width,\n    height,\n  };\n};\n\nconst extractCoreFromStringifiedSvg = (svg) => {\n  const firstSvgClosingBracket = svg.indexOf('>');\n  const lastSvgOpeningBracket = svg.lastIndexOf('</svg>');\n  const [width, height] = svg\n    .substring(\n      svg.indexOf('viewbox=\"') + 9,\n      svg.indexOf('\"', svg.indexOf('viewbox=\"') + 9)\n    )\n    .split(' ')\n    .slice(2);\n  return {\n    core: svg.substring(firstSvgClosingBracket + 1, lastSvgOpeningBracket),\n    width: +width,\n    height: +height,\n  };\n};\n\nconst AppSidebar = React.memo(function AppSidebar() {\n  const chromInfo = useChromInfo();\n  const showModal = useShowModal();\n\n  const [xDomainStart, setXDomainStart] = useXDomainStartWithAssembly(\n    chromInfo\n  );\n  const [xDomainEnd, setXDomainEnd] = useXDomainEndWithAssembly(chromInfo);\n  const [showWelcome, setShowWelcome] = useShowWelcome();\n  const [showVariantsSettings, setShowVariantsSettings] = useRecoilState(\n    showVariantsSettingsState\n  );\n\n  const higlassEnhancerRegions = useRecoilValue(higlassEnhancerRegionsState);\n  const higlassDnaAccess = useRecoilValue(higlassDnaAccessState);\n  const enhancerGenesSvg = useRecoilValue(enhancerGenesSvgState);\n\n  const [userChangedDomain, setUserChangedDomain] = useState(0);\n\n  const numericalXDomainStart = useMemo(\n    () =>\n      isString(xDomainStart) && xDomainStart.indexOf(':') >= 0\n        ? chromInfo.chrToAbs([\n            xDomainStart.split(':')[0],\n            +xDomainStart.split(':')[1],\n          ])\n        : +xDomainStart,\n    [xDomainStart, chromInfo]\n  );\n\n  const numericalXDomainEnd = useMemo(\n    () =>\n      isString(xDomainEnd) && xDomainEnd.indexOf(':') >= 0\n        ? chromInfo.chrToAbs([\n            xDomainEnd.split(':')[0],\n            +xDomainEnd.split(':')[1],\n          ])\n        : +xDomainEnd,\n    [xDomainEnd, chromInfo]\n  );\n\n  const xDomainStartChangeHandler = useCallback(\n    (event) => {\n      setXDomainStart(event.target.value);\n      setUserChangedDomain(2);\n    },\n    [setXDomainStart]\n  );\n\n  const xDomainEndChangeHandler = useCallback(\n    (event) => {\n      setXDomainEnd(event.target.value);\n      setUserChangedDomain(2);\n    },\n    [setXDomainEnd]\n  );\n\n  useEffect(() => {\n    setUserChangedDomain((curr) => Math.max(0, curr - 1));\n  }, [xDomainStart, xDomainEnd]);\n\n  const higlassEnhancerZoomToXDomain = (event) => {\n    if (!higlassEnhancerRegions) return;\n\n    const xDomain = [\n      ...higlassEnhancerRegions.getViewConfig().views[0].initialXDomain,\n    ];\n\n    if (!Number.isNaN(+numericalXDomainStart)) {\n      xDomain[0] = numericalXDomainStart;\n    }\n    if (!Number.isNaN(+numericalXDomainEnd)) {\n      xDomain[1] = numericalXDomainEnd;\n    }\n\n    higlassEnhancerRegions.zoomTo(\n      'context',\n      xDomain[0],\n      xDomain[1],\n      xDomain[0],\n      xDomain[1],\n      2000\n    );\n  };\n\n  const closeWelcome = useCallback(() => {\n    setShowWelcome(false);\n  }, [setShowWelcome]);\n\n  const openWelcome = useCallback(() => {\n    setShowWelcome(true);\n  }, [setShowWelcome]);\n\n  const openWelcomeIntro = useCallback(() => {\n    setShowWelcome('intro');\n  }, [setShowWelcome]);\n\n  useEffect(() => {\n    if (showWelcome)\n      showModal(Welcome, closeWelcome, {\n        openIntroHandler: openWelcomeIntro,\n        closeIntroHandler: openWelcome,\n      });\n    else showModal();\n  }, [showWelcome, showModal, closeWelcome, openWelcomeIntro]);\n\n  const closeVariantsSettings = useCallback(() => {\n    setShowVariantsSettings(false);\n  }, [setShowVariantsSettings]);\n\n  const openVariantsSettings = useCallback(() => {\n    setShowVariantsSettings(true);\n  }, [setShowVariantsSettings]);\n\n  useEffect(() => {\n    if (showVariantsSettings) {\n      showModal(VariantsSettings, closeVariantsSettings);\n    } else if (!showWelcome) {\n      showModal();\n    }\n  }, [showWelcome, showVariantsSettings, showModal, closeVariantsSettings]);\n\n  const mergeSvgs = (enhancerSvg, dnaAccessSvg, enhancerGeneSvg) => {\n    const {\n      core: enhancerSvgCore,\n      width: enhancerWidth,\n      height: enhancerHeight,\n    } = extractCoreFromHiGlassSvg(enhancerSvg);\n    const {\n      core: dnaAccessSvgCore,\n      width: dnaAccessWidth,\n      height: dnaAccessHeight,\n    } = extractCoreFromHiGlassSvg(dnaAccessSvg);\n    const {\n      core: enhancerGeneSvgCore = null,\n      height: enhancerGeneHeight = 0,\n    } = enhancerGeneSvg ? extractCoreFromStringifiedSvg(enhancerGeneSvg) : {};\n\n    const actualEnhancerHeight = DEFAULT_VIEW_CONFIG_ENHANCER.views[0].tracks.top.reduce(\n      (height, track) => height + track.height,\n      0\n    );\n    const actualDnaAccessHeight = DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY.views[0].tracks.top.reduce(\n      (height, track) => height + track.height,\n      0\n    );\n    const padding = 24;\n\n    let mergedSvg = SVG_SKELETON;\n    mergedSvg = mergedSvg.replace(\n      '_WIDTH_',\n      enhancerWidth + dnaAccessWidth + padding\n    );\n    mergedSvg = mergedSvg.replace(\n      '_HEIGHT_',\n      Math.max(\n        enhancerHeight + enhancerGeneHeight + padding,\n        dnaAccessHeight,\n        actualEnhancerHeight + enhancerGeneHeight + padding,\n        actualDnaAccessHeight\n      )\n    );\n    mergedSvg = mergedSvg.replace('_ENHANCER_', enhancerSvgCore);\n    mergedSvg = mergedSvg.replace(\n      '_ENHANCER_GENE_Y_',\n      enhancerHeight + padding\n    );\n    mergedSvg = mergedSvg.replace('_ENHANCER_GENE_', enhancerGeneSvgCore);\n    mergedSvg = mergedSvg.replace('_DNA_ACCESS_X_', enhancerWidth + padding);\n    mergedSvg = mergedSvg.replace('_DNA_ACCESS_', dnaAccessSvgCore);\n\n    if (enhancerGeneSvgCore === null) {\n      mergedSvg = mergedSvg.replace('_ENHANCER_GENE_', '');\n    } else {\n      mergedSvg = mergedSvg.replace('_ENHANCER_GENE_', enhancerGeneSvgCore);\n    }\n\n    return mergedSvg;\n  };\n\n  const higlassExportAsSvg = () => {\n    if (!higlassEnhancerRegions || !higlassDnaAccess) {\n      console.warn('One of the HiGlass instances is not available');\n      return;\n    }\n\n    const mergedSvg = mergeSvgs(\n      higlassEnhancerRegions.exportAsSvg(),\n      higlassDnaAccess.exportAsSvg(),\n      enhancerGenesSvg ? stringifySvg(enhancerGenesSvg) : null\n    );\n\n    download(\n      'abc-enhancers.svg',\n      new Blob([mergedSvg], { type: 'image/svg+xml' })\n    );\n  };\n\n  // Run on every render\n  const classes = useStyles();\n\n  return (\n    <Drawer\n      className={classes.drawer}\n      variant=\"permanent\"\n      classes={{\n        paper: classes.drawerPaper,\n      }}\n      anchor=\"left\"\n    >\n      <Grid container direction=\"column\" className={classes.drawerGrid}>\n        <Grid item>\n          <ButtonBase\n            className={classes.toolbar}\n            style={{ width: '100%' }}\n            onClick={openWelcome}\n          >\n            <h1 className={classes.h1}>\n              <Logo />\n            </h1>\n          </ButtonBase>\n          <Divider />\n        </Grid>\n        <Grid container item className={classes.grow} direction=\"column\">\n          <Grid item>\n            <Box m={1}>\n              <Box m={0}>\n                <FormControl variant=\"outlined\" margin=\"dense\" fullWidth>\n                  <InputLabel htmlFor=\"x-domain-start\">Region Start</InputLabel>\n                  <OutlinedInput\n                    id=\"x-domain-start\"\n                    label=\"Region Start\"\n                    onChange={xDomainStartChangeHandler}\n                    value={xDomainStart}\n                  />\n                </FormControl>\n              </Box>\n              <Box m={0}>\n                <FormControl variant=\"outlined\" margin=\"dense\" fullWidth>\n                  <InputLabel htmlFor=\"x-domain-end\">Region End</InputLabel>\n                  <OutlinedInput\n                    id=\"x-domain-end\"\n                    label=\"Region End\"\n                    onChange={xDomainEndChangeHandler}\n                    value={xDomainEnd}\n                  />\n                </FormControl>\n              </Box>\n              {userChangedDomain > 0 && (\n                <Box m={0}>\n                  <Button\n                    variant=\"contained\"\n                    margin=\"dense\"\n                    onClick={higlassEnhancerZoomToXDomain}\n                    fullWidth\n                    disableElevation\n                    size=\"small\"\n                  >\n                    Go\n                  </Button>\n                </Box>\n              )}\n            </Box>\n            <Divider />\n            <Box m={1}>\n              <Button\n                variant=\"contained\"\n                margin=\"dense\"\n                fullWidth\n                disableElevation\n                size=\"small\"\n                startIcon={<SettingsIcon />}\n                onClick={openVariantsSettings}\n              >\n                Edit Variants\n              </Button>\n            </Box>\n            <Divider />\n          </Grid>\n          <Grid item className={classes.settings}>\n            <Box m={0} className={classes.settingsContent}>\n              <Box className={classes.globalSettingsFirstBox}>\n                <CheckboxList\n                  filterState={sampleFilterState}\n                  filterLabel=\"Filter Samples\"\n                  optionWithName={sampleWithName}\n                  optionGroupWithGroup={sampleGroupWithGroup}\n                  groupedOptions={GROUPED_SAMPLE_OPTIONS}\n                  optionToGroup={SAMPLE_TO_GROUP}\n                  groupColors={DEFAULT_COLOR_MAP}\n                  groupColorsDark={DEFAULT_COLOR_MAP_DARK}\n                />\n              </Box>\n            </Box>\n          </Grid>\n          <Grid item>\n            <Divider />\n            <Box m={1}>\n              <Button\n                variant=\"contained\"\n                margin=\"dense\"\n                onClick={higlassExportAsSvg}\n                fullWidth\n                disableElevation\n                size=\"small\"\n              >\n                Export as SVG\n              </Button>\n            </Box>\n          </Grid>\n        </Grid>\n      </Grid>\n    </Drawer>\n  );\n});\n\nexport default AppSidebar;\n","import PropTypes from 'prop-types';\nimport React, { useEffect, useState } from 'react';\nimport TextField from '@material-ui/core/TextField';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Grid from '@material-ui/core/Grid';\nimport Chip from '@material-ui/core/Chip';\nimport SvgIcon from '@material-ui/core/SvgIcon';\nimport FlashOnIcon from '@material-ui/icons/FlashOn';\nimport FilterCenterFocusIcon from '@material-ui/icons/FilterCenterFocus';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { identity } from '@flekschas/utils';\n\nimport useDebounce from './use-debounce';\n\nconst useStyles = makeStyles((theme) => ({\n  inputRoot: {\n    background: 'white !important',\n    borderTopLeftRadius: 0,\n    borderTopRightRadius: 0,\n    '&::before': {\n      borderBottomWidth: 0,\n      boxShadow: '0 1px 0 0 rgba(0, 0, 0, 0)',\n      transition: 'boxShadow 0.2s ease',\n    },\n    '&:hover::before': {\n      borderBottomWidth: 0,\n      boxShadow: '0 1px 0 0 rgba(0, 0, 0, 1)',\n    },\n  },\n  focused: {\n    boxShadow: '0 1px 0 0 rgba(0, 0, 0, 1)',\n  },\n  input: {\n    height: 35,\n    padding: '6px 0 6px',\n  },\n  textFieldRoot: {\n    '& .MuiFormLabel-root': {\n      color: 'black',\n      fontWeight: 'bold',\n      transform: 'translate(12px, 21px) scale(1.25)',\n    },\n    '& .MuiInputLabel-shrink': {\n      fontWeight: 'normal',\n    },\n  },\n}));\n\nconst fetchJsonFromUrl = async (url, query) => {\n  if (typeof url === 'string') {\n    const response = await fetch(`${url}&ac=${query || ''}`);\n    return response.json();\n  }\n  const response = await fetch(`${url.url}&ac=${query || ''}`);\n  const results = await response.json();\n  return results.map((result) => {\n    result.type = url.type;\n    return result;\n  });\n};\n\nfunction GeneIcon(props) {\n  return (\n    <SvgIcon viewBox=\"0 0 16 16\" {...props}>\n      <path d=\"M5.03 14.378A7.33 7.33 0 003.423 16h2.42a7.762 7.762 0 011.281-.774 13.241 13.241 0 01-1.863-1.016c-.078.054-.156.11-.233.168zM5.766 0l.219.174a8.754 8.754 0 001.636.92l.024.008c.797.24 1.507.627 2.023.933.325.18.674.4 1.024.66 1.825 1.363 2.79 3.22 2.79 5.367 0 2.062-.962 3.89-2.782 5.286-.061.048-.125.094-.186.139a10.45 10.45 0 00-1.895-.955 8.17 8.17 0 001.69-1.162h-3.92a6.191 6.191 0 01-1.199-1.15h6.093a4.054 4.054 0 00.603-1.747H3.839c.072.656.307 1.239.636 1.747h.011c.282.438.628.822.991 1.15H5.47l.74.584c.831.588 1.573.893 1.636.92a9.358 9.358 0 012.847 1.504A7.38 7.38 0 0112.3 16H9.879l-.759-.5a7.876 7.876 0 00-1.256-.594 11.833 11.833 0 01-2.07-1.04l.017-.009c-1.567-.999-3.571-2.851-3.571-5.794 0-2.149.964-4.005 2.79-5.367.076-.058.154-.113.231-.167.495.32 1.143.698 1.863 1.015a7.677 7.677 0 00-1.296.786c-.043.032-.083.066-.125.098h3.318c.535.336.999.727 1.364 1.149H4.598a4.215 4.215 0 00-.721 1.748h7.97l-.038-.195a3.527 3.527 0 00-.306-.904 4.417 4.417 0 00-.378-.65l-.01-.007a5.793 5.793 0 00-1.081-1.13l-.14-.109a7.236 7.236 0 00-.722-.48l-.031-.02a7.942 7.942 0 00-1.276-.607 10.278 10.278 0 01-1.257-.57C5.728 2.218 4.31 1.364 3.281 0h2.486zm6.267 0a7.808 7.808 0 01-1.743 1.707A10.443 10.443 0 008.396.752 8.592 8.592 0 009.592 0h2.442z\" />\n    </SvgIcon>\n  );\n}\n\nfunction GeneOption(props) {\n  return (\n    <Grid\n      key={props.option.geneName}\n      container\n      direction=\"row\"\n      alignItems=\"center\"\n    >\n      <GeneIcon fontSize=\"small\" />\n      <span>{props.option.geneName}</span>\n    </Grid>\n  );\n}\n\nfunction VariantOption(props) {\n  return (\n    <Grid\n      key={props.option.geneName}\n      container\n      direction=\"row\"\n      alignItems=\"center\"\n    >\n      <FlashOnIcon fontSize=\"small\" />\n      <span>{props.option.geneName}</span>\n    </Grid>\n  );\n}\n\nfunction RegionOption(props) {\n  return (\n    <Grid\n      key={props.option.geneName}\n      container\n      direction=\"row\"\n      alignItems=\"center\"\n    >\n      <FilterCenterFocusIcon fontSize=\"small\" />\n      <span>{props.option.geneName}</span>\n    </Grid>\n  );\n}\n\nfunction Option(props) {\n  if (props.option.type === 'gene') return <GeneOption option={props.option} />;\n  if (props.option.type === 'variant')\n    return <VariantOption option={props.option} />;\n  if (props.option.type === 'region')\n    return <RegionOption option={props.option} />;\n  return <div>{props.option.geneName}</div>;\n}\n\nfunction getIcon(icon) {\n  switch (icon) {\n    case 'gene':\n      return <GeneIcon />;\n\n    case 'variant':\n      return <FlashOnIcon />;\n\n    case 'region':\n      return <FilterCenterFocusIcon />;\n\n    default:\n      return undefined;\n  }\n}\n\nexport default function SearchField(props) {\n  const [open, setOpen] = useState(false);\n  const [options, setOptions] = useState([]);\n  const [searchQuery, setSearchQuery] = useState(props.inputValue);\n  const debouncedSearchQuery = useDebounce(searchQuery, 250);\n  const loading = open && options.length === 0;\n  const classes = useStyles();\n  const autocompleteClasses = { ...classes };\n  delete autocompleteClasses.textFieldRoot;\n\n  const { customSearch, searchUrl } = props;\n\n  useEffect(() => {\n    let active = true;\n\n    if (!open) return undefined;\n\n    setOptions([]);\n\n    const whenResults = Array.isArray(searchUrl)\n      ? searchUrl.map((url) => fetchJsonFromUrl(url, debouncedSearchQuery))\n      : [fetchJsonFromUrl(searchUrl, debouncedSearchQuery)];\n\n    if (customSearch) whenResults.push(customSearch(debouncedSearchQuery));\n\n    Promise.all(whenResults).then((results) => {\n      if (active) setOptions(results.flat().filter(identity));\n    });\n\n    return () => {\n      active = false;\n    };\n  }, [searchUrl, customSearch, open, debouncedSearchQuery]);\n\n  useEffect(() => {\n    if (!open) {\n      setOptions([]);\n    }\n  }, [open]);\n\n  const value =\n    props.multiple && !Array.isArray(props.value) ? [props.value] : props.value;\n\n  let autocompleteOptions = value && options.length === 0 ? value : options;\n  autocompleteOptions = Array.isArray(autocompleteOptions)\n    ? autocompleteOptions\n    : [autocompleteOptions];\n\n  return (\n    <Autocomplete\n      classes={props.larger ? autocompleteClasses : {}}\n      multiple={props.multiple}\n      onChange={(event, newValue) => {\n        props.onChange(newValue);\n      }}\n      value={value}\n      onInputChange={(event, newInputValue) => {\n        if (event) setSearchQuery(newInputValue);\n      }}\n      fullWidth={props.fullWidth}\n      style={{ width: props.fullWidth ? 'auto' : props.width }}\n      open={open}\n      onOpen={() => {\n        setOpen(true);\n      }}\n      onClose={() => {\n        setOpen(false);\n      }}\n      getOptionSelected={(option, _value) =>\n        option.geneName === _value.geneName\n      }\n      getOptionLabel={(option) => (option ? option.geneName : '')}\n      options={autocompleteOptions}\n      loading={loading}\n      renderInput={(params) => (\n        <TextField\n          {...params}\n          className={props.larger ? classes.textFieldRoot : ''}\n          id={props.id}\n          label={props.label}\n          variant={props.variant}\n          size={props.size}\n          InputProps={{\n            ...params.InputProps,\n            endAdornment: (\n              <React.Fragment>\n                {loading ? (\n                  <CircularProgress color=\"inherit\" size={20} />\n                ) : null}\n                {params.InputProps.endAdornment}\n              </React.Fragment>\n            ),\n          }}\n        />\n      )}\n      renderOption={(option) => <Option option={option} />}\n      renderTags={(v, getTagProps) =>\n        v.map((option, index) => (\n          <Chip\n            icon={getIcon(option.type)}\n            key={option.geneName}\n            label={option.geneName}\n            {...getTagProps({ index })}\n          />\n        ))\n      }\n    />\n  );\n}\n\nSearchField.defaultProps = {\n  fullWidth: true,\n  id: '',\n  label: '',\n  multiple: false,\n  onChange: identity,\n  size: 'small',\n  value: null,\n  variant: 'outlined',\n  width: '10rem',\n};\n\nSearchField.propTypes = {\n  customSearch: PropTypes.func,\n  fullWidth: PropTypes.bool,\n  id: PropTypes.string,\n  label: PropTypes.oneOfType([PropTypes.string, PropTypes.node]),\n  multiple: PropTypes.bool,\n  onChange: PropTypes.func,\n  searchUrl: PropTypes.oneOfType([\n    PropTypes.arrayOf(\n      PropTypes.oneOfType([\n        PropTypes.shape({\n          url: PropTypes.string,\n          type: PropTypes.string,\n        }),\n        PropTypes.string,\n      ])\n    ),\n    PropTypes.string,\n  ]).isRequired,\n  size: PropTypes.string,\n  value: PropTypes.oneOfType([PropTypes.array, PropTypes.object]),\n  variant: PropTypes.string,\n  width: PropTypes.string,\n};\n","import { useRef, useEffect } from 'react';\n\nexport default function usePrevious(value) {\n  const ref = useRef();\n  useEffect(() => {\n    ref.current = value;\n  });\n  return ref.current;\n}\n","import React, { useMemo } from 'react';\nimport { useRecoilState } from 'recoil';\n\nimport AppBar from '@material-ui/core/AppBar';\nimport FormControl from '@material-ui/core/FormControl';\nimport Grid from '@material-ui/core/Grid';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport { makeStyles } from '@material-ui/core/styles';\nimport SearchIcon from '@material-ui/icons/Search';\n\nimport SearchField from './SearchField';\n\nimport usePrevious from './use-previous';\n\nimport {\n  focusGeneOptionState,\n  // focusVariantOptionState,\n  focusRegionOptionState,\n  useFocusGene,\n  // useFocusVariant,\n  useFocusRegion,\n} from './state';\n\nimport { DRAWER_WIDTH, GENE_SEARCH_URL, VARIANT_SEARCH_URL } from './constants';\n\nimport { isChrRange } from './utils';\n\nconst useStyles = makeStyles((theme) => ({\n  appBar: {\n    width: `calc(100% - ${DRAWER_WIDTH}px)`,\n    marginLeft: DRAWER_WIDTH,\n    color: theme.palette.common.black,\n    backgroundColor: theme.palette.common.white,\n    boxShadow: `0 1px 0 0 ${theme.palette.grey['300']}`,\n  },\n  toolbarExtra: {\n    paddingLeft: 0,\n    paddingRight: 0,\n    alignItems: 'flex-end',\n  },\n}));\n\nconst locationSearch = async (query) => {\n  if (!query) return undefined;\n\n  const match = isChrRange(query);\n\n  if (!match) return undefined;\n\n  const startChr = match[1];\n  const startPos = +match[2];\n  const endChr = match[7] || match[1];\n\n  let endPos =\n    match[8] ||\n    (match[4] === '~' || match[4] === '+' ? startPos + +match[5] : +match[5]);\n\n  endPos = Number.isNaN(endPos) ? startPos + 1 : endPos;\n\n  if (startChr && startPos && endChr && endPos) {\n    return [\n      {\n        chrStart: `chr${startChr}`,\n        chrEnd: `chr${endChr}`,\n        txStart: startPos,\n        txEnd: endPos,\n        geneName: query,\n        type: 'region',\n      },\n    ];\n  }\n\n  return undefined;\n};\n\nconst AppTopbar = React.memo(function AppTopbar() {\n  const [focusGene, setFocusGene] = useFocusGene();\n  // const [focusVariant, setFocusVariant] = useFocusVariant();\n  const [focusRegion, setFocusRegion] = useFocusRegion();\n\n  const [focusGeneOption, setFocusGeneOption] = useRecoilState(\n    focusGeneOptionState\n  );\n  const [focusRegionOption, setFocusRegionOption] = useRecoilState(\n    focusRegionOptionState\n  );\n\n  const prevFocusGeneOption = usePrevious(focusGeneOption);\n  // const prevFocusVariantOption = usePrevious(focusVariantOption);\n  const prevFocusRegionOption = usePrevious(focusRegionOption);\n\n  // Derived State\n  const focusOptions = useMemo(\n    () => {\n      const _focusOptions = [];\n      // At first we add the focus element that has not changed!\n      if (focusGeneOption && focusGeneOption === prevFocusGeneOption)\n        _focusOptions.push(focusGeneOption);\n      if (focusRegionOption && focusRegionOption === prevFocusRegionOption)\n        _focusOptions.push(focusRegionOption);\n      // Subsequently, we add the focused element that has changed!\n      if (focusGeneOption && focusGeneOption !== prevFocusGeneOption)\n        _focusOptions.push(focusGeneOption);\n      if (focusRegionOption && focusRegionOption !== prevFocusRegionOption)\n        _focusOptions.push(focusRegionOption);\n      return _focusOptions;\n    },\n    // `prevFocusGeneOption` and `prevFocusVariantOption` are ommitted\n    // on purpose to avoid circular updates.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [focusGeneOption, focusRegionOption]\n  );\n\n  const clearFocusGene = () => {\n    setFocusGene('');\n    setFocusGeneOption(null);\n  };\n\n  const clearFocusRegion = () => {\n    setFocusRegion('');\n    setFocusRegionOption(null);\n  };\n\n  const focusOptionChangeHandler = (newOptions) => {\n    if (newOptions.length) {\n      const newFocusElements = {};\n      // We only allow exactly two options!\n      newOptions.slice(newOptions.length - 2).forEach((newOption) => {\n        switch (newOption.type) {\n          case 'gene':\n            newFocusElements.gene = newOption;\n            if (focusGene !== newOption.geneName) {\n              setFocusGene(newOption.geneName);\n              setFocusGeneOption(newOption);\n            }\n            break;\n\n          case 'variant':\n            newFocusElements.variant = newOption;\n            if (focusRegion !== newOption.geneName) {\n              setFocusRegion(newOption.geneName);\n              setFocusRegionOption(newOption);\n            }\n            break;\n\n          case 'region':\n            newFocusElements.region = newOption;\n            if (focusRegion !== newOption.geneName) {\n              setFocusRegion([\n                `${newOption.chrStart}:${newOption.txStart}`,\n                `${newOption.chrEnd}:${newOption.txEnd}`,\n              ]);\n              setFocusRegionOption(newOption);\n            }\n            break;\n\n          default:\n            // eslint-disable-next-line no-console\n            console.warn('Unknown focus element', newOption);\n            break;\n        }\n      });\n      // Unset focus elements\n      if (focusGene && !newFocusElements.gene) clearFocusGene();\n      if (focusRegion && !newFocusElements.region && !newFocusElements.variant)\n        clearFocusRegion();\n    } else {\n      clearFocusGene();\n      clearFocusRegion();\n    }\n  };\n\n  const classes = useStyles();\n\n  return (\n    <AppBar position=\"fixed\" className={classes.appBar}>\n      <Toolbar\n        classes={{\n          root: classes.toolbarExtra,\n        }}\n      >\n        <FormControl fullWidth>\n          <SearchField\n            label={\n              <Grid container direction=\"row\" alignItems=\"center\">\n                <SearchIcon fontSize=\"small\" />\n                <span style={{ marginLeft: 3 }}>Gene, Variant, or Region</span>\n              </Grid>\n            }\n            customSearch={locationSearch}\n            searchUrl={[\n              { url: GENE_SEARCH_URL, type: 'gene' },\n              { url: VARIANT_SEARCH_URL, type: 'variant' },\n            ]}\n            onChange={focusOptionChangeHandler}\n            value={focusOptions}\n            variant=\"filled\"\n            larger\n            fullWidth\n            multiple\n          />\n        </FormControl>\n      </Toolbar>\n    </AppBar>\n  );\n});\n\nexport default AppTopbar;\n","import React from 'react';\nimport { useRecoilValue } from 'recoil';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport {\n  enhancerRegionsShowInfoState,\n  focusRegionState,\n  focusGeneState,\n} from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n    justifyContent: 'space-between',\n  },\n  text: {\n    fontSize: '0.8rem',\n  },\n  black: {\n    color: 'black',\n  },\n  gray: {\n    color: theme.palette.grey['400'],\n  },\n  pink: {\n    color: '#cc0078',\n  },\n}));\n\nconst EnhancerRegionsInfo = React.memo(function EnhancerRegionsInfo() {\n  const showInfo = useRecoilValue(enhancerRegionsShowInfoState);\n  const focusGene = useRecoilValue(focusGeneState);\n  const focusRegion = useRecoilValue(focusRegionState);\n\n  const classes = useStyles();\n\n  if (!showInfo) return '';\n\n  return (\n    <React.Fragment>\n      {focusGene && focusRegion && (\n        <Typography className={classes.text} noWrap>\n          <span className={classes.pink}></span> Enhancers containing{' '}\n          <em>{focusRegion}</em> and predicted to regulate <em>{focusGene}</em>\n        </Typography>\n      )}\n      {focusGene && !focusRegion && (\n        <Typography className={classes.text} noWrap>\n          <span className={classes.pink}></span> Enhancers predicted to\n          regulate <em>{focusGene}</em>\n        </Typography>\n      )}\n      {!focusGene && focusRegion && (\n        <Typography className={classes.text} noWrap>\n          <span className={classes.pink}></span> Enhancers containing{' '}\n          <em>{focusRegion}</em>\n        </Typography>\n      )}\n      {focusGene || focusRegion ? (\n        <Typography className={classes.text} noWrap>\n          <span className={classes.gray}></span> All other predicted enhancers\n        </Typography>\n      ) : (\n        <Typography className={classes.text} noWrap>\n          <span className={classes.black}></span> All predicted enhancers\n        </Typography>\n      )}\n    </React.Fragment>\n  );\n});\n\nexport default EnhancerRegionsInfo;\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\n\nconst EnhancerRegionsInfo = React.memo(function EnhancerRegionsInfo() {\n  return (\n    <React.Fragment>\n      <Typography>\n        This panel visualizes the predicted enhancers by sample type as a\n        matrix-like track. Each rectangle representes an enhancer. Promoter\n        regions are indicated by translucent light gray overlays.\n      </Typography>\n      <Typography>\n        {' '}\n        You can filter enhancers via their target gene or by variant (the dot\n        plot below the gene annotations). Click on a variant or gene to select\n        it. Selections are shown in pink/red.\n      </Typography>\n    </React.Fragment>\n  );\n});\n\nexport default EnhancerRegionsInfo;\n","import React, { useCallback } from 'react';\nimport Box from '@material-ui/core/Box';\nimport IconButton from '@material-ui/core/IconButton';\nimport RadioButtonCheckedIcon from '@material-ui/icons/RadioButtonChecked';\nimport RadioButtonUncheckedIcon from '@material-ui/icons/RadioButtonUnchecked';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport RadioGroup from '@material-ui/core/RadioGroup';\nimport Switch from '@material-ui/core/Switch';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport {\n  useEnhancerRegionsHideUnfocused,\n  useEnhancerRegionsColorEncoding,\n  useVariantYScale,\n} from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  iconRadioLegend: {\n    margin: theme.spacing(2, 0, 0.25, 0),\n  },\n}));\n\nconst EnhancerRegionsInfo = React.memo(function EnhancerRegionsInfo() {\n  const [variantYScale, setVariantYScale] = useVariantYScale();\n  const [hideUnfocused, setHideUnfocused] = useEnhancerRegionsHideUnfocused();\n  const [colorEncoding, setColorEncoding] = useEnhancerRegionsColorEncoding();\n\n  const hideUnfocusedChangeHandler = useCallback(\n    (event) => {\n      setHideUnfocused(event.target.checked);\n    },\n    [setHideUnfocused]\n  );\n\n  const changeVariantYScale = useCallback(\n    (value) => () => {\n      setVariantYScale(value);\n    },\n    [setVariantYScale]\n  );\n\n  const changeColorEncoding = useCallback(\n    (value) => () => {\n      setColorEncoding(value);\n    },\n    [setColorEncoding]\n  );\n\n  const classes = useStyles();\n\n  return (\n    <React.Fragment>\n      <Box m={1}>\n        <FormControlLabel\n          control={\n            <Switch\n              checked={hideUnfocused}\n              onChange={hideUnfocusedChangeHandler}\n              name=\"hideUnfocused\"\n            />\n          }\n          label=\"Hide unfocused enhancer regions\"\n        />\n      </Box>\n      <Box m={1}>\n        <FormControl component=\"fieldset\">\n          <FormLabel component=\"legend\" className={classes.iconRadioLegend}>\n            Variant y-scale\n          </FormLabel>\n          <RadioGroup\n            aria-label=\"variantYScale\"\n            name=\"variantYScale\"\n            value={variantYScale}\n          >\n            <FormControlLabel\n              label=\"p-value\"\n              value=\"pValue\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeVariantYScale('pValue')}\n                >\n                  {variantYScale === 'pValue' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Posterior probability\"\n              value=\"posteriorProbability\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeVariantYScale('posteriorProbability')}\n                >\n                  {variantYScale === 'posteriorProbability' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n          </RadioGroup>\n        </FormControl>\n      </Box>\n      <Box m={1}>\n        <FormControl component=\"fieldset\">\n          <FormLabel component=\"legend\" className={classes.iconRadioLegend}>\n            Matrix colorEncoding\n          </FormLabel>\n          <RadioGroup\n            aria-label=\"colorEncoding\"\n            name=\"colorEncoding\"\n            value={colorEncoding}\n          >\n            <FormControlLabel\n              label=\"Solid\"\n              value=\"solid\"\n              className={classes.iconRadio}\n              control={\n                <IconButton size=\"small\" onClick={changeColorEncoding('solid')}>\n                  {colorEncoding === 'solid' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Number of predictions\"\n              value=\"frequency\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeColorEncoding('frequency')}\n                >\n                  {colorEncoding === 'frequency' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Highest prediction score\"\n              value=\"highestImportance\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeColorEncoding('highestImportance')}\n                >\n                  {colorEncoding === 'highestImportance' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Closest prediction score\"\n              value=\"closestImportance\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeColorEncoding('closestImportance')}\n                >\n                  {colorEncoding === 'closestImportance' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n          </RadioGroup>\n        </FormControl>\n      </Box>\n    </React.Fragment>\n  );\n});\n\nexport default EnhancerRegionsInfo;\n","import React, { useCallback, useMemo, useState } from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport IconButton from '@material-ui/core/IconButton';\nimport HelpIcon from '@material-ui/icons/Help';\nimport InfoIcon from '@material-ui/icons/Info';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport Popover from '@material-ui/core/Popover';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme) => ({\n  grow: {\n    flexGrow: 1,\n  },\n  bar: {\n    position: 'relative',\n    padding: '2px',\n    fontSize: '0.8rem',\n    background: theme.palette.grey['100'],\n  },\n  title: {\n    fontSize: '0.8rem',\n    padding: '0 2px',\n    fontWeight: 900,\n  },\n  icon: {\n    color: theme.palette.grey['400'],\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  iconActive: {\n    color: theme.palette.grey['600'],\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  popeover: {\n    '& > *': {\n      maxWidth: '20rem',\n      padding: '0.5rem',\n      fontSize: '0.8rem',\n      '&+p': {\n        paddingTop: 0,\n      },\n    },\n  },\n  info: {\n    '&> *': {\n      padding: '0 2px',\n    },\n    '&> *:last-child': {\n      borderBottom: `1px solid ${theme.palette.grey['100']}`,\n    },\n  },\n}));\n\nconst TitleBar = React.memo(function TitleBar({\n  id,\n  title,\n  Info,\n  Help,\n  Settings,\n  useShowInfo,\n  popoverDirection = 'bottom',\n}) {\n  const [showInfo, setShowInfo] = useShowInfo();\n  const [helpAnchorEl, setHelpAnchorEl] = useState();\n  const [settingsAnchorEl, setSettingsAnchorEl] = useState();\n\n  const infoToggleHandler = useCallback(() => {\n    setShowInfo((show) => !(show === true || show === 'true'));\n  }, [setShowInfo]);\n\n  const helpOpenHandler = useCallback((event) => {\n    setHelpAnchorEl(event.currentTarget);\n  }, []);\n\n  const helpCloseHandler = useCallback(() => {\n    setHelpAnchorEl(null);\n  }, []);\n\n  const settingsOpenHandler = useCallback((event) => {\n    setSettingsAnchorEl(event.currentTarget);\n  }, []);\n\n  const settingsCloseHandler = useCallback(() => {\n    setSettingsAnchorEl(null);\n  }, []);\n\n  const helpId = useMemo(() => `${id}-help`, [id]);\n  const settingsId = useMemo(() => `${id}-settings`, [id]);\n\n  const anchorOriginVertical = useMemo(\n    () => (popoverDirection === 'bottom' ? 'bottom' : 'top'),\n    [popoverDirection]\n  );\n  const transformOriginVertical = useMemo(\n    () => (popoverDirection === 'bottom' ? 'top' : 'bottom'),\n    [popoverDirection]\n  );\n\n  // On every render\n  const classes = useStyles();\n\n  const helpOpen = Boolean(helpAnchorEl);\n  const settingsOpen = Boolean(settingsAnchorEl);\n\n  const iconInfoClass = showInfo ? classes.iconActive : classes.icon;\n  const iconHelpClass = helpOpen ? classes.iconActive : classes.icon;\n  const iconSettingsClass = settingsOpen ? classes.iconActive : classes.icon;\n\n  return (\n    <Grid item className={classes.root}>\n      <Grid\n        item\n        className={classes.bar}\n        container\n        alignItems=\"center\"\n        wrap=\"nowrap\"\n      >\n        <Grid\n          item\n          container\n          alignItems=\"center\"\n          wrap=\"nowrap\"\n          className={classes.grow}\n        >\n          <Typography component=\"h3\" className={classes.title} noWrap>\n            {title}:\n          </Typography>\n        </Grid>\n        <Grid item>\n          <Grid container alignItems=\"center\" wrap=\"nowrap\">\n            <IconButton\n              aria-label=\"details\"\n              className={iconInfoClass}\n              size=\"small\"\n              onClick={infoToggleHandler}\n            >\n              <InfoIcon fontSize=\"inherit\" />\n            </IconButton>\n            <IconButton\n              aria-label=\"help\"\n              aria-describedby={helpId}\n              className={iconHelpClass}\n              size=\"small\"\n              onClick={helpOpenHandler}\n            >\n              <HelpIcon fontSize=\"inherit\" />\n            </IconButton>\n            <Popover\n              id={helpId}\n              open={helpOpen}\n              anchorEl={helpAnchorEl}\n              onClose={helpCloseHandler}\n              anchorOrigin={{\n                vertical: anchorOriginVertical,\n                horizontal: 'right',\n              }}\n              transformOrigin={{\n                vertical: transformOriginVertical,\n                horizontal: 'right',\n              }}\n            >\n              <div className={classes.popeover}>\n                <Help />\n              </div>\n            </Popover>\n            <IconButton\n              aria-label=\"settings\"\n              aria-describedby={settingsId}\n              className={iconSettingsClass}\n              size=\"small\"\n              onClick={settingsOpenHandler}\n            >\n              <SettingsIcon fontSize=\"inherit\" />\n            </IconButton>\n            <Popover\n              id={helpId}\n              open={settingsOpen}\n              anchorEl={settingsAnchorEl}\n              onClose={settingsCloseHandler}\n              anchorOrigin={{\n                vertical: anchorOriginVertical,\n                horizontal: 'right',\n              }}\n              transformOrigin={{\n                vertical: transformOriginVertical,\n                horizontal: 'right',\n              }}\n            >\n              <div className={classes.popeover}>\n                <Settings />\n              </div>\n            </Popover>\n          </Grid>\n        </Grid>\n      </Grid>\n      <Grid item className={classes.info}>\n        {showInfo && <Info />}\n      </Grid>\n    </Grid>\n  );\n});\n\nexport default TitleBar;\n","import React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { useRecoilValue, useSetRecoilState, useRecoilState } from 'recoil';\nimport { HiGlassComponent } from 'higlass';\nimport { debounce, deepClone, isParentOf, pipe, sum } from '@flekschas/utils';\n\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport { useChromInfo } from './ChromInfoProvider';\nimport EnhancerRegionsInfo from './EnhancerRegionsInfo';\nimport EnhancerRegionsHelp from './EnhancerRegionsHelp';\nimport EnhancerRegionsSettings from './EnhancerRegionsSettings';\nimport TitleBar from './TitleBar';\n\nimport {\n  enhancerRegionsColorEncodingState,\n  enhancerRegionsHideUnfocusedState,\n  focusGeneEndWithAssembly,\n  focusGeneOptionState,\n  focusGeneStartWithAssembly,\n  focusRegionOptionState,\n  focusRegionAbsWithAssembly,\n  higlassEnhancerRegionsState,\n  sampleGroupSelectionSizesState,\n  selectedSamplesState,\n  useEnhancerRegionsShowInfos,\n  useFocusGene,\n  useFocusRegion,\n  useXDomainEndWithAssembly,\n  useXDomainStartWithAssembly,\n  variantTracksState,\n  variantYScaleState,\n  xDomainEndAbsWithAssembly,\n  xDomainStartAbsWithAssembly,\n} from './state';\n\nimport {\n  updateViewConfigFocusGene,\n  updateViewConfigFocusRegion,\n  updateViewConfigVariantYScale,\n  updateViewConfigXDomain,\n  updateViewConfigVariantTracks,\n} from './view-config';\n\nimport {\n  BIOSAMPLE_COLUMN,\n  DEFAULT_VIEW_CONFIG_ENHANCER,\n  HIGLASS_PAN_ZOOM,\n  HIGLASS_SELECT,\n  IGNORED_FOCUS_ELEMENTS,\n} from './constants';\n\nimport { chrRangePosEncoder } from './utils';\n\nimport 'higlass/dist/hglib.css';\n\nimport './EnhancerRegions.css';\n\nconst useStyles = makeStyles((theme) => ({\n  grow: {\n    flexGrow: 1,\n  },\n  fullWidthHeight: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n  },\n  higlassContainer: {\n    position: 'relative',\n    minHeight: '100%',\n    overflow: 'hidden',\n  },\n  panZoomTip: {\n    position: 'absolute',\n    zIndex: 11,\n    top: 0,\n    left: 0,\n    right: 0,\n    padding: '0 2px',\n    fontSize: '0.8rem',\n    lineHeight: '1.5rem',\n    background: theme.palette.grey['100'],\n    textAlign: 'center',\n    boxShadow: '0 1px 3px 0 rgba(0, 0, 0, 0.1)',\n    opacity: 1,\n    animation: '0.75s ease 3s 1 running forwards fadeout',\n    '-webkit-touch-callout': 'none',\n    '-webkit-user-select': 'none',\n    '-khtml-user-select': 'none',\n    '-moz-user-select': 'none',\n    '-ms-user-select': 'none',\n    userSelect: 'none',\n    transition: '0.25s ease opacity, 0.25s ease transform',\n    '&:hover': {\n      opacity: 0,\n    },\n  },\n  panZoomTipNormal: {\n    color: theme.palette.grey['600'],\n  },\n  panZoomTipNormalHover: {\n    fontWeight: 'bold',\n    color: 'black',\n    background: '#aaa',\n    animation: '0.75s ease 5s 1 running forwards fadeout',\n  },\n  panZoomTipActive: {\n    color: 'white',\n    background: '#dd55a5',\n    animation: '0.75s ease 5s 1 running forwards fadeout',\n  },\n  panZoomTipActiveHover: {\n    fontWeight: 'bold',\n    color: 'white',\n    background: '#cc0078',\n    animation: '0.75s ease 5s 1 running forwards fadeout',\n  },\n}));\n\nconst updateViewConfigFocusStyle = (hideUnfocused) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[4].options.focusStyle = hideUnfocused\n    ? 'filtering'\n    : 'highlighting';\n  viewConfig.views[0].tracks.top[4].options.stratification.axisNoGroupColor = !hideUnfocused;\n\n  return viewConfig;\n};\n\nconst updateViewConfigColorEncoding = (coloring) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[4].options.opacityEncoding = coloring;\n  return viewConfig;\n};\n\nconst updateViewConfigFilter = (selectedSamples) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[3].contents[0].options.filter = {\n    set: selectedSamples,\n    field: BIOSAMPLE_COLUMN,\n  };\n  viewConfig.views[0].tracks.top[3].contents[1].options.filter = {\n    set: selectedSamples,\n    field: BIOSAMPLE_COLUMN,\n  };\n  viewConfig.views[0].tracks.top[4].options.filter = {\n    set: selectedSamples,\n    field: BIOSAMPLE_COLUMN,\n  };\n  return viewConfig;\n};\n\nconst updateViewConfigMatrixHeight = (numSamples) => (viewConfig) => {\n  const matrixTrack = viewConfig.views[0].tracks.top[4];\n  matrixTrack.height = numSamples * matrixTrack.options.markHeight + 14;\n  return viewConfig;\n};\n\nconst EnhancerRegion = React.memo((props) => {\n  const chromInfo = useChromInfo();\n\n  const [focusGeneOption, setFocusGeneOption] = useRecoilState(\n    focusGeneOptionState\n  );\n\n  const setFocusGene = useFocusGene()[1];\n  const setFocusRegion = useFocusRegion()[1];\n  const setXDomainStart = useXDomainStartWithAssembly(chromInfo)[1];\n  const setXDomainEnd = useXDomainEndWithAssembly(chromInfo)[1];\n  const setFocusRegionOption = useSetRecoilState(focusRegionOptionState);\n  const setHiglass = useSetRecoilState(higlassEnhancerRegionsState);\n\n  const variantTracks = useRecoilValue(variantTracksState);\n  const hideUnfocused = useRecoilValue(enhancerRegionsHideUnfocusedState);\n  const variantYScale = useRecoilValue(variantYScaleState);\n  const colorEncoding = useRecoilValue(enhancerRegionsColorEncodingState);\n  const focusRegionAbs = useRecoilValue(focusRegionAbsWithAssembly(chromInfo));\n  const xDomainStartAbs = useRecoilValue(\n    xDomainStartAbsWithAssembly(chromInfo)\n  );\n  const xDomainEndAbs = useRecoilValue(xDomainEndAbsWithAssembly(chromInfo));\n  const focusGeneStart = useRecoilValue(focusGeneStartWithAssembly(chromInfo));\n  const focusGeneEnd = useRecoilValue(focusGeneEndWithAssembly(chromInfo));\n  const sampleGroupSelectionSizes = useRecoilValue(\n    sampleGroupSelectionSizesState\n  );\n  const selectedSamples = useRecoilValue(selectedSamplesState);\n\n  const [higlassMouseOver, setHiglassMouseOver] = useState(false);\n  const [higlassFocus, setHiglassFocus] = useState(false);\n  const higlassApi = useRef(null);\n  const higlassRangeSelection = useRef(null);\n  const higlassListeners = useRef([]);\n  const higlassContainerRef = useRef(null);\n  const higlassEnhancerClickSelection = useRef(null);\n  const higlassMouseDown = useRef(false);\n  const higlassNumMouseOver = useRef(0);\n  const higlassNumFocus = useRef(0);\n  const higlassNumFocusMouseOut = useRef(0);\n\n  const shouldSkipUpdatingXDomain = () => {\n    if (higlassEnhancerClickSelection.current) {\n      higlassEnhancerClickSelection.current = false;\n      return true;\n    }\n    return false;\n  };\n\n  const numSamples = useMemo(\n    () => sum(Object.values(sampleGroupSelectionSizes)),\n    [sampleGroupSelectionSizes]\n  );\n\n  useEffect(() => {\n    higlassNumMouseOver.current += higlassMouseOver;\n  }, [higlassMouseOver]);\n\n  useEffect(() => {\n    higlassNumFocus.current += higlassFocus;\n  }, [higlassFocus]);\n\n  useEffect(() => {\n    if (higlassFocus) higlassNumFocusMouseOut.current += !higlassMouseOver;\n    else higlassNumFocusMouseOut.current = 0;\n  }, [higlassFocus, higlassMouseOver]);\n\n  const viewConfig = useMemo(\n    () =>\n      pipe(\n        updateViewConfigVariantTracks(variantTracks),\n        updateViewConfigFocusGene(\n          focusGeneOption ? focusGeneOption.geneName : null,\n          focusGeneStart,\n          focusGeneEnd\n        ),\n        updateViewConfigFocusRegion(focusRegionAbs, [2, 4]),\n        updateViewConfigFocusStyle(hideUnfocused),\n        updateViewConfigColorEncoding(colorEncoding),\n        updateViewConfigVariantYScale(variantYScale),\n        updateViewConfigXDomain(xDomainStartAbs, xDomainEndAbs, {\n          force: shouldSkipUpdatingXDomain,\n        }),\n        updateViewConfigFilter(selectedSamples),\n        updateViewConfigMatrixHeight(numSamples)\n      )(deepClone(DEFAULT_VIEW_CONFIG_ENHANCER)),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [\n      // `xDomainStartAbs` and `xDomainEndAbs` are ommitted on purpose to avoid\n      // updating the view-config on every pan or zoom event.\n      variantTracks,\n      focusGeneOption,\n      focusGeneStart,\n      focusGeneEnd,\n      focusRegionAbs,\n      hideUnfocused,\n      colorEncoding,\n      variantYScale,\n      selectedSamples,\n      numSamples,\n    ]\n  );\n\n  const viewConfigHeight = useMemo(\n    () =>\n      viewConfig.views[0].tracks.top.reduce(\n        (height, track) => height + track.height,\n        0\n      ),\n    [viewConfig]\n  );\n\n  const higlassBlockClasses = useMemo(\n    () => (higlassFocus ? 'higlass-block focus' : 'higlass-block'),\n    [higlassFocus]\n  );\n\n  // HiGlass Functions\n  const higlassClickHandler = (event) => {\n    if (event.type === 'gene-annotation') {\n      setFocusGene(event.payload.name);\n      higlassEnhancerClickSelection.current = true;\n      setFocusGeneOption({\n        chr: event.payload.fields[0],\n        txStart: event.payload.fields[1],\n        txEnd: event.payload.fields[2],\n        geneName: event.payload.name,\n        type: 'gene',\n      });\n    } else if (event.type === 'snp') {\n      setFocusRegion(event.payload.name);\n      higlassEnhancerClickSelection.current = true;\n      setFocusRegionOption({\n        chr: event.payload.fields[0],\n        txStart: event.payload.fields[1],\n        txEnd: event.payload.fields[2],\n        geneName: event.payload.name,\n        score: event.payload.importance,\n        type: 'variant',\n      });\n    } else if (event.type === 'annotation' && event.payload.item) {\n      setFocusRegionOption({\n        chrStart: event.payload.item.fields[0],\n        txStart: +event.payload.item.fields[1],\n        chrEnd: event.payload.item.fields[0],\n        txEnd: +event.payload.item.fields[2],\n        geneName: chrRangePosEncoder([\n          `${event.payload.item.fields[0]}:${event.payload.item.fields[1]}`,\n          `${event.payload.item.fields[0]}:${event.payload.item.fields[2]}`,\n        ]),\n        type: 'region',\n      });\n    }\n  };\n\n  const higlassLocationChangeHandler = (event) => {\n    const [newXDomainStart, newXDomainEnd] = event.xDomain.map((absPos) =>\n      chromInfo.absToChr(absPos).slice(0, 2).join(':')\n    );\n    setXDomainStart(newXDomainStart);\n    setXDomainEnd(newXDomainEnd);\n  };\n  const higlassLocationChangeHandlerDb = debounce(\n    higlassLocationChangeHandler,\n    250\n  );\n\n  const higlassRangeSelectionHandler = (event) => {\n    if (event.dataRange[0]) [higlassRangeSelection.current] = event.dataRange;\n  };\n\n  const windowMouseDownClearHandler = useCallback((e) => {\n    if (!isParentOf(e.target, higlassContainerRef.current)) {\n      setHiglassFocus(false);\n    }\n  }, []);\n\n  useEffect(\n    () => {\n      window.addEventListener('mouseup', windowMouseDownClearHandler);\n      window.addEventListener('blur', windowMouseDownClearHandler);\n\n      return () => {\n        window.removeEventListener('mouseup', windowMouseDownClearHandler);\n        window.removeEventListener('blur', windowMouseDownClearHandler);\n      };\n    },\n    // Execute only once on initialization\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n\n  const higlassMouseDownHandler = useCallback(() => {\n    higlassMouseDown.current = true;\n  }, []);\n\n  const higlassInitHandler = useCallback(\n    (higlassInstance) => {\n      if (higlassInstance !== null) {\n        setHiglass(higlassInstance.api);\n        higlassApi.current = higlassInstance.api;\n        higlassInstance.api.setRangeSelectionToInt();\n        higlassListeners.current.push(\n          higlassInstance.api.on('click', higlassClickHandler)\n        );\n        higlassListeners.current.push(\n          higlassInstance.api.on(\n            'location',\n            higlassLocationChangeHandlerDb,\n            'context'\n          )\n        );\n        higlassListeners.current.push(\n          higlassInstance.api.on(\n            'rangeSelection',\n            higlassRangeSelectionHandler,\n            'context'\n          )\n        );\n        higlassInstance.api\n          .getComponent()\n          .element.addEventListener('mousedown', higlassMouseDownHandler);\n      }\n    },\n    // Execute only once on initialization\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n\n  const higlassFocusHandler = () => {\n    setHiglassFocus(true);\n  };\n\n  const higlassBlurHandler = () => {\n    if (!higlassMouseDown.current) {\n      setHiglassFocus(false);\n    }\n  };\n\n  const higlassContainerMouseEnterHandler = () => {\n    setHiglassMouseOver(true);\n  };\n\n  const higlassContainerMouseLeaveHandler = () => {\n    setHiglassMouseOver(false);\n  };\n\n  // On init only\n  useEffect(\n    () => {\n      function keydownHandler(event) {\n        if (\n          IGNORED_FOCUS_ELEMENTS.has(\n            document.activeElement.tagName.toLowerCase()\n          )\n        )\n          return;\n\n        event.preventDefault();\n\n        if (event.altKey) higlassApi.current.activateTool(HIGLASS_SELECT);\n      }\n\n      function keyupHandler(event) {\n        if (\n          IGNORED_FOCUS_ELEMENTS.has(\n            document.activeElement.tagName.toLowerCase()\n          )\n        )\n          return;\n\n        event.preventDefault();\n\n        if (higlassRangeSelection.current) {\n          const chrRange = higlassRangeSelection.current.map(\n            chromInfo.absToChr\n          );\n          const [chrStart, txStart] = chrRange[0];\n          const [chrEnd, txEnd] = chrRange[1];\n          setFocusRegion([`${chrStart}:${txStart}`, `${chrEnd}:${txEnd}`]);\n          setFocusRegionOption({\n            chrStart,\n            txStart,\n            chrEnd,\n            txEnd,\n            geneName: chrRangePosEncoder([\n              `${chrStart}:${txStart}`,\n              `${chrEnd}:${txEnd}`,\n            ]),\n            type: 'region',\n          });\n        }\n\n        higlassRangeSelection.current = null;\n        higlassApi.current.activateTool(HIGLASS_PAN_ZOOM);\n      }\n\n      document.addEventListener('keydown', keydownHandler);\n      document.addEventListener('keyup', keyupHandler);\n\n      return () => {\n        document.removeEventListener('keydown', keydownHandler);\n        document.removeEventListener('keyup', keyupHandler);\n      };\n    },\n    // Execute only once on initialization\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [chromInfo]\n  );\n\n  // Unmount\n  useEffect(\n    () => () => {\n      if (higlassApi.current) {\n        higlassListeners.current.forEach(({ event, handler }) => {\n          higlassApi.current.off(event, handler);\n        });\n        higlassApi.current\n          .getComponent()\n          .element.removeEventListener('mousedown', higlassMouseDownHandler);\n        higlassApi.current.destroy();\n      }\n    },\n    // Execute only once on initialization\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n\n  // Run on every render\n  const classes = useStyles();\n\n  return (\n    <div className={classes.root}>\n      <TitleBar\n        id=\"enhancer-regions\"\n        title=\"Enhancer Regions\"\n        useShowInfo={useEnhancerRegionsShowInfos}\n        Info={EnhancerRegionsInfo}\n        Help={EnhancerRegionsHelp}\n        Settings={EnhancerRegionsSettings}\n      />\n      <div\n        className={`higlass-container ${classes.higlassContainer}`}\n        onMouseEnter={higlassContainerMouseEnterHandler}\n        onMouseLeave={higlassContainerMouseLeaveHandler}\n        ref={higlassContainerRef}\n        style={{ height: `${viewConfigHeight}px` }}\n      >\n        {higlassFocus &&\n          !higlassMouseOver &&\n          higlassNumFocus.current < 2 &&\n          higlassNumFocusMouseOut.current < 1 && (\n            <Typography\n              // Just a hack to trigger a dom rerendering which in turn\n              // triggers the fadeout animation\n              component=\"div\"\n              className={`panZoomTip ${classes.panZoomTip} ${classes.panZoomTipActive}`}\n              noWrap\n            >\n              Click outside to deactivate pan & zoom!\n            </Typography>\n          )}\n        {higlassFocus &&\n          higlassMouseOver &&\n          higlassNumFocus.current < 2 &&\n          higlassNumFocusMouseOut.current < 1 && (\n            <Typography\n              // Just a hack to trigger a dom rerendering which in turn\n              // triggers the fadeout animation\n              component=\"span\"\n              className={`panZoomTip ${classes.panZoomTip} ${classes.panZoomTipActiveHover}`}\n              noWrap\n            >\n              You can now pan & zoom the plot!\n            </Typography>\n          )}\n        {!higlassFocus && higlassMouseOver && higlassNumMouseOver.current < 2 && (\n          <Typography\n            // Just a hack to trigger a dom rerendering which in turn\n            // triggers the fadeout animation\n            component=\"div\"\n            className={`panZoomTip ${classes.panZoomTip} ${classes.panZoomTipNormalHover}`}\n            noWrap\n          >\n            Click to activate pan & zoom!\n          </Typography>\n        )}\n        {!higlassFocus && !higlassMouseOver && higlassNumMouseOver.current < 2 && (\n          <Typography\n            // Just a hack to trigger a dom rerendering which in turn\n            // triggers the fadeout animation\n            component=\"span\"\n            className={`panZoomTip ${classes.panZoomTip} ${classes.panZoomTipNormal}`}\n            noWrap\n          >\n            This plot is interactive!\n          </Typography>\n        )}\n        <div\n          className={higlassBlockClasses}\n          onMouseDown={higlassMouseDownHandler}\n          onFocus={higlassFocusHandler}\n          onBlur={higlassBlurHandler}\n          tabIndex=\"0\"\n        />\n        <HiGlassComponent\n          ref={higlassInitHandler}\n          viewConfig={viewConfig}\n          options={{\n            sizeMode: 'bounded',\n            globalMousePosition: true,\n          }}\n        />\n      </div>\n    </div>\n  );\n});\n\nexport default EnhancerRegion;\n","import React from 'react';\nimport { useRecoilValue } from 'recoil';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport {\n  enhancerGenesCellEncodingState,\n  enhancerGenesShowInfoState,\n  focusRegionState,\n  focusRegionStrState,\n} from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n    justifyContent: 'space-between',\n  },\n  text: {\n    fontSize: '0.8rem',\n    verticalAlign: 'center',\n  },\n  placeholder: {\n    fontStyle: 'italic',\n    color: theme.palette.grey['600'],\n  },\n  small: {\n    fontSize: '0.5em',\n    lineHeight: '2em',\n  },\n  medium: {\n    fontSize: '1em',\n    lineHeight: '1em',\n  },\n  large: {\n    fontSize: '1.5em',\n    lineHeight: '0.6667em',\n    marginLeft: '-0.05rem',\n    marginRight: '0.1rem',\n  },\n}));\n\nconst EnhancerRegionsInfo = React.memo(function EnhancerRegionsInfo() {\n  const showInfo = useRecoilValue(enhancerGenesShowInfoState);\n  const focusRegion = useRecoilValue(focusRegionState);\n  const focusRegionStr = useRecoilValue(focusRegionStrState);\n  const cellEncoding = useRecoilValue(enhancerGenesCellEncodingState);\n\n  const classes = useStyles();\n\n  if (!showInfo) return '';\n\n  return (\n    <div>\n      {!focusRegion && (\n        <Grid\n          container\n          justify=\"center\"\n          alignItems=\"center\"\n          className={classes.placeholder}\n        >\n          <Typography className={classes.text}>\n            Select a variant or focus region to see details\n          </Typography>\n        </Grid>\n      )}\n      {focusRegion && cellEncoding === 'max-score' && (\n        <React.Fragment>\n          <Typography className={classes.text}>\n            <span className={classes.small}></span>\n            <span className={classes.medium}></span>\n            <span className={classes.large}></span>\n            <strong>Max. ABC score</strong> of enhancer-gene connections\n            overlapping <em>{focusRegionStr}</em> by sample groups across\n            up/downstream genes.\n          </Typography>\n        </React.Fragment>\n      )}\n      {focusRegion && cellEncoding === 'number' && (\n        <React.Fragment>\n          <Typography className={classes.text}>\n            <span className={classes.small}></span>\n            <span className={classes.medium}></span>\n            <span className={classes.large}></span>\n            <strong>Absolute number</strong> of enhancer-gene connections\n            overlapping <em>{focusRegionStr}</em> by sample groups across\n            up/downstream genes.\n          </Typography>\n        </React.Fragment>\n      )}\n      {focusRegion && cellEncoding === 'percent' && (\n        <React.Fragment>\n          <Typography className={classes.text}>\n            <span className={classes.small}></span>\n            <span className={classes.medium}></span>\n            <span className={classes.large}></span>\n            <strong>Percentage</strong> of enhancer-gene connections overlapping{' '}\n            <em>{focusRegionStr}</em> within a sample group across up/downstream\n            genes.\n          </Typography>\n        </React.Fragment>\n      )}\n      {focusRegion && cellEncoding === 'distribution' && (\n        <React.Fragment>\n          <Typography className={classes.text}>\n            <strong>Distribution</strong> of the prediction scores of\n            enhancer-gene connections overlapping <em>{focusRegionStr}</em> by\n            sample group across up/downstream genes.\n          </Typography>\n        </React.Fragment>\n      )}\n      {focusRegion && cellEncoding === 'array' && (\n        <React.Fragment>\n          <Typography className={classes.text}>\n            <span></span>\n            <strong>Presence</strong> of enhancer-gene connections overlapping{' '}\n            <em>{focusRegionStr}</em> by samples across sample groups and\n            up/downstream genes.\n          </Typography>\n        </React.Fragment>\n      )}\n    </div>\n  );\n});\n\nexport default EnhancerRegionsInfo;\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\n\nconst EnhancerRegionsHelp = React.memo(function EnhancerRegionsHelp() {\n  return (\n    <React.Fragment>\n      <Typography>...</Typography>\n    </React.Fragment>\n  );\n});\n\nexport default EnhancerRegionsHelp;\n","import Switch from '@material-ui/core/Switch';\nimport { withStyles } from '@material-ui/core/styles';\n\nconst AntSwitch = withStyles((theme) => ({\n  root: {\n    width: 36,\n    height: 24,\n    padding: 4,\n    margin: '-4px 0 -4px -4px',\n    display: 'flex',\n    borderRadius: 24,\n    transition: 'background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n    '&:hover': {\n      backgroundColor: 'rgba(0, 0, 0, 0.04)',\n    },\n  },\n  switchBase: {\n    top: 4,\n    left: 4,\n    padding: 2,\n    color: theme.palette.grey[500],\n    '&$checked': {\n      transform: 'translateX(12px)',\n      color: theme.palette.common.white,\n      '& + $track': {\n        opacity: 1,\n        backgroundColor: theme.palette.primary.main,\n        borderColor: theme.palette.primary.main,\n      },\n    },\n  },\n  thumb: {\n    width: 12,\n    height: 12,\n    boxShadow: 'none',\n  },\n  track: {\n    border: `1px solid ${theme.palette.grey[500]}`,\n    borderRadius: 16 / 2,\n    opacity: 1,\n    backgroundColor: theme.palette.common.white,\n  },\n  checked: {},\n}))(Switch);\n\nexport default AntSwitch;\n","import React from 'react';\nimport Box from '@material-ui/core/Box';\nimport IconButton from '@material-ui/core/IconButton';\nimport RadioButtonCheckedIcon from '@material-ui/icons/RadioButtonChecked';\nimport RadioButtonUncheckedIcon from '@material-ui/icons/RadioButtonUnchecked';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport RadioGroup from '@material-ui/core/RadioGroup';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport AntSwitch from './AntSwitch';\n\nimport { useEnhancerGenesCellEncoding, useEnhancerGenesPadding } from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  iconRadio: {\n    padding: theme.spacing(0.5, 0),\n    marginLeft: -theme.spacing(1) / 2,\n    '& .MuiFormControlLabel-label': {\n      lineHeight: 1.2,\n    },\n  },\n  iconRadioActive: {\n    color: 'black',\n  },\n  iconRadioLegend: {\n    margin: theme.spacing(2, 0, 0.25, 0),\n  },\n  switch: {\n    margin: 0,\n  },\n}));\n\nconst EnhancerGenesSettings = React.memo(function EnhancerGenesSettings() {\n  const [cellEncoding, setCellEncoding] = useEnhancerGenesCellEncoding();\n  const [padding, setPadding] = useEnhancerGenesPadding();\n\n  const changeCellEncoding = (value) => () => {\n    setCellEncoding(value);\n  };\n\n  const changePadding = (event) => {\n    setPadding(event.target.checked);\n  };\n\n  const classes = useStyles();\n\n  return (\n    <React.Fragment>\n      <Box m={1}>\n        <FormControlLabel\n          className={classes.switch}\n          control={\n            <AntSwitch checked={padding} onChange={changePadding} name=\"true\" />\n          }\n          label=\"Gene padding\"\n        />\n      </Box>\n      <Box m={1}>\n        <FormControl component=\"fieldset\">\n          <FormLabel component=\"legend\" className={classes.iconRadioLegend}>\n            Gene Cell Encoding\n          </FormLabel>\n          <RadioGroup\n            aria-label=\"cellEncoding\"\n            name=\"cellEncoding\"\n            value={cellEncoding}\n          >\n            <FormControlLabel\n              label=\"Max. ABC prediction score\"\n              value=\"number\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeCellEncoding('max-score')}\n                >\n                  {cellEncoding === 'max-score' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Abs. number of predictions\"\n              value=\"number\"\n              className={classes.iconRadio}\n              control={\n                <IconButton size=\"small\" onClick={changeCellEncoding('number')}>\n                  {cellEncoding === 'number' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Rel. number of predictions per group\"\n              value=\"percent\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeCellEncoding('percent')}\n                >\n                  {cellEncoding === 'percent' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Distribution by prediction score\"\n              value=\"distribution\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeCellEncoding('distribution')}\n                >\n                  {cellEncoding === 'distribution' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Sample array\"\n              value=\"array\"\n              className={classes.iconRadio}\n              control={\n                <IconButton size=\"small\" onClick={changeCellEncoding('array')}>\n                  {cellEncoding === 'array' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n          </RadioGroup>\n        </FormControl>\n      </Box>\n    </React.Fragment>\n  );\n});\n\nexport default EnhancerGenesSettings;\n","import React, { createContext, useCallback, useState } from 'react';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst TooltipContext = createContext();\n\nconst useStyles = makeStyles({\n  root: {\n    position: 'fixed',\n    zIndex: 10,\n    width: 1,\n    height: 1,\n    background: 'transparent',\n    fontWeight: 'normal',\n    pointerEvents: 'none',\n    '& strong': {\n      fontWeight: 'bold',\n    },\n  },\n});\n\nexport default function TooltipProvider({ children }) {\n  const [localState, setLocalState] = useState({\n    show: false,\n    title: '',\n    x: 0,\n    y: 0,\n    arrow: true,\n    placement: 'bottom',\n    classes: {},\n  });\n\n  const showTooltip = useCallback(\n    (\n      x,\n      y,\n      title,\n      { arrow = false, placement = 'bottom', classes = {} } = {}\n    ) => {\n      if (Number.isNaN(+x) || Number.isNaN(+y) || !title) {\n        // Close tooltip\n        setLocalState({\n          show: false,\n          title: '',\n          x: 0,\n          y: 0,\n          arrow: true,\n          placement: 'bottom',\n          classes: {},\n        });\n      } else {\n        // Open tooltip\n        setLocalState({\n          show: true,\n          x,\n          y,\n          title,\n          arrow,\n          placement,\n          classes,\n        });\n      }\n    },\n    []\n  );\n\n  const classes = useStyles();\n\n  return (\n    <TooltipContext.Provider value={showTooltip}>\n      {children}\n      <Tooltip\n        open={localState.show}\n        title={localState.title}\n        arrow={localState.arrow}\n        placement={localState.placement}\n        classes={localState.classes}\n      >\n        <div\n          className={classes.root}\n          style={{\n            top: localState.y,\n            left: localState.x,\n          }}\n        />\n      </Tooltip>\n    </TooltipContext.Provider>\n  );\n}\n\nfunction useShowTooltip() {\n  const context = React.useContext(TooltipContext);\n  if (context === undefined) {\n    throw new Error('useShowTooltip must be used within a TooltipContext');\n  }\n  return context;\n}\n\nexport { useShowTooltip };\n","import { identity, range } from '@flekschas/utils';\nimport { axisRight, scaleLinear, scaleLog, select } from 'd3';\nimport React, {\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useMemo,\n  useState,\n} from 'react';\nimport { useRecoilValue, useRecoilState } from 'recoil';\nimport TinyQueue from 'tinyqueue';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport { useChromInfo } from './ChromInfoProvider';\nimport { useShowTooltip } from './TooltipProvider';\n\nimport {\n  enhancerGenesCellEncodingState,\n  enhancerGenesPaddingState,\n  enhancerGenesSvgState,\n  focusRegionAbsWithAssembly,\n  focusRegionRelState,\n  focusRegionState,\n  focusRegionStrState,\n  sampleSelectionState,\n  sampleGroupSelectionSizesState,\n} from './state';\n\nimport {\n  DEFAULT_COLOR_MAP,\n  DEFAULT_COLOR_MAP_DARK,\n  DEFAULT_COLOR_MAP_LIGHT,\n  DEFAULT_STRATIFICATION,\n  DEFAULT_VIEW_CONFIG_ENHANCER,\n  BIOSAMPLE_COLUMN,\n  GENE_NAME_COLUMN,\n  SAMPLE_IDX,\n} from './constants';\nimport { scaleBand } from './utils';\nimport usePrevious from './use-previous';\n\nimport './EnhancerGenesPlot.css';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    color: theme.palette.grey['300'],\n    minHeight: '6rem',\n  },\n  plot: {\n    position: 'relative',\n    flexGrow: 1,\n  },\n  plotSvg: {\n    width: '100%',\n    height: '100%',\n  },\n}));\n\nconst useTooltipStyles = DEFAULT_COLOR_MAP_LIGHT.map((color, i) =>\n  makeStyles((theme) => ({\n    arrow: {\n      color,\n    },\n    tooltip: {\n      color: DEFAULT_COLOR_MAP_DARK[i],\n      backgroundColor: color,\n      boxShadow: '0 0 3px 0 rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(0, 0, 0, 0.05)',\n      '& .value': {\n        color: 'white',\n        background: DEFAULT_COLOR_MAP_DARK[i],\n        padding: '0 0.25em',\n        borderRadius: '0.25rem',\n      },\n    },\n  }))\n);\n\nconst {\n  server,\n  tilesetUid: uuid,\n} = DEFAULT_VIEW_CONFIG_ENHANCER.views[0].tracks.top[3].contents[1];\n\nconst fetchTiles = async (tileIds) => {\n  const response = await fetch(\n    `${server}/tiles/?${tileIds.map((tileId) => `d=${tileId}`).join('&')}`\n  );\n  return response.json();\n};\n\nconst categories = {};\nconst samples = {};\n\nDEFAULT_STRATIFICATION.groups.forEach((group, i) => {\n  categories[group.label] = {\n    name: group.label,\n    size: group.categories.length,\n    index: i,\n  };\n\n  group.categories.forEach((category, j) => {\n    samples[category] = {\n      category: categories[group.label],\n      index: j,\n    };\n  });\n});\n\nconst getMinTileSize = (tilesetInfo) =>\n  tilesetInfo.max_width / 2 ** tilesetInfo.max_zoom;\n\nconst filterIntervalsByRange = (tile, absRange) =>\n  tile.filter(\n    (interval) => interval.xEnd >= absRange[0] && interval.xStart < absRange[1]\n  );\n\n// From https://observablehq.com/@d3/beeswarm\nconst dodge = (data, radius, yScale) => {\n  const radius2 = radius ** 2;\n  const circles = data\n    .map((d) => ({ y: yScale(d.score), data: d }))\n    .sort((a, b) => a.y - b.y);\n  const epsilon = 1e-3;\n  let head = null;\n  let tail = null;\n\n  // Returns true if circle x,y intersects with any circle in the queue.\n  function intersects(x, y) {\n    let a = head;\n    while (a) {\n      if (radius2 - epsilon > (a.x - x) ** 2 + (a.y - y) ** 2) {\n        return true;\n      }\n      a = a.next;\n    }\n    return false;\n  }\n\n  // Place each circle sequentially.\n  for (const b of circles) {\n    // Remove circles from the queue that cant intersect the new circle b.\n    while (head && head.y < b.y - radius2) head = head.next;\n\n    // Choose the minimum non-intersecting tangent.\n    if (intersects((b.x = 0), b.y)) {\n      let a = head;\n      b.x = Infinity;\n      do {\n        const x = a.x + Math.sqrt(radius2 - (a.y - b.y) ** 2);\n        if (x < b.x && !intersects(x, b.y)) b.x = x;\n        a = a.next;\n      } while (a);\n    }\n\n    // Add b to the queue.\n    b.next = null;\n    // eslint-disable-next-line no-multi-assign\n    if (head === null) head = tail = b;\n    // eslint-disable-next-line no-multi-assign\n    else tail = tail.next = b;\n  }\n\n  return circles;\n};\n\nconst plotEnhancerGeneConnections = (\n  node,\n  width,\n  data,\n  {\n    geneCellEncoding = 'distribution',\n    prevGeneCellEncoding,\n    genePadding = false,\n    showTooltip = identity,\n    tooltipClasses = [],\n    position = '',\n    focusRegion = null,\n  } = {}\n) => {\n  if (!width || !data) return;\n\n  const svg = select(node);\n\n  const paddingTop = 60;\n  const paddingBottom = 60;\n  const circleRadius = 1;\n  const circlePadding = 0.5;\n  const rowHeight = 36;\n  const geneLabelPadding = 3;\n  const beeswarmPadding = 1;\n  const distanceBarWidth = 6;\n  const distPaddingRange = [0, 20];\n  const height =\n    Object.values(categories).length * rowHeight + paddingTop + paddingBottom;\n\n  svg.attr('viewbox', `0 0 ${width} ${height}`).attr('height', height);\n\n  const maxCatgorySize = Object.values(data.categoryAggregation).reduce(\n    (max, cat) => Math.max(max, cat.numEnhancers),\n    0\n  );\n\n  const categorySizeScale = scaleLog()\n    .domain([1, maxCatgorySize])\n    .range([2, rowHeight])\n    .clamp(true);\n\n  const percentScale = scaleLinear()\n    .domain([0, 1])\n    .range([0, rowHeight])\n    .clamp(true);\n\n  const scoreScale = scaleLinear()\n    .domain([0, data.maxScore])\n    .range([0, rowHeight])\n    .clamp(true);\n\n  const circleYScalePre = scaleLinear()\n    .domain([0, 1])\n    .range([1, 10])\n    .clamp(true);\n\n  const circleYScalePost = scaleLog()\n    .domain([1, 10])\n    .range([\n      rowHeight - circleRadius - beeswarmPadding,\n      circleRadius + beeswarmPadding,\n    ]);\n\n  const circleYScale = (v) => circleYScalePost(circleYScalePre(v));\n\n  // ---------------------------------------------------------------------------\n  // Gene setup\n  const geneContainerWidth = width / 2 - rowHeight;\n  const maxGenes = Math.floor(geneContainerWidth / rowHeight);\n\n  const genesUpstream = data.genesUpstreamByDist.slice(0, maxGenes).reverse();\n  const genesDownstream = data.genesDownstreamByDist.slice(0, maxGenes);\n\n  const [minRelDistance, maxRelDistance] = [\n    ...genesUpstream,\n    ...genesDownstream,\n  ].reduce(\n    (minMax, gene) => [\n      Math.min(minMax[0], gene.relDistance),\n      Math.max(minMax[1], gene.relDistance),\n    ],\n    [Infinity, 0]\n  );\n\n  const paddingScale = scaleLinear()\n    .domain([minRelDistance, maxRelDistance])\n    .range(distPaddingRange);\n\n  const genesUpstreamPadding = genePadding\n    ? genesUpstream.map((d) => Math.round(paddingScale(d.relDistance)))\n    : [];\n  const genesUpstreamScale = scaleBand()\n    .domain(genesUpstream.map((d) => d.name))\n    .range([0, width / 2 - rowHeight / 2])\n    .paddingInner(genesUpstreamPadding);\n\n  const genesDownstreamPadding = genePadding\n    ? genesDownstream.map((d) => Math.round(paddingScale(d.relDistance)))\n    : [];\n  const genesDownstreamScale = scaleBand()\n    .domain(genesDownstream.map((d) => d.name))\n    .range([0, width / 2 - rowHeight / 2])\n    .paddingInner(genesDownstreamPadding)\n    .paddingInnerZeroBased(true);\n\n  const bandwidth = Math.min(\n    genesUpstreamScale.bandwidth(),\n    genesDownstreamScale.bandwidth()\n  );\n\n  genesUpstreamScale.fixedBandwidth(bandwidth);\n  genesDownstreamScale.fixedBandwidth(bandwidth);\n\n  const genesUpstreamLeftPad = Math.max(\n    0,\n    genesUpstreamScale.rangeSize() - genesUpstreamScale.totalWidth()\n  );\n\n  const minVisibleAbsDist = Math.min(\n    genesUpstream.reduce(\n      (minDist, gene) => Math.min(minDist, gene.absDistance),\n      Infinity\n    ),\n    genesDownstream.reduce(\n      (minDist, gene) => Math.min(minDist, gene.absDistance),\n      Infinity\n    )\n  );\n\n  const maxVisibleAbsDist = Math.max(\n    genesUpstream.reduce(\n      (maxDist, gene) => Math.max(maxDist, gene.absDistance),\n      0\n    ),\n    genesDownstream.reduce(\n      (maxDist, gene) => Math.max(maxDist, gene.absDistance),\n      0\n    )\n  );\n\n  const distanceHeightScale = scaleLinear()\n    .domain([minVisibleAbsDist, maxVisibleAbsDist])\n    .range([2, paddingBottom]);\n\n  const plotBeeswarm = (selection, { isRightAligned = false } = {}) => {\n    selection\n      .attr(\n        'fill',\n        (d, i) => DEFAULT_COLOR_MAP_DARK[i % DEFAULT_COLOR_MAP_DARK.length]\n      )\n      .selectAll('circle')\n      .data((d) => dodge(d, circleRadius * 2 + circlePadding, circleYScale))\n      .join('circle')\n      .attr('cx', (d) =>\n        isRightAligned\n          ? genesUpstreamScale.bandwidth() - (d.x + 2 * beeswarmPadding)\n          : d.x + circleRadius + beeswarmPadding\n      )\n      .attr('cy', (d) => d.y)\n      .attr('r', circleRadius);\n  };\n\n  const getArrayNumCols = (genes) => {\n    const maxSize = Object.values(genes[0].samplesByCategory).reduce(\n      (max, cat) => Math.max(max, cat.size),\n      0\n    );\n    return Math.ceil(Math.sqrt((maxSize * bandwidth) / rowHeight));\n  };\n\n  const plotArray = (\n    selection,\n    numCols,\n    {\n      instanceCache = {},\n      onMouseEnter = identity,\n      onMouseLeave = identity,\n      tooltipTitleGetter = null,\n    } = {}\n  ) => {\n    const cellSize = bandwidth / numCols;\n\n    const indexToX = (index) => (index % numCols) * cellSize;\n    const indexToY = (index) => Math.floor(index / numCols) * cellSize;\n\n    instanceCache.current = selection\n      .attr(\n        'fill',\n        (d, i) => DEFAULT_COLOR_MAP_DARK[i % DEFAULT_COLOR_MAP_DARK.length]\n      )\n      .selectAll('rect')\n      .data(\n        (d) => d,\n        (d) => `${d.gene}|${d.sample}`\n      )\n      .join('rect')\n      .attr('x', (d) => indexToX(samples[d.sample].index))\n      .attr('y', (d) => indexToY(samples[d.sample].index))\n      .attr('width', cellSize)\n      .attr('height', cellSize)\n      .on('mouseenter', (event, d) => {\n        const bBox = event.target.getBoundingClientRect();\n        const title =\n          (tooltipTitleGetter && tooltipTitleGetter(d)) || d.score.toFixed(3);\n        showTooltip(bBox.x + bBox.width / 2, bBox.y, title, {\n          arrow: true,\n          placement: 'top',\n          classes:\n            tooltipClasses[\n              categories[d.sampleCategory].index % tooltipClasses.length\n            ],\n        });\n        onMouseEnter(d);\n      })\n      .on('mouseleave', (d) => {\n        showTooltip();\n        onMouseLeave(d);\n      });\n  };\n\n  const arrayTooltipTitleGetter = (d) => (\n    <React.Fragment>\n      The enhancer overlapping <strong>{position}</strong>\n      {focusRegion ? ` (${focusRegion})` : ''} is predicted to regulate{' '}\n      <strong>{d.gene}</strong> in sample <strong>{d.sample}</strong> with a\n      score of <strong className=\"value\">{d.score.toFixed(3)}</strong>.\n    </React.Fragment>\n  );\n\n  const geneArrayInstances = {\n    upstream: { current: null },\n    downstream: { current: null },\n  };\n\n  const geneArrayInstanceMouseEnterHandler = (dHovering) => {\n    const opacity = (d) => (d.sample === dHovering.sample ? 1 : 0.2);\n    geneArrayInstances.upstream.current.attr('opacity', opacity);\n    geneArrayInstances.downstream.current.attr('opacity', opacity);\n  };\n\n  const geneArrayInstanceMouseLeaveHandler = () => {\n    geneArrayInstances.upstream.current.attr('opacity', 1);\n    geneArrayInstances.downstream.current.attr('opacity', 1);\n  };\n\n  const plotBox = (\n    selection,\n    valueScale,\n    valueGetter,\n    {\n      cellWidth = rowHeight,\n      fillColor = DEFAULT_COLOR_MAP_LIGHT,\n      forceMaxSize = false,\n      textColor = DEFAULT_COLOR_MAP_DARK,\n      showText = true,\n      showZero = true,\n      showTooltip: showTooltipOnMouseEnter = false,\n      tooltipTitleGetter = null,\n    } = {}\n  ) => {\n    const sizeGetter = forceMaxSize\n      ? () => valueScale.range()[1]\n      : (d) => valueScale(valueGetter(d));\n\n    const bg = selection\n      .selectAll('.bg')\n      .data((d) => [d])\n      .join('rect')\n      .attr('class', 'bg')\n      .attr('fill', (d) => fillColor[d.row % fillColor.length])\n      .attr('x', (d) => (cellWidth - sizeGetter(d)) / 2)\n      .attr('y', (d) => (rowHeight - sizeGetter(d)) / 2)\n      .attr('width', sizeGetter)\n      .attr('height', sizeGetter)\n      .attr('opacity', (d) => +(valueGetter(d) > 0));\n\n    if (showTooltipOnMouseEnter) {\n      bg.on('mouseenter', (event, d) => {\n        const bBox = event.target.getBoundingClientRect();\n        const title =\n          (tooltipTitleGetter && tooltipTitleGetter(d)) || valueGetter(d);\n        showTooltip(bBox.x + bBox.width / 2, bBox.y, title, {\n          arrow: true,\n          placement: 'top',\n          classes: tooltipClasses[d.row % tooltipClasses.length],\n        });\n      }).on('mouseleave', () => {\n        showTooltip();\n      });\n    } else {\n      bg.on('mouseenter', null).on('mouseleave', null);\n    }\n\n    if (showText) {\n      let style = 'font-size: 12px; font-weight: bold;';\n      if (showTooltip) style += ' pointer-events: none;';\n      selection\n        .selectAll('.box-text')\n        .data((d) => [d])\n        .join('text')\n        .attr('class', 'box-text')\n        .attr('fill', (d) => textColor[d.row % textColor.length])\n        .attr('style', style)\n        .attr('dominant-baseline', 'middle')\n        .attr('text-anchor', 'middle')\n        .attr('x', cellWidth / 2)\n        .attr('y', rowHeight / 2)\n        .attr('opacity', (d) => +(valueGetter(d) > 0 || showZero))\n        .text((d) => valueGetter(d));\n    }\n  };\n\n  const enhancerTooltipTitleGetter = (d) => (\n    <React.Fragment>\n      Found {d.numEnhancers} active enhancer overlapping {position} across all{' '}\n      {d.category.size} {Object.values(categories)[d.row].name} samples.\n    </React.Fragment>\n  );\n\n  const boxTooltipTitleGetter = (d) => (\n    <React.Fragment>\n      <strong className=\"value\">{d.length}</strong> active enhancers found\n      across {d.size} {Object.values(categories)[d.row].name} samples.\n    </React.Fragment>\n  );\n\n  const boxScoreTooltipTitleGetter = (d) => (\n    <React.Fragment>\n      The most likely active enhancer for {d.maxScoreSample.gene} has an ABC\n      score of <strong className=\"value\">{d.maxScore.toFixed(3)}</strong> and is\n      found in {d.maxScoreSample.sample.replaceAll('_', ' ')} (Overall max. ABC\n      score is {data.maxScore.toFixed(3)}).\n    </React.Fragment>\n  );\n\n  // ---------------------------------------------------------------------------\n  // Category summary\n  const enhancerG = svg\n    .select('#enhancers')\n    .attr('transform', `translate(${width / 2 - rowHeight / 2}, 0)`);\n\n  // Draw background\n  const enhancerGCellG = enhancerG\n    .selectAll('.enhancer-gene-aggregate')\n    .data(\n      Object.values(data.categoryAggregation).map((d, i) => {\n        // Little hacky but necessary unfortunately\n        d.row = i;\n        return d;\n      }),\n      (d) => d.category.name\n    )\n    .join('g')\n    .attr('class', 'enhancer-gene-aggregate')\n    .attr('transform', (d, i) => `translate(0, ${i * rowHeight + paddingTop})`);\n\n  plotBox(enhancerGCellG, categorySizeScale, (d) => d.numEnhancers, {\n    fillColor: ['#fff'],\n    showTooltip: true,\n    tooltipTitleGetter: enhancerTooltipTitleGetter,\n    forceMaxSize: true,\n  });\n\n  // Draw border\n  svg\n    .select('#enhancers')\n    .selectAll('.enhancer-box-border')\n    .data(Object.values(categories), (d) => d.name)\n    .join('rect')\n    .attr('class', 'enhancer-box-border')\n    .attr('fill', 'none')\n    .attr(\n      'stroke',\n      (d, i) => DEFAULT_COLOR_MAP_LIGHT[i % DEFAULT_COLOR_MAP_LIGHT.length]\n    )\n    .attr('stroke-width', '1')\n    .attr('x', 0)\n    .attr('y', (d, i) => i * rowHeight + paddingTop)\n    .attr('width', rowHeight)\n    .attr('height', rowHeight);\n\n  // ---------------------------------------------------------------------------\n  // Draw upstream genes\n\n  const genesUpstreamG = svg\n    .select('#genes-upstream')\n    .selectAll('.gene-upstream')\n    .data(genesUpstream, (d) => d.name)\n    .join('g')\n    .attr('class', 'gene-upstream')\n    .attr(\n      'transform',\n      (d) =>\n        `translate(${genesUpstreamLeftPad + genesUpstreamScale(d.name)}, 0)`\n    );\n\n  // Draw labels\n  const geneLabelX = genesUpstreamScale.bandwidth() / 2;\n  const geneLabelY = paddingTop - geneLabelPadding;\n  genesUpstreamG\n    // the join is needed to avoid appending more and more text elements on\n    // subsequent calls of this function, which would happen if we used\n    // `append()` instead.\n    .selectAll('.gene-upstream-label')\n    .data((d) => [d])\n    .join('text')\n    .attr('class', 'gene-label gene-upstream-label')\n    .attr('style', 'font-size: 9px;')\n    .attr('transform', `translate(${geneLabelX},${geneLabelY}) rotate(-90)`)\n    .attr('fill', 'black')\n    .attr('dominant-baseline', 'middle')\n    .text((d) => d.name);\n\n  // Draw cell\n  const genesUpstreamGCellG = genesUpstreamG\n    .selectAll('.gene-upstream-cell')\n    .data(\n      (d) =>\n        Object.values(d.samplesByCategory).map((item, i) => {\n          // Little hacky but necessary unfortunately\n          item.row = i;\n          return item;\n        }),\n      (d) => d.name\n    )\n    .join('g')\n    .attr('class', 'gene-upstream-cell')\n    .attr('transform', (d, i) => `translate(0, ${i * rowHeight + paddingTop})`);\n\n  if (geneCellEncoding !== prevGeneCellEncoding) {\n    genesUpstreamGCellG.selectAll('*').remove();\n  }\n\n  switch (geneCellEncoding) {\n    case 'distribution':\n      plotBeeswarm(genesUpstreamGCellG, { isRightAligned: true });\n      break;\n\n    case 'array':\n      plotArray(genesUpstreamGCellG, getArrayNumCols(genesUpstream), {\n        tooltipTitleGetter: arrayTooltipTitleGetter,\n        instanceCache: geneArrayInstances.upstream,\n        onMouseEnter: geneArrayInstanceMouseEnterHandler,\n        onMouseLeave: geneArrayInstanceMouseLeaveHandler,\n      });\n      break;\n\n    case 'number':\n    case 'percent': {\n      const valueScale =\n        geneCellEncoding === 'percent' ? percentScale : categorySizeScale;\n\n      const valueGetter =\n        geneCellEncoding === 'percent'\n          ? (d) => d.length / d.size\n          : (d) => d.length;\n\n      plotBox(genesUpstreamGCellG, valueScale, valueGetter, {\n        showText: false,\n        cellWidth: genesUpstreamScale.bandwidth(),\n        fillColor: DEFAULT_COLOR_MAP,\n        showTooltip: true,\n        tooltipTitleGetter: boxTooltipTitleGetter,\n      });\n\n      break;\n    }\n\n    case 'max-score':\n    default: {\n      plotBox(genesUpstreamGCellG, scoreScale, (d) => d.maxScore, {\n        showText: false,\n        cellWidth: genesUpstreamScale.bandwidth(),\n        fillColor: DEFAULT_COLOR_MAP,\n        showTooltip: true,\n        tooltipTitleGetter: boxScoreTooltipTitleGetter,\n      });\n\n      break;\n    }\n  }\n\n  // Draw border\n  genesUpstreamG\n    .selectAll('.gene-upstream-border')\n    .data(Object.values(categories), (d) => d.name)\n    .join('rect')\n    .attr('class', 'gene-upstream-border')\n    .attr('fill', 'none')\n    .attr(\n      'stroke',\n      (d, i) => DEFAULT_COLOR_MAP_LIGHT[i % DEFAULT_COLOR_MAP_LIGHT.length]\n    )\n    .attr('stroke-width', '1')\n    .attr('x', 0)\n    .attr('y', (d, i) => i * rowHeight + paddingTop)\n    .attr('width', genesUpstreamScale.bandwidth())\n    .attr('height', rowHeight);\n\n  // Draw distance bars\n  genesUpstreamG\n    // Same reason we're using a join here as for the text labels above\n    .selectAll('.gene-upstream-distance-bar')\n    .data((d) => [d])\n    .join('rect')\n    .attr('class', 'gene-upstream-distance-bar')\n    .attr('fill', '#bbbbbb')\n    .attr('x', genesUpstreamScale.bandwidth() / 2 - distanceBarWidth / 2)\n    .attr('y', Object.values(categories).length * rowHeight + paddingTop)\n    .attr('width', distanceBarWidth)\n    .attr('height', (d) => distanceHeightScale(d.absDistance));\n\n  // ---------------------------------------------------------------------------\n  // Draw downstream genes\n  svg\n    .select('#genes-downstream')\n    .attr('transform', `translate(${width / 2 + rowHeight / 2}, 0)`);\n\n  const genesDownstreamG = svg\n    .select('#genes-downstream')\n    .selectAll('.gene-downstream')\n    .data(genesDownstream, (d) => d.name)\n    .join('g')\n    .attr('class', 'gene-downstream')\n    .attr('transform', (d) => `translate(${genesDownstreamScale(d.name)}, 0)`);\n\n  // Draw labels\n  genesDownstreamG\n    .selectAll('.gene-downstream-label')\n    .data((d) => [d])\n    .join('text')\n    .attr('class', 'gene-label gene-downstream-label')\n    .attr('style', 'font-size: 9px;')\n    .attr('transform', `translate(${geneLabelX},${geneLabelY}) rotate(-90)`)\n    .attr('fill', 'black')\n    .attr('dominant-baseline', 'middle')\n    .text((d) => d.name);\n\n  // Draw cell\n  const genesDownstreamGCellG = genesDownstreamG\n    .selectAll('.gene-downstream-cell')\n    .data(\n      (d) =>\n        Object.values(d.samplesByCategory).map((item, i) => {\n          // Little hacky but necessary unfortunately\n          item.row = i;\n          return item;\n        }),\n      (d) => d.name\n    )\n    .join('g')\n    .attr('class', 'gene-downstream-cell')\n    .attr('transform', (d, i) => `translate(0, ${i * rowHeight + paddingTop})`);\n\n  if (geneCellEncoding !== prevGeneCellEncoding) {\n    genesDownstreamGCellG.selectAll('*').remove();\n  }\n\n  switch (geneCellEncoding) {\n    case 'distribution':\n      plotBeeswarm(genesDownstreamGCellG);\n      break;\n\n    case 'array':\n      plotArray(genesDownstreamGCellG, getArrayNumCols(genesDownstream), {\n        tooltipTitleGetter: arrayTooltipTitleGetter,\n        instanceCache: geneArrayInstances.downstream,\n        onMouseEnter: geneArrayInstanceMouseEnterHandler,\n        onMouseLeave: geneArrayInstanceMouseLeaveHandler,\n      });\n      break;\n\n    case 'number':\n    case 'percent': {\n      const valueScale =\n        geneCellEncoding === 'percent' ? percentScale : categorySizeScale;\n\n      const valueGetter =\n        geneCellEncoding === 'percent'\n          ? (d) => d.length / d.size\n          : (d) => d.length;\n\n      plotBox(genesDownstreamGCellG, valueScale, valueGetter, {\n        showText: false,\n        cellWidth: genesDownstreamScale.bandwidth(),\n        fillColor: DEFAULT_COLOR_MAP,\n        showTooltip: true,\n        tooltipTitleGetter: boxTooltipTitleGetter,\n      });\n\n      break;\n    }\n\n    case 'max-score':\n    default: {\n      plotBox(genesDownstreamGCellG, scoreScale, (d) => d.maxScore, {\n        showText: false,\n        cellWidth: genesDownstreamScale.bandwidth(),\n        fillColor: DEFAULT_COLOR_MAP,\n        showTooltip: true,\n        tooltipTitleGetter: boxScoreTooltipTitleGetter,\n      });\n\n      break;\n    }\n  }\n\n  // Draw border\n  genesDownstreamG\n    .selectAll('.gene-downstream-border')\n    .data(Object.values(categories), (d) => d.name)\n    .join('rect')\n    .attr('class', 'gene-downstream-border')\n    .attr('fill', 'none')\n    .attr(\n      'stroke',\n      (d, i) => DEFAULT_COLOR_MAP_LIGHT[i % DEFAULT_COLOR_MAP_LIGHT.length]\n    )\n    .attr('stroke-width', '1')\n    .attr('x', 0)\n    .attr('y', (d, i) => i * rowHeight + paddingTop)\n    .attr('width', genesDownstreamScale.bandwidth())\n    .attr('height', rowHeight);\n\n  // Draw distance bars\n  genesDownstreamG\n    // Same reason we're using a join here as for the text labels above\n    .selectAll('.gene-downstream-distance-bar')\n    .data((d) => [d])\n    .join('rect')\n    .attr('class', 'gene-downstream-distance-bar')\n    .attr('fill', '#bbbbbb')\n    .attr('x', genesDownstreamScale.bandwidth() / 2 - distanceBarWidth / 2)\n    .attr('y', Object.values(categories).length * rowHeight + paddingTop)\n    .attr('width', distanceBarWidth)\n    .attr('height', (d) => distanceHeightScale(d.absDistance));\n\n  // ---------------------------------------------------------------------------\n  // Draw gene distance axis\n\n  const distRange = Math.ceil((maxVisibleAbsDist - minVisibleAbsDist) / 1e5);\n  const distStep = Math.ceil(distRange / 4);\n  const tickValues =\n    distRange <= 1\n      ? [minVisibleAbsDist, maxVisibleAbsDist]\n      : Array(4)\n          .fill()\n          .map(\n            (v, i) =>\n              Math.ceil(minVisibleAbsDist / 1e5) * 1e5 + i * (distStep * 1e5)\n          );\n\n  svg\n    .select('#gene-distance-axis')\n    .attr(\n      'transform',\n      `translate(0, ${\n        Object.values(categories).length * rowHeight + paddingTop\n      })`\n    )\n    .call(\n      axisRight(distanceHeightScale)\n        .tickSize(width)\n        .tickFormat(function geneDistanceAxisTickFormat(d) {\n          const s = (d / 1e6).toFixed(1);\n          return this.parentNode.nextSibling\n            ? s\n            : `${s} Mbp distance to enhancer`;\n        })\n        .tickValues(tickValues)\n    )\n    .call((g) => g.select('.domain').remove())\n    .call((g) =>\n      g\n        .selectAll('.tick line')\n        .attr('stroke', '#bbbbbb')\n        .attr('stroke-width', 0.5)\n        .attr('stroke-dasharray', '4,4')\n    )\n    .call((g) =>\n      g\n        .selectAll('.tick text')\n        .attr('fill', '#bbbbbb')\n        .attr('x', width / 2)\n        .attr('dy', 1)\n        .attr('text-anchor', 'middle')\n        .attr('dominant-baseline', 'hanging')\n    );\n};\n\nconst EnhancerGenesPlot = React.memo(function EnhancerGenesPlot() {\n  const chromInfo = useChromInfo();\n  const showTooltip = useShowTooltip();\n\n  const sampleSelection = useRecoilValue(sampleSelectionState);\n  const sampleGroupSelectionSizes = useRecoilValue(\n    sampleGroupSelectionSizesState\n  );\n  const geneCellEncoding = useRecoilValue(enhancerGenesCellEncodingState);\n  const absRange = useRecoilValue(focusRegionAbsWithAssembly(chromInfo));\n  const focusRegion = useRecoilValue(focusRegionState);\n  const relPosition = useRecoilValue(focusRegionRelState);\n  const strPosition = useRecoilValue(focusRegionStrState);\n  const genePadding = useRecoilValue(enhancerGenesPaddingState);\n\n  const [plotEl, setPlotEl] = useRecoilState(enhancerGenesSvgState);\n\n  const [tile, setTile] = useState(null);\n  const [isLoadingTile, setIsLoadingTile] = useState(null);\n  const [tilesetInfo, setTilesetInfo] = useState(null);\n  const [width, setWidth] = useState(null);\n  const prevWidth = usePrevious(width);\n  const prevGeneCellEncoding = usePrevious(geneCellEncoding);\n\n  useEffect(() => {\n    // Determine highest resolution tiles\n    let active = true;\n\n    if (absRange === null || tilesetInfo === null) return undefined;\n\n    const [absStart, absEnd] = absRange;\n    const regionLength = Math.abs(absEnd - absStart);\n\n    const minTileSize = getMinTileSize(tilesetInfo);\n\n    const k = 5;\n    const zoomOutLevel = Math.max(\n      0,\n      Math.ceil(Math.log2(regionLength / minTileSize / k))\n    );\n    const zoomLevel = tilesetInfo.max_zoom - zoomOutLevel;\n\n    const tileSize = minTileSize * 2 ** zoomOutLevel;\n\n    const tileXPosStart = Math.floor(absStart / tileSize);\n    const tileXPosEnd = Math.floor(absEnd / tileSize);\n\n    const tileIds = range(tileXPosStart, tileXPosEnd + 1).reduce(\n      (ids, xPos) => {\n        ids.push(`${uuid}.${zoomLevel}.${xPos}`);\n        return ids;\n      },\n      []\n    );\n\n    setIsLoadingTile(true);\n    fetchTiles(tileIds).then((tiles) => {\n      if (active) {\n        setIsLoadingTile(false);\n        setTile(filterIntervalsByRange(Object.values(tiles).flat(), absRange));\n      }\n    });\n\n    return () => {\n      active = false;\n    };\n  }, [absRange, tilesetInfo]);\n\n  const plotElRef = useCallback(\n    (node) => {\n      setPlotEl(node);\n    },\n    [setPlotEl]\n  );\n\n  // Derived State\n  const isInit = useMemo(() => !!tilesetInfo, [tilesetInfo]);\n\n  const data = useMemo(\n    () => {\n      if (!tile) return undefined;\n\n      let maxScore = 0;\n      let minAbsDistance = Infinity;\n      let maxAbsDistance = 0;\n      const genes = {};\n      const categoryAggregation = {};\n\n      Object.entries(categories).forEach(([name, category]) => {\n        categoryAggregation[name] = {\n          category,\n          numEnhancers: 0,\n        };\n      });\n\n      const distComparator = (a, b) => a.absDistance - b.absDistance;\n      const genesUpstreamByDist = new TinyQueue([], distComparator);\n      const genesDownstreamByDist = new TinyQueue([], distComparator);\n\n      tile.forEach((entry) => {\n        const sample = entry.fields[BIOSAMPLE_COLUMN];\n\n        // Exclude samples that have been deselected\n        if (!sampleSelection[SAMPLE_IDX[sample]]) return;\n\n        const geneName = entry.fields[GENE_NAME_COLUMN];\n\n        if (!genes[geneName]) {\n          const relGenePos = +entry.fields[4];\n          const distance = relGenePos - relPosition;\n          const isDownstream = distance > 0;\n          const absDistance = Math.abs(distance);\n          genes[geneName] = {\n            name: geneName,\n            position: relGenePos,\n            absDistance,\n            isDownstream,\n            samplesByCategory: {},\n          };\n\n          Object.values(categories).forEach(({ name, size }) => {\n            genes[geneName].samplesByCategory[name] = [];\n            genes[geneName].samplesByCategory[name].maxScore = 0;\n            genes[geneName].samplesByCategory[name].size =\n              sampleGroupSelectionSizes[name];\n          });\n\n          minAbsDistance = Math.min(minAbsDistance, absDistance);\n          maxAbsDistance = Math.max(maxAbsDistance, absDistance);\n\n          if (isDownstream) genesDownstreamByDist.push(genes[geneName]);\n          else genesUpstreamByDist.push(genes[geneName]);\n        }\n\n        const sampleCat = samples[sample].category.name;\n        const sampleObj = {\n          gene: geneName,\n          sample,\n          sampleCategory: sampleCat,\n          score: entry.importance,\n        };\n\n        genes[geneName].samplesByCategory[sampleCat].push(sampleObj);\n\n        if (\n          entry.importance >\n          genes[geneName].samplesByCategory[sampleCat].maxScore\n        ) {\n          genes[geneName].samplesByCategory[sampleCat].maxScore =\n            entry.importance;\n          genes[geneName].samplesByCategory[\n            sampleCat\n          ].maxScoreSample = sampleObj;\n        }\n\n        maxScore = Math.max(maxScore, entry.importance);\n        categoryAggregation[sampleCat].numEnhancers++;\n      });\n\n      const genesDownstreamByDistArr = [];\n      while (genesDownstreamByDist.length)\n        genesDownstreamByDistArr.push(genesDownstreamByDist.pop());\n\n      const genesUpstreamByDistArr = [];\n      while (genesUpstreamByDist.length)\n        genesUpstreamByDistArr.push(genesUpstreamByDist.pop());\n\n      genesDownstreamByDistArr.forEach((gene, i) => {\n        const prevGene = genesDownstreamByDistArr[i - 1];\n        gene.relDistance =\n          gene.position - ((prevGene && prevGene.position) || relPosition);\n      });\n\n      genesUpstreamByDistArr.forEach((gene, i) => {\n        const prevGene = genesDownstreamByDistArr[i - 1];\n        gene.relDistance =\n          ((prevGene && prevGene.position) || relPosition) - gene.position;\n      });\n\n      return {\n        minAbsDistance,\n        maxAbsDistance,\n        maxScore,\n        genes,\n        genesDownstreamByDist: genesDownstreamByDistArr,\n        genesUpstreamByDist: genesUpstreamByDistArr,\n        categoryAggregation,\n      };\n    },\n    // `relPosition` is excluded on purpose because `tile` is already updated\n    // when `relPosition` updates\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [tile, sampleGroupSelectionSizes, sampleSelection]\n  );\n\n  // Initialization\n  useEffect(\n    () => {\n      (async () => {\n        const response = await fetch(`${server}/tileset_info/?d=${uuid}`);\n        const results = await response.json();\n\n        if (results[uuid]) setTilesetInfo(results[uuid]);\n      })();\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n\n  // Rendering\n  const classes = useStyles();\n\n  useLayoutEffect(\n    () => {\n      if (!plotEl) return undefined;\n\n      const measure = () =>\n        window.requestAnimationFrame(() => {\n          const currWidth = plotEl.getBoundingClientRect().width;\n          if (currWidth !== prevWidth) setWidth(currWidth);\n        });\n\n      measure();\n\n      window.addEventListener('resize', measure);\n      window.addEventListener('orientationchange', measure);\n\n      return () => {\n        window.removeEventListener('resize', measure);\n        window.removeEventListener('orientationchange', measure);\n      };\n    },\n    // `prevWidth` is ommitted on purpose to avoid circular updates.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [plotEl]\n  );\n\n  const tooltipClasses = [];\n  for (let i = 0; i < useTooltipStyles.length; i++) {\n    tooltipClasses.push(useTooltipStyles[i]());\n  }\n\n  useEffect(\n    () => {\n      plotEnhancerGeneConnections(plotEl, width, data, {\n        geneCellEncoding,\n        prevGeneCellEncoding,\n        genePadding,\n        showTooltip,\n        classes,\n        tooltipClasses,\n        position: strPosition,\n        focusRegion,\n      });\n    },\n    // `prevGeneCellEncoding` is ommitted on purpose to avoid circular updates.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [plotEl, width, data, geneCellEncoding, genePadding, showTooltip]\n  );\n\n  return (\n    <Grid\n      className={classes.root}\n      container\n      justify=\"center\"\n      alignItems=\"center\"\n    >\n      {isInit && !isLoadingTile ? (\n        <Grid item className={classes.plot}>\n          <svg ref={plotElRef} className={classes.plotSvg}>\n            <g id=\"enhancers\"></g>\n            <g id=\"gene-distance-axis\"></g>\n            <g id=\"genes-upstream\"></g>\n            <g id=\"genes-downstream\"></g>\n          </svg>\n        </Grid>\n      ) : (\n        <CircularProgress color=\"inherit\" />\n      )}\n    </Grid>\n  );\n});\n\nexport default EnhancerGenesPlot;\n","import React from 'react';\nimport { useRecoilValue } from 'recoil';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport EnhancerGenesInfo from './EnhancerGenesInfo';\nimport EnhancerGenesHelp from './EnhancerGenesHelp';\nimport EnhancerGenesSettings from './EnhancerGenesSettings';\nimport EnhancerGenesPlot from './EnhancerGenesPlot';\nimport TitleBar from './TitleBar';\n\nimport { focusRegionState, useEnhancerGenesShowInfos } from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  plot: {\n    minHeight: '6rem',\n  },\n}));\n\nconst EnhancerGenes = React.memo(function EnhancerGenes() {\n  const focusRegion = useRecoilValue(focusRegionState);\n\n  const classes = useStyles();\n\n  return (\n    <div>\n      <TitleBar\n        id=\"enhancer-gene\"\n        title=\"Enhancer-Gene Connections\"\n        popoverDirection=\"top\"\n        useShowInfo={useEnhancerGenesShowInfos}\n        Info={EnhancerGenesInfo}\n        Help={EnhancerGenesHelp}\n        Settings={EnhancerGenesSettings}\n      />\n      <div className={classes.plot}>{focusRegion && <EnhancerGenesPlot />}</div>\n    </div>\n  );\n});\n\nexport default EnhancerGenes;\n","import React from 'react';\nimport { useRecoilValue } from 'recoil';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport { useChromInfo } from './ChromInfoProvider';\n\nimport {\n  dnaAccessLabelShowInfoState,\n  dnaAccessXDomainWithAssembly,\n} from './state';\n\nimport { toFixed } from './utils';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n    justifyContent: 'space-between',\n  },\n  text: {\n    fontSize: '0.8rem',\n  },\n}));\n\nconst DnaAccessibilityInfo = React.memo(function DnaAccessibilityInfo() {\n  const chromInfo = useChromInfo();\n\n  const showInfo = useRecoilValue(dnaAccessLabelShowInfoState);\n  const xDomainAbs = useRecoilValue(dnaAccessXDomainWithAssembly(chromInfo));\n\n  const classes = useStyles();\n\n  const dnaAccessibilityRegionSize = Math.round(\n    (xDomainAbs[1] - xDomainAbs[0]) / 1000\n  );\n\n  if (!showInfo) return '';\n\n  return (\n    <div className={classes.root}>\n      <span></span>\n      <Typography align=\"center\" className={classes.text} noWrap>\n        {toFixed(dnaAccessibilityRegionSize, 1)}{' '}\n        <abbr title=\"kilo base pairs\">Kbp</abbr>\n      </Typography>\n      <span></span>\n    </div>\n  );\n});\n\nexport default DnaAccessibilityInfo;\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\n\nconst DnaAccessibilityHelp = React.memo(function DnaAccessibilityHelp() {\n  return (\n    <Typography>\n      This panel visualizes the DNA accessibility of all 131 samples. Each track\n      is individually normalized. Mouse over a track to see the underlying\n      value. To focus on a specific locus specify a focus variant.\n    </Typography>\n  );\n});\n\nexport default DnaAccessibilityHelp;\n","import React from 'react';\nimport Box from '@material-ui/core/Box';\nimport IconButton from '@material-ui/core/IconButton';\nimport RadioButtonCheckedIcon from '@material-ui/icons/RadioButtonChecked';\nimport RadioButtonUncheckedIcon from '@material-ui/icons/RadioButtonUnchecked';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport RadioGroup from '@material-ui/core/RadioGroup';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport AntSwitch from './AntSwitch';\n\nimport { useDnaAccessLabelStyle, useDnaAccessRowNorm } from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  iconRadioLegend: {\n    margin: theme.spacing(2, 0, 0.25, 0),\n  },\n  switch: {\n    margin: 0,\n  },\n}));\n\nconst DnaAccessibilitySettings = React.memo(\n  function DnaAccessibilitySettings() {\n    const [\n      dnaAccessLabelStyle,\n      setDnaAccessLabelStyle,\n    ] = useDnaAccessLabelStyle();\n    const [dnaAccessRowNorm, setDnaAccessRowNorm] = useDnaAccessRowNorm();\n\n    const changeDnaAccessLabelStyle = (value) => () => {\n      setDnaAccessLabelStyle(value);\n    };\n\n    const changeDnaAccessRowNorm = (event) => {\n      setDnaAccessRowNorm(event.target.checked);\n    };\n\n    // On every render\n    const classes = useStyles();\n\n    return (\n      <React.Fragment>\n        <Box m={1}>\n          <FormControlLabel\n            className={classes.switch}\n            control={\n              <AntSwitch\n                checked={dnaAccessRowNorm}\n                onChange={changeDnaAccessRowNorm}\n                name=\"true\"\n              />\n            }\n            label=\"Row-wise normalization\"\n          />\n        </Box>\n        <Box m={1}>\n          <FormControl component=\"fieldset\">\n            <FormLabel component=\"legend\" className={classes.iconRadioLegend}>\n              Labels\n            </FormLabel>\n            <RadioGroup\n              aria-label=\"dnaAccessLabelStyle\"\n              name=\"dnaAccessLabelStyle\"\n              value={dnaAccessLabelStyle}\n            >\n              <FormControlLabel\n                label=\"Indicator\"\n                value=\"indicator\"\n                className={classes.iconRadio}\n                control={\n                  <IconButton\n                    size=\"small\"\n                    onClick={changeDnaAccessLabelStyle('indicator')}\n                  >\n                    {dnaAccessLabelStyle === 'indicator' ? (\n                      <RadioButtonCheckedIcon\n                        className={classes.iconRadioActive}\n                        fontSize=\"inherit\"\n                      />\n                    ) : (\n                      <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                    )}\n                  </IconButton>\n                }\n              />\n              <FormControlLabel\n                label=\"Text\"\n                value=\"text\"\n                className={classes.iconRadio}\n                control={\n                  <IconButton\n                    size=\"small\"\n                    onClick={changeDnaAccessLabelStyle('text')}\n                  >\n                    {dnaAccessLabelStyle === 'text' ? (\n                      <RadioButtonCheckedIcon\n                        className={classes.iconRadioActive}\n                        fontSize=\"inherit\"\n                      />\n                    ) : (\n                      <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                    )}\n                  </IconButton>\n                }\n              />\n              <FormControlLabel\n                label=\"Hidden\"\n                value=\"hidden\"\n                className={classes.iconRadio}\n                control={\n                  <IconButton\n                    size=\"small\"\n                    onClick={changeDnaAccessLabelStyle('hidden')}\n                  >\n                    {dnaAccessLabelStyle === 'hidden' ? (\n                      <RadioButtonCheckedIcon\n                        className={classes.iconRadioActive}\n                        fontSize=\"inherit\"\n                      />\n                    ) : (\n                      <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                    )}\n                  </IconButton>\n                }\n              />\n            </RadioGroup>\n          </FormControl>\n        </Box>\n      </React.Fragment>\n    );\n  }\n);\n\nexport default DnaAccessibilitySettings;\n","import React, { useCallback, useEffect, useMemo, useRef } from 'react';\nimport { useRecoilValue, useSetRecoilState } from 'recoil';\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { deepClone, pipe } from '@flekschas/utils';\nimport { HiGlassComponent } from 'higlass';\n\nimport { useChromInfo } from './ChromInfoProvider';\nimport DnaAccessibilityInfo from './DnaAccessibilityInfo';\nimport DnaAccessibilityHelp from './DnaAccessibilityHelp';\nimport DnaAccessibilitySettings from './DnaAccessibilitySettings';\n\nimport TitleBar from './TitleBar';\n\nimport {\n  dnaAccessLabelStyleState,\n  dnaAccessRowNormState,\n  dnaAccessXDomainWithAssembly,\n  focusRegionAbsWithAssembly,\n  higlassDnaAccessState,\n  sampleSelectionState,\n  useDnaAccessShowInfos,\n  variantTracksState,\n  variantYScaleState,\n} from './state';\n\nimport {\n  DEFAULT_DNA_ACCESSIBILITY_ROW_SELECTION,\n  DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY,\n} from './constants';\nimport useDebounce from './use-debounce';\n\nimport {\n  updateViewConfigFocusRegion,\n  updateViewConfigVariantYScale,\n  updateViewConfigXDomain,\n  updateViewConfigVariantTracks,\n} from './view-config';\n\nimport 'higlass/dist/hglib.css';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n  },\n  grow: {\n    flexGrow: 1,\n  },\n}));\n\nconst updateViewConfigDnaAccessLabels = (labels) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[3].options.showRowLabels =\n    !labels || labels === 'hidden' ? false : labels;\n  return viewConfig;\n};\n\nconst updateViewConfigDnaAccessRowNorm = (rowNorm) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[3].options.rowNormalization = rowNorm;\n  return viewConfig;\n};\n\nconst updateViewConfigRowSelection = (selection) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[3].options.rowSelections = DEFAULT_DNA_ACCESSIBILITY_ROW_SELECTION.filter(\n    (rowId, i) => selection[i]\n  );\n  return viewConfig;\n};\n\nconst DnaAccessibility = React.memo(function DnaAccessibility() {\n  const chromInfo = useChromInfo();\n\n  const setHiglassDnaAccess = useSetRecoilState(higlassDnaAccessState);\n\n  const sampleSelection = useRecoilValue(sampleSelectionState);\n  const labelStyle = useRecoilValue(dnaAccessLabelStyleState);\n  const rowNorm = useRecoilValue(dnaAccessRowNormState);\n  const variantYScale = useRecoilValue(variantYScaleState);\n  const variantTracks = useRecoilValue(variantTracksState);\n  const focusRegionAbs = useRecoilValue(focusRegionAbsWithAssembly(chromInfo));\n\n  const higlassApi = useRef(null);\n\n  const xDomainAbsDb = useDebounce(\n    useRecoilValue(dnaAccessXDomainWithAssembly(chromInfo)),\n    500\n  );\n\n  const higlassInitHandler = useCallback(\n    (higlassInstance) => {\n      if (higlassInstance !== null) {\n        setHiglassDnaAccess(higlassInstance.api);\n        higlassApi.current = higlassInstance.api;\n      }\n    },\n    [setHiglassDnaAccess]\n  );\n\n  const viewConfig = useMemo(\n    () =>\n      pipe(\n        updateViewConfigVariantTracks(variantTracks),\n        updateViewConfigFocusRegion(focusRegionAbs, [2]),\n        updateViewConfigVariantYScale(variantYScale),\n        updateViewConfigDnaAccessLabels(labelStyle),\n        updateViewConfigDnaAccessRowNorm(rowNorm),\n        updateViewConfigXDomain(...xDomainAbsDb, { force: true }),\n        updateViewConfigRowSelection(sampleSelection)\n      )(deepClone(DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY)),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [\n      // `xDomainStartAbs` and `xDomainEndAbs` are ommitted on purpose to avoid\n      // updating the view-config on every pan or zoom event.\n      variantTracks,\n      focusRegionAbs,\n      xDomainAbsDb,\n      variantYScale,\n      labelStyle,\n      sampleSelection,\n      rowNorm,\n    ]\n  );\n\n  // Unmount\n  useEffect(\n    () => () => {\n      if (higlassApi.current) {\n        higlassApi.current.destroy();\n      }\n    },\n    // Execute only once on initialization\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n\n  // On every render\n  const classes = useStyles();\n\n  return (\n    <Grid container direction=\"column\" className={classes.root}>\n      <TitleBar\n        id=\"dna-accessibility\"\n        title=\"DNA Accessibility\"\n        useShowInfo={useDnaAccessShowInfos}\n        Info={DnaAccessibilityInfo}\n        Help={DnaAccessibilityHelp}\n        Settings={DnaAccessibilitySettings}\n      />\n      <Grid item container direction=\"column\" className={classes.grow}>\n        <HiGlassComponent\n          ref={higlassInitHandler}\n          viewConfig={viewConfig}\n          options={{\n            sizeMode: 'scroll',\n            pixelPreciseMarginPadding: true,\n            containerPaddingX: 0,\n            containerPaddingY: 0,\n            viewMarginTop: 0,\n            viewMarginBottom: 0,\n            viewMarginLeft: 0,\n            viewMarginRight: 0,\n            viewPaddingTop: 0,\n            viewPaddingBottom: 0,\n            viewPaddingLeft: 0,\n            viewPaddingRight: 16,\n            globalMousePosition: true,\n          }}\n        />\n      </Grid>\n    </Grid>\n  );\n});\n\nexport default DnaAccessibility;\n","import React, { useEffect } from 'react';\nimport { useRecoilState } from 'recoil';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { isString } from '@flekschas/utils';\n\nimport AppSidebar from './AppSidebar';\nimport AppTopbar from './AppTopbar';\nimport EnhancerRegions from './EnhancerRegions';\nimport EnhancerGenes from './EnhancerGenes';\nimport DnaAccessibility from './DnaAccessibility';\nimport ModalProvider from './ModalProvider';\nimport TooltipProvider from './TooltipProvider';\n\nimport { useChromInfo } from './ChromInfoProvider';\n\nimport {\n  focusGeneOptionState,\n  focusRegionOptionState,\n  useFocusGene,\n  useFocusRegion,\n  useVariantTracksSyncher,\n  useShowWelcomeSyncher,\n  useFocusGeneSyncher,\n  useFocusRegionSyncher,\n  useDnaAccessLabelStyleSyncher,\n  useDnaAccessRowNormSyncher,\n  useDnaAccessShowInfosSyncher,\n  useXDomainStartWithAssemblySyncher,\n  useXDomainEndWithAssemblySyncher,\n  useEnhancerRegionsShowInfosSyncher,\n  useEnhancerRegionsHideUnfocusedSyncher,\n  useEnhancerRegionsColorEncodingSyncher,\n  useEnhancerGenesShowInfosSyncher,\n  useEnhancerGenesPaddingSyncher,\n  useEnhancerGenesCellEncodingSyncher,\n  useVariantYScaleSyncher,\n} from './state';\n\nimport { GENE_SEARCH_URL, VARIANT_SEARCH_URL } from './constants';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    position: 'absolute',\n    display: 'flex',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n  },\n  toolbar: theme.mixins.toolbar,\n  content: {\n    flexGrow: 1,\n    padding: theme.spacing(1),\n    backgroundColor: 'white',\n  },\n  grow: {\n    flexGrow: 1,\n  },\n  separator: {\n    zIndex: 1,\n    margin: `-${theme.spacing(1)}px 0`,\n    width: 1,\n    background: theme.palette.grey['300'],\n  },\n  enhancerWrapper: {\n    position: 'relative',\n    flexGrow: 1,\n    margin: '-8px 0 -8px -8px',\n  },\n  enhancer: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    overflowY: 'auto',\n    '&> div': {\n      minHeight: '100%',\n    },\n  },\n  enhancerRegions: {\n    position: 'relative',\n    flexGrow: 1,\n  },\n  enhancerGenes: {\n    position: 'relative',\n  },\n  dnaAccessibility: {\n    position: 'relative',\n    width: '20rem',\n    margin: '-8px -8px -8px 0',\n  },\n}));\n\nconst AppMain = React.memo(function AppMain() {\n  const chromInfo = useChromInfo();\n\n  // Initialize query strings\n  useVariantTracksSyncher();\n  useShowWelcomeSyncher();\n  useFocusGeneSyncher();\n  useFocusRegionSyncher();\n  useDnaAccessLabelStyleSyncher();\n  useDnaAccessRowNormSyncher();\n  useDnaAccessShowInfosSyncher();\n  useEnhancerRegionsShowInfosSyncher();\n  useEnhancerRegionsHideUnfocusedSyncher();\n  useEnhancerRegionsColorEncodingSyncher();\n  useEnhancerGenesShowInfosSyncher();\n  useEnhancerGenesPaddingSyncher();\n  useEnhancerGenesCellEncodingSyncher();\n  useVariantYScaleSyncher();\n  useXDomainStartWithAssemblySyncher(chromInfo);\n  useXDomainEndWithAssemblySyncher(chromInfo);\n\n  const [focusGene, setFocusGene] = useFocusGene();\n  const [focusRegion, setFocusRegion] = useFocusRegion();\n\n  const [focusGeneOption, setFocusGeneOption] = useRecoilState(\n    focusGeneOptionState\n  );\n  const [focusRegionOption, setFocusRegionOption] = useRecoilState(\n    focusRegionOptionState\n  );\n\n  const clearFocusGene = () => {\n    setFocusGene('');\n    setFocusGeneOption(null);\n  };\n\n  const focusGeneChangeHandler = (newValue) => {\n    if (newValue) {\n      setFocusGene(newValue.geneName);\n      setFocusGeneOption(newValue);\n    } else {\n      clearFocusGene();\n    }\n  };\n\n  const clearFocusRegion = () => {\n    setFocusRegion('');\n    setFocusRegionOption(null);\n  };\n\n  const focusRegionChangeHandler = (newValue) => {\n    if (newValue) {\n      setFocusRegion(newValue.geneName);\n      setFocusRegionOption(newValue);\n    } else {\n      clearFocusRegion();\n    }\n  };\n\n  const classes = useStyles();\n\n  // Initialize focus gene/variant options\n  useEffect(\n    () => {\n      (async () => {\n        if (focusGene && !focusGeneOption) {\n          const r = await fetch(`${GENE_SEARCH_URL}&ac=${focusGene}`);\n          const results = await r.json();\n          const result = results[0];\n          if (result) {\n            result.type = 'gene';\n            focusGeneChangeHandler(results[0]);\n          }\n        }\n        if (focusRegion && isString(focusRegion) && !focusRegionOption) {\n          const r = await fetch(`${VARIANT_SEARCH_URL}&ac=${focusRegion}`);\n          const results = await r.json();\n          const result = results[0];\n          if (result) {\n            result.type = 'variant';\n            focusRegionChangeHandler(results[0]);\n          }\n        }\n      })();\n    },\n    // Execute only once on initialization\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n\n  return (\n    <div className={classes.root}>\n      <ModalProvider>\n        <CssBaseline />\n        <AppTopbar />\n        <AppSidebar />\n        <TooltipProvider>\n          <Grid\n            container\n            direction=\"column\"\n            className={classes.content}\n            wrap=\"nowrap\"\n          >\n            <div className={classes.toolbar} />\n            <Grid container className={classes.grow} wrap=\"nowrap\">\n              <div className={classes.enhancerWrapper}>\n                <div className={classes.enhancer}>\n                  <Grid container direction=\"column\">\n                    <Grid item className={classes.enhancerRegions}>\n                      <EnhancerRegions />\n                    </Grid>\n                    <Grid item className={classes.enhancerGenes}>\n                      <EnhancerGenes />\n                    </Grid>\n                  </Grid>\n                </div>\n              </div>\n              <div className={classes.separator} />\n              <div className={classes.dnaAccessibility}>\n                <DnaAccessibility />\n              </div>\n            </Grid>\n          </Grid>\n        </TooltipProvider>\n      </ModalProvider>\n    </div>\n  );\n});\n\nexport default AppMain;\n","import React from 'react';\n\nconst withEither = (ifEitherFn, EitherComponent) => (Component) => (props) =>\n  ifEitherFn(props) ? <EitherComponent {...props} /> : <Component {...props} />;\n\nexport default withEither;\n","import React, { useState, useEffect } from 'react';\nimport { RecoilRoot } from 'recoil';\nimport { ChromosomeInfo } from 'higlass';\nimport { pipe } from '@flekschas/utils';\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\n\nimport AppInitializing from './AppInitializing';\nimport AppError from './AppError';\nimport ChromInfoProvider from './ChromInfoProvider';\nimport AppMain from './AppMain';\nimport withEither from './with-either';\n\nimport './App.css';\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: '#000',\n    },\n    secondary: {\n      main: '#000',\n    },\n  },\n});\n\nconst App = () => {\n  const [chromInfo, setChromInfo] = useState(null);\n\n  useEffect(() => {\n    ChromosomeInfo('https://s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv')\n      .then((_chromInfo) => {\n        if (_chromInfo.totalLength === undefined) {\n          // Monkey patch: chrom sizes were actually unavailable...\n          // Also see https://github.com/higlass/higlass/issues/957\n          setChromInfo(false);\n        } else {\n          setChromInfo(_chromInfo);\n        }\n      })\n      .catch(() => {\n        setChromInfo(false);\n      });\n  }, []);\n\n  const Main = pipe(\n    withEither(() => chromInfo === null, AppInitializing),\n    withEither(() => chromInfo === false, AppError)\n  )(AppMain);\n\n  return (\n    <div className=\"App\">\n      <RecoilRoot>\n        <ThemeProvider theme={theme}>\n          <ChromInfoProvider chromInfo={chromInfo}>\n            <Main />\n          </ChromInfoProvider>\n        </ThemeProvider>\n      </RecoilRoot>\n    </div>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","function createAnnotationOverlayMetaTrack(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  // Services\n  const { pubSub } = HGC.services;\n\n  class AnnotationOverlayMetaTrack {\n    constructor(context, options) {\n      const { definition, getTrackObject, onNewTilesLoaded: animate } = context;\n\n      this.animate = animate;\n      this.options = options;\n\n      this.overlaysTrack = getTrackObject(definition.overlaysTrack);\n\n      if (!this.overlaysTrack) {\n        console.warn(\n          `Overlays track (uid: ${definition.overlaysTrack}) not found`\n        );\n        return;\n      }\n\n      this.annotationTrackIds = new Set();\n      this.annotationTracks = definition.options.annotationTracks\n        .map((uid) => {\n          const track = getTrackObject(uid);\n\n          if (!track) {\n            console.warn(`Child track (uid: ${uid}) not found`);\n          } else {\n            this.annotationTrackIds.add(track.uuid);\n          }\n\n          return track;\n        })\n        .filter((track) => track);\n\n      this.tilesDrawnEndHandlerBound = this.tilesDrawnEndHandler.bind(this);\n\n      this.drawnAnnotations = new Map();\n      this.tracksDrawingTiles = new Set();\n\n      this.pubSubs = [];\n\n      // Augment annotation tracks\n      this.annotationTracks.forEach((track) => {\n        track.subscribe('tilesDrawn', this.tilesDrawnEndHandlerBound);\n      });\n    }\n\n    /**\n     * Remove this track.\n     */\n    remove() {\n      this.pubSubs.forEach(pubSub.unsubscribe);\n      this.pubSubs = undefined;\n      this.annotationTracks.forEach((track) => {\n        track.unsubscribe('tileDrawn', this.annotationsDrawnHandlerBound);\n      });\n    }\n\n    tilesDrawnEndHandler({ uuid, annotations = [] }) {\n      if (!this.annotationTrackIds.has(uuid)) return;\n\n      this.tracksDrawingTiles.add(uuid);\n\n      annotations.forEach(({ xStartAbs, xEndAbs, data }) => {\n        this.drawnAnnotations.set(data.uid, [xStartAbs, xEndAbs]);\n      });\n\n      if (!(this.tracksDrawingTiles.size % this.annotationTracks.length)) {\n        this.updateOverlays();\n      }\n    }\n\n    updateOverlays() {\n      this.overlaysTrack.options.extent = Array.from(\n        this.drawnAnnotations.values()\n      );\n      this.overlaysTrack.draw();\n      this.tracksDrawingTiles.clear();\n      this.drawnAnnotations.clear();\n    }\n  }\n\n  return new AnnotationOverlayMetaTrack(...args);\n}\n\ncreateAnnotationOverlayMetaTrack.config = {\n  type: 'annotation-overlay',\n  availableOptions: ['annotationTracks'],\n  defaultOptions: {\n    annotationTracks: [],\n  },\n};\n\nexport default createAnnotationOverlayMetaTrack;\n","import {\n  identity,\n  maxNan,\n  maxVector,\n  meanNan,\n  minNan,\n  sumNan,\n} from '@flekschas/utils';\nimport { line } from 'd3';\n\nimport {\n  DEFAULT_COLOR_MAP,\n  DEFAULT_COLOR_MAP_LIGHT,\n  DEFAULT_COLOR_MAP_DARK,\n} from './constants';\n\nconst FLOAT_BYTES = Float32Array.BYTES_PER_ELEMENT;\n\nconst VS = `precision mediump float;\n\n  attribute vec2 aPrevPosition;\n  attribute vec2 aCurrPosition;\n  attribute vec2 aNextPosition;\n  attribute float aOffsetSign;\n  attribute float aColorIndex;\n\n  uniform sampler2D uAreaColorTex;\n  uniform float uAreaColorTexRes;\n  uniform mat3 projectionMatrix;\n  uniform mat3 translationMatrix;\n\n  uniform vec4 uLineColor;\n  uniform vec4 uNaNColor;\n  uniform float uWidth;\n  uniform int uMiter;\n\n  varying vec4 vColor;\n\n  void main(void)\n  {\n    mat3 model = projectionMatrix * translationMatrix;\n\n    if (aColorIndex <= -0.5) {\n      // Render line\n      vColor = vec4(uLineColor.rgb, 1.0);\n\n      vec4 prevGlPos = vec4((model * vec3(aPrevPosition, 1.0)).xy, 0.0, 1.0);\n      vec4 currGlPos = vec4((model * vec3(aCurrPosition, 1.0)).xy, 0.0, 1.0);\n      vec4 nextGlPos = vec4((model * vec3(aNextPosition, 1.0)).xy, 0.0, 1.0);\n\n      // Calculate the direction\n      vec2 dir = vec2(0.0);\n\n      if (currGlPos == prevGlPos) {\n        // start point uses (next - current)\n        dir = normalize(nextGlPos.xy - currGlPos.xy);\n      }\n      else if (currGlPos == nextGlPos) {\n        // end point uses (current - previous)\n        dir = normalize(currGlPos.xy - prevGlPos.xy);\n      }\n      else {\n        // somewhere in middle, needs a join:\n        // get directions from (C - B) and (B - A)\n        vec2 dirA = normalize((currGlPos.xy - prevGlPos.xy));\n        if (uMiter == 1) {\n          vec2 dirB = normalize((nextGlPos.xy - currGlPos.xy));\n          // now compute the miter join normal and length\n          vec2 tangent = normalize(dirA + dirB);\n          vec2 perp = vec2(-dirA.y, dirA.x);\n          vec2 miter = vec2(-tangent.y, tangent.x);\n          dir = tangent;\n        } else {\n          dir = dirA;\n        }\n      }\n\n      float width = (projectionMatrix * vec3(uWidth, 0.0, 0.0)).x / 2.0;\n\n      vec2 normal = vec2(-dir.y, dir.x) * width;\n      // normal.x /= aspectRatio;\n      vec4 offset = vec4(normal * aOffsetSign, 0.0, 0.0);\n      gl_Position = currGlPos + offset;\n    } else {\n      // Render area\n      float colorRowIndex = aColorIndex / uAreaColorTexRes;\n\n      vec2 colorTexIndex = vec2(\n        (aColorIndex / uAreaColorTexRes) - colorRowIndex,\n        colorRowIndex / uAreaColorTexRes\n      );\n      vColor = texture2D(uAreaColorTex, colorTexIndex);\n\n      gl_Position = vec4((model * vec3(aCurrPosition, 1.0)).xy, 0.0, 1.0);\n    }\n  }\n`;\n\nconst FS = `precision mediump float;\n\n  varying vec4 vColor;\n\n  void main() {\n    gl_FragColor = vColor;\n  }\n`;\n\nconst TILE_SIZE = 256;\n\nconst COLORMAP_GRAYS = Array(127)\n  .fill()\n  .map((x, i) => {\n    const gray = (1 - i / 127) * 0.5 + 0.5;\n    return [gray, gray, gray, 1];\n  });\n\nconst getMax = (fetchedTiles) =>\n  Object.values(fetchedTiles).reduce(\n    (maxValue, tile) => Math.max(maxValue, tile.tileData.maxNonZero),\n    -Infinity\n  );\n\nconst getNumRows = (fetchedTiles) =>\n  Object.values(fetchedTiles)[0].tileData.coarseShape[0];\n\nconst getRowMaxs = (fetchedTiles) =>\n  maxVector(\n    Object.values(fetchedTiles).map((tile) => tile.tileData.maxValueByRow)\n  );\n\nconst scaleGraphics = (graphics, xScale, drawnAtScale) => {\n  const tileK =\n    (drawnAtScale.domain()[1] - drawnAtScale.domain()[0]) /\n    (xScale.domain()[1] - xScale.domain()[0]);\n  const newRange = xScale.domain().map(drawnAtScale);\n\n  const posOffset = newRange[0];\n  graphics.scale.x = tileK;\n  graphics.position.x = -posOffset * tileK;\n};\n\nconst getNumPointsPerRow = (numRows, positions, markArea) =>\n  positions.length / numRows / 4 / (1 + markArea) - 2;\n\nconst createRidgePlotTrack = function createRidgePlotTrack(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  const { PIXI } = HGC.libraries;\n  const { format } = HGC.libraries.d3Format;\n  const { scaleLinear } = HGC.libraries.d3Scale;\n  const { tileProxy } = HGC.services;\n\n  const createColorTexture = (colors) => {\n    const colorTexRes = Math.max(2, Math.ceil(Math.sqrt(colors.length)));\n    const rgba = new Float32Array(colorTexRes ** 2 * 4);\n    colors.forEach((color, i) => {\n      // eslint-disable-next-line prefer-destructuring\n      rgba[i * 4] = color[0]; // r\n      // eslint-disable-next-line prefer-destructuring\n      rgba[i * 4 + 1] = color[1]; // g\n      // eslint-disable-next-line prefer-destructuring\n      rgba[i * 4 + 2] = color[2]; // b\n      // eslint-disable-next-line prefer-destructuring\n      rgba[i * 4 + 3] = color[3]; // a\n    });\n\n    return [\n      PIXI.Texture.fromBuffer(rgba, colorTexRes, colorTexRes),\n      colorTexRes,\n    ];\n  };\n\n  class RidgePlotTrack extends HGC.tracks.HorizontalLine1DPixiTrack {\n    constructor(context, options) {\n      super(context, options);\n      this.updateOptions();\n\n      this.pLoading = new PIXI.Graphics();\n      this.pLoading.position.x = 0;\n      this.pLoading.position.y = 0;\n      this.pMasked.addChild(this.pLoading);\n\n      this.loadIndicator = new PIXI.Text('Loading data...', {\n        fontSize: this.labelSize || 10,\n        fill: 0x808080,\n      });\n      this.pLoading.addChild(this.loadIndicator);\n    }\n\n    initTile(tile) {\n      this.coarsifyTileValues(tile);\n    }\n\n    destroyTile() {}\n\n    binsPerTile() {\n      return this.tilesetInfo.bins_per_dimension || TILE_SIZE;\n    }\n\n    /**\n     * From HeatmapTiledPixiTrack\n     */\n    getTilePosAndDimensions(zoomLevel, tilePos, binsPerTileIn) {\n      const binsPerTile = binsPerTileIn || this.binsPerTile();\n\n      if (this.tilesetInfo.resolutions) {\n        const sortedResolutions = this.tilesetInfo.resolutions\n          .map((x) => +x)\n          .sort((a, b) => b - a);\n\n        const chosenResolution = sortedResolutions[zoomLevel];\n\n        const tileWidth = chosenResolution * binsPerTile;\n        const tileHeight = tileWidth;\n\n        const tileX = chosenResolution * binsPerTile * tilePos[0];\n        const tileY = chosenResolution * binsPerTile * tilePos[1];\n\n        return {\n          tileX,\n          tileY,\n          tileWidth,\n          tileHeight,\n        };\n      }\n\n      const xTilePos = tilePos[0];\n      const yTilePos = tilePos[1];\n\n      const minX = this.tilesetInfo.min_pos[0];\n      const minY = this.options.reverseYAxis\n        ? -this.tilesetInfo.max_pos[1]\n        : this.tilesetInfo.min_pos[1];\n\n      const tileWidth = this.tilesetInfo.max_width / 2 ** zoomLevel;\n      const tileHeight = this.tilesetInfo.max_width / 2 ** zoomLevel;\n\n      const tileX = minX + xTilePos * tileWidth;\n      const tileY = minY + yTilePos * tileHeight;\n\n      return {\n        tileX,\n        tileY,\n        tileWidth,\n        tileHeight,\n      };\n    }\n\n    updateOptions() {\n      this.selectRowsAggregationMode =\n        this.options.selectRowsAggregationMode || 'mean';\n\n      switch (this.selectRowsAggregationMode) {\n        case 'max':\n          this.selectRowsAggregationFn = maxNan;\n          break;\n\n        case 'min':\n          this.selectRowsAggregationFn = minNan;\n          break;\n\n        case 'sum':\n          this.selectRowsAggregationFn = sumNan;\n          break;\n\n        case 'mean':\n        default:\n          this.selectRowsAggregationFn = meanNan;\n          break;\n      }\n\n      this.markArea = !!this.options.markArea;\n\n      this.markAreaColor = 'grays';\n\n      this.markColor = HGC.utils.colorToHex(this.options.markColor || 'black');\n\n      this.markColorRgbNorm = this.options.markColor\n        ? HGC.utils\n            .colorToRgba(this.options.markColor)\n            .slice(0, 3)\n            .map((x) => Math.min(1, Math.max(0, x / 255)))\n        : [0, 0, 0];\n\n      [this.markColorTex, this.markColorTexRes] = createColorTexture([\n        ...COLORMAP_GRAYS,\n      ]);\n\n      this.markNumColors = COLORMAP_GRAYS.length;\n\n      this.markOpacity = Number.isNaN(+this.options.markOpacity)\n        ? 1\n        : Math.min(1, Math.max(0, +this.options.markOpacity));\n\n      this.markSize = this.options.markSize || 2;\n\n      // Number of line segments\n      const oldMarkResolution = this.markResolution;\n      this.markResolution = Math.max(\n        1,\n        Math.min(TILE_SIZE, this.options.markResolution || TILE_SIZE / 4)\n      );\n      // Given 100 (rows) x 256 (tile size). At a resolution of 1 we need:\n      // 100 x (256 / 4) x 4 = 25,600 vertices\n\n      const oldRowHeight = this.rowHeight;\n      this.rowHeight = Number.isNaN(+this.options.rowHeight)\n        ? 'auto'\n        : +this.options.rowHeight;\n\n      const oldRowPadding = this.rowPadding;\n      this.rowPadding =\n        this.rowHeight === 'auto' ? 0 : this.options.rowPadding || 0;\n\n      const oldRowNormalization = this.rowNormalization;\n      this.rowNormalization = this.options.rowNormalization || false;\n\n      const oldRowSelections = this.rowSelections;\n      this.rowSelections =\n        this.options.rowSelections || this.rowSelections || [];\n\n      const oldShowRowLabels = this.showRowLabels;\n      this.showRowLabels = this.options.showRowLabels;\n\n      if (\n        oldMarkResolution !== this.markResolution ||\n        oldRowSelections !== this.rowSelections\n      ) {\n        this.updateTiles();\n        this.updateRowLabels();\n        this.drawLabel();\n      }\n\n      if (\n        oldRowHeight !== this.rowHeight ||\n        oldRowPadding !== this.rowPadding ||\n        oldRowNormalization !== this.rowNormalization\n      ) {\n        this.updateScales();\n      }\n\n      if (oldShowRowLabels !== this.showRowLabels) {\n        this.updateRowLabels();\n        this.drawLabel();\n      }\n\n      this.rowLabelAlign = this.options.rowLabelAlign || 'left';\n      this.rowLabelSize = this.options.rowLabelSize || 12;\n\n      this.rowCategories = this.options.rowCategories || {};\n      this.rowIdToCategory = (id) => id.substring(0, id.length - 14);\n      this.rowIdToCategory = this.options.rowIdToCategory\n        ? (id) =>\n            id[this.options.rowIdToCategory.fn](\n              ...this.options.rowIdToCategory.args\n            )\n        : identity;\n    }\n\n    removeRowLabels() {\n      while (this.pAxis.children.length) {\n        this.pAxis.removeChildAt(0);\n      }\n      if (this.rowLabels) {\n        this.rowLabels.forEach((rowLabel) => {\n          rowLabel.destroy();\n        });\n        this.rowLabels = undefined;\n      }\n    }\n\n    updateRowLabels() {\n      if (!this.tilesetInfo || !this.tilesetInfo.row_infos) return;\n\n      const labels = this.rowSelections.length\n        ? this.rowSelections.map((rowIndex) =>\n            this.tilesetInfo.row_infos[rowIndex] === undefined\n              ? '?'\n              : this.rowIdToCategory(this.tilesetInfo.row_infos[rowIndex].id)\n          )\n        : this.tilesetInfo.row_infos.map(({ id }) => this.rowIdToCategory(id));\n\n      this.removeRowLabels();\n\n      if (this.showRowLabels === 'indicator') {\n        this.rowLabels = labels.map((label) => {\n          const indicator = new PIXI.Sprite(PIXI.Texture.WHITE);\n          indicator.width = this.rowLabelSize / 2;\n          indicator.height = this.rowLabelSize;\n          indicator.tint = this.rowCategories[label]\n            ? HGC.utils.colorToHex(\n                this.rowCategories[label].axisLabelColor ||\n                  DEFAULT_COLOR_MAP[\n                    this.rowCategories[label].index % DEFAULT_COLOR_MAP.length\n                  ]\n              )\n            : 0x808080;\n          return indicator;\n        });\n      } else if (this.showRowLabels) {\n        this.rowLabels = labels.map(\n          (label) =>\n            new PIXI.Text(label, {\n              fontSize: this.rowLabelSize,\n              align: this.rowLabelAlign === 'right' ? 'right' : 'left',\n              fill: this.rowCategories[label]\n                ? HGC.utils.colorToHex(\n                    this.rowCategories[label].axisLabelColor ||\n                      DEFAULT_COLOR_MAP_DARK[\n                        this.rowCategories[label].index %\n                          DEFAULT_COLOR_MAP_DARK.length\n                      ]\n                  )\n                : 0x808080,\n            })\n        );\n      }\n    }\n\n    drawLabel() {\n      if (!this.showRowLabels) {\n        if (this.rowLabels) {\n          while (this.pAxis.children.length) {\n            this.pAxis.removeChildAt(0);\n          }\n        }\n        return;\n      }\n      if (this.showRowLabels && !this.rowLabels) this.updateRowLabels();\n      if (!this.rowLabels) return;\n\n      const [width] = this.dimensions;\n      const [left, top] = this.position;\n\n      this.pAxis.position.x = this.axisAlign === 'right' ? left + width : left;\n      this.pAxis.position.y = top;\n\n      this.pAxis.clear();\n      let yStart = 0;\n\n      const xLabelOffset = this.axisAlign === 'right' ? -3 : 3;\n      const [, rowStepHeight] = this.getRowHeight();\n      const rowStepYCenter = rowStepHeight / 2;\n\n      this.rowLabels.forEach((label, i) => {\n        label.x = xLabelOffset;\n        label.y = yStart - this.rowPadding + rowStepYCenter;\n        label.anchor.x = this.axisAlign === 'right' ? 1 : 0;\n        label.anchor.y = 0.5;\n\n        yStart += rowStepHeight;\n\n        this.pAxis.addChild(label);\n      });\n    }\n\n    rerender(newOptions) {\n      this.options = newOptions;\n      this.updateOptions();\n      this.updateExistingGraphics();\n    }\n\n    hasFetchedTiles() {\n      return Object.values(this.fetchedTiles).length;\n    }\n\n    coarsifyTileValues(tile) {\n      const { tileX, tileWidth } = this.getTilePosAndDimensions(\n        tile.tileData.zoomLevel,\n        tile.tileData.tilePos\n      );\n      const [numRows] = tile.tileData.shape;\n      const binSizePx = Math.floor(TILE_SIZE / this.markResolution);\n      const binSizeBp = tileWidth / this.markResolution;\n      const binSizeBpHalf = binSizeBp / 2;\n\n      // Determine bin boundaries\n      tile.tileData.binXPos = Array(this.markResolution).fill();\n      for (let i = 0; i <= this.markResolution; i++) {\n        tile.tileData.binXPos[i] = tileX + binSizeBp * i + binSizeBpHalf;\n      }\n\n      // 1. Coarsify the dense matrix according to `this.markResolution`\n      tile.tileData.valuesByRow = Array(numRows)\n        .fill()\n        .map(() => []);\n      tile.tileData.maxValueByRow = Array(numRows).fill(-Infinity);\n\n      for (let i = 0; i < numRows; i++) {\n        for (let j = 0; j < TILE_SIZE; j += binSizePx) {\n          const meanValue = meanNan(\n            tile.tileData.dense.subarray(\n              i * TILE_SIZE + j,\n              i * TILE_SIZE + j + binSizePx\n            )\n          );\n          tile.tileData.valuesByRow[i].push(meanValue);\n          tile.tileData.maxValueByRow[i] =\n            meanValue > tile.tileData.maxValueByRow[i]\n              ? meanValue\n              : tile.tileData.maxValueByRow[i];\n        }\n      }\n\n      // 2. Sort rows\n      if (this.rowSelections.length) {\n        tile.tileData.valuesByRow = this.rowSelections\n          .map((rowIdx) => tile.tileData.valuesByRow[rowIdx])\n          .filter(identity);\n        tile.tileData.maxValueByRow = this.rowSelections\n          .map((rowIdx) => tile.tileData.maxValueByRow[rowIdx])\n          .filter(identity);\n      }\n\n      // 3. Set out shape\n      tile.tileData.coarseShape = [\n        tile.tileData.valuesByRow.length,\n        this.markResolution,\n      ];\n    }\n\n    updateTiles() {\n      Object.values(this.fetchedTiles).forEach(\n        this.coarsifyTileValues.bind(this)\n      );\n    }\n\n    updateScales() {\n      const fetchedTiles = Object.values(this.fetchedTiles);\n\n      if (!fetchedTiles.length) return;\n\n      const numRows = getNumRows(fetchedTiles);\n\n      const [rowHeight] = this.getRowHeight();\n\n      const actualTrackHeight = this.getTrackHeight(numRows, rowHeight);\n\n      const globalMax = getMax(this.fetchedTiles);\n\n      this.valueScale = scaleLinear()\n        .domain([0, globalMax])\n        .range([rowHeight, 0]);\n      this.colorIndexScale = scaleLinear()\n        .domain([0, globalMax])\n        .range([0, this.markNumColors])\n        .clamp(true);\n\n      if (this.rowNormalization) {\n        const rowMaxs = getRowMaxs(this.fetchedTiles);\n        this.rowValueScales = {};\n        this.rowColorIndexScales = {};\n        for (let i = 0; i < numRows; i++) {\n          this.rowValueScales[i] = scaleLinear()\n            .domain([0, rowMaxs[i]])\n            .range([rowHeight, 0]);\n          this.rowColorIndexScales[i] = scaleLinear()\n            .domain([0, rowMaxs[i]])\n            .range([0, this.markNumColors])\n            .clamp(true);\n        }\n        this.valueScaleByRow = (value, row) =>\n          Number.isNaN(value) ? rowHeight : this.rowValueScales[row](value);\n        this.colorIndexScaleByRow = (value, row) =>\n          Number.isNaN(value) ? -2 : this.rowColorIndexScales[row](value);\n      } else {\n        this.valueScaleByRow = (value, row) =>\n          Number.isNaN(value) ? rowHeight : this.valueScale(value);\n        this.colorIndexScaleByRow = (value, row) =>\n          Number.isNaN(value) ? -2 : this.colorIndexScale(value);\n      }\n\n      this.rowScale = scaleLinear()\n        .domain([0, numRows])\n        .range([0, actualTrackHeight + this.rowPadding]);\n    }\n\n    tilesToData(tiles, { markArea, maxRows = Infinity, rowHeight } = {}) {\n      if (!tiles.length) return [];\n\n      const numRows = Math.min(maxRows, getNumRows(tiles));\n\n      const positionsByRow = Array(numRows)\n        .fill()\n        .map(() => []);\n      const colorIndicesByRow = Array(numRows)\n        .fill()\n        .map(() => []);\n      const offsetSignsByRow = Array(numRows)\n        .fill()\n        .map(() => []);\n\n      tiles.forEach((tile) => {\n        tile.tileData.valuesByRow.forEach((values, i) => {\n          if (i >= maxRows) return;\n          values.forEach((value, j) => {\n            const x = this._xScale(tile.tileData.binXPos[j]);\n            const yStart = this.rowScale(i);\n            const y = yStart + this.valueScaleByRow(value, i);\n            // We're duplicating the point as for every point on the line we\n            // need two x,y vertices to render triangles.\n            positionsByRow[i].push(x, y, x, y);\n            colorIndicesByRow[i].push(-1, -1); // -1 refers to the line color\n            offsetSignsByRow[i].push(1, -1);\n\n            if (markArea) {\n              positionsByRow[i].push(x, y, x, yStart + rowHeight);\n              colorIndicesByRow[i].push(this.colorIndexScaleByRow(value, i), 0);\n              offsetSignsByRow[i].push(0, 0);\n            }\n          });\n        });\n      });\n\n      const size2d = markArea ? 8 : 4;\n      const size1d = markArea ? 4 : 2;\n\n      // For each row, duplicate the first and last point\n      for (let i = 0; i < numRows; i++) {\n        // Add first point pair to the beginning of the array\n        positionsByRow[i].unshift(...positionsByRow[i].slice(0, size2d));\n\n        // The very first duplicated point positions do not matter as\n        // we offset the buffer reading. Subsequent dupliations need to be\n        // taken into account though.\n        if (i > 0) {\n          colorIndicesByRow[i].unshift(\n            ...colorIndicesByRow[i].slice(0, size1d)\n          );\n          offsetSignsByRow[i].unshift(...offsetSignsByRow[i].slice(0, size1d));\n        }\n\n        // Add last point pair to the end of the array\n        positionsByRow[i].push(...positionsByRow[i].slice(-size2d));\n        colorIndicesByRow[i].push(...colorIndicesByRow[i].slice(-size1d));\n        offsetSignsByRow[i].push(...offsetSignsByRow[i].slice(-size1d));\n      }\n\n      return [\n        new Float32Array(positionsByRow.flatMap(identity)),\n        new Float32Array(colorIndicesByRow.flatMap(identity)),\n        new Float32Array(offsetSignsByRow.flatMap(identity)),\n      ];\n    }\n\n    toLineIndices(numRows, numPointsPerRow, markArea) {\n      const verticesPerLine = markArea ? 12 : 6;\n      const verticesPerPoint = markArea ? 4 : 2;\n      const indices = new Uint32Array(\n        (numPointsPerRow - 1) * numRows * verticesPerLine\n      );\n      let k = 0;\n\n      if (markArea) {\n        // Draw a line and area\n        for (let i = 0; i < numRows; i++) {\n          for (let j = 0; j < numPointsPerRow - 1; j++) {\n            // The `+2` comes from the fact that for each row of points we\n            // duplicate the first and last point.\n            const pointOffset = i * (numPointsPerRow + 2) * verticesPerPoint;\n            const p1a = pointOffset + j * verticesPerPoint;\n            const p1b = p1a + 1;\n            const p1c = p1a + 2;\n            const p1d = p1a + 3;\n            const p2a = p1a + 4;\n            const p2b = p1a + 5;\n            const p2c = p1a + 6;\n            const p2d = p1a + 7;\n\n            const indexOffset = k * verticesPerLine;\n            // Area\n            indices[indexOffset] = p1c;\n            indices[indexOffset + 1] = p1d;\n            indices[indexOffset + 2] = p2c;\n            indices[indexOffset + 3] = p2c;\n            indices[indexOffset + 4] = p1d;\n            indices[indexOffset + 5] = p2d;\n            // Line\n            indices[indexOffset + 6] = p1a;\n            indices[indexOffset + 7] = p1b;\n            indices[indexOffset + 8] = p2a;\n            indices[indexOffset + 9] = p2a;\n            indices[indexOffset + 10] = p1b;\n            indices[indexOffset + 11] = p2b;\n\n            k++;\n          }\n        }\n      } else {\n        // Just draw a line\n        for (let i = 0; i < numRows; i++) {\n          for (let j = 0; j < numPointsPerRow - 1; j++) {\n            // The `+2` comes from the fact that for each row of points we\n            // duplicate the first and last point.\n            const pointOffset = i * (numPointsPerRow + 2) * verticesPerPoint;\n            const p1a = pointOffset + j * verticesPerPoint;\n            const p1b = p1a + 1;\n            const p2a = p1a + 2;\n            const p2b = p1a + 3;\n\n            const indexOffset = k * verticesPerLine;\n            indices[indexOffset] = p1a;\n            indices[indexOffset + 1] = p1b;\n            indices[indexOffset + 2] = p2a;\n            indices[indexOffset + 3] = p2a;\n            indices[indexOffset + 4] = p1b;\n            indices[indexOffset + 5] = p2b;\n\n            k++;\n          }\n        }\n      }\n\n      return indices;\n    }\n\n    getRowHeight(numRows) {\n      const [, visibleTrackHeight] = this.dimensions;\n\n      return this.rowHeight === 'auto'\n        ? [\n            Math.floor(visibleTrackHeight / numRows),\n            Math.floor(visibleTrackHeight / numRows),\n          ]\n        : [this.rowHeight, this.rowHeight + this.rowPadding];\n    }\n\n    getTrackHeight(numRows, rowHeight) {\n      const [, visibleTrackHeight] = this.dimensions;\n\n      return this.rowHeight === 'auto'\n        ? visibleTrackHeight\n        : rowHeight * numRows + this.rowPadding * (numRows - 1);\n    }\n\n    renderLines() {\n      this.drawnAtScale = scaleLinear()\n        .domain([...this.xScale().domain()])\n        .range([...this.xScale().range()]);\n\n      const tiles = Object.values(this.fetchedTiles);\n\n      const numRows = getNumRows(tiles);\n      const [rowHeight] = this.getRowHeight(numRows);\n\n      const [positions, colorIndices, offsetSigns] = this.tilesToData(tiles, {\n        maxRows: numRows,\n        markArea: this.markArea,\n        rowHeight,\n      });\n\n      const numPointsPerRow = getNumPointsPerRow(\n        numRows,\n        positions,\n        this.markArea\n      );\n\n      const indices = this.toLineIndices(\n        numRows,\n        numPointsPerRow,\n        this.markArea\n      );\n\n      const uniforms = new PIXI.UniformGroup({\n        uLineColor: [...this.markColorRgbNorm, 1.0],\n        uNaNColor: [1.0, 1.0, 1.0, 1.0],\n        uAreaColorTex: this.markColorTex,\n        uAreaColorTexRes: this.markColorTexRes,\n        uWidth: 0.25,\n        uMiter: 1,\n      });\n\n      const shader = PIXI.Shader.from(VS, FS, uniforms);\n\n      const geometry = new PIXI.Geometry();\n      const numCoords = 2;\n      const numVerticesPoint = this.markArea ? 4 : 2;\n      geometry.addAttribute(\n        'aPrevPosition',\n        positions,\n        2, // size\n        false, // normalize\n        PIXI.TYPES.FLOAT, // type\n        FLOAT_BYTES * numCoords, // stride\n        0 // offset/start\n      );\n      geometry.addAttribute(\n        'aCurrPosition',\n        positions,\n        2, // size\n        false, // normalize\n        PIXI.TYPES.FLOAT, // type\n        FLOAT_BYTES * numCoords, // stride\n        // note that each point is duplicated, hence we need to skip over the first two\n        FLOAT_BYTES * numCoords * numVerticesPoint // offset/start\n      );\n      geometry.addAttribute(\n        'aNextPosition',\n        positions,\n        2, // size\n        false, // normalize\n        PIXI.TYPES.FLOAT, // type\n        FLOAT_BYTES * 2, // stride\n        // note that each point is duplicated, hence we need to skip over the first four\n        FLOAT_BYTES * numCoords * numVerticesPoint * 2 // offset/start\n      );\n      geometry.addAttribute('aOffsetSign', offsetSigns, 1);\n      geometry.addAttribute('aColorIndex', colorIndices, 1);\n      geometry.addIndex(indices);\n\n      const mesh = new PIXI.Mesh(geometry, shader);\n\n      const newGraphics = new PIXI.Graphics();\n      newGraphics.addChild(mesh);\n\n      // eslint-disable-next-line\n      this.pMain.x = this.position[0];\n\n      if (this.lineGraphics) {\n        this.pMain.removeChild(this.lineGraphics);\n        this.lineGraphics.destroy();\n      }\n\n      this.pMain.addChild(newGraphics);\n      this.lineGraphics = newGraphics;\n\n      scaleGraphics(this.lineGraphics, this._xScale, this.drawnAtScale);\n\n      this.draw();\n      this.animate();\n    }\n\n    // Called whenever a new tile comes in\n    updateExistingGraphics() {\n      this.updateLoadIndicator();\n      if (!this.hasFetchedTiles()) return;\n      this.updateScales();\n      this.renderLines();\n    }\n\n    updateLoadIndicator() {\n      const [left, top] = this.position;\n      this.pLoading.position.x = left + 6;\n      this.pLoading.position.y = top + 6;\n\n      if (this.fetching.size) {\n        this.pLoading.addChild(this.loadIndicator);\n      } else {\n        this.pLoading.removeChild(this.loadIndicator);\n      }\n    }\n\n    refreshTiles() {\n      super.refreshTiles();\n      this.updateLoadIndicator();\n    }\n\n    setPosition(newPosition) {\n      super.setPosition(newPosition);\n\n      [this.pMain.position.x, this.pMain.position.y] = this.position;\n    }\n\n    zoomed(newXScale, newYScale) {\n      this.xScale(newXScale);\n      this.yScale(newYScale);\n\n      if (this.lineGraphics) {\n        scaleGraphics(this.lineGraphics, newXScale, this.drawnAtScale);\n      }\n\n      this.refreshTiles();\n      this.draw();\n    }\n\n    /**\n     * Return the data currently visible at position X and Y\n     *\n     * @param {Number} trackX: The x position relative to the track's start and end\n     * @param {Number} trakcY: The y position relative to the track's start and end\n     */\n    getVisibleData(trackX, trackY) {\n      if (!this.hasFetchedTiles()) return '';\n\n      const zoomLevel = this.calculateZoomLevel();\n\n      const numRows = getNumRows(this.fetchedTiles);\n      const [, rowStepHeight] = this.getRowHeight(numRows);\n\n      // the width of the tile in base pairs\n      const tileWidth = tileProxy.calculateTileWidth(\n        this.tilesetInfo,\n        zoomLevel,\n        this.tilesetInfo.tile_size\n      );\n\n      // the position of the tile containing the query position\n      const tilePos = this._xScale.invert(trackX) / tileWidth;\n\n      // the position of query within the tile\n      let posInTileX =\n        this.tilesetInfo.tile_size * (tilePos - Math.floor(tilePos));\n      // const posInTileYNormalized = trackY / this.dimensions[1];\n      // The first track doesn't apply padding so we have to shift padding\n      // to the mouse position once\n      const rowIndex = Math.floor(\n        Math.max(0, (trackY + this.rowPadding) / rowStepHeight)\n      );\n      const rowSelection = this.rowSelections[rowIndex];\n      const tileId = this.tileToLocalId([zoomLevel, Math.floor(tilePos)]);\n      const fetchedTile = this.fetchedTiles[tileId];\n      const colIndex =\n        Math.floor(posInTileX) / Math.floor(TILE_SIZE / this.markResolution);\n\n      let text = '';\n      let value = '<em>unknown</em>';\n\n      if (rowSelection === undefined) return text;\n\n      if (fetchedTile) {\n        if (!this.tilesetInfo.shape) {\n          posInTileX =\n            fetchedTile.tileData.dense.length * (tilePos - Math.floor(tilePos));\n        }\n\n        let index = null;\n        if (this.tilesetInfo.shape) {\n          // Accomodate data from vector sources\n          if (\n            Array.isArray(rowSelection) &&\n            this.options.selectRowsAggregationMethod === 'client'\n          ) {\n            // Need to aggregate, so `index` will actually be an array.\n            index = rowSelection.map(\n              (rowI) =>\n                this.tilesetInfo.shape[0] * rowI + Math.floor(posInTileX)\n            );\n          } else if (\n            rowSelection &&\n            this.options.selectRowsAggregationMethod === 'client'\n          ) {\n            index =\n              this.tilesetInfo.shape[0] * rowSelection + Math.floor(posInTileX);\n          } else {\n            // No need to aggregate, `index` will contain a single item.\n            index =\n              this.tilesetInfo.shape[0] * rowIndex + Math.floor(posInTileX);\n          }\n        } else {\n          index =\n            fetchedTile.tileData.dense.length * rowIndex +\n            Math.floor(posInTileX);\n        }\n\n        if (Array.isArray(index)) {\n          const values = index.map((i) => fetchedTile.tileData.dense[i]);\n          value = format('.3f')(this.selectRowsAggregationFn(values));\n          text = value;\n\n          text += '<br/>';\n          text += `${index.length}-item ${this.options.selectRowsAggregationMode}`;\n        } else {\n          value = format('.3f')(\n            fetchedTile.tileData.valuesByRow[rowIndex][colIndex]\n          );\n          text = value;\n\n          if (Array.isArray(rowSelection)) {\n            value += '<br/>';\n            value += `${rowSelection.length}-item ${this.options.selectRowsAggregationMode}`;\n          }\n        }\n      }\n\n      // add information about the row\n      if (this.tilesetInfo.row_infos) {\n        let rowInfo = '';\n\n        if (rowSelection !== undefined) {\n          rowInfo = this.tilesetInfo.row_infos[rowSelection];\n        }\n\n        const label =\n          typeof rowInfo === 'object'\n            ? this.rowIdToCategory(rowInfo.id)\n            : rowInfo;\n\n        const color = this.rowCategories[label]\n          ? this.rowCategories[label].axisLabelColor ||\n            DEFAULT_COLOR_MAP_DARK[\n              this.rowCategories[label].index % DEFAULT_COLOR_MAP_DARK.length\n            ]\n          : '#666666';\n\n        const background = this.rowCategories[label]\n          ? this.rowCategories[label].axisLabelColor ||\n            DEFAULT_COLOR_MAP_LIGHT[\n              this.rowCategories[label].index % DEFAULT_COLOR_MAP_LIGHT.length\n            ]\n          : '#ffffff';\n\n        return `<div style=\"margin: -0.25rem; padding: 0 0.25rem; background: ${background}\"><strong style=\"color: ${color};\">${label}:</strong> ${value}</div>`;\n      }\n\n      return text;\n    }\n\n    /**\n     * Get some information to display when the mouse is over this\n     * track\n     *\n     * @param {Number} trackX: the x position of the mouse over the track\n     * @param {Number} trackY: the y position of the mouse over the track\n     *\n     * @return {string}: A HTML string containing the information to display\n     *\n     */\n    getMouseOverHtml(trackX, trackY) {\n      if (!this.tilesetInfo) return '';\n\n      return this.getVisibleData(trackX, trackY);\n    }\n\n    exportSVG() {\n      const svgns = 'http://www.w3.org/2000/svg';\n\n      let track = null;\n      let base = null;\n\n      [base, track] = super.exportSVG();\n\n      base.setAttribute('class', 'ridge-plot-track');\n      const output = document.createElement('g');\n\n      track.appendChild(output);\n      output.setAttribute(\n        'transform',\n        `translate(${this.position[0]}, ${this.position[1]})`\n      );\n\n      const tiles = Object.values(this.fetchedTiles);\n\n      const numRows = getNumRows(tiles);\n      const [rowHeight] = this.getRowHeight(numRows);\n      const stride = this.markArea ? 8 : 4;\n\n      const [positions] = this.tilesToData(tiles, {\n        maxRows: numRows,\n        markArea: this.markArea,\n        rowHeight,\n      });\n\n      const createLine = line()\n        .x((d) => d[0])\n        .y((d) => d[1]);\n\n      const posPerRow = positions.length / numRows;\n\n      const posToPoints = (pos) => {\n        const arr = [];\n        const start = stride;\n        const end = pos.length - stride;\n\n        for (let i = start; i < end; i += stride) {\n          arr.push([pos[i], pos[i + 1]]);\n        }\n\n        return arr;\n      };\n\n      let fill = this.markArea\n        ? (this.options.colorRange && this.options.colorRange[0]) || '#ffffff'\n        : 'none';\n      if (this.markArea && this.options.colorRange) {\n        const numColors = this.options.colorRange.length;\n        const defs = document.createElementNS(svgns, 'defs');\n        const linearGradient = document.createElementNS(\n          svgns,\n          'linearGradient'\n        );\n        linearGradient.setAttribute('id', 'RidgePlotGradient');\n        linearGradient.setAttribute('x1', '0');\n        linearGradient.setAttribute('y1', '1');\n        linearGradient.setAttribute('x2', '0');\n        linearGradient.setAttribute('y2', '0');\n        this.options.colorRange.forEach((color, i) => {\n          const stop = document.createElementNS(svgns, 'stop');\n          stop.setAttribute(\n            'offset',\n            `${Math.round((i / (numColors - 1)) * 100)}%`\n          );\n          stop.setAttribute('stop-color', color);\n          linearGradient.appendChild(stop);\n        });\n        defs.appendChild(linearGradient);\n        base.insertBefore(defs, base.firstChild);\n        fill = 'url(#RidgePlotGradient)';\n      }\n\n      for (let i = 0; i < numRows; i++) {\n        const arr = posToPoints(\n          positions.subarray(i * posPerRow, (i + 1) * posPerRow)\n        );\n\n        const l = document.createElement('path');\n        let d = createLine(arr);\n\n        const y0 = this.rowScale(i) + this.valueScaleByRow(0, i);\n\n        // We extend the line a little to the left and right and anchor them at\n        // y = 0 to avoid weird glitches with the fill.\n        const firstComma = d.indexOf(',');\n        const firstX = +d.substring(1, firstComma);\n        const firstY = +d.substring(firstComma + 1, d.indexOf('L'));\n        d = `M${firstX - 1},${y0}L${firstX - 1},${firstY}L${d.substring(1)}`;\n        const lastComma = d.lastIndexOf(',');\n        const lastX = +d.substring(d.lastIndexOf('L') + 1, lastComma);\n        const lastY = +d.substring(lastComma + 1);\n        d += `L${lastX + 1},${lastY}L${lastX + 1},${y0}`;\n\n        l.setAttribute('d', d);\n        l.setAttribute('fill', fill);\n        l.setAttribute('stroke', this.options.markColor || 'black');\n        l.setAttribute('stroke-width', (this.options.markSize || 2) / 8);\n\n        output.appendChild(l);\n      }\n\n      return [base, track];\n    }\n  }\n\n  return new RidgePlotTrack(...args);\n};\n\ncreateRidgePlotTrack.config = {\n  type: 'ridge-plot',\n  datatype: ['multivec'],\n  orientation: '1d',\n  name: 'RidgePlot',\n};\n\nexport default createRidgePlotTrack;\n","import IntervalTree from '@flatten-js/interval-tree';\n\nimport {\n  DEFAULT_COLOR_MAP,\n  DEFAULT_COLOR_MAP_DARK,\n  DEFAULT_COLOR_MAP_LIGHT,\n  EPS,\n} from './constants';\nimport { dashedXLineTo, toFixed } from './utils';\n\nconst intersects = (a, b) => a[0] < b[1] && a[1] >= b[0];\n\nconst VS = `\n  precision mediump float;\n  attribute vec2 aPosition;\n  attribute float aOpacity;\n  attribute float aHighlight;\n\n  uniform mat3 projectionMatrix;\n  uniform mat3 translationMatrix;\n  uniform float uPointSize;\n\n  varying float vHighlight;\n  varying float vOpacity;\n\n  void main(void)\n  {\n    vHighlight = aHighlight;\n    vOpacity = aOpacity;\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n    gl_PointSize = uPointSize;\n  }\n`;\n\nconst FS = `\n  precision mediump float;\n\n  uniform vec4 uColor;\n  uniform vec4 uColorHighlight;\n\n  varying float vHighlight;\n  varying float vOpacity;\n\n  void main() {\n    float isNotFocused = 1.0 - vHighlight;\n\n    float r = uColor.r * isNotFocused + uColorHighlight.r * vHighlight;\n    float g = uColor.g * isNotFocused + uColorHighlight.g * vHighlight;\n    float b = uColor.b * isNotFocused + uColorHighlight.b * vHighlight;\n\n    gl_FragColor = vec4(r, g, b, 1.0) * vOpacity;\n  }\n`;\n\n// prettier-ignore\nconst pointToPosition = (pt) => [\n  // top-left\n  pt.cX - pt.widthHalf, pt.y,\n  // top-right\n  pt.cX + pt.widthHalf, pt.y,\n  // bottom-right\n  pt.cX + pt.widthHalf, pt.y + pt.height,\n  // pt.cX + pt.widthHalf, pt.y + pt.height,\n  // bottom-left\n  pt.cX - pt.widthHalf, pt.y + pt.height,\n  // pt.cX - pt.widthHalf, pt.y,\n];\n\nconst pointToIndex = (pt, i) => {\n  const base = i * 4;\n  return [base, base + 1, base + 2, base + 2, base + 3, base];\n};\n\nconst pointToOpacity = (pt) => [pt.opacity, pt.opacity, pt.opacity, pt.opacity];\n\nconst pointToHighlight = (pt) => [\n  pt.highlight,\n  pt.highlight,\n  pt.highlight,\n  pt.highlight,\n];\n\nconst getItemDistance = (item) =>\n  Math.abs(\n    +item.fields[1] +\n      (+item.fields[2] - +item.fields[1]) / 2 -\n      (+item.fields[4] + (+item.fields[4] - +item.fields[5]) / 2)\n  );\n\nconst getMaxDistance = (fetchedTiles) =>\n  Object.values(fetchedTiles).reduce(\n    (maxDist, tile) =>\n      Math.max(\n        maxDist,\n        tile.tileData.reduce(\n          (maxDistItem, item) => Math.max(maxDistItem, item.distance),\n          0\n        )\n      ),\n    0\n  );\n\nconst scaleScalableGraphics = (graphics, xScale, drawnAtScale) => {\n  const tileK =\n    (drawnAtScale.domain()[1] - drawnAtScale.domain()[0]) /\n    (xScale.domain()[1] - xScale.domain()[0]);\n  const newRange = xScale.domain().map(drawnAtScale);\n\n  const posOffset = newRange[0];\n  graphics.scale.x = tileK;\n  graphics.position.x = -posOffset * tileK;\n};\n\nconst getRegionId = (item) =>\n  `${item.fields[0]}:${item.fields[1]}-${item.fields[2]}`;\n\nconst createStratifiedBedTrack = function createStratifiedBedTrack(\n  HGC,\n  ...args\n) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  const { PIXI } = HGC.libraries;\n  const { scaleLinear, scaleLog } = HGC.libraries.d3Scale;\n  const { tileProxy } = HGC.services;\n  const { MAX_CLICK_DELAY } = HGC.configs;\n\n  const opacityLogScale = scaleLog()\n    .domain([1, 10])\n    .range([0.1, 1])\n    .clamp(true);\n\n  class StratifiedBedTrack extends HGC.tracks.HorizontalLine1DPixiTrack {\n    constructor(context, options) {\n      super(context, options);\n\n      this.pLegend = new PIXI.Graphics();\n      this.pMasked.addChild(this.pLegend);\n\n      this.legendMin = Infinity;\n      this.legendMax = -Infinity;\n\n      // Needed for interaction tracking because interaction tracking on the\n      // mesh causes errors...\n      this.bg = new PIXI.Sprite(PIXI.Texture.WHITE);\n      [this.bg.width, this.bg.height] = this.dimensions;\n      this.bg.interactive = true;\n      this.bg.interactiveChildren = false;\n      this.bg.alpha = 0;\n\n      let mousedownTime = performance.now();\n      this.bg.mousedown = () => {\n        mousedownTime = performance.now();\n      };\n      this.bg.mouseup = (e) => {\n        if (performance.now() - mousedownTime < MAX_CLICK_DELAY)\n          this.clickHandler(e);\n      };\n\n      this.updateOptions();\n\n      this.pLoading = new PIXI.Graphics();\n      this.pLoading.position.x = 0;\n      this.pLoading.position.y = 0;\n      this.pMasked.addChild(this.pLoading);\n\n      this.loadIndicator = new PIXI.Text('Loading data...', {\n        fontSize: this.labelSize || 10,\n        fill: 0x808080,\n      });\n      this.pLoading.addChild(this.loadIndicator);\n    }\n\n    initTile(tile) {\n      const intervals = [];\n\n      tile.intervalTree = new IntervalTree(intervals);\n\n      tile.tileData.forEach((item, i) => {\n        item.distance = getItemDistance(item) || -1;\n        item.cX = item.xStart + (item.xEnd - item.xStart) / 2;\n        item.regionId = getRegionId(item);\n        item.isLeftToRight = item.xStart < item.xEnd;\n        tile.intervalTree.insert([item.xStart, item.xEnd], i);\n      });\n    }\n\n    updateStratificationOption() {\n      if (!this.options.stratification) {\n        this.categoryField = undefined;\n        this.categoryToGroup = undefined;\n        this.groupToColor = undefined;\n        this.numGroups = 0;\n        this.numCategories = 0;\n        this.groupLabels = [];\n        return;\n      }\n\n      this.categoryField = this.options.stratification.categoryField;\n      this.getCategory = (item) =>\n        item.fields[this.categoryField].toLowerCase();\n      this.categoryToGroup = new Map();\n      this.categoryToY = new Map();\n      this.yToCategory = new Map();\n      this.groupToColor = new Map();\n\n      this.groupSizes = this.options.stratification.groups.map(\n        (group) =>\n          group.categories.filter((category) => this.valueFilter(category))\n            .length\n      );\n      this.filteredGroups = this.options.stratification.groups.filter(\n        (group, i) => this.groupSizes[i] > 0\n      );\n      this.numGroups = this.filteredGroups.length;\n      this.numCategories = this.groupSizes.reduce(\n        (numCategories, groupSize) => numCategories + groupSize,\n        0\n      );\n      this.groupLabels = this.options.stratification.groups.map(\n        (group, i) => group.label || `Group ${i}`\n      );\n\n      let k = 0;\n      this.options.stratification.groups.forEach((group, i) => {\n        this.groupToColor.set(i, [\n          HGC.utils.colorToHex(\n            group.color || DEFAULT_COLOR_MAP[i % DEFAULT_COLOR_MAP.length]\n          ),\n          HGC.utils.colorToHex(\n            group.backgroundColor ||\n              DEFAULT_COLOR_MAP_LIGHT[i % DEFAULT_COLOR_MAP_LIGHT.length]\n          ),\n          HGC.utils.colorToHex(\n            group.backgroundColor ||\n              DEFAULT_COLOR_MAP_DARK[i % DEFAULT_COLOR_MAP_DARK.length]\n          ),\n        ]);\n        group.categories\n          .filter((category) => this.valueFilter(category))\n          .forEach((category, j) => {\n            const cat = category.toLowerCase();\n            this.categoryToGroup.set(cat, i);\n            this.categoryToY.set(cat, k + j);\n            this.yToCategory.set(k + j, cat);\n          });\n        k += this.groupSizes[i];\n      });\n\n      this.groupLabelsPixiText = this.groupLabels.map(\n        (label, i) =>\n          new PIXI.Text(label, {\n            fontSize: this.labelSize,\n            align: this.axisAlign === 'right' ? 'right' : 'left',\n            fill: HGC.utils.colorToHex(\n              this.options.stratification.groups[i].axisLabelColor ||\n                DEFAULT_COLOR_MAP_DARK[i % DEFAULT_COLOR_MAP_DARK.length]\n            ),\n          })\n      );\n    }\n\n    updateOptions() {\n      this.axisAlign = this.options.axisAlign || 'left';\n\n      this.labelColor = HGC.utils.colorToHex(\n        this.options.labelColor || 'black'\n      );\n\n      this.labelSize = this.options.labelSize || 12;\n\n      this.markColor = HGC.utils.colorToHex(this.options.markColor || 'black');\n\n      this.markColorRgbNorm = this.options.markColor\n        ? HGC.utils\n            .colorToRgba(this.options.markColor)\n            .slice(0, 3)\n            .map((x) => Math.min(1, Math.max(0, x / 255)))\n        : [0, 0, 0];\n\n      this.markOpacity = Number.isNaN(+this.options.markOpacity)\n        ? 1\n        : Math.min(1, Math.max(0, +this.options.markOpacity));\n\n      this.markSize = this.options.markSize || 2;\n      this.markMinWidth = this.options.markMinWidth || this.markSize;\n      this.markHeight = this.options.markHeight || this.markSize;\n\n      this.rowHeight = this.options.rowHeight || this.markHeight;\n\n      this.markColorHighlight = HGC.utils.colorToHex(\n        this.options.markColorHighlight || 'red'\n      );\n\n      this.markColorHighlightRgbNorm = this.options.markColorHighlight\n        ? HGC.utils\n            .colorToRgba(this.options.markColorHighlight)\n            .slice(0, 3)\n            .map((x) => Math.min(1, Math.max(0, x / 255)))\n        : [1, 0, 0];\n\n      this.markColorDehighlight = HGC.utils.colorToHex(\n        this.options.markColorDehighlight || '#999999'\n      );\n\n      this.markColorDehighlightRgbNorm = this.options.markColorDehighlight\n        ? HGC.utils\n            .colorToRgba(this.options.markColorDehighlight)\n            .slice(0, 3)\n            .map((x) => Math.min(1, Math.max(0, x / 255)))\n        : [0.6, 0.6, 0.6];\n\n      this.markOpacityFocus = Number.isNaN(+this.options.markOpacityFocus)\n        ? this.markOpacity\n        : Math.min(1, Math.max(0, +this.options.markOpacityFocus));\n\n      this.filterSet =\n        this.options.filter && this.options.filter.set\n          ? this.options.filter.set.reduce((s, include) => {\n              s.add(include);\n              return s;\n            }, new Set())\n          : null;\n\n      this.filterField = this.options.filter && this.options.filter.field;\n\n      this.valueFilter = this.filterSet\n        ? (value) => this.filterSet.has(value)\n        : () => true;\n\n      this.itemFilter =\n        this.valueFilter && this.filterField\n          ? (item) => this.valueFilter(item.fields[this.filterField])\n          : () => true;\n\n      this.getImportance = this.options.importanceField\n        ? (item) => +item.fields[this.options.importanceField]\n        : (item) => item.distance;\n\n      this.opacityEncoding = this.options.opacityEncoding || 'solid';\n\n      switch (this.opacityEncoding) {\n        case 'frequency':\n          this.opacityScale = () => 0.1;\n          break;\n\n        case 'highestImportance':\n        case 'closestImportance': {\n          const importanceDomain = this.options.importanceDomain || [1, 1000];\n          const opacityLinearScale = scaleLinear()\n            .domain(importanceDomain)\n            .range([1, 10]);\n          this.opacityScale = (x) => opacityLogScale(opacityLinearScale(x));\n          break;\n        }\n\n        case 'solid':\n        default:\n          this.opacityScale = () => 1;\n          break;\n      }\n\n      this.focusRegion = this.options.focusRegion\n        ? this.options.focusRegion\n        : [Infinity, Infinity];\n\n      this.getRegion = this.options.focusRegion\n        ? (item) => [item.xStart, item.xEnd]\n        : undefined;\n\n      this.focusGene = this.options.focusGene\n        ? this.options.focusGene.toLowerCase()\n        : undefined;\n\n      this.getGene = this.options.geneField\n        ? (item) => item.fields[this.options.geneField].toLowerCase()\n        : undefined;\n\n      this.focusStyle = this.options.focusStyle\n        ? this.options.focusStyle.toLowerCase()\n        : undefined;\n\n      this.minImportance = this.options.minImportance || 0;\n\n      this.updateStratificationOption();\n    }\n\n    rerender(newOptions) {\n      this.options = newOptions;\n      this.updateOptions();\n      this.updateExistingGraphics();\n    }\n\n    hasFetchedTiles() {\n      return Object.values(this.fetchedTiles).length;\n    }\n\n    updateScales() {\n      const fetchedTiles = Object.values(this.fetchedTiles);\n\n      if (!fetchedTiles.length) return;\n\n      const [, height] = this.dimensions;\n\n      this.maxDist = getMaxDistance(this.fetchedTiles);\n\n      this.heightScale = scaleLinear()\n        .domain([0, this.maxDist])\n        .range([Math.min(12, height / 10), height]);\n\n      this.categoryHeightScale = scaleLinear()\n        .domain([0, this.numCategories])\n        .range([0, this.numCategories * this.rowHeight]);\n\n      this.valueScale = scaleLinear()\n        .domain([0, this.maxDist])\n        .range([height, 0]);\n\n      this.valueScaleInverted = scaleLinear()\n        .domain([0, this.maxDist])\n        .range([0, height]);\n    }\n\n    itemToIndicatorCategory(item, isHighlighting) {\n      return {\n        cX: this._xScale(item.cX),\n        y: this.categoryHeightScale(\n          this.categoryToY.get(this.getCategory(item))\n        ),\n        opacity: this.opacityScale(this.getImportance(item)),\n        highlight: isHighlighting && item.__focus,\n        widthHalf: Math.max(\n          this.markMinWidth / 2,\n          Math.abs(this._xScale(item.xStart) - this._xScale(item.xEnd)) / 2\n        ),\n        height: this.markHeight,\n        __item: item,\n      };\n    }\n\n    isItemInFocus() {\n      if (\n        this.getGene &&\n        this.focusGene &&\n        this.getRegion &&\n        this.focusRegion\n      ) {\n        return (item) => {\n          item.__focus =\n            this.getGene(item) === this.focusGene &&\n            intersects(this.getRegion(item), this.focusRegion);\n          return item.__focus;\n        };\n      }\n\n      if (this.getGene && this.focusGene) {\n        return (item) => {\n          item.__focus = this.getGene(item) === this.focusGene;\n          return item.__focus;\n        };\n      }\n\n      if (this.getRegion && this.focusRegion) {\n        return (item) => {\n          item.__focus = intersects(this.getRegion(item), this.focusRegion);\n          return item.__focus;\n        };\n      }\n\n      return (item) => {\n        item.__focus = false;\n        // If no focus was defined, we include all intervals\n        return true;\n      };\n    }\n\n    itemToIndicatorReducer(focusFilterFn, addFn) {\n      if (this.focusStyle === 'highlighting') {\n        return (filteredItems, item, i) => {\n          focusFilterFn(item);\n          if (this.itemFilter(item)) addFn(filteredItems, item);\n          return filteredItems;\n        };\n      }\n\n      return (filteredItems, item) => {\n        if (focusFilterFn(item) && this.itemFilter(item))\n          addFn(filteredItems, item);\n        return filteredItems;\n      };\n    }\n\n    getPoints(isHighlighting) {\n      let reducerVar = [];\n      let addFn = (accumulator, item) =>\n        accumulator.push(this.itemToIndicatorCategory(item, isHighlighting));\n\n      if (this.opacityEncoding === 'highestImportance') {\n        reducerVar = {};\n        addFn = (accumulator, item) => {\n          if (accumulator[item.regionId]) {\n            const i1 = this.getImportance(accumulator[item.regionId].__item);\n            const i2 = this.getImportance(item);\n            if (i2 > i1) {\n              accumulator[item.regionId] = this.itemToIndicatorCategory(\n                item,\n                isHighlighting\n              );\n            }\n          } else {\n            accumulator[item.regionId] = this.itemToIndicatorCategory(\n              item,\n              isHighlighting\n            );\n          }\n        };\n      } else if (this.opacityEncoding === 'closestImportance') {\n        reducerVar = {};\n        addFn = (accumulator, item) => {\n          if (\n            !accumulator[item.regionId] ||\n            item.distance < accumulator[item.regionId].__item.distance\n          ) {\n            accumulator[item.regionId] = this.itemToIndicatorCategory(\n              item,\n              isHighlighting\n            );\n          }\n        };\n      }\n\n      const focusFilterFn = this.isItemInFocus();\n      const dataToPoint = this.itemToIndicatorReducer(focusFilterFn, addFn);\n\n      return Object.values(this.fetchedTiles).flatMap((tile) =>\n        Object.values(tile.tileData.reduce(dataToPoint, reducerVar))\n      );\n    }\n\n    renderIndicatorPoints() {\n      this.drawnAtScale = scaleLinear()\n        .domain([...this.xScale().domain()])\n        .range([...this.xScale().range()]);\n\n      const isHighlighting = !!(\n        this.focusStyle === 'highlighting' &&\n        ((this.focusGene && this.getGene) ||\n          (this.focusRegion && this.getRegion))\n      );\n\n      const points = this.getPoints(isHighlighting);\n\n      const positions = new Float32Array(points.flatMap(pointToPosition));\n      const indices = new Uint16Array(points.flatMap(pointToIndex));\n      const opacities = new Float32Array(points.flatMap(pointToOpacity));\n      const highlights = new Float32Array(points.flatMap(pointToHighlight));\n\n      const uniforms = new PIXI.UniformGroup({\n        uColor: isHighlighting\n          ? [...this.markColorDehighlightRgbNorm, this.markOpacity]\n          : [...this.markColorRgbNorm, this.markOpacity],\n        uColorHighlight: [...this.markColorHighlightRgbNorm, this.markOpacity],\n        uHighlighting: isHighlighting,\n      });\n\n      const shader = PIXI.Shader.from(VS, FS, uniforms);\n\n      const geometry = new PIXI.Geometry();\n      geometry.addAttribute('aPosition', positions, 2);\n      geometry.addAttribute('aOpacity', opacities, 1);\n      geometry.addAttribute('aHighlight', highlights, 1);\n      geometry.addIndex(indices);\n\n      const mesh = new PIXI.Mesh(geometry, shader);\n\n      const newGraphics = new PIXI.Graphics();\n      newGraphics.addChild(this.bg);\n      newGraphics.addChild(mesh);\n\n      [this.bg.width, this.bg.height] = this.dimensions;\n\n      // eslint-disable-next-line\n      this.pMain.x = this.position[0];\n\n      if (this.indicatorPointGraphics) {\n        this.indicatorPointGraphics.removeChild(this.bg);\n        this.pMain.removeChild(this.indicatorPointGraphics);\n      }\n\n      this.pMain.addChild(newGraphics);\n      this.indicatorPointGraphics = newGraphics;\n\n      scaleScalableGraphics(\n        this.indicatorPointGraphics,\n        this._xScale,\n        this.drawnAtScale\n      );\n\n      this.draw();\n      this.animate();\n    }\n\n    renderIndicatorCategoryAxis() {\n      const [width] = this.dimensions;\n      const [left, top] = this.position;\n\n      this.pAxis.position.x = this.axisAlign === 'right' ? left + width : left;\n      this.pAxis.position.y = top;\n\n      this.pAxis.clear();\n      let yStart = 0;\n      let yEnd = 0;\n\n      const xTickOffset = this.axisAlign === 'right' ? -5 : 5;\n      const xTickEnd = this.axisAlign === 'right' ? -width : width;\n      const xLabelOffset = this.axisAlign === 'right' ? -3 : 3;\n      const numAxisLabels = this.pAxis.children.length;\n\n      this.pAxis.lineStyle(1, 0x000000, 1.0, 0.0);\n\n      this.groupLabelsPixiText.forEach((labelPixiText, i) => {\n        if (numAxisLabels < i + 1) {\n          this.pAxis.addChild(labelPixiText);\n        }\n\n        // Don't ask me why but somehow after `labelPixiText` was added to\n        // `this.pAxis` the object is not the same as `this.pAxis.children[i]`\n        // anymore and subsequent changes were ineffective\n        const text = this.pAxis.children[i];\n\n        if (this.groupSizes[i] === 0) {\n          text.alpha = 0;\n          return;\n        }\n\n        const height = this.categoryHeightScale(this.groupSizes[i]);\n        yEnd += height;\n        text.x = xLabelOffset;\n        text.y = yStart + height / 2;\n        text.anchor.x = this.axisAlign === 'right' ? 1 : 0;\n        text.anchor.y = 0.5;\n        text.alpha = 1;\n\n        if (this.options.focusStyle === 'highlighting') {\n          this.pAxis.beginFill(0xffffff, 0.66);\n        } else {\n          this.pAxis.beginFill(this.groupToColor.get(i)[1], 0.66);\n        }\n\n        this.pAxis.lineStyle(0);\n        if (this.axisAlign === 'right') {\n          this.pAxis.drawRect(\n            text.x - text.width,\n            text.y - text.height / 2,\n            text.width,\n            text.height\n          );\n        } else {\n          this.pAxis.drawRect(\n            text.x,\n            text.y - text.height / 2,\n            text.width,\n            text.height\n          );\n        }\n        this.pAxis.endFill();\n\n        this.pAxis.lineStyle(1, 0x000000, 1.0, 0.0);\n        this.pAxis.moveTo(0, yStart);\n        this.pAxis.lineTo(xTickOffset, yStart);\n\n        if (this.options.stratification.axisShowGroupSeparator) {\n          dashedXLineTo(this.pAxis, 0, xTickEnd, yStart, 5);\n        }\n\n        yStart = yEnd;\n      });\n\n      this.pAxis.moveTo(0, 0);\n      this.pAxis.lineTo(0, yEnd);\n      this.pAxis.lineTo(xTickOffset, yEnd);\n\n      if (this.options.stratification.axisShowGroupSeparator) {\n        dashedXLineTo(this.pAxis, 0, xTickEnd, yEnd, 5);\n      }\n    }\n\n    renderIndicatorLegend() {\n      this.pLegend.clear();\n\n      if (this.opacityEncoding.indexOf('Importance') === -1) {\n        if (this.legendMinText) {\n          this.pLegend.removeChild(this.legendMinText);\n          this.legendMinText.destroy();\n          this.legendMinText = undefined;\n        }\n        if (this.legendMaxText) {\n          this.pLegend.removeChild(this.legendMaxText);\n          this.legendMaxText.destroy();\n          this.legendMaxText = undefined;\n        }\n        return;\n      }\n\n      const padding = 6;\n      const [width] = this.dimensions;\n      const [left, top] = this.position;\n      const [, y] = this.categoryHeightScale.range();\n      const isRightAligned = this.options.legendAlign === 'right';\n      const isHighlighting = !!(\n        this.focusStyle === 'highlighting' &&\n        ((this.focusGene && this.getGene) ||\n          (this.focusRegion && this.getRegion))\n      );\n\n      this.pLegend.position.x = isRightAligned ? left + width : left;\n\n      const [minValue, maxValue] = this.options.importanceDomain || [1, 1000];\n\n      if (Math.abs(minValue - this.legendMin) > EPS) {\n        if (this.legendMinText) {\n          this.pLegend.removeChild(this.legendMinText);\n          this.legendMinText.destroy();\n        }\n        this.legendMinText = new PIXI.Text(toFixed(minValue, 3), {\n          fontSize: this.labelSize,\n          align: isRightAligned ? 'right' : 'left',\n          fill: 0x808080,\n        });\n        this.legendMinText.x = 0;\n        this.legendMinText.y = padding / 2;\n        this.legendMinText.anchor.x = isRightAligned ? 1 : 0;\n        this.pLegend.addChild(this.legendMinText);\n      }\n\n      if (Math.abs(maxValue - this.legendMax) > EPS) {\n        if (this.legendMaxText) {\n          this.pLegend.removeChild(this.legendMaxText);\n          this.legendMaxText.destroy();\n        }\n        this.legendMaxText = new PIXI.Text(toFixed(maxValue, 3), {\n          fontSize: this.labelSize,\n          align: isRightAligned ? 'right' : 'left',\n          fill: 0x808080,\n        });\n        this.legendMaxText.x = 0;\n        this.legendMaxText.y = padding / 2;\n        this.legendMaxText.anchor.x = isRightAligned ? 1 : 0;\n        this.pLegend.addChild(this.legendMaxText);\n      }\n\n      const legendRectWidth = 42;\n      const minTextWidth = this.legendMinText.getBounds().width;\n      const maxTextWidth = this.legendMaxText.getBounds().width;\n      const offset = isRightAligned\n        ? -(maxTextWidth + legendRectWidth + padding)\n        : minTextWidth + 2 * padding;\n\n      const rectHeight = 18 + (isHighlighting * padding) / 2;\n\n      this.pLegend.beginFill(0xffffff);\n      this.pLegend.lineStyle(1, 0xcccccc);\n      if (isRightAligned) {\n        this.legendMinText.x = offset - padding;\n        this.pLegend.drawRoundedRect(\n          -(legendRectWidth + minTextWidth + maxTextWidth + 3 * padding + 0.5),\n          0,\n          legendRectWidth + minTextWidth + maxTextWidth + 3 * padding,\n          rectHeight,\n          3\n        );\n      } else {\n        this.legendMaxText.x = offset + legendRectWidth + 2 * padding;\n        this.pLegend.drawRoundedRect(\n          0.5,\n          0,\n          legendRectWidth + minTextWidth + maxTextWidth + 3 * padding,\n          18 + (isHighlighting * padding) / 2,\n          3\n        );\n      }\n      this.pLegend.endFill();\n      this.pLegend.lineStyle(0);\n\n      for (let i = 0; i < 5; i++) {\n        const opacity = this.opacityScale(minValue + (i / 4) * maxValue);\n\n        this.pLegend.beginFill(this.markColor, opacity);\n        this.pLegend.drawRect(\n          i * 9 + offset,\n          padding / 2 + !isHighlighting * 3,\n          6,\n          6\n        );\n        this.pLegend.endFill();\n\n        if (isHighlighting) {\n          this.pLegend.beginFill(this.markColorHighlight, opacity);\n          this.pLegend.drawRect(i * 9 + offset, padding / 2 + 9, 6, 6);\n          this.pLegend.endFill();\n        }\n      }\n\n      if (isRightAligned) {\n        this.legendMinText.x = offset - padding;\n        this.legendMaxText.x = -padding / 2;\n      } else {\n        this.legendMinText.x = padding / 2;\n        this.legendMaxText.x = offset + legendRectWidth + padding;\n      }\n\n      this.pLegend.position.y = top + y - padding - rectHeight;\n    }\n\n    updateIndicators() {\n      this.renderIndicatorCategoryAxis();\n      this.renderIndicatorLegend();\n      this.renderIndicatorPoints();\n    }\n\n    updateLoadIndicator() {\n      const [left, top] = this.position;\n      this.pLoading.position.x = left + 6;\n      this.pLoading.position.y = top + 6;\n\n      if (this.fetching.size) {\n        this.pLoading.addChild(this.loadIndicator);\n      } else {\n        this.pLoading.removeChild(this.loadIndicator);\n      }\n    }\n\n    // Called whenever a new tile comes in\n    updateExistingGraphics() {\n      this.updateLoadIndicator();\n      if (!this.hasFetchedTiles()) return;\n      this.updateScales();\n      this.updateIndicators();\n    }\n\n    // Gets called on every draw call\n    drawTile(tile) {\n      tile.graphics.clear();\n\n      this.updateLoadIndicator();\n\n      if (!this.options.stratification.axisNoGroupColor) {\n        let yStart = 0;\n        let yEnd = 0;\n        this.groupSizes.forEach((size, i) => {\n          yEnd += this.categoryHeightScale(size);\n\n          tile.graphics.beginFill(this.groupToColor.get(i)[1]);\n          tile.graphics.drawRect(\n            0,\n            yStart,\n            this.dimensions[0],\n            Math.abs(yEnd - yStart)\n          );\n\n          yStart = yEnd;\n        });\n        tile.graphics.endFill();\n      }\n    }\n\n    getElementAtPosition(relX, relY) {\n      if (!this.tilesetInfo) return undefined;\n\n      const zoomLevel = this.calculateZoomLevel();\n      const tileWidth = tileProxy.calculateTileWidth(\n        this.tilesetInfo,\n        zoomLevel,\n        this.tilesetInfo.tile_size\n      );\n\n      // the position of the tile containing the query position\n      const tileId = this.tileToLocalId([\n        zoomLevel,\n        Math.floor(this._xScale.invert(relX) / tileWidth),\n      ]);\n      const fetchedTile = this.fetchedTiles[tileId];\n\n      if (!fetchedTile) return undefined;\n\n      const category = this.yToCategory.get(\n        Math.floor(this.categoryHeightScale.invert(relY))\n      );\n\n      const xAbsLo = this._xScale.invert(relX - 1);\n      const xAbsHi = this._xScale.invert(relX + 1);\n\n      let foundItem;\n      fetchedTile.intervalTree.search([xAbsLo, xAbsHi]).forEach((idx) => {\n        const item = fetchedTile.tileData[idx];\n        if (this.getCategory(item) === category) {\n          foundItem = item;\n          return true;\n        }\n        return false;\n      });\n\n      return {\n        item: foundItem,\n        category,\n        tileId,\n      };\n    }\n\n    getMouseOverHtml(relX, relY) {\n      const element = this.getElementAtPosition(relX, relY);\n\n      if (!element) return '';\n\n      const { item, category } = element;\n\n      if (item) {\n        const [, bg, text] = this.groupToColor.get(\n          this.categoryToGroup.get(category)\n        );\n        const colorHex = `#${text.toString(16)}`;\n        const bgHex = `#${bg.toString(16)}`;\n        const value = this.getImportance(item).toFixed(2);\n        return `<div style=\"margin: -0.25rem; padding: 0 0.25rem; background: ${bgHex}\"><strong style=\"color: ${colorHex};\">${category}:</strong> ${value}</div>`;\n      }\n\n      return '';\n    }\n\n    clickHandler(event) {\n      const [offsetX, offsetY] = this.position;\n      const relX = event.data.global.x - offsetX;\n      const relY = event.data.global.y - offsetY;\n\n      const element = this.getElementAtPosition(relX, relY);\n\n      if (element) {\n        this.pubSub.publish('app.click', {\n          type: 'annotation',\n          event,\n          payload: element,\n        });\n      }\n    }\n\n    setPosition(newPosition) {\n      super.setPosition(newPosition);\n\n      [this.pMain.position.x, this.pMain.position.y] = this.position;\n    }\n\n    zoomed(newXScale, newYScale) {\n      this.xScale(newXScale);\n      this.yScale(newYScale);\n\n      if (this.indicatorPointGraphics) {\n        scaleScalableGraphics(\n          this.indicatorPointGraphics,\n          newXScale,\n          this.drawnAtScale\n        );\n      }\n\n      this.refreshTiles();\n      this.draw();\n    }\n\n    refreshTiles() {\n      super.refreshTiles();\n      this.updateLoadIndicator();\n    }\n\n    renderIndicatorCategoryAxisAsSvg() {\n      const gAxis = document.createElement('g');\n      gAxis.setAttribute('id', 'axis');\n\n      const [width] = this.dimensions;\n      const [left, top] = this.position;\n\n      this.pAxis.position.x = this.axisAlign === 'right' ? left + width : left;\n      this.pAxis.position.y = top;\n\n      gAxis.setAttribute(\n        'transform',\n        `translate(${this.pAxis.position.x}, ${this.pAxis.position.y})`\n      );\n\n      let yStart = 0;\n      let yEnd = 0;\n\n      const xTickOffset = this.axisAlign === 'right' ? -5 : 5;\n      const xTickEnd = this.axisAlign === 'right' ? -width : width;\n      const xLabelOffset = this.axisAlign === 'right' ? -3 : 3;\n\n      const createRect = (x, y, w, h, f, o) => {\n        const r = document.createElement('rect');\n\n        r.setAttribute('x', x);\n        r.setAttribute('y', y);\n        r.setAttribute('width', w);\n        r.setAttribute('height', h);\n        r.setAttribute('fill', f);\n        r.setAttribute('fill-opacity', o);\n        r.setAttribute('stroke-width', 0);\n\n        return r;\n      };\n\n      const createText = (pixiText) => {\n        const t = document.createElement('text');\n\n        t.setAttribute('x', pixiText.x);\n        t.setAttribute('y', pixiText.y + pixiText.height / (4 / 1));\n        t.setAttribute('fill', pixiText._style._fill);\n        t.setAttribute(\n          'text-anchor',\n          pixiText._style._align === 'right' ? 'end' : 'start'\n        );\n        t.setAttribute('style', `font: ${pixiText._font};`);\n\n        t.textContent = pixiText.text;\n\n        return t;\n      };\n\n      const createLine = ({\n        stroke = '#000000',\n        strokeWidth = 1,\n        strokeDasharray = null,\n      } = {}) => (x1, y1, x2, y2) => {\n        const l = document.createElement('line');\n\n        l.setAttribute('x1', x1);\n        l.setAttribute('y1', y1);\n        l.setAttribute('x2', x2);\n        l.setAttribute('y2', y2);\n        l.setAttribute('stroke', stroke);\n        l.setAttribute('stroke-width', strokeWidth);\n\n        if (strokeDasharray)\n          l.setAttribute('stroke-dasharray', strokeDasharray);\n\n        return l;\n      };\n\n      const createDashedLine = createLine({ strokeDasharray: '5' });\n\n      const isHighlighting = this.options.focusStyle === 'highlighting';\n      const backgroundOpacity = 0.66;\n\n      this.groupLabelsPixiText.forEach((labelPixiText, i) => {\n        const height = this.categoryHeightScale(this.groupSizes[i]);\n        yEnd += height;\n        labelPixiText.x = xLabelOffset;\n        labelPixiText.y = yStart + height / 2;\n\n        // Background color\n        const backgroundColor = isHighlighting\n          ? '#ffffff'\n          : `#${this.groupToColor.get(i)[1].toString(16)}`;\n\n        if (this.axisAlign === 'right') {\n          gAxis.appendChild(\n            createRect(\n              labelPixiText.x - labelPixiText.width,\n              labelPixiText.y - labelPixiText.height / (4 / 1),\n              labelPixiText.width,\n              labelPixiText.height,\n              backgroundColor,\n              backgroundOpacity\n            )\n          );\n        } else {\n          gAxis.appendChild(\n            createRect(\n              labelPixiText.x,\n              labelPixiText.y - labelPixiText.height / (4 / 1),\n              labelPixiText.width,\n              labelPixiText.height,\n              backgroundColor,\n              backgroundOpacity\n            )\n          );\n        }\n\n        gAxis.appendChild(createText(labelPixiText));\n\n        gAxis.appendChild(createLine()(0, yStart, xTickOffset, yStart));\n\n        if (this.options.stratification.axisShowGroupSeparator) {\n          gAxis.appendChild(createDashedLine(0, yStart, xTickEnd, yStart));\n        }\n\n        yStart = yEnd;\n      });\n\n      gAxis.appendChild(createLine()(0, 0, 0, yEnd));\n\n      if (this.options.stratification.axisShowGroupSeparator) {\n        gAxis.appendChild(createDashedLine(0, yEnd, xTickEnd, yEnd));\n      }\n\n      return gAxis;\n    }\n\n    /**\n     * Export an SVG representation of this track\n     *\n     * @returns {Array} The two returned DOM nodes are both SVG\n     * elements [base,track]. Base is a parent which contains track as a\n     * child. Track is clipped with a clipping rectangle contained in base.\n     *\n     */\n    exportSVG() {\n      let track = null;\n      let base = null;\n\n      [base, track] = super.superSVG();\n\n      base.setAttribute('class', 'exported-stratified-bed-track');\n      const output = document.createElement('g');\n\n      track.appendChild(output);\n      output.setAttribute(\n        'transform',\n        `translate(${this.position[0]},${this.position[1]})`\n      );\n\n      const isHighlighting = !!(\n        this.focusStyle === 'highlighting' &&\n        ((this.focusGene && this.getGene) ||\n          (this.focusRegion && this.getRegion))\n      );\n\n      const points = this.getPoints(isHighlighting);\n      const color = isHighlighting\n        ? this.options.markColorDehighlight || '#999999'\n        : this.options.markColor || 'black';\n      const colorHighlight = this.options.markColorHighlight || 'red';\n\n      points.forEach(({ cX, y, widthHalf, opacity, highlight, height }, i) => {\n        const r = document.createElement('rect');\n\n        r.setAttribute('x', cX - widthHalf);\n        r.setAttribute('y', y);\n        r.setAttribute('width', widthHalf * 2);\n        r.setAttribute('height', height);\n        r.setAttribute('fill', highlight ? colorHighlight : color);\n        r.setAttribute('fill-opacity', opacity);\n        r.setAttribute('stroke-width', 0);\n\n        output.appendChild(r);\n      });\n\n      base.appendChild(this.renderIndicatorCategoryAxisAsSvg());\n\n      return [base, track];\n    }\n  }\n\n  return new StratifiedBedTrack(...args);\n};\n\nconst icon =\n  '<svg viewBox=\"0 0 16 16\" xmlns=\"http://www.w3.org/2000/svg\" fill-rule=\"evenodd\" clip-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"1.5\"><path d=\"M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268\" fill=\"none\" stroke=\"currentColor\"/><path d=\"M10.5 3.5v12\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-dasharray=\"1,2,0,0\"/><path d=\"M5.5 13.5V6\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-width=\".9969299999999999\" stroke-dasharray=\"1.71,3.43,0,0\"/><path d=\"M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z\" fill=\"currentColor\"/><path d=\"M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z\" fill=\"currentColor\"/></svg>';\n\ncreateStratifiedBedTrack.config = {\n  type: 'stratified-bed',\n  datatype: ['arcs', 'bedlike'],\n  orientation: '1d',\n  name: 'Arcs1D',\n  thumbnail: new DOMParser().parseFromString(icon, 'text/xml').documentElement,\n  availableOptions: [\n    'arcStyle',\n    'flip1D',\n    'labelPosition',\n    'labelColor',\n    'labelTextOpacity',\n    'labelBackgroundOpacity',\n    'trackBorderWidth',\n    'trackBorderColor',\n  ],\n  defaultOptions: {\n    arcStyle: 'ellipse',\n    flip1D: 'no',\n    labelColor: 'black',\n    labelPosition: 'hidden',\n    trackBorderWidth: 0,\n    trackBorderColor: 'black',\n  },\n  optionsInfo: {\n    arcStyle: {\n      name: 'Arc Style',\n      inlineOptions: {\n        circle: {\n          name: 'Circle',\n          value: 'circle',\n        },\n        ellipse: {\n          name: 'Ellipse',\n          value: 'ellipse',\n        },\n      },\n    },\n  },\n};\n\nexport default createStratifiedBedTrack;\n","const MAX_RADIUS = 2;\nconst MAX_RADIUS_EXTENSION = 2;\n\n// const VS = `\n//   attribute vec2 aPosition;\n\n//   uniform mat3 projectionMatrix;\n//   uniform mat3 translationMatrix;\n//   uniform float uPointSize;\n//   uniform vec4 uColor;\n\n//   varying vec4 vColor;\n\n//   void main(void)\n//   {\n//     vColor = uColor;\n//     gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n//     gl_PointSize = uPointSize;\n//   }\n// `;\n\n// const FS_ROUND = `\n//   #ifdef GL_OES_standard_derivatives\n//   #extension GL_OES_standard_derivatives : enable\n//   #endif\n\n//   precision mediump float;\n\n//   varying vec4 vColor;\n\n//   void main() {\n//     float r = 0.0, delta = 0.0, alpha = 1.0;\n//     vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n//     r = dot(cxy, cxy);\n\n//     #ifdef GL_OES_standard_derivatives\n//       delta = fwidth(r);\n//       alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n//     #endif\n\n//     gl_FragColor = vec4(vColor.rgb, alpha * vColor.a);\n//   }\n// `;\n\n// const FS_SQUARE = `\n//   precision mediump float;\n//   varying vec4 vColor;\n\n//   void main() {\n//     gl_FragColor = vec4(vColor.rgb, vColor.a);\n//   }\n// `;\n\n// const DEFAULT_GROUP_COLORS = [\n//   '#c17da5',\n//   '#c76526',\n//   '#dca237',\n//   '#eee462',\n//   '#469b76',\n//   '#3170ad',\n//   '#6fb2e4',\n//   '#000000',\n//   '#999999',\n// ];\n\n// const DEFAULT_GROUP_COLORS_DARK = [\n//   '#a1688a',\n//   '#a65420',\n//   '#b7872e',\n//   '#9f9841',\n//   '#3a8162',\n//   '#295d90',\n//   '#4a7798',\n//   '#000000',\n//   '#666666',\n// ];\n\n// const DEFAULT_GROUP_COLORS_LIGHT = [\n//   '#f5e9f0',\n//   '#f6e5db',\n//   '#f9f0de',\n//   '#fcfbe5',\n//   '#e0eee8',\n//   '#dde7f1',\n//   '#e7f2fb',\n//   '#d5d5d5',\n//   '#ffffff',\n// ];\n\n// const scaleScalableGraphics = (graphics, xScale, drawnAtScale) => {\n//   const tileK =\n//     (drawnAtScale.domain()[1] - drawnAtScale.domain()[0]) /\n//     (xScale.domain()[1] - xScale.domain()[0]);\n//   const newRange = xScale.domain().map(drawnAtScale);\n\n//   const posOffset = newRange[0];\n//   graphics.scale.x = tileK;\n//   graphics.position.x = -posOffset * tileK;\n// };\n\nconst createSnpTrack = function createSnpTrack(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  const { range } = HGC.libraries.d3Array;\n  const { scaleBand } = HGC.libraries.d3Scale;\n  const { tileProxy } = HGC.services;\n  const { colorToHex } = HGC.utils;\n\n  class SnpTrack extends HGC.tracks.BedLikeTrack {\n    setValueScale() {\n      this.valueScale = null;\n      if (this.options && this.options.valueColumn) {\n        const min = this.options.colorEncodingRange\n          ? +this.options.colorEncodingRange[0]\n          : this.minVisibleValueInTiles(+this.options.valueColumn);\n        const max = this.options.colorEncodingRange\n          ? +this.options.colorEncodingRange[1]\n          : this.maxVisibleValueInTiles(+this.options.valueColumn);\n\n        if (this.options.valueColumn) {\n          [this.valueScale] = this.makeValueScale(\n            min,\n            this.calculateMedianVisibleValue(+this.options.valueColumn),\n            max,\n            2\n          );\n        }\n      }\n    }\n\n    finalDotYPos(y, r) {\n      return Math.max(r, Math.min(this.dimensions[1] - r, y));\n    }\n\n    drawPoly(tile, xStartPos, xEndPos, rectY, doubleRadius = false) {\n      // prettier-ignore\n      const drawnPoly = [\n        // left top\n        xStartPos, rectY,\n        // right top\n        xEndPos, rectY,\n        // right bottom\n        xEndPos, this.dimensions[1],\n         // left bottom\n        xStartPos, this.dimensions[1]\n      ];\n\n      const anchorRadius = Math.max(MAX_RADIUS, xEndPos - xStartPos);\n      const radius = anchorRadius * (1 + MAX_RADIUS_EXTENSION * doubleRadius);\n\n      tile.rectGraphics.drawCircle(\n        xStartPos,\n        this.finalDotYPos(rectY, anchorRadius),\n        radius\n      );\n\n      return drawnPoly;\n    }\n\n    renderRows(tile, rows, maxRows, startY, endY, fill) {\n      const zoomLevel = +tile.tileId.split('.')[0];\n\n      this.initialize();\n\n      const rowScale = scaleBand()\n        .domain(range(maxRows))\n        .range([startY, endY])\n        .paddingInner(0);\n\n      const focusRegion = this.options.focusRegion || [Infinity, Infinity];\n\n      const circleDraws = [];\n      const circleFocusDraws = [];\n\n      for (let j = 0; j < rows.length; j++) {\n        for (let i = 0; i < rows[j].length; i++) {\n          const td = rows[j][i].value;\n          const geneInfo = td.fields;\n\n          // the returned positions are chromosome-based and they need to\n          // be converted to genome-based\n          const chrOffset = +td.chrOffset;\n          const txStart = +geneInfo[1] + chrOffset;\n          const txEnd = +geneInfo[2] + chrOffset;\n          let yMiddle = rowScale(j) + rowScale.step() / 2;\n\n          if (this.valueScale) {\n            yMiddle = this.valueScale(+geneInfo[+this.options.valueColumn - 1]);\n          }\n\n          const rectY = yMiddle;\n          const xStartPos = this._xScale(txStart);\n          const xEndPos = this._xScale(txEnd);\n\n          // don't draw anything that has already been drawn\n          if (\n            !(\n              zoomLevel in this.drawnRects &&\n              td.uid in this.drawnRects[zoomLevel]\n            )\n          ) {\n            if (!this.drawnRects[zoomLevel]) this.drawnRects[zoomLevel] = {};\n\n            const circleDraw = [xStartPos, xEndPos, rectY, td, txStart, txEnd];\n\n            if (txStart <= focusRegion[1] && txEnd >= focusRegion[0]) {\n              circleFocusDraws.push(circleDraw);\n            } else {\n              circleDraws.push(circleDraw);\n            }\n          }\n        }\n\n        // 1. draw white background to make clicking easier\n        tile.rectGraphics.lineStyle(0);\n        tile.rectGraphics.beginFill(0xffffff);\n        circleDraws.forEach((circleDraw) => {\n          this.drawPoly(\n            tile,\n            circleDraw[0],\n            circleDraw[1],\n            circleDraw[2],\n            true\n          );\n        });\n\n        // 2. Now draw the normal circles\n        let color = this.options.markColor || 'black';\n        let opacity = this.options.fillOpacity || 0.3;\n        tile.rectGraphics.lineStyle(1, colorToHex(color), opacity);\n        tile.rectGraphics.beginFill(colorToHex(color), opacity);\n        circleDraws.forEach((circleDraw) => {\n          const drawnPoly = this.drawPoly(\n            tile,\n            circleDraw[0],\n            circleDraw[1],\n            circleDraw[2]\n          );\n          this.drawnRects[zoomLevel][circleDraw[4].uid] = [\n            drawnPoly,\n            {\n              start: circleDraw[4],\n              end: circleDraw[5],\n              value: circleDraw[3],\n              tile,\n              fill,\n            },\n            tile.tileId,\n          ];\n        });\n\n        // 2. Now draw the focused circles\n        color = this.options.markColorFocus || 'red';\n        opacity = this.options.markOpacityFocus || 0.6;\n        tile.rectGraphics.lineStyle(1, colorToHex(color), opacity);\n        tile.rectGraphics.beginFill(colorToHex(color), opacity);\n        circleFocusDraws.forEach((circleDraw) => {\n          const drawnPoly = this.drawPoly(\n            tile,\n            circleDraw[0],\n            circleDraw[1],\n            circleDraw[2]\n          );\n          this.drawnRects[zoomLevel][circleDraw[4].uid] = [\n            drawnPoly,\n            {\n              start: circleDraw[4],\n              end: circleDraw[5],\n              value: circleDraw[3],\n              tile,\n              fill,\n            },\n            tile.tileId,\n          ];\n        });\n        tile.rectGraphics.endFill();\n      }\n\n      tile.rectGraphics.interactive = true;\n      tile.rectGraphics.buttonMode = true;\n      tile.rectGraphics.mouseup = (event) => {\n        if (this.hoveringSnp) {\n          this.pubSub.publish('app.click', {\n            type: 'snp',\n            event,\n            payload: this.hoveringSnp,\n          });\n        }\n      };\n\n      return [circleDraws, circleFocusDraws];\n    }\n\n    /**\n     * Shows value and type for each bar\n     *\n     * @param trackX relative x-coordinate of mouse\n     * @param trackY relative y-coordinate of mouse\n     * @returns string with embedded values and svg square for color\n     */\n    getMouseOverHtml(trackX, trackY) {\n      this.hoveringSnp = undefined;\n\n      if (!this.tilesetInfo || !this.options.toolTip || !this.valueScale)\n        return '';\n\n      const zoomLevel = this.calculateZoomLevel();\n      const tileWidth = tileProxy.calculateTileWidth(\n        this.tilesetInfo,\n        zoomLevel,\n        this.tilesetInfo.tile_size\n      );\n\n      // the position of the tile containing the query position\n      const genomePos = this._xScale.invert(trackX);\n      const relTilePos = genomePos / tileWidth;\n      const tilePos = Math.floor(relTilePos);\n      const tileId = this.tileToLocalId([zoomLevel, tilePos]);\n      const fetchedTile = this.fetchedTiles[tileId];\n\n      if (!fetchedTile) return '';\n\n      let minDist = 3;\n      fetchedTile.tileData.forEach((item) => {\n        const dist = Math.abs(this._xScale(item.xStart) - trackX);\n        if (dist < minDist) {\n          this.hoveringSnp = item;\n          minDist = dist;\n        }\n      });\n\n      if (!this.hoveringSnp) return '';\n\n      const itemY = this.finalDotYPos(\n        this.valueScale(this.hoveringSnp.importance),\n        2\n      );\n\n      if (\n        Math.abs(itemY - (trackY - 1)) >\n        MAX_RADIUS * (MAX_RADIUS_EXTENSION + 1)\n      )\n        return '';\n\n      const name = this.hoveringSnp.fields[this.options.toolTip.name.field];\n      const value = (+this.hoveringSnp.fields[\n        this.options.toolTip.value.field\n      ]).toFixed(this.options.toolTip.value.numDecimals || 2);\n      let otherStr = '';\n\n      if (this.options.toolTip.other) {\n        this.options.toolTip.other.forEach((other) => {\n          const label = other.label || '';\n          const v = (+this.hoveringSnp.fields[other.field]).toFixed(\n            other.numDecimals || 2\n          );\n          otherStr += `${label}: ${v};`;\n        });\n        otherStr = ` (${otherStr.substr(0, otherStr.length - 1)})`;\n      }\n\n      return `<div><strong>${name}:</strong> ${value}${otherStr}</div>`;\n    }\n\n    /**\n     * Export an SVG representation of this track\n     *\n     * @returns {Array} The two returned DOM nodes are both SVG\n     * elements [base,track]. Base is a parent which contains track as a\n     * child. Track is clipped with a clipping rectangle contained in base.\n     *\n     */\n    exportSVG() {\n      let track = null;\n      let base = null;\n\n      [base, track] = super.exportSVG();\n\n      base.setAttribute('class', 'exported-snp-track');\n      const output = document.createElement('g');\n\n      track.appendChild(output);\n      output.setAttribute(\n        'transform',\n        `translate(${this.position[0]},${this.position[1]})`\n      );\n\n      this.visibleAndFetchedTiles()\n        .filter((tile) => tile.plusStrandRows)\n        .forEach((tile) => {\n          // call drawTile with storePolyStr = true so that\n          // we record path strings to use in the SVG\n          const [circles, focusedCircles] = this.renderRows(\n            tile,\n            tile.plusStrandRows,\n            tile.plusStrandRows.length,\n            0,\n            this.dimensions[1],\n            'blue'\n          );\n\n          circles.forEach((circle) => {\n            const c = document.createElement('circle');\n            c.setAttribute('fill', this.options.markColor || 'black');\n            c.setAttribute('stroke-width', 0);\n            c.setAttribute('opacity', this.options.markOpacity || 0.33);\n            c.setAttribute('r', this.options.markSize);\n            c.setAttribute('cx', circle[0]);\n            c.setAttribute('cy', circle[2]);\n            output.appendChild(c);\n          });\n\n          focusedCircles.forEach((circle) => {\n            const c = document.createElement('circle');\n            c.setAttribute('fill', this.options.markColorFocus || 'red');\n            c.setAttribute('stroke-width', 0);\n            c.setAttribute('opacity', this.options.markOpacityFocus || 0.66);\n            c.setAttribute('r', this.options.markSize + 1);\n            c.setAttribute('cx', circle[0]);\n            c.setAttribute('cy', circle[2]);\n            output.appendChild(c);\n          });\n        });\n\n      const gAxis = document.createElement('g');\n      gAxis.setAttribute('id', 'axis');\n\n      // append the axis to base so that it's not clipped\n      base.appendChild(gAxis);\n      gAxis.setAttribute(\n        'transform',\n        `translate(${this.axis.pAxis.position.x}, ${this.axis.pAxis.position.y})`\n      );\n\n      if (\n        this.options.axisPositionHorizontal === 'left' ||\n        this.options.axisPositionVertical === 'top'\n      ) {\n        const gDrawnAxis = this.axis.exportAxisLeftSVG(\n          this.valueScale,\n          this.dimensions[1]\n        );\n        gAxis.appendChild(gDrawnAxis);\n      } else if (\n        this.options.axisPositionHorizontal === 'right' ||\n        this.options.axisPositionVertical === 'bottom'\n      ) {\n        const gDrawnAxis = this.axis.exportAxisRightSVG(\n          this.valueScale,\n          this.dimensions[1]\n        );\n        gAxis.appendChild(gDrawnAxis);\n      }\n\n      return [base, track];\n    }\n  }\n\n  return new SnpTrack(...args);\n};\n\nconst icon =\n  '<svg viewBox=\"0 0 16 16\" xmlns=\"http://www.w3.org/2000/svg\" fill-rule=\"evenodd\" clip-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"1.5\"><path d=\"M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268\" fill=\"none\" stroke=\"currentColor\"/><path d=\"M10.5 3.5v12\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-dasharray=\"1,2,0,0\"/><path d=\"M5.5 13.5V6\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-width=\".9969299999999999\" stroke-dasharray=\"1.71,3.43,0,0\"/><path d=\"M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z\" fill=\"currentColor\"/><path d=\"M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z\" fill=\"currentColor\"/></svg>';\n\ncreateSnpTrack.config = {\n  type: 'point-annotation',\n  datatype: ['arcs', 'bedlike'],\n  orientation: '1d',\n  name: 'Arcs1D',\n  thumbnail: new DOMParser().parseFromString(icon, 'text/xml').documentElement,\n  availableOptions: [\n    'arcStyle',\n    'flip1D',\n    'labelPosition',\n    'labelColor',\n    'labelTextOpacity',\n    'labelBackgroundOpacity',\n    'strokeColor',\n    'strokeWidth',\n    'trackBorderWidth',\n    'trackBorderColor',\n  ],\n  defaultOptions: {\n    arcStyle: 'ellipse',\n    flip1D: 'no',\n    labelColor: 'black',\n    labelPosition: 'hidden',\n    strokeColor: 'black',\n    strokeWidth: 1,\n    trackBorderWidth: 0,\n    trackBorderColor: 'black',\n  },\n  optionsInfo: {\n    arcStyle: {\n      name: 'Arc Style',\n      inlineOptions: {\n        circle: {\n          name: 'Circle',\n          value: 'circle',\n        },\n        ellipse: {\n          name: 'Ellipse',\n          value: 'ellipse',\n        },\n      },\n    },\n  },\n};\n\nexport default createSnpTrack;\n","import {\n  DEFAULT_COLOR_MAP,\n  DEFAULT_COLOR_MAP_DARK,\n  DEFAULT_COLOR_MAP_LIGHT,\n} from './constants';\nimport { createColorTexture } from './utils';\n\nconst DEFAULT_TILE_SIZE = 1024;\n\nconst DEFAULT_BIN_SIZE = 8; // 8 \"tile-pixels\" make up one bin by default\n\nconst VS = `\nprecision mediump float;\nattribute vec2 aPosition;\nattribute float aColorIdx;\nattribute float aFocused;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform sampler2D uColorMapTex;\nuniform float uColorMapTexRes;\nuniform sampler2D uColorMapFocusTex;\nuniform float uColorMapFocusTexRes;\n\nvarying vec4 vColor;\nvarying vec4 vColorFocused;\nvarying float vFocused;\n\nvoid main(void)\n{\n  // Half a texel (i.e., pixel in texture coordinates)\n  float eps = 0.5 / uColorMapTexRes;\n  float colorRowIndex = floor((aColorIdx + eps) / uColorMapTexRes);\n  vec2 colorTexIndex = vec2(\n    (aColorIdx / uColorMapTexRes) - colorRowIndex + eps,\n    (colorRowIndex / uColorMapTexRes) + eps\n  );\n  vColor = texture2D(uColorMapTex, colorTexIndex);\n\n  float eps2 = 0.5 / uColorMapFocusTexRes;\n  float colorRowIndex2 = floor((aColorIdx + eps2) / uColorMapFocusTexRes);\n  vec2 colorTexIndex2 = vec2(\n    (aColorIdx / uColorMapFocusTexRes) - colorRowIndex2 + eps2,\n    (colorRowIndex2 / uColorMapFocusTexRes) + eps2\n  );\n  vColorFocused = texture2D(uColorMapFocusTex, colorTexIndex2);\n\n  vFocused = aFocused;\n\n  gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n}\n`;\n\nconst FS = `\n  precision mediump float;\n\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vFocused;\n\n  void main() {\n    float isNotFocused = 1.0 - vFocused;\n\n    float r = vColor.r * isNotFocused + vColorFocused.r * vFocused;\n    float g = vColor.g * isNotFocused + vColorFocused.g * vFocused;\n    float b = vColor.b * isNotFocused + vColorFocused.b * vFocused;\n\n    gl_FragColor = vec4(r, g, b, 1.0);\n  }\n`;\n\nconst getHistMax = (fetchedTiles) =>\n  fetchedTiles.reduce(\n    (histMax, tile) => Math.max(histMax, tile.histogramMax),\n    0\n  );\n\nconst scaleScalableGraphics = (graphics, xScale, drawnAtScale) => {\n  const tileK =\n    (drawnAtScale.domain()[1] - drawnAtScale.domain()[0]) /\n    (xScale.domain()[1] - xScale.domain()[0]);\n  const newRange = xScale.domain().map(drawnAtScale);\n\n  const posOffset = newRange[0];\n  graphics.scale.x = tileK;\n  graphics.position.x = -posOffset * tileK;\n};\n\n// prettier-ignore\nconst segmentToPosition = (segment) => [\n  segment.xStart, segment.yStart,\n  segment.xEnd, segment.yStart,\n  segment.xEnd, segment.yEnd,\n  segment.xStart, segment.yStart,\n  segment.xStart, segment.yEnd,\n  segment.xEnd, segment.yEnd,\n];\n\nconst segmentToColorIdx = (segment) => [\n  segment.colorIdx,\n  segment.colorIdx,\n  segment.colorIdx,\n  segment.colorIdx,\n  segment.colorIdx,\n  segment.colorIdx,\n];\n\nconst segmentToFocused = (segment) => [\n  segment.focused,\n  segment.focused,\n  segment.focused,\n  segment.focused,\n  segment.focused,\n  segment.focused,\n];\n\nconst createStackedBarTrack = function createStackedBarTrack(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  const { PIXI } = HGC.libraries;\n  const { scaleLinear, scaleLog } = HGC.libraries.d3Scale;\n  const { tileProxy } = HGC.services;\n  const { colorToHex } = HGC.utils;\n\n  const opacityLogScale = scaleLog()\n    .domain([1, 10])\n    .range([0.1, 1])\n    .clamp(true);\n\n  const toRgbNorm = (color) =>\n    HGC.utils\n      .colorToRgba(color)\n      .slice(0, 3)\n      .map((x) => Math.min(1, Math.max(0, x / 255)));\n\n  class StackedBarTrack extends HGC.tracks.HorizontalLine1DPixiTrack {\n    constructor(context, options) {\n      super(context, options);\n\n      this.updateOptions();\n\n      this.pLoading = new PIXI.Graphics();\n      this.pLoading.position.x = 0;\n      this.pLoading.position.y = 0;\n      this.pMasked.addChild(this.pLoading);\n\n      this.loadIndicator = new PIXI.Text('Loading data...', {\n        fontSize: this.labelSize || 10,\n        fill: 0x808080,\n      });\n      this.pLoading.addChild(this.loadIndicator);\n    }\n\n    initTile(tile) {\n      tile.histogramMax = 0;\n      this.updateTileFocusMap(tile);\n    }\n\n    updateTileHistogram(tile) {\n      const { tileX, tileWidth } = this.getTilePosAndDimensions(\n        tile.tileData.zoomLevel,\n        tile.tileData.tilePos\n      );\n      const binSize = tileWidth / this.numBins;\n\n      tile.binXPos = new Float32Array(this.numBins + 1);\n      tile.histogram1d = new Float32Array(this.numBins);\n      tile.histogram2d = new Float32Array(this.numBins * this.numGroups);\n      tile.histogram2dNumPred = new Uint8Array(this.numBins * this.numGroups);\n\n      let max = 0;\n\n      // Determine bin boundaries\n      for (let i = 0; i <= this.numBins; i++) {\n        tile.binXPos[i] = tileX + binSize * i;\n      }\n\n      const categoryBinHash = new Map();\n      const maxBinId = this.numBins - 1;\n\n      tile.tileData.filter(this.itemFilter).forEach((item) => {\n        const group = this.categoryToGroup.get(\n          item.fields[this.categoryField].toLowerCase()\n        );\n        const binStart = Math.max(\n          0,\n          Math.min(\n            maxBinId,\n            Math.round((this.getStart(item) - tileX) / binSize)\n          )\n        );\n        const binEnd = Math.max(\n          0,\n          Math.min(maxBinId, Math.round((this.getEnd(item) - tileX) / binSize))\n        );\n        const numBins = Math.abs(binEnd - binStart);\n        const score = this.getImportance(item);\n        const category = this.getCategory(item);\n        const base = group * this.numBins;\n\n        for (let i = 0; i <= numBins; i++) {\n          const bin = binStart + i;\n          const histIdx = base + bin;\n\n          const binHash = categoryBinHash.get(category) || {};\n\n          // Make sure we count multiple enhancer predictions of the same\n          // biosample and bin only once (i.e., summing up)\n          if (!binHash[bin]) {\n            binHash[bin] = binHash[bin] || score > 0;\n            tile.histogram2dNumPred[histIdx] += binHash[bin];\n            categoryBinHash.set(category, binHash);\n          }\n\n          tile.histogram2d[histIdx] += score;\n          tile.histogram1d[bin] += score;\n\n          max = Math.max(max, tile.histogram1d[bin]);\n        }\n      });\n\n      tile.histogramMax = max;\n    }\n\n    updateHistograms() {\n      Object.values(this.fetchedTiles).forEach(\n        this.updateTileHistogram.bind(this)\n      );\n    }\n\n    updateTileFocusMap(tile) {\n      tile.focusMap = new Float32Array(this.numBins);\n\n      const { tileX, tileWidth } = this.getTilePosAndDimensions(\n        tile.tileData.zoomLevel,\n        tile.tileData.tilePos\n      );\n\n      if (\n        tileX <= this.focusRegion[1] &&\n        tileX + tileWidth >= this.focusRegion[0]\n      ) {\n        const binSize = tileWidth / this.numBins;\n\n        const binStart = Math.max(\n          0,\n          Math.round((this.focusRegion[0] - tileX) / binSize)\n        );\n        const binEnd = Math.min(\n          this.numBins - 1,\n          Math.round((this.focusRegion[1] - tileX) / binSize)\n        );\n        const numBins = Math.abs(binEnd - binStart);\n\n        for (let i = 0; i <= numBins; i++) {\n          tile.focusMap[i] = 1;\n        }\n      }\n    }\n\n    updateFocusMap() {\n      Object.values(this.fetchedTiles).forEach(\n        this.updateTileFocusMap.bind(this)\n      );\n    }\n\n    updateStratificationOption() {\n      if (!this.options.stratification) {\n        this.categoryField = undefined;\n        this.categoryToGroup = undefined;\n        this.groupToColor = undefined;\n        this.numGroups = 0;\n        this.numFilteredGroups = 0;\n        this.numCategories = 0;\n        this.groupLabels = [];\n        return;\n      }\n\n      this.categoryField = this.options.stratification.categoryField;\n      this.getCategory = (item) =>\n        item.fields[this.categoryField].toLowerCase();\n      this.categoryToGroup = new Map();\n      this.categoryToY = new Map();\n      this.groupToColor = new Map();\n\n      this.groupSizes = this.options.stratification.groups.map(\n        (group) =>\n          group.categories.filter((category) => this.valueFilter(category))\n            .length\n      );\n      this.filteredGroups = this.options.stratification.groups.filter(\n        (group, i) => this.groupSizes[i] > 0\n      );\n      this.numGroups = this.options.stratification.groups.length;\n      this.numFilteredGroups = this.filteredGroups.length;\n      this.numCategories = this.groupSizes.reduce(\n        (numCategories, groupSize) => numCategories + groupSize,\n        0\n      );\n      this.groupLabels = this.options.stratification.groups.map(\n        (group, i) => group.label || `Group ${i}`\n      );\n\n      let k = 0;\n      this.options.stratification.groups.forEach((group, i) => {\n        this.groupToColor.set(i, [\n          colorToHex(\n            group.color || DEFAULT_COLOR_MAP[i % DEFAULT_COLOR_MAP.length]\n          ),\n          colorToHex(\n            group.backgroundColor ||\n              DEFAULT_COLOR_MAP_LIGHT[i % DEFAULT_COLOR_MAP_LIGHT.length]\n          ),\n        ]);\n        group.categories\n          .filter((category) => this.valueFilter(category))\n          .forEach((category, j) => {\n            this.categoryToGroup.set(category.toLowerCase(), i);\n            this.categoryToY.set(category.toLowerCase(), k + j);\n          });\n        k += this.groupSizes[i];\n      });\n\n      this.groupLabelsPixiText = this.groupLabels.map(\n        (label, i) =>\n          new PIXI.Text(label, {\n            fontSize: this.labelSize,\n            // fill: this.labelColor,\n            align: this.axisAlign === 'right' ? 'right' : 'left',\n            fill: colorToHex(\n              this.options.stratification.groups[i].axisLabelColor ||\n                DEFAULT_COLOR_MAP_DARK[i % DEFAULT_COLOR_MAP_DARK.length]\n            ),\n          })\n      );\n    }\n\n    updateOptions() {\n      this.axisAlign = this.options.axisAlign || 'left';\n\n      this.labelColor = colorToHex(this.options.labelColor || 'black');\n\n      this.labelSize = this.options.labelSize || 12;\n\n      this.colorMap = this.options.colorMap || [...DEFAULT_COLOR_MAP];\n\n      this.colorMapRgbNorm = this.colorMap.map(toRgbNorm);\n\n      [this.colorMapTex, this.colorMapTexRes] = createColorTexture(\n        PIXI,\n        this.colorMapRgbNorm\n      );\n\n      this.colorMapFocus = this.options.colorMapFocus || [\n        ...DEFAULT_COLOR_MAP_DARK,\n      ];\n\n      this.colorMapFocusRgbNorm = this.colorMapFocus.map(toRgbNorm);\n\n      [this.colorMapFocusTex, this.colorMapFocusTexRes] = createColorTexture(\n        PIXI,\n        this.colorMapFocusRgbNorm\n      );\n\n      this.markColor = colorToHex(this.options.markColor || 'black');\n\n      this.markColorRgbNorm = this.options.markColor\n        ? toRgbNorm(this.options.markColor)\n        : [0, 0, 0];\n\n      this.markOpacity = Number.isNaN(+this.options.markOpacity)\n        ? 1\n        : Math.min(1, Math.max(0, +this.options.markOpacity));\n\n      this.markSize = this.options.markSize || 2;\n\n      this.markColorFocus = colorToHex(this.options.markColorFocus || 'red');\n\n      this.markColorFocusRgbNorm = this.options.markColorFocus\n        ? toRgbNorm(this.options.markColorFocus)\n        : [1, 0, 0];\n\n      this.markOpacityFocus = Number.isNaN(+this.options.markOpacityFocus)\n        ? this.markOpacity\n        : Math.min(1, Math.max(0, +this.options.markOpacityFocus));\n\n      this.markSizeFocus = this.options.markSizeFocus || this.markSize;\n\n      this.binSize = this.options.binSize || DEFAULT_BIN_SIZE;\n\n      this.numBins = this.tilesetInfo\n        ? Math.round(this.tilesetInfo.tile_size / this.binSize)\n        : DEFAULT_TILE_SIZE / this.binSize;\n\n      this.getOffset =\n        !Number.isNaN(+this.options.offsetField) &&\n        this.options.offsetField >= 0\n          ? (item) => this.chromOffsets[item.fields[this.options.offsetField]]\n          : () => 0;\n\n      this.getStart =\n        !Number.isNaN(+this.options.startField) && this.options.startField >= 0\n          ? (item) =>\n              this.getOffset(item) + +item.fields[this.options.startField]\n          : (item) => item.xStart;\n\n      this.getEnd =\n        !Number.isNaN(+this.options.endField) && this.options.endField >= 0\n          ? (item) => this.getOffset(item) + +item.fields[this.options.endField]\n          : (item) => item.xEnd;\n\n      this.getImportance = this.options.importanceField\n        ? (item) => +item.fields[this.options.importanceField]\n        : () => 1;\n\n      const importanceDomain = this.options.importanceDomain || [1000, 1];\n\n      this.filterSet =\n        this.options.filter && this.options.filter.set\n          ? this.options.filter.set.reduce((s, include) => {\n              s.add(include);\n              return s;\n            }, new Set())\n          : null;\n\n      this.filterField = this.options.filter && this.options.filter.field;\n\n      this.valueFilter = this.filterSet\n        ? (value) => this.filterSet.has(value)\n        : () => true;\n\n      this.itemFilter =\n        this.valueFilter && this.filterField\n          ? (item) => this.valueFilter(item.fields[this.filterField])\n          : () => true;\n\n      const opacityLinearScale = scaleLinear()\n        .domain(importanceDomain)\n        .range([1, 10]);\n\n      this.opacityScale = (x) => opacityLogScale(opacityLinearScale(x));\n\n      this.focusRegion = this.options.focusRegion\n        ? this.options.focusRegion\n        : [Infinity, Infinity];\n\n      this.focusGene = this.options.focusGene\n        ? this.options.focusGene.toLowerCase()\n        : undefined;\n\n      this.minImportance = this.options.minImportance || 0;\n\n      this.updateStratificationOption();\n\n      this.updateFocusMap();\n      this.updateHistograms();\n      this.updateScales();\n    }\n\n    updateLoadIndicator() {\n      const [left, top] = this.position;\n      this.pLoading.position.x = left + 6;\n      this.pLoading.position.y = top + 6;\n\n      if (this.fetching.size) {\n        this.pLoading.addChild(this.loadIndicator);\n      } else {\n        this.pLoading.removeChild(this.loadIndicator);\n      }\n    }\n\n    computeChromOffets() {\n      if (!this.tilesetInfo) return;\n      const chroms = this.tilesetInfo.chrom_names.split('\\t');\n      const chromSizes = this.tilesetInfo.chrom_sizes\n        .split('\\t')\n        .map((size) => +size);\n      // eslint-disable-next-line prefer-destructuring\n      this.chromOffsets = chroms.reduce(\n        ([offsets, cumSum], chrom, i) => {\n          offsets[chrom] = cumSum;\n          return [offsets, cumSum + chromSizes[i]];\n        },\n        [{}, 0]\n      )[0];\n    }\n\n    refreshTiles(...brgs) {\n      super.refreshTiles(...brgs);\n      this.computeChromOffets();\n      this.updateLoadIndicator();\n      if (this.tilesetInfo) {\n        const oldNumBins = this.numBins;\n        this.numBins = Math.round(this.tilesetInfo.tile_size / this.binSize);\n        if (oldNumBins !== this.numBins) {\n          this.updateHistograms();\n          this.updateScales();\n        }\n      }\n    }\n\n    rerender(newOptions) {\n      this.options = newOptions;\n      this.updateOptions();\n      this.updateExistingGraphics();\n    }\n\n    updateScales() {\n      const fetchedTiles = Object.values(this.fetchedTiles);\n\n      if (!fetchedTiles.length) return;\n\n      const [, height] = this.dimensions;\n\n      this.histMax = getHistMax(fetchedTiles);\n\n      this.heightScale = scaleLinear()\n        .domain([0, this.histMax])\n        .range([height, 0]);\n\n      this.valueScale = this.heightScale;\n\n      this.valueScaleInverted = scaleLinear()\n        .domain([0, this.histMax])\n        .range([0, height]);\n    }\n\n    histToSegments(tile) {\n      const segments = [];\n\n      for (let i = 0; i < this.numBins; i++) {\n        let cumHeight = 0;\n        if (tile.histogram1d[i] > 0) {\n          for (let j = 0; j < this.numGroups; j++) {\n            const height = tile.histogram2d[j * this.numBins + i];\n\n            if (height) {\n              segments.push({\n                xStart: this._xScale(tile.binXPos[i]),\n                xEnd: this._xScale(tile.binXPos[i + 1]),\n                yStart: this.heightScale(cumHeight),\n                yEnd: this.heightScale(cumHeight + height),\n                colorIdx: j % this.colorMap.length,\n                focused: tile.focusMap[i],\n              });\n\n              cumHeight += height;\n            }\n          }\n        }\n      }\n\n      return segments;\n    }\n\n    renderStackedBars() {\n      this.drawnAtScale = scaleLinear()\n        .domain([...this.xScale().domain()])\n        .range([...this.xScale().range()]);\n\n      const segments = Object.values(this.fetchedTiles).flatMap(\n        this.histToSegments.bind(this)\n      );\n\n      const positions = new Float32Array(segments.flatMap(segmentToPosition));\n      const colorIdxs = new Float32Array(segments.flatMap(segmentToColorIdx));\n      const focused = new Float32Array(segments.flatMap(segmentToFocused));\n\n      const uniforms = new PIXI.UniformGroup({\n        uColorMapTex: this.colorMapTex,\n        uColorMapTexRes: this.colorMapTexRes,\n        uColorMapFocus: this.colorMapFocusTex,\n        uColorMapFocusTexRes: this.colorMapFocusTexRes,\n      });\n\n      const shader = PIXI.Shader.from(VS, FS, uniforms);\n\n      const geometry = new PIXI.Geometry();\n      geometry.addAttribute('aPosition', positions, 2);\n      geometry.addAttribute('aColorIdx', colorIdxs, 1);\n      geometry.addAttribute('aFocused', focused, 1);\n\n      const mesh = new PIXI.Mesh(\n        geometry,\n        shader,\n        new PIXI.State(),\n        PIXI.DRAW_MODES.TRIANGLES\n      );\n\n      const newGraphics = new PIXI.Graphics();\n      newGraphics.addChild(mesh);\n\n      // eslint-disable-next-line\n      this.pMain.x = this.position[0];\n\n      if (this.indicatorPointGraphics) {\n        this.pMain.removeChild(this.indicatorPointGraphics);\n      }\n\n      this.pMain.addChild(newGraphics);\n      this.indicatorPointGraphics = newGraphics;\n\n      scaleScalableGraphics(\n        this.indicatorPointGraphics,\n        this._xScale,\n        this.drawnAtScale\n      );\n\n      this.draw();\n      this.animate();\n    }\n\n    renderTrack() {\n      this.drawAxis(this.valueScaleInverted);\n      this.renderStackedBars();\n    }\n\n    hasFetchedTiles() {\n      return Object.values(this.fetchedTiles).length;\n    }\n\n    // Called whenever a new tile comes in\n    updateExistingGraphics() {\n      this.updateLoadIndicator();\n      if (!this.hasFetchedTiles()) return;\n      this.updateHistograms();\n      this.updateScales();\n      this.renderTrack();\n    }\n\n    /**\n     * Shows value and type for each bar\n     *\n     * @param trackX relative x-coordinate of mouse\n     * @param trackY relative y-coordinate of mouse\n     * @returns string with embedded values and svg square for color\n     */\n    getMouseOverHtml(trackX, trackY) {\n      if (!this.tilesetInfo) return '';\n\n      const zoomLevel = this.calculateZoomLevel();\n      const tileWidth = tileProxy.calculateTileWidth(\n        this.tilesetInfo,\n        zoomLevel,\n        this.tilesetInfo.tile_size\n      );\n\n      // the position of the tile containing the query position\n      const relTilePos = this._xScale.invert(trackX) / tileWidth;\n      const tilePos = Math.floor(relTilePos);\n      const tileId = this.tileToLocalId([zoomLevel, tilePos]);\n      const fetchedTile = this.fetchedTiles[tileId];\n\n      if (!fetchedTile) return '';\n\n      const relPos = relTilePos - tilePos;\n      const binXPos = Math.floor(this.numBins * relPos);\n\n      const rowCumSum = [];\n      const rowNumPred = [];\n      let totalPred = 0;\n      let sum = 0;\n      for (let i = 0; i < this.numGroups; i++) {\n        sum += fetchedTile.histogram2d[i * this.numBins + binXPos];\n        const numPred =\n          fetchedTile.histogram2dNumPred[i * this.numBins + binXPos];\n        rowNumPred.push(numPred);\n        totalPred += numPred;\n        rowCumSum.push(sum);\n      }\n\n      const relYPos = this.heightScale.invert(trackY);\n      const group = rowCumSum.findIndex((cumHeight) => cumHeight > relYPos);\n\n      if (group >= 0) {\n        const [color, bg] = this.groupToColor.get(group);\n        const colorHex = `#${color.toString(16)}`;\n        const bgHex = `#${bg.toString(16)}`;\n        const value =\n          fetchedTile.histogram2dNumPred[group * this.numBins + binXPos];\n        return `<div style=\"margin: -0.25rem; padding: 0 0.25rem; background: ${bgHex}\"><strong style=\"color: ${colorHex};\">${this.groupLabels[group]}:</strong> ${value} of ${totalPred} samples</div>`;\n      }\n\n      return '';\n    }\n\n    setPosition(newPosition) {\n      super.setPosition(newPosition);\n\n      [this.pMain.position.x, this.pMain.position.y] = this.position;\n    }\n\n    zoomed(newXScale, newYScale) {\n      this.xScale(newXScale);\n      this.yScale(newYScale);\n\n      if (this.indicatorPointGraphics) {\n        scaleScalableGraphics(\n          this.indicatorPointGraphics,\n          newXScale,\n          this.drawnAtScale\n        );\n      }\n\n      this.refreshTiles();\n      this.draw();\n    }\n\n    /**\n     * Export an SVG representation of this track\n     *\n     * @returns {Array} The two returned DOM nodes are both SVG\n     * elements [base,track]. Base is a parent which contains track as a\n     * child. Track is clipped with a clipping rectangle contained in base.\n     *\n     */\n    exportSVG() {\n      let track = null;\n      let base = null;\n\n      [base, track] = super.superSVG();\n\n      base.setAttribute('class', 'exported-stacked-bar-track');\n      const output = document.createElement('g');\n\n      track.appendChild(output);\n      output.setAttribute(\n        'transform',\n        `translate(${this.position[0]},${this.position[1]})`\n      );\n\n      const segments = Object.values(this.fetchedTiles).flatMap(\n        this.histToSegments.bind(this)\n      );\n\n      segments.forEach(({ xStart, xEnd, yStart, yEnd, colorIdx }) => {\n        const r = document.createElement('rect');\n\n        r.setAttribute('x', xEnd);\n        r.setAttribute('y', yEnd);\n        r.setAttribute('width', Math.abs(xEnd - xStart));\n        r.setAttribute('height', Math.abs(yEnd - yStart));\n        r.setAttribute('fill', this.colorMap[colorIdx]);\n        r.setAttribute('stroke-width', 0);\n\n        output.appendChild(r);\n      });\n\n      const gAxis = document.createElement('g');\n      gAxis.setAttribute('id', 'axis');\n\n      // append the axis to base so that it's not clipped\n      base.appendChild(gAxis);\n      gAxis.setAttribute(\n        'transform',\n        `translate(${this.axis.pAxis.position.x}, ${this.axis.pAxis.position.y})`\n      );\n\n      if (\n        this.options.axisPositionHorizontal === 'left' ||\n        this.options.axisPositionVertical === 'top'\n      ) {\n        const gDrawnAxis = this.axis.exportAxisLeftSVG(\n          this.valueScale,\n          this.dimensions[1]\n        );\n        gAxis.appendChild(gDrawnAxis);\n      } else if (\n        this.options.axisPositionHorizontal === 'right' ||\n        this.options.axisPositionVertical === 'bottom'\n      ) {\n        const gDrawnAxis = this.axis.exportAxisRightSVG(\n          this.valueScale,\n          this.dimensions[1]\n        );\n        gAxis.appendChild(gDrawnAxis);\n      }\n\n      return [base, track];\n    }\n  }\n\n  return new StackedBarTrack(...args);\n};\n\nconst icon =\n  '<svg viewBox=\"0 0 16 16\" xmlns=\"http://www.w3.org/2000/svg\" fill-rule=\"evenodd\" clip-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"1.5\"><path d=\"M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268\" fill=\"none\" stroke=\"currentColor\"/><path d=\"M10.5 3.5v12\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-dasharray=\"1,2,0,0\"/><path d=\"M5.5 13.5V6\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-width=\".9969299999999999\" stroke-dasharray=\"1.71,3.43,0,0\"/><path d=\"M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z\" fill=\"currentColor\"/><path d=\"M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z\" fill=\"currentColor\"/></svg>';\n\ncreateStackedBarTrack.config = {\n  type: 'stacked-bar',\n  datatype: ['bedlike'],\n  orientation: '1d',\n  name: 'Advanced Stacked Bars Track',\n  thumbnail: new DOMParser().parseFromString(icon, 'text/xml').documentElement,\n  availableOptions: [\n    'flip1D',\n    'labelPosition',\n    'labelColor',\n    'labelTextOpacity',\n    'labelBackgroundOpacity',\n    'strokeColor',\n    'strokeWidth',\n    'trackBorderWidth',\n    'trackBorderColor',\n  ],\n  defaultOptions: {\n    flip1D: 'no',\n    labelColor: 'black',\n    labelPosition: 'hidden',\n    strokeColor: 'black',\n    strokeWidth: 1,\n    trackBorderWidth: 0,\n    trackBorderColor: 'black',\n  },\n};\n\nexport default createStackedBarTrack;\n","import createPubSub from 'pub-sub-es';\nimport { sortedIndex } from 'lodash-es';\n\nfunction createTssTrack(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  class TssTrack extends HGC.tracks.BedLikeTrack {\n    constructor(context, options) {\n      super(context, options);\n\n      const { publish, subscribe, unsubscribe } = createPubSub();\n      this.publish = publish;\n      this.subscribe = subscribe;\n      this.unsubscribe = unsubscribe;\n\n      this.collectAnnotationsBound = this.collectAnnotations.bind(this);\n\n      this.updateOptions();\n    }\n\n    updateOptions() {\n      this.options.maxPerTile = this.options.maxPerTile || 50;\n    }\n\n    drawPoly() {}\n\n    renderRows() {}\n\n    collectAnnotations(tile) {\n      const zoomLevel = +tile.tileId.split('.')[0];\n\n      this.initialize();\n\n      const focusRegion = this.options.focusRegion || [Infinity, Infinity];\n\n      const annotations = [];\n\n      const rows = [\n        ...(tile.plusStrandRows || []),\n        ...(tile.minusStrandRows || []),\n      ];\n\n      const sortedIdxs = [];\n      const sortedValues = [];\n\n      for (let j = 0; j < rows.length; j++) {\n        for (let i = 0; i < rows[j].length; i++) {\n          const td = rows[j][i].value;\n          const geneInfo = td.fields;\n\n          // the returned positions are chromosome-based and they need to\n          // be converted to genome-based\n          const chrOffset = +td.chrOffset;\n          const txStart = +geneInfo[1] + chrOffset;\n          const txEnd = +geneInfo[2] + chrOffset;\n\n          const xStartPos = this._xScale(txStart);\n          const xEndPos = this._xScale(txEnd);\n\n          // don't draw anything that has already been drawn\n          if (\n            !(\n              zoomLevel in this.drawnRects &&\n              td.uid in this.drawnRects[zoomLevel]\n            )\n          ) {\n            if (!this.drawnRects[zoomLevel]) this.drawnRects[zoomLevel] = {};\n\n            const circleDraw = {\n              xStartScreen: xStartPos,\n              xEndScreen: xEndPos,\n              xStartAbs: txStart,\n              xEndAbs: txEnd,\n              data: td,\n              isFocused: txStart <= focusRegion[1] && txEnd >= focusRegion[0],\n            };\n\n            const idx = sortedIndex(sortedValues, td.importance);\n            sortedValues.splice(idx, 0, td.importance);\n            sortedIdxs.splice(idx, 0, annotations.push(circleDraw) - 1);\n          }\n        }\n      }\n\n      if (annotations.length <= this.options.maxPerTile) return annotations;\n\n      return sortedIdxs\n        .slice(0, this.options.maxPerTile)\n        .map((idx) => annotations[idx]);\n    }\n\n    rerender() {\n      this.updateOptions();\n      this.updateExistingGraphics();\n    }\n\n    updateExistingGraphics() {\n      super.updateExistingGraphics();\n      const annotations = Object.values(this.visibleAndFetchedTiles())\n        .map(this.collectAnnotationsBound)\n        .reduce(\n          (allAnnotations, tileAnnotations) =>\n            allAnnotations.concat(tileAnnotations),\n          []\n        );\n      this.publish('tilesDrawn', { uuid: this.uuid, annotations });\n    }\n\n    getMouseOverHtml() {\n      return '';\n    }\n  }\n\n  return new TssTrack(...args);\n}\n\ncreateTssTrack.config = {\n  type: 'tss',\n  datatype: ['bedlike'],\n};\n\nexport default createTssTrack;\n","import { globalPubSub } from 'pub-sub-es';\n\n// Timeout requests after 10 seconds\nconst T_TIMEOUT = 10000;\n\nconst LocalCsvDataFetcher = function LocalCsvDataFetcher(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  const createRandomId = () => Math.random().toString(36).substring(2);\n\n  class LocalBedDataFetcherClass {\n    constructor(dataConfig) {\n      this.dataConfig = dataConfig;\n    }\n\n    tilesetInfo(callback) {\n      this.tilesetInfoLoading = true;\n\n      if (!this.tilesetInfoData) {\n        this.tilesetInfoData = new Promise((resolve, reject) => {\n          const requestId = createRandomId();\n          const timeoutId = setTimeout(\n            () =>\n              reject(\n                new Error(\n                  `Could not load tileset info for ${this.dataConfig.id}`\n                )\n              ),\n            T_TIMEOUT\n          );\n          globalPubSub.subscribe(\n            `localBed:tilesetInfo:${requestId}`,\n            (tilesetInfo) => {\n              clearTimeout(timeoutId);\n              this.tilesetInfoLoading = false;\n              resolve(tilesetInfo);\n            },\n            1\n          );\n          globalPubSub.publish('localBed:requestTilesetInfo', {\n            fileId: this.dataConfig.id,\n            requestId,\n          });\n        });\n      }\n\n      this.tilesetInfoData.then((tilesetInfoData) => {\n        callback(tilesetInfoData);\n      });\n    }\n\n    /** We expect there to be a tilesetUid in the provided tilesetInfo\n     * and tiles data since tileResponseToData needs it\n     *\n     * It is also easier for users to paste in request responses for debugging.\n     */\n    fetchTilesDebounced(loadHandler, tileIds) {\n      Promise.all(tileIds.map((tileId) => this.tile(tileId.split('.')))).then(\n        (tiles) => {\n          loadHandler(\n            tiles.reduce((response, tile, i) => {\n              response[tileIds[i]] = tile;\n              return response;\n            }, {})\n          );\n        }\n      );\n    }\n\n    tile([z, x]) {\n      return new Promise((resolve, reject) => {\n        const requestId = createRandomId();\n        const timeoutId = setTimeout(\n          () =>\n            reject(\n              new Error(\n                `Could not load tile ${z}.${x} for ${this.dataConfig.id} (request: ${requestId})`\n              )\n            ),\n          T_TIMEOUT\n        );\n        globalPubSub.subscribe(\n          `localBed:tile:${requestId}`,\n          (tile) => {\n            clearTimeout(timeoutId);\n            resolve(tile);\n          },\n          1\n        );\n        globalPubSub.publish('localBed:requestTile', {\n          fileId: this.dataConfig.id,\n          z: +z,\n          x: +x,\n          requestId,\n        });\n      });\n    }\n  }\n\n  return new LocalBedDataFetcherClass(...args);\n};\n\nLocalCsvDataFetcher.config = {\n  type: 'localBed',\n};\n\nexport default LocalCsvDataFetcher;\n","import register from 'higlass-register';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'higlass-arcs';\n\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nimport createAnnotationOverlayMetaTrack from './annotation-overlay-meta-track';\nimport createRidgePlotTrack from './ridge-plot-track';\nimport createStratifiedBedTrack from './stratified-bed-track';\nimport createSnpTrack from './snp-track';\nimport createStackedBarTrack from './stacked-bar-track';\nimport createTssTrack from './tss-track';\n\nimport createLocalBedDataFetcher from './local-bed-data-fetcher';\n\nimport './index.css';\n\nregister(\n  {\n    dataFetcher: createLocalBedDataFetcher,\n    config: createLocalBedDataFetcher.config,\n  },\n  { pluginType: 'dataFetcher' }\n);\n\nregister({\n  track: createRidgePlotTrack,\n  config: createRidgePlotTrack.config,\n});\n\nregister({\n  track: createStratifiedBedTrack,\n  config: createStratifiedBedTrack.config,\n});\n\nregister({\n  track: createSnpTrack,\n  config: createSnpTrack.config,\n});\n\nregister({\n  track: createStackedBarTrack,\n  config: createStackedBarTrack.config,\n});\n\nregister({\n  track: createTssTrack,\n  config: createTssTrack.config,\n});\n\nregister({\n  track: createAnnotationOverlayMetaTrack,\n  config: createAnnotationOverlayMetaTrack.config,\n  isMetaTrack: true,\n});\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}