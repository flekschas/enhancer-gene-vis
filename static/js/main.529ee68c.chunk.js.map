{"version":3,"sources":["images/enhancer-view-1.png","images/enhancer-view-2.png","images/enhancer-view-3.png","images/enhancer-view-4.png","images/enhancer-view-5.png","images/gene-view-1.png","images/gene-view-2.png","AppInitializing.js","AppError.js","ChromInfoProvider.js","use-debounce.js","CheckboxList.js","Logo.js","FileInput.js","utils.js","local-bed-data-server.js","use-query-string.js","constants.js","view-config.js","state.js","VariantsSettings.js","Welcome.js","ModalProvider.js","AppSidebar.js","SearchField.js","use-previous.js","AppTopbar.js","EnhancerRegionsInfo.js","EnhancerRegionsHelp.js","EnhancerRegionsSettings.js","TitleBar.js","EnhancerRegions.js","EnhancerGenesInfo.js","EnhancerGenesHelp.js","AntSwitch.js","EnhancerGenesSettings.js","TooltipProvider.js","EnhancerGenesPlot.js","EnhancerGenes.js","DnaAccessibilityInfo.js","DnaAccessibilityHelp.js","DnaAccessibilitySettings.js","DnaAccessibility.js","AppMain.js","with-either.js","App.js","serviceWorker.js","annotation-overlay-meta-track.js","ridge-plot-track.js","stratified-bed-track.js","snp-track.js","stacked-bar-track.js","tss-track.js","local-bed-data-fetcher.js","index.js"],"names":["module","exports","useStyles","makeStyles","theme","backdrop","zIndex","drawer","color","backgroundColor","AppInitializing","classes","className","Backdrop","open","CircularProgress","ChromInfoContext","createContext","ChromInfoProvider","children","chromInfo","Provider","value","useChromInfo","context","React","useContext","undefined","Error","useDebounce","delay","useState","debouncedValue","setDebouncedValue","useEffect","handler","setTimeout","clearTimeout","root","position","filterBar","top","content","right","left","bottom","background","checkbox","marginTop","marginBottom","checkboxLabel","fontSize","marginLeft","nestedCheckbox","visible","transition","transform","height","invisible","Option","memo","filterState","name","stateWithName","group","stateWithGroup","colorCheckbox","colorText","filter","useRecoilValue","useRecoilState","state","setState","groupState","setGroupState","nameLowerCase","useMemo","toLowerCase","changeHandler","useCallback","event","currState","checked","target","currGroupState","newGroupState","n","N","length","includes","FormControlLabel","key","control","Checkbox","style","icon","checkedIcon","onChange","label","Typography","noWrap","OptionGroup","NestedCheckboxList","optionWithName","optionGroupWithGroup","filterLabel","groupedOptions","optionToGroup","groupColors","groupColorsDark","globalFilter","setGlobalFilter","setFilter","filterDb","filterChangeHandler","filterBarBg","FormControl","variant","margin","fullWidth","InputLabel","htmlFor","Grid","container","direction","alignItems","OutlinedInput","id","FormGroup","map","i","Fragment","options","option","logo","padding","lineHeight","fontWeight","logoAbc","letterSpacing","paddingRight","logoEnhancer","Logo","props","styles","item","defaultProps","FileInput","forwardRef","ref","clearHandler","onClear","accept","Icon","InsertDriveFileIcon","otherProps","file","setFile","localChangeHandler","fileList","files","clearFile","ButtonGroup","Button","component","disableElevation","startIcon","type","hidden","disabled","onClick","createColorTexture","PIXI","colors","colorTexRes","Math","max","ceil","sqrt","rgba","Float32Array","forEach","Texture","fromBuffer","dashedXLineTo","graphics","xStart","xEnd","y","dashSize","diff","sign","width","abs","stepSize","numSteps","moveTo","lineTo","getQueryStringValue","decoder","identity","queryString","parse","window","location","search","setQueryStringValue","encoder","values","newQsValue","stringify","strict","url","origin","pathname","history","pushState","path","toAbsPosition","absPosition","indexOf","split","chrom","pos","chrPositions","toFixed","number","decimals","forced","string","substring","scaleBand","domain","fixedBandwidth","bandwidth","range","rangeSize","paddingInner","paddingInnerZeroBased","totalWidth","sum","a","b","getBandwidth","update","totalPaddingInner","reduce","scale","v","idx","slice","newDomain","newRange","newFixedBandwidth","newPaddingInner","newPaddingInnerZeroBased","booleanQueryStringDecoder","isChrRange","chrRange","match","chrPosUrlDecoder","chrPos","replace","chrPosUrlEncoder","chrPosAdd","chrRangePosUrlDecoder","chrRangePos","start","end","chrRangePosEncoder","chrPosEncoder","lengthOperator","startChrom","startPos","endChrom","endPos","join","chrRangePosUrlEncoder","header","columnImportance","tree","IntervalTree","text","lines","fields","chromOffset","startAbs","endAbs","insert","chrOffset","importance","uid","createLocalBedDataServer","tilesetInfo","whenIndex","loadFile","subscriptionTile","globalPubSub","subscribe","fileId","z","x","requestId","then","index","tileWidth","max_width","results","publish","subscriptionTilesetInfo","destroy","unsubscribe","useRecoilQueryString","atom","setValue","newValue","useRecoilQueryStringSyncher","EPS","DEFAULT_COLOR_MAP","DEFAULT_COLOR_MAP_DARK","DEFAULT_COLOR_MAP_LIGHT","GENE_SEARCH_URL","VARIANT_SEARCH_URL","DEFAULT_STRATIFICATION","categoryField","axisShowGroupSeparator","axisNoGroupColor","groups","categories","GROUPED_SAMPLE_OPTIONS","SAMPLE_TO_GROUP","sampleToGroup","SAMPLES","flatMap","SAMPLE_IDX","idxs","sample","VARIANT_TRACK_ABBR_TO_SERVER","rg","hg","VARIANT_TRACK_SERVER_TO_ABBR","Object","entries","abbr","DEFAULT_VARIANT_TRACK_SERVER_ABBR","DEFAULT_VARIANT_TRACK_DEF","axisPositionHorizontal","markColor","markColorFocus","markSize","markOpacity","markOpacityFocus","valueColumn","labelPosition","labelColor","labelOpacity","showMousePosition","showGlobalMousePosition","mousePositionColor","toolTip","field","numDecimals","other","LOCAL_BED_TILESET_INFO_HG19","zoom_step","max_length","assembly","chrom_names","chrom_sizes","tile_size","max_zoom","min_pos","max_pos","version","coordSystem","DEFAULT_VIEW_CONFIG_ENHANCER","editable","trackSourceServers","views","genomePositionSearchBox","autocompleteServer","autocompleteId","chromInfoServer","chromInfoId","chromInfoPath","tracks","contents","stroke","fontIsLeftAligned","tilesetUid","server","fromViewUid","projectionFillColor","projectionStrokeColor","projectionFillOpacity","projectionStrokeOpacity","strokeWidth","plusStrandColor","minusStrandColor","geneAnnotationHeight","geneLabelPosition","geneStrandSpacing","maxPerTile","focusRegion","strokeColor","strokeOpacity","arcStyle","startField","endField","set","binSize","axisAlign","offsetField","importanceField","importanceDomain","stratification","legendAlign","markColorHighlight","markColorDehighlight","markMinWidth","markHeight","rowHeight","indicatorStyle","geneField","overlays","extent","minWidth","fill","fillOpacity","outline","outlineOpacity","outlineWidth","outlinePos","metaTracks","overlaysTrack","annotationTracks","layout","w","h","initialXDomain","initialYDomain","DEFAULT_DNA_ACCESSIBILITY_ROW_SELECTION","DEFAULT_DNA_ACCESSIBILITY_ROW_CATEGORIES","row","category","axisLabelColor","axisLabelBackground","DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY","zoomFixed","labelShowResolution","labelShowAssembly","markArea","markResolution","valueScaling","colorRange","rowPadding","rowNormalization","rowSelections","rowIdToCategory","fn","args","rowCategories","showRowLabels","rowLabelSize","IGNORED_FOCUS_ELEMENTS","Set","getFocusGeneRegion","viewConfig","getFocusVariantRegion","track","updateViewConfigVariantTracks","variantTrackConfigs","trackConfig","variantTrack","deepClone","push","data","updateViewConfigFocusRegion","region","trackIdxs","Array","isArray","trackIdx","childTrack","setFocusRegion","updateViewConfigVariantYScale","yScale","updateViewConfigXDomain","newXDomainStart","newXDomainEnd","force","_force","isFunction","xDomain","focusGeneRegion","focusVariantRegion","Number","isNaN","min","getDefault","initialValue","qVal","showWelcomeDecoder","excluded","s","_s","add","has","customBooleanQueryStringDecoder","variantTracksEncoder","serverAbbr","pValCol","columnPvalue","pProbCol","columnPosteriorProbability","sampleFilterState","default","sampleSelectionState","selector","get","sampleWithName","selectedSamplesState","memoize","sampleGroupWithGroup","sampleGroupSelectionSizesState","sizes","variantTracksState","showVariantsSettingsState","showWelcomeState","dnaAccessLabelStyleState","dnaAccessRowNormState","dnaAccessLabelShowInfoState","focusGeneState","focusGeneOptionState","focusRegionState","focusRegionOptionState","chrStart","txStart","chrEnd","txEnd","geneName","variantYScaleState","enhancerRegionsHideUnfocusedState","enhancerRegionsColorEncodingState","enhancerRegionsShowInfoState","enhancerGenesShowInfoState","enhancerGenesPaddingState","enhancerGenesCellEncodingState","enhancerGenesSvgState","higlassEnhancerRegionsState","higlassDnaAccessState","xDomainStartWithAssembly","totalLength","absToChr","xDomainEndWithAssembly","xDomainStartAbsWithAssembly","xDomainStart","xDomainEndAbsWithAssembly","xDomainEnd","focusGeneStartWithAssembly","focusGeneOption","chr","focusGeneEndWithAssembly","focusRegionAbsWithAssembly","focusRegionOption","focusRegionRelState","NaN","focusRegionStrState","dnaAccessXDomainWithAssembly","focusRegionAbs","focusGeneStart","focusGeneEnd","xDomainStartAbs","xDomainEndAbs","interval","enhancerViewRange","enhancerViewCenter","focusRegionCenter","midPos","getDnaAccessXDomain","useFocusGene","useFocusRegion","useDnaAccessShowInfos","useXDomainStartWithAssembly","useXDomainEndWithAssembly","useEnhancerRegionsShowInfos","useEnhancerGenesShowInfos","note","palette","grey","title","buttonNormal","buttonActive","boxShadow","trackList","useStylesTrackConfig","grow","flex","separator","marginRight","propInput","useStylesTooltipVisible","arrow","tooltip","useStylesTooltipHidden","display","TrackConfig","config","propertyChangeHandler","property","isRemote","Boolean","isLocal","whatever","classesTooltipVisible","classesTooltipHidden","Tooltip","placement","TextField","size","step","VariantsSettings","closeHandler","variantTracks","setVariantTracks","setFocusRegionOption","tmpVariantTracks","setTmpVariantTracks","changed","setChanged","variantTrackServers","useRef","currVariantTracks","current","changeTmpVariantTracks","newTrackConfig","currTmpVariantTracks","newTmpVariantTracks","saveHandler","newVariantTracks","servers","some","currFocusRegion","isString","currFocusRegionOption","align","href","rel","variantTrackConfig","justifyContent","spacing","showIntro","startExploring","introTitle","textTransform","introHeadline","introSubHeadline","introStartExploring","figure","Welcome","openIntroHandler","showWelcome","src","imgEnhancerView1","alt","imgEnhancerView2","imgEnhancerView3","imgEnhancerView4","imgEnhancerView5","IconButton","imgGeneView1","imgGeneView2","ModalContext","paper","borderRadius","shadows","maxWidth","maxHeight","overflow","ModalProvider","Component","setComponent","customCloseHandler","setCustomCloseHandler","customProps","setCustomProps","showModal","newComponent","newCustomCloseHandler","newCustomProps","Modal","aria-labelledby","aria-describedby","onClose","closeAfterTransition","BackdropComponent","BackdropProps","timeout","Fade","in","h1","flexShrink","drawerGrid","drawerPaper","settings","flexGrow","globalSettingsTitle","settingsContent","toolbar","mixins","titleBar","titleBarText","titleBarContainer","titleBarTitle","titleBarIcon","titleBarIconActive","globalSettingsFirstBox","extractCoreFromHiGlassSvg","svg","fifthLn","nthIndexOf","lastLn","lastIndexOf","core","AppSidebar","useShowModal","setXDomainStart","setXDomainEnd","setShowWelcome","showVariantsSettings","setShowVariantsSettings","higlassEnhancerRegions","higlassDnaAccess","enhancerGenesSvg","userChangedDomain","setUserChangedDomain","numericalXDomainStart","chrToAbs","numericalXDomainEnd","xDomainStartChangeHandler","xDomainEndChangeHandler","curr","closeWelcome","openWelcome","openWelcomeIntro","closeVariantsSettings","openVariantsSettings","mergeSvgs","enhancerSvg","dnaAccessSvg","enhancerGeneSvg","enhancerSvgCore","enhancerWidth","enhancerHeight","dnaAccessSvgCore","dnaAccessWidth","dnaAccessHeight","firstSvgClosingBracket","lastSvgOpeningBracket","extractCoreFromStringifiedSvg","enhancerGeneSvgCore","enhancerGeneHeight","actualEnhancerHeight","actualDnaAccessHeight","mergedSvg","Drawer","anchor","ButtonBase","Divider","Box","m","getViewConfig","zoomTo","CheckboxList","exportAsSvg","XMLSerializer","serializeToString","filename","stringOrBlob","blob","Blob","navigator","msSaveOrOpenBlob","msSaveBlob","elem","document","createElement","URL","createObjectURL","download","body","appendChild","click","removeChild","revokeObjectURL","console","warn","inputRoot","borderTopLeftRadius","borderTopRightRadius","borderBottomWidth","focused","input","textFieldRoot","fetchJsonFromUrl","query","fetch","response","json","result","GeneIcon","SvgIcon","viewBox","d","GeneOption","VariantOption","RegionOption","getIcon","SearchField","setOpen","setOptions","inputValue","searchQuery","setSearchQuery","debouncedSearchQuery","loading","autocompleteClasses","customSearch","searchUrl","active","whenResults","Promise","all","flat","multiple","autocompleteOptions","Autocomplete","larger","onInputChange","newInputValue","onOpen","getOptionSelected","_value","getOptionLabel","renderInput","params","InputProps","endAdornment","renderOption","renderTags","getTagProps","Chip","usePrevious","appBar","common","black","white","toolbarExtra","paddingLeft","locationSearch","startChr","endChr","AppTopbar","focusGene","setFocusGene","setFocusGeneOption","prevFocusGeneOption","prevFocusRegionOption","focusOptions","_focusOptions","clearFocusGene","clearFocusRegion","AppBar","Toolbar","newOptions","newFocusElements","newOption","gene","gray","pink","EnhancerRegionsInfo","showInfo","iconRadioLegend","variantYScale","setVariantYScale","hideUnfocused","setHideUnfocused","colorEncoding","setColorEncoding","hideUnfocusedChangeHandler","changeVariantYScale","changeColorEncoding","Switch","FormLabel","RadioGroup","aria-label","iconRadio","iconRadioActive","bar","iconActive","popeover","paddingTop","info","borderBottom","TitleBar","Info","Help","Settings","useShowInfo","popoverDirection","setShowInfo","helpAnchorEl","setHelpAnchorEl","settingsAnchorEl","setSettingsAnchorEl","infoToggleHandler","show","helpOpenHandler","currentTarget","helpCloseHandler","settingsOpenHandler","settingsCloseHandler","helpId","settingsId","anchorOriginVertical","transformOriginVertical","helpOpen","settingsOpen","iconInfoClass","iconHelpClass","iconSettingsClass","wrap","Popover","anchorEl","anchorOrigin","vertical","horizontal","transformOrigin","fullWidthHeight","higlassContainer","minHeight","panZoomTip","textAlign","opacity","animation","userSelect","panZoomTipNormal","panZoomTipNormalHover","panZoomTipActive","panZoomTipActiveHover","EnhancerRegion","useSetRecoilState","setHiglass","sampleGroupSelectionSizes","selectedSamples","higlassMouseOver","setHiglassMouseOver","higlassFocus","setHiglassFocus","higlassApi","higlassRangeSelection","higlassListeners","higlassContainerRef","higlassEnhancerClickSelection","higlassMouseDown","higlassNumMouseOver","higlassNumFocus","higlassNumFocusMouseOut","shouldSkipUpdatingXDomain","numSamples","pipe","focusStyle","updateViewConfigFocusStyle","coloring","opacityEncoding","updateViewConfigFilter","matrixTrack","updateViewConfigMatrixHeight","viewConfigHeight","higlassBlockClasses","higlassClickHandler","payload","score","higlassLocationChangeHandlerDb","debounce","absPos","higlassRangeSelectionHandler","dataRange","windowMouseDownClearHandler","e","isParentOf","addEventListener","removeEventListener","higlassMouseDownHandler","higlassInitHandler","higlassInstance","api","setRangeSelectionToInt","on","getComponent","element","keydownHandler","activeElement","tagName","preventDefault","altKey","activateTool","keyupHandler","off","EnhancerRegionsHelp","EnhancerRegionsSettings","onMouseEnter","onMouseLeave","onMouseDown","onFocus","onBlur","tabIndex","sizeMode","globalMousePosition","verticalAlign","placeholder","fontStyle","small","medium","large","focusRegionStr","cellEncoding","justify","AntSwitch","withStyles","switchBase","primary","main","borderColor","thumb","border","switch","EnhancerGenesSettings","setCellEncoding","setPadding","changeCellEncoding","TooltipContext","pointerEvents","TooltipProvider","localState","setLocalState","showTooltip","plot","plotSvg","useTooltipStyles","uuid","fetchTiles","tileIds","tileId","samples","j","dodge","radius","radius2","circles","sort","head","tail","intersects","next","Infinity","EnhancerGenesPlot","useShowTooltip","sampleSelection","geneCellEncoding","absRange","relPosition","strPosition","genePadding","plotEl","setPlotEl","tile","setTile","isLoadingTile","setIsLoadingTile","setTilesetInfo","setWidth","prevWidth","prevGeneCellEncoding","absStart","absEnd","regionLength","minTileSize","getMinTileSize","zoomOutLevel","log2","zoomLevel","tileSize","tileXPosStart","floor","tileXPosEnd","ids","xPos","tiles","filterIntervalsByRange","plotElRef","node","isInit","maxScore","minAbsDistance","maxAbsDistance","genes","categoryAggregation","numEnhancers","distComparator","absDistance","genesUpstreamByDist","TinyQueue","genesDownstreamByDist","entry","relGenePos","distance","isDownstream","samplesByCategory","sampleCategory","genesDownstreamByDistArr","pop","genesUpstreamByDistArr","prevGene","relDistance","useLayoutEffect","measure","requestAnimationFrame","currWidth","getBoundingClientRect","tooltipClasses","select","paddingBottom","circleRadius","circlePadding","geneLabelPadding","beeswarmPadding","distanceBarWidth","distPaddingRange","attr","maxCatgorySize","cat","categorySizeScale","scaleLog","clamp","percentScale","scaleLinear","circleYScalePre","circleYScalePost","circleYScale","geneContainerWidth","maxGenes","genesUpstream","reverse","genesDownstream","minMax","minRelDistance","maxRelDistance","paddingScale","genesUpstreamPadding","round","genesUpstreamScale","genesDownstreamPadding","genesDownstreamScale","genesUpstreamLeftPad","minVisibleAbsDist","minDist","maxVisibleAbsDist","maxDist","distanceHeightScale","plotBeeswarm","selection","isRightAligned","selectAll","getArrayNumCols","maxSize","plotArray","numCols","instanceCache","tooltipTitleGetter","cellSize","indexToX","indexToY","bBox","arrayTooltipTitleGetter","geneArrayInstances","upstream","downstream","geneArrayInstanceMouseEnterHandler","dHovering","geneArrayInstanceMouseLeaveHandler","plotBox","valueScale","valueGetter","cellWidth","fillColor","textColor","showText","showZero","showTooltipOnMouseEnter","bg","boxTooltipTitleGetter","enhancerG","enhancerGCellG","genesUpstreamG","geneLabelX","geneLabelY","genesUpstreamGCellG","remove","genesDownstreamG","genesDownstreamGCellG","distRange","distStep","tickValues","call","axisRight","tickSize","tickFormat","this","parentNode","nextSibling","g","plotEnhancerGeneConnections","EnhancerGenes","EnhancerGenesInfo","EnhancerGenesHelp","DnaAccessibilityInfo","xDomainAbs","dnaAccessibilityRegionSize","DnaAccessibilityHelp","DnaAccessibilitySettings","dnaAccessLabelStyle","setDnaAccessLabelStyle","dnaAccessRowNorm","setDnaAccessRowNorm","changeDnaAccessLabelStyle","DnaAccessibility","setHiglassDnaAccess","labelStyle","rowNorm","xDomainAbsDb","labels","updateViewConfigDnaAccessRowNorm","rowId","pixelPreciseMarginPadding","containerPaddingX","containerPaddingY","viewMarginTop","viewMarginBottom","viewMarginLeft","viewMarginRight","viewPaddingTop","viewPaddingBottom","viewPaddingLeft","viewPaddingRight","enhancerWrapper","enhancer","overflowY","enhancerRegions","enhancerGenes","dnaAccessibility","AppMain","useXDomainStartWithAssemblySyncher","useXDomainEndWithAssemblySyncher","focusGeneChangeHandler","focusRegionChangeHandler","r","CssBaseline","withEither","ifEitherFn","EitherComponent","createMuiTheme","secondary","App","setChromInfo","ChromosomeInfo","_chromInfo","catch","Main","AppError","ThemeProvider","hostname","createAnnotationOverlayMetaTrack","HGC","pubSub","services","AnnotationOverlayMetaTrack","definition","getTrackObject","animate","onNewTilesLoaded","annotationTrackIds","tilesDrawnEndHandlerBound","tilesDrawnEndHandler","bind","drawnAnnotations","Map","tracksDrawingTiles","pubSubs","annotationsDrawnHandlerBound","annotations","xStartAbs","xEndAbs","updateOverlays","from","draw","clear","availableOptions","defaultOptions","FLOAT_BYTES","BYTES_PER_ELEMENT","VS","FS","COLORMAP_GRAYS","getMax","fetchedTiles","maxValue","tileData","maxNonZero","getNumRows","coarseShape","getRowMaxs","maxVector","maxValueByRow","scaleGraphics","xScale","drawnAtScale","tileK","posOffset","getNumPointsPerRow","numRows","positions","createRidgePlotTrack","libraries","format","d3Format","d3Scale","tileProxy","RidgePlotTrack","updateOptions","pLoading","Graphics","pMasked","addChild","loadIndicator","Text","labelSize","coarsifyTileValues","bins_per_dimension","tilePos","binsPerTileIn","binsPerTile","resolutions","chosenResolution","tileHeight","tileX","tileY","xTilePos","yTilePos","minX","minY","reverseYAxis","selectRowsAggregationMode","selectRowsAggregationFn","maxNan","minNan","sumNan","meanNan","markAreaColor","utils","colorToHex","markColorRgbNorm","colorToRgba","markColorTex","markColorTexRes","markNumColors","oldMarkResolution","TILE_SIZE","oldRowHeight","oldRowPadding","oldRowNormalization","oldRowSelections","oldShowRowLabels","updateTiles","updateRowLabels","drawLabel","updateScales","rowLabelAlign","pAxis","removeChildAt","rowLabels","rowLabel","row_infos","rowIndex","removeRowLabels","indicator","Sprite","WHITE","tint","dimensions","yStart","xLabelOffset","getRowHeight","rowStepHeight","rowStepYCenter","updateExistingGraphics","getTilePosAndDimensions","shape","binSizePx","binSizeBp","binSizeBpHalf","binXPos","valuesByRow","meanValue","dense","subarray","rowIdx","actualTrackHeight","getTrackHeight","globalMax","colorIndexScale","rowMaxs","rowValueScales","rowColorIndexScales","valueScaleByRow","colorIndexScaleByRow","rowScale","maxRows","positionsByRow","colorIndicesByRow","offsetSignsByRow","_xScale","size2d","size1d","unshift","numPointsPerRow","verticesPerLine","verticesPerPoint","indices","Uint32Array","k","p1a","p1b","p1c","p1d","p2a","p2b","p2c","p2d","indexOffset","visibleTrackHeight","tilesToData","colorIndices","offsetSigns","toLineIndices","uniforms","UniformGroup","uLineColor","uNaNColor","uAreaColorTex","uAreaColorTexRes","uWidth","uMiter","shader","Shader","geometry","Geometry","numVerticesPoint","addAttribute","TYPES","FLOAT","addIndex","mesh","Mesh","newGraphics","pMain","lineGraphics","updateLoadIndicator","hasFetchedTiles","renderLines","fetching","newPosition","newXScale","newYScale","refreshTiles","trackX","trackY","calculateZoomLevel","calculateTileWidth","invert","posInTileX","rowSelection","tileToLocalId","fetchedTile","colIndex","selectRowsAggregationMethod","rowI","rowInfo","getVisibleData","svgns","base","setAttribute","output","stride","createLine","line","posPerRow","posToPoints","arr","numColors","defs","createElementNS","linearGradient","stop","insertBefore","firstChild","l","y0","firstComma","firstX","firstY","lastComma","lastX","lastY","HorizontalLine1DPixiTrack","datatype","orientation","pointToPosition","pt","cX","widthHalf","pointToIndex","pointToOpacity","pointToHighlight","highlight","getItemDistance","getMaxDistance","maxDistItem","scaleScalableGraphics","getRegionId","createStratifiedBedTrack","MAX_CLICK_DELAY","configs","opacityLogScale","StratifiedBedTrack","pLegend","legendMin","legendMax","interactive","interactiveChildren","alpha","mousedownTime","performance","now","mousedown","mouseup","clickHandler","intervalTree","regionId","isLeftToRight","categoryToGroup","groupToColor","numGroups","numCategories","groupLabels","getCategory","categoryToY","yToCategory","groupSizes","valueFilter","filteredGroups","groupSize","groupLabelsPixiText","markColorHighlightRgbNorm","markColorDehighlightRgbNorm","filterSet","include","filterField","itemFilter","getImportance","opacityScale","opacityLinearScale","getRegion","getGene","minImportance","updateStratificationOption","heightScale","categoryHeightScale","valueScaleInverted","isHighlighting","__focus","__item","focusFilterFn","addFn","filteredItems","reducerVar","accumulator","itemToIndicatorCategory","i1","isItemInFocus","dataToPoint","itemToIndicatorReducer","points","getPoints","Uint16Array","opacities","highlights","uColor","uColorHighlight","uHighlighting","indicatorPointGraphics","yEnd","xTickOffset","xTickEnd","numAxisLabels","lineStyle","labelPixiText","beginFill","drawRect","endFill","legendMinText","legendMaxText","minValue","minTextWidth","getBounds","maxTextWidth","offset","rectHeight","drawRoundedRect","renderIndicatorCategoryAxis","renderIndicatorLegend","renderIndicatorPoints","updateIndicators","relX","relY","foundItem","xAbsLo","xAbsHi","getElementAtPosition","colorHex","toString","bgHex","offsetX","offsetY","global","gAxis","createRect","f","o","strokeDasharray","x1","y1","x2","y2","createDashedLine","pixiText","t","_style","_fill","_align","_font","textContent","createText","colorHighlight","renderIndicatorCategoryAxisAsSvg","thumbnail","DOMParser","parseFromString","documentElement","flip1D","trackBorderWidth","trackBorderColor","optionsInfo","inlineOptions","circle","ellipse","createSnpTrack","d3Array","SnpTrack","colorEncodingRange","minVisibleValueInTiles","maxVisibleValueInTiles","makeValueScale","calculateMedianVisibleValue","xStartPos","xEndPos","rectY","doubleRadius","drawnPoly","anchorRadius","rectGraphics","drawCircle","finalDotYPos","rows","startY","endY","initialize","circleDraws","circleFocusDraws","td","geneInfo","yMiddle","drawnRects","circleDraw","drawPoly","buttonMode","hoveringSnp","relTilePos","dist","itemY","MAX_RADIUS","otherStr","substr","visibleAndFetchedTiles","plusStrandRows","renderRows","focusedCircles","c","axis","axisPositionVertical","gDrawnAxis","exportAxisLeftSVG","exportAxisRightSVG","BedLikeTrack","getIs2d","get1dStart","get2dStart","get1dEnd","get2dEnd","getHistMax","histMax","histogramMax","segmentToPosition","segment","segmentToColorIdx","colorIdx","segmentToFocused","createStackedBarTrack","toRgbNorm","StackedBarTrack","is2d","getStart","getEnd","updateTileFocusMap","numBins","histogram1d","histogram2d","histogram2dNumPred","Uint8Array","categoryBinHash","maxBinId","binStart","binEnd","bin","histIdx","binHash","updateTileHistogram","focusMap","numFilteredGroups","colorMap","colorMapRgbNorm","colorMapTex","colorMapTexRes","colorMapFocus","colorMapFocusRgbNorm","colorMapFocusTex","colorMapFocusTexRes","markColorFocusRgbNorm","markSizeFocus","getOffset","chromOffsets","updateFocusMap","updateHistograms","chroms","chromSizes","offsets","cumSum","brgs","computeChromOffets","oldNumBins","segments","cumHeight","histToSegments","colorIdxs","uColorMapTex","uColorMapTexRes","uColorMapFocus","uColorMapFocusTexRes","State","DRAW_MODES","TRIANGLES","drawAxis","renderStackedBars","renderTrack","relPos","rowCumSum","rowNumPred","totalPred","numPred","relYPos","findIndex","createTssTrack","TssTrack","createPubSub","collectAnnotationsBound","collectAnnotations","minusStrandRows","sortedIdxs","sortedValues","xStartScreen","xEndScreen","isFocused","sortedIndex","splice","allAnnotations","tileAnnotations","concat","LocalCsvDataFetcher","createRandomId","random","LocalBedDataFetcherClass","dataConfig","callback","tilesetInfoLoading","tilesetInfoData","resolve","reject","timeoutId","loadHandler","register","dataFetcher","createLocalBedDataFetcher","pluginType","isMetaTrack","ReactDOM","render","getElementById","serviceWorker","ready","registration","unregister","error","message"],"mappings":"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sBACA,kCACA,wBAGJ,CACEtO,MAAO,UACPsO,WAAY,CACV,oBACA,gBACA,uCACA,gBACA,iBACA,kBACA,eACA,+BACA,0CAGJ,CACEtO,MAAO,UACPsO,WAAY,CACV,mCACA,kBACA,8BACA,oCACA,4CACA,uBACA,wCACA,kBAGJ,CACEtO,MAAO,6BACPsO,WAAY,CACV,gBACA,eACA,6CACA,0BACA,kCACA,gDACA,iCACA,kBAGJ,CACEtO,MAAO,cACPsO,WAAY,CACV,8BACA,+BACA,2BACA,mBACA,+BAGJ,CACEtO,MAAO,aACPsO,WAAY,CACV,gCACA,qCACA,gBACA,eACA,6BACA,KACA,uBACA,gBACA,mBACA,kCACA,kBACA,OACA,4DACA,cACA,kBACA,uBACA,OACA,aACA,iCACA,gCACA,eACA,uBACA,qCACA,0BACA,qDACA,gBACA,0BACA,wBACA,aACA,0BACA,qDACA,2BACA,uCACA,QACA,4CACA,gBACA,uBACA,mCACA,kCACA,gDACA,iBACA,kCAGJ,CACEtO,MAAO,QACPsO,WAAY,CACV,wBACA,kBACA,oBACA,yBACA,2BACA,yBACA,gBACA,8BACA,gCACA,yBACA,mBACA,eACA,cACA,yBACA,6BACA,oBACA,wDACA,6CACA,QACA,2DACA,uBACA,iEACA,sEAMKC,GAAyBN,GAAuBI,OAAOtM,KAClE,SAACjE,GAAD,MAAY,CACVF,KAAME,EAAMkC,MACZkC,QAASpE,EAAMwQ,eAINE,GAAkBD,GAAuBnF,QACpD,SAACqF,EAAe3Q,GAId,OAHAA,EAAMoE,QAAQiD,SAAQ,SAAChD,GACrBsM,EAActM,GAAUrE,EAAMF,QAEzB6Q,IAET,IAGWC,GAAUH,GAAuBI,SAAQ,SAAC7Q,GAAD,OAAWA,EAAMoE,WAE1D0M,GAAaF,GAAQtF,QAAO,SAACyF,EAAMC,EAAQvF,GAEtD,OADAsF,EAAKC,GAAUvF,EACRsF,IACN,IAOUE,GAA+B,CAC1CC,GAAI,2BACJC,GAAI,6BAGOC,GAA+BC,OAAOC,QACjDL,IACA3F,QAAO,SAACrH,EAAD,GAA0B,IAAD,mBAAlBsN,EAAkB,K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ChBC,aAAc,EACdC,WAAY,CAAC,WAInBC,WAAY,CACV,CACE9I,IAAK,oBACL5H,KAAM,qBACN2Q,cAAe,eACf9S,QAAS,CACP+S,iBAAkB,CAAC,UAIzBC,OAAQ,CACNC,EAAG,GACHC,EAAG,GACHzI,EAAG,EACHjH,EAAG,GAEL2P,eAAgB,CA/agB,WACF,YA+a9BC,eAAgB,CAhbgB,WACF,eAobvBC,GAA0C,CACrD,IACA,GACA,GACA,GACA,GACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,EACA,GACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,IACA,IACA,GACA,GACA,GACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,IACA,IACA,GACA,IACA,GACA,IACA,GACA,IACA,GACA,EACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,IACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,EACA,IACA,GACA,GACA,GACA,GACA,EACA,IACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,EACA,GACA,IACA,GACA,GACA,IACA,GACA,GACA,GACA,IACA,GACA,GACA,IACA,EACA,IACA,IACA,GACA,EACA,GACA,GACA,IACA,GACA,IACA,GACA,EACA,IACA,GACA,IACA,GACA,EACA,IACA,GACA,IACA,GACA,EACA,GACA,GACA,GACA,GACA,IAGWC,GAA2CvH,GAAuBI,OAAOjF,QACpF,SAACqM,EAAK3X,EAAOgP,GACX,IAAM4I,EAAW,CACf1V,MAAOlC,EAAMkC,MACb1F,MAAOwD,EAAM6X,eACb/Y,WAAYkB,EAAM8X,oBAClB9I,SAKF,OAHAhP,EAAMwQ,WAAWnJ,SAAQ,SAAC2J,GACxB2G,EAAI3G,GAAU4G,KAETD,IAET,IAGWI,GAAwC,CACnDC,WAAW,EACXxE,UAAU,EACVC,mBAAoB,CAAC,uBACrBC,MAAO,CACL,CACEvF,IAAK,UACL6F,cAAe,oDACfC,OAAQ,CACNxV,IAAK,CACH,CACE0P,IAAK,SACL5H,KAAM,+BACN+N,OAAQ,2BACRD,WAAY,yBACZ5U,OAAQ,GACR2E,QAAS,CAEP5H,MAAO,UACP2X,OAAQ,QACRhV,SAAU,GACViV,mBAAmB,EACnBhC,mBAAmB,EACnBE,mBAAoB,YAGxB,CACEnE,IAAK,QACL5H,KAAM,8BACN+N,OAAQ,2BACRD,WAAY,yBACZ5U,OAAQ,GACR2E,QAAS,CACPjF,SAAU,EACV0V,gBAAiB,QACjBC,iBAAkB,QAClBC,qBAAsB,GACtBC,kBAAmB,UACnBC,kBAAmB,GACnB7C,mBAAmB,EACnBC,yBAAyB,EACzBC,mBAAoB,UAGxB,CACE/L,KAAM,WACN4H,IAAK,WACL1O,OAAQ,GACRyU,SAAU,CACR,CACE3N,KAAM,mBACN4H,IAAK,WAGLmG,OAAQ,2BACRD,WAAY,yBACZ5U,OAAQ,GACR2E,QAAS,CACPsN,uBAAwB,QACxBC,UAAW,QACXC,eAAgB,UAChBC,SAAU,EACVC,YAAa,IACbC,iBAAkB,IAElBC,YAAa,EACbmD,YAAa,CACX,WACA,YAEFrV,KAAM,eACNmS,cAAe,UACfC,WAAY,UACZE,mBAAmB,EACnBC,yBAAyB,EACzBC,mBAAoB,QACpBC,QAAS,CACPzS,KAAM,CACJ0S,MAAO,GAETlV,MAAO,CACLkV,MAAO,EACPC,YAAa,GAEfC,MAAO,CACL,CACExQ,MAAO,cACPsQ,MAAO,EACPC,YAAa,SAQ3B,CACEtE,IAAK,oBACL5H,KAAM,aAGN+N,OAAQ,2BACRD,WAAY,yBAEZ5U,OAAQ,KACR2E,QAAS,CACPtE,KAAM,oBACNmS,cAAe,cACfgG,qBAAqB,EACrBC,mBAAmB,EACnBC,UAAU,EACVxG,UAAW,UACXyG,eAAgB,IAChBC,aAAc,cACdC,WAAY,CAAC,UAAW,WACxBjC,UAAW,GACXkC,YAAa,EACbC,kBAAkB,EAClBC,cAAehB,GACfiB,gBAAiB,CACfC,GAAI,UACJC,KAAM,CAAC,iBAAkB,KAE3BC,cAAenB,GACfoB,eAAe,EACfC,aAAc,GACd3G,mBAAmB,EACnBC,yBAAyB,EACzBC,mBAAoB,YAK5BkE,SAAU,CACR,CACErI,IAAK,eACL1M,SAAU,CAAC,QAAS,WAAY,qBAChC2C,QAAS,CACPqS,OAAQ,GACRC,SAAU,EACVC,KAAM,UACNC,YAAa,IACbhC,YAAa,EACbiC,QAAS,UACTC,eAAgB,IAChBC,aAAc,EACdC,WAAY,CAAC,OAAQ,YAI3BI,OAAQ,CACNC,EAAG,GACHC,EAAG,GACHzI,EAAG,EACHjH,EAAG,GAEL2P,eAAgB,CACd,WACA,YAEFC,eAAgB,CACd,WACA,eAMKwB,GAAyB,IAAIC,IAAI,CAAC,QAAS,aCn/BlDC,GAAqB,SAACC,GAC1B,OAAOA,EAAWzF,MAAM,GAAG8C,SAAS,IAClC2C,EAAWzF,MAAM,GAAG8C,SAAS,GAAGpS,QAAQqS,QACxC0C,EAAWzF,MAAM,GAAG8C,SAAS,GAAGpS,QAAQqS,OAAOjV,OAF1C,YAGC2X,EAAWzF,MAAM,GAAG8C,SAAS,GAAGpS,QAAQqS,OAAO,IACnD,MAGA2C,GAAwB,SAACD,GAC7B,IAAME,EAAQF,EAAWzF,MAAM,GAAGO,OAAOxV,IAAI,GACzC0W,EAAc,KAElB,GAAmB,aAAfkE,EAAM9S,KAAqB,CAC7B,IAAK8S,EAAMnF,SAAS,GAAI,OAAOiB,EAC/BA,EAAckE,EAAMnF,SAAS,GAAG9P,QAAQ+Q,iBAExCA,EAAckE,EAAMjV,QAAQ+Q,YAG9B,OAAOA,EAAW,YAAOA,GAAeA,GAG7BmE,GAAgC,SAACC,GAAD,OAAyB,SACpEJ,GAEA,IAAME,EAAQF,EAAWzF,MAAM,GAAGO,OAAOxV,IAAI,GA4B7C,MA1BmB,aAAf4a,EAAM9S,OACR8S,EAAMnF,SAAWqF,EAAoBjO,QAAO,SAAC2I,EAAQuF,GACnD,IAAMC,EAAeC,YAAUjI,IAkB/B,OAjBI+H,EAAYlF,QAAUkF,EAAYnF,YACpCoF,EAAanF,OAASkF,EAAYlF,OAClCmF,EAAapF,WAAamF,EAAYnF,WACtCoF,EAAatL,IAAb,mBAA+BqL,EAAYnF,YACvCmF,EAAYtX,MACduX,EAAarV,QAAQtE,KAAO0Z,EAAYtX,aAGjCuX,EAAarV,QAAQtE,KAE9BmU,EAAO0F,KAAKF,IACHD,EAAY5T,OACrB6T,EAAaG,KAAO,CAAErT,KAAM,WAAYxC,GAAIyV,EAAY5T,KAAK9F,MAC7D2Z,EAAatL,IAAb,mBAA+BqL,EAAY5T,KAAK9F,MAChD2Z,EAAarV,QAAQtE,KAAO0Z,EAAYtX,OAAS,WACjD+R,EAAO0F,KAAKF,IAEPxF,IACN,IAEHoF,EAAM5Z,OAAuC,IAA7B4Z,EAAMnF,SAAS1S,OAAS,IAGnC2X,IAGIU,GAA8B,SAACC,GAAD,IAASC,EAAT,uDAAqB,GAArB,OAA4B,SACrEZ,GAsBA,GAAKa,MAAMC,QAAQH,IAAsB,OAAXA,EAKvB,CACL,IAAM3E,EAAc,CAAC2E,EAAO,GAAK,GAAKA,EAAO,GAAK,IAElDC,EAAU1S,SAAQ,SAAC6S,IAlBE,SAACb,EAAOlE,GACV,aAAfkE,EAAM9S,KACR8S,EAAMnF,SAAS7M,SAAQ,SAAC8S,GACtBA,EAAW/V,QAAQ+Q,YAAcA,KAGnCkE,EAAMjV,QAAQ+Q,YAAcA,EAa5BiF,CAAejB,EAAWzF,MAAM,GAAGO,OAAOxV,IAAIyb,GAAW/E,MAG3DgE,EAAWzF,MAAM,GAAG8C,SAAS,GAAGpS,QAAQqS,OAAS,CAACtB,QAXlD4E,EAAU1S,SAAQ,SAAC6S,GArBE,IAACb,EACH,cADGA,EAsBLF,EAAWzF,MAAM,GAAGO,OAAOxV,IAAIyb,IArBtC3T,KACR8S,EAAMnF,SAAS7M,SAAQ,SAAC8S,UACfA,EAAW/V,QAAQ+Q,sBAGrBkE,EAAMjV,QAAQ+Q,eAkBvBgE,EAAWzF,MAAM,GAAG8C,SAAS,GAAGpS,QAAQqS,OAAS,GAWnD,OAAO0C,IAGIkB,GAAgC,SAACC,GAAD,OAAY,SAACnB,GACxD,IAAME,EAAQF,EAAWzF,MAAM,GAAGO,OAAOxV,IAAI,GAU7C,MARmB,aAAf4a,EAAM9S,KACR8S,EAAMnF,SAAS7M,SAAQ,SAAC8S,GACtBA,EAAW/V,QAAQ4N,YAAyB,WAAXsI,EAAsB,EAAI,KAG7DjB,EAAMjV,QAAQ4N,YAAyB,WAAXsI,EAAsB,EAAI,EAGjDnB,IAGIoB,GAA0B,SACrCC,EACAC,GAFqC,6DAGjB,GAHiB,IAGnCC,aAHmC,gBAIlC,SAACvB,GACJ,IAAMwB,GAAmB,IAAVD,GAAmBE,YAAWF,IAAUA,IAEjDG,EAAO,YAAO1B,EAAWzF,MAAM,GAAG6D,gBAClCuD,EAAkB5B,GAAmBC,GACrC4B,EAAqB3B,GAAsBD,GAqBjD,OAnBK6B,OAAOC,OAAOT,KACjBK,EAAQ,GAAKL,GAEVQ,OAAOC,OAAOR,KACjBI,EAAQ,GAAKJ,GAGXK,IAAoBH,IACtBE,EAAQ,GAAKC,EAAgB,GAAK,IAClCD,EAAQ,GAAKC,EAAgB,GAAK,KAGhCC,IAAuBJ,IACzBE,EAAQ,GAAK9T,KAAKmU,IAAIL,EAAQ,GAAIE,EAAmB,GAAK,KAC1DF,EAAQ,GAAK9T,KAAKC,IAAI6T,EAAQ,GAAIE,EAAmB,GAAK,MAG5D5B,EAAWzF,MAAM,GAAG6D,eAAiBsD,EAE9B1B,IC9GHgC,GAAa,SAACxZ,EAAKyZ,EAAc7S,GACrC,IAAM8S,EAAO/S,GAAoB3G,EAAK4G,GACtC,YAAgB5K,IAAT0d,EAAqBD,EAAeC,GAGvCC,GLoJyC,WAAoB,IAAnBC,EAAkB,uDAAP,GACnDC,EAAID,EAASjQ,QAAO,SAACmQ,EAAIjQ,GAE7B,OADAiQ,EAAGC,IAAIlQ,GACAiQ,IACN,IAAIxC,KACP,OAAO,SAACzN,GACN,YAAU7N,IAAN6N,GAAmBgQ,EAAEG,IAAInQ,GAAWA,EAC3B,SAANA,GK3JgBoQ,CAAgC,CAAC,UA4BtDC,GAAuB,SAACrQ,GAC5B,IAAKA,IAAMwO,MAAMC,QAAQzO,IAAMA,EAAEhK,OAAS,EAAG,MAAO,GADlB,IAG1B6S,EAAe7I,EAAE,GAAjB6I,WACFyH,EACJ1K,GAA6B5F,EAAE,GAAG8I,UAClC9C,GACI,KACAJ,GAA6B5F,EAAE,GAAG8I,QAClCyH,EF2MsC,IE1M1CvQ,EAAE,GAAGwQ,aACD,KACAxQ,EAAE,GAAGwQ,aACLC,EFyMuC,IExM3CzQ,EAAE,GAAG0Q,2BACD,KACA1Q,EAAE,GAAG0Q,2BAEX,OAAK7H,QAA6B1W,IAAfme,EAEZ,CAACzH,EAAYyH,EAAYC,EAASE,GAAU7b,OAAOoI,KAAU4E,KAAK,KAFrB,IAMzC+O,GAAoB1M,YAAK,CACpC9N,IAAK,oBACLya,QAAS,KAGEC,GAAuBC,YAAS,CAC3C3a,IAAK,kBACL4a,IAAK,gBAAGA,EAAH,EAAGA,IAAH,OAAa3L,GAAQ3M,KAAI,SAACnE,GAAD,OAAUyc,EAAIC,GAAe1c,IAAOoB,cAGvDub,GAAuBH,YAAS,CAC3C3a,IAAK,kBACL4a,IAAK,gBAAGA,EAAH,EAAGA,IAAH,OAAa3L,GAAQxQ,QAAO,SAACN,GAAD,OAAUyc,EAAIC,GAAe1c,IAAOoB,cAG1Dsb,GAAiBE,cAAQ,SAAC5c,GAAD,OACpC2P,YAAK,CACH9N,IAAI,UAAD,OAAY7B,GACfsc,QAAS,CACPlb,SAAS,EACT5B,SAAS,QAKFqd,GAAuBD,cAClC,SAAC1c,GAAD,OACEyP,YAAK,CACH9N,IAAI,eAAD,OAAiB3B,EAAMF,MAC1Bsc,QAAS,CACPlb,SAAS,EACT5B,SAAS,EACTgC,EAAGtB,EAAMoE,QAAQ5C,OACjBD,EAAGvB,EAAMoE,QAAQ5C,aAGvB,SAACxB,GAAD,OAAWA,EAAMF,QAGN8c,GAAiCN,YAAS,CACrD3a,IAAK,4BACL4a,IAAK,gBAAGA,EAAH,EAAGA,IAAH,OACH9L,GAAuBnF,QAAO,SAACuR,EAAO7c,GAEpC,OADA6c,EAAM7c,EAAMF,MAAQyc,EAAII,GAAqB3c,IAAQsB,EAC9Cub,IACN,OAGMC,GAAqBrN,YAAK,CACrC9N,IAAK,gBACLya,QAASjB,GACP,KACAzB,YF4IkC,CACpC,CACEpF,OAAQ,2BACRD,WAAY,yBACZ2H,aAAc,EACdE,2BAA4B,EAC5BvK,UAAW,QACXzP,MAAO,mBEzPkB,SAACsJ,GAC5B,GAAKA,EAAL,CADkC,MAS9BA,EAAE3B,MAAM,KATsB,mBAKhCwK,EALgC,YAMhCyH,OANgC,MAMnBtK,GANmB,SAOhCwK,OAPgC,MF8OU,EE9OV,SAalC,YAAmBre,IAAf0W,EAAiCA,EAE9B,CACL,CACEC,OANWrD,GAA6B6K,GAOxCzH,aACA2H,eACAE,gCApB8B,MFgPW,EEhPX,EAqB9BvK,UAAW,gBAsFJoL,GAA4BtN,YAAK,CAC5C9N,IAAK,uBACLya,SAAS,IAGEY,GAAmBvN,YAAK,CACnC9N,IAAK,cACLya,QAASjB,GAAW,KAAK,EAAMG,MAGpB2B,GAA2BxN,YAAK,CAC3C9N,IAAK,sBACLya,QAASjB,GAAW,MAAO,eAGhB+B,GAAwBzN,YAAK,CACxC9N,IAAK,mBACLya,QAASjB,GAAW,QAAQ,EAAMnP,MAGvBmR,GAA8B1N,YAAK,CAC9C9N,IAAK,0BACLya,QAASjB,GAAW,OAAO,EAAMnP,MAGtBoR,GAAiB3N,YAAK,CACjC9N,IAAK,YACLya,QAASjB,GAAW,IAAK,MAGdkC,GAAuB5N,YAAK,CACvC9N,IAAK,kBACLya,QAAS,OAGEkB,GAAmB7N,YAAK,CACnC9N,IAAI,cACJya,QAASjB,GAAW,IAAK,aAAa,SAAC3P,GAAD,OACpCA,GAAKS,GAAWT,GAAKiB,GAAsBjB,GAAKA,OAIvC+R,GAAyB9N,YAAK,CACzC9N,IAAI,oBACJya,QAASjB,GAAW,IAAK,MAAM,SAAC3P,GAC9B,IAAKA,IAAMS,GAAWT,GAAI,OAAO,KADG,MAGfiB,GAAsBjB,GAHP,mBAG7BmB,EAH6B,KAGtBC,EAHsB,KAKpC,IAAKD,IAAUC,EAAK,OAAO,KALS,MAORD,EAAM9C,MAAM,KAPJ,mBAO7B2T,EAP6B,KAOnBC,EAPmB,OAQZ7Q,EAAI/C,MAAM,KARE,mBAUpC,MAAO,CACL2T,WACAE,OAZkC,KAalCD,SAAUA,EACVE,OAdkC,KAelCC,SAAU/Q,GAAmB,CAACF,EAAOC,IACrCrG,KAAM,eAKCsX,GAAqBpO,YAAK,CACrC9N,IAAK,gBACLya,QAASjB,GAAW,KAAM,YAGf2C,GAAoCrO,YAAK,CACpD9N,IAAK,+BACLya,QAASjB,GAAW,QAAQ,EAAOnP,MAGxB+R,GAAoCtO,YAAK,CACpD9N,IAAK,+BACLya,QAASjB,GAAW,MAAO,WAGhB6C,GAA+BvO,YAAK,CAC/C9N,IAAK,2BACLya,QAASjB,GAAW,OAAO,EAAMnP,MAGtBiS,GAA6BxO,YAAK,CAC7C9N,IAAK,yBACLya,QAASjB,GAAW,OAAO,EAAMnP,MAGtBkS,GAA4BzO,YAAK,CAC5C9N,IAAK,uBACLya,QAASjB,GAAW,OAAO,EAAOnP,MAGvBmS,GAAiC1O,YAAK,CACjD9N,IAAK,4BACLya,QAASjB,GAAW,OAAQ,YAGjBiD,GAAwB3O,YAAK,CACxC9N,IAAK,mBACLya,QAAS,OAEEiC,GAA8B5O,YAAK,CAC9C9N,IAAK,yBACLya,QAAS,OAGEkC,GAAwB7O,YAAK,CACxC9N,IAAK,mBACLya,QAAS,OAIEmC,GAA2B7B,cACtC,SAACtf,GAAD,OACEqS,YAAK,CACH9N,IAAI,gBAAD,OAAkBvE,EAAUohB,aAC/BpC,QAASjB,GACP,KACA/d,EAAUqhB,SFVoB,YEUa/S,MAAM,EAAG,GAAG0B,KAAK,KAC5DhB,SAGN,SAAChP,GAAD,OAAeA,EAAUohB,eAGdE,GAAyBhC,cACpC,SAACtf,GAAD,OACEqS,YAAK,CACH9N,IAAI,cAAD,OAAgBvE,EAAUohB,aAC7BpC,QAASjB,GACP,KACA/d,EAAUqhB,SFtBkB,YEsBa/S,MAAM,EAAG,GAAG0B,KAAK,KAC1DhB,SAGN,SAAChP,GAAD,OAAeA,EAAUohB,eAIdG,GAA8BjC,cACzC,SAACtf,GAAD,OACEkf,YAAS,CACP3a,IAAI,mBAAD,OAAqBvE,EAAUohB,aAClCjC,IAAK,YAAc,IACXqC,GAAerC,EADL,EAAVA,KACmBgC,GAAyBnhB,IAClD,OAAOsM,GAAckV,EAAcxhB,SAGzC,SAACA,GAAD,OAAeA,EAAUohB,eAGdK,GAA4BnC,cACvC,SAACtf,GAAD,OACEkf,YAAS,CACP3a,IAAI,iBAAD,OAAmBvE,EAAUohB,aAChCjC,IAAK,YAAc,IACXuC,GAAavC,EADH,EAAVA,KACiBmC,GAAuBthB,IAC9C,OAAOsM,GAAcoV,EAAY1hB,SAGvC,SAACA,GAAD,OAAeA,EAAUohB,eAGdO,GAA6BrC,cACxC,SAACtf,GAAD,OACEkf,YAAS,CACP3a,IAAI,kBAAD,OAAoBvE,EAAUohB,aACjCjC,IAAK,YAAc,IACXyC,GAAkBzC,EADR,EAAVA,KACsBc,IAC5B,OAAO2B,EACHtV,GAAc,GAAD,OACRsV,EAAgBC,IADR,YACeD,EAAgBvB,SAC1CrgB,GAEF,WAGV,SAACA,GAAD,OAAeA,EAAUohB,eAGdU,GAA2BxC,cACtC,SAACtf,GAAD,OACEkf,YAAS,CACP3a,IAAI,gBAAD,OAAkBvE,EAAUohB,aAC/BjC,IAAK,YAAc,IACXyC,GAAkBzC,EADR,EAAVA,KACsBc,IAC5B,OAAO2B,EACHtV,GAAc,GAAD,OACRsV,EAAgBC,IADR,YACeD,EAAgBrB,OAC1CvgB,GAEF,WAGV,SAACA,GAAD,OAAeA,EAAUohB,eAGdW,GAA6BzC,cACxC,SAACtf,GAAD,OACEkf,YAAS,CACP3a,IAAI,kBAAD,OAAoBvE,EAAUohB,aACjCjC,IAAK,YAAc,IACX6C,GAAoB7C,EADV,EAAVA,KACwBgB,IAE9B,IAAK6B,EAAmB,OAAO,KAE/B,GAAIA,EAAkB5B,SACpB,MAAO,CACL9T,GAAc,GAAD,OACR0V,EAAkB5B,SADV,YACsB4B,EAAkB3B,SACnDrgB,GAEFsM,GAAc,GAAD,OACR0V,EAAkB1B,OADV,YACoB0B,EAAkBzB,OACjDvgB,IAIN,IAAM0Q,EAAWpE,GAAc,GAAD,OACzB0V,EAAkBH,IADO,YACAG,EAAkB3B,SAC9CrgB,GAGF,MAAO,CAAC0Q,EAAUA,EAAW,SAGnC,SAAC1Q,GAAD,OAAeA,EAAUohB,eAGda,GAAsB/C,YAAS,CAC1C3a,IAAK,kBACL4a,IAAK,YAAc,IACX6C,GAAoB7C,EADV,EAAVA,KACwBgB,IAE9B,OAAK6B,EAGHA,EAAkB5B,UAClB4B,EAAkB1B,QAClB0B,EAAkB5B,WAAa4B,EAAkB1B,OAI1C1C,OAAOsE,IAEZF,EAAkB5B,UAEjB4B,EAAkB3B,UACjB2B,EAAkBzB,OAASyB,EAAkB3B,SAAW,GAItD2B,EAAkB3B,QAlBK,QAsBtB8B,GAAsBjD,YAAS,CAC1C3a,IAAK,iBACL4a,IAAK,YAAc,IACX6C,GAAoB7C,EADV,EAAVA,KACwBgB,IAE9B,IAAK6B,EAAmB,OAAO,KAE/B,IAAMlT,EAAWkT,EAAkB5B,SAC/B,CAAC,GAAD,OACK4B,EAAkB5B,SADvB,YACmC4B,EAAkB3B,SADrD,UAEK2B,EAAkB1B,OAFvB,YAEiC0B,EAAkBzB,QAEnD,CAAC,GAAD,OACKyB,EAAkBH,IADvB,YAC8BG,EAAkB3B,SADhD,UAEK2B,EAAkBH,IAFvB,YAE8BG,EAAkBzB,QAGpD,OAAO9Q,GAAmBX,MAIjBsT,GAA+B9C,cAC1C,SAACtf,GAAD,OACEkf,YAAS,CACP3a,IAAK,mBACL4a,IAAK,YAAc,IAAXA,EAAU,EAAVA,IAON,ODtR2B,SACjCkD,EACAC,EACAC,EACAC,EACAC,GAEA,IJiCgCC,EIjC1BC,EAAoBF,EAAgBD,EACpCI,EAAqBJ,EAAkBG,EAAoB,EAEjE,GAAIN,EAAgB,CAClB,IAAMQ,GJ6BwBH,EI7BcL,GJ8BrC,IAAMK,EAAS,GAAKA,EAAS,IAAM,EI7B1C,OACEC,EAAoB,KACpBhZ,KAAKkB,IAAI+X,EAAqBC,GAAqB,IAE5C,CAACL,EAAiBC,GAEpB,CAACJ,EAAe,GAAK,KAAMA,EAAe,GAAK,MAGxD,GAAIC,GAAkBC,EAAc,CAClC,IAAMO,EAASR,GAAkBC,EAAeD,GAAkB,EAElE,OACEK,EAAoB,KACpBC,EAAqBN,GACrBM,EAAqBL,EAEd,CAACC,EAAiBC,GAGpB,CAACK,EAAS,KAAMA,EAAS,MAGlC,MAAO,CAACN,EAAiBC,GCmPZM,CANgB5D,EAAI4C,GAA2B/hB,IAC/Bmf,EAAIwC,GAA2B3hB,IACjCmf,EAAI2C,GAAyB9hB,IAC1Bmf,EAAIoC,GAA4BvhB,IAClCmf,EAAIsC,GAA0BzhB,WAW1D,SAACA,GAAD,OAAeA,EAAUohB,eAed4B,GAAe,kBAAM5Q,GAAqB,IAAK4N,KAI/CiD,GAAiB,SAACjjB,GAAD,OAC5BoS,GAAqB,IAAK8N,IAAkB,SAAC9R,GAAD,OAC1CwO,MAAMC,QAAQzO,GAAK6B,GAAsB7B,GAAKA,MAiBrC8U,GAAwB,kBACnC9Q,GAAqB,MAAO2N,KAIjBoD,GAA8B,SAACnjB,GAAD,OACzCoS,GACE,IACA+O,GAAyBnhB,GACzBmP,KASSiU,GAA4B,SAACpjB,GAAD,OACvCoS,GACE,IACAkP,GAAuBthB,GACvBmP,KASSkU,GAA8B,kBACzCjR,GAAqB,MAAOwO,KAcjB0C,GAA4B,kBACvClR,GAAqB,MAAOyO,KChgBxB/hB,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvCukB,KAAM,CACJnkB,MAAOJ,EAAMwkB,QAAQC,KAAK,KAC1B7hB,UAAW,OAEb8hB,MAAO,CACL3hB,SAAU,SACVsF,WAAY,IACZnB,OAAQ,gBAEVyd,aAAc,CACZrK,SAAU,UACVpT,OAAQ,YAEV0d,aAAc,CACZtK,SAAU,UACVtX,WAAY,SACZ5C,MAAO,QACPsC,WAAY,2DACZmiB,UAAW,uCACX,UAAW,CACTA,UAAW,uCACXniB,WAAY,4DAEd,UAAW,CACTmiB,UAAW,yCAGfC,UAAW,CACT5d,OAAQ,cAIN6d,GAAuBhlB,aAAW,SAACC,GAAD,MAAY,CAClD2F,KAAM,CACJvF,MAAOJ,EAAMwkB,QAAQC,KAAK,KAC1B,UAAW,CACTrkB,MAAO,UAGX4kB,KAAM,CACJC,KAAM,GAERC,UAAW,CACT/c,QAAS,SAEX+P,OAAQ,CACN+M,KAAM,EACNE,YAAa,OAEflN,WAAY,CACVgN,KAAM,EACNjiB,WAAY,OAEdoiB,UAAW,CACTH,KAAM,EACNjiB,WAAY,MACZmiB,YAAa,MACb,gBAAiB,CACfniB,WAAY,GAEd,eAAgB,CACdmiB,YAAa,QAKbE,GAA0BtlB,aAAW,SAACC,GAAD,MAAY,CACrDslB,MAAO,CACLllB,MAAO,SAETmlB,QAAS,CACPllB,gBAAiB,aAIfmlB,GAAyBzlB,aAAW,SAACC,GAAD,MAAY,CACpDulB,QAAS,CACPE,QAAS,YAIPC,GAAcrkB,IAAMmC,MAAK,YAA4C,IAArBmiB,EAAoB,EAApBA,OAAQ9f,EAAY,EAAZA,SAAY,EAC9ClE,mBAASgkB,GADqC,mBACjExhB,EADiE,KAC1DC,EAD0D,KAGlEwhB,EAAwB,SAACC,GAAD,OAAc,SAACjhB,GAE3C,IAAM1D,EAAQ0D,EAAMG,OAAO7D,MAC3BkD,GAAS,SAACS,GAAD,mBAAC,eACLA,GADI,mBAENghB,EAAW3kB,SAsChBY,qBAAU,WACJqC,IAAUwhB,GAAQ9f,EAAS1B,KAC9B,CAAC0B,EAAU1B,EAAOwhB,IAErB,IAAMG,EAAWC,QAAQ5hB,EAAM+T,QAAU/T,EAAM8T,YACzC+N,EAAUD,QAAQ5hB,EAAM8hB,UAExB1lB,EAAUwkB,KACVmB,EAAwBb,KACxBc,EAAuBX,KAE7B,OACE,kBAAC,IAAMzd,SAAP,KACE,kBAACT,EAAA,EAAD,CAAMG,WAAW,SAASF,WAAS,GACjC,kBAACD,EAAA,EAAD,CAAM9G,UAAWD,EAAQykB,KAAMnc,MAAI,GACjC,kBAACvB,EAAA,EAAD,CAAMG,WAAW,SAASF,WAAS,GACjC,kBAAC6e,GAAA,EAAD,CACE7lB,QAASylB,EAAUE,EAAwBC,EAC3CzB,MAAM,wCACN2B,UAAU,MACVf,OAAK,GAEL,kBAACgB,GAAA,EAAD,CACExgB,MAAM,aACNmB,QAAQ,WACRsf,KAAK,QACLrlB,MAAOiD,EAAM+T,QAAU,GACvBrS,SA7Dc,SAACjB,GAC3B,IAAMsT,EAAStT,EAAMG,OAAO7D,MAC5BkD,GAAS,SAACS,GAAD,mBAAC,eACLA,GADI,IAEPqT,SACA1O,UAAMjI,QAyDIf,UAAWD,EAAQ2X,UAGvB,kBAACkO,GAAA,EAAD,CACE7lB,QAASylB,EAAUE,EAAwBC,EAC3CzB,MAAM,4CACN2B,UAAU,MACVf,OAAK,GAEL,kBAACgB,GAAA,EAAD,CACExgB,MAAM,aACNmB,QAAQ,WACRsf,KAAK,QACLrlB,MAAOiD,EAAM8T,YAAc,GAC3BpS,SAnEkB,SAACjB,GAC/B,IAAMqT,EAAarT,EAAMG,OAAO7D,MAChCkD,GAAS,SAACS,GAAD,mBAAC,eACLA,GADI,IAEPoT,aACAzO,UAAMjI,QA+DIf,UAAWD,EAAQ0X,gBAK3B,kBAAC3Q,EAAA,EAAD,CAAMuB,MAAI,GACR,kBAAC9C,EAAA,EAAD,CAAYvF,UAAWD,EAAQ2kB,WAA/B,OAEF,kBAAC5d,EAAA,EAAD,CAAMuB,MAAI,GACR,kBAACud,GAAA,EAAD,CACE7lB,QAASulB,EAAWI,EAAwBC,EAC5CzB,MAAM,yDACN2B,UAAU,MACVf,OAAK,GAEL,kBAAC,GAAD,CACE9b,KAAMrF,EAAMqF,KACZ3D,SA5Ec,SAAC2D,GACzBpF,GAAS,SAACS,GAAD,mBAAC,eACLA,GADI,IAEP2E,OACA0O,YAAQ3W,EACR0W,gBAAY1W,QAwEJ4H,QApEa,WACvB/E,GAAS,SAACS,GAAD,mBAAC,eACLA,GADI,IAEP2E,UAAMjI,aAsEN,kBAAC+F,EAAA,EAAD,CAAMG,WAAW,SAASF,WAAS,GACjC,kBAAC+e,GAAA,EAAD,CACExgB,MAAM,OACNmB,QAAQ,WACRC,OAAO,SACPqf,KAAK,QACLrlB,MAAOiD,EAAM2B,OAAS,GACtBD,SAAU+f,EAAsB,SAChCplB,UAAWD,EAAQ6kB,YAErB,kBAACkB,GAAA,EAAD,CACExgB,MAAM,iBACNmB,QAAQ,WACRC,OAAO,SACPqf,KAAK,QACLpc,KAAK,SACL2U,IAAI,IACJ0H,KAAK,IACLtlB,MAAOiD,EAAMyb,cAAgB,EAC7B/Z,SAAU+f,EAAsB,gBAChCplB,UAAWD,EAAQ6kB,YAErB,kBAACkB,GAAA,EAAD,CACExgB,MAAM,oBACNmB,QAAQ,WACRC,OAAO,SACPqf,KAAK,QACLpc,KAAK,SACL2U,IAAI,IACJ0H,KAAK,IACLtlB,MAAOiD,EAAM2b,4BAA8B,EAC3Cja,SAAU+f,EAAsB,8BAChCplB,UAAWD,EAAQ6kB,iBAmMdqB,GA5LUplB,IAAMmC,MAAK,YAEhC,IADFkjB,EACC,EADDA,aAEM1lB,EAAYG,IAEZ6c,EAAiBiG,KAAiB,GAHvC,EDuMD7Q,GAAqB,KAAMsN,GAAoBjB,ICvM9C,mBAIMkH,EAJN,KAIqBC,EAJrB,OAMiD1iB,YAChDid,IAPD,mBAMM6B,EANN,KAMyB6D,EANzB,OAU+CllB,oBAAS,kBACvD2b,YAAUqJ,MAXX,mBAUMG,EAVN,KAUwBC,EAVxB,OAa6BplB,oBAAS,GAbtC,mBAaMqlB,EAbN,KAaeC,EAbf,KAcKC,EAAsBC,iBAAO,IAC7BC,EAAoBD,iBAAOR,GAEjC7kB,qBAAU,WACRslB,EAAkBC,QAAUV,IAC3B,CAACA,IAEJ,IAAMW,EAAyB3iB,uBAC7B,SAACmD,GAAD,OAAO,SAACyf,GACNR,GAAoB,SAACS,GACnB,IAAMC,EAAmB,YAAOD,GAEhC,OADAC,EAAoB3f,GAAKyf,EAClBE,KAETR,GAAW,MAEb,IAGIS,EAAc/iB,uBAAY,WAC9B,IAAMgjB,EAAmBrK,YAAUwJ,GAGnCI,EAAoBG,QAAQpc,SAAQ,SAACiN,GACnCA,EAAOhF,aAITgU,EAAoBG,QAAUM,EAAiBzY,QAC7C,SAAC0Y,EAASxK,GACR,GAAIA,EAAY5T,KAAM,CACpB,IAAMyI,EAAW,2BACZsE,IADY,IAEf7S,KAAM0Z,EAAY5T,OAEpBoe,EAAQrK,KACNvL,GACEoL,EAAY5T,KACZ4T,EAAY5T,KAAK9F,KACjB1C,EACAiR,EACA,CACEf,QAAQ,EACRC,iBAAkB,KAK1B,OAAOyW,IAET,IAEFhB,EAAiBe,IAEfA,EAAiBE,MACf,SAACN,EAAgBzf,GAAjB,OACEyf,EAAerP,SAAWkP,EAAkBC,QAAQvf,GAAGoQ,WAE3DyP,EAAiBE,MACf,SAACN,EAAgBzf,GAAjB,OACEyf,EAAetP,aAAemP,EAAkBC,QAAQvf,GAAGmQ,eAE/D0P,EAAiBE,MACf,SAACN,EAAgBzf,GAAjB,OACEyf,EAAe/d,OAAS4d,EAAkBC,QAAQvf,GAAG0B,WAGzDwU,GAAe,SAAC8J,GACd,OAAIC,YAASD,GACJ,CAAC,GAAD,OACF9E,EAAkB5B,SADhB,YAC4B4B,EAAkB3B,SAD9C,UAEF2B,EAAkB1B,OAFhB,YAE0B0B,EAAkBzB,QAG9CuG,KAETjB,GAAqB,SAACmB,GACpB,OAAIA,EAAsBnF,IACjB,CACLzB,SAAU4G,EAAsBnF,IAChCvB,OAAQ0G,EAAsBnF,IAC9BxB,QAAS2G,EAAsB3G,QAC/BE,MAAOyG,EAAsBzG,MAC7BC,SAAU/Q,GAAmB,CAAC,GAAD,OACxBuX,EAAsBnF,IADE,YACKmF,EAAsB3G,SAD3B,UAExB2G,EAAsBnF,IAFE,YAEKmF,EAAsBzG,SAExDpX,KAAM,UAGH6d,MAGXtB,MACC,CACD1lB,EACA8lB,EACAJ,EACA1D,EACA4D,EACA5I,EACA6I,IAGItmB,EAAUT,KAEhB,OACE,kBAAC,IAAMiI,SAAP,KACE,kBAAChC,EAAA,EAAD,CACE4B,GAAG,QACHsgB,MAAM,SACNhhB,QAAQ,KACR+C,UAAU,KACVhE,QAAM,EACNxF,UAAWD,EAAQmkB,OANrB,iBAUA,uBAAG/c,GAAG,eAAN,uCACuC,IACrC,8BACE,uBACEugB,KAAK,0DACLnjB,OAAO,SACPojB,IAAI,uBAHN,WAOM,IAVV,cAWa,sCAXb,8DAYiB,IACf,uBACED,KAAK,8CACLnjB,OAAO,SACPojB,IAAI,uBAHN,kBAMK,IAnBP,0FAuBA,yBAAK3nB,UAAWD,EAAQukB,WACrBgC,EAAiBjf,KAAI,SAACugB,EAAoBtgB,GAArB,OACpB,kBAAC,GAAD,CACEvC,IAAKuC,EACL6d,OAAQyC,EACRviB,SAAUyhB,EAAuBxf,SAIvC,kBAAC/B,EAAA,EAAD,CAAYkiB,MAAM,UAChB,kBAACle,EAAA,EAAD,CACEvJ,UAAWD,EAAQokB,aACnBra,QAASoc,EACTzf,QAAQ,YACRgD,kBAAgB,GAJlB,UAQA,kBAACF,EAAA,EAAD,CACEvJ,UAAWwmB,EAAUzmB,EAAQqkB,aAAerkB,EAAQokB,aACpDra,QAAS0c,EAAUU,EAAchB,EACjCzf,QAAQ,YACRgD,kBAAgB,GAEf+c,EAAU,OAAS,a,6JClaxBlnB,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvCkC,KAAM,CACJ,MAAO,CACLa,SAAU,YAGd2hB,MAAO,CACLe,QAAS,OACT4C,eAAgB,SAChBnhB,OAAQlH,EAAMsoB,QAAQ,EAAG,EAAG,IAE9B/D,KAAM,CACJnkB,MAAOJ,EAAMwkB,QAAQC,KAAK,KAC1B7hB,UAAW,OAEb+C,KAAM,CACJvF,MAAOJ,EAAMwkB,QAAQC,KAAK,KAC1B,UAAW,CACTrkB,MAAO,UAGXmoB,UAAW,CACTjO,SAAU,UACV6K,YAAa,UAEfqD,eAAgB,CACdlO,SAAU,UACVtX,WAAY,SACZ5C,MAAO,QACPsC,WAAY,2DACZmiB,UAAW,uCACX,UAAW,CACTA,UAAW,uCACXniB,WAAY,4DAEd,UAAW,CACTmiB,UAAW,yCAGf4D,WAAY,CACV1lB,SAAU,SACVwF,cAAe,YACfF,WAAY,IACZqgB,cAAe,YACf,OAAQ,CACN9lB,UAAW,KAGf+lB,cAAe,CACb5lB,SAAU,QACVsF,WAAY,IACZnB,OAAQlH,EAAMsoB,QAAQ,EAAG,EAAG,EAAG,IAEjCM,iBAAkB,CAChB7lB,SAAU,UACVsF,WAAY,IACZnB,OAAQlH,EAAMsoB,QAAQ,EAAG,EAAG,EAAG,IAEjCO,oBAAqB,CACnB3hB,OAAQlH,EAAMsoB,QAAQ,EAAG,EAAG,EAAG,IAEjCQ,OAAQ,CACN5hB,OAAQlH,EAAMsoB,QAAQ,EAAG,GACzB,QAAS,CACP1c,MAAO,OACPvI,OAAQ,aAiaC0lB,GA5ZC1nB,IAAMmC,MAAK,YAGvB,IAFFkjB,EAEC,EAFDA,aACAsC,EACC,EADDA,iBAEMC,EAAchlB,YAAe2c,IAE7BrgB,EAAUT,KAEhB,MAAoB,UAAhBmpB,EAEA,yBAAKzoB,UAAWD,EAAQ2B,MACtB,kBAAC6D,EAAA,EAAD,CACE4B,GAAG,cACHsgB,MAAM,SACNhhB,QAAQ,KACR+C,UAAU,KACVhE,QAAM,EACNxF,UAAWD,EAAQkoB,YANrB,gBAUA,kBAAC1iB,EAAA,EAAD,CACE4B,GAAG,sBACHsgB,MAAM,SACNhhB,QAAQ,KACR+C,UAAU,KACVhE,QAAM,EACNxF,UAAWD,EAAQooB,eANrB,6BAUA,6IAE6C,IAC3C,mDAHF,yOAQA,4BAAQnoB,UAAWD,EAAQuoB,QACzB,yBAAKI,IAAKC,KAAkBC,IAAI,uCAElC,sJAEoD,0CAAoB,IAFxE,2BAG0B,wCAH1B,UAGkD,wCAHlD,mBAIc,wCAJd,KAMA,4BAAQ5oB,UAAWD,EAAQuoB,QACzB,yBACEI,IAAKG,KACLD,IAAI,wCAGR,8bAQA,2XAOA,4BAAQ5oB,UAAWD,EAAQuoB,QACzB,yBACEI,IAAKI,KACLF,IAAI,uDAGR,uTAOA,4BAAQ5oB,UAAWD,EAAQuoB,QACzB,yBACEI,IAAKK,KACLH,IAAI,4DAGR,mZAMkC,sCANlC,+KAWA,4BAAQ5oB,UAAWD,EAAQuoB,QACzB,yBACEI,IAAKM,KACLJ,IAAI,qDAGR,8dASA,kBAACrjB,EAAA,EAAD,CACE4B,GAAG,uCACHsgB,MAAM,SACNhhB,QAAQ,KACR+C,UAAU,KACVhE,QAAM,EACNxF,UAAWD,EAAQqoB,kBANrB,oBAUA,2RAMA,kBAAC7iB,EAAA,EAAD,CACE4B,GAAG,yCACHsgB,MAAM,SACNhhB,QAAQ,KACR+C,UAAU,KACVhE,QAAM,EACNxF,UAAWD,EAAQqoB,kBANrB,6BAUA,iUAKmB,0BAAMlE,MAAM,IAAZ,OALnB,kFAOc,6CAPd,2GASI,IACF,uBACEwD,KAAK,8CACLnjB,OAAO,SACPojB,IAAI,uBAHN,kBAMK,IAhBP,yFAkBuB,IACrB,uBACED,KAAK,0DACLnjB,OAAO,SACPojB,IAAI,uBAEJ,wCALF,UAnBF,4BA2BE,uBACED,KAAK,kFACLnjB,OAAO,SACPojB,IAAI,uBAEJ,sCALF,SAMK,IAjCP,iHAqCA,2BACE,iDADF,wIAGgC,IAC9B,uBAAGD,KAAK,oBAAoBnjB,OAAO,SAASojB,IAAI,uBAAhD,aAJF,6DASA,kBAACpiB,EAAA,EAAD,CACE4B,GAAG,+BACHsgB,MAAM,SACNhhB,QAAQ,KACR+C,UAAU,KACVhE,QAAM,EACNxF,UAAWD,EAAQqoB,kBANrB,YAUA,wJAEgE,IAC9D,kBAACa,GAAA,EAAD,CAAYlD,KAAK,QAAQ/lB,UAAWD,EAAQoF,MAC1C,kBAAC,IAAD,CAAc5C,SAAS,aAJ3B,kBAMiB,qCANjB,wLASa,qDATb,mKAYE,wDAZF,wEAakC,wDAblC,MAeA,kBAACgD,EAAA,EAAD,CACE4B,GAAG,kBACHsgB,MAAM,SACNhhB,QAAQ,KACR+C,UAAU,KACVhE,QAAM,EACNxF,UAAWD,EAAQooB,eANrB,yBAUA,4rBAYA,4BAAQnoB,UAAWD,EAAQuoB,QACzB,yBAAKI,IAAKQ,KAAcN,IAAI,8BAE9B,0MAKA,4BAAQ5oB,UAAWD,EAAQuoB,QACzB,yBAAKI,IAAKS,KAAcP,IAAI,sCAE9B,kEACsC,mDADtC,kEAE8D,IAC5D,uCAHF,aAG4B,sCAH5B,uBAGgE,IAC9D,mDAJF,qEAK4B,uCAL5B,aAKsD,sCALtD,KAOA,qHAIA,kBAACrjB,EAAA,EAAD,CACE4B,GAAG,2BACHsgB,MAAM,SACNhhB,QAAQ,KACR+C,UAAU,KACVhE,QAAM,EACNxF,UAAWD,EAAQqoB,kBANrB,YAUA,8RAKE,0DALF,MAOA,4IAEiD,IAC/C,uBACEV,KAAK,+EACLnjB,OAAO,SACPojB,IAAI,uBAHN,kBAHF,IAUG,gEAVH,wcAmBA,yDAC6B,4CAD7B,4hBAWA,kBAACpiB,EAAA,EAAD,CACE4B,GAAG,+BACHsgB,MAAM,SACNhhB,QAAQ,KACR+C,UAAU,KACVhE,QAAM,EACNxF,UAAWD,EAAQooB,eANrB,6BAUA,oZAMwB,sDANxB,4LAWA,kBAAC5iB,EAAA,EAAD,CAAYkiB,MAAM,SAASznB,UAAWD,EAAQsoB,qBAC5C,kBAAC9e,EAAA,EAAD,CACEvJ,UAAWD,EAAQioB,eACnBle,QAASoc,EACTzf,QAAQ,YACRgD,kBAAgB,GAJlB,qBASF,kBAAClE,EAAA,EAAD,CAAYkiB,MAAM,SAASznB,UAAWD,EAAQgkB,MAC5C,uIASN,yBAAK/jB,UAAWD,EAAQ2B,MACtB,kBAAC6D,EAAA,EAAD,CACE4B,GAAG,QACHsgB,MAAM,SACNhhB,QAAQ,KACR+C,UAAU,KACVhE,QAAM,EACNxF,UAAWD,EAAQmkB,OAEnB,kBAAC,GAAD,CACE9b,OAAQ,CACNgD,MAAO,WAIb,uBAAGjE,GAAG,eAAN,sGAE+B,mDAF/B,mIAMA,8GAEe,IACb,uBACEugB,KAAK,oDACLnjB,OAAO,SACPojB,IAAI,uBAHN,uHAMqD,IACnD,+CAPF,WAHF,KAcA,8FACmE,IACjE,iDAFF,iDAE2E,IACzE,uBACED,KAAK,wDACLnjB,OAAO,SACPojB,IAAI,uBAHN,2BAHF,KAYA,kBAACpiB,EAAA,EAAD,CAAYkiB,MAAM,UAChB,kBAACle,EAAA,EAAD,CACEvJ,UAAWD,EAAQgoB,UACnBje,QAAS0e,EACT/hB,QAAQ,YACRgD,kBAAgB,GAJlB,qBAQA,kBAACF,EAAA,EAAD,CACEvJ,UAAWD,EAAQioB,eACnBle,QAASoc,EACTzf,QAAQ,YACRgD,kBAAgB,GAJlB,yB,oBCneF2f,GAAe/oB,0BAEff,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvCkC,KAAM,CACJujB,QAAS,OACThe,WAAY,SACZ4gB,eAAgB,SAChBlgB,QAAS,QAEX0hB,MAAO,CACLxpB,gBAAiBL,EAAMwkB,QAAQ9hB,WAAWmnB,MAC1CC,aAAc,UACdjF,UAAW7kB,EAAM+pB,QAAQ,GACzBC,SAAU,QACVC,UAAW,qBACXC,SAAU,OACV/hB,QAASnI,EAAMsoB,QAAQ,EAAG,GAC1B7N,QAAS,OAIE,SAAS0P,GAAT,GAAsC,IAAbppB,EAAY,EAAZA,SAAY,EAChBY,mBAAS,MADO,mBAC3CyoB,EAD2C,KAChCC,EADgC,OAEE1oB,mBAAS,MAFX,mBAE3C2oB,EAF2C,KAEvBC,EAFuB,OAGZ5oB,mBAAS,MAHG,mBAG3C6oB,EAH2C,KAG9BC,EAH8B,KAK5CC,EAAY/lB,uBAChB,WAIM,IAHJgmB,EAGG,uDAHY,KACfC,EAEG,uDAFqB,KACxBC,EACG,uDADc,GAEjBR,EAAaM,GACbJ,GAAsB,kBAAMK,KAC5BH,EAAeI,KAEjB,IAGInE,EAAe/hB,uBAAY,WAC/B0lB,EAAa,MACbE,EAAsB,QACrB,IAEGhqB,EAAUT,KAEVY,EAAOqlB,QAAQqE,GAErB,OACE,kBAACR,GAAa3oB,SAAd,CAAuBC,MAAOwpB,GAC3B3pB,EACD,kBAAC+pB,GAAA,EAAD,CACEC,kBAAgB,cAChBC,mBAAiB,oBACjBxqB,UAAWD,EAAQ2B,KACnBxB,KAAMA,EACNuqB,QAASX,GAAsB5D,EAC/BwE,sBAAoB,EACpBC,kBAAmB1qB,IACnB2qB,cAAe,CACbC,QAAS,MAGX,kBAACC,GAAA,EAAD,CAAMC,GAAI7qB,GACR,yBAAKF,UAAWD,EAAQspB,OACrBnpB,GACC,kBAAC0pB,EAAD,iBACMI,EADN,CAEE9D,aAAc4D,GAAsB5D,SCzBpD,IAAM5mB,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvCwrB,GAAI,CACFnoB,OAAQ,OACR6D,OAAQ,IACRiB,QAAS,IACTpF,SAAU,OACVqF,WAAY,OACZC,WAAY,QAEdlI,OAAQ,CACNyL,MN3DwB,IM4DxB6f,WAAY,GAEdC,WAAY,CACVroB,OAAQ,QAEVsoB,YAAa,CACX/f,MNlEwB,KMoE1BggB,SAAU,CACRzpB,SAAU,WACV0pB,SAAU,GAEZC,oBAAqB,CACnB3jB,QAAS,kBACTjB,OAAQ,EACR,OAAQ,CACNnE,SAAU,SACVsF,WAAY,SAGhB0jB,gBAAiB,CACf5pB,SAAU,WACVE,IAAK,EACLE,MAAO,EACPE,OAAQ,EACRD,KAAM,EACN0nB,SAAU,eAEZ8B,QAAShsB,EAAMisB,OAAOD,QACtBhH,KAAM,CACJ6G,SAAU,GAEZK,SAAU,CACR/pB,SAAU,WACVgG,QAAS,MACTpF,SAAU,SACVL,WAAY1C,EAAMwkB,QAAQC,KAAK,MAEjC0H,aAAc,CACZppB,SAAU,UAEZqpB,kBAAmB,CACjBxgB,MAAO,QAETygB,cAAe,CACblkB,QAAS,QACTE,WAAY,KAEdikB,aAAc,CACZlsB,MAAOJ,EAAMwkB,QAAQC,KAAK,KAC1B,UAAW,CACTrkB,MAAO,UAGXmsB,mBAAoB,CAClBnsB,MAAO,QACP,UAAW,CACTA,MAAO,UAGXosB,uBAAwB,CACtBtlB,OAAQlH,EAAMsoB,QAAQ,EAAG,EAAG,EAAG,QAI7BmE,GAA4B,SAACC,GACjC,IAAMC,EAAUC,YAAWF,EAAK,KAAM,GAChCG,EAASH,EAAII,YAAY,MACzBlhB,GAAS8gB,EAAIxe,UACjBwe,EAAIlf,QAAQ,WAAa,EACzBkf,EAAIlf,QAAQ,KAAMkf,EAAIlf,QAAQ,WAAa,IAEvCnK,GAAUqpB,EAAIxe,UAClBwe,EAAIlf,QAAQ,YAAc,EAC1Bkf,EAAIlf,QAAQ,KAAMkf,EAAIlf,QAAQ,YAAc,IAE9C,MAAO,CACLuf,KAAML,EAAIxe,UAAUye,EAAU,EAAGE,GACjCjhB,QACAvI,WAgVW2pB,GA3TI3rB,IAAMmC,MAAK,WAC5B,IAAMxC,EAAYG,IACZupB,ED9ER,WACE,IAAMtpB,EAAUC,IAAMC,WAAWsoB,IACjC,QAAgBroB,IAAZH,EACF,MAAM,IAAII,MAAM,mDAElB,OAAOJ,ECyEW6rB,GAFgC,EAIV9I,GACtCnjB,GALgD,mBAI3CwhB,EAJ2C,KAI7B0K,EAJ6B,OAOd9I,GAA0BpjB,GAPZ,mBAO3C0hB,EAP2C,KAO/ByK,EAP+B,OJ8ShB/Z,GAAqB,IAAKwN,II9SV,mBAQ3CqI,EAR2C,KAQ9BmE,EAR8B,OASMlpB,YACtDyc,IAVgD,mBAS3C0M,EAT2C,KASrBC,EATqB,KAa5CC,EAAyBtpB,YAAege,IACxCuL,EAAmBvpB,YAAeie,IAClCuL,EAAmBxpB,YAAe+d,IAfU,EAiBArgB,mBAAS,GAjBT,mBAiB3C+rB,EAjB2C,KAiBxBC,EAjBwB,KAmB5CC,EAAwBppB,mBAC5B,kBACEujB,YAASvF,IAAiBA,EAAahV,QAAQ,MAAQ,EACnDxM,EAAU6sB,SAAS,CACjBrL,EAAa/U,MAAM,KAAK,IACvB+U,EAAa/U,MAAM,KAAK,MAE1B+U,IACP,CAACA,EAAcxhB,IAGX8sB,EAAsBtpB,mBAC1B,kBACEujB,YAASrF,IAAeA,EAAWlV,QAAQ,MAAQ,EAC/CxM,EAAU6sB,SAAS,CACjBnL,EAAWjV,MAAM,KAAK,IACrBiV,EAAWjV,MAAM,KAAK,MAExBiV,IACP,CAACA,EAAY1hB,IAGT+sB,EAA4BppB,uBAChC,SAACC,GACCsoB,EAAgBtoB,EAAMG,OAAO7D,OAC7BysB,EAAqB,KAEvB,CAACT,IAGGc,EAA0BrpB,uBAC9B,SAACC,GACCuoB,EAAcvoB,EAAMG,OAAO7D,OAC3BysB,EAAqB,KAEvB,CAACR,IAGHrrB,qBAAU,WACR6rB,GAAqB,SAACM,GAAD,OAAUtjB,KAAKC,IAAI,EAAGqjB,EAAO,QACjD,CAACzL,EAAcE,IAElB,IAwBMwL,EAAevpB,uBAAY,WAC/ByoB,GAAe,KACd,CAACA,IAEEe,EAAcxpB,uBAAY,WAC9ByoB,GAAe,KACd,CAACA,IAEEgB,EAAmBzpB,uBAAY,WACnCyoB,EAAe,WACd,CAACA,IAEJtrB,qBAAU,WACJmnB,EACFyB,EAAU3B,GAASmF,EAAc,CAC/BlF,iBAAkBoF,IAEjB1D,MACJ,CAACzB,EAAayB,EAAWwD,EAAcE,IAE1C,IAAMC,EAAwB1pB,uBAAY,WACxC2oB,GAAwB,KACvB,CAACA,IAEEgB,EAAuB3pB,uBAAY,WACvC2oB,GAAwB,KACvB,CAACA,IAEJxrB,qBAAU,WACJurB,EACF3C,EAAUjE,GAAkB4H,GAClBpF,GACVyB,MAED,CAACzB,EAAaoE,EAAsB3C,EAAW2D,IAElD,IAAME,EAAY,SAACC,EAAaC,EAAcC,GAAqB,IAAD,EAK5DjC,GAA0B+B,GAHtBG,EAFwD,EAE9D5B,KACO6B,EAHuD,EAG9DhjB,MACQijB,EAJsD,EAI9DxrB,OAJ8D,EAU5DopB,GAA0BgC,GAHtBK,EAPwD,EAO9D/B,KACOgC,EARuD,EAQ9DnjB,MACQojB,EATsD,EAS9D3rB,OAT8D,EAc5DqrB,EAxJ8B,SAAChC,GACrC,IAAMuC,EAAyBvC,EAAIlf,QAAQ,KACrC0hB,EAAwBxC,EAAII,YAAY,UAFD,EAGrBJ,EACrBxe,UACCwe,EAAIlf,QAAQ,aAAe,EAC3Bkf,EAAIlf,QAAQ,IAAKkf,EAAIlf,QAAQ,aAAe,IAE7CC,MAAM,KACN6B,MAAM,GAToC,mBAGtC1D,EAHsC,KAG/BvI,EAH+B,KAU7C,MAAO,CACL0pB,KAAML,EAAIxe,UAAU+gB,EAAyB,EAAGC,GAChDtjB,OAAQA,EACRvI,QAASA,GA2Ia8rB,CAA8BT,GAAmB,GAdP,IAY9D3B,KAAMqC,OAZwD,MAYlC,KAZkC,MAa9D/rB,OAAQgsB,OAbsD,MAajC,EAbiC,EAgB1DC,EAAuBnY,GAA6BG,MAAM,GAAGO,OAAOxV,IAAI6M,QAC5E,SAAC7L,EAAQ4Z,GAAT,OAAmB5Z,EAAS4Z,EAAM5Z,SAClC,GAEIksB,EAAwB5T,GAAsCrE,MAAM,GAAGO,OAAOxV,IAAI6M,QACtF,SAAC7L,EAAQ4Z,GAAT,OAAmB5Z,EAAS4Z,EAAM5Z,SAClC,GAIEmsB,EN/SiB,okBM4UrB,OARAA,GADAA,GADAA,GAJAA,GADAA,GATAA,GAJAA,EAAYA,EAAUtf,QACpB,UACA0e,EAAgBG,EALF,KAOM7e,QACpB,WACAvF,KAAKC,IACHikB,EAAiBQ,EAVL,GAWZL,EACAM,EAAuBD,EAZX,GAaZE,KAGkBrf,QAAQ,aAAcye,IACtBze,QACpB,oBACA2e,EAnBc,KAqBM3e,QAAQ,kBAAmBkf,IAC3Blf,QAAQ,iBAAkB0e,EAtBhC,KAuBM1e,QAAQ,eAAgB4e,GAG5CU,EAD0B,OAAxBJ,EACUI,EAAUtf,QAAQ,kBAAmB,IAErCsf,EAAUtf,QAAQ,kBAAmBkf,IAyB/C7uB,EAAUT,KAEhB,OACE,kBAAC2vB,EAAA,EAAD,CACEjvB,UAAWD,EAAQJ,OACnB8G,QAAQ,YACR1G,QAAS,CACPspB,MAAOtpB,EAAQorB,aAEjB+D,OAAO,QAEP,kBAACpoB,EAAA,EAAD,CAAMC,WAAS,EAACC,UAAU,SAAShH,UAAWD,EAAQmrB,YACpD,kBAACpkB,EAAA,EAAD,CAAMuB,MAAI,GACR,kBAAC8mB,EAAA,EAAD,CACEnvB,UAAWD,EAAQyrB,QACnBtmB,MAAO,CAAEkG,MAAO,QAChBtB,QAAS6jB,GAET,wBAAI3tB,UAAWD,EAAQirB,IACrB,kBAAC,GAAD,QAGJ,kBAACoE,EAAA,EAAD,OAEF,kBAACtoB,EAAA,EAAD,CAAMC,WAAS,EAACsB,MAAI,EAACrI,UAAWD,EAAQykB,KAAMxd,UAAU,UACtD,kBAACF,EAAA,EAAD,CAAMuB,MAAI,GACR,kBAACgnB,EAAA,EAAD,CAAKC,EAAG,GACN,kBAACD,EAAA,EAAD,CAAKC,EAAG,GACN,kBAAC9oB,EAAA,EAAD,CAAaC,QAAQ,WAAWC,OAAO,QAAQC,WAAS,GACtD,kBAACC,EAAA,EAAD,CAAYC,QAAQ,kBAApB,gBACA,kBAACK,EAAA,EAAD,CACEC,GAAG,iBACH7B,MAAM,eACND,SAAUkoB,EACV7sB,MAAOshB,MAIb,kBAACqN,EAAA,EAAD,CAAKC,EAAG,GACN,kBAAC9oB,EAAA,EAAD,CAAaC,QAAQ,WAAWC,OAAO,QAAQC,WAAS,GACtD,kBAACC,EAAA,EAAD,CAAYC,QAAQ,gBAApB,cACA,kBAACK,EAAA,EAAD,CACEC,GAAG,eACH7B,MAAM,aACND,SAAUmoB,EACV9sB,MAAOwhB,MAIZgL,EAAoB,GACnB,kBAACmC,EAAA,EAAD,CAAKC,EAAG,GACN,kBAAC/lB,EAAA,EAAD,CACE9C,QAAQ,YACRC,OAAO,QACPoD,QA/LmB,SAAC1F,GACpC,GAAK2oB,EAAL,CAEA,IAAM9O,EAAO,YACR8O,EAAuBwC,gBAAgBzY,MAAM,GAAG6D,gBAGhDyD,OAAOC,OAAO+O,KACjBnP,EAAQ,GAAKmP,GAEVhP,OAAOC,OAAOiP,KACjBrP,EAAQ,GAAKqP,GAGfP,EAAuByC,OACrB,UACAvR,EAAQ,GACRA,EAAQ,GACRA,EAAQ,GACRA,EAAQ,GACR,OA4KctX,WAAS,EACT8C,kBAAgB,EAChBsc,KAAK,SANP,QAaN,kBAACqJ,EAAA,EAAD,MACA,kBAACC,EAAA,EAAD,CAAKC,EAAG,GACN,kBAAC/lB,EAAA,EAAD,CACE9C,QAAQ,YACRC,OAAO,QACPC,WAAS,EACT8C,kBAAgB,EAChBsc,KAAK,QACLrc,UAAW,kBAAC,IAAD,MACXI,QAASgkB,GAPX,kBAYF,kBAACsB,EAAA,EAAD,OAEF,kBAACtoB,EAAA,EAAD,CAAMuB,MAAI,EAACrI,UAAWD,EAAQqrB,UAC5B,kBAACiE,EAAA,EAAD,CAAKC,EAAG,EAAGtvB,UAAWD,EAAQwrB,iBAC5B,kBAAC8D,EAAA,EAAD,CAAKrvB,UAAWD,EAAQisB,wBACtB,kBAACyD,GAAD,CACExsB,YAAasc,GACb1Z,YAAY,iBACZF,eAAgBia,GAChBha,qBAAsBma,GACtBja,eAAgB+N,GAChB9N,cAAe+N,GACf9N,YAAakN,GACbjN,gBAAiBkN,QAKzB,kBAACrM,EAAA,EAAD,CAAMuB,MAAI,GACR,kBAAC+mB,EAAA,EAAD,MACA,kBAACC,EAAA,EAAD,CAAKC,EAAG,GACN,kBAAC/lB,EAAA,EAAD,CACE9C,QAAQ,YACRC,OAAO,QACPoD,QAzHa,WACzB,GAAKijB,GAA2BC,EAAhC,CAKA,ITjKyBd,ESiKnB8C,EAAYjB,EAChBhB,EAAuB2C,cACvB1C,EAAiB0C,cACjBzC,GTpKuBf,ESoKSe,GTnKpC,IAAIlhB,OAAO4jB,eAAgBC,kBAAkB1D,ISmKW,OT1TlC,SAAC2D,EAAUC,GACjC,IAAMC,EACoB,kBAAjBD,EACH,IAAIE,KAAK,CAACF,GAAe,CAAEnmB,KAAM,6BACjCmmB,EACN,GAAI/jB,OAAOkkB,UAAUC,iBACnBnkB,OAAOkkB,UAAUE,WAAWJ,EAAMF,OAC7B,CACL,IAAMO,EAAOrkB,OAAOskB,SAASC,cAAc,KAC3CF,EAAK1I,KAAO3b,OAAOwkB,IAAIC,gBAAgBT,GACvCK,EAAKK,SAAWZ,EAChBQ,SAASK,KAAKC,YAAYP,GAC1BA,EAAKQ,QACLP,SAASK,KAAKG,YAAYT,GAC1BG,IAAIO,gBAAgBV,EAAK1I,OS+SzB+I,CACE,oBACA,IAAIT,KAAK,CAAChB,GAAY,CAAErlB,KAAM,wBAZ9BonB,QAAQC,KAAK,kDAwHHrqB,WAAS,EACT8C,kBAAgB,EAChBsc,KAAK,SANP,yB,iHC1bRzmB,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvCyxB,UAAW,CACT/uB,WAAY,mBACZgvB,oBAAqB,EACrBC,qBAAsB,EACtB,YAAa,CACXC,kBAAmB,EACnB/M,UAAW,6BACX1hB,WAAY,uBAEd,kBAAmB,CACjByuB,kBAAmB,EACnB/M,UAAW,+BAGfgN,QAAS,CACPhN,UAAW,8BAEbiN,MAAO,CACLzuB,OAAQ,GACR8E,QAAS,aAEX4pB,cAAe,CACb,uBAAwB,CACtB3xB,MAAO,QACPiI,WAAY,OACZjF,UAAW,qCAEb,0BAA2B,CACzBiF,WAAY,eAKZ2pB,GAAgB,uCAAG,WAAOhlB,EAAKilB,GAAZ,mBAAApjB,EAAA,yDACJ,kBAAR7B,EADY,gCAEEklB,MAAM,GAAD,OAAIllB,EAAJ,eAAcilB,GAAS,KAF9B,cAEfE,EAFe,yBAGdA,EAASC,QAHK,uBAKAF,MAAM,GAAD,OAAIllB,EAAIA,IAAR,eAAkBilB,GAAS,KALhC,cAKjBE,EALiB,iBAMDA,EAASC,OANR,eAMjBrf,EANiB,yBAOhBA,EAAQlL,KAAI,SAACwqB,GAElB,OADAA,EAAOloB,KAAO6C,EAAI7C,KACXkoB,MATc,4CAAH,wDAatB,SAASC,GAAS3pB,GAChB,OACE,kBAAC4pB,GAAA,EAAD,eAASC,QAAQ,aAAgB7pB,GAC/B,0BAAM8pB,EAAE,uvCAKd,SAASC,GAAW/pB,GAClB,OACE,kBAACrB,EAAA,EAAD,CACE/B,IAAKoD,EAAMV,OAAOuZ,SAClBja,WAAS,EACTC,UAAU,MACVC,WAAW,UAEX,kBAAC6qB,GAAD,CAAUvvB,SAAS,UACnB,8BAAO4F,EAAMV,OAAOuZ,WAK1B,SAASmR,GAAchqB,GACrB,OACE,kBAACrB,EAAA,EAAD,CACE/B,IAAKoD,EAAMV,OAAOuZ,SAClBja,WAAS,EACTC,UAAU,MACVC,WAAW,UAEX,kBAAC,KAAD,CAAa1E,SAAS,UACtB,8BAAO4F,EAAMV,OAAOuZ,WAK1B,SAASoR,GAAajqB,GACpB,OACE,kBAACrB,EAAA,EAAD,CACE/B,IAAKoD,EAAMV,OAAOuZ,SAClBja,WAAS,EACTC,UAAU,MACVC,WAAW,UAEX,kBAAC,KAAD,CAAuB1E,SAAS,UAChC,8BAAO4F,EAAMV,OAAOuZ,WAK1B,SAASje,GAAOoF,GACd,MAA0B,SAAtBA,EAAMV,OAAOkC,KAAwB,kBAACuoB,GAAD,CAAYzqB,OAAQU,EAAMV,SACzC,YAAtBU,EAAMV,OAAOkC,KACR,kBAACwoB,GAAD,CAAe1qB,OAAQU,EAAMV,SACZ,WAAtBU,EAAMV,OAAOkC,KACR,kBAACyoB,GAAD,CAAc3qB,OAAQU,EAAMV,SAC9B,6BAAMU,EAAMV,OAAOuZ,UAG5B,SAASqR,GAAQltB,GACf,OAAQA,GACN,IAAK,OACH,OAAO,kBAAC2sB,GAAD,MAET,IAAK,UACH,OAAO,kBAAC,KAAD,MAET,IAAK,SACH,OAAO,kBAAC,KAAD,MAET,QACE,QAIS,SAASQ,GAAYnqB,GAAQ,IAAD,EACjBhH,oBAAS,GADQ,mBAClCjB,EADkC,KAC5BqyB,EAD4B,OAEXpxB,mBAAS,IAFE,mBAElCqG,EAFkC,KAEzBgrB,EAFyB,OAGHrxB,mBAASgH,EAAMsqB,YAHZ,mBAGlCC,EAHkC,KAGrBC,EAHqB,KAInCC,EAAuB3xB,EAAYyxB,EAAa,KAChDG,EAAU3yB,GAA2B,IAAnBsH,EAAQ5C,OAC1B7E,EAAUT,KACVwzB,EAAmB,eAAQ/yB,UAC1B+yB,EAAoBvB,cARc,IAUjCwB,EAA4B5qB,EAA5B4qB,aAAcC,EAAc7qB,EAAd6qB,UAEtB1xB,qBAAU,WACR,IAAI2xB,GAAS,EAEb,GAAK/yB,EAAL,CAEAsyB,EAAW,IAEX,IAAMU,EAAc9V,MAAMC,QAAQ2V,GAC9BA,EAAU3rB,KAAI,SAACmF,GAAD,OAASglB,GAAiBhlB,EAAKomB,MAC7C,CAACpB,GAAiBwB,EAAWJ,IAQjC,OANIG,GAAcG,EAAYnW,KAAKgW,EAAaH,IAEhDO,QAAQC,IAAIF,GAAa/gB,MAAK,SAACI,GACzB0gB,GAAQT,EAAWjgB,EAAQ8gB,OAAO7vB,OAAOoI,SAGxC,WACLqnB,GAAS,MAEV,CAACD,EAAWD,EAAc7yB,EAAM0yB,IAEnCtxB,qBAAU,WACHpB,GACHsyB,EAAW,MAEZ,CAACtyB,IAEJ,IAAMQ,EACJyH,EAAMmrB,WAAalW,MAAMC,QAAQlV,EAAMzH,OAAS,CAACyH,EAAMzH,OAASyH,EAAMzH,MAEpE6yB,EAAsB7yB,GAA4B,IAAnB8G,EAAQ5C,OAAelE,EAAQ8G,EAKlE,OAJA+rB,EAAsBnW,MAAMC,QAAQkW,GAChCA,EACA,CAACA,GAGH,kBAACC,GAAA,EAAD,CACEzzB,QAASoI,EAAMsrB,OAASX,EAAsB,GAC9CQ,SAAUnrB,EAAMmrB,SAChBjuB,SAAU,SAACjB,EAAO2O,GAChB5K,EAAM9C,SAAS0N,IAEjBrS,MAAOA,EACPgzB,cAAe,SAACtvB,EAAOuvB,GACjBvvB,GAAOuuB,EAAegB,IAE5BhtB,UAAWwB,EAAMxB,UACjBzB,MAAO,CAAEkG,MAAOjD,EAAMxB,UAAY,OAASwB,EAAMiD,OACjDlL,KAAMA,EACN0zB,OAAQ,WACNrB,GAAQ,IAEV9H,QAAS,WACP8H,GAAQ,IAEVsB,kBAAmB,SAACpsB,EAAQqsB,GAAT,OACjBrsB,EAAOuZ,WAAa8S,EAAO9S,UAE7B+S,eAAgB,SAACtsB,GAAD,OAAaA,EAASA,EAAOuZ,SAAW,IACxDxZ,QAAS+rB,EACTV,QAASA,EACTmB,YAAa,SAACC,GAAD,OACX,kBAACnO,GAAA,EAAD,iBACMmO,EADN,CAEEj0B,UAAWmI,EAAMsrB,OAAS1zB,EAAQwxB,cAAgB,GAClDpqB,GAAIgB,EAAMhB,GACV7B,MAAO6C,EAAM7C,MACbmB,QAAS0B,EAAM1B,QACfsf,KAAM5d,EAAM4d,KACZmO,WAAU,2BACLD,EAAOC,YADF,IAERC,aACE,kBAAC,IAAM5sB,SAAP,KACGsrB,EACC,kBAAC1yB,EAAA,EAAD,CAAkBP,MAAM,UAAUmmB,KAAM,KACtC,KACHkO,EAAOC,WAAWC,oBAM7BC,aAAc,SAAC3sB,GAAD,OAAY,kBAAC,GAAD,CAAQA,OAAQA,KAC1C4sB,WAAY,SAACzlB,EAAG0lB,GAAJ,OACV1lB,EAAEvH,KAAI,SAACI,EAAQ2K,GAAT,OACJ,kBAACmiB,GAAA,EAAD,eACEpvB,KAAMktB,GAAQ5qB,EAAOkC,MACrB5E,IAAK0C,EAAOuZ,SACZ1b,MAAOmC,EAAOuZ,UACVsT,EAAY,CAAEliB,kBC7Of,SAASoiB,GAAY9zB,GAClC,IAAM+H,EAAMke,mBAIZ,OAHArlB,qBAAU,WACRmH,EAAIoe,QAAUnmB,KAET+H,EAAIoe,QDgPbyL,GAAYhqB,aAAe,CACzB3B,WAAW,EACXQ,GAAI,GACJ7B,MAAO,GACPguB,UAAU,EACVjuB,SAAUuG,IACVma,KAAM,QACNrlB,MAAO,KACP+F,QAAS,WACT2E,MAAO,SErOT,IAAM9L,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvCi1B,OAAQ,CACNrpB,MAAM,eAAD,OT7BmB,IS6BnB,OACL5I,WT9BwB,IS+BxB5C,MAAOJ,EAAMwkB,QAAQ0Q,OAAOC,MAC5B90B,gBAAiBL,EAAMwkB,QAAQ0Q,OAAOE,MACtCvQ,UAAU,aAAD,OAAe7kB,EAAMwkB,QAAQC,KAAK,OAE7C4Q,aAAc,CACZC,YAAa,EACb9sB,aAAc,EACdf,WAAY,gBAIV8tB,GAAc,uCAAG,WAAOtD,GAAP,uBAAApjB,EAAA,yDAChBojB,EADgB,8CACF1wB,GADE,UAGfwO,EAAQF,GAAWoiB,GAHJ,8CAKF1wB,GALE,UAOfi0B,EAAWzlB,EAAM,GACjBc,GAAYd,EAAM,GAClB0lB,EAAS1lB,EAAM,IAAMA,EAAM,GAE7BgB,EACFhB,EAAM,KACQ,MAAbA,EAAM,IAA2B,MAAbA,EAAM,GAAac,IAAYd,EAAM,IAAMA,EAAM,IAExEgB,EAAS6N,OAAOC,MAAM9N,GAAUF,EAAW,EAAIE,IAE3CykB,GAAY3kB,GAAY4kB,GAAU1kB,GAjBjB,0CAkBZ,CACL,CACEqQ,SAAS,MAAD,OAAQoU,GAChBlU,OAAO,MAAD,OAAQmU,GACdpU,QAASxQ,EACT0Q,MAAOxQ,EACPyQ,SAAUyQ,EACV9nB,KAAM,YAzBS,sCA8Bd5I,GA9Bc,4CAAH,sDAqKLm0B,GApIGr0B,IAAMmC,MAAK,WAAsB,IAAD,EACdwgB,KADc,mBACzC2R,EADyC,KAC9BC,EAD8B,OAGV3R,KAHU,mBAGzClL,EAHyC,KAG5BiF,EAH4B,OAKF9Z,YAC5C+c,IAN8C,mBAKzC2B,EALyC,KAKxBiT,EALwB,OAQE3xB,YAChDid,IAT8C,mBAQzC6B,EARyC,KAQtB6D,EARsB,KAY1CiP,EAAsBd,GAAYpS,GAElCmT,EAAwBf,GAAYhS,GAGpCgT,EAAexxB,mBACnB,WACE,IAAMyxB,EAAgB,GAWtB,OATIrT,GAAmBA,IAAoBkT,GACzCG,EAAc1Y,KAAKqF,GACjBI,GAAqBA,IAAsB+S,GAC7CE,EAAc1Y,KAAKyF,GAEjBJ,GAAmBA,IAAoBkT,GACzCG,EAAc1Y,KAAKqF,GACjBI,GAAqBA,IAAsB+S,GAC7CE,EAAc1Y,KAAKyF,GACdiT,IAKT,CAACrT,EAAiBI,IAGdkT,EAAiB,WACrBN,EAAa,IACbC,EAAmB,OAGfM,EAAmB,WACvBnY,EAAe,IACf6I,EAAqB,OAoDjBtmB,EAAUT,KAEhB,OACE,kBAACs2B,GAAA,EAAD,CAAQj0B,SAAS,QAAQ3B,UAAWD,EAAQ00B,QAC1C,kBAACoB,GAAA,EAAD,CACE91B,QAAS,CACP2B,KAAM3B,EAAQ80B,eAGhB,kBAACruB,EAAA,EAAD,CAAaG,WAAS,GACpB,kBAAC2rB,GAAD,CACEhtB,MACE,kBAACwB,EAAA,EAAD,CAAMC,WAAS,EAACC,UAAU,MAAMC,WAAW,UACzC,kBAAC,KAAD,CAAY1E,SAAS,UACrB,0BAAM2C,MAAO,CAAE1C,WAAY,IAA3B,6BAGJuwB,aAAcgC,GACd/B,UAAW,CACT,CAAExmB,IAAK6G,GAAiB1J,KAAM,QAC9B,CAAE6C,IAAK8G,GAAoB3J,KAAM,YAEnCtE,SAvEuB,SAACywB,GAChC,GAAIA,EAAWlxB,OAAQ,CACrB,IAAMmxB,EAAmB,GAEzBD,EAAWhnB,MAAMgnB,EAAWlxB,OAAS,GAAG6F,SAAQ,SAACurB,GAC/C,OAAQA,EAAUrsB,MAChB,IAAK,OACHosB,EAAiBE,KAAOD,EACpBb,IAAca,EAAUhV,WAC1BoU,EAAaY,EAAUhV,UACvBqU,EAAmBW,IAErB,MAEF,IAAK,UACHD,EAAiBtvB,QAAUuvB,EACvBzd,IAAgByd,EAAUhV,WAC5BxD,EAAewY,EAAUhV,UACzBqF,EAAqB2P,IAEvB,MAEF,IAAK,SACHD,EAAiB7Y,OAAS8Y,EACtBzd,IAAgByd,EAAUhV,WAC5BxD,EAAe,CAAC,GAAD,OACVwY,EAAUpV,SADA,YACYoV,EAAUnV,SADtB,UAEVmV,EAAUlV,OAFA,YAEUkV,EAAUjV,SAEnCsF,EAAqB2P,IAEvB,MAEF,QAEEjF,QAAQC,KAAK,wBAAyBgF,OAKxCb,IAAcY,EAAiBE,MAAMP,KACrCnd,GAAgBwd,EAAiB7Y,QAAW6Y,EAAiBtvB,SAC/DkvB,SAEFD,IACAC,KA2BMj1B,MAAO80B,EACP/uB,QAAQ,SACRgtB,QAAM,EACN9sB,WAAS,EACT2sB,UAAQ,UC5Ldh0B,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvCkC,KAAM,CACJujB,QAAS,OACT4C,eAAgB,iBAElB/W,KAAM,CACJvO,SAAU,UAEZoyB,MAAO,CACL/0B,MAAO,SAETs2B,KAAM,CACJt2B,MAAOJ,EAAMwkB,QAAQC,KAAK,MAE5BkS,KAAM,CACJv2B,MAAO,eA8CIw2B,GA1Cav1B,IAAMmC,MAAK,WACrC,IAAMqzB,EAAW5yB,YAAe2d,IAC1B+T,EAAY1xB,YAAe+c,IAC3BjI,EAAc9U,YAAeid,IAE7B3gB,EAAUT,KAEhB,OAAK+2B,EAGH,kBAAC,IAAM9uB,SAAP,KACG4tB,GAAa5c,GACZ,kBAAChT,EAAA,EAAD,CAAYvF,UAAWD,EAAQ+Q,KAAMtL,QAAM,GACzC,0BAAMxF,UAAWD,EAAQo2B,MAAzB,UADF,wBAC+D,IAC7D,4BAAK5d,GAFP,8BAEmD,4BAAK4c,IAGzDA,IAAc5c,GACb,kBAAChT,EAAA,EAAD,CAAYvF,UAAWD,EAAQ+Q,KAAMtL,QAAM,GACzC,0BAAMxF,UAAWD,EAAQo2B,MAAzB,UADF,oCAEW,4BAAKhB,KAGhBA,GAAa5c,GACb,kBAAChT,EAAA,EAAD,CAAYvF,UAAWD,EAAQ+Q,KAAMtL,QAAM,GACzC,0BAAMxF,UAAWD,EAAQo2B,MAAzB,UADF,wBAC+D,IAC7D,4BAAK5d,IAGR4c,GAAa5c,EACZ,kBAAChT,EAAA,EAAD,CAAYvF,UAAWD,EAAQ+Q,KAAMtL,QAAM,GACzC,0BAAMxF,UAAWD,EAAQm2B,MAAzB,UADF,kCAIA,kBAAC3wB,EAAA,EAAD,CAAYvF,UAAWD,EAAQ+Q,KAAMtL,QAAM,GACzC,0BAAMxF,UAAWD,EAAQ40B,OAAzB,UADF,6BA3BgB,MChBTyB,GAlBav1B,IAAMmC,MAAK,WACrC,OACE,kBAAC,IAAMuE,SAAP,KACE,kBAAChC,EAAA,EAAD,wMAKA,kBAACA,EAAA,EAAD,KACG,IADH,0L,sECOAjG,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvC82B,gBAAiB,CACf5vB,OAAQlH,EAAMsoB,QAAQ,EAAG,EAAG,IAAM,QAiMvBsO,GA7Lav1B,IAAMmC,MAAK,WAAgC,IAAD,EV+gBpE4P,GAAqB,KAAMqO,IU/gByC,mBAC7DsV,EAD6D,KAC9CC,EAD8C,OVsfpE5jB,GAAqB,MAAOsO,IUtfwC,mBAE7DuV,EAF6D,KAE9CC,EAF8C,OV2fpE9jB,GAAqB,MAAOuO,IU3fwC,mBAG7DwV,EAH6D,KAG9CC,EAH8C,KAK9DC,EAA6B1yB,uBACjC,SAACC,GACCsyB,EAAiBtyB,EAAMG,OAAOD,WAEhC,CAACoyB,IAGGI,EAAsB3yB,uBAC1B,SAACzD,GAAD,OAAW,WACT81B,EAAiB91B,MAEnB,CAAC81B,IAGGO,EAAsB5yB,uBAC1B,SAACzD,GAAD,OAAW,WACTk2B,EAAiBl2B,MAEnB,CAACk2B,IAGG72B,EAAUT,KAEhB,OACE,kBAAC,IAAMiI,SAAP,KACE,kBAAC8nB,EAAA,EAAD,CAAKC,EAAG,GACN,kBAACxqB,EAAA,EAAD,CACEE,QACE,kBAACgyB,GAAA,EAAD,CACE1yB,QAASmyB,EACTpxB,SAAUwxB,EACV3zB,KAAK,kBAGToC,MAAM,qCAGV,kBAAC+pB,EAAA,EAAD,CAAKC,EAAG,GACN,kBAAC9oB,EAAA,EAAD,CAAagD,UAAU,YACrB,kBAACytB,GAAA,EAAD,CAAWztB,UAAU,SAASxJ,UAAWD,EAAQu2B,iBAAjD,mBAGA,kBAACY,GAAA,EAAD,CACEC,aAAW,gBACXj0B,KAAK,gBACLxC,MAAO61B,GAEP,kBAACzxB,EAAA,EAAD,CACEQ,MAAM,UACN5E,MAAM,SACNV,UAAWD,EAAQq3B,UACnBpyB,QACE,kBAACikB,GAAA,EAAD,CACElD,KAAK,QACLjc,QAASgtB,EAAoB,WAEV,WAAlBP,EACC,kBAAC,KAAD,CACEv2B,UAAWD,EAAQs3B,gBACnB90B,SAAS,YAGX,kBAAC,KAAD,CAA0BA,SAAS,eAK3C,kBAACuC,EAAA,EAAD,CACEQ,MAAM,wBACN5E,MAAM,uBACNV,UAAWD,EAAQq3B,UACnBpyB,QACE,kBAACikB,GAAA,EAAD,CACElD,KAAK,QACLjc,QAASgtB,EAAoB,yBAEV,yBAAlBP,EACC,kBAAC,KAAD,CACEv2B,UAAWD,EAAQs3B,gBACnB90B,SAAS,YAGX,kBAAC,KAAD,CAA0BA,SAAS,kBAQjD,kBAAC8sB,EAAA,EAAD,CAAKC,EAAG,GACN,kBAAC9oB,EAAA,EAAD,CAAagD,UAAU,YACrB,kBAACytB,GAAA,EAAD,CAAWztB,UAAU,SAASxJ,UAAWD,EAAQu2B,iBAAjD,wBAGA,kBAACY,GAAA,EAAD,CACEC,aAAW,gBACXj0B,KAAK,gBACLxC,MAAOi2B,GAEP,kBAAC7xB,EAAA,EAAD,CACEQ,MAAM,QACN5E,MAAM,QACNV,UAAWD,EAAQq3B,UACnBpyB,QACE,kBAACikB,GAAA,EAAD,CAAYlD,KAAK,QAAQjc,QAASitB,EAAoB,UACjC,UAAlBJ,EACC,kBAAC,KAAD,CACE32B,UAAWD,EAAQs3B,gBACnB90B,SAAS,YAGX,kBAAC,KAAD,CAA0BA,SAAS,eAK3C,kBAACuC,EAAA,EAAD,CACEQ,MAAM,wBACN5E,MAAM,YACNV,UAAWD,EAAQq3B,UACnBpyB,QACE,kBAACikB,GAAA,EAAD,CACElD,KAAK,QACLjc,QAASitB,EAAoB,cAEV,cAAlBJ,EACC,kBAAC,KAAD,CACE32B,UAAWD,EAAQs3B,gBACnB90B,SAAS,YAGX,kBAAC,KAAD,CAA0BA,SAAS,eAK3C,kBAACuC,EAAA,EAAD,CACEQ,MAAM,2BACN5E,MAAM,oBACNV,UAAWD,EAAQq3B,UACnBpyB,QACE,kBAACikB,GAAA,EAAD,CACElD,KAAK,QACLjc,QAASitB,EAAoB,sBAEV,sBAAlBJ,EACC,kBAAC,KAAD,CACE32B,UAAWD,EAAQs3B,gBACnB90B,SAAS,YAGX,kBAAC,KAAD,CAA0BA,SAAS,eAK3C,kBAACuC,EAAA,EAAD,CACEQ,MAAM,2BACN5E,MAAM,oBACNV,UAAWD,EAAQq3B,UACnBpyB,QACE,kBAACikB,GAAA,EAAD,CACElD,KAAK,QACLjc,QAASitB,EAAoB,sBAEV,sBAAlBJ,EACC,kBAAC,KAAD,CACE32B,UAAWD,EAAQs3B,gBACnB90B,SAAS,YAGX,kBAAC,KAAD,CAA0BA,SAAS,sB,oDC/LjDjD,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvCglB,KAAM,CACJ6G,SAAU,GAEZiM,IAAK,CACH31B,SAAU,WACVgG,QAAS,MACTpF,SAAU,SACVL,WAAY1C,EAAMwkB,QAAQC,KAAK,MAEjCC,MAAO,CACL3hB,SAAU,SACVoF,QAAS,QACTE,WAAY,KAEd1C,KAAM,CACJvF,MAAOJ,EAAMwkB,QAAQC,KAAK,KAC1B,UAAW,CACTrkB,MAAO,UAGX23B,WAAY,CACV33B,MAAOJ,EAAMwkB,QAAQC,KAAK,KAC1B,UAAW,CACTrkB,MAAO,UAGX43B,SAAU,CACR,QAAS,CACPhO,SAAU,QACV7hB,QAAS,SACTpF,SAAU,SACV,MAAO,CACLk1B,WAAY,KAIlBC,KAAM,CACJ,OAAQ,CACN/vB,QAAS,SAEX,kBAAmB,CACjBgwB,aAAa,aAAD,OAAen4B,EAAMwkB,QAAQC,KAAK,YA0JrC2T,GArJE/2B,IAAMmC,MAAK,YAQxB,IAPFmE,EAOC,EAPDA,GACA+c,EAMC,EANDA,MACA2T,EAKC,EALDA,KACAC,EAIC,EAJDA,KACAC,EAGC,EAHDA,SACAC,EAEC,EAFDA,YAEC,IADDC,wBACC,MADkB,SAClB,IAC+BD,IAD/B,mBACM3B,EADN,KACgB6B,EADhB,OAEuC/2B,qBAFvC,mBAEMg3B,EAFN,KAEoBC,EAFpB,OAG+Cj3B,qBAH/C,mBAGMk3B,EAHN,KAGwBC,EAHxB,KAKKC,EAAoBp0B,uBAAY,WACpC+zB,GAAY,SAACM,GAAD,SAAqB,IAATA,GAA0B,SAATA,QACxC,CAACN,IAEEO,EAAkBt0B,uBAAY,SAACC,GACnCg0B,EAAgBh0B,EAAMs0B,iBACrB,IAEGC,EAAmBx0B,uBAAY,WACnCi0B,EAAgB,QACf,IAEGQ,EAAsBz0B,uBAAY,SAACC,GACvCk0B,EAAoBl0B,EAAMs0B,iBACzB,IAEGG,EAAuB10B,uBAAY,WACvCm0B,EAAoB,QACnB,IAEGQ,EAAS90B,mBAAQ,2BAASmD,EAAT,WAAoB,CAACA,IACtC4xB,EAAa/0B,mBAAQ,2BAASmD,EAAT,eAAwB,CAACA,IAE9C6xB,EAAuBh1B,mBAC3B,iBAA4B,WAArBi0B,EAAgC,SAAW,QAClD,CAACA,IAEGgB,EAA0Bj1B,mBAC9B,iBAA4B,WAArBi0B,EAAgC,MAAQ,WAC/C,CAACA,IAIGl4B,EAAUT,KAEV45B,EAAW3T,QAAQ4S,GACnBgB,EAAe5T,QAAQ8S,GAEvBe,EAAgB/C,EAAWt2B,EAAQw3B,WAAax3B,EAAQoF,KACxDk0B,EAAgBH,EAAWn5B,EAAQw3B,WAAax3B,EAAQoF,KACxDm0B,EAAoBH,EAAep5B,EAAQw3B,WAAax3B,EAAQoF,KAEtE,OACE,kBAAC2B,EAAA,EAAD,CAAMuB,MAAI,EAACrI,UAAWD,EAAQ2B,MAC5B,kBAACoF,EAAA,EAAD,CACEuB,MAAI,EACJrI,UAAWD,EAAQu3B,IACnBvwB,WAAS,EACTE,WAAW,SACXsyB,KAAK,UAEL,kBAACzyB,EAAA,EAAD,CACEuB,MAAI,EACJtB,WAAS,EACTE,WAAW,SACXsyB,KAAK,SACLv5B,UAAWD,EAAQykB,MAEnB,kBAACjf,EAAA,EAAD,CAAYiE,UAAU,KAAKxJ,UAAWD,EAAQmkB,MAAO1e,QAAM,GACxD0e,EADH,MAIF,kBAACpd,EAAA,EAAD,CAAMuB,MAAI,GACR,kBAACvB,EAAA,EAAD,CAAMC,WAAS,EAACE,WAAW,SAASsyB,KAAK,UACvC,kBAACtQ,GAAA,EAAD,CACEkO,aAAW,UACXn3B,UAAWo5B,EACXrT,KAAK,QACLjc,QAASyuB,GAET,kBAAC,KAAD,CAAUh2B,SAAS,aAErB,kBAAC0mB,GAAA,EAAD,CACEkO,aAAW,OACX3M,mBAAkBsO,EAClB94B,UAAWq5B,EACXtT,KAAK,QACLjc,QAAS2uB,GAET,kBAAC,KAAD,CAAUl2B,SAAS,aAErB,kBAACi3B,GAAA,EAAD,CACEryB,GAAI2xB,EACJ54B,KAAMg5B,EACNO,SAAUtB,EACV1N,QAASkO,EACTe,aAAc,CACZC,SAAUX,EACVY,WAAY,SAEdC,gBAAiB,CACfF,SAAUV,EACVW,WAAY,UAGd,yBAAK55B,UAAWD,EAAQy3B,UACtB,kBAACM,EAAD,QAGJ,kBAAC7O,GAAA,EAAD,CACEkO,aAAW,WACX3M,mBAAkBuO,EAClB/4B,UAAWs5B,EACXvT,KAAK,QACLjc,QAAS8uB,GAET,kBAAC,IAAD,CAAcr2B,SAAS,aAEzB,kBAACi3B,GAAA,EAAD,CACEryB,GAAI2xB,EACJ54B,KAAMi5B,EACNM,SAAUpB,EACV5N,QAASoO,EACTa,aAAc,CACZC,SAAUX,EACVY,WAAY,SAEdC,gBAAiB,CACfF,SAAUV,EACVW,WAAY,UAGd,yBAAK55B,UAAWD,EAAQy3B,UACtB,kBAACO,EAAD,WAMV,kBAACjxB,EAAA,EAAD,CAAMuB,MAAI,EAACrI,UAAWD,EAAQ23B,MAC3BrB,GAAY,kBAACwB,EAAD,WCzIfv4B,I,cAAYC,aAAW,SAACC,GAAD,MAAY,CACvCglB,KAAM,CACJ6G,SAAU,GAEZyO,gBAAiB,CACfn4B,SAAU,WACVE,IAAK,EACLE,MAAO,EACPE,OAAQ,EACRD,KAAM,GAER+3B,iBAAkB,CAChBp4B,SAAU,WACVq4B,UAAW,OACXtQ,SAAU,UAEZuQ,WAAY,CACVt4B,SAAU,WACVjC,OAAQ,GACRmC,IAAK,EACLG,KAAM,EACND,MAAO,EACP4F,QAAS,QACTpF,SAAU,SACVqF,WAAY,SACZ1F,WAAY1C,EAAMwkB,QAAQC,KAAK,KAC/BiW,UAAW,SACX7V,UAAW,iCACX8V,QAAS,EACTC,UAAW,2CACX,wBAAyB,OACzB,sBAAuB,OACvB,qBAAsB,OACtB,mBAAoB,OACpB,kBAAmB,OACnBC,WAAY,OACZ13B,WAAY,2CACZ,UAAW,CACTw3B,QAAS,IAGbG,iBAAkB,CAChB16B,MAAOJ,EAAMwkB,QAAQC,KAAK,MAE5BsW,sBAAuB,CACrB1yB,WAAY,OACZjI,MAAO,QACPsC,WAAY,OACZk4B,UAAW,4CAEbI,iBAAkB,CAChB56B,MAAO,QACPsC,WAAY,UACZk4B,UAAW,4CAEbK,sBAAuB,CACrB5yB,WAAY,OACZjI,MAAO,QACPsC,WAAY,UACZk4B,UAAW,iDA2cAM,GAnaQ75B,IAAMmC,MAAK,SAACmF,GACjC,IAAM3H,EAAYG,IADyB,EAGG+C,YAC5C+c,IAJyC,mBAGpC2B,EAHoC,KAGnBiT,EAHmB,KAOrCD,EAAe5R,KAAe,GAC9BhG,EAAiBiG,KAAiB,GAClCiJ,EAAkB/I,GAA4BnjB,GAAW,GACzDmsB,EAAgB/I,GAA0BpjB,GAAW,GACrD6lB,EAAuBsU,YAAkBha,IACzCia,EAAaD,YAAkBlZ,IAE/B0E,EAAgB1iB,YAAeyc,IAC/BuW,EAAgBhzB,YAAeyd,IAC/BqV,EAAgB9yB,YAAewd,IAC/B0V,EAAgBlzB,YAAe0d,IAC/B0B,EAAiBpf,YAAe8e,GAA2B/hB,IAC3DwiB,EAAkBvf,YACtBse,GAA4BvhB,IAExByiB,EAAgBxf,YAAewe,GAA0BzhB,IACzDsiB,EAAiBrf,YAAe0e,GAA2B3hB,IAC3DuiB,EAAetf,YAAe6e,GAAyB9hB,IACvDq6B,EAA4Bp3B,YAChCuc,IAEI8a,EAAkBr3B,YAAeoc,IA5BI,EA8BK1e,oBAAS,GA9Bd,mBA8BpC45B,EA9BoC,KA8BlBC,EA9BkB,OA+BH75B,oBAAS,GA/BN,mBA+BpC85B,EA/BoC,KA+BtBC,EA/BsB,KAgCrCC,EAAaxU,iBAAO,MACpByU,EAAwBzU,iBAAO,MAC/B0U,EAAmB1U,iBAAO,IAC1B2U,EAAsB3U,iBAAO,MAC7B4U,EAAgC5U,iBAAO,MACvC6U,EAAmB7U,kBAAO,GAC1B8U,EAAsB9U,iBAAO,GAC7B+U,EAAkB/U,iBAAO,GACzBgV,EAA0BhV,iBAAO,GAEjCiV,EAA4B,WAChC,QAAIL,EAA8B1U,UAChC0U,EAA8B1U,SAAU,GACjC,IAKLgV,EAAa73B,mBACjB,kBAAMoK,YAAIqG,OAAOrI,OAAOyuB,MACxB,CAACA,IAGHv5B,qBAAU,WACRm6B,EAAoB5U,SAAWkU,IAC9B,CAACA,IAEJz5B,qBAAU,WACRo6B,EAAgB7U,SAAWoU,IAC1B,CAACA,IAEJ35B,qBAAU,WACJ25B,EAAcU,EAAwB9U,UAAYkU,EACjDY,EAAwB9U,QAAU,IACtC,CAACoU,EAAcF,IAElB,IAAMxe,EAAavY,mBACjB,kBACE83B,YACEpf,GAA8ByJ,IbnFI8P,EaqFhC7T,EAAkBA,EAAgBpB,SAAW,KbrFPjR,EasFtC+S,EbtF6C9S,EauF7C+S,EbvFqD,SAACxG,GAC9D,IAAM7X,EAAI6X,EAAWzF,MAAM,GAAGO,OAAOxV,IAAI+C,OAUzC,OARIqxB,GACF1Z,EAAWzF,MAAM,GAAGO,OAAOxV,IAAI6C,EAAI,GAAG8C,QAAQ2tB,UAAYc,EAC1D1Z,EAAWzF,MAAM,GAAG8C,SAAS,GAAGpS,QAAQqS,OAAS,CAAC,CAAC9J,EAAOC,aAEnDuM,EAAWzF,MAAM,GAAGO,OAAOxV,IAAI6C,EAAI,GAAG8C,QAAQ2tB,iBAC9C5Y,EAAWzF,MAAM,GAAG8C,SAAS,GAAGpS,QAAQqS,QAG1C0C,Ia8EDU,GAA4B4F,EAAgB,CAAC,EAAG,IAjHrB,SAAC4T,GAAD,OAAmB,SAACla,GAMrD,OALAA,EAAWzF,MAAM,GAAGO,OAAOxV,IAAI,GAAG2F,QAAQu0B,WAAatF,EACnD,YACA,eACJla,EAAWzF,MAAM,GAAGO,OAAOxV,IAAI,GAAG2F,QAAQ2R,eAAezF,kBAAoB+iB,EAEtEla,GA4GDyf,CAA2BvF,IAzGIwF,EA0GDtF,EA1Gc,SAACpa,GAEnD,OADAA,EAAWzF,MAAM,GAAGO,OAAOxV,IAAI,GAAG2F,QAAQ00B,gBAAkBD,EACrD1f,IAyGDkB,GAA8B8Y,GAC9B5Y,GAAwBqF,EAAiBC,EAAe,CACtDnF,MAAO8d,IAxGc,SAACd,GAAD,OAAqB,SAACve,GAanD,OAZAA,EAAWzF,MAAM,GAAGO,OAAOxV,IAAI,GAAGyV,SAAS,GAAG9P,QAAQhE,OAAS,CAC7DqV,IAAKiiB,EACLllB,MAAO,IAET2G,EAAWzF,MAAM,GAAGO,OAAOxV,IAAI,GAAGyV,SAAS,GAAG9P,QAAQhE,OAAS,CAC7DqV,IAAKiiB,EACLllB,MAAO,IAET2G,EAAWzF,MAAM,GAAGO,OAAOxV,IAAI,GAAG2F,QAAQhE,OAAS,CACjDqV,IAAKiiB,EACLllB,MAAO,IAEF2G,GA6FD4f,CAAuBrB,GA1FM,SAACe,GAAD,OAAgB,SAACtf,GACpD,IAAM6f,EAAc7f,EAAWzF,MAAM,GAAGO,OAAOxV,IAAI,GAEnD,OADAu6B,EAAYv5B,OAASg5B,EAAaO,EAAY50B,QAAQgS,WAAa,GAC5D+C,GAwFD8f,CAA6BR,GAf/BC,CAgBEhf,YAAUnG,KAjHoB,IAACslB,EbeGhG,EAAMlmB,EAAOC,IaoGnD,CAGEmW,EACA/D,EACAU,EACAC,EACAF,EACA4T,EACAE,EACAJ,EACAuE,EACAe,IAIES,EAAmBt4B,mBACvB,kBACEuY,EAAWzF,MAAM,GAAGO,OAAOxV,IAAI6M,QAC7B,SAAC7L,EAAQ4Z,GAAT,OAAmB5Z,EAAS4Z,EAAM5Z,SAClC,KAEJ,CAAC0Z,IAGGggB,EAAsBv4B,mBAC1B,kBAAOi3B,EAAe,sBAAwB,kBAC9C,CAACA,IAIGuB,EAAsB,SAACp4B,GACR,oBAAfA,EAAMuF,MACRyrB,EAAahxB,EAAMq4B,QAAQv5B,MAC3Bq4B,EAA8B1U,SAAU,EACxCwO,EAAmB,CACjBhT,IAAKje,EAAMq4B,QAAQzrB,OAAO,GAC1B6P,QAASzc,EAAMq4B,QAAQzrB,OAAO,GAC9B+P,MAAO3c,EAAMq4B,QAAQzrB,OAAO,GAC5BgQ,SAAU5c,EAAMq4B,QAAQv5B,KACxByG,KAAM,UAEgB,QAAfvF,EAAMuF,MACf6T,EAAepZ,EAAMq4B,QAAQv5B,MAC7Bq4B,EAA8B1U,SAAU,EACxCR,EAAqB,CACnBhE,IAAKje,EAAMq4B,QAAQzrB,OAAO,GAC1B6P,QAASzc,EAAMq4B,QAAQzrB,OAAO,GAC9B+P,MAAO3c,EAAMq4B,QAAQzrB,OAAO,GAC5BgQ,SAAU5c,EAAMq4B,QAAQv5B,KACxBw5B,MAAOt4B,EAAMq4B,QAAQnrB,WACrB3H,KAAM,aAEgB,eAAfvF,EAAMuF,MAAyBvF,EAAMq4B,QAAQp0B,MACtDge,EAAqB,CACnBzF,SAAUxc,EAAMq4B,QAAQp0B,KAAK2I,OAAO,GACpC6P,SAAUzc,EAAMq4B,QAAQp0B,KAAK2I,OAAO,GACpC8P,OAAQ1c,EAAMq4B,QAAQp0B,KAAK2I,OAAO,GAClC+P,OAAQ3c,EAAMq4B,QAAQp0B,KAAK2I,OAAO,GAClCgQ,SAAU/Q,GAAmB,CAAC,GAAD,OACxB7L,EAAMq4B,QAAQp0B,KAAK2I,OAAO,GADF,YACQ5M,EAAMq4B,QAAQp0B,KAAK2I,OAAO,IADlC,UAExB5M,EAAMq4B,QAAQp0B,KAAK2I,OAAO,GAFF,YAEQ5M,EAAMq4B,QAAQp0B,KAAK2I,OAAO,MAE/DrH,KAAM,YAYNgzB,GAAiCC,aAPF,SAACx4B,GAAW,IAAD,EACLA,EAAM6Z,QAAQ5W,KAAI,SAACw1B,GAAD,OACzDr8B,EAAUqhB,SAASgb,GAAQ/tB,MAAM,EAAG,GAAG0B,KAAK,QAFA,mBACvCoN,EADuC,KACtBC,EADsB,KAI9C6O,EAAgB9O,GAChB+O,EAAc9O,KAId,KAGIif,GAA+B,SAAC14B,GACpC,GAAIA,EAAM24B,UAAU,GAApB,mBAA0D34B,EAAM24B,UAAhE,GAAyB3B,EAAsBvU,QAA/C,OAGImW,GAA8B74B,uBAAY,SAAC84B,GAC1CC,YAAWD,EAAE14B,OAAQ+2B,EAAoBzU,UAC5CqU,GAAgB,KAEjB,IAEH55B,qBACE,WAIE,OAHAyK,OAAOoxB,iBAAiB,UAAWH,IACnCjxB,OAAOoxB,iBAAiB,OAAQH,IAEzB,WACLjxB,OAAOqxB,oBAAoB,UAAWJ,IACtCjxB,OAAOqxB,oBAAoB,OAAQJ,OAKvC,IAGF,IAAMK,GAA0Bl5B,uBAAY,WAC1Cq3B,EAAiB3U,SAAU,IAC1B,IAEGyW,GAAqBn5B,uBACzB,SAACo5B,GACyB,OAApBA,IACF3C,EAAW2C,EAAgBC,KAC3BrC,EAAWtU,QAAU0W,EAAgBC,IACrCD,EAAgBC,IAAIC,yBACpBpC,EAAiBxU,QAAQ9J,KACvBwgB,EAAgBC,IAAIE,GAAG,QAASlB,IAElCnB,EAAiBxU,QAAQ9J,KACvBwgB,EAAgBC,IAAIE,GAClB,WACAf,GACA,YAGJtB,EAAiBxU,QAAQ9J,KACvBwgB,EAAgBC,IAAIE,GAClB,iBACAZ,GACA,YAGJS,EAAgBC,IACbG,eACAC,QAAQT,iBAAiB,YAAaE,OAK7C,IAsBF/7B,qBACE,WACE,SAASu8B,EAAez5B,GAEpBgY,GAAuB2C,IACrBsR,SAASyN,cAAcC,QAAQ95B,iBAKnCG,EAAM45B,iBAEF55B,EAAM65B,QAAQ9C,EAAWtU,QAAQqX,adslBf,WcnlBxB,SAASC,EAAa/5B,GACpB,IACEgY,GAAuB2C,IACrBsR,SAASyN,cAAcC,QAAQ95B,eAFnC,CASA,GAFAG,EAAM45B,iBAEF5C,EAAsBvU,QAAS,CACjC,IAAMvX,EAAW8rB,EAAsBvU,QAAQxf,IAC7C7G,EAAUqhB,UAFqB,cAILvS,EAAS,GAJJ,GAI1BsR,EAJ0B,KAIhBC,EAJgB,mBAKTvR,EAAS,GALA,GAK1BwR,EAL0B,KAKlBC,EALkB,KAMjCvD,EAAe,CAAC,GAAD,OAAIoD,EAAJ,YAAgBC,GAAhB,UAA8BC,EAA9B,YAAwCC,KACvDsF,EAAqB,CACnBzF,WACAC,UACAC,SACAC,QACAC,SAAU/Q,GAAmB,CAAC,GAAD,OACxB2Q,EADwB,YACZC,GADY,UAExBC,EAFwB,YAEdC,KAEfpX,KAAM,WAIVyxB,EAAsBvU,QAAU,KAChCsU,EAAWtU,QAAQqX,adkjBK,Yc5iB1B,OAHA7N,SAAS8M,iBAAiB,UAAWU,GACrCxN,SAAS8M,iBAAiB,QAASgB,GAE5B,WACL9N,SAAS+M,oBAAoB,UAAWS,GACxCxN,SAAS+M,oBAAoB,QAASe,MAK1C,CAAC39B,IAIHc,qBACE,kBAAM,WACA65B,EAAWtU,UACbwU,EAAiBxU,QAAQpc,SAAQ,YAAyB,IAAtBrG,EAAqB,EAArBA,MAAO7C,EAAc,EAAdA,QACzC45B,EAAWtU,QAAQuX,IAAIh6B,EAAO7C,MAEhC45B,EAAWtU,QACR8W,eACAC,QAAQR,oBAAoB,YAAaC,IAC5ClC,EAAWtU,QAAQnU,cAKvB,IAIF,IAAM3S,GAAUT,KAEhB,OACE,yBAAKU,UAAWD,GAAQ2B,MACtB,kBAAC,GAAD,CACEyF,GAAG,mBACH+c,MAAM,mBACN8T,YAAanU,GACbgU,KAAMzB,GACN0B,KAAMuG,GACNtG,SAAUuG,KAEZ,yBACEt+B,UAAS,4BAAuBD,GAAQg6B,kBACxCwE,aAxGoC,WACxCvD,GAAoB,IAwGhBwD,aArGoC,WACxCxD,GAAoB,IAqGhBvyB,IAAK6yB,EACLp2B,MAAO,CAAErC,OAAO,GAAD,OAAKy5B,EAAL,QAEdrB,IACEF,GACDW,EAAgB7U,QAAU,GAC1B8U,EAAwB9U,QAAU,GAChC,kBAACthB,EAAA,EAAD,CAGEiE,UAAU,MACVxJ,UAAS,qBAAgBD,GAAQk6B,WAAxB,YAAsCl6B,GAAQy6B,kBACvDh1B,QAAM,GALR,2CAUHy1B,GACCF,GACAW,EAAgB7U,QAAU,GAC1B8U,EAAwB9U,QAAU,GAChC,kBAACthB,EAAA,EAAD,CAGEiE,UAAU,OACVxJ,UAAS,qBAAgBD,GAAQk6B,WAAxB,YAAsCl6B,GAAQ06B,uBACvDj1B,QAAM,GALR,qCAUFy1B,GAAgBF,GAAoBU,EAAoB5U,QAAU,GAClE,kBAACthB,EAAA,EAAD,CAGEiE,UAAU,MACVxJ,UAAS,qBAAgBD,GAAQk6B,WAAxB,YAAsCl6B,GAAQw6B,uBACvD/0B,QAAM,GALR,kCAUAy1B,IAAiBF,GAAoBU,EAAoB5U,QAAU,GACnE,kBAACthB,EAAA,EAAD,CAGEiE,UAAU,OACVxJ,UAAS,qBAAgBD,GAAQk6B,WAAxB,YAAsCl6B,GAAQu6B,kBACvD90B,QAAM,GALR,6BAUF,yBACExF,UAAWu8B,EACXkC,YAAapB,GACbqB,QA5KoB,WAC1BxD,GAAgB,IA4KVyD,OAzKmB,WACpBnD,EAAiB3U,SACpBqU,GAAgB,IAwKZ0D,SAAS,MAEX,kBAAC,mBAAD,CACEn2B,IAAK60B,GACL/gB,WAAYA,EACZ/U,QAAS,CACPq3B,SAAU,UACVC,qBAAqB,UChjB3Bx/B,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvCkC,KAAM,CACJujB,QAAS,OACT4C,eAAgB,iBAElB/W,KAAM,CACJvO,SAAU,SACVw8B,cAAe,UAEjBC,YAAa,CACXC,UAAW,SACXr/B,MAAOJ,EAAMwkB,QAAQC,KAAK,MAE5Bib,MAAO,CACL38B,SAAU,QACVqF,WAAY,OAEdu3B,OAAQ,CACN58B,SAAU,MACVqF,WAAY,OAEdw3B,MAAO,CACL78B,SAAU,QACVqF,WAAY,WACZpF,WAAY,WACZmiB,YAAa,cA2EFyR,GAvEav1B,IAAMmC,MAAK,WACrC,IAAMqzB,EAAW5yB,YAAe4d,IAC1B9I,EAAc9U,YAAeid,IAC7B2e,EAAiB57B,YAAekf,IAChC2c,EAAe77B,YAAe8d,IAE9BxhB,EAAUT,KAEhB,OAAK+2B,EAGH,8BACI9d,GACA,kBAACzR,EAAA,EAAD,CACEC,WAAS,EACTw4B,QAAQ,SACRt4B,WAAW,SACXjH,UAAWD,EAAQi/B,aAEnB,kBAACz5B,EAAA,EAAD,CAAYvF,UAAWD,EAAQ+Q,MAA/B,oDAKHyH,GAAgC,WAAjB+mB,GACd,kBAAC,IAAM/3B,SAAP,KACE,kBAAChC,EAAA,EAAD,CAAYvF,UAAWD,EAAQ+Q,MAC7B,0BAAM9Q,UAAWD,EAAQm/B,OAAzB,UACA,0BAAMl/B,UAAWD,EAAQo/B,QAAzB,UACA,0BAAMn/B,UAAWD,EAAQq/B,OAAzB,UACA,mDAJF,6CAKc,4BAAKC,GALnB,kDAUH9mB,GAAgC,YAAjB+mB,GACd,kBAAC,IAAM/3B,SAAP,KACE,kBAAChC,EAAA,EAAD,CAAYvF,UAAWD,EAAQ+Q,MAC7B,0BAAM9Q,UAAWD,EAAQm/B,OAAzB,UACA,0BAAMl/B,UAAWD,EAAQo/B,QAAzB,UACA,0BAAMn/B,UAAWD,EAAQq/B,OAAzB,UACA,8CAJF,4CAIuE,IACrE,4BAAKC,GALP,uDAUH9mB,GAAgC,iBAAjB+mB,GACd,kBAAC,IAAM/3B,SAAP,KACE,kBAAChC,EAAA,EAAD,CAAYvF,UAAWD,EAAQ+Q,MAC7B,gDADF,sEAEwC,4BAAKuuB,GAF7C,iDAOH9mB,GAAgC,UAAjB+mB,GACd,kBAAC,IAAM/3B,SAAP,KACE,kBAAChC,EAAA,EAAD,CAAYvF,UAAWD,EAAQ+Q,MAC7B,wCACA,4CAFF,4CAEqE,IACnE,4BAAKuuB,GAHP,+DAnDc,MCvCThB,GARax9B,IAAMmC,MAAK,WACrC,OACE,kBAAC,IAAMuE,SAAP,KACE,kBAAChC,EAAA,EAAD,gB,SCuCSi6B,GA1CGC,cAAW,SAACjgC,GAAD,MAAY,CACvCkC,KAAM,CACJ0J,MAAO,GACPvI,OAAQ,GACR8E,QAAS,EACTjB,OAAQ,mBACRue,QAAS,OACTqE,aAAc,GACd3mB,WAAY,0DACZ,UAAW,CACT9C,gBAAiB,wBAGrB6/B,WAAY,CACV79B,IAAK,EACLG,KAAM,EACN2F,QAAS,EACT/H,MAAOJ,EAAMwkB,QAAQC,KAAK,KAC1B,YAAa,CACXrhB,UAAW,mBACXhD,MAAOJ,EAAMwkB,QAAQ0Q,OAAOE,MAC5B,aAAc,CACZuF,QAAS,EACTt6B,gBAAiBL,EAAMwkB,QAAQ2b,QAAQC,KACvCC,YAAargC,EAAMwkB,QAAQ2b,QAAQC,QAIzCE,MAAO,CACL10B,MAAO,GACPvI,OAAQ,GACRwhB,UAAW,QAEb5H,MAAO,CACLsjB,OAAO,aAAD,OAAevgC,EAAMwkB,QAAQC,KAAK,MACxCqF,aAAc,EACd6Q,QAAS,EACTt6B,gBAAiBL,EAAMwkB,QAAQ0Q,OAAOE,OAExCtwB,QAAS,MAvCOm7B,CAwCdzI,MC5BE13B,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvC43B,UAAW,CACTzvB,QAASnI,EAAMsoB,QAAQ,GAAK,GAC5BtlB,YAAahD,EAAMsoB,QAAQ,GAAK,EAChC,+BAAgC,CAC9BlgB,WAAY,MAGhByvB,gBAAiB,CACfz3B,MAAO,SAET02B,gBAAiB,CACf5vB,OAAQlH,EAAMsoB,QAAQ,EAAG,EAAG,IAAM,IAEpCkY,OAAQ,CACNt5B,OAAQ,OAwHGu5B,GApHep/B,IAAMmC,MAAK,WAAkC,IAAD,EhBggBxE4P,GAAqB,OAAQ2O,IgBhgB2C,mBACjE+d,EADiE,KACnDY,EADmD,OhB2fxEttB,GAAqB,MAAO0O,IgB3f4C,mBAEjE3Z,EAFiE,KAExDw4B,EAFwD,KAIlEC,EAAqB,SAAC1/B,GAAD,OAAW,WACpCw/B,EAAgBx/B,KAOZX,EAAUT,KAEhB,OACE,kBAAC,IAAMiI,SAAP,KACE,kBAAC8nB,EAAA,EAAD,CAAKC,EAAG,GACN,kBAACxqB,EAAA,EAAD,CACE9E,UAAWD,EAAQigC,OACnBh7B,QACE,kBAAC,GAAD,CAAWV,QAASqD,EAAStC,SAZjB,SAACjB,GACrB+7B,EAAW/7B,EAAMG,OAAOD,UAWsCpB,KAAK,SAE7DoC,MAAM,kBAGV,kBAAC+pB,EAAA,EAAD,CAAKC,EAAG,GACN,kBAAC9oB,EAAA,EAAD,CAAagD,UAAU,YACrB,kBAACytB,GAAA,EAAD,CAAWztB,UAAU,SAASxJ,UAAWD,EAAQu2B,iBAAjD,sBAGA,kBAACY,GAAA,EAAD,CACEC,aAAW,eACXj0B,KAAK,eACLxC,MAAO4+B,GAEP,kBAACx6B,EAAA,EAAD,CACEQ,MAAM,6BACN5E,MAAM,SACNV,UAAWD,EAAQq3B,UACnBpyB,QACE,kBAACikB,GAAA,EAAD,CAAYlD,KAAK,QAAQjc,QAASs2B,EAAmB,WACjC,WAAjBd,EACC,kBAAC,KAAD,CACEt/B,UAAWD,EAAQs3B,gBACnB90B,SAAS,YAGX,kBAAC,KAAD,CAA0BA,SAAS,eAK3C,kBAACuC,EAAA,EAAD,CACEQ,MAAM,uCACN5E,MAAM,UACNV,UAAWD,EAAQq3B,UACnBpyB,QACE,kBAACikB,GAAA,EAAD,CACElD,KAAK,QACLjc,QAASs2B,EAAmB,YAEV,YAAjBd,EACC,kBAAC,KAAD,CACEt/B,UAAWD,EAAQs3B,gBACnB90B,SAAS,YAGX,kBAAC,KAAD,CAA0BA,SAAS,eAK3C,kBAACuC,EAAA,EAAD,CACEQ,MAAM,mCACN5E,MAAM,eACNV,UAAWD,EAAQq3B,UACnBpyB,QACE,kBAACikB,GAAA,EAAD,CACElD,KAAK,QACLjc,QAASs2B,EAAmB,iBAEV,iBAAjBd,EACC,kBAAC,KAAD,CACEt/B,UAAWD,EAAQs3B,gBACnB90B,SAAS,YAGX,kBAAC,KAAD,CAA0BA,SAAS,eAK3C,kBAACuC,EAAA,EAAD,CACEQ,MAAM,eACN5E,MAAM,QACNV,UAAWD,EAAQq3B,UACnBpyB,QACE,kBAACikB,GAAA,EAAD,CAAYlD,KAAK,QAAQjc,QAASs2B,EAAmB,UACjC,UAAjBd,EACC,kBAAC,KAAD,CACEt/B,UAAWD,EAAQs3B,gBACnB90B,SAAS,YAGX,kBAAC,KAAD,CAA0BA,SAAS,sB,4BCtIjD89B,GAAiBhgC,0BAEjBf,GAAYC,YAAW,CAC3BmC,KAAM,CACJC,SAAU,QACVjC,OAAQ,GACR0L,MAAO,EACPvI,OAAQ,EACRX,WAAY,QACZ2F,WAAY,SACZy4B,cAAe,OACf,WAAY,CACVz4B,WAAY,WAKH,SAAS04B,GAAT,GAAwC,IAAbhgC,EAAY,EAAZA,SAAY,EAChBY,mBAAS,CAC3Cq3B,MAAM,EACNtU,MAAO,GACPjS,EAAG,EACHjH,EAAG,EACH8Z,OAAO,EACPe,UAAW,SACX9lB,QAAS,KARyC,mBAC7CygC,EAD6C,KACjCC,EADiC,KAW9CC,EAAcv8B,uBAClB,SACE8N,EACAjH,EACAkZ,GAEI,IAAD,yDADqD,GACrD,IADDY,aACC,aADce,iBACd,MAD0B,SAC1B,MADoC9lB,eACpC,MAD8C,GAC9C,EACCqe,OAAOC,OAAOpM,IAAMmM,OAAOC,OAAOrT,KAAOkZ,EAE3Cuc,EAAc,CACZjI,MAAM,EACNtU,MAAO,GACPjS,EAAG,EACHjH,EAAG,EACH8Z,OAAO,EACPe,UAAW,SACX9lB,QAAS,KAIX0gC,EAAc,CACZjI,MAAM,EACNvmB,IACAjH,IACAkZ,QACAY,QACAe,YACA9lB,cAIN,IAGIA,EAAUT,KAEhB,OACE,kBAAC+gC,GAAe5/B,SAAhB,CAAyBC,MAAOggC,GAC7BngC,EACD,kBAACqlB,GAAA,EAAD,CACE1lB,KAAMsgC,EAAWhI,KACjBtU,MAAOsc,EAAWtc,MAClBY,MAAO0b,EAAW1b,MAClBe,UAAW2a,EAAW3a,UACtB9lB,QAASygC,EAAWzgC,SAEpB,yBACEC,UAAWD,EAAQ2B,KACnBwD,MAAO,CACLrD,IAAK2+B,EAAWx1B,EAChBhJ,KAAMw+B,EAAWvuB,O,WCvCvB3S,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvCkC,KAAM,CACJ9B,MAAOJ,EAAMwkB,QAAQC,KAAK,KAC1B+V,UAAW,QAEb2G,KAAM,CACJh/B,SAAU,WACV0pB,SAAU,GAEZuV,QAAS,CACPx1B,MAAO,OACPvI,OAAQ,YAINg+B,GAAmBztB,GAAwB/L,KAAI,SAACzH,EAAO0H,GAAR,OACnD/H,aAAW,SAACC,GAAD,MAAY,CACrBslB,MAAO,CACLllB,SAEFmlB,QAAS,CACPnlB,MAAOuT,GAAuB7L,GAC9BzH,gBAAiBD,EACjBykB,UAAW,8DACX,WAAY,CACVzkB,MAAO,QACPsC,WAAYiR,GAAuB7L,GACnCK,QAAS,WACT2hB,aAAc,mB,GASlB3S,GAA6BG,MAAM,GAAGO,OAAOxV,IAAI,GAAGyV,SAAS,GAF/DI,G,GAAAA,OACYopB,G,GAAZrpB,WAGIspB,GAAU,uCAAG,WAAOC,GAAP,eAAA3yB,EAAA,sEACMqjB,MAAM,GAAD,OACvBha,GADuB,mBACNspB,EAAQ35B,KAAI,SAAC45B,GAAD,kBAAiBA,MAAUzwB,KAAK,OAFjD,cACXmhB,EADW,yBAIVA,EAASC,QAJC,2CAAH,sDAOVhe,GAAa,GACbstB,GAAU,GAEhB3tB,GAAuBI,OAAOlJ,SAAQ,SAACrH,EAAOkE,GAC5CsM,GAAWxQ,EAAMkC,OAAS,CACxBpC,KAAME,EAAMkC,MACZygB,KAAM3iB,EAAMwQ,WAAWhP,OACvBwN,MAAO9K,GAGTlE,EAAMwQ,WAAWnJ,SAAQ,SAACuQ,EAAUmmB,GAClCD,GAAQlmB,GAAY,CAClBA,SAAUpH,GAAWxQ,EAAMkC,OAC3B8M,MAAO+uB,SAKb,IASMC,GAAQ,SAACpkB,EAAMqkB,EAAQ3jB,GAC3B,IAAM4jB,EAAO,SAAGD,EAAU,GACpBE,EAAUvkB,EACb3V,KAAI,SAAC4qB,GAAD,MAAQ,CAAEjnB,EAAG0S,EAAOuU,EAAEvxB,OAAQsc,KAAMiV,MACxCuP,MAAK,SAACnzB,EAAGC,GAAJ,OAAUD,EAAErD,EAAIsD,EAAEtD,KAEtBy2B,EAAO,KACPC,EAAO,KAGX,SAASC,EAAW1vB,EAAGjH,GAErB,IADA,IAAIqD,EAAIozB,EACDpzB,GAAG,CACR,GAAIizB,EARQ,KAQY,SAACjzB,EAAE4D,EAAIA,EAAM,GAAb,SAAkB5D,EAAErD,EAAIA,EAAM,GACpD,OAAO,EAETqD,EAAIA,EAAEuzB,KAER,OAAO,EAlB6B,qBAsBtBL,GAtBsB,IAsBtC,2BAAyB,CAEvB,IAFwB,IAAfjzB,EAAc,QAEhBmzB,GAAQA,EAAKz2B,EAAIsD,EAAEtD,EAAIs2B,GAASG,EAAOA,EAAKG,KAGnD,GAAID,EAAYrzB,EAAE2D,EAAI,EAAI3D,EAAEtD,GAAI,CAC9B,IAAIqD,EAAIozB,EACRnzB,EAAE2D,EAAI4vB,IACN,EAAG,CACD,IAAM5vB,EAAI5D,EAAE4D,EAAI9H,KAAKG,KAAKg3B,EAAO,SAAIjzB,EAAErD,EAAIsD,EAAEtD,EAAM,IAC/CiH,EAAI3D,EAAE2D,IAAM0vB,EAAW1vB,EAAG3D,EAAEtD,KAAIsD,EAAE2D,EAAIA,GAC1C5D,EAAIA,EAAEuzB,WACCvzB,GAIXC,EAAEszB,KAAO,KAEI,OAATH,EAAeA,EAAOC,EAAOpzB,EAE5BozB,EAAOA,EAAKE,KAAOtzB,GA1CY,8BA6CtC,OAAOizB,GAw4BMO,GA3QWjhC,IAAMmC,MAAK,WACnC,IAAMxC,EAAYG,IACZ+/B,EDtsBR,WACE,IAAM9/B,EAAUC,IAAMC,WAAWu/B,IACjC,QAAgBt/B,IAAZH,EACF,MAAM,IAAII,MAAM,uDAElB,OAAOJ,ECisBamhC,GAEdC,EAAkBv+B,YAAegc,IACjCob,EAA4Bp3B,YAChCuc,IAEIiiB,EAAmBx+B,YAAe8d,IAClC2gB,EAAWz+B,YAAe8e,GAA2B/hB,IACrD+X,EAAc9U,YAAeid,IAC7ByhB,EAAc1+B,YAAegf,IAC7B2f,EAAc3+B,YAAekf,IAC7B0f,EAAc5+B,YAAe6d,IAb6B,EAepC5d,YAAe8d,IAfqB,mBAezD8gB,EAfyD,KAejDC,EAfiD,OAiBxCphC,mBAAS,MAjB+B,mBAiBzDqhC,EAjByD,KAiBnDC,EAjBmD,OAkBtBthC,mBAAS,MAlBa,mBAkBzDuhC,EAlByD,KAkB1CC,EAlB0C,OAmB1BxhC,mBAAS,MAnBiB,mBAmBzDsQ,EAnByD,KAmB5CmxB,EAnB4C,OAoBtCzhC,mBAAS,MApB6B,mBAoBzDiK,EApByD,KAoBlDy3B,EApBkD,KAqB1DC,EAAYtO,GAAYppB,GACxB23B,EAAuBvO,GAAYyN,GAEzC3gC,qBAAU,WAER,IAAI2xB,GAAS,EAEb,GAAiB,OAAbiP,GAAqC,OAAhBzwB,EAAzB,CAJc,kBAMaywB,EANb,GAMPc,EANO,KAMGC,EANH,KAORC,EAAe/4B,KAAKkB,IAAI43B,EAASD,GAEjCG,EAptBa,SAAC1xB,GAAD,OACrBA,EAAYa,UAAZ,SAAwB,EAAKb,EAAY6E,UAmtBnB8sB,CAAe3xB,GAG7B4xB,EAAel5B,KAAKC,IACxB,EACAD,KAAKE,KAAKF,KAAKm5B,KAAKJ,EAAeC,EAH3B,KAKJI,EAAY9xB,EAAY6E,SAAW+sB,EAEnCG,EAAWL,EAAW,SAAG,EAAKE,GAE9BI,EAAgBt5B,KAAKu5B,MAAMV,EAAWQ,GACtCG,EAAcx5B,KAAKu5B,MAAMT,EAASO,GAElCxC,EAAUjzB,YAAM01B,EAAeE,EAAc,GAAGj1B,QACpD,SAACk1B,EAAKC,GAEJ,OADAD,EAAI7mB,KAAJ,UAAY+jB,GAAZ,YAAoByC,EAApB,YAAiCM,IAC1BD,IAET,IAWF,OARAjB,GAAiB,GACjB5B,GAAWC,GAAS7uB,MAAK,SAAC2xB,GACpB7Q,IACF0P,GAAiB,GACjBF,EA3uBuB,SAACD,EAAMN,GAAP,OAC7BM,EAAKh/B,QACH,SAAC0f,GAAD,OAAcA,EAASnY,MAAQm3B,EAAS,IAAMhf,EAASpY,OAASo3B,EAAS,MAyuB7D6B,CAAuBtvB,OAAOrI,OAAO03B,GAAOzQ,OAAQ6O,QAIzD,WACLjP,GAAS,MAEV,CAACiP,EAAUzwB,IAEd,IAAMuyB,EAAY7/B,uBAChB,SAAC8/B,GACC1B,EAAU0B,KAEZ,CAAC1B,IAIG2B,EAASlgC,mBAAQ,mBAAQyN,IAAa,CAACA,IAEvCuL,EAAOhZ,mBACX,WACE,GAAKw+B,EAAL,CAEA,IAAI2B,EAAW,EACXC,EAAiBvC,IACjBwC,EAAiB,EACfC,EAAQ,GACRC,EAAsB,GAE5B9vB,OAAOC,QAAQd,IAAYnJ,SAAQ,YAAuB,IAAD,mBAApBvH,EAAoB,KAAd8X,EAAc,KACvDupB,EAAoBrhC,GAAQ,CAC1B8X,WACAwpB,aAAc,MAIlB,IAAMC,EAAiB,SAACp2B,EAAGC,GAAJ,OAAUD,EAAEq2B,YAAcp2B,EAAEo2B,aAC7CC,EAAsB,IAAIC,KAAU,GAAIH,GACxCI,EAAwB,IAAID,KAAU,GAAIH,GAEhDjC,EAAK/3B,SAAQ,SAACq6B,GACZ,IAAM1wB,EAAS0wB,EAAM9zB,OAAO,IAG5B,GAAKgxB,EAAgB9tB,GAAWE,IAAhC,CAEA,IAAM4M,EAAW8jB,EAAM9zB,OAAO,GAE9B,IAAKszB,EAAMtjB,GAAW,CACpB,IAAM+jB,GAAcD,EAAM9zB,OAAO,GAC3Bg0B,EAAWD,EAAa5C,EACxB8C,EAAeD,EAAW,EAC1BN,EAAcv6B,KAAKkB,IAAI25B,GAC7BV,EAAMtjB,GAAY,CAChB9d,KAAM8d,EACNrf,SAAUojC,EACVL,cACAO,eACAC,kBAAmB,IAGrBzwB,OAAOrI,OAAOwH,IAAYnJ,SAAQ,YAAqB,IAAlBvH,EAAiB,EAAjBA,KAAiB,EAAX6iB,KACzCue,EAAMtjB,GAAUkkB,kBAAkBhiC,GAAQ,GAC1CohC,EAAMtjB,GAAUkkB,kBAAkBhiC,GAAM6iB,KACtC8U,EAA0B33B,MAG9BkhC,EAAiBj6B,KAAKmU,IAAI8lB,EAAgBM,GAC1CL,EAAiBl6B,KAAKC,IAAIi6B,EAAgBK,GAEtCO,EAAcJ,EAAsB9nB,KAAKunB,EAAMtjB,IAC9C2jB,EAAoB5nB,KAAKunB,EAAMtjB,IAGtCsjB,EAAMtjB,GAAUkkB,kBAAkBhE,GAAQ9sB,GAAQ4G,SAAS9X,MAAM6Z,KAAK,CACpEkZ,KAAMjV,EACN5M,SACA+wB,eAAgBjE,GAAQ9sB,GAAQ4G,SAAS9X,KACzCxC,MAAOokC,EAAMxzB,aAEf6yB,EAAWh6B,KAAKC,IAAI+5B,EAAUW,EAAMxzB,YACpCizB,EAAoBrD,GAAQ9sB,GAAQ4G,SAAS9X,MAAMshC,mBAIrD,IADA,IAAMY,EAA2B,GAC1BP,EAAsBjgC,QAC3BwgC,EAAyBroB,KAAK8nB,EAAsBQ,OAGtD,IADA,IAAMC,EAAyB,GACxBX,EAAoB//B,QACzB0gC,EAAuBvoB,KAAK4nB,EAAoBU,OAclD,OAZAD,EAAyB36B,SAAQ,SAACwrB,EAAM3uB,GACtC,IAAMi+B,EAAWH,EAAyB99B,EAAI,GAC9C2uB,EAAKuP,YACHvP,EAAKt0B,UAAa4jC,GAAYA,EAAS5jC,UAAawgC,MAGxDmD,EAAuB76B,SAAQ,SAACwrB,EAAM3uB,GACpC,IAAMi+B,EAAWH,EAAyB99B,EAAI,GAC9C2uB,EAAKuP,aACDD,GAAYA,EAAS5jC,UAAawgC,GAAelM,EAAKt0B,YAGrD,CACLyiC,iBACAC,iBACAF,WACAG,QACAO,sBAAuBO,EACvBT,oBAAqBW,EACrBf,0BAMJ,CAAC/B,EAAM3H,EAA2BmH,IAIpC1gC,qBACE,WACE,sBAAC,8BAAA+M,EAAA,sEACwBqjB,MAAM,GAAD,OAAIha,GAAJ,4BAA8BopB,KAD3D,cACOnP,EADP,gBAEuBA,EAASC,OAFhC,QAEOrf,EAFP,QAIauuB,KAAO8B,EAAerwB,EAAQuuB,KAJ3C,0CAAD,KAQF,IAIF,IAAM/gC,EAAUT,KAEhBmmC,2BACE,WACE,GAAKnD,EAAL,CAEA,IAAMoD,EAAU,kBACd35B,OAAO45B,uBAAsB,WAC3B,IAAMC,EAAYtD,EAAOuD,wBAAwBz6B,MAC7Cw6B,IAAc9C,GAAWD,EAAS+C,OAQ1C,OALAF,IAEA35B,OAAOoxB,iBAAiB,SAAUuI,GAClC35B,OAAOoxB,iBAAiB,oBAAqBuI,GAEtC,WACL35B,OAAOqxB,oBAAoB,SAAUsI,GACrC35B,OAAOqxB,oBAAoB,oBAAqBsI,OAKpD,CAACpD,IAIH,IADA,IAAMwD,EAAiB,GACdx+B,EAAI,EAAGA,EAAIu5B,GAAiBj8B,OAAQ0C,IAC3Cw+B,EAAe/oB,KAAK8jB,GAAiBv5B,MAqBvC,OAlBAhG,qBACE,YA71BgC,SAClC2iC,EACA74B,EACA4R,GAUI,IAAD,yDADC,GACD,IARDilB,wBAQC,MARkB,eAQlB,EAPDc,EAOC,EAPDA,qBAOC,IANDV,mBAMC,aALD3B,mBAKC,MALa90B,IAKb,MAJDk6B,sBAIC,MAJgB,GAIhB,MAHDnkC,gBAGC,MAHU,GAGV,MAFD4W,mBAEC,MAFa,KAEb,EACH,GAAKnN,GAAU4R,EAAf,CAEA,IAAMkP,EAAM6Z,aAAO9B,GAEbxM,EAAa,GACbuO,EAAgB,GAChBC,EAAe,EACfC,EAAgB,GAChBzsB,EAAY,GACZ0sB,EAAmB,EACnBC,EAAkB,EAClBC,EAAmB,EACnBC,EAAmB,CAAC,EAAG,IACvBzjC,EACJ4R,OAAOrI,OAAOwH,IAAYhP,OAAS6U,EAAYge,EAAauO,EAE9D9Z,EAAIqa,KAAK,UAAT,cAA2Bn7B,EAA3B,YAAoCvI,IAAU0jC,KAAK,SAAU1jC,GAE7D,IAAM2jC,EAAiB/xB,OAAOrI,OAAO4Q,EAAKunB,qBAAqB71B,QAC7D,SAACtE,EAAKq8B,GAAN,OAAct8B,KAAKC,IAAIA,EAAKq8B,EAAIjC,gBAChC,GAEIkC,EAAoBC,eACvB/4B,OAAO,CAAC,EAAG44B,IACXz4B,MAAM,CAAC,EAAG0L,IACVmtB,OAAM,GAEHC,EAAeC,eAClBl5B,OAAO,CAAC,EAAG,IACXG,MAAM,CAAC,EAAG0L,IACVmtB,OAAM,GAEHG,EAAkBD,eACrBl5B,OAAO,CAAC,EAAG,IACXG,MAAM,CAAC,EAAG,KACV64B,OAAM,GAEHI,EAAmBL,eACtB/4B,OAAO,CAAC,EAAG,KACXG,MAAM,CACL0L,EAAYwsB,EAAeG,EAC3BH,EAAeG,IAGba,EAAe,SAACr4B,GAAD,OAAOo4B,EAAiBD,EAAgBn4B,KAIvDs4B,EAAqB97B,EAAQ,EAAIqO,EACjC0tB,EAAWh9B,KAAKu5B,MAAMwD,EAAqBztB,GAE3C2tB,EAAgBpqB,EAAK2nB,oBAAoB71B,MAAM,EAAGq4B,GAAUE,UAC5DC,EAAkBtqB,EAAK6nB,sBAAsB/1B,MAAM,EAAGq4B,GArDzD,EAuDsC,sBACpCC,GADoC,YAEpCE,IACH54B,QACA,SAAC64B,EAAQtR,GAAT,MAAkB,CAChB9rB,KAAKmU,IAAIipB,EAAO,GAAItR,EAAKuP,aACzBr7B,KAAKC,IAAIm9B,EAAO,GAAItR,EAAKuP,gBAE3B,CAAC3D,IAAU,IA/DV,mBAuDI2F,EAvDJ,KAuDoBC,EAvDpB,KAkEGC,EAAeZ,eAClBl5B,OAAO,CAAC45B,EAAgBC,IACxB15B,MAAMu4B,GAEHqB,EAAuBtF,EACzB+E,EAAc//B,KAAI,SAAC4qB,GAAD,OAAO9nB,KAAKy9B,MAAMF,EAAazV,EAAEuT,iBACnD,GACEqC,EAAqBl6B,KACxBC,OAAOw5B,EAAc//B,KAAI,SAAC4qB,GAAD,OAAOA,EAAE/uB,SAClC6K,MAAM,CAAC,EAAG3C,EAAQ,EAAIqO,EAAY,IAClCxL,aAAa05B,GAEVG,EAAyBzF,EAC3BiF,EAAgBjgC,KAAI,SAAC4qB,GAAD,OAAO9nB,KAAKy9B,MAAMF,EAAazV,EAAEuT,iBACrD,GACEuC,EAAuBp6B,KAC1BC,OAAO05B,EAAgBjgC,KAAI,SAAC4qB,GAAD,OAAOA,EAAE/uB,SACpC6K,MAAM,CAAC,EAAG3C,EAAQ,EAAIqO,EAAY,IAClCxL,aAAa65B,GACb55B,uBAAsB,GAEnBJ,EAAY3D,KAAKmU,IACrBupB,EAAmB/5B,YACnBi6B,EAAqBj6B,aAGvB+5B,EAAmBh6B,eAAeC,GAClCi6B,EAAqBl6B,eAAeC,GAEpC,IAAMk6B,EAAuB79B,KAAKC,IAChC,EACAy9B,EAAmB75B,YAAc65B,EAAmB15B,cAGhD85B,EAAoB99B,KAAKmU,IAC7B8oB,EAAc14B,QACZ,SAACw5B,EAASjS,GAAV,OAAmB9rB,KAAKmU,IAAI4pB,EAASjS,EAAKyO,eAC1C7C,KAEFyF,EAAgB54B,QACd,SAACw5B,EAASjS,GAAV,OAAmB9rB,KAAKmU,IAAI4pB,EAASjS,EAAKyO,eAC1C7C,MAIEsG,GAAoBh+B,KAAKC,IAC7Bg9B,EAAc14B,QACZ,SAAC05B,EAASnS,GAAV,OAAmB9rB,KAAKC,IAAIg+B,EAASnS,EAAKyO,eAC1C,GAEF4C,EAAgB54B,QACd,SAAC05B,EAASnS,GAAV,OAAmB9rB,KAAKC,IAAIg+B,EAASnS,EAAKyO,eAC1C,IAIE2D,GAAsBvB,eACzBl5B,OAAO,CAACq6B,EAAmBE,KAC3Bp6B,MAAM,CAAC,EAAGi4B,IAEPsC,GAAe,SAACC,GAAgD,IAAD,yDAAP,GAAO,IAAlCC,sBAAkC,SACnED,EACGhC,KACC,QACA,SAACtU,EAAG3qB,GAAJ,OAAU6L,GAAuB7L,EAAI6L,GAAuBvO,WAE7D6jC,UAAU,UACVzrB,MAAK,SAACiV,GAAD,OAAOmP,GAAMnP,EAAkB,EAAfgU,EAAmBC,EAAee,MACvDz2B,KAAK,UACL+1B,KAAK,MAAM,SAACtU,GAAD,OACVuW,EACIX,EAAmB/5B,aAAemkB,EAAEhgB,EAAI,EAAIm0B,GAC5CnU,EAAEhgB,EAAIg0B,EAAeG,KAE1BG,KAAK,MAAM,SAACtU,GAAD,OAAOA,EAAEjnB,KACpBu7B,KAAK,IAAKN,IAGTyC,GAAkB,SAACpE,GACvB,IAAMqE,EAAUl0B,OAAOrI,OAAOk4B,EAAM,GAAGY,mBAAmBx2B,QACxD,SAACtE,EAAKq8B,GAAN,OAAct8B,KAAKC,IAAIA,EAAKq8B,EAAI1gB,QAChC,GAEF,OAAO5b,KAAKE,KAAKF,KAAKG,KAAMq+B,EAAU76B,EAAa2L,KAG/CmvB,GAAY,SAChBL,EACAM,GAOI,IAAD,yDADC,GACD,IALDC,qBAKC,MALe,GAKf,MAJDvK,oBAIC,MAJc3yB,IAId,MAHD4yB,oBAGC,MAHc5yB,IAGd,MAFDm9B,0BAEC,MAFoB,KAEpB,EACGC,EAAWl7B,EAAY+6B,EAEvBI,EAAW,SAAC72B,GAAD,OAAYA,EAAQy2B,EAAWG,GAC1CE,EAAW,SAAC92B,GAAD,OAAWjI,KAAKu5B,MAAMtxB,EAAQy2B,GAAWG,GAE1DF,EAAcjiB,QAAU0hB,EACrBhC,KACC,QACA,SAACtU,EAAG3qB,GAAJ,OAAU6L,GAAuB7L,EAAI6L,GAAuBvO,WAE7D6jC,UAAU,QACVzrB,MACC,SAACiV,GAAD,OAAOA,KACP,SAACA,GAAD,gBAAUA,EAAEgE,KAAZ,YAAoBhE,EAAE7d,WAEvB5D,KAAK,QACL+1B,KAAK,KAAK,SAACtU,GAAD,OAAOgX,EAAS/H,GAAQjP,EAAE7d,QAAQhC,UAC5Cm0B,KAAK,KAAK,SAACtU,GAAD,OAAOiX,EAAShI,GAAQjP,EAAE7d,QAAQhC,UAC5Cm0B,KAAK,QAASyC,GACdzC,KAAK,SAAUyC,GACftL,GAAG,cAAc,SAACt5B,EAAO6tB,GACxB,IAAMkX,EAAO/kC,EAAMG,OAAOshC,wBACpB3hB,EACH6kB,GAAsBA,EAAmB9W,IAAOA,EAAEvxB,MAAM2M,QAAQ,GACnEqzB,EAAYyI,EAAKl3B,EAAIk3B,EAAK/9B,MAAQ,EAAG+9B,EAAKn+B,EAAGkZ,EAAO,CAClDY,OAAO,EACPe,UAAW,MACX9lB,QACE+lC,EACElyB,GAAWqe,EAAEkT,gBAAgB/yB,MAAQ0zB,EAAelhC,UAG1D25B,EAAatM,MAEdyL,GAAG,cAAc,SAACzL,GACjByO,IACAlC,EAAavM,OAIbmX,GAA0B,SAACnX,GAAD,OAC9B,kBAAC,IAAM1qB,SAAP,iCAC2B,gCAAS5F,GACjC4W,EAAW,YAAQA,EAAR,KAAyB,GAFvC,4BAEoE,IAClE,gCAAS0Z,EAAEgE,MAHb,cAGsC,gCAAShE,EAAE7d,QAHjD,oBAIW,4BAAQpU,UAAU,SAASiyB,EAAEvxB,MAAM2M,QAAQ,IAJtD,MAQIg8B,GAAqB,CACzBC,SAAU,CAAEziB,QAAS,MACrB0iB,WAAY,CAAE1iB,QAAS,OAGnB2iB,GAAqC,SAACC,GAC1C,IAAMtP,EAAU,SAAClI,GAAD,OAAQA,EAAE7d,SAAWq1B,EAAUr1B,OAAS,EAAI,IAC5Di1B,GAAmBC,SAASziB,QAAQ0f,KAAK,UAAWpM,GACpDkP,GAAmBE,WAAW1iB,QAAQ0f,KAAK,UAAWpM,IAGlDuP,GAAqC,WACzCL,GAAmBC,SAASziB,QAAQ0f,KAAK,UAAW,GACpD8C,GAAmBE,WAAW1iB,QAAQ0f,KAAK,UAAW,IAGlDoD,GAAU,SACdpB,EACAqB,EACAC,GAUI,IAAD,yDADC,GACD,IARDC,iBAQC,MARWrwB,EAQX,MAPDswB,iBAOC,MAPW32B,GAOX,MAND42B,iBAMC,MANW72B,GAMX,MALD82B,gBAKC,aAJDC,gBAIC,aAHDxJ,YAAayJ,OAGZ,aAFDpB,0BAEC,MAFoB,KAEpB,EACGqB,EAAK7B,EACRE,UAAU,OACVzrB,MAAK,SAACiV,GAAD,MAAO,CAACA,MACbzhB,KAAK,QACL+1B,KAAK,QAAS,MACdA,KAAK,QAAQ,SAACtU,GAAD,OAAO8X,EAAU9X,EAAElX,IAAMgvB,EAAUnlC,WAChD2hC,KAAK,KAAK,SAACtU,GAAD,OAAQ6X,EAAYF,EAAWC,EAAY5X,KAAO,KAC5DsU,KAAK,KAAK,SAACtU,GAAD,OAAQxY,EAAYmwB,EAAWC,EAAY5X,KAAO,KAC5DsU,KAAK,SAAS,SAACtU,GAAD,OAAO2X,EAAWC,EAAY5X,OAC5CsU,KAAK,UAAU,SAACtU,GAAD,OAAO2X,EAAWC,EAAY5X,OAC7CsU,KAAK,WAAW,SAACtU,GAAD,QAAS4X,EAAY5X,GAAK,MAEzCkY,EACFC,EAAG1M,GAAG,cAAc,SAACt5B,EAAO6tB,GAC1B,IAAMkX,EAAO/kC,EAAMG,OAAOshC,wBACpB3hB,EACH6kB,GAAsBA,EAAmB9W,IAAO4X,EAAY5X,GAC/DyO,EAAYyI,EAAKl3B,EAAIk3B,EAAK/9B,MAAQ,EAAG+9B,EAAKn+B,EAAGkZ,EAAO,CAClDY,OAAO,EACPe,UAAW,MACX9lB,QAAS+lC,EAAe7T,EAAElX,IAAM+qB,EAAelhC,aAEhD84B,GAAG,cAAc,WAClBgD,OAGF0J,EAAG1M,GAAG,aAAc,MAAMA,GAAG,aAAc,MAGzCuM,GACF1B,EACGE,UAAU,aACVzrB,MAAK,SAACiV,GAAD,MAAO,CAACA,MACbzhB,KAAK,QACL+1B,KAAK,QAAS,YACdA,KAAK,QAAQ,SAACtU,GAAD,OAAO+X,EAAU/X,EAAElX,IAAMivB,EAAUplC,WAChD2hC,KAAK,QAAS,uCACdA,KAAK,oBAAqB,UAC1BA,KAAK,cAAe,UACpBA,KAAK,IAAKuD,EAAY,GACtBvD,KAAK,IAAK9sB,EAAY,GACtB8sB,KAAK,WAAW,SAACtU,GAAD,QAAS4X,EAAY5X,GAAK,GAAKiY,MAC/Cp5B,MAAK,SAACmhB,GAAD,OAAO4X,EAAY5X,OAIzBoY,GAAwB,SAACpY,GAAD,OAC5B,kBAAC,IAAM1qB,SAAP,KACE,4BAAQvH,UAAU,SAASiyB,EAAErtB,QAD/B,WACwDqtB,EAAElM,KAAM,IAC9D,4BAAKtR,OAAOrI,OAAOwH,IAAYqe,EAAElX,KAAK7X,MAFxC,+CASIonC,GAAYpe,EACf6Z,OAAO,cACPQ,KAAK,YAFU,oBAEgBn7B,EAAQ,EAAIqO,EAAY,EAFxC,SAKZ8wB,GAAiBD,GACpB7B,UAAU,4BACVzrB,KACCvI,OAAOrI,OAAO4Q,EAAKunB,qBAAqBl9B,KAAI,SAAC4qB,EAAG3qB,GAG9C,OADA2qB,EAAElX,IAAMzT,EACD2qB,MAET,SAACA,GAAD,OAAOA,EAAEjX,SAAS9X,QAEnBsN,KAAK,KACL+1B,KAAK,QAAS,2BACdA,KAAK,aAAa,SAACtU,EAAG3qB,GAAJ,6BAA0BA,EAAImS,EAAYge,EAA1C,QAErBkS,GAAQY,GAAgB7D,GAAmB,SAACzU,GAAD,OAAOA,EAAEuS,gBAGpDtY,EACG6Z,OAAO,cACP0C,UAAU,wBACVzrB,KAAKvI,OAAOrI,OAAOwH,KAAa,SAACqe,GAAD,OAAOA,EAAE/uB,QACzCsN,KAAK,QACL+1B,KAAK,QAAS,uBACdA,KAAK,OAAQ,QACbA,KACC,UACA,SAACtU,EAAG3qB,GAAJ,OAAU8L,GAAwB9L,EAAI8L,GAAwBxO,WAE/D2hC,KAAK,eAAgB,KACrBA,KAAK,IAAK,GACVA,KAAK,KAAK,SAACtU,EAAG3qB,GAAJ,OAAUA,EAAImS,EAAYge,KACpC8O,KAAK,QAAS9sB,GACd8sB,KAAK,SAAU9sB,GAKlB,IAAM+wB,GAAiBte,EACpB6Z,OAAO,mBACP0C,UAAU,kBACVzrB,KAAKoqB,GAAe,SAACnV,GAAD,OAAOA,EAAE/uB,QAC7BsN,KAAK,KACL+1B,KAAK,QAAS,iBACdA,KACC,aACA,SAACtU,GAAD,0BACe+V,EAAuBH,EAAmB5V,EAAE/uB,MAD3D,WAKEunC,GAAa5C,EAAmB/5B,YAAc,EAC9C48B,GAAajT,EAAa0O,EAChCqE,GAIG/B,UAAU,wBACVzrB,MAAK,SAACiV,GAAD,MAAO,CAACA,MACbzhB,KAAK,QACL+1B,KAAK,QAAS,kCACdA,KAAK,QAAS,mBACdA,KAAK,YATR,oBASkCkE,GATlC,YASgDC,GAThD,kBAUGnE,KAAK,OAAQ,SACbA,KAAK,oBAAqB,UAC1Bz1B,MAAK,SAACmhB,GAAD,OAAOA,EAAE/uB,QAGjB,IAAMynC,GAAsBH,GACzB/B,UAAU,uBACVzrB,MACC,SAACiV,GAAD,OACExd,OAAOrI,OAAO6lB,EAAEiT,mBAAmB79B,KAAI,SAACgB,EAAMf,GAG5C,OADAe,EAAK0S,IAAMzT,EACJe,QAEX,SAAC4pB,GAAD,OAAOA,EAAE/uB,QAEVsN,KAAK,KACL+1B,KAAK,QAAS,sBACdA,KAAK,aAAa,SAACtU,EAAG3qB,GAAJ,6BAA0BA,EAAImS,EAAYge,EAA1C,QAMrB,OAJIwK,IAAqBc,GACvB4H,GAAoBlC,UAAU,KAAKmC,SAG7B3I,GACN,IAAK,eACHqG,GAAaqC,GAAqB,CAAEnC,gBAAgB,IACpD,MAEF,IAAK,QACHI,GAAU+B,GAAqBjC,GAAgBtB,GAAgB,CAC7D2B,mBAAoBK,GACpBN,cAAeO,GAAmBC,SAClC/K,aAAciL,GACdhL,aAAckL,KAEhB,MAEF,IAAK,SACL,IAAK,UACL,QACE,IAAME,GACiB,YAArB3H,EAAiC4E,EAAeH,EAE5CmD,GACiB,YAArB5H,EACI,SAAChQ,GAAD,OAAOA,EAAErtB,OAASqtB,EAAElM,MACpB,SAACkM,GAAD,OAAOA,EAAErtB,QAEf+kC,GAAQgB,GAAqBf,GAAYC,GAAa,CACpDI,UAAU,EACVH,UAAWjC,EAAmB/5B,YAC9Bi8B,UAAW72B,GACXwtB,aAAa,EACbqI,mBAAoBsB,KAQ1BG,GACG/B,UAAU,yBACVzrB,KAAKvI,OAAOrI,OAAOwH,KAAa,SAACqe,GAAD,OAAOA,EAAE/uB,QACzCsN,KAAK,QACL+1B,KAAK,QAAS,wBACdA,KAAK,OAAQ,QACbA,KACC,UACA,SAACtU,EAAG3qB,GAAJ,OAAU8L,GAAwB9L,EAAI8L,GAAwBxO,WAE/D2hC,KAAK,eAAgB,KACrBA,KAAK,IAAK,GACVA,KAAK,KAAK,SAACtU,EAAG3qB,GAAJ,OAAUA,EAAImS,EAAYge,KACpC8O,KAAK,QAASsB,EAAmB/5B,aACjCy4B,KAAK,SAAU9sB,GAGlB+wB,GAEG/B,UAAU,+BACVzrB,MAAK,SAACiV,GAAD,MAAO,CAACA,MACbzhB,KAAK,QACL+1B,KAAK,QAAS,8BACdA,KAAK,OAAQ,WACbA,KAAK,IAAKsB,EAAmB/5B,YAAc,EAAIu4B,EAAmB,GAClEE,KAAK,IAAK9xB,OAAOrI,OAAOwH,IAAYhP,OAAS6U,EAAYge,GACzD8O,KAAK,QAASF,GACdE,KAAK,UAAU,SAACtU,GAAD,OAAOoW,GAAoBpW,EAAEyS,gBAI/CxY,EACG6Z,OAAO,qBACPQ,KAAK,YAFR,oBAEkCn7B,EAAQ,EAAIqO,EAAY,EAF1D,SAIA,IAAMoxB,GAAmB3e,EACtB6Z,OAAO,qBACP0C,UAAU,oBACVzrB,KAAKsqB,GAAiB,SAACrV,GAAD,OAAOA,EAAE/uB,QAC/BsN,KAAK,KACL+1B,KAAK,QAAS,mBACdA,KAAK,aAAa,SAACtU,GAAD,0BAAoB8V,EAAqB9V,EAAE/uB,MAA3C,WAGrB2nC,GACGpC,UAAU,0BACVzrB,MAAK,SAACiV,GAAD,MAAO,CAACA,MACbzhB,KAAK,QACL+1B,KAAK,QAAS,oCACdA,KAAK,QAAS,mBACdA,KAAK,YANR,oBAMkCkE,GANlC,YAMgDC,GANhD,kBAOGnE,KAAK,OAAQ,SACbA,KAAK,oBAAqB,UAC1Bz1B,MAAK,SAACmhB,GAAD,OAAOA,EAAE/uB,QAGjB,IAAM4nC,GAAwBD,GAC3BpC,UAAU,yBACVzrB,MACC,SAACiV,GAAD,OACExd,OAAOrI,OAAO6lB,EAAEiT,mBAAmB79B,KAAI,SAACgB,EAAMf,GAG5C,OADAe,EAAK0S,IAAMzT,EACJe,QAEX,SAAC4pB,GAAD,OAAOA,EAAE/uB,QAEVsN,KAAK,KACL+1B,KAAK,QAAS,wBACdA,KAAK,aAAa,SAACtU,EAAG3qB,GAAJ,6BAA0BA,EAAImS,EAAYge,EAA1C,QAMrB,OAJIwK,IAAqBc,GACvB+H,GAAsBrC,UAAU,KAAKmC,SAG/B3I,GACN,IAAK,eACHqG,GAAawC,IACb,MAEF,IAAK,QACHlC,GAAUkC,GAAuBpC,GAAgBpB,GAAkB,CACjEyB,mBAAoBK,GACpBN,cAAeO,GAAmBE,WAClChL,aAAciL,GACdhL,aAAckL,KAEhB,MAEF,IAAK,SACL,IAAK,UACL,QACE,IAAME,GACiB,YAArB3H,EAAiC4E,EAAeH,EAE5CmD,GACiB,YAArB5H,EACI,SAAChQ,GAAD,OAAOA,EAAErtB,OAASqtB,EAAElM,MACpB,SAACkM,GAAD,OAAOA,EAAErtB,QAEf+kC,GAAQmB,GAAuBlB,GAAYC,GAAa,CACtDI,UAAU,EACVH,UAAW/B,EAAqBj6B,YAChCi8B,UAAW72B,GACXwtB,aAAa,EACbqI,mBAAoBsB,KAQ1BQ,GACGpC,UAAU,2BACVzrB,KAAKvI,OAAOrI,OAAOwH,KAAa,SAACqe,GAAD,OAAOA,EAAE/uB,QACzCsN,KAAK,QACL+1B,KAAK,QAAS,0BACdA,KAAK,OAAQ,QACbA,KACC,UACA,SAACtU,EAAG3qB,GAAJ,OAAU8L,GAAwB9L,EAAI8L,GAAwBxO,WAE/D2hC,KAAK,eAAgB,KACrBA,KAAK,IAAK,GACVA,KAAK,KAAK,SAACtU,EAAG3qB,GAAJ,OAAUA,EAAImS,EAAYge,KACpC8O,KAAK,QAASwB,EAAqBj6B,aACnCy4B,KAAK,SAAU9sB,GAGlBoxB,GAEGpC,UAAU,iCACVzrB,MAAK,SAACiV,GAAD,MAAO,CAACA,MACbzhB,KAAK,QACL+1B,KAAK,QAAS,gCACdA,KAAK,OAAQ,WACbA,KAAK,IAAKwB,EAAqBj6B,YAAc,EAAIu4B,EAAmB,GACpEE,KAAK,IAAK9xB,OAAOrI,OAAOwH,IAAYhP,OAAS6U,EAAYge,GACzD8O,KAAK,QAASF,GACdE,KAAK,UAAU,SAACtU,GAAD,OAAOoW,GAAoBpW,EAAEyS,gBAK/C,IAAMqG,GAAY5gC,KAAKE,MAAM89B,GAAoBF,GAAqB,KAChE+C,GAAW7gC,KAAKE,KAAK0gC,GAAY,GACjCE,GACJF,IAAa,EACT,CAAC9C,EAAmBE,IACpB/qB,MAAM,GACHrD,OACA1S,KACC,SAACuH,EAAGtH,GAAJ,OACuC,IAArC6C,KAAKE,KAAK49B,EAAoB,KAAa3gC,GAAgB,IAAX0jC,OAG5D9e,EACG6Z,OAAO,uBACPQ,KACC,YAHJ,uBAKM9xB,OAAOrI,OAAOwH,IAAYhP,OAAS6U,EAAYge,EALrD,MAQGyT,KACCC,aAAU9C,IACP+C,SAAShgC,GACTigC,YAAW,SAAoCpZ,GAC9C,IAAMrT,GAAKqT,EAAI,KAAK5kB,QAAQ,GAC5B,OAAOi+B,KAAKC,WAAWC,YACnB5sB,EADG,UAEAA,EAFA,gCAIRqsB,WAAWA,KAEfC,MAAK,SAACO,GAAD,OAAOA,EAAE1F,OAAO,WAAW6E,YAChCM,MAAK,SAACO,GAAD,OACJA,EACGhD,UAAU,cACVlC,KAAK,SAAU,WACfA,KAAK,eAAgB,IACrBA,KAAK,mBAAoB,UAE7B2E,MAAK,SAACO,GAAD,OACJA,EACGhD,UAAU,cACVlC,KAAK,OAAQ,WACbA,KAAK,IAAKn7B,EAAQ,GAClBm7B,KAAK,KAAM,GACXA,KAAK,cAAe,UACpBA,KAAK,oBAAqB,eAwO7BmF,CAA4BpJ,EAAQl3B,EAAO4R,EAAM,CAC/CilB,mBACAc,uBACAV,cACA3B,cACA3gC,UACA+lC,iBACAnkC,SAAUygC,EACV7pB,kBAKJ,CAAC+pB,EAAQl3B,EAAO4R,EAAMilB,EAAkBI,EAAa3B,IAIrD,kBAAC55B,EAAA,EAAD,CACE9G,UAAWD,EAAQ2B,KACnBqF,WAAS,EACTw4B,QAAQ,SACRt4B,WAAW,UAEVi9B,IAAWxB,EACV,kBAAC57B,EAAA,EAAD,CAAMuB,MAAI,EAACrI,UAAWD,EAAQ4gC,MAC5B,yBAAKl4B,IAAKu7B,EAAWhkC,UAAWD,EAAQ6gC,SACtC,uBAAGz5B,GAAG,cACN,uBAAGA,GAAG,uBACN,uBAAGA,GAAG,mBACN,uBAAGA,GAAG,uBAIV,kBAAChH,EAAA,EAAD,CAAkBP,MAAM,gBCvhC1BN,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvCmhC,KAAM,CACJ3G,UAAW,YAyBA2R,GArBO9qC,IAAMmC,MAAK,WAC/B,IAAMuV,EAAc9U,YAAeid,IAE7B3gB,EAAUT,KAEhB,OACE,6BACE,kBAAC,GAAD,CACE6H,GAAG,gBACH+c,MAAM,4BACN+T,iBAAiB,MACjBD,YAAalU,GACb+T,KAAM+T,GACN9T,KAAM+T,GACN9T,SAAUkI,KAEZ,yBAAKjgC,UAAWD,EAAQ4gC,MAAOpoB,GAAe,kBAAC,GAAD,WCpB9CjZ,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvCkC,KAAM,CACJujB,QAAS,OACT4C,eAAgB,iBAElB/W,KAAM,CACJvO,SAAU,cA8BCupC,GA1BcjrC,IAAMmC,MAAK,WACtC,IAAMxC,EAAYG,IAEZ01B,EAAW5yB,YAAe8c,IAC1BwrB,EAAatoC,YAAemf,GAA6BpiB,IAEzDT,EAAUT,KAEV0sC,EAA6B7hC,KAAKy9B,OACrCmE,EAAW,GAAKA,EAAW,IAAM,KAGpC,OAAK1V,EAGH,yBAAKr2B,UAAWD,EAAQ2B,MACtB,wCACA,kBAAC6D,EAAA,EAAD,CAAYkiB,MAAM,SAASznB,UAAWD,EAAQ+Q,KAAMtL,QAAM,GACvD6H,GAAQ2+B,EAA4B,GAAI,IACzC,0BAAM9nB,MAAM,mBAAZ,QAEF,yCATkB,MCvBT+nB,GAVcprC,IAAMmC,MAAK,WACtC,OACE,kBAACuC,EAAA,EAAD,wNCUEjG,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvC82B,gBAAiB,CACf5vB,OAAQlH,EAAMsoB,QAAQ,EAAG,EAAG,IAAM,IAEpCkY,OAAQ,CACNt5B,OAAQ,OAoHGwlC,GAhHkBrrC,IAAMmC,MACrC,WAAqC,IAAD,EtBucpC4P,GAAqB,MAAOyN,IsBvcQ,mBAEhC8rB,EAFgC,KAGhCC,EAHgC,OtB4cpCx5B,GAAqB,OAAQ0N,IsB5cO,mBAK3B+rB,EAL2B,KAKTC,EALS,KAO5BC,EAA4B,SAAC7rC,GAAD,OAAW,WAC3C0rC,EAAuB1rC,KAQnBX,EAAUT,KAEhB,OACE,kBAAC,IAAMiI,SAAP,KACE,kBAAC8nB,EAAA,EAAD,CAAKC,EAAG,GACN,kBAACxqB,EAAA,EAAD,CACE9E,UAAWD,EAAQigC,OACnBh7B,QACE,kBAAC,GAAD,CACEV,QAAS+nC,EACThnC,SAfmB,SAACjB,GAC9BkoC,EAAoBloC,EAAMG,OAAOD,UAevBpB,KAAK,SAGToC,MAAM,4BAGV,kBAAC+pB,EAAA,EAAD,CAAKC,EAAG,GACN,kBAAC9oB,EAAA,EAAD,CAAagD,UAAU,YACrB,kBAACytB,GAAA,EAAD,CAAWztB,UAAU,SAASxJ,UAAWD,EAAQu2B,iBAAjD,UAGA,kBAACY,GAAA,EAAD,CACEC,aAAW,sBACXj0B,KAAK,sBACLxC,MAAOyrC,GAEP,kBAACrnC,EAAA,EAAD,CACEQ,MAAM,YACN5E,MAAM,YACNV,UAAWD,EAAQq3B,UACnBpyB,QACE,kBAACikB,GAAA,EAAD,CACElD,KAAK,QACLjc,QAASyiC,EAA0B,cAEV,cAAxBJ,EACC,kBAAC,KAAD,CACEnsC,UAAWD,EAAQs3B,gBACnB90B,SAAS,YAGX,kBAAC,KAAD,CAA0BA,SAAS,eAK3C,kBAACuC,EAAA,EAAD,CACEQ,MAAM,OACN5E,MAAM,OACNV,UAAWD,EAAQq3B,UACnBpyB,QACE,kBAACikB,GAAA,EAAD,CACElD,KAAK,QACLjc,QAASyiC,EAA0B,SAEV,SAAxBJ,EACC,kBAAC,KAAD,CACEnsC,UAAWD,EAAQs3B,gBACnB90B,SAAS,YAGX,kBAAC,KAAD,CAA0BA,SAAS,eAK3C,kBAACuC,EAAA,EAAD,CACEQ,MAAM,SACN5E,MAAM,SACNV,UAAWD,EAAQq3B,UACnBpyB,QACE,kBAACikB,GAAA,EAAD,CACElD,KAAK,QACLjc,QAASyiC,EAA0B,WAEV,WAAxBJ,EACC,kBAAC,KAAD,CACEnsC,UAAWD,EAAQs3B,gBACnB90B,SAAS,YAGX,kBAAC,KAAD,CAA0BA,SAAS,sBClFnDjD,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvCkC,KAAM,CACJC,SAAU,WACVE,IAAK,EACLE,MAAO,EACPE,OAAQ,EACRD,KAAM,GAERwiB,KAAM,CACJ6G,SAAU,OA8HCmhB,GAxGU3rC,IAAMmC,MAAK,WAClC,IAAMxC,EAAYG,IAEZ8rC,EAAsB9R,YAAkBjZ,IAExCsgB,EAAkBv+B,YAAegc,IACjCitB,EAAajpC,YAAe4c,IAC5BssB,EAAUlpC,YAAe6c,IACzBiW,EAAgB9yB,YAAewd,IAC/BkF,EAAgB1iB,YAAeyc,IAC/B2C,EAAiBpf,YAAe8e,GAA2B/hB,IAE3D26B,EAAaxU,iBAAO,MAEpBimB,EAAe3rC,EACnBwC,YAAemf,GAA6BpiB,IAC5C,KAGI88B,EAAqBn5B,uBACzB,SAACo5B,GACyB,OAApBA,IACFkP,EAAoBlP,EAAgBC,KACpCrC,EAAWtU,QAAU0W,EAAgBC,OAGzC,CAACiP,IAGGlwB,EAAavY,mBACjB,kBACE83B,YACEpf,GAA8ByJ,GAC9BlJ,GAA4B4F,EAAgB,CAAC,IAC7CpF,GAA8B8Y,IApDGsW,EAqDDH,EArDY,SAACnwB,GAGnD,OAFAA,EAAWzF,MAAM,GAAGO,OAAOxV,IAAI,GAAG2F,QAAQ0U,iBACvC2wB,GAAqB,WAAXA,IAA8BA,EACpCtwB,IAGgC,SAACowB,GAAD,OAAa,SAACpwB,GAErD,OADAA,EAAWzF,MAAM,GAAGO,OAAOxV,IAAI,GAAG2F,QAAQoU,iBAAmB+wB,EACtDpwB,GA8CDuwB,CAAiCH,GACjChvB,GAAuB,WAAvB,cAA2BivB,GAA3B,QAAyC,CAAE9uB,OAAO,OA5CpByqB,EA6CDvG,EA7Ce,SAACzlB,GAInD,OAHAA,EAAWzF,MAAM,GAAGO,OAAOxV,IAAI,GAAG2F,QAAQqU,cAAgBhB,GAAwCrX,QAChG,SAACupC,EAAOzlC,GAAR,OAAcihC,EAAUjhC,MAEnBiV,IAkCHuf,CAQEhf,YAAU3B,KA9CmB,IAACotB,EAXGsE,IA2DrC,CAGE1mB,EACAtD,EACA+pB,EACArW,EACAmW,EACA1K,EACA2K,IAKJrrC,qBACE,kBAAM,WACA65B,EAAWtU,SACbsU,EAAWtU,QAAQnU,aAKvB,IAIF,IAAM3S,EAAUT,KAEhB,OACE,kBAACwH,EAAA,EAAD,CAAMC,WAAS,EAACC,UAAU,SAAShH,UAAWD,EAAQ2B,MACpD,kBAAC,GAAD,CACEyF,GAAG,oBACH+c,MAAM,oBACN8T,YAAatU,GACbmU,KAAMiU,GACNhU,KAAMmU,GACNlU,SAAUmU,KAEZ,kBAACplC,EAAA,EAAD,CAAMuB,MAAI,EAACtB,WAAS,EAACC,UAAU,SAAShH,UAAWD,EAAQykB,MACzD,kBAAC,mBAAD,CACE/b,IAAK60B,EACL/gB,WAAYA,EACZ/U,QAAS,CACPq3B,SAAU,SACVmO,2BAA2B,EAC3BC,kBAAmB,EACnBC,kBAAmB,EACnBC,cAAe,EACfC,iBAAkB,EAClBC,eAAgB,EAChBC,gBAAiB,EACjBC,eAAgB,EAChBC,kBAAmB,EACnBC,gBAAiB,EACjBC,iBAAkB,GAClB5O,qBAAqB,UC9H3Bx/B,GAAYC,aAAW,SAACC,GAAD,MAAY,CACvCkC,KAAM,CACJC,SAAU,WACVsjB,QAAS,OACTpjB,IAAK,EACLE,MAAO,EACPE,OAAQ,EACRD,KAAM,GAERwpB,QAAShsB,EAAMisB,OAAOD,QACtB1pB,QAAS,CACPupB,SAAU,EACV1jB,QAASnI,EAAMsoB,QAAQ,GACvBjoB,gBAAiB,SAEnB2kB,KAAM,CACJ6G,SAAU,GAEZ3G,UAAW,CACThlB,OAAQ,EACRgH,OAAO,IAAD,OAAMlH,EAAMsoB,QAAQ,GAApB,QACN1c,MAAO,EACPlJ,WAAY1C,EAAMwkB,QAAQC,KAAK,MAEjC0pB,gBAAiB,CACfhsC,SAAU,WACV0pB,SAAU,EACV3kB,OAAQ,oBAEVknC,SAAU,CACRjsC,SAAU,WACVE,IAAK,EACLE,MAAO,EACPE,OAAQ,EACRD,KAAM,EACN6rC,UAAW,OACX,SAAU,CACR7T,UAAW,SAGf8T,gBAAiB,CACfnsC,SAAU,WACV0pB,SAAU,GAEZ0iB,cAAe,CACbpsC,SAAU,YAEZqsC,iBAAkB,CAChBrsC,SAAU,WACVyJ,MAAO,QACP1E,OAAQ,wBAqIGunC,GAjICptC,IAAMmC,MAAK,WACzB,IAAMxC,EAAYG,IxB2WlBqS,GAA4B,KAAMkN,GAAoBjB,IAItDjM,GAA4B,IAAKoN,IAIjCpN,GAA4B,IAAKwN,IAOjCxN,GAA4B,IAAK0N,IAAkB,SAAC9R,GAAD,OACjDwO,MAAMC,QAAQzO,GAAK6B,GAAsB7B,GAAKA,KAMhDoE,GAA4B,MAAOqN,IAKnCrN,GAA4B,OAAQsN,IAKpCtN,GAA4B,MAAOuN,IA+BnCvN,GAA4B,MAAOoO,IAKnCpO,GAA4B,MAAOkO,IAKnClO,GAA4B,MAAOmO,IAKnCnO,GAA4B,MAAOqO,IAKnCrO,GAA4B,MAAOsO,IAKnCtO,GAA4B,OAAQuO,IAKpCvO,GAA4B,KAAMiO,IArDc,SAACzgB,GACjDwS,GACE,IACA2O,GAAyBnhB,GACzBmP,IwBtYFu+B,CAAmC1tC,GxB+YW,SAACA,GAC/CwS,GACE,IACA8O,GAAuBthB,GACvBmP,IwBlZFw+B,CAAiC3tC,GAnBW,MAqBVgjB,KArBU,mBAqBrC2R,EArBqC,KAqB1BC,EArB0B,OAsBN3R,KAtBM,mBAsBrClL,EAtBqC,KAsBxBiF,EAtBwB,OAwBE9Z,YAC5C+c,IAzB0C,mBAwBrC2B,EAxBqC,KAwBpBiT,EAxBoB,OA2BM3xB,YAChDid,IA5B0C,mBA2BrC6B,EA3BqC,KA2BlB6D,EA3BkB,KAoCtC+nB,EAAyB,SAACr7B,GAC1BA,GACFqiB,EAAariB,EAASiO,UACtBqU,EAAmBtiB,KAPrBqiB,EAAa,IACbC,EAAmB,QAiBfgZ,EAA2B,SAACt7B,GAC5BA,GACFyK,EAAezK,EAASiO,UACxBqF,EAAqBtT,KAPvByK,EAAe,IACf6I,EAAqB,QAYjBtmB,EAAUT,KA+BhB,OA5BAgC,qBACE,WACE,sBAAC,sCAAA+M,EAAA,0DACK8mB,GAAc/S,EADnB,gCAEmBsP,MAAM,GAAD,OAAIre,GAAJ,eAA0B8hB,IAFlD,cAESmZ,EAFT,gBAGyBA,EAAE1c,OAH3B,OAGSrf,EAHT,QAISsf,EAAStf,EAAQ,MAErBsf,EAAOloB,KAAO,OACdykC,EAAuB77B,EAAQ,KAPpC,WAUKgG,IAAegP,YAAShP,IAAiBiK,EAV9C,kCAWmBkP,MAAM,GAAD,OAAIpe,GAAJ,eAA6BiF,IAXrD,eAWS+1B,EAXT,iBAYyBA,EAAE1c,OAZ3B,QAYSrf,EAZT,QAaSsf,EAAStf,EAAQ,MAErBsf,EAAOloB,KAAO,UACd0kC,EAAyB97B,EAAQ,KAhBtC,2CAAD,KAuBF,IAIA,yBAAKvS,UAAWD,EAAQ2B,MACtB,kBAACioB,GAAD,KACE,kBAAC4kB,EAAA,EAAD,MACA,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAChO,GAAD,KACE,kBAACz5B,EAAA,EAAD,CACEC,WAAS,EACTC,UAAU,SACVhH,UAAWD,EAAQ+B,QACnBy3B,KAAK,UAEL,yBAAKv5B,UAAWD,EAAQyrB,UACxB,kBAAC1kB,EAAA,EAAD,CAAMC,WAAS,EAAC/G,UAAWD,EAAQykB,KAAM+U,KAAK,UAC5C,yBAAKv5B,UAAWD,EAAQ4tC,iBACtB,yBAAK3tC,UAAWD,EAAQ6tC,UACtB,kBAAC9mC,EAAA,EAAD,CAAMC,WAAS,EAACC,UAAU,UACxB,kBAACF,EAAA,EAAD,CAAMuB,MAAI,EAACrI,UAAWD,EAAQ+tC,iBAC5B,kBAAC,GAAD,OAEF,kBAAChnC,EAAA,EAAD,CAAMuB,MAAI,EAACrI,UAAWD,EAAQguC,eAC5B,kBAAC,GAAD,UAKR,yBAAK/tC,UAAWD,EAAQ2kB,YACxB,yBAAK1kB,UAAWD,EAAQiuC,kBACtB,kBAAC,GAAD,eClNDQ,GAHI,SAACC,EAAYC,GAAb,OAAiC,SAAC9kB,GAAD,OAAe,SAACzhB,GAAD,OACjEsmC,EAAWtmC,GAAS,kBAACumC,EAAoBvmC,GAAY,kBAACyhB,EAAczhB,MCWhE3I,I,OAAQmvC,YAAe,CAC3B3qB,QAAS,CACP2b,QAAS,CACPC,KAAM,QAERgP,UAAW,CACThP,KAAM,YA0CGiP,GArCH,WAAO,IAAD,EACkB1tC,mBAAS,MAD3B,mBACTX,EADS,KACEsuC,EADF,KAGhBxtC,qBAAU,WACRytC,yBAAe,2DACZ58B,MAAK,SAAC68B,QAC0BjuC,IAA3BiuC,EAAWptB,YAGbktB,GAAa,GAEbA,EAAaE,MAGhBC,OAAM,WACLH,GAAa,QAEhB,IAEH,IAAMI,EAAOpT,YACX0S,IAAW,kBAAoB,OAAdhuC,IAAoBV,GACrC0uC,IAAW,kBAAoB,IAAdhuC,IAAqB2uC,GAF3BrT,CAGXmS,IAEF,OACE,yBAAKjuC,UAAU,OACb,kBAAC,IAAD,KACE,kBAACovC,EAAA,EAAD,CAAe5vC,MAAOA,IACpB,kBAACc,EAAD,CAAmBE,UAAWA,GAC5B,kBAAC0uC,EAAD,WC1CQ3pB,QACW,cAA7BxZ,OAAOC,SAASqjC,UAEe,UAA7BtjC,OAAOC,SAASqjC,UAEhBtjC,OAAOC,SAASqjC,SAAS9/B,MACvB,2D,+BClBN,SAAS+/B,GAAiCC,GACxC,KAAI,gBADGD,GACH,yBACF,MAAM,IAAItuC,MACR,yEAHkD,QAQ9CwuC,EAAWD,EAAIE,SAAfD,OAEFE,EAVgD,WAWpD,WAAY9uC,EAAS4G,GAAU,IAAD,gCACpBmoC,EAA0D/uC,EAA1D+uC,WAAYC,EAA8ChvC,EAA9CgvC,eAAkCC,EAAYjvC,EAA9BkvC,iBAEpCxE,KAAKuE,QAAUA,EACfvE,KAAK9jC,QAAUA,EAEf8jC,KAAKhxB,cAAgBs1B,EAAeD,EAAWr1B,eAE1CgxB,KAAKhxB,eAOVgxB,KAAKyE,mBAAqB,IAAI1zB,IAC9BivB,KAAK/wB,iBAAmBo1B,EAAWnoC,QAAQ+S,iBACxClT,KAAI,SAACkK,GACJ,IAAMkL,EAAQmzB,EAAer+B,GAQ7B,OANKkL,EAGH,EAAKszB,mBAAmBjxB,IAAIrC,EAAMqkB,MAFlC/P,QAAQC,KAAR,4BAAkCzf,EAAlC,gBAKKkL,KAERjZ,QAAO,SAACiZ,GAAD,OAAWA,KAErB6uB,KAAK0E,0BAA4B1E,KAAK2E,qBAAqBC,KAAK5E,MAEhEA,KAAK6E,iBAAmB,IAAIC,IAC5B9E,KAAK+E,mBAAqB,IAAIh0B,IAE9BivB,KAAKgF,QAAU,GAGfhF,KAAK/wB,iBAAiB9P,SAAQ,SAACgS,GAC7BA,EAAM3K,UAAU,aAAc,EAAKk+B,+BA9BnCjf,QAAQC,KAAR,+BAC0B2e,EAAWr1B,cADrC,gBApBgD,sDAyD1C,IAAD,OACPgxB,KAAKgF,QAAQ7lC,QAAQ+kC,EAAO78B,aAC5B24B,KAAKgF,aAAUvvC,EACfuqC,KAAK/wB,iBAAiB9P,SAAQ,SAACgS,GAC7BA,EAAM9J,YAAY,YAAa,EAAK49B,mCA7DY,8CAiEF,IAAD,OAA1BzP,EAA0B,EAA1BA,KAA0B,IAApB0P,mBAAoB,MAAN,GAAM,EAC1ClF,KAAKyE,mBAAmBhxB,IAAI+hB,KAEjCwK,KAAK+E,mBAAmBvxB,IAAIgiB,GAE5B0P,EAAY/lC,SAAQ,YAAmC,IAAhCgmC,EAA+B,EAA/BA,UAAWC,EAAoB,EAApBA,QAAS1zB,EAAW,EAAXA,KACzC,EAAKmzB,iBAAiBt3B,IAAImE,EAAKzL,IAAK,CAACk/B,EAAWC,OAG5CpF,KAAK+E,mBAAmBtqB,KAAOulB,KAAK/wB,iBAAiB3V,QACzD0mC,KAAKqF,oBA3E2C,uCAgFlDrF,KAAKhxB,cAAc9S,QAAQqS,OAASuD,MAAMwzB,KACxCtF,KAAK6E,iBAAiB/jC,UAExBk/B,KAAKhxB,cAAcu2B,OACnBvF,KAAK+E,mBAAmBS,QACxBxF,KAAK6E,iBAAiBW,YArF4B,wBAAN90B,EAAM,iCAANA,EAAM,kBAyFtD,OAAO,aAAI0zB,EAA8B1zB,GAG3CszB,GAAiCnqB,OAAS,CACxCxb,KAAM,qBACNonC,iBAAkB,CAAC,oBACnBC,eAAgB,CACdz2B,iBAAkB,KAIP+0B,U,oCCpFT2B,GAAczmC,aAAa0mC,kBAE3BC,GAAE,y6EAgFFC,GAAE,2GAWFC,GAAiBj0B,MAAM,KAC1BrD,OACA1S,KAAI,SAAC4K,EAAG3K,GACP,IAAM4uB,EAAuB,IAAf,EAAI5uB,EAAI,KAAa,GACnC,MAAO,CAAC4uB,EAAMA,EAAMA,EAAM,MAGxBob,GAAS,SAACC,GAAD,OACb98B,OAAOrI,OAAOmlC,GAAc7iC,QAC1B,SAAC8iC,EAAUhP,GAAX,OAAoBr4B,KAAKC,IAAIonC,EAAUhP,EAAKiP,SAASC,eACpD7P,MAGC8P,GAAa,SAACJ,GAAD,OACjB98B,OAAOrI,OAAOmlC,GAAc,GAAGE,SAASG,YAAY,IAEhDC,GAAa,SAACN,GAAD,OACjBO,YACEr9B,OAAOrI,OAAOmlC,GAAclqC,KAAI,SAACm7B,GAAD,OAAUA,EAAKiP,SAASM,mBAGtDC,GAAgB,SAACnnC,EAAUonC,EAAQC,GACvC,IAAMC,GACHD,EAAatkC,SAAS,GAAKskC,EAAatkC,SAAS,KACjDqkC,EAAOrkC,SAAS,GAAKqkC,EAAOrkC,SAAS,IAGlCwkC,EAFWH,EAAOrkC,SAASvG,IAAI6qC,GAEV,GAC3BrnC,EAAS8D,MAAMsD,EAAIkgC,EACnBtnC,EAASlJ,SAASsQ,GAAKmgC,EAAYD,GAG/BE,GAAqB,SAACC,EAASC,EAAWh3B,GAArB,OACzBg3B,EAAU3tC,OAAS0tC,EAAU,GAAK,EAAI/2B,GAAY,GAE9Ci3B,GAAuB,SAASA,EAAqBjD,GACzD,KAAI,gBADgCiD,EAChC,yBACF,MAAM,IAAIxxC,MACR,yEAHmE,QAO/DgJ,EAASulC,EAAIkD,UAAbzoC,KACA0oC,EAAWnD,EAAIkD,UAAUE,SAAzBD,OACA5L,EAAgByI,EAAIkD,UAAUG,QAA9B9L,YACA+L,EAActD,EAAIE,SAAlBoD,UAEF9oC,EAAqB,SAACE,GAC1B,IAAMC,EAAcC,KAAKC,IAAI,EAAGD,KAAKE,KAAKF,KAAKG,KAAKL,EAAOrF,UACrD2F,EAAO,IAAIC,aAAgC,EAAnB,SAAAN,EAAe,IAY7C,OAXAD,EAAOQ,SAAQ,SAAC7K,EAAO0H,GAErBiD,EAAS,EAAJjD,GAAS1H,EAAM,GAEpB2K,EAAS,EAAJjD,EAAQ,GAAK1H,EAAM,GAExB2K,EAAS,EAAJjD,EAAQ,GAAK1H,EAAM,GAExB2K,EAAS,EAAJjD,EAAQ,GAAK1H,EAAM,MAGnB,CACLoK,EAAKU,QAAQC,WAAWJ,EAAML,EAAaA,GAC3CA,IAIE4oC,EAhCiE,oDAiCrE,WAAYlyC,EAAS4G,GAAU,IAAD,+BAC5B,cAAM5G,EAAS4G,IACVurC,gBAEL,EAAKC,SAAW,IAAIhpC,EAAKipC,SACzB,EAAKD,SAASrxC,SAASsQ,EAAI,EAC3B,EAAK+gC,SAASrxC,SAASqJ,EAAI,EAC3B,EAAKkoC,QAAQC,SAAS,EAAKH,UAE3B,EAAKI,cAAgB,IAAIppC,EAAKqpC,KAAK,kBAAmB,CACpD9wC,SAAU,EAAK+wC,WAAa,GAC5Bv5B,KAAM,UAER,EAAKi5B,SAASG,SAAS,EAAKC,eAbA,EAjCuC,sDAiD5D5Q,GACP8I,KAAKiI,mBAAmB/Q,KAlD2C,2EAwDnE,OAAO8I,KAAK75B,YAAY+hC,oBA7FZ,MAqCuD,8CA8D7CjQ,EAAWkQ,EAASC,GAC1C,IAAMC,EAAcD,GAAiBpI,KAAKqI,cAE1C,GAAIrI,KAAK75B,YAAYmiC,YAAa,CAChC,IAIMC,EAJoBvI,KAAK75B,YAAYmiC,YACxCvsC,KAAI,SAAC4K,GAAD,OAAQA,KACZuvB,MAAK,SAACnzB,EAAGC,GAAJ,OAAUA,EAAID,KAEqBk1B,GAErClxB,EAAYwhC,EAAmBF,EAC/BG,EAAazhC,EAKnB,MAAO,CACL0hC,MAJYF,EAAmBF,EAAcF,EAAQ,GAKrDO,MAJYH,EAAmBF,EAAcF,EAAQ,GAKrDphC,YACAyhC,cAIJ,IAAMG,EAAWR,EAAQ,GACnBS,EAAWT,EAAQ,GAEnBU,EAAO7I,KAAK75B,YAAY8E,QAAQ,GAChC69B,EAAO9I,KAAK9jC,QAAQ6sC,cACrB/I,KAAK75B,YAAY+E,QAAQ,GAC1B80B,KAAK75B,YAAY8E,QAAQ,GAEvBlE,EAAYi5B,KAAK75B,YAAYa,UAAjB,SAA6B,EAAKixB,GAC9CuQ,EAAaxI,KAAK75B,YAAYa,UAAjB,SAA6B,EAAKixB,GAKrD,MAAO,CACLwQ,MAJYI,EAAOF,EAAW5hC,EAK9B2hC,MAJYI,EAAOF,EAAWJ,EAK9BzhC,YACAyhC,gBAxGiE,sCA4GpD,IAAD,OAId,OAHAxI,KAAKgJ,0BACHhJ,KAAK9jC,QAAQ8sC,2BAA6B,OAEpChJ,KAAKgJ,2BACX,IAAK,MACHhJ,KAAKiJ,wBAA0BC,IAC/B,MAEF,IAAK,MACHlJ,KAAKiJ,wBAA0BE,IAC/B,MAEF,IAAK,MACHnJ,KAAKiJ,wBAA0BG,IAC/B,MAEF,IAAK,OACL,QACEpJ,KAAKiJ,wBAA0BI,IAInCrJ,KAAK/vB,WAAa+vB,KAAK9jC,QAAQ+T,SAE/B+vB,KAAKsJ,cAAgB,QAErBtJ,KAAKv2B,UAAYw6B,EAAIsF,MAAMC,WAAWxJ,KAAK9jC,QAAQuN,WAAa,SAEhEu2B,KAAKyJ,iBAAmBzJ,KAAK9jC,QAAQuN,UACjCw6B,EAAIsF,MACDG,YAAY1J,KAAK9jC,QAAQuN,WACzBjG,MAAM,EAAG,GACTzH,KAAI,SAAC4K,GAAD,OAAO9H,KAAKmU,IAAI,EAAGnU,KAAKC,IAAI,EAAG6H,EAAI,SAC1C,CAAC,EAAG,EAAG,GAlCG,MAoC8BlI,EAAmB,YAC1DsnC,KArCS,mBAoCb/F,KAAK2J,aApCQ,KAoCM3J,KAAK4J,gBApCX,KAwCd5J,KAAK6J,cAAgB9D,GAAezsC,OAEpC0mC,KAAKp2B,YAAckJ,OAAOC,OAAOitB,KAAK9jC,QAAQ0N,aAC1C,EACA/K,KAAKmU,IAAI,EAAGnU,KAAKC,IAAI,GAAIkhC,KAAK9jC,QAAQ0N,cAE1Co2B,KAAKr2B,SAAWq2B,KAAK9jC,QAAQyN,UAAY,EAGzC,IAAMmgC,EAAoB9J,KAAK9vB,eAC/B8vB,KAAK9vB,eAAiBrR,KAAKC,IACzB,EACAD,KAAKmU,IArMK,IAqMUgtB,KAAK9jC,QAAQgU,gBAAkB65B,KAKrD,IAAMC,EAAehK,KAAK7xB,UAC1B6xB,KAAK7xB,UAAY2E,OAAOC,OAAOitB,KAAK9jC,QAAQiS,WACxC,QACC6xB,KAAK9jC,QAAQiS,UAElB,IAAM87B,EAAgBjK,KAAK3vB,WAC3B2vB,KAAK3vB,WACgB,SAAnB2vB,KAAK7xB,UAAuB,EAAI6xB,KAAK9jC,QAAQmU,YAAc,EAE7D,IAAM65B,EAAsBlK,KAAK1vB,iBACjC0vB,KAAK1vB,iBAAmB0vB,KAAK9jC,QAAQoU,mBAAoB,EAEzD,IAAM65B,EAAmBnK,KAAKzvB,cAC9ByvB,KAAKzvB,cACHyvB,KAAK9jC,QAAQqU,eAAiByvB,KAAKzvB,eAAiB,GAEtD,IAAM65B,EAAmBpK,KAAKpvB,cAC9BovB,KAAKpvB,cAAgBovB,KAAK9jC,QAAQ0U,cAGhCk5B,IAAsB9J,KAAK9vB,gBAC3Bi6B,IAAqBnK,KAAKzvB,gBAE1ByvB,KAAKqK,cACLrK,KAAKsK,kBACLtK,KAAKuK,aAILP,IAAiBhK,KAAK7xB,WACtB87B,IAAkBjK,KAAK3vB,YACvB65B,IAAwBlK,KAAK1vB,kBAE7B0vB,KAAKwK,eAGHJ,IAAqBpK,KAAKpvB,gBAC5BovB,KAAKsK,kBACLtK,KAAKuK,aAGPvK,KAAKyK,cAAgBzK,KAAK9jC,QAAQuuC,eAAiB,OACnDzK,KAAKnvB,aAAemvB,KAAK9jC,QAAQ2U,cAAgB,GAEjDmvB,KAAKrvB,cAAgBqvB,KAAK9jC,QAAQyU,eAAiB,GACnDqvB,KAAKxvB,gBAAkB,SAAC3U,GAAD,OAAQA,EAAGuG,UAAU,EAAGvG,EAAGvC,OAAS,KAC3D0mC,KAAKxvB,gBAAkBwvB,KAAK9jC,QAAQsU,gBAChC,SAAC3U,GAAD,OACEA,EAAG,EAAKK,QAAQsU,gBAAgBC,IAAhC,MAAA5U,EAAE,YACG,EAAKK,QAAQsU,gBAAgBE,QAEpCpQ,MAxN+D,wCA4NnE,KAAO0/B,KAAK0K,MAAMz1C,SAASqE,QACzB0mC,KAAK0K,MAAMC,cAAc,GAEvB3K,KAAK4K,YACP5K,KAAK4K,UAAUzrC,SAAQ,SAAC0rC,GACtBA,EAASzjC,aAEX44B,KAAK4K,eAAYn1C,KAnOgD,wCAuOlD,IAAD,OAChB,GAAKuqC,KAAK75B,aAAgB65B,KAAK75B,YAAY2kC,UAA3C,CAEA,IAAMvJ,EAASvB,KAAKzvB,cAAcjX,OAC9B0mC,KAAKzvB,cAAcxU,KAAI,SAACgvC,GAAD,YACoBt1C,IAAzC,EAAK0Q,YAAY2kC,UAAUC,GACvB,IACA,EAAKv6B,gBAAgB,EAAKrK,YAAY2kC,UAAUC,GAAUlvC,OAEhEmkC,KAAK75B,YAAY2kC,UAAU/uC,KAAI,gBAAGF,EAAH,EAAGA,GAAH,OAAY,EAAK2U,gBAAgB3U,MAEpEmkC,KAAKgL,kBAEsB,cAAvBhL,KAAKpvB,cACPovB,KAAK4K,UAAYrJ,EAAOxlC,KAAI,SAAC/B,GAC3B,IAAMixC,EAAY,IAAIvsC,EAAKwsC,OAAOxsC,EAAKU,QAAQ+rC,OAW/C,OAVAF,EAAUnrC,MAAQ,EAAK+Q,aAAe,EACtCo6B,EAAU1zC,OAAS,EAAKsZ,aACxBo6B,EAAUG,KAAO,EAAKz6B,cAAc3W,GAChCiqC,EAAIsF,MAAMC,WACR,EAAK74B,cAAc3W,GAAO2V,gBACxB/H,GACE,EAAK+I,cAAc3W,GAAO8M,MAAQc,GAAkBtO,SAG1D,QACG2xC,KAEAjL,KAAKpvB,gBACdovB,KAAK4K,UAAYrJ,EAAOxlC,KACtB,SAAC/B,GAAD,OACE,IAAI0E,EAAKqpC,KAAK/tC,EAAO,CACnB/C,SAAU,EAAK4Z,aACfsL,MAA8B,UAAvB,EAAKsuB,cAA4B,QAAU,OAClDh8B,KAAM,EAAKkC,cAAc3W,GACrBiqC,EAAIsF,MAAMC,WACR,EAAK74B,cAAc3W,GAAO2V,gBACxB9H,GACE,EAAK8I,cAAc3W,GAAO8M,MACxBe,GAAuBvO,SAG/B,iBAjRuD,kCAuRxD,IAAD,OACV,GAAK0mC,KAAKpvB,eASV,GADIovB,KAAKpvB,gBAAkBovB,KAAK4K,WAAW5K,KAAKsK,kBAC3CtK,KAAK4K,UAAV,CAVU,IAYH9qC,EAZG,YAYMkgC,KAAKqL,WAZX,oBAaUrL,KAAK3pC,SAbf,GAaHK,EAbG,KAaGH,EAbH,KAeVypC,KAAK0K,MAAMr0C,SAASsQ,EAAuB,UAAnBq5B,KAAKvyB,UAAwB/W,EAAOoJ,EAAQpJ,EACpEspC,KAAK0K,MAAMr0C,SAASqJ,EAAInJ,EAExBypC,KAAK0K,MAAMlF,QACX,IAAI8F,EAAS,EAEPC,EAAkC,UAAnBvL,KAAKvyB,WAAyB,EAAI,EArB7C,EAsBgBuyB,KAAKwL,eAAtBC,EAtBC,oBAuBJC,EAAiBD,EAAgB,EAEvCzL,KAAK4K,UAAUzrC,SAAQ,SAACnF,EAAOgC,GAC7BhC,EAAM2M,EAAI4kC,EACVvxC,EAAM0F,EAAI4rC,EAAS,EAAKj7B,WAAaq7B,EACrC1xC,EAAM4pB,OAAOjd,EAAuB,UAAnB,EAAK8G,UAAwB,EAAI,EAClDzT,EAAM4pB,OAAOlkB,EAAI,GAEjB4rC,GAAUG,EAEV,EAAKf,MAAM7C,SAAS7tC,YA/BpB,GAAIgmC,KAAK4K,UACP,KAAO5K,KAAK0K,MAAMz1C,SAASqE,QACzB0mC,KAAK0K,MAAMC,cAAc,KA3RoC,+BA4T5DngB,GACPwV,KAAK9jC,QAAUsuB,EACfwV,KAAKyH,gBACLzH,KAAK2L,2BA/T8D,wCAmUnE,OAAOxiC,OAAOrI,OAAOk/B,KAAKiG,cAAc3sC,SAnU2B,yCAsUlD49B,GAAO,IAAD,EACM8I,KAAK4L,wBAChC1U,EAAKiP,SAASlO,UACdf,EAAKiP,SAASgC,SAFRM,EADe,EACfA,MAAO1hC,EADQ,EACRA,UAIRigC,EALgB,YAKL9P,EAAKiP,SAAS0F,MALT,MAMjBC,EAAYjtC,KAAKu5B,MAjXX,IAiX6B4H,KAAK9vB,gBACxC67B,EAAYhlC,EAAYi5B,KAAK9vB,eAC7B87B,EAAgBD,EAAY,EAGlC7U,EAAKiP,SAAS8F,QAAUn6B,MAAMkuB,KAAK9vB,gBAAgBzB,OACnD,IAAK,IAAIzS,EAAI,EAAGA,GAAKgkC,KAAK9vB,eAAgBlU,IACxCk7B,EAAKiP,SAAS8F,QAAQjwC,GAAKysC,EAAQsD,EAAY/vC,EAAIgwC,EAIrD9U,EAAKiP,SAAS+F,YAAcp6B,MAAMk1B,GAC/Bv4B,OACA1S,KAAI,iBAAM,MACbm7B,EAAKiP,SAASM,cAAgB30B,MAAMk1B,GAASv4B,MAAM8nB,KAEnD,IAAK,IAAIv6B,EAAI,EAAGA,EAAIgrC,EAAShrC,IAC3B,IAAK,IAAI65B,EAAI,EAAGA,EAlYN,IAkYqBA,GAAKiW,EAAW,CAC7C,IAAMK,EAAY9C,YAChBnS,EAAKiP,SAASiG,MAAMC,SApYd,IAqYJrwC,EAAgB65B,EArYZ,IAsYJ75B,EAAgB65B,EAAIiW,IAGxB5U,EAAKiP,SAAS+F,YAAYlwC,GAAGyV,KAAK06B,GAClCjV,EAAKiP,SAASM,cAAczqC,GAC1BmwC,EAAYjV,EAAKiP,SAASM,cAAczqC,GACpCmwC,EACAjV,EAAKiP,SAASM,cAAczqC,GAKlCgkC,KAAKzvB,cAAcjX,SACrB49B,EAAKiP,SAAS+F,YAAclM,KAAKzvB,cAC9BxU,KAAI,SAACuwC,GAAD,OAAYpV,EAAKiP,SAAS+F,YAAYI,MAC1Cp0C,OAAOoI,KACV42B,EAAKiP,SAASM,cAAgBzG,KAAKzvB,cAChCxU,KAAI,SAACuwC,GAAD,OAAYpV,EAAKiP,SAASM,cAAc6F,MAC5Cp0C,OAAOoI,MAIZ42B,EAAKiP,SAASG,YAAc,CAC1BpP,EAAKiP,SAAS+F,YAAY5yC,OAC1B0mC,KAAK9vB,kBAzX4D,oCA8XnE/G,OAAOrI,OAAOk/B,KAAKiG,cAAc9mC,QAC/B6gC,KAAKiI,mBAAmBrD,KAAK5E,SA/XoC,qCAmYrD,IAAD,OACPiG,EAAe98B,OAAOrI,OAAOk/B,KAAKiG,cAExC,GAAKA,EAAa3sC,OAAlB,CAEA,IAAM0tC,EAAUX,GAAWJ,GALd,EAOOjG,KAAKwL,eAAlBr9B,EAPM,oBASPo+B,EAAoBvM,KAAKwM,eAAexF,EAAS74B,GAEjDs+B,EAAYzG,GAAOhG,KAAKiG,cAU9B,GARAjG,KAAK1B,WAAa9C,IACfl5B,OAAO,CAAC,EAAGmqC,IACXhqC,MAAM,CAAC0L,EAAW,IACrB6xB,KAAK0M,gBAAkBlR,IACpBl5B,OAAO,CAAC,EAAGmqC,IACXhqC,MAAM,CAAC,EAAGu9B,KAAK6J,gBACfvO,OAAM,GAEL0E,KAAK1vB,iBAAkB,CACzB,IAAMq8B,EAAUpG,GAAWvG,KAAKiG,cAChCjG,KAAK4M,eAAiB,GACtB5M,KAAK6M,oBAAsB,GAC3B,IAAK,IAAI7wC,EAAI,EAAGA,EAAIgrC,EAAShrC,IAC3BgkC,KAAK4M,eAAe5wC,GAAKw/B,IACtBl5B,OAAO,CAAC,EAAGqqC,EAAQ3wC,KACnByG,MAAM,CAAC0L,EAAW,IACrB6xB,KAAK6M,oBAAoB7wC,GAAKw/B,IAC3Bl5B,OAAO,CAAC,EAAGqqC,EAAQ3wC,KACnByG,MAAM,CAAC,EAAGu9B,KAAK6J,gBACfvO,OAAM,GAEX0E,KAAK8M,gBAAkB,SAAC13C,EAAOqa,GAAR,OACrBqD,OAAOC,MAAM3d,GAAS+Y,EAAY,EAAKy+B,eAAen9B,GAAKra,IAC7D4qC,KAAK+M,qBAAuB,SAAC33C,EAAOqa,GAAR,OAC1BqD,OAAOC,MAAM3d,IAAU,EAAI,EAAKy3C,oBAAoBp9B,GAAKra,SAE3D4qC,KAAK8M,gBAAkB,SAAC13C,EAAOqa,GAAR,OACrBqD,OAAOC,MAAM3d,GAAS+Y,EAAY,EAAKmwB,WAAWlpC,IACpD4qC,KAAK+M,qBAAuB,SAAC33C,EAAOqa,GAAR,OAC1BqD,OAAOC,MAAM3d,IAAU,EAAI,EAAKs3C,gBAAgBt3C,IAGpD4qC,KAAKgN,SAAWxR,IACbl5B,OAAO,CAAC,EAAG0kC,IACXvkC,MAAM,CAAC,EAAG8pC,EAAoBvM,KAAK3vB,gBAlb6B,kCAqbzDmoB,GAA0D,IAAD,gEAAJ,GAA5CvoB,EAAgD,EAAhDA,SAAgD,IAAtCg9B,eAAsC,MAA5B1W,IAA4B,EAAlBpoB,EAAkB,EAAlBA,UACjD,IAAKqqB,EAAMl/B,OAAQ,MAAO,GAE1B,IAAM0tC,EAAUnoC,KAAKmU,IAAIi6B,EAAS5G,GAAW7N,IAEvC0U,EAAiBp7B,MAAMk1B,GAC1Bv4B,OACA1S,KAAI,iBAAM,MACPoxC,EAAoBr7B,MAAMk1B,GAC7Bv4B,OACA1S,KAAI,iBAAM,MACPqxC,EAAmBt7B,MAAMk1B,GAC5Bv4B,OACA1S,KAAI,iBAAM,MAEby8B,EAAMr5B,SAAQ,SAAC+3B,GACbA,EAAKiP,SAAS+F,YAAY/sC,SAAQ,SAAC2B,EAAQ9E,GACrCA,GAAKixC,GACTnsC,EAAO3B,SAAQ,SAAC/J,EAAOygC,GACrB,IAAMlvB,EAAI,EAAK0mC,QAAQnW,EAAKiP,SAAS8F,QAAQpW,IACvCyV,EAAS,EAAK0B,SAAShxC,GACvB0D,EAAI4rC,EAAS,EAAKwB,gBAAgB13C,EAAO4G,GAG/CkxC,EAAelxC,GAAGyV,KAAK9K,EAAGjH,EAAGiH,EAAGjH,GAChCytC,EAAkBnxC,GAAGyV,MAAM,GAAI,GAC/B27B,EAAiBpxC,GAAGyV,KAAK,GAAI,GAEzBxB,IACFi9B,EAAelxC,GAAGyV,KAAK9K,EAAGjH,EAAGiH,EAAG2kC,EAASn9B,GACzCg/B,EAAkBnxC,GAAGyV,KAAK,EAAKs7B,qBAAqB33C,EAAO4G,GAAI,GAC/DoxC,EAAiBpxC,GAAGyV,KAAK,EAAG,aAUpC,IAJA,IAAM67B,EAASr9B,EAAW,EAAI,EACxBs9B,EAASt9B,EAAW,EAAI,EAGrBjU,EAAI,EAAGA,EAAIgrC,EAAShrC,IAAK,CAAC,IAAD,QAOrB,IAAX,IALA,EAAAkxC,EAAelxC,IAAGwxC,QAAlB,oBAA6BN,EAAelxC,GAAGwH,MAAM,EAAG8pC,KAKpDtxC,EAAI,GACN,EAAAmxC,EAAkBnxC,IAAGwxC,QAArB,oBACKL,EAAkBnxC,GAAGwH,MAAM,EAAG+pC,MAEnC,EAAAH,EAAiBpxC,IAAGwxC,QAApB,oBAA+BJ,EAAiBpxC,GAAGwH,MAAM,EAAG+pC,MAI9D,EAAAL,EAAelxC,IAAGyV,KAAlB,oBAA0By7B,EAAelxC,GAAGwH,OAAO8pC,MACnD,EAAAH,EAAkBnxC,IAAGyV,KAArB,oBAA6B07B,EAAkBnxC,GAAGwH,OAAO+pC,MACzD,EAAAH,EAAiBpxC,IAAGyV,KAApB,oBAA4B27B,EAAiBpxC,GAAGwH,OAAO+pC,KAGzD,MAAO,CACL,IAAIruC,aAAaguC,EAAevkC,QAAQrI,MACxC,IAAIpB,aAAaiuC,EAAkBxkC,QAAQrI,MAC3C,IAAIpB,aAAakuC,EAAiBzkC,QAAQrI,SArfuB,oCAyfvD0mC,EAASyG,EAAiBx9B,GACtC,IAAMy9B,EAAkBz9B,EAAW,GAAK,EAClC09B,EAAmB19B,EAAW,EAAI,EAClC29B,EAAU,IAAIC,aACjBJ,EAAkB,GAAKzG,EAAU0G,GAEhCI,EAAI,EAER,GAAI79B,EAEF,IAAK,IAAIjU,EAAI,EAAGA,EAAIgrC,EAAShrC,IAC3B,IAAK,IAAI65B,EAAI,EAAGA,EAAI4X,EAAkB,EAAG5X,IAAK,CAG5C,IACMkY,EADc/xC,GAAKyxC,EAAkB,GAAKE,EACtB9X,EAAI8X,EACxBK,EAAMD,EAAM,EACZE,EAAMF,EAAM,EACZG,EAAMH,EAAM,EACZI,EAAMJ,EAAM,EACZK,EAAML,EAAM,EACZM,EAAMN,EAAM,EACZO,EAAMP,EAAM,EAEZQ,EAAcT,EAAIJ,EAExBE,EAAQW,GAAeN,EACvBL,EAAQW,EAAc,GAAKL,EAC3BN,EAAQW,EAAc,GAAKF,EAC3BT,EAAQW,EAAc,GAAKF,EAC3BT,EAAQW,EAAc,GAAKL,EAC3BN,EAAQW,EAAc,GAAKD,EAE3BV,EAAQW,EAAc,GAAKR,EAC3BH,EAAQW,EAAc,GAAKP,EAC3BJ,EAAQW,EAAc,GAAKJ,EAC3BP,EAAQW,EAAc,GAAKJ,EAC3BP,EAAQW,EAAc,IAAMP,EAC5BJ,EAAQW,EAAc,IAAMH,EAE5BN,SAKJ,IAAK,IAAI9xC,EAAI,EAAGA,EAAIgrC,EAAShrC,IAC3B,IAAK,IAAI65B,EAAI,EAAGA,EAAI4X,EAAkB,EAAG5X,IAAK,CAG5C,IACMkY,EADc/xC,GAAKyxC,EAAkB,GAAKE,EACtB9X,EAAI8X,EACxBK,EAAMD,EAAM,EACZI,EAAMJ,EAAM,EACZK,EAAML,EAAM,EAEZQ,EAAcT,EAAIJ,EACxBE,EAAQW,GAAeR,EACvBH,EAAQW,EAAc,GAAKP,EAC3BJ,EAAQW,EAAc,GAAKJ,EAC3BP,EAAQW,EAAc,GAAKJ,EAC3BP,EAAQW,EAAc,GAAKP,EAC3BJ,EAAQW,EAAc,GAAKH,EAE3BN,IAKN,OAAOF,IA7jB4D,mCAgkBxD5G,GAAU,IACZwH,EADW,YACWxO,KAAKqL,WADhB,MAGpB,MAA0B,SAAnBrL,KAAK7xB,UACR,CACEtP,KAAKu5B,MAAMoW,EAAqBxH,GAChCnoC,KAAKu5B,MAAMoW,EAAqBxH,IAElC,CAAChH,KAAK7xB,UAAW6xB,KAAK7xB,UAAY6xB,KAAK3vB,cAxkBwB,qCA2kBtD22B,EAAS74B,GAAY,IACzBqgC,EADwB,YACFxO,KAAKqL,WADH,MAGjC,MAA0B,SAAnBrL,KAAK7xB,UACRqgC,EACArgC,EAAY64B,EAAUhH,KAAK3vB,YAAc22B,EAAU,KAhlBY,oCAolBnEhH,KAAK4G,aAAepL,IACjBl5B,OADiB,YACN09B,KAAK2G,SAASrkC,WACzBG,MAFiB,YAEPu9B,KAAK2G,SAASlkC,UAE3B,IAAM+1B,EAAQrvB,OAAOrI,OAAOk/B,KAAKiG,cAE3Be,EAAUX,GAAW7N,GAPf,EAQQwH,KAAKwL,aAAaxE,GAA/B74B,EARK,sBAUmC6xB,KAAKyO,YAAYjW,EAAO,CACrEyU,QAASjG,EACT/2B,SAAU+vB,KAAK/vB,SACf9B,cAbU,mBAUL84B,EAVK,KAUMyH,EAVN,KAUoBC,EAVpB,KAgBNlB,EAAkB1G,GACtBC,EACAC,EACAjH,KAAK/vB,UAGD29B,EAAU5N,KAAK4O,cACnB5H,EACAyG,EACAzN,KAAK/vB,UAGD4+B,EAAW,IAAInwC,EAAKowC,aAAa,CACrCC,WAAW,GAAD,mBAAM/O,KAAKyJ,kBAAX,CAA6B,IACvCuF,UAAW,CAAC,EAAK,EAAK,EAAK,GAC3BC,cAAejP,KAAK2J,aACpBuF,iBAAkBlP,KAAK4J,gBACvBuF,OAAQ,IACRC,OAAQ,IAGJC,EAAS3wC,EAAK4wC,OAAOhK,KAAKO,GAAIC,GAAI+I,GAElCU,EAAW,IAAI7wC,EAAK8wC,SAEpBC,EAAmBzP,KAAK/vB,SAAW,EAAI,EAC7Cs/B,EAASG,aACP,gBACAzI,EACA,GACA,EACAvoC,EAAKixC,MAAMC,MAPK,EAQhBjK,GACA,GAEF4J,EAASG,aACP,gBACAzI,EACA,GACA,EACAvoC,EAAKixC,MAAMC,MAhBK,EAiBhBjK,GAjBgB,EAmBhBA,GAA0B8J,GAE5BF,EAASG,aACP,gBACAzI,EACA,GACA,EACAvoC,EAAKixC,MAAMC,MACG,EAAdjK,GA3BgB,EA6BhBA,GAA0B8J,EAAmB,GAE/CF,EAASG,aAAa,cAAef,EAAa,GAClDY,EAASG,aAAa,cAAehB,EAAc,GACnDa,EAASM,SAASjC,GAElB,IAAMkC,EAAO,IAAIpxC,EAAKqxC,KAAKR,EAAUF,GAE/BW,EAAc,IAAItxC,EAAKipC,SAC7BqI,EAAYnI,SAASiI,GAGrB9P,KAAKiQ,MAAMtpC,EAAIq5B,KAAK3pC,SAAS,GAEzB2pC,KAAKkQ,eACPlQ,KAAKiQ,MAAM1qB,YAAYya,KAAKkQ,cAC5BlQ,KAAKkQ,aAAa9oC,WAGpB44B,KAAKiQ,MAAMpI,SAASmI,GACpBhQ,KAAKkQ,aAAeF,EAEpBtJ,GAAc1G,KAAKkQ,aAAclQ,KAAKqN,QAASrN,KAAK4G,cAEpD5G,KAAKuF,OACLvF,KAAKuE,YAjrB8D,+CAsrBnEvE,KAAKmQ,sBACAnQ,KAAKoQ,oBACVpQ,KAAKwK,eACLxK,KAAKqQ,iBAzrB8D,4CA4rB9C,IAAD,cACArQ,KAAK3pC,SADL,GACbK,EADa,KACPH,EADO,KAEpBypC,KAAK0H,SAASrxC,SAASsQ,EAAIjQ,EAAO,EAClCspC,KAAK0H,SAASrxC,SAASqJ,EAAInJ,EAAM,EAE7BypC,KAAKsQ,SAAS71B,KAChBulB,KAAK0H,SAASG,SAAS7H,KAAK8H,eAE5B9H,KAAK0H,SAASniB,YAAYya,KAAK8H,iBApsBkC,qCAysBnE,uEACA9H,KAAKmQ,wBA1sB8D,kCA6sBzDI,GACV,qEAAkBA,GADK,kBAG0BvQ,KAAK3pC,SAH/B,GAGtB2pC,KAAKiQ,MAAM55C,SAASsQ,EAHE,KAGCq5B,KAAKiQ,MAAM55C,SAASqJ,EAHrB,OA7sB4C,6BAmtB9D8wC,EAAWC,GAChBzQ,KAAK2G,OAAO6J,GACZxQ,KAAK5tB,OAAOq+B,GAERzQ,KAAKkQ,cACPxJ,GAAc1G,KAAKkQ,aAAcM,EAAWxQ,KAAK4G,cAGnD5G,KAAK0Q,eACL1Q,KAAKuF,SA5tB8D,qCAquBtDoL,EAAQC,GAAS,IAAD,OAC7B,IAAK5Q,KAAKoQ,kBAAmB,MAAO,GAEpC,IAAMnY,EAAY+H,KAAK6Q,qBAEjB7J,EAAUX,GAAWrG,KAAKiG,cALH,EAMHjG,KAAKwL,aAAaxE,GAAnCyE,EANoB,oBASvB1kC,EAAYwgC,EAAUuJ,mBAC1B9Q,KAAK75B,YACL8xB,EACA+H,KAAK75B,YAAY4E,WAIbo9B,EAAUnI,KAAKqN,QAAQ0D,OAAOJ,GAAU5pC,EAG1CiqC,EACFhR,KAAK75B,YAAY4E,WAAao9B,EAAUtpC,KAAKu5B,MAAM+P,IAI/C4C,EAAWlsC,KAAKu5B,MACpBv5B,KAAKC,IAAI,GAAI8xC,EAAS5Q,KAAK3vB,YAAco7B,IAErCwF,EAAejR,KAAKzvB,cAAcw6B,GAClCpV,EAASqK,KAAKkR,cAAc,CAACjZ,EAAWp5B,KAAKu5B,MAAM+P,KACnDgJ,EAAcnR,KAAKiG,aAAatQ,GAChCyb,EACJvyC,KAAKu5B,MAAM4Y,GAAcnyC,KAAKu5B,MAzyBpB,IAyyBsC4H,KAAK9vB,gBAEnD1K,EAAO,GACPpQ,EAAQ,mBAEZ,QAAqBK,IAAjBw7C,EAA4B,OAAOzrC,EAEvC,GAAI2rC,EAAa,CACVnR,KAAK75B,YAAY0lC,QACpBmF,EACEG,EAAYhL,SAASiG,MAAM9yC,QAAU6uC,EAAUtpC,KAAKu5B,MAAM+P,KAG9D,IAAIrhC,EAAQ,KA6BZ,GArBIA,EAPAk5B,KAAK75B,YAAY0lC,MAGjB/5B,MAAMC,QAAQk/B,IAC+B,WAA7CjR,KAAK9jC,QAAQm1C,4BAGLJ,EAAal1C,KACnB,SAACu1C,GAAD,OACE,EAAKnrC,YAAY0lC,MAAM,GAAKyF,EAAOzyC,KAAKu5B,MAAM4Y,MAGlDC,GAC6C,WAA7CjR,KAAK9jC,QAAQm1C,4BAGXrR,KAAK75B,YAAY0lC,MAAM,GAAKoF,EAAepyC,KAAKu5B,MAAM4Y,GAItDhR,KAAK75B,YAAY0lC,MAAM,GAAKd,EAAWlsC,KAAKu5B,MAAM4Y,GAIpDG,EAAYhL,SAASiG,MAAM9yC,OAASyxC,EACpClsC,KAAKu5B,MAAM4Y,GAGXl/B,MAAMC,QAAQjL,GAAQ,CACxB,IAAMhG,EAASgG,EAAM/K,KAAI,SAACC,GAAD,OAAOm1C,EAAYhL,SAASiG,MAAMpwC,MAE3DwJ,EADApQ,EAAQgyC,EAAO,MAAPA,CAAcpH,KAAKiJ,wBAAwBnoC,IAGnD0E,GAAQ,QACRA,GAAI,UAAOsB,EAAMxN,OAAb,iBAA4B0mC,KAAK9jC,QAAQ8sC,gCAK7CxjC,EAHApQ,EAAQgyC,EAAO,MAAPA,CACN+J,EAAYhL,SAAS+F,YAAYnB,GAAUqG,IAIzCt/B,MAAMC,QAAQk/B,KAChB77C,GAAS,QACTA,GAAK,UAAO67C,EAAa33C,OAApB,iBAAmC0mC,KAAK9jC,QAAQ8sC,4BAM3D,GAAIhJ,KAAK75B,YAAY2kC,UAAW,CAC9B,IAAIyG,EAAU,QAEO97C,IAAjBw7C,IACFM,EAAUvR,KAAK75B,YAAY2kC,UAAUmG,IAGvC,IAAMj3C,EACe,kBAAZu3C,EACHvR,KAAKxvB,gBAAgB+gC,EAAQ11C,IAC7B01C,EAEAj9C,EAAQ0rC,KAAKrvB,cAAc3W,GAC7BgmC,KAAKrvB,cAAc3W,GAAO2V,gBAC1B9H,GACEm4B,KAAKrvB,cAAc3W,GAAO8M,MAAQe,GAAuBvO,QAE3D,UAEE1C,EAAaopC,KAAKrvB,cAAc3W,GAClCgmC,KAAKrvB,cAAc3W,GAAO2V,gBAC1B7H,GACEk4B,KAAKrvB,cAAc3W,GAAO8M,MAAQgB,GAAwBxO,QAE5D,UAEJ,MAAM,iEAAN,OAAwE1C,EAAxE,mCAA6GtC,EAA7G,cAAwH0F,EAAxH,sBAA2I5E,EAA3I,UAGF,OAAOoQ,IAh2B4D,uCA62BpDmrC,EAAQC,GACvB,OAAK5Q,KAAK75B,YAEH65B,KAAKwR,eAAeb,EAAQC,GAFL,KA92BqC,kCAo3BnE,IAAMa,EAAQ,6BAEVtgC,EAAQ,KACRugC,EAAO,KAJD,yFAMTA,EANS,KAMHvgC,EANG,KAQVugC,EAAKC,aAAa,QAAS,oBAC3B,IAAMC,EAAS7sB,SAASC,cAAc,KAEtC7T,EAAMkU,YAAYusB,GAClBA,EAAOD,aACL,YADF,oBAEe3R,KAAK3pC,SAAS,GAF7B,aAEoC2pC,KAAK3pC,SAAS,GAFlD,MAKA,IAAMmiC,EAAQrvB,OAAOrI,OAAOk/B,KAAKiG,cAE3Be,EAAUX,GAAW7N,GAnBjB,EAoBUwH,KAAKwL,aAAaxE,GAA/B74B,EApBG,oBAqBJ0jC,EAAS7R,KAAK/vB,SAAW,EAAI,EArBzB,EAuBU+vB,KAAKyO,YAAYjW,EAAO,CAC1CyU,QAASjG,EACT/2B,SAAU+vB,KAAK/vB,SACf9B,cAHK84B,EAvBG,oBA6BJ6K,EAAaC,eAChBprC,GAAE,SAACggB,GAAD,OAAOA,EAAE,MACXjnB,GAAE,SAACinB,GAAD,OAAOA,EAAE,MAERqrB,EAAY/K,EAAU3tC,OAAS0tC,EAE/BiL,EAAc,SAACpwC,GAKnB,IAJA,IAAMqwC,EAAM,GACNztC,EAAQotC,EACRntC,EAAM7C,EAAIvI,OAASu4C,EAEhB71C,EAAIyI,EAAOzI,EAAI0I,EAAK1I,GAAK61C,EAChCK,EAAIzgC,KAAK,CAAC5P,EAAI7F,GAAI6F,EAAI7F,EAAI,KAG5B,OAAOk2C,GAGLzjC,EAAOuxB,KAAK/vB,SACX+vB,KAAK9jC,QAAQkU,YAAc4vB,KAAK9jC,QAAQkU,WAAW,IAAO,UAC3D,OACJ,GAAI4vB,KAAK/vB,UAAY+vB,KAAK9jC,QAAQkU,WAAY,CAC5C,IAAM+hC,EAAYnS,KAAK9jC,QAAQkU,WAAW9W,OACpC84C,EAAOrtB,SAASstB,gBAAgBZ,EAAO,QACvCa,EAAiBvtB,SAASstB,gBAC9BZ,EACA,kBAEFa,EAAeX,aAAa,KAAM,qBAClCW,EAAeX,aAAa,KAAM,KAClCW,EAAeX,aAAa,KAAM,KAClCW,EAAeX,aAAa,KAAM,KAClCW,EAAeX,aAAa,KAAM,KAClC3R,KAAK9jC,QAAQkU,WAAWjR,SAAQ,SAAC7K,EAAO0H,GACtC,IAAMu2C,EAAOxtB,SAASstB,gBAAgBZ,EAAO,QAC7Cc,EAAKZ,aACH,SADF,UAEK9yC,KAAKy9B,MAAOtgC,GAAKm2C,EAAY,GAAM,KAFxC,MAIAI,EAAKZ,aAAa,aAAcr9C,GAChCg+C,EAAejtB,YAAYktB,MAE7BH,EAAK/sB,YAAYitB,GACjBZ,EAAKc,aAAaJ,EAAMV,EAAKe,YAC7BhkC,EAAO,0BAGT,IAAK,IAAIzS,EAAI,EAAGA,EAAIgrC,EAAShrC,IAAK,CAChC,IAAMk2C,EAAMD,EACVhL,EAAUoF,SAASrwC,EAAIg2C,GAAYh2C,EAAI,GAAKg2C,IAGxCU,EAAI3tB,SAASC,cAAc,QAC7B2B,EAAImrB,EAAWI,GAEbS,EAAK3S,KAAKgN,SAAShxC,GAAKgkC,KAAK8M,gBAAgB,EAAG9wC,GAIhD42C,EAAajsB,EAAEjlB,QAAQ,KACvBmxC,GAAUlsB,EAAEvkB,UAAU,EAAGwwC,GACzBE,GAAUnsB,EAAEvkB,UAAUwwC,EAAa,EAAGjsB,EAAEjlB,QAAQ,MAEhDqxC,GADNpsB,EAAC,WAAOksB,EAAS,EAAhB,YAAqBF,EAArB,YAA2BE,EAAS,EAApC,YAAyCC,EAAzC,YAAmDnsB,EAAEvkB,UAAU,KAC5C4e,YAAY,KAC1BgyB,GAASrsB,EAAEvkB,UAAUukB,EAAE3F,YAAY,KAAO,EAAG+xB,GAC7CE,GAAStsB,EAAEvkB,UAAU2wC,EAAY,GACvCpsB,GAAC,WAAQqsB,EAAQ,EAAhB,YAAqBC,EAArB,YAA8BD,EAAQ,EAAtC,YAA2CL,GAE5CD,EAAEf,aAAa,IAAKhrB,GACpB+rB,EAAEf,aAAa,OAAQljC,GACvBikC,EAAEf,aAAa,SAAU3R,KAAK9jC,QAAQuN,WAAa,SACnDipC,EAAEf,aAAa,gBAAiB3R,KAAK9jC,QAAQyN,UAAY,GAAK,GAE9DioC,EAAOvsB,YAAYqtB,GAGrB,MAAO,CAAChB,EAAMvgC,OA59BqD,GAgC1C8yB,EAAIl4B,OAAOmnC,2BAhC+B,mBAANxiC,EAAM,iCAANA,EAAM,kBAg+BvE,OAAO,aAAI82B,EAAkB92B,IAG/Bw2B,GAAqBrtB,OAAS,CAC5Bxb,KAAM,aACN80C,SAAU,CAAC,YACXC,YAAa,KACbx7C,KAAM,aAGOsvC,UChnCT7Q,GAAa,SAACtzB,EAAGC,GAAJ,OAAUD,EAAE,GAAKC,EAAE,IAAMD,EAAE,IAAMC,EAAE,IAEhD6iC,GAAE,ofAsBFC,GAAE,4eAqBFuN,GAAkB,SAACC,GAAD,MAAQ,CAE9BA,EAAGC,GAAKD,EAAGE,UAAWF,EAAG5zC,EAEzB4zC,EAAGC,GAAKD,EAAGE,UAAWF,EAAG5zC,EAEzB4zC,EAAGC,GAAKD,EAAGE,UAAWF,EAAG5zC,EAAI4zC,EAAG/7C,OAGhC+7C,EAAGC,GAAKD,EAAGE,UAAWF,EAAG5zC,EAAI4zC,EAAG/7C,SAI5Bk8C,GAAe,SAACH,EAAIt3C,GACxB,IAAM01C,EAAW,EAAJ11C,EACb,MAAO,CAAC01C,EAAMA,EAAO,EAAGA,EAAO,EAAGA,EAAO,EAAGA,EAAO,EAAGA,IAGlDgC,GAAiB,SAACJ,GAAD,MAAQ,CAACA,EAAGzkB,QAASykB,EAAGzkB,QAASykB,EAAGzkB,QAASykB,EAAGzkB,UAEjE8kB,GAAmB,SAACL,GAAD,MAAQ,CAC/BA,EAAGM,UACHN,EAAGM,UACHN,EAAGM,UACHN,EAAGM,YAGCC,GAAkB,SAAC92C,GAAD,OACtB8B,KAAKkB,KACFhD,EAAK2I,OAAO,KACT3I,EAAK2I,OAAO,IAAM3I,EAAK2I,OAAO,IAAM,IACpC3I,EAAK2I,OAAO,KAAO3I,EAAK2I,OAAO,IAAM3I,EAAK2I,OAAO,IAAM,KAGzDouC,GAAiB,SAAC7N,GAAD,OACrB98B,OAAOrI,OAAOmlC,GAAc7iC,QAC1B,SAAC05B,EAAS5F,GAAV,OACEr4B,KAAKC,IACHg+B,EACA5F,EAAKiP,SAAS/iC,QACZ,SAAC2wC,EAAah3C,GAAd,OAAuB8B,KAAKC,IAAIi1C,EAAah3C,EAAK28B,YAClD,MAGN,IAGEsa,GAAwB,SAACz0C,EAAUonC,EAAQC,GAC/C,IAAMC,GACHD,EAAatkC,SAAS,GAAKskC,EAAatkC,SAAS,KACjDqkC,EAAOrkC,SAAS,GAAKqkC,EAAOrkC,SAAS,IAGlCwkC,EAFWH,EAAOrkC,SAASvG,IAAI6qC,GAEV,GAC3BrnC,EAAS8D,MAAMsD,EAAIkgC,EACnBtnC,EAASlJ,SAASsQ,GAAKmgC,EAAYD,GAG/BoN,GAAc,SAACl3C,GAAD,gBACfA,EAAK2I,OAAO,GADG,YACG3I,EAAK2I,OAAO,GADf,YACqB3I,EAAK2I,OAAO,KAE/CwuC,GAA2B,SAASA,EACxCjQ,GAGA,KAAI,gBAJoCiQ,EAIpC,yBACF,MAAM,IAAIx+C,MACR,yEAHJ,QAOQgJ,EAASulC,EAAIkD,UAAbzoC,KAPR,EAQkCulC,EAAIkD,UAAUG,QAAxC9L,EARR,EAQQA,YAAaH,EARrB,EAQqBA,SACbkM,EAActD,EAAIE,SAAlBoD,UACA4M,EAAoBlQ,EAAImQ,QAAxBD,gBAEFE,EAAkBhZ,IACrB/4B,OAAO,CAAC,EAAG,KACXG,MAAM,CAAC,GAAK,IACZ64B,OAAM,GAEHgZ,EAjBN,oDAkBE,WAAYh/C,EAAS4G,GAAU,IAAD,wBAC5B,cAAM5G,EAAS4G,IAEVq4C,QAAU,IAAI71C,EAAKipC,SACxB,EAAKC,QAAQC,SAAS,EAAK0M,SAE3B,EAAKC,UAAYje,IACjB,EAAKke,WAAale,IAIlB,EAAKuI,GAAK,IAAIpgC,EAAKwsC,OAAOxsC,EAAKU,QAAQ+rC,OAXX,kBAYM,EAAKE,WAZX,GAY3B,EAAKvM,GAAGh/B,MAZmB,KAYZ,EAAKg/B,GAAGvnC,OAZI,KAa5B,EAAKunC,GAAG4V,aAAc,EACtB,EAAK5V,GAAG6V,qBAAsB,EAC9B,EAAK7V,GAAG8V,MAAQ,EAEhB,IAAIC,EAAgBC,YAAYC,MAjBJ,OAkB5B,EAAKjW,GAAGkW,UAAY,WAClBH,EAAgBC,YAAYC,OAE9B,EAAKjW,GAAGmW,QAAU,SAACtjB,GACbmjB,YAAYC,MAAQF,EAAgBV,GACtC,EAAKe,aAAavjB,IAGtB,EAAK8V,gBAEL,EAAKC,SAAW,IAAIhpC,EAAKipC,SACzB,EAAKD,SAASrxC,SAASsQ,EAAI,EAC3B,EAAK+gC,SAASrxC,SAASqJ,EAAI,EAC3B,EAAKkoC,QAAQC,SAAS,EAAKH,UAE3B,EAAKI,cAAgB,IAAIppC,EAAKqpC,KAAK,kBAAmB,CACpD9wC,SAAU,EAAK+wC,WAAa,GAC5Bv5B,KAAM,UAER,EAAKi5B,SAASG,SAAS,EAAKC,eArCA,EAlBhC,sDA0DW5Q,GAGPA,EAAKie,aAAe,IAAI5vC,KAFN,IAIlB2xB,EAAKiP,SAAShnC,SAAQ,SAACpC,EAAMf,GAC3Be,EAAK28B,SAAWma,GAAgB92C,KAAU,EAC1CA,EAAKw2C,GAAKx2C,EAAKyC,QAAUzC,EAAK0C,KAAO1C,EAAKyC,QAAU,EACpDzC,EAAKq4C,SAAWnB,GAAYl3C,GAC5BA,EAAKs4C,cAAgBt4C,EAAKyC,OAASzC,EAAK0C,KACxCy3B,EAAKie,aAAarvC,OAAO,CAAC/I,EAAKyC,OAAQzC,EAAK0C,MAAOzD,QApEzD,mDAwEgC,IAAD,OAC3B,IAAKgkC,KAAK9jC,QAAQ2R,eAOhB,OANAmyB,KAAK93B,mBAAgBzS,EACrBuqC,KAAKsV,qBAAkB7/C,EACvBuqC,KAAKuV,kBAAe9/C,EACpBuqC,KAAKwV,UAAY,EACjBxV,KAAKyV,cAAgB,OACrBzV,KAAK0V,YAAc,IAIrB1V,KAAK93B,cAAgB83B,KAAK9jC,QAAQ2R,eAAe3F,cACjD83B,KAAK2V,YAAc,SAAC54C,GAAD,OACjBA,EAAK2I,OAAO,EAAKwC,eAAevP,eAClCqnC,KAAKsV,gBAAkB,IAAIxQ,IAC3B9E,KAAK4V,YAAc,IAAI9Q,IACvB9E,KAAK6V,YAAc,IAAI/Q,IACvB9E,KAAKuV,aAAe,IAAIzQ,IAExB9E,KAAK8V,WAAa9V,KAAK9jC,QAAQ2R,eAAexF,OAAOtM,KACnD,SAACjE,GAAD,OACEA,EAAMwQ,WAAWpQ,QAAO,SAACwX,GAAD,OAAc,EAAKqmC,YAAYrmC,MACpDpW,UAEP0mC,KAAKgW,eAAiBhW,KAAK9jC,QAAQ2R,eAAexF,OAAOnQ,QACvD,SAACJ,EAAOkE,GAAR,OAAc,EAAK85C,WAAW95C,GAAK,KAErCgkC,KAAKwV,UAAYxV,KAAKgW,eAAe18C,OACrC0mC,KAAKyV,cAAgBzV,KAAK8V,WAAW1yC,QACnC,SAACqyC,EAAeQ,GAAhB,OAA8BR,EAAgBQ,IAC9C,GAEFjW,KAAK0V,YAAc1V,KAAK9jC,QAAQ2R,eAAexF,OAAOtM,KACpD,SAACjE,EAAOkE,GAAR,OAAclE,EAAMkC,OAAN,gBAAwBgC,MAGxC,IAAI8xC,EAAI,EACR9N,KAAK9jC,QAAQ2R,eAAexF,OAAOlJ,SAAQ,SAACrH,EAAOkE,GACjD,EAAKu5C,aAAahoC,IAAIvR,EAAG,CACvBioC,EAAIsF,MAAMC,WACR1xC,EAAMxD,OAASsT,GAAkB5L,EAAI4L,GAAkBtO,SAEzD2qC,EAAIsF,MAAMC,WACR1xC,EAAMvD,iBACJuT,GAAwB9L,EAAI8L,GAAwBxO,SAExD2qC,EAAIsF,MAAMC,WACR1xC,EAAMvD,iBACJsT,GAAuB7L,EAAI6L,GAAuBvO,WAGxDxB,EAAMwQ,WACHpQ,QAAO,SAACwX,GAAD,OAAc,EAAKqmC,YAAYrmC,MACtCvQ,SAAQ,SAACuQ,EAAUmmB,GAClB,IAAMsF,EAAMzrB,EAAS/W,cACrB,EAAK28C,gBAAgB/nC,IAAI4tB,EAAKn/B,GAC9B,EAAK45C,YAAYroC,IAAI4tB,EAAK2S,EAAIjY,GAC9B,EAAKggB,YAAYtoC,IAAIugC,EAAIjY,EAAGsF,MAEhC2S,GAAK,EAAKgI,WAAW95C,MAGvBgkC,KAAKkW,oBAAsBlW,KAAK0V,YAAY35C,KAC1C,SAAC/B,EAAOgC,GAAR,OACE,IAAI0C,EAAKqpC,KAAK/tC,EAAO,CACnB/C,SAAU,EAAK+wC,UACf7rB,MAA0B,UAAnB,EAAK1O,UAAwB,QAAU,OAC9CgB,KAAMw1B,EAAIsF,MAAMC,WACd,EAAKttC,QAAQ2R,eAAexF,OAAOrM,GAAG2T,gBACpC9H,GAAuB7L,EAAI6L,GAAuBvO,gBA7IhE,sCAmJmB,IAAD,OA+Ed,OA9EA0mC,KAAKvyB,UAAYuyB,KAAK9jC,QAAQuR,WAAa,OAE3CuyB,KAAKh2B,WAAai6B,EAAIsF,MAAMC,WAC1BxJ,KAAK9jC,QAAQ8N,YAAc,SAG7Bg2B,KAAKgI,UAAYhI,KAAK9jC,QAAQ8rC,WAAa,GAE3ChI,KAAKv2B,UAAYw6B,EAAIsF,MAAMC,WAAWxJ,KAAK9jC,QAAQuN,WAAa,SAEhEu2B,KAAKyJ,iBAAmBzJ,KAAK9jC,QAAQuN,UACjCw6B,EAAIsF,MACDG,YAAY1J,KAAK9jC,QAAQuN,WACzBjG,MAAM,EAAG,GACTzH,KAAI,SAAC4K,GAAD,OAAO9H,KAAKmU,IAAI,EAAGnU,KAAKC,IAAI,EAAG6H,EAAI,SAC1C,CAAC,EAAG,EAAG,GAEXq5B,KAAKp2B,YAAckJ,OAAOC,OAAOitB,KAAK9jC,QAAQ0N,aAC1C,EACA/K,KAAKmU,IAAI,EAAGnU,KAAKC,IAAI,GAAIkhC,KAAK9jC,QAAQ0N,cAE1Co2B,KAAKr2B,SAAWq2B,KAAK9jC,QAAQyN,UAAY,EACzCq2B,KAAK/xB,aAAe+xB,KAAK9jC,QAAQ+R,cAAgB+xB,KAAKr2B,SACtDq2B,KAAK9xB,WAAa8xB,KAAK9jC,QAAQgS,YAAc8xB,KAAKr2B,SAElDq2B,KAAK7xB,UAAY6xB,KAAK9jC,QAAQiS,WAAa6xB,KAAK9xB,WAEhD8xB,KAAKjyB,mBAAqBk2B,EAAIsF,MAAMC,WAClCxJ,KAAK9jC,QAAQ6R,oBAAsB,OAGrCiyB,KAAKmW,0BAA4BnW,KAAK9jC,QAAQ6R,mBAC1Ck2B,EAAIsF,MACDG,YAAY1J,KAAK9jC,QAAQ6R,oBACzBvK,MAAM,EAAG,GACTzH,KAAI,SAAC4K,GAAD,OAAO9H,KAAKmU,IAAI,EAAGnU,KAAKC,IAAI,EAAG6H,EAAI,SAC1C,CAAC,EAAG,EAAG,GAEXq5B,KAAKhyB,qBAAuBi2B,EAAIsF,MAAMC,WACpCxJ,KAAK9jC,QAAQ8R,sBAAwB,WAGvCgyB,KAAKoW,4BAA8BpW,KAAK9jC,QAAQ8R,qBAC5Ci2B,EAAIsF,MACDG,YAAY1J,KAAK9jC,QAAQ8R,sBACzBxK,MAAM,EAAG,GACTzH,KAAI,SAAC4K,GAAD,OAAO9H,KAAKmU,IAAI,EAAGnU,KAAKC,IAAI,EAAG6H,EAAI,SAC1C,CAAC,GAAK,GAAK,IAEfq5B,KAAKn2B,iBAAmBiJ,OAAOC,OAAOitB,KAAK9jC,QAAQ2N,kBAC/Cm2B,KAAKp2B,YACL/K,KAAKmU,IAAI,EAAGnU,KAAKC,IAAI,GAAIkhC,KAAK9jC,QAAQ2N,mBAE1Cm2B,KAAKqW,UACHrW,KAAK9jC,QAAQhE,QAAU8nC,KAAK9jC,QAAQhE,OAAOqV,IACvCyyB,KAAK9jC,QAAQhE,OAAOqV,IAAInK,QAAO,SAACkQ,EAAGgjC,GAEjC,OADAhjC,EAAEE,IAAI8iC,GACChjC,IACN,IAAIvC,KACP,KAENivB,KAAKuW,YAAcvW,KAAK9jC,QAAQhE,QAAU8nC,KAAK9jC,QAAQhE,OAAOoS,MAE9D01B,KAAK+V,YAAc/V,KAAKqW,UACpB,SAACjhD,GAAD,OAAW,EAAKihD,UAAU5iC,IAAIre,IAC9B,kBAAM,GAEV4qC,KAAKwW,WACHxW,KAAK+V,aAAe/V,KAAKuW,YACrB,SAACx5C,GAAD,OAAU,EAAKg5C,YAAYh5C,EAAK2I,OAAO,EAAK6wC,eAC5C,kBAAM,GAEZvW,KAAKyW,cAAgBzW,KAAK9jC,QAAQyR,gBAC9B,SAAC5Q,GAAD,OAAWA,EAAK2I,OAAO,EAAKxJ,QAAQyR,kBACpC,SAAC5Q,GAAD,OAAUA,EAAK28B,UAEnBsG,KAAKpP,gBAAkBoP,KAAK9jC,QAAQ00B,iBAAmB,QAE/CoP,KAAKpP,iBACX,IAAK,YACHoP,KAAK0W,aAAe,iBAAM,IAC1B,MAEF,IAAK,oBACL,IAAK,oBACH,IAAM9oC,EAAmBoyB,KAAK9jC,QAAQ0R,kBAAoB,CAAC,EAAG,KACxD+oC,EAAqBnb,IACxBl5B,OAAOsL,GACPnL,MAAM,CAAC,EAAG,KACbu9B,KAAK0W,aAAe,SAAC/vC,GAAD,OAAO0tC,EAAgBsC,EAAmBhwC,KAC9D,MAGF,IAAK,QACL,QACEq5B,KAAK0W,aAAe,kBAAM,GAI9B1W,KAAK/yB,YAAc+yB,KAAK9jC,QAAQ+Q,YAC5B+yB,KAAK9jC,QAAQ+Q,YACb,CAACspB,IAAUA,KAEfyJ,KAAK4W,UAAY5W,KAAK9jC,QAAQ+Q,YAC1B,SAAClQ,GAAD,MAAU,CAACA,EAAKyC,OAAQzC,EAAK0C,YAC7BhK,EAEJuqC,KAAKnW,UAAYmW,KAAK9jC,QAAQ2tB,UAC1BmW,KAAK9jC,QAAQ2tB,UAAUlxB,mBACvBlD,EAEJuqC,KAAK6W,QAAU7W,KAAK9jC,QAAQmS,UACxB,SAACtR,GAAD,OAAUA,EAAK2I,OAAO,EAAKxJ,QAAQmS,WAAW1V,oBAC9ClD,EAEJuqC,KAAKvP,WAAauP,KAAK9jC,QAAQu0B,WAC3BuP,KAAK9jC,QAAQu0B,WAAW93B,mBACxBlD,EAEJuqC,KAAK8W,cAAgB9W,KAAK9jC,QAAQ46C,eAAiB,EAEnD9W,KAAK+W,+BA7QT,+BAgRWvsB,GACPwV,KAAK9jC,QAAUsuB,EACfwV,KAAKyH,gBACLzH,KAAK2L,2BAnRT,wCAuRI,OAAOxiC,OAAOrI,OAAOk/B,KAAKiG,cAAc3sC,SAvR5C,qCA6RI,GAFqB6P,OAAOrI,OAAOk/B,KAAKiG,cAEtB3sC,OAAlB,CAHa,IAKJ/B,EALI,YAKMyoC,KAAKqL,WALX,MAObrL,KAAKlD,QAAUgX,GAAe9T,KAAKiG,cAEnCjG,KAAKgX,YAAcxb,IAChBl5B,OAAO,CAAC,EAAG09B,KAAKlD,UAChBr6B,MAAM,CAAC5D,KAAKmU,IAAI,GAAIzb,EAAS,IAAKA,IAErCyoC,KAAKiX,oBAAsBzb,IACxBl5B,OAAO,CAAC,EAAG09B,KAAKyV,gBAChBhzC,MAAM,CAAC,EAAGu9B,KAAKyV,cAAgBzV,KAAK7xB,YAEvC6xB,KAAK1B,WAAa9C,IACfl5B,OAAO,CAAC,EAAG09B,KAAKlD,UAChBr6B,MAAM,CAAClL,EAAQ,IAElByoC,KAAKkX,mBAAqB1b,IACvBl5B,OAAO,CAAC,EAAG09B,KAAKlD,UAChBr6B,MAAM,CAAC,EAAGlL,OAjTjB,8CAoT0BwF,EAAMo6C,GAC5B,MAAO,CACL5D,GAAIvT,KAAKqN,QAAQtwC,EAAKw2C,IACtB7zC,EAAGsgC,KAAKiX,oBACNjX,KAAK4V,YAAYvhC,IAAI2rB,KAAK2V,YAAY54C,KAExC8xB,QAASmR,KAAK0W,aAAa1W,KAAKyW,cAAc15C,IAC9C62C,UAAWuD,GAAkBp6C,EAAKq6C,QAClC5D,UAAW30C,KAAKC,IACdkhC,KAAK/xB,aAAe,EACpBpP,KAAKkB,IAAIigC,KAAKqN,QAAQtwC,EAAKyC,QAAUwgC,KAAKqN,QAAQtwC,EAAK0C,OAAS,GAElElI,OAAQyoC,KAAK9xB,WACbmpC,OAAQt6C,KAjUd,sCAqUmB,IAAD,OACd,OACEijC,KAAK6W,SACL7W,KAAKnW,WACLmW,KAAK4W,WACL5W,KAAK/yB,YAEE,SAAClQ,GAIN,OAHAA,EAAKq6C,QACH,EAAKP,QAAQ95C,KAAU,EAAK8sB,WAC5BwM,GAAW,EAAKugB,UAAU75C,GAAO,EAAKkQ,aACjClQ,EAAKq6C,SAIZpX,KAAK6W,SAAW7W,KAAKnW,UAChB,SAAC9sB,GAEN,OADAA,EAAKq6C,QAAU,EAAKP,QAAQ95C,KAAU,EAAK8sB,UACpC9sB,EAAKq6C,SAIZpX,KAAK4W,WAAa5W,KAAK/yB,YAClB,SAAClQ,GAEN,OADAA,EAAKq6C,QAAU/gB,GAAW,EAAKugB,UAAU75C,GAAO,EAAKkQ,aAC9ClQ,EAAKq6C,SAIT,SAACr6C,GAGN,OAFAA,EAAKq6C,SAAU,GAER,KArWb,6CAyWyBE,EAAeC,GAAQ,IAAD,OAC3C,MAAwB,iBAApBvX,KAAKvP,WACA,SAAC+mB,EAAez6C,EAAMf,GAG3B,OAFAs7C,EAAcv6C,GACV,EAAKy5C,WAAWz5C,IAAOw6C,EAAMC,EAAez6C,GACzCy6C,GAIJ,SAACA,EAAez6C,GAGrB,OAFIu6C,EAAcv6C,IAAS,EAAKy5C,WAAWz5C,IACzCw6C,EAAMC,EAAez6C,GAChBy6C,KArXb,gCAyXYL,GAAiB,IAAD,OACpBM,EAAa,GACbF,EAAQ,SAACG,EAAa36C,GAAd,OACV26C,EAAYjmC,KAAK,EAAKkmC,wBAAwB56C,EAAMo6C,KAEzB,sBAAzBnX,KAAKpP,iBACP6mB,EAAa,GACbF,EAAQ,SAACG,EAAa36C,GACpB,GAAI26C,EAAY36C,EAAKq4C,UAAW,CAC9B,IAAMwC,EAAK,EAAKnB,cAAciB,EAAY36C,EAAKq4C,UAAUiC,QAC9C,EAAKZ,cAAc15C,GACrB66C,IACPF,EAAY36C,EAAKq4C,UAAY,EAAKuC,wBAChC56C,EACAo6C,SAIJO,EAAY36C,EAAKq4C,UAAY,EAAKuC,wBAChC56C,EACAo6C,KAI4B,sBAAzBnX,KAAKpP,kBACd6mB,EAAa,GACbF,EAAQ,SAACG,EAAa36C,KAEjB26C,EAAY36C,EAAKq4C,WAClBr4C,EAAK28B,SAAWge,EAAY36C,EAAKq4C,UAAUiC,OAAO3d,YAElDge,EAAY36C,EAAKq4C,UAAY,EAAKuC,wBAChC56C,EACAo6C,MAMR,IAAMG,EAAgBtX,KAAK6X,gBACrBC,EAAc9X,KAAK+X,uBAAuBT,EAAeC,GAE/D,OAAOpuC,OAAOrI,OAAOk/B,KAAKiG,cAAct9B,SAAQ,SAACuuB,GAAD,OAC9C/tB,OAAOrI,OAAOo2B,EAAKiP,SAAS/iC,OAAO00C,EAAaL,SApatD,8CAyaIzX,KAAK4G,aAAepL,IACjBl5B,OADiB,YACN09B,KAAK2G,SAASrkC,WACzBG,MAFiB,YAEPu9B,KAAK2G,SAASlkC,UAE3B,IAAM00C,IACgB,iBAApBnX,KAAKvP,cACHuP,KAAKnW,WAAamW,KAAK6W,SACtB7W,KAAK/yB,aAAe+yB,KAAK4W,YAGxBoB,EAAShY,KAAKiY,UAAUd,GAExBlQ,EAAY,IAAI/nC,aAAa84C,EAAOrvC,QAAQ0qC,KAC5CzF,EAAU,IAAIsK,YAAYF,EAAOrvC,QAAQ8qC,KACzC0E,EAAY,IAAIj5C,aAAa84C,EAAOrvC,QAAQ+qC,KAC5C0E,EAAa,IAAIl5C,aAAa84C,EAAOrvC,QAAQgrC,KAE7C9E,EAAW,IAAInwC,EAAKowC,aAAa,CACrCuJ,OAAsB,UAAdlB,EAAc,YACdnX,KAAKoW,6BADS,YAEdpW,KAAKyJ,kBAFS,CACoBzJ,KAAKp2B,cAE/C0uC,gBAAgB,GAAD,mBAAMtY,KAAKmW,2BAAX,CAAsCnW,KAAKp2B,cAC1D2uC,cAAepB,IAGX9H,EAAS3wC,EAAK4wC,OAAOhK,KAAKO,GAAIC,GAAI+I,GAElCU,EAAW,IAAI7wC,EAAK8wC,SAC1BD,EAASG,aAAa,YAAazI,EAAW,GAC9CsI,EAASG,aAAa,WAAYyI,EAAW,GAC7C5I,EAASG,aAAa,aAAc0I,EAAY,GAChD7I,EAASM,SAASjC,GAElB,IAAMkC,EAAO,IAAIpxC,EAAKqxC,KAAKR,EAAUF,GAE/BW,EAAc,IAAItxC,EAAKipC,SAC7BqI,EAAYnI,SAAS7H,KAAKlB,IAC1BkR,EAAYnI,SAASiI,GAtCC,kBAwCY9P,KAAKqL,WAxCjB,GAwCrBrL,KAAKlB,GAAGh/B,MAxCa,KAwCNkgC,KAAKlB,GAAGvnC,OAxCF,KA2CtByoC,KAAKiQ,MAAMtpC,EAAIq5B,KAAK3pC,SAAS,GAEzB2pC,KAAKwY,yBACPxY,KAAKwY,uBAAuBjzB,YAAYya,KAAKlB,IAC7CkB,KAAKiQ,MAAM1qB,YAAYya,KAAKwY,yBAG9BxY,KAAKiQ,MAAMpI,SAASmI,GACpBhQ,KAAKwY,uBAAyBxI,EAE9BgE,GACEhU,KAAKwY,uBACLxY,KAAKqN,QACLrN,KAAK4G,cAGP5G,KAAKuF,OACLvF,KAAKuE,YApeT,oDAueiC,IAAD,OACrBzkC,EADqB,YACZkgC,KAAKqL,WADO,oBAERrL,KAAK3pC,SAFG,GAErBK,EAFqB,KAEfH,EAFe,KAI5BypC,KAAK0K,MAAMr0C,SAASsQ,EAAuB,UAAnBq5B,KAAKvyB,UAAwB/W,EAAOoJ,EAAQpJ,EACpEspC,KAAK0K,MAAMr0C,SAASqJ,EAAInJ,EAExBypC,KAAK0K,MAAMlF,QACX,IAAI8F,EAAS,EACTmN,EAAO,EAELC,EAAiC,UAAnB1Y,KAAKvyB,WAAyB,EAAI,EAChDkrC,EAA8B,UAAnB3Y,KAAKvyB,WAAyB3N,EAAQA,EACjDyrC,EAAkC,UAAnBvL,KAAKvyB,WAAyB,EAAI,EACjDmrC,EAAgB5Y,KAAK0K,MAAMz1C,SAASqE,OAE1C0mC,KAAK0K,MAAMmO,UAAU,EAAG,EAAU,EAAK,GAEvC7Y,KAAKkW,oBAAoB/2C,SAAQ,SAAC25C,EAAe98C,GAC3C48C,EAAgB58C,EAAI,GACtB,EAAK0uC,MAAM7C,SAASiR,GAMtB,IAAMtzC,EAAO,EAAKklC,MAAMz1C,SAAS+G,GAEjC,GAA2B,IAAvB,EAAK85C,WAAW95C,GAApB,CAKA,IAAMzE,EAAS,EAAK0/C,oBAAoB,EAAKnB,WAAW95C,IACxDy8C,GAAQlhD,EACRiO,EAAKmB,EAAI4kC,EACT/lC,EAAK9F,EAAI4rC,EAAS/zC,EAAS,EAC3BiO,EAAKoe,OAAOjd,EAAuB,UAAnB,EAAK8G,UAAwB,EAAI,EACjDjI,EAAKoe,OAAOlkB,EAAI,GAChB8F,EAAKovC,MAAQ,EAEmB,iBAA5B,EAAK14C,QAAQu0B,WACf,EAAKia,MAAMqO,UAAU,SAAU,KAE/B,EAAKrO,MAAMqO,UAAU,EAAKxD,aAAalhC,IAAIrY,GAAG,GAAI,KAGpD,EAAK0uC,MAAMmO,UAAU,GACE,UAAnB,EAAKprC,UACP,EAAKi9B,MAAMsO,SACTxzC,EAAKmB,EAAInB,EAAK1F,MACd0F,EAAK9F,EAAI8F,EAAKjO,OAAS,EACvBiO,EAAK1F,MACL0F,EAAKjO,QAGP,EAAKmzC,MAAMsO,SACTxzC,EAAKmB,EACLnB,EAAK9F,EAAI8F,EAAKjO,OAAS,EACvBiO,EAAK1F,MACL0F,EAAKjO,QAGT,EAAKmzC,MAAMuO,UAEX,EAAKvO,MAAMmO,UAAU,EAAG,EAAU,EAAK,GACvC,EAAKnO,MAAMxqC,OAAO,EAAGorC,GACrB,EAAKZ,MAAMvqC,OAAOu4C,EAAapN,GAE3B,EAAKpvC,QAAQ2R,eAAe1F,wBAC9B7I,GAAc,EAAKorC,MAAO,EAAGiO,EAAUrN,EAAQ,GAGjDA,EAASmN,OA5CPjzC,EAAKovC,MAAQ,KA+CjB5U,KAAK0K,MAAMxqC,OAAO,EAAG,GACrB8/B,KAAK0K,MAAMvqC,OAAO,EAAGs4C,GACrBzY,KAAK0K,MAAMvqC,OAAOu4C,EAAaD,GAE3BzY,KAAK9jC,QAAQ2R,eAAe1F,wBAC9B7I,GAAc0gC,KAAK0K,MAAO,EAAGiO,EAAUF,EAAM,KAxjBnD,8CA+jBI,GAFAzY,KAAKuU,QAAQ/O,SAEuC,IAAhDxF,KAAKpP,gBAAgBlvB,QAAQ,cAW/B,OAVIs+B,KAAKkZ,gBACPlZ,KAAKuU,QAAQhvB,YAAYya,KAAKkZ,eAC9BlZ,KAAKkZ,cAAc9xC,UACnB44B,KAAKkZ,mBAAgBzjD,QAEnBuqC,KAAKmZ,gBACPnZ,KAAKuU,QAAQhvB,YAAYya,KAAKmZ,eAC9BnZ,KAAKmZ,cAAc/xC,UACnB44B,KAAKmZ,mBAAgB1jD,IAKzB,IACOqK,EAlBe,YAkBNkgC,KAAKqL,WAlBC,oBAmBFrL,KAAK3pC,SAnBH,GAmBfK,EAnBe,KAmBTH,EAnBS,OAoBRypC,KAAKiX,oBAAoBx0C,QAA9B/C,EApBa,oBAqBhBw9B,EAA8C,UAA7B8C,KAAK9jC,QAAQ4R,YAC9BqpC,IACgB,iBAApBnX,KAAKvP,cACHuP,KAAKnW,WAAamW,KAAK6W,SACtB7W,KAAK/yB,aAAe+yB,KAAK4W,YAG9B5W,KAAKuU,QAAQl+C,SAASsQ,EAAIu2B,EAAiBxmC,EAAOoJ,EAAQpJ,EA5BpC,MA8BOspC,KAAK9jC,QAAQ0R,kBAAoB,CAAC,EAAG,KA9B5C,mBA8BfwrC,EA9Be,KA8BLlT,EA9BK,KAgClBrnC,KAAKkB,IAAIq5C,EAAWpZ,KAAKwU,WAAa7sC,KACpCq4B,KAAKkZ,gBACPlZ,KAAKuU,QAAQhvB,YAAYya,KAAKkZ,eAC9BlZ,KAAKkZ,cAAc9xC,WAErB44B,KAAKkZ,cAAgB,IAAIx6C,EAAKqpC,KAAKhmC,GAAQq3C,EAAU,GAAI,CACvDniD,SAAU+oC,KAAKgI,UACf7rB,MAAO+gB,EAAiB,QAAU,OAClCzuB,KAAM,UAERuxB,KAAKkZ,cAAcvyC,EAAI,EACvBq5B,KAAKkZ,cAAcx5C,EAAIrD,EACvB2jC,KAAKkZ,cAAct1B,OAAOjd,EAAIu2B,EAAiB,EAAI,EACnD8C,KAAKuU,QAAQ1M,SAAS7H,KAAKkZ,gBAGzBr6C,KAAKkB,IAAImmC,EAAWlG,KAAKyU,WAAa9sC,KACpCq4B,KAAKmZ,gBACPnZ,KAAKuU,QAAQhvB,YAAYya,KAAKmZ,eAC9BnZ,KAAKmZ,cAAc/xC,WAErB44B,KAAKmZ,cAAgB,IAAIz6C,EAAKqpC,KAAKhmC,GAAQmkC,EAAU,GAAI,CACvDjvC,SAAU+oC,KAAKgI,UACf7rB,MAAO+gB,EAAiB,QAAU,OAClCzuB,KAAM,UAERuxB,KAAKmZ,cAAcxyC,EAAI,EACvBq5B,KAAKmZ,cAAcz5C,EAAIrD,EACvB2jC,KAAKmZ,cAAcv1B,OAAOjd,EAAIu2B,EAAiB,EAAI,EACnD8C,KAAKuU,QAAQ1M,SAAS7H,KAAKmZ,gBAG7B,IACME,EAAerZ,KAAKkZ,cAAcI,YAAYx5C,MAC9Cy5C,EAAevZ,KAAKmZ,cAAcG,YAAYx5C,MAC9C05C,EAAStc,IACTqc,EAJkB,GA/CR,GAoDZF,EAAe,GAEbI,EAAa,GAtDH,EAsDStC,EAA4B,EAErDnX,KAAKuU,QAAQwE,UAAU,UACvB/Y,KAAKuU,QAAQsE,UAAU,EAAG,UACtB3b,GACF8C,KAAKkZ,cAAcvyC,EAAI6yC,EA3DT,EA4DdxZ,KAAKuU,QAAQmF,kBAbS,GAcAL,EAAeE,EAAe,GAAc,IAChE,EAfoB,GAgBFF,EAAeE,EAAe,GAChDE,EACA,KAGFzZ,KAAKmZ,cAAcxyC,EAAI6yC,EArBD,GAqB4B,GAClDxZ,KAAKuU,QAAQmF,gBACX,GACA,EAxBoB,GAyBFL,EAAeE,EAAe,GAChD,GAzEY,EAyENpC,EAA4B,EAClC,IAGJnX,KAAKuU,QAAQ0E,UACbjZ,KAAKuU,QAAQsE,UAAU,GAEvB,IAAK,IAAI78C,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,IAAM6yB,EAAUmR,KAAK0W,aAAa0C,EAAYp9C,EAAI,EAAKkqC,GAEvDlG,KAAKuU,QAAQwE,UAAU/Y,KAAKv2B,UAAWolB,GACvCmR,KAAKuU,QAAQyE,SACP,EAAJh9C,EAAQw9C,EACRn9C,EAAgC,GAAjB86C,EACf,EACA,GAEFnX,KAAKuU,QAAQ0E,UAET9B,IACFnX,KAAKuU,QAAQwE,UAAU/Y,KAAKjyB,mBAAoB8gB,GAChDmR,KAAKuU,QAAQyE,SAAa,EAAJh9C,EAAQw9C,EAAQn9C,GAAiB,EAAG,GAC1D2jC,KAAKuU,QAAQ0E,WAIb/b,GACF8C,KAAKkZ,cAAcvyC,EAAI6yC,EApGT,EAqGdxZ,KAAKmZ,cAAcxyC,GAAI,IAEvBq5B,KAAKkZ,cAAcvyC,EAAItK,EACvB2jC,KAAKmZ,cAAcxyC,EAAI6yC,EAzDD,GA/CR,GA2GhBxZ,KAAKuU,QAAQl+C,SAASqJ,EAAInJ,EAAMmJ,EA3GhB,EA2G8B+5C,IAxrBlD,yCA4rBIzZ,KAAK2Z,8BACL3Z,KAAK4Z,wBACL5Z,KAAK6Z,0BA9rBT,4CAisByB,IAAD,cACA7Z,KAAK3pC,SADL,GACbK,EADa,KACPH,EADO,KAEpBypC,KAAK0H,SAASrxC,SAASsQ,EAAIjQ,EAAO,EAClCspC,KAAK0H,SAASrxC,SAASqJ,EAAInJ,EAAM,EAE7BypC,KAAKsQ,SAAS71B,KAChBulB,KAAK0H,SAASG,SAAS7H,KAAK8H,eAE5B9H,KAAK0H,SAASniB,YAAYya,KAAK8H,iBAzsBrC,+CA+sBI9H,KAAKmQ,sBACAnQ,KAAKoQ,oBACVpQ,KAAKwK,eACLxK,KAAK8Z,sBAltBT,+BAstBW5iB,GAAO,IAAD,OAKb,GAJAA,EAAK33B,SAASimC,QAEdxF,KAAKmQ,uBAEAnQ,KAAK9jC,QAAQ2R,eAAezF,iBAAkB,CACjD,IAAIkjC,EAAS,EACTmN,EAAO,EACXzY,KAAK8V,WAAW32C,SAAQ,SAACsb,EAAMze,GAC7By8C,GAAQ,EAAKxB,oBAAoBx8B,GAEjCyc,EAAK33B,SAASw5C,UAAU,EAAKxD,aAAalhC,IAAIrY,GAAG,IACjDk7B,EAAK33B,SAASy5C,SACZ,EACA1N,EACA,EAAKD,WAAW,GAChBxsC,KAAKkB,IAAI04C,EAAOnN,IAGlBA,EAASmN,KAEXvhB,EAAK33B,SAAS05C,aA3uBpB,2CA+uBuBc,EAAMC,GAAO,IAAD,OAC/B,GAAKha,KAAK75B,YAAV,CAEA,IAAM8xB,EAAY+H,KAAK6Q,qBACjB9pC,EAAYwgC,EAAUuJ,mBAC1B9Q,KAAK75B,YACL8xB,EACA+H,KAAK75B,YAAY4E,WAIb4qB,EAASqK,KAAKkR,cAAc,CAChCjZ,EACAp5B,KAAKu5B,MAAM4H,KAAKqN,QAAQ0D,OAAOgJ,GAAQhzC,KAEnCoqC,EAAcnR,KAAKiG,aAAatQ,GAEtC,GAAKwb,EAAL,CAEA,IAOI8I,EAPEvqC,EAAWswB,KAAK6V,YAAYxhC,IAChCxV,KAAKu5B,MAAM4H,KAAKiX,oBAAoBlG,OAAOiJ,KAGvCE,EAASla,KAAKqN,QAAQ0D,OAAOgJ,EAAO,GACpCI,EAASna,KAAKqN,QAAQ0D,OAAOgJ,EAAO,GAY1C,OATA5I,EAAYgE,aAAax0C,OAAO,CAACu5C,EAAQC,IAASh7C,SAAQ,SAACoE,GACzD,IAAMxG,EAAOo0C,EAAYhL,SAAS5iC,GAClC,OAAI,EAAKoyC,YAAY54C,KAAU2S,IAC7BuqC,EAAYl9C,GACL,MAKJ,CACLA,KAAMk9C,EACNvqC,WACAimB,cAtxBN,uCA0xBmBokB,EAAMC,GACrB,IAAM1nB,EAAU0N,KAAKoa,qBAAqBL,EAAMC,GAEhD,IAAK1nB,EAAS,MAAO,GAHM,IAKnBv1B,EAAmBu1B,EAAnBv1B,KAAM2S,EAAa4iB,EAAb5iB,SAEd,GAAI3S,EAAM,CAAC,IAAD,EACaijC,KAAKuV,aAAalhC,IACrC2rB,KAAKsV,gBAAgBjhC,IAAI3E,IAFnB,mBACCovB,EADD,KACKt5B,EADL,KAIF60C,EAAQ,WAAO70C,EAAK80C,SAAS,KAC7BC,EAAK,WAAOzb,EAAGwb,SAAS,KACxBllD,EAAQ4qC,KAAKyW,cAAc15C,GAAMgF,QAAQ,GAC/C,MAAM,iEAAN,OAAwEw4C,EAAxE,mCAAwGF,EAAxG,cAAsH3qC,EAAtH,sBAA4Ita,EAA5I,UAGF,MAAO,KA3yBX,mCA8yBe0D,GAAQ,IAAD,cACSknC,KAAK3pC,SADd,GACXmkD,EADW,KACFC,EADE,KAEZV,EAAOjhD,EAAM4Y,KAAKgpC,OAAO/zC,EAAI6zC,EAC7BR,EAAOlhD,EAAM4Y,KAAKgpC,OAAOh7C,EAAI+6C,EAE7BnoB,EAAU0N,KAAKoa,qBAAqBL,EAAMC,GAE5C1nB,GACF0N,KAAKkE,OAAOh9B,QAAQ,YAAa,CAC/B7I,KAAM,aACNvF,QACAq4B,QAASmB,MAzzBjB,kCA8zBcie,GACV,qEAAkBA,GADK,kBAG0BvQ,KAAK3pC,SAH/B,GAGtB2pC,KAAKiQ,MAAM55C,SAASsQ,EAHE,KAGCq5B,KAAKiQ,MAAM55C,SAASqJ,EAHrB,OA9zB3B,6BAo0BS8wC,EAAWC,GAChBzQ,KAAK2G,OAAO6J,GACZxQ,KAAK5tB,OAAOq+B,GAERzQ,KAAKwY,wBACPxE,GACEhU,KAAKwY,uBACLhI,EACAxQ,KAAK4G,cAIT5G,KAAK0Q,eACL1Q,KAAKuF,SAj1BT,qCAq1BI,uEACAvF,KAAKmQ,wBAt1BT,yDAy1BsC,IAAD,OAC3BwK,EAAQ51B,SAASC,cAAc,KACrC21B,EAAMhJ,aAAa,KAAM,QAFQ,IAI1B7xC,EAJ0B,YAIjBkgC,KAAKqL,WAJY,oBAKbrL,KAAK3pC,SALQ,GAK1BK,EAL0B,KAKpBH,EALoB,KAOjCypC,KAAK0K,MAAMr0C,SAASsQ,EAAuB,UAAnBq5B,KAAKvyB,UAAwB/W,EAAOoJ,EAAQpJ,EACpEspC,KAAK0K,MAAMr0C,SAASqJ,EAAInJ,EAExBokD,EAAMhJ,aACJ,YADF,oBAEe3R,KAAK0K,MAAMr0C,SAASsQ,EAFnC,aAEyCq5B,KAAK0K,MAAMr0C,SAASqJ,EAF7D,MAKA,IAAI4rC,EAAS,EACTmN,EAAO,EAELC,EAAiC,UAAnB1Y,KAAKvyB,WAAyB,EAAI,EAChDkrC,EAA8B,UAAnB3Y,KAAKvyB,WAAyB3N,EAAQA,EACjDyrC,EAAkC,UAAnBvL,KAAKvyB,WAAyB,EAAI,EAEjDmtC,EAAa,SAACj0C,EAAGjH,EAAGyP,EAAGC,EAAGyrC,EAAGC,GACjC,IAAM9X,EAAIje,SAASC,cAAc,QAUjC,OARAge,EAAE2O,aAAa,IAAKhrC,GACpBq8B,EAAE2O,aAAa,IAAKjyC,GACpBsjC,EAAE2O,aAAa,QAASxiC,GACxB6zB,EAAE2O,aAAa,SAAUviC,GACzB4zB,EAAE2O,aAAa,OAAQkJ,GACvB7X,EAAE2O,aAAa,eAAgBmJ,GAC/B9X,EAAE2O,aAAa,eAAgB,GAExB3O,GAoBH8O,EAAa,wEAIf,GAJe,IACjB7lC,cADiB,MACR,UADQ,MAEjBS,mBAFiB,MAEH,EAFG,MAGjBquC,uBAHiB,MAGC,KAHD,SAIR,SAACC,EAAIC,EAAIC,EAAIC,GACtB,IAAMzI,EAAI3tB,SAASC,cAAc,QAYjC,OAVA0tB,EAAEf,aAAa,KAAMqJ,GACrBtI,EAAEf,aAAa,KAAMsJ,GACrBvI,EAAEf,aAAa,KAAMuJ,GACrBxI,EAAEf,aAAa,KAAMwJ,GACrBzI,EAAEf,aAAa,SAAU1lC,GACzBymC,EAAEf,aAAa,eAAgBjlC,GAE3BquC,GACFrI,EAAEf,aAAa,mBAAoBoJ,GAE9BrI,IAGH0I,EAAmBtJ,EAAW,CAAEiJ,gBAAiB,MAEjD5D,EAA6C,iBAA5BnX,KAAK9jC,QAAQu0B,WAuDpC,OApDAuP,KAAKkW,oBAAoB/2C,SAAQ,SAAC25C,EAAe98C,GAC/C,IAAMzE,EAAS,EAAK0/C,oBAAoB,EAAKnB,WAAW95C,IACxDy8C,GAAQlhD,EACRuhD,EAAcnyC,EAAI4kC,EAClBuN,EAAcp5C,EAAI4rC,EAAS/zC,EAAS,EAGpC,IAAMhD,EAAkB4iD,EACpB,UADkC,WAE9B,EAAK5B,aAAalhC,IAAIrY,GAAG,GAAGs+C,SAAS,KAEtB,UAAnB,EAAK7sC,UACPktC,EAAMt1B,YACJu1B,EACE9B,EAAcnyC,EAAImyC,EAAch5C,MAChCg5C,EAAcp5C,EAAIo5C,EAAcvhD,OAAd,EAClBuhD,EAAch5C,MACdg5C,EAAcvhD,OACdhD,EApBkB,MAyBtBomD,EAAMt1B,YACJu1B,EACE9B,EAAcnyC,EACdmyC,EAAcp5C,EAAIo5C,EAAcvhD,OAAd,EAClBuhD,EAAch5C,MACdg5C,EAAcvhD,OACdhD,EA/BkB,MAqCxBomD,EAAMt1B,YA7EW,SAACg2B,GAClB,IAAMC,EAAIv2B,SAASC,cAAc,QAajC,OAXAs2B,EAAE3J,aAAa,IAAK0J,EAAS10C,GAC7B20C,EAAE3J,aAAa,IAAK0J,EAAS37C,EAAI27C,EAAS9jD,OAAT,GACjC+jD,EAAE3J,aAAa,OAAQ0J,EAASE,OAAOC,OACvCF,EAAE3J,aACA,cAC2B,UAA3B0J,EAASE,OAAOE,OAAqB,MAAQ,SAE/CH,EAAE3J,aAAa,QAAf,gBAAiC0J,EAASK,MAA1C,MAEAJ,EAAEK,YAAcN,EAAS71C,KAElB81C,EA+DWM,CAAW9C,IAE7B6B,EAAMt1B,YAAYysB,IAAa,EAAGxG,EAAQoN,EAAapN,IAEnD,EAAKpvC,QAAQ2R,eAAe1F,wBAC9BwyC,EAAMt1B,YAAY+1B,EAAiB,EAAG9P,EAAQqN,EAAUrN,IAG1DA,EAASmN,KAGXkC,EAAMt1B,YAAYysB,IAAa,EAAG,EAAG,EAAG2G,IAEpCzY,KAAK9jC,QAAQ2R,eAAe1F,wBAC9BwyC,EAAMt1B,YAAY+1B,EAAiB,EAAG3C,EAAME,EAAUF,IAGjDkC,IA39BX,kCAu+BI,IAAIxpC,EAAQ,KACRugC,EAAO,KAFD,wFAITA,EAJS,KAIHvgC,EAJG,KAMVugC,EAAKC,aAAa,QAAS,iCAC3B,IAAMC,EAAS7sB,SAASC,cAAc,KAEtC7T,EAAMkU,YAAYusB,GAClBA,EAAOD,aACL,YADF,oBAEe3R,KAAK3pC,SAAS,GAF7B,YAEmC2pC,KAAK3pC,SAAS,GAFjD,MAKA,IAAM8gD,IACgB,iBAApBnX,KAAKvP,cACHuP,KAAKnW,WAAamW,KAAK6W,SACtB7W,KAAK/yB,aAAe+yB,KAAK4W,YAGxBoB,EAAShY,KAAKiY,UAAUd,GACxB7iD,EAAQ6iD,EACVnX,KAAK9jC,QAAQ8R,sBAAwB,UACrCgyB,KAAK9jC,QAAQuN,WAAa,QACxBoyC,EAAiB7b,KAAK9jC,QAAQ6R,oBAAsB,MAkB1D,OAhBAiqC,EAAO74C,SAAQ,WAAmDnD,GAAO,IAAvDu3C,EAAsD,EAAtDA,GAAI7zC,EAAkD,EAAlDA,EAAG8zC,EAA+C,EAA/CA,UAAW3kB,EAAoC,EAApCA,QAAS+kB,EAA2B,EAA3BA,UAAWr8C,EAAgB,EAAhBA,OAChDyrC,EAAIje,SAASC,cAAc,QAEjCge,EAAE2O,aAAa,IAAK4B,EAAKC,GACzBxQ,EAAE2O,aAAa,IAAKjyC,GACpBsjC,EAAE2O,aAAa,QAAqB,EAAZ6B,GACxBxQ,EAAE2O,aAAa,SAAUp6C,GACzByrC,EAAE2O,aAAa,OAAQiC,EAAYiI,EAAiBvnD,GACpD0uC,EAAE2O,aAAa,eAAgB9iB,GAC/BmU,EAAE2O,aAAa,eAAgB,GAE/BC,EAAOvsB,YAAY2d,MAGrB0O,EAAKrsB,YAAY2a,KAAK8b,oCAEf,CAACpK,EAAMvgC,OAjhClB,GAiBiC8yB,EAAIl4B,OAAOmnC,2BAjB5C,mBADGxiC,EACH,iCADGA,EACH,kBAqhCA,OAAO,aAAI4jC,EAAsB5jC,IAMnCwjC,GAAyBr6B,OAAS,CAChCxb,KAAM,iBACN80C,SAAU,CAAC,OAAQ,WACnBC,YAAa,KACbx7C,KAAM,SACNmkD,WAAW,IAAIC,WAAYC,gBAP3B,szDAOiD,YAAYC,gBAC7DzW,iBAAkB,CAChB,WACA,SACA,gBACA,aACA,mBACA,yBACA,mBACA,oBAEFC,eAAgB,CACdt4B,SAAU,UACV+uC,OAAQ,KACRnyC,WAAY,QACZD,cAAe,SACfqyC,iBAAkB,EAClBC,iBAAkB,SAEpBC,YAAa,CACXlvC,SAAU,CACRxV,KAAM,YACN2kD,cAAe,CACbC,OAAQ,CACN5kD,KAAM,SACNxC,MAAO,UAETqnD,QAAS,CACP7kD,KAAM,UACNxC,MAAO,eAOF8+C,UCvlCTwI,GAAiB,SAASA,EAAezY,GAC7C,KAAI,gBAD0ByY,EAC1B,yBACF,MAAM,IAAIhnD,MACR,yEAHuD,QAOnD+M,EAAUwhC,EAAIkD,UAAUwV,QAAxBl6C,MACAJ,EAAc4hC,EAAIkD,UAAUG,QAA5BjlC,UACAklC,EAActD,EAAIE,SAAlBoD,UACAiC,EAAevF,EAAIsF,MAAnBC,WAEFoT,EAZqD,kLAevD,GADA5c,KAAK1B,WAAa,KACd0B,KAAK9jC,SAAW8jC,KAAK9jC,QAAQ4N,YAAa,CAC5C,IAAMkJ,EAAMgtB,KAAK9jC,QAAQ2gD,oBACpB7c,KAAK9jC,QAAQ2gD,mBAAmB,GACjC7c,KAAK8c,wBAAwB9c,KAAK9jC,QAAQ4N,aACxChL,EAAMkhC,KAAK9jC,QAAQ2gD,oBACpB7c,KAAK9jC,QAAQ2gD,mBAAmB,GACjC7c,KAAK+c,wBAAwB/c,KAAK9jC,QAAQ4N,aAE9C,GAAIk2B,KAAK9jC,QAAQ4N,YAAa,CAAC,IAAD,EACRk2B,KAAKgd,eACvBhqC,EACAgtB,KAAKid,6BAA6Bjd,KAAK9jC,QAAQ4N,aAC/ChL,EACA,GAL0B,mBAC3BkhC,KAAK1B,WADsB,SAvBuB,mCAkC5C5+B,EAAGsjC,GACd,OAAOnkC,KAAKC,IAAIkkC,EAAGnkC,KAAKmU,IAAIgtB,KAAKqL,WAAW,GAAKrI,EAAGtjC,MAnCG,+BAsChDw3B,EAAMgmB,EAAWC,EAASC,GAA8B,IAAvBC,EAAsB,wDAExDC,EAAY,CAEhBJ,EAAWE,EAEXD,EAASC,EAETD,EAASnd,KAAKqL,WAAW,GAEzB6R,EAAWld,KAAKqL,WAAW,IAGvBkS,EAAe1+C,KAAKC,IAvJb,EAuJ6Bq+C,EAAUD,GAC9CnnB,EAASwnB,GAAgB,EAvJR,EAuJmCF,GAQ1D,OANAnmB,EAAKsmB,aAAaC,WAChBP,EACAld,KAAK0d,aAAaN,EAAOG,GACzBxnB,GAGKunB,IA5DgD,iCA+D9CpmB,EAAMymB,EAAM1Q,EAAS2Q,EAAQC,EAAMpvC,GAAO,IAAD,OAC5CwpB,GAAaf,EAAKvB,OAAOh0B,MAAM,KAAK,GAE1Cq+B,KAAK8d,aAYL,IAVA,IAAM9Q,EAAW3qC,IACdC,OAAOG,EAAMwqC,IACbxqC,MAAM,CAACm7C,EAAQC,IACfl7C,aAAa,GAEVsK,EAAc+yB,KAAK9jC,QAAQ+Q,aAAe,CAACspB,IAAUA,KAErDwnB,EAAc,GACdC,EAAmB,GAEhBnoB,EAAI,EAAGA,EAAI8nB,EAAKrkD,OAAQu8B,IAAK,CACpC,IAAK,IAAI75B,EAAI,EAAGA,EAAI2hD,EAAK9nB,GAAGv8B,OAAQ0C,IAAK,CACvC,IAAMiiD,EAAKN,EAAK9nB,GAAG75B,GAAG5G,MAChB8oD,EAAWD,EAAGv4C,OAIdK,GAAak4C,EAAGl4C,UAChBwP,GAAW2oC,EAAS,GAAKn4C,EACzB0P,GAASyoC,EAAS,GAAKn4C,EACzBo4C,EAAUnR,EAASnX,GAAKmX,EAAStyB,OAAS,EAE1CslB,KAAK1B,aACP6f,EAAUne,KAAK1B,YAAY4f,GAAUle,KAAK9jC,QAAQ4N,YAAc,KAGlE,IAAMszC,EAAQe,EACRjB,EAAYld,KAAKqN,QAAQ93B,GACzB4nC,EAAUnd,KAAKqN,QAAQ53B,GAG7B,KAEIwiB,KAAa+H,KAAKoe,eAClBH,EAAGh4C,OAAO+5B,KAAKoe,WAAWnmB,IAE5B,CACK+H,KAAKoe,WAAWnmB,KAAY+H,KAAKoe,WAAWnmB,GAAa,IAE9D,IAAMomB,EAAa,CAACnB,EAAWC,EAASC,EAAOa,EAAI1oC,EAASE,GAExDF,GAAWtI,EAAY,IAAMwI,GAASxI,EAAY,GACpD+wC,EAAiBvsC,KAAK4sC,GAEtBN,EAAYtsC,KAAK4sC,IAMvBnnB,EAAKsmB,aAAa3E,UAAU,GAC5B3hB,EAAKsmB,aAAazE,UAAU,UAC5BgF,EAAY5+C,SAAQ,SAACk/C,GACnB,EAAKC,SACHpnB,EACAmnB,EAAW,GACXA,EAAW,GACXA,EAAW,IACX,MAKJ,IAAI/pD,EAAQ0rC,KAAK9jC,QAAQuN,WAAa,QAClColB,EAAUmR,KAAK9jC,QAAQwS,aAAe,GAC1CwoB,EAAKsmB,aAAa3E,UAAU,EAAGrP,EAAWl1C,GAAQu6B,GAClDqI,EAAKsmB,aAAazE,UAAUvP,EAAWl1C,GAAQu6B,GAC/CkvB,EAAY5+C,SAAQ,SAACk/C,GACnB,IAAMf,EAAY,EAAKgB,SACrBpnB,EACAmnB,EAAW,GACXA,EAAW,GACXA,EAAW,IAEb,EAAKD,WAAWnmB,GAAWomB,EAAW,GAAGp4C,KAAO,CAC9Cq3C,EACA,CACE74C,MAAO45C,EAAW,GAClB35C,IAAK25C,EAAW,GAChBjpD,MAAOipD,EAAW,GAClBnnB,OACAzoB,QAEFyoB,EAAKvB,WAKTrhC,EAAQ0rC,KAAK9jC,QAAQwN,gBAAkB,MACvCmlB,EAAUmR,KAAK9jC,QAAQ2N,kBAAoB,GAC3CqtB,EAAKsmB,aAAa3E,UAAU,EAAGrP,EAAWl1C,GAAQu6B,GAClDqI,EAAKsmB,aAAazE,UAAUvP,EAAWl1C,GAAQu6B,GAC/CmvB,EAAiB7+C,SAAQ,SAACk/C,GACxB,IAAMf,EAAY,EAAKgB,SACrBpnB,EACAmnB,EAAW,GACXA,EAAW,GACXA,EAAW,IAEb,EAAKD,WAAWnmB,GAAWomB,EAAW,GAAGp4C,KAAO,CAC9Cq3C,EACA,CACE74C,MAAO45C,EAAW,GAClB35C,IAAK25C,EAAW,GAChBjpD,MAAOipD,EAAW,GAClBnnB,OACAzoB,QAEFyoB,EAAKvB,WAGTuB,EAAKsmB,aAAavE,UAepB,OAZA/hB,EAAKsmB,aAAa9I,aAAc,EAChCxd,EAAKsmB,aAAae,YAAa,EAC/BrnB,EAAKsmB,aAAavI,QAAU,SAACn8C,GACvB,EAAK0lD,aACP,EAAKta,OAAOh9B,QAAQ,YAAa,CAC/B7I,KAAM,MACNvF,QACAq4B,QAAS,EAAKqtB,eAKb,CAACT,EAAaC,KAlMkC,uCA4MxCrN,EAAQC,GAAS,IAAD,OAG/B,GAFA5Q,KAAKwe,iBAAc/oD,GAEduqC,KAAK75B,cAAgB65B,KAAK9jC,QAAQmO,UAAY21B,KAAK1B,WACtD,MAAO,GAET,IAAMrG,EAAY+H,KAAK6Q,qBACjB9pC,EAAYwgC,EAAUuJ,mBAC1B9Q,KAAK75B,YACL8xB,EACA+H,KAAK75B,YAAY4E,WAKb0zC,EADYze,KAAKqN,QAAQ0D,OAAOJ,GACP5pC,EACzBohC,EAAUtpC,KAAKu5B,MAAMqmB,GACrB9oB,EAASqK,KAAKkR,cAAc,CAACjZ,EAAWkQ,IACxCgJ,EAAcnR,KAAKiG,aAAatQ,GAEtC,IAAKwb,EAAa,MAAO,GAEzB,IAAIvU,EAAU,EASd,GARAuU,EAAYhL,SAAShnC,SAAQ,SAACpC,GAC5B,IAAM2hD,EAAO7/C,KAAKkB,IAAI,EAAKstC,QAAQtwC,EAAKyC,QAAUmxC,GAC9C+N,EAAO9hB,IACT,EAAK4hB,YAAczhD,EACnB6/B,EAAU8hB,OAIT1e,KAAKwe,YAAa,MAAO,GAE9B,IAAMG,EAAQ3e,KAAK0d,aACjB1d,KAAK1B,WAAW0B,KAAKwe,YAAYx4C,YACjC,GAGF,GACEnH,KAAKkB,IAAI4+C,GAAS/N,EAAS,IAC3BgO,EAEA,MAAO,GAET,IAAMhnD,EAAOooC,KAAKwe,YAAY94C,OAAOs6B,KAAK9jC,QAAQmO,QAAQzS,KAAK0S,OACzDlV,IAAU4qC,KAAKwe,YAAY94C,OAC/Bs6B,KAAK9jC,QAAQmO,QAAQjV,MAAMkV,QAC1BvI,QAAQi+B,KAAK9jC,QAAQmO,QAAQjV,MAAMmV,aAAe,GACjDs0C,EAAW,GAaf,OAXI7e,KAAK9jC,QAAQmO,QAAQG,QACvBw1B,KAAK9jC,QAAQmO,QAAQG,MAAMrL,SAAQ,SAACqL,GAClC,IAAMxQ,EAAQwQ,EAAMxQ,OAAS,GACvBsJ,IAAM,EAAKk7C,YAAY94C,OAAO8E,EAAMF,QAAQvI,QAChDyI,EAAMD,aAAe,GAEvBs0C,GAAQ,UAAO7kD,EAAP,aAAiBsJ,EAAjB,QAEVu7C,EAAQ,YAAQA,EAASC,OAAO,EAAGD,EAASvlD,OAAS,GAA7C,MAGJ,gBAAN,OAAuB1B,EAAvB,sBAAyCxC,GAAzC,OAAiDypD,EAAjD,YAzQuD,kCAoR5C,IAAD,OACN1tC,EAAQ,KACRugC,EAAO,KAFD,yFAITA,EAJS,KAIHvgC,EAJG,KAMVugC,EAAKC,aAAa,QAAS,sBAC3B,IAAMC,EAAS7sB,SAASC,cAAc,KAEtC7T,EAAMkU,YAAYusB,GAClBA,EAAOD,aACL,YADF,oBAEe3R,KAAK3pC,SAAS,GAF7B,YAEmC2pC,KAAK3pC,SAAS,GAFjD,MAKA2pC,KAAK+e,yBACF7mD,QAAO,SAACg/B,GAAD,OAAUA,EAAK8nB,kBACtB7/C,SAAQ,SAAC+3B,GAAS,MAGiB,EAAK+nB,WACrC/nB,EACAA,EAAK8nB,eACL9nB,EAAK8nB,eAAe1lD,OACpB,EACA,EAAK+xC,WAAW,GAChB,QATe,mBAGVpV,EAHU,KAGDipB,EAHC,KAYjBjpB,EAAQ92B,SAAQ,SAACq9C,GACf,IAAM2C,EAAIp6B,SAASC,cAAc,UACjCm6B,EAAExN,aAAa,OAAQ,EAAKz1C,QAAQuN,WAAa,SACjD01C,EAAExN,aAAa,eAAgB,GAC/BwN,EAAExN,aAAa,UAAW,EAAKz1C,QAAQ0N,aAAe,KACtDu1C,EAAExN,aAAa,IAAK,EAAKz1C,QAAQyN,UACjCw1C,EAAExN,aAAa,KAAM6K,EAAO,IAC5B2C,EAAExN,aAAa,KAAM6K,EAAO,IAC5B5K,EAAOvsB,YAAY85B,MAGrBD,EAAe//C,SAAQ,SAACq9C,GACtB,IAAM2C,EAAIp6B,SAASC,cAAc,UACjCm6B,EAAExN,aAAa,OAAQ,EAAKz1C,QAAQwN,gBAAkB,OACtDy1C,EAAExN,aAAa,eAAgB,GAC/BwN,EAAExN,aAAa,UAAW,EAAKz1C,QAAQ2N,kBAAoB,KAC3Ds1C,EAAExN,aAAa,IAAK,EAAKz1C,QAAQyN,SAAW,GAC5Cw1C,EAAExN,aAAa,KAAM6K,EAAO,IAC5B2C,EAAExN,aAAa,KAAM6K,EAAO,IAC5B5K,EAAOvsB,YAAY85B,SAIzB,IAAMxE,EAAQ51B,SAASC,cAAc,KAUrC,GATA21B,EAAMhJ,aAAa,KAAM,QAGzBD,EAAKrsB,YAAYs1B,GACjBA,EAAMhJ,aACJ,YADF,oBAEe3R,KAAKof,KAAK1U,MAAMr0C,SAASsQ,EAFxC,aAE8Cq5B,KAAKof,KAAK1U,MAAMr0C,SAASqJ,EAFvE,MAM0C,SAAxCsgC,KAAK9jC,QAAQsN,wBACyB,QAAtCw2B,KAAK9jC,QAAQmjD,qBACb,CACA,IAAMC,EAAatf,KAAKof,KAAKG,kBAC3Bvf,KAAK1B,WACL0B,KAAKqL,WAAW,IAElBsP,EAAMt1B,YAAYi6B,QACb,GACmC,UAAxCtf,KAAK9jC,QAAQsN,wBACyB,WAAtCw2B,KAAK9jC,QAAQmjD,qBACb,CACA,IAAMC,EAAatf,KAAKof,KAAKI,mBAC3Bxf,KAAK1B,WACL0B,KAAKqL,WAAW,IAElBsP,EAAMt1B,YAAYi6B,GAGpB,MAAO,CAAC5N,EAAMvgC,OAtWyC,GAYpC8yB,EAAIl4B,OAAO0zC,cAZyB,mBAAN/uC,EAAM,iCAANA,EAAM,kBA0W3D,OAAO,aAAIksC,EAAYlsC,IAMzBgsC,GAAe7iC,OAAS,CACtBxb,KAAM,mBACN80C,SAAU,CAAC,OAAQ,WACnBC,YAAa,KACbx7C,KAAM,SACNmkD,WAAW,IAAIC,WAAYC,gBAP3B,szDAOiD,YAAYC,gBAC7DzW,iBAAkB,CAChB,WACA,SACA,gBACA,aACA,mBACA,yBACA,cACA,cACA,mBACA,oBAEFC,eAAgB,CACdt4B,SAAU,UACV+uC,OAAQ,KACRnyC,WAAY,QACZD,cAAe,SACfmD,YAAa,QACbR,YAAa,EACb0vC,iBAAkB,EAClBC,iBAAkB,SAEpBC,YAAa,CACXlvC,SAAU,CACRxV,KAAM,YACN2kD,cAAe,CACbC,OAAQ,CACN5kD,KAAM,SACNxC,MAAO,UAETqnD,QAAS,CACP7kD,KAAM,UACNxC,MAAO,eAOFsnD,UCtfT7W,GAAE,6tCA0CFC,GAAE,kbAkBF4Z,GAAU,SAACxoB,GAAD,OACdA,EAAKiP,SAAS7sC,aAAsC7D,IAA5ByhC,EAAKiP,SAAS,GAAGmF,QAErCqU,GAAa,SAAC5iD,GAAD,OAAUA,EAAKyC,QAE5BogD,GAAa,SAAC7iD,GAAD,OAAUA,EAAKyC,QAAUzC,EAAK0C,KAAO1C,EAAKyC,QAAU,GAEjEqgD,GAAW,SAAC9iD,GAAD,OAAUA,EAAK0C,MAE1BqgD,GAAW,SAAC/iD,GAAD,OAAUA,EAAKuuC,QAAUvuC,EAAK07C,KAAO17C,EAAKuuC,QAAU,GAE/DyU,GAAa,SAAC9Z,GAAD,OACjBA,EAAa7iC,QACX,SAAC48C,EAAS9oB,GAAV,OAAmBr4B,KAAKC,IAAIkhD,EAAS9oB,EAAK+oB,gBAC1C,IAGEjM,GAAwB,SAACz0C,EAAUonC,EAAQC,GAC/C,IAAMC,GACHD,EAAatkC,SAAS,GAAKskC,EAAatkC,SAAS,KACjDqkC,EAAOrkC,SAAS,GAAKqkC,EAAOrkC,SAAS,IAGlCwkC,EAFWH,EAAOrkC,SAASvG,IAAI6qC,GAEV,GAC3BrnC,EAAS8D,MAAMsD,EAAIkgC,EACnBtnC,EAASlJ,SAASsQ,GAAKmgC,EAAYD,GAI/BqZ,GAAoB,SAACC,GAAD,MAAa,CACrCA,EAAQ3gD,OAAQ2gD,EAAQ7U,OACxB6U,EAAQ1gD,KAAM0gD,EAAQ7U,OACtB6U,EAAQ1gD,KAAM0gD,EAAQ1H,KACtB0H,EAAQ3gD,OAAQ2gD,EAAQ7U,OACxB6U,EAAQ3gD,OAAQ2gD,EAAQ1H,KACxB0H,EAAQ1gD,KAAM0gD,EAAQ1H,OAGlB2H,GAAoB,SAACD,GAAD,MAAa,CACrCA,EAAQE,SACRF,EAAQE,SACRF,EAAQE,SACRF,EAAQE,SACRF,EAAQE,SACRF,EAAQE,WAGJC,GAAmB,SAACH,GAAD,MAAa,CACpCA,EAAQp6B,QACRo6B,EAAQp6B,QACRo6B,EAAQp6B,QACRo6B,EAAQp6B,QACRo6B,EAAQp6B,QACRo6B,EAAQp6B,UAGJw6B,GAAwB,SAASA,EAAsBtc,GAC3D,KAAI,gBADiCsc,EACjC,yBACF,MAAM,IAAI7qD,MACR,yEAHqE,QAOjEgJ,EAASulC,EAAIkD,UAAbzoC,KAPiE,EAQvCulC,EAAIkD,UAAUG,QAAxC9L,EARiE,EAQjEA,YAAaH,EARoD,EAQpDA,SACbkM,EAActD,EAAIE,SAAlBoD,UACAiC,EAAevF,EAAIsF,MAAnBC,WAEF6K,EAAkBhZ,IACrB/4B,OAAO,CAAC,EAAG,KACXG,MAAM,CAAC,GAAK,IACZ64B,OAAM,GAEHklB,EAAY,SAAClsD,GAAD,OAChB2vC,EAAIsF,MACDG,YAAYp1C,GACZkP,MAAM,EAAG,GACTzH,KAAI,SAAC4K,GAAD,OAAO9H,KAAKmU,IAAI,EAAGnU,KAAKC,IAAI,EAAG6H,EAAI,UAEtC85C,EAvBmE,oDAwBvE,WAAYnrD,EAAS4G,GAAU,IAAD,+BAC5B,cAAM5G,EAAS4G,IAEVurC,gBAEL,EAAKC,SAAW,IAAIhpC,EAAKipC,SACzB,EAAKD,SAASrxC,SAASsQ,EAAI,EAC3B,EAAK+gC,SAASrxC,SAASqJ,EAAI,EAC3B,EAAKkoC,QAAQC,SAAS,EAAKH,UAE3B,EAAKI,cAAgB,IAAIppC,EAAKqpC,KAAK,kBAAmB,CACpD9wC,SAAU,EAAK+wC,WAAa,GAC5Bv5B,KAAM,UAER,EAAKi5B,SAASG,SAAS,EAAKC,eAdA,EAxByC,sDAyC9D5Q,GACP,IAAMwpB,EAAOhB,GAAQxoB,GACfypB,EAAWD,EAAOd,GAAaD,GAC/BiB,EAASF,EAAOZ,GAAWD,GAEjC3oB,EAAKiP,SAAShnC,SAAQ,SAACpC,GACrBA,EAAK0H,MAAQk8C,EAAS5jD,GACtBA,EAAK2H,IAAMk8C,EAAO7jD,GAClBA,EAAKs4C,cAAgBt4C,EAAK0H,MAAQ1H,EAAK2H,OAGzCwyB,EAAK+oB,aAAe,EAEpBjgB,KAAK6gB,mBAAmB3pB,KAtD6C,0CAyDnDA,GAAO,IAAD,SACK8I,KAAK4L,wBAChC1U,EAAKiP,SAASlO,UACdf,EAAKiP,SAASgC,SAFRM,EADgB,EAChBA,MAIFj7B,EALkB,EACTzG,UAIai5B,KAAK8gB,QAEjC5pB,EAAK+U,QAAU,IAAI/sC,aAAa8gC,KAAK8gB,QAAU,GAC/C5pB,EAAK6pB,YAAc,IAAI7hD,aAAa8gC,KAAK8gB,SACzC5pB,EAAK8pB,YAAc,IAAI9hD,aAAa8gC,KAAK8gB,QAAU9gB,KAAKwV,WACxDte,EAAK+pB,mBAAqB,IAAIC,WAAWlhB,KAAK8gB,QAAU9gB,KAAKwV,WAK7D,IAHA,IAAI12C,EAAM,EAGD9C,EAAI,EAAGA,GAAKgkC,KAAK8gB,QAAS9kD,IACjCk7B,EAAK+U,QAAQjwC,GAAKysC,EAAQj7B,EAAUxR,EAGtC,IAAMmlD,EAAkB,IAAIrc,IACtBsc,EAAWphB,KAAK8gB,QAAU,EAEhC5pB,EAAKiP,SAASjuC,OAAO8nC,KAAKwW,YAAYr3C,SAAQ,SAACpC,GAoB7C,IAnBA,IAAMjF,EAAQ,EAAKw9C,gBAAgBjhC,IACjCtX,EAAK2I,OAAO,EAAKwC,eAAevP,eAE5B0oD,EAAWxiD,KAAKC,IACpB,EACAD,KAAKmU,IACHouC,EACAviD,KAAKy9B,OAAO,EAAKqkB,SAAS5jD,GAAQ0rC,GAASj7B,KAGzC8zC,EAASziD,KAAKC,IAClB,EACAD,KAAKmU,IAAIouC,EAAUviD,KAAKy9B,OAAO,EAAKskB,OAAO7jD,GAAQ0rC,GAASj7B,KAExDszC,EAAUjiD,KAAKkB,IAAIuhD,EAASD,GAC5BjwB,EAAQ,EAAKqlB,cAAc15C,GAC3B2S,EAAW,EAAKimC,YAAY54C,GAC5B20C,EAAO55C,EAAQ,EAAKgpD,QAEjB9kD,EAAI,EAAGA,GAAK8kD,EAAS9kD,IAAK,CACjC,IAAMulD,EAAMF,EAAWrlD,EACjBwlD,EAAU9P,EAAO6P,EAEjBE,EAAUN,EAAgB9sC,IAAI3E,IAAa,GAI5C+xC,EAAQF,KACXE,EAAQF,GAAOE,EAAQF,IAAQnwB,EAAQ,EACvC8F,EAAK+pB,mBAAmBO,IAAYC,EAAQF,GAC5CJ,EAAgB5zC,IAAImC,EAAU+xC,IAGhCvqB,EAAK8pB,YAAYQ,IAAYpwB,EAC7B8F,EAAK6pB,YAAYQ,IAAQnwB,EAEzBtyB,EAAMD,KAAKC,IAAIA,EAAKo4B,EAAK6pB,YAAYQ,QAIzCrqB,EAAK+oB,aAAenhD,IAxHiD,yCA4HrEqK,OAAOrI,OAAOk/B,KAAKiG,cAAc9mC,QAC/B6gC,KAAK0hB,oBAAoB9c,KAAK5E,SA7HqC,yCAiIpD9I,GACjBA,EAAKyqB,SAAW,IAAIziD,aAAa8gC,KAAK8gB,SADf,MAGM9gB,KAAK4L,wBAChC1U,EAAKiP,SAASlO,UACdf,EAAKiP,SAASgC,SAFRM,EAHe,EAGfA,MAAO1hC,EAHQ,EAGRA,UAKf,GACE0hC,GAASzI,KAAK/yB,YAAY,IAC1Bw7B,EAAQ1hC,GAAai5B,KAAK/yB,YAAY,GActC,IAZA,IAAMO,EAAUzG,EAAYi5B,KAAK8gB,QAE3BO,EAAWxiD,KAAKC,IACpB,EACAD,KAAKy9B,OAAO0D,KAAK/yB,YAAY,GAAKw7B,GAASj7B,IAEvC8zC,EAASziD,KAAKmU,IAClBgtB,KAAK8gB,QAAU,EACfjiD,KAAKy9B,OAAO0D,KAAK/yB,YAAY,GAAKw7B,GAASj7B,IAEvCszC,EAAUjiD,KAAKkB,IAAIuhD,EAASD,GAEzBrlD,EAAI,EAAGA,GAAK8kD,EAAS9kD,IAC5Bk7B,EAAKyqB,SAAS3lD,GAAK,IA1J8C,uCAgKrEmN,OAAOrI,OAAOk/B,KAAKiG,cAAc9mC,QAC/B6gC,KAAK6gB,mBAAmBjc,KAAK5E,SAjKsC,mDAqKzC,IAAD,OAC3B,IAAKA,KAAK9jC,QAAQ2R,eAQhB,OAPAmyB,KAAK93B,mBAAgBzS,EACrBuqC,KAAKsV,qBAAkB7/C,EACvBuqC,KAAKuV,kBAAe9/C,EACpBuqC,KAAKwV,UAAY,EACjBxV,KAAK4hB,kBAAoB,EACzB5hB,KAAKyV,cAAgB,OACrBzV,KAAK0V,YAAc,IAIrB1V,KAAK93B,cAAgB83B,KAAK9jC,QAAQ2R,eAAe3F,cACjD83B,KAAK2V,YAAc,SAAC54C,GAAD,OACjBA,EAAK2I,OAAO,EAAKwC,eAAevP,eAClCqnC,KAAKsV,gBAAkB,IAAIxQ,IAC3B9E,KAAK4V,YAAc,IAAI9Q,IACvB9E,KAAKuV,aAAe,IAAIzQ,IAExB9E,KAAK8V,WAAa9V,KAAK9jC,QAAQ2R,eAAexF,OAAOtM,KACnD,SAACjE,GAAD,OACEA,EAAMwQ,WAAWpQ,QAAO,SAACwX,GAAD,OAAc,EAAKqmC,YAAYrmC,MACpDpW,UAEP0mC,KAAKgW,eAAiBhW,KAAK9jC,QAAQ2R,eAAexF,OAAOnQ,QACvD,SAACJ,EAAOkE,GAAR,OAAc,EAAK85C,WAAW95C,GAAK,KAErCgkC,KAAKwV,UAAYxV,KAAK9jC,QAAQ2R,eAAexF,OAAO/O,OACpD0mC,KAAK4hB,kBAAoB5hB,KAAKgW,eAAe18C,OAC7C0mC,KAAKyV,cAAgBzV,KAAK8V,WAAW1yC,QACnC,SAACqyC,EAAeQ,GAAhB,OAA8BR,EAAgBQ,IAC9C,GAEFjW,KAAK0V,YAAc1V,KAAK9jC,QAAQ2R,eAAexF,OAAOtM,KACpD,SAACjE,EAAOkE,GAAR,OAAclE,EAAMkC,OAAN,gBAAwBgC,MAGxC,IAAI8xC,EAAI,EACR9N,KAAK9jC,QAAQ2R,eAAexF,OAAOlJ,SAAQ,SAACrH,EAAOkE,GACjD,EAAKu5C,aAAahoC,IAAIvR,EAAG,CACvBwtC,EACE1xC,EAAMxD,OAASsT,GAAkB5L,EAAI4L,GAAkBtO,SAEzDkwC,EACE1xC,EAAMvD,iBACJuT,GAAwB9L,EAAI8L,GAAwBxO,WAG1DxB,EAAMwQ,WACHpQ,QAAO,SAACwX,GAAD,OAAc,EAAKqmC,YAAYrmC,MACtCvQ,SAAQ,SAACuQ,EAAUmmB,GAClB,EAAKyf,gBAAgB/nC,IAAImC,EAAS/W,cAAeqD,GACjD,EAAK45C,YAAYroC,IAAImC,EAAS/W,cAAem1C,EAAIjY,MAErDiY,GAAK,EAAKgI,WAAW95C,MAGvBgkC,KAAKkW,oBAAsBlW,KAAK0V,YAAY35C,KAC1C,SAAC/B,EAAOgC,GAAR,OACE,IAAI0C,EAAKqpC,KAAK/tC,EAAO,CACnB/C,SAAU,EAAK+wC,UAEf7rB,MAA0B,UAAnB,EAAK1O,UAAwB,QAAU,OAC9CgB,KAAM+6B,EACJ,EAAKttC,QAAQ2R,eAAexF,OAAOrM,GAAG2T,gBACpC9H,GAAuB7L,EAAI6L,GAAuBvO,gBAtOS,sCA4OtD,IAAD,OACd0mC,KAAKvyB,UAAYuyB,KAAK9jC,QAAQuR,WAAa,OAE3CuyB,KAAKh2B,WAAaw/B,EAAWxJ,KAAK9jC,QAAQ8N,YAAc,SAExDg2B,KAAKgI,UAAYhI,KAAK9jC,QAAQ8rC,WAAa,GAE3ChI,KAAK6hB,SAAW7hB,KAAK9jC,QAAQ2lD,UAAb,YAA6Bj6C,IAE7Co4B,KAAK8hB,gBAAkB9hB,KAAK6hB,SAAS9lD,IAAIykD,GAT3B,MAW4B/hD,GACxCC,EACAshC,KAAK8hB,iBAbO,mBAWb9hB,KAAK+hB,YAXQ,KAWK/hB,KAAKgiB,eAXV,KAgBdhiB,KAAKiiB,cAAgBjiB,KAAK9jC,QAAQ+lD,eAAb,YAChBp6C,IAGLm4B,KAAKkiB,qBAAuBliB,KAAKiiB,cAAclmD,IAAIykD,GApBrC,MAsBsC/hD,GAClDC,EACAshC,KAAKkiB,sBAxBO,mBAsBbliB,KAAKmiB,iBAtBQ,KAsBUniB,KAAKoiB,oBAtBf,KA2BdpiB,KAAKv2B,UAAY+/B,EAAWxJ,KAAK9jC,QAAQuN,WAAa,SAEtDu2B,KAAKyJ,iBAAmBzJ,KAAK9jC,QAAQuN,UACjC+2C,EAAUxgB,KAAK9jC,QAAQuN,WACvB,CAAC,EAAG,EAAG,GAEXu2B,KAAKp2B,YAAckJ,OAAOC,OAAOitB,KAAK9jC,QAAQ0N,aAC1C,EACA/K,KAAKmU,IAAI,EAAGnU,KAAKC,IAAI,GAAIkhC,KAAK9jC,QAAQ0N,cAE1Co2B,KAAKr2B,SAAWq2B,KAAK9jC,QAAQyN,UAAY,EAEzCq2B,KAAKt2B,eAAiB8/B,EAAWxJ,KAAK9jC,QAAQwN,gBAAkB,OAEhEs2B,KAAKqiB,sBAAwBriB,KAAK9jC,QAAQwN,eACtC82C,EAAUxgB,KAAK9jC,QAAQwN,gBACvB,CAAC,EAAG,EAAG,GAEXs2B,KAAKn2B,iBAAmBiJ,OAAOC,OAAOitB,KAAK9jC,QAAQ2N,kBAC/Cm2B,KAAKp2B,YACL/K,KAAKmU,IAAI,EAAGnU,KAAKC,IAAI,GAAIkhC,KAAK9jC,QAAQ2N,mBAE1Cm2B,KAAKsiB,cAAgBtiB,KAAK9jC,QAAQomD,eAAiBtiB,KAAKr2B,SAExDq2B,KAAKxyB,QAAUwyB,KAAK9jC,QAAQsR,SArZT,EAuZnBwyB,KAAK8gB,QAAU9gB,KAAK75B,YAChBtH,KAAKy9B,MAAM0D,KAAK75B,YAAY4E,UAAYi1B,KAAKxyB,SA1Z7B,KA2ZIwyB,KAAKxyB,QAE7BwyB,KAAKuiB,UAAYviB,KAAK9jC,QAAQwR,YAC1B,SAAC3Q,GAAD,OAAU,EAAKylD,aAAazlD,EAAK2I,OAAO,EAAKxJ,QAAQwR,eACrD,kBAAM,GAEVsyB,KAAK2gB,SAAW3gB,KAAK9jC,QAAQmR,WACzB,SAACtQ,GAAD,OAAU,EAAKwlD,UAAUxlD,KAASA,EAAK2I,OAAO,EAAKxJ,QAAQmR,aAC3D,SAACtQ,GAAD,OAAUA,EAAKyC,QAEnBwgC,KAAK4gB,OAAS5gB,KAAK9jC,QAAQoR,SACvB,SAACvQ,GAAD,OAAU,EAAKwlD,UAAUxlD,KAASA,EAAK2I,OAAO,EAAKxJ,QAAQoR,WAC3D,SAACvQ,GAAD,OAAUA,EAAK0C,MAEnBugC,KAAKyW,cAAgBzW,KAAK9jC,QAAQyR,gBAC9B,SAAC5Q,GAAD,OAAWA,EAAK2I,OAAO,EAAKxJ,QAAQyR,kBACpC,kBAAM,GAEV,IAAMC,EAAmBoyB,KAAK9jC,QAAQ0R,kBAAoB,CAAC,IAAM,GAEjEoyB,KAAKqW,UACHrW,KAAK9jC,QAAQhE,QAAU8nC,KAAK9jC,QAAQhE,OAAOqV,IACvCyyB,KAAK9jC,QAAQhE,OAAOqV,IAAInK,QAAO,SAACkQ,EAAGgjC,GAEjC,OADAhjC,EAAEE,IAAI8iC,GACChjC,IACN,IAAIvC,KACP,KAENivB,KAAKuW,YAAcvW,KAAK9jC,QAAQhE,QAAU8nC,KAAK9jC,QAAQhE,OAAOoS,MAE9D01B,KAAK+V,YAAc/V,KAAKqW,UACpB,SAACjhD,GAAD,OAAW,EAAKihD,UAAU5iC,IAAIre,IAC9B,kBAAM,GAEV4qC,KAAKwW,WACHxW,KAAK+V,aAAe/V,KAAKuW,YACrB,SAACx5C,GAAD,OAAU,EAAKg5C,YAAYh5C,EAAK2I,OAAO,EAAK6wC,eAC5C,kBAAM,GAEZ,IAAMI,EAAqBnb,IACxBl5B,OAAOsL,GACPnL,MAAM,CAAC,EAAG,KAEbu9B,KAAK0W,aAAe,SAAC/vC,GAAD,OAAO0tC,EAAgBsC,EAAmBhwC,KAE9Dq5B,KAAK/yB,YAAc+yB,KAAK9jC,QAAQ+Q,YAC5B+yB,KAAK9jC,QAAQ+Q,YACb,CAACspB,IAAUA,KAEfyJ,KAAKnW,UAAYmW,KAAK9jC,QAAQ2tB,UAC1BmW,KAAK9jC,QAAQ2tB,UAAUlxB,mBACvBlD,EAEJuqC,KAAK8W,cAAgB9W,KAAK9jC,QAAQ46C,eAAiB,EAEnD9W,KAAK+W,6BAEL/W,KAAKyiB,iBACLziB,KAAK0iB,mBACL1iB,KAAKwK,iBA9VgE,4CAiWhD,IAAD,cACAxK,KAAK3pC,SADL,GACbK,EADa,KACPH,EADO,KAEpBypC,KAAK0H,SAASrxC,SAASsQ,EAAIjQ,EAAO,EAClCspC,KAAK0H,SAASrxC,SAASqJ,EAAInJ,EAAM,EAE7BypC,KAAKsQ,SAAS71B,KAChBulB,KAAK0H,SAASG,SAAS7H,KAAK8H,eAE5B9H,KAAK0H,SAASniB,YAAYya,KAAK8H,iBAzWoC,2CA8WrE,GAAK9H,KAAK75B,YAAV,CACA,IAAMw8C,EAAS3iB,KAAK75B,YAAY0E,YAAYlJ,MAAM,MAC5CihD,EAAa5iB,KAAK75B,YAAY2E,YACjCnJ,MAAM,MACN5F,KAAI,SAAC0e,GAAD,OAAWA,KAElBulB,KAAKwiB,aAAeG,EAAOv/C,QACzB,WAAoBxB,EAAO5F,GAAO,IAAD,mBAA/B6mD,EAA+B,KAAtBC,EAAsB,KAE/B,OADAD,EAAQjhD,GAASkhD,EACV,CAACD,EAASC,EAASF,EAAW5mD,MAEvC,CAAC,GAAI,IACL,MA1XmE,qCA6XjD,IAAC,IAAD,qBAAN+mD,EAAM,yBAANA,EAAM,gBAIpB,IAHA,0FAAsBA,IACtB/iB,KAAKgjB,qBACLhjB,KAAKmQ,sBACDnQ,KAAK75B,YAAa,CACpB,IAAM88C,EAAajjB,KAAK8gB,QACxB9gB,KAAK8gB,QAAUjiD,KAAKy9B,MAAM0D,KAAK75B,YAAY4E,UAAYi1B,KAAKxyB,SACxDy1C,IAAejjB,KAAK8gB,UACtB9gB,KAAK0iB,mBACL1iB,KAAKwK,mBAtY4D,+BA2Y9DhgB,GACPwV,KAAK9jC,QAAUsuB,EACfwV,KAAKyH,gBACLzH,KAAK2L,2BA9YgE,qCAkZrE,IAAM1F,EAAe98B,OAAOrI,OAAOk/B,KAAKiG,cAExC,GAAKA,EAAa3sC,OAAlB,CAHa,IAKJ/B,EALI,YAKMyoC,KAAKqL,WALX,MAObrL,KAAKggB,QAAUD,GAAW9Z,GAE1BjG,KAAKgX,YAAcxb,IAChBl5B,OAAO,CAAC,EAAG09B,KAAKggB,UAChBv9C,MAAM,CAAClL,EAAQ,IAElByoC,KAAK1B,WAAa0B,KAAKgX,YAEvBhX,KAAKkX,mBAAqB1b,IACvBl5B,OAAO,CAAC,EAAG09B,KAAKggB,UAChBv9C,MAAM,CAAC,EAAGlL,OAlawD,kCAqa3DwF,GACV,MAAO,CACLyC,OAAQwgC,KAAKqN,QAAQtwC,EAAK0H,OAC1BhF,KAAMugC,KAAKqN,QAAQtwC,EAAK0H,OACxB6mC,OAAQtL,KAAKgX,YACXhX,KAAK4V,YAAYvhC,IAAItX,EAAK2I,OAAOs6B,KAAK93B,eAAevP,gBAEvD8/C,KAAM,aACN5pB,QAASmR,KAAK0W,aAAa1W,KAAKyW,cAAc15C,IAC9CgpB,QACEhpB,EAAKyC,QAAUwgC,KAAK/yB,YAAY,IAChClQ,EAAK0C,MAAQugC,KAAK/yB,YAAY,MAhbmC,qCAobxDiqB,GAGb,IAFA,IAAMgsB,EAAW,GAERlnD,EAAI,EAAGA,EAAIgkC,KAAK8gB,QAAS9kD,IAAK,CACrC,IAAImnD,EAAY,EAChB,GAAIjsB,EAAK6pB,YAAY/kD,GAAK,EACxB,IAAK,IAAI65B,EAAI,EAAGA,EAAImK,KAAKwV,UAAW3f,IAAK,CACvC,IAAMt+B,EAAS2/B,EAAK8pB,YAAYnrB,EAAImK,KAAK8gB,QAAU9kD,GAE/CzE,IACF2rD,EAASzxC,KAAK,CACZjS,OAAQwgC,KAAKqN,QAAQnW,EAAK+U,QAAQjwC,IAClCyD,KAAMugC,KAAKqN,QAAQnW,EAAK+U,QAAQjwC,EAAI,IACpCsvC,OAAQtL,KAAKgX,YAAYmM,GACzB1K,KAAMzY,KAAKgX,YAAYmM,EAAY5rD,GACnC8oD,SAAUxqB,EAAImK,KAAK6hB,SAASvoD,OAC5BysB,QAASmR,EAAKyqB,SAAS3lD,KAGzBmnD,GAAa5rD,IAMrB,OAAO2rD,IA7c8D,0CAidrEljB,KAAK4G,aAAepL,IACjBl5B,OADiB,YACN09B,KAAK2G,SAASrkC,WACzBG,MAFiB,YAEPu9B,KAAK2G,SAASlkC,UAE3B,IAAMygD,EAAW/5C,OAAOrI,OAAOk/B,KAAKiG,cAAct9B,QAChDq3B,KAAKojB,eAAexe,KAAK5E,OAGrBiH,EAAY,IAAI/nC,aAAagkD,EAASv6C,QAAQu3C,KAC9CmD,EAAY,IAAInkD,aAAagkD,EAASv6C,QAAQy3C,KAC9Cr6B,EAAU,IAAI7mB,aAAagkD,EAASv6C,QAAQ23C,KAE5CzR,EAAW,IAAInwC,EAAKowC,aAAa,CACrCwU,aAActjB,KAAK+hB,YACnBwB,gBAAiBvjB,KAAKgiB,eACtBwB,eAAgBxjB,KAAKmiB,iBACrBsB,qBAAsBzjB,KAAKoiB,sBAGvB/S,EAAS3wC,EAAK4wC,OAAOhK,KAAKO,GAAIC,GAAI+I,GAElCU,EAAW,IAAI7wC,EAAK8wC,SAC1BD,EAASG,aAAa,YAAazI,EAAW,GAC9CsI,EAASG,aAAa,YAAa2T,EAAW,GAC9C9T,EAASG,aAAa,WAAY3pB,EAAS,GAE3C,IAAM+pB,EAAO,IAAIpxC,EAAKqxC,KACpBR,EACAF,EACA,IAAI3wC,EAAKglD,MACThlD,EAAKilD,WAAWC,WAGZ5T,EAAc,IAAItxC,EAAKipC,SAC7BqI,EAAYnI,SAASiI,GAGrB9P,KAAKiQ,MAAMtpC,EAAIq5B,KAAK3pC,SAAS,GAEzB2pC,KAAKwY,wBACPxY,KAAKiQ,MAAM1qB,YAAYya,KAAKwY,wBAG9BxY,KAAKiQ,MAAMpI,SAASmI,GACpBhQ,KAAKwY,uBAAyBxI,EAE9BgE,GACEhU,KAAKwY,uBACLxY,KAAKqN,QACLrN,KAAK4G,cAGP5G,KAAKuF,OACLvF,KAAKuE,YAtgBgE,oCA0gBrEvE,KAAK6jB,SAAS7jB,KAAKkX,oBACnBlX,KAAK8jB,sBA3gBgE,wCA+gBrE,OAAO36C,OAAOrI,OAAOk/B,KAAKiG,cAAc3sC,SA/gB6B,+CAohBrE0mC,KAAKmQ,sBACAnQ,KAAKoQ,oBACVpQ,KAAK0iB,mBACL1iB,KAAKwK,eACLxK,KAAK+jB,iBAxhBgE,uCAkiBtDpT,EAAQC,GACvB,IAAK5Q,KAAK75B,YAAa,MAAO,GAE9B,IAAM8xB,EAAY+H,KAAK6Q,qBACjB9pC,EAAYwgC,EAAUuJ,mBAC1B9Q,KAAK75B,YACL8xB,EACA+H,KAAK75B,YAAY4E,WAIb0zC,EAAaze,KAAKqN,QAAQ0D,OAAOJ,GAAU5pC,EAC3CohC,EAAUtpC,KAAKu5B,MAAMqmB,GACrB9oB,EAASqK,KAAKkR,cAAc,CAACjZ,EAAWkQ,IACxCgJ,EAAcnR,KAAKiG,aAAatQ,GAEtC,IAAKwb,EAAa,MAAO,GASzB,IAPA,IAAM6S,EAASvF,EAAatW,EACtB8D,EAAUptC,KAAKu5B,MAAM4H,KAAK8gB,QAAUkD,GAEpCC,EAAY,GACZC,EAAa,GACfC,EAAY,EACZrhD,EAAM,EACD9G,EAAI,EAAGA,EAAIgkC,KAAKwV,UAAWx5C,IAAK,CACvC8G,GAAOquC,EAAY6P,YAAYhlD,EAAIgkC,KAAK8gB,QAAU7U,GAClD,IAAMmY,EACJjT,EAAY8P,mBAAmBjlD,EAAIgkC,KAAK8gB,QAAU7U,GACpDiY,EAAWzyC,KAAK2yC,GAChBD,GAAaC,EACbH,EAAUxyC,KAAK3O,GAGjB,IAAMuhD,EAAUrkB,KAAKgX,YAAYjG,OAAOH,GAClC94C,EAAQmsD,EAAUK,WAAU,SAACnB,GAAD,OAAeA,EAAYkB,KAE7D,GAAIvsD,GAAS,EAAG,CAAC,IAAD,EACMkoC,KAAKuV,aAAalhC,IAAIvc,GAD5B,mBACPxD,EADO,KACAwqC,EADA,KAERub,EAAQ,WAAO/lD,EAAMgmD,SAAS,KAC9BC,EAAK,WAAOzb,EAAGwb,SAAS,KACxBllD,EACJ+7C,EAAY8P,mBAAmBnpD,EAAQkoC,KAAK8gB,QAAU7U,GACxD,MAAM,iEAAN,OAAwEsO,EAAxE,mCAAwGF,EAAxG,cAAsHra,KAAK0V,YAAY59C,GAAvI,sBAA2J1C,EAA3J,eAAuK+uD,EAAvK,kBAGF,MAAO,KAhlB8D,kCAmlB3D5T,GACV,qEAAkBA,GADK,kBAG0BvQ,KAAK3pC,SAH/B,GAGtB2pC,KAAKiQ,MAAM55C,SAASsQ,EAHE,KAGCq5B,KAAKiQ,MAAM55C,SAASqJ,EAHrB,OAnlB8C,6BAylBhE8wC,EAAWC,GAChBzQ,KAAK2G,OAAO6J,GACZxQ,KAAK5tB,OAAOq+B,GAERzQ,KAAKwY,wBACPxE,GACEhU,KAAKwY,uBACLhI,EACAxQ,KAAK4G,cAIT5G,KAAK0Q,eACL1Q,KAAKuF,SAtmBgE,kCAinB1D,IAAD,OACNp0B,EAAQ,KACRugC,EAAO,KAFD,wFAITA,EAJS,KAIHvgC,EAJG,KAMVugC,EAAKC,aAAa,QAAS,8BAC3B,IAAMC,EAAS7sB,SAASC,cAAc,KAEtC7T,EAAMkU,YAAYusB,GAClBA,EAAOD,aACL,YADF,oBAEe3R,KAAK3pC,SAAS,GAF7B,YAEmC2pC,KAAK3pC,SAAS,GAFjD,MAKiB8S,OAAOrI,OAAOk/B,KAAKiG,cAAct9B,QAChDq3B,KAAKojB,eAAexe,KAAK5E,OAGlB7gC,SAAQ,YAA+C,IAA5CK,EAA2C,EAA3CA,OAAQC,EAAmC,EAAnCA,KAAM6rC,EAA6B,EAA7BA,OAAQmN,EAAqB,EAArBA,KAAM4H,EAAe,EAAfA,SACxCrd,EAAIje,SAASC,cAAc,QAEjCge,EAAE2O,aAAa,IAAKlyC,GACpBujC,EAAE2O,aAAa,IAAK8G,GACpBzV,EAAE2O,aAAa,QAAS9yC,KAAKkB,IAAIN,EAAOD,IACxCwjC,EAAE2O,aAAa,SAAU9yC,KAAKkB,IAAI04C,EAAOnN,IACzCtI,EAAE2O,aAAa,OAAQ,EAAKkQ,SAASxB,IACrCrd,EAAE2O,aAAa,eAAgB,GAE/BC,EAAOvsB,YAAY2d,MAGrB,IAAM2X,EAAQ51B,SAASC,cAAc,KAUrC,GATA21B,EAAMhJ,aAAa,KAAM,QAGzBD,EAAKrsB,YAAYs1B,GACjBA,EAAMhJ,aACJ,YADF,oBAEe3R,KAAKof,KAAK1U,MAAMr0C,SAASsQ,EAFxC,aAE8Cq5B,KAAKof,KAAK1U,MAAMr0C,SAASqJ,EAFvE,MAM0C,SAAxCsgC,KAAK9jC,QAAQsN,wBACyB,QAAtCw2B,KAAK9jC,QAAQmjD,qBACb,CACA,IAAMC,EAAatf,KAAKof,KAAKG,kBAC3Bvf,KAAK1B,WACL0B,KAAKqL,WAAW,IAElBsP,EAAMt1B,YAAYi6B,QACb,GACmC,UAAxCtf,KAAK9jC,QAAQsN,wBACyB,WAAtCw2B,KAAK9jC,QAAQmjD,qBACb,CACA,IAAMC,EAAatf,KAAKof,KAAKI,mBAC3Bxf,KAAK1B,WACL0B,KAAKqL,WAAW,IAElBsP,EAAMt1B,YAAYi6B,GAGpB,MAAO,CAAC5N,EAAMvgC,OA/qBuD,GAuB3C8yB,EAAIl4B,OAAOmnC,2BAvBgC,mBAANxiC,EAAM,iCAANA,EAAM,kBAmrBzE,OAAO,aAAI+vC,EAAmB/vC,IAMhC6vC,GAAsB1mC,OAAS,CAC7Bxb,KAAM,cACN80C,SAAU,CAAC,WACXC,YAAa,KACbx7C,KAAM,8BACNmkD,WAAW,IAAIC,WAAYC,gBAP3B,szDAOiD,YAAYC,gBAC7DzW,iBAAkB,CAChB,SACA,gBACA,aACA,mBACA,yBACA,cACA,cACA,mBACA,oBAEFC,eAAgB,CACdyW,OAAQ,KACRnyC,WAAY,QACZD,cAAe,SACfmD,YAAa,QACbR,YAAa,EACb0vC,iBAAkB,EAClBC,iBAAkB,UAIPkE,U,mBCj1Bf,SAASgE,GAAetgB,GACtB,KAAI,gBADGsgB,GACH,yBACF,MAAM,IAAI7uD,MACR,yEAHgC,QAO9B8uD,EAP8B,oDAQlC,WAAYlvD,EAAS4G,GAAU,IAAD,uBAC5B,cAAM5G,EAAS4G,GADa,MAGgBuoD,eAApCv9C,EAHoB,EAGpBA,QAASV,EAHW,EAGXA,UAAWa,EAHA,EAGAA,YAHA,OAI5B,EAAKH,QAAUA,EACf,EAAKV,UAAYA,EACjB,EAAKa,YAAcA,EAEnB,EAAKq9C,wBAA0B,EAAKC,mBAAmB/f,KAAxB,iBAE/B,EAAK6C,gBAVuB,EARI,6DAsBhCzH,KAAK9jC,QAAQ8Q,WAAagzB,KAAK9jC,QAAQ8Q,YAAc,KAtBrB,mHA6BfkqB,GACjB,IAAMe,GAAaf,EAAKvB,OAAOh0B,MAAM,KAAK,GAE1Cq+B,KAAK8d,aAcL,IAZA,IAAM7wC,EAAc+yB,KAAK9jC,QAAQ+Q,aAAe,CAACspB,IAAUA,KAErD2O,EAAc,GAEdyY,EAAI,sBACJzmB,EAAK8nB,gBAAkB,IADnB,YAEJ9nB,EAAK0tB,iBAAmB,KAGxBC,EAAa,GACbC,EAAe,GAEZjvB,EAAI,EAAGA,EAAI8nB,EAAKrkD,OAAQu8B,IAC/B,IAAK,IAAI75B,EAAI,EAAGA,EAAI2hD,EAAK9nB,GAAGv8B,OAAQ0C,IAAK,CACvC,IAAMiiD,EAAKN,EAAK9nB,GAAG75B,GAAG5G,MAChB8oD,EAAWD,EAAGv4C,OAIdK,GAAak4C,EAAGl4C,UAChBwP,GAAW2oC,EAAS,GAAKn4C,EACzB0P,GAASyoC,EAAS,GAAKn4C,EAEvBm3C,EAAYld,KAAKqN,QAAQ93B,GACzB4nC,EAAUnd,KAAKqN,QAAQ53B,GAG7B,KAEIwiB,KAAa+H,KAAKoe,eAClBH,EAAGh4C,OAAO+5B,KAAKoe,WAAWnmB,IAE5B,CACK+H,KAAKoe,WAAWnmB,KAAY+H,KAAKoe,WAAWnmB,GAAa,IAE9D,IAAMomB,EAAa,CACjB0G,aAAc7H,EACd8H,WAAY7H,EACZhY,UAAW5vB,EACX6vB,QAAS3vB,EACT/D,KAAMusC,EACNgH,UAAW1vC,GAAWtI,EAAY,IAAMwI,GAASxI,EAAY,IAGzD1J,EAAM2hD,aAAYJ,EAAc7G,EAAGj4C,YACzC8+C,EAAaK,OAAO5hD,EAAK,EAAG06C,EAAGj4C,YAC/B6+C,EAAWM,OAAO5hD,EAAK,EAAG2hC,EAAYzzB,KAAK4sC,GAAc,IAK/D,OAAInZ,EAAY5rC,QAAU0mC,KAAK9jC,QAAQ8Q,WAAmBk4B,EAEnD2f,EACJrhD,MAAM,EAAGw8B,KAAK9jC,QAAQ8Q,YACtBjR,KAAI,SAACwH,GAAD,OAAS2hC,EAAY3hC,QAzFI,iCA6FhCy8B,KAAKyH,gBACLzH,KAAK2L,2BA9F2B,+CAkGhC,iFACA,IAAMzG,EAAc/7B,OAAOrI,OAAOk/B,KAAK+e,0BACpChjD,IAAIikC,KAAK0kB,yBACTthD,QACC,SAACgiD,EAAgBC,GAAjB,OACED,EAAeE,OAAOD,KACxB,IAEJrlB,KAAK94B,QAAQ,aAAc,CAAEsuB,KAAMwK,KAAKxK,KAAM0P,kBA1Gd,yCA8GhC,MAAO,OA9GyB,GAObjB,EAAIl4B,OAAO0zC,cAPE,mBAAN/uC,EAAM,iCAANA,EAAM,kBAkHpC,OAAO,aAAI8zC,EAAY9zC,GAGzB6zC,GAAe1qC,OAAS,CACtBxb,KAAM,MACN80C,SAAU,CAAC,YAGEoR,UCxHTgB,GAAsB,SAASA,EAAoBthB,GACvD,KAAI,gBAD+BshB,EAC/B,yBACF,MAAM,IAAI7vD,MACR,yEAHiE,IAOrE,IAAM8vD,EAAiB,kBAAM3mD,KAAK4mD,SAASnL,SAAS,IAAIl4C,UAAU,IAE5DsjD,EAT+D,WAUnE,WAAYC,GAAa,qBACvB3lB,KAAK2lB,WAAaA,EAX+C,yDAcvDC,GAAW,IAAD,OACpB5lB,KAAK6lB,oBAAqB,EAErB7lB,KAAK8lB,kBACR9lB,KAAK8lB,gBAAkB,IAAIj+B,SAAQ,SAACk+B,EAASC,GAC3C,IAAMp/C,EAAY4+C,IACZS,EAAY/vD,YAChB,kBACE8vD,EACE,IAAItwD,MAAJ,0CACqC,EAAKiwD,WAAW9pD,QA1BnD,KA+BR0K,KAAaC,UAAb,+BAC0BI,IACxB,SAACT,GACChQ,aAAa8vD,GACb,EAAKJ,oBAAqB,EAC1BE,EAAQ5/C,KAEV,GAEFI,KAAaW,QAAQ,8BAA+B,CAClDT,OAAQ,EAAKk/C,WAAW9pD,GACxB+K,kBAKNo5B,KAAK8lB,gBAAgBj/C,MAAK,SAACi/C,GACzBF,EAASE,QA9CsD,0CAuD/CI,EAAaxwB,GAAU,IAAD,OACxC7N,QAAQC,IAAI4N,EAAQ35B,KAAI,SAAC45B,GAAD,OAAY,EAAKuB,KAAKvB,EAAOh0B,MAAM,UAAQkF,MACjE,SAAC2xB,GACC0tB,EACE1tB,EAAMp1B,QAAO,SAACijB,EAAU6Q,EAAMl7B,GAE5B,OADAqqB,EAASqP,EAAQ15B,IAAMk7B,EAChB7Q,IACN,UA9DwD,8BAoErD,IAAD,0BAAP3f,EAAO,KAAJC,EAAI,KACX,OAAO,IAAIkhB,SAAQ,SAACk+B,EAASC,GAC3B,IAAMp/C,EAAY4+C,IACZS,EAAY/vD,YAChB,kBACE8vD,EACE,IAAItwD,MAAJ,8BACyBgR,EADzB,YAC8BC,EAD9B,gBACuC,EAAKg/C,WAAW9pD,GADvD,sBACuE+K,EADvE,SA5EI,KAkFVL,KAAaC,UAAb,wBACmBI,IACjB,SAACswB,GACC/gC,aAAa8vD,GACbF,EAAQ7uB,KAEV,GAEF3wB,KAAaW,QAAQ,uBAAwB,CAC3CT,OAAQ,EAAKk/C,WAAW9pD,GACxB6K,GAAIA,EACJC,GAAIA,EACJC,qBA5F6D,wBAAN8J,EAAM,iCAANA,EAAM,kBAkGrE,OAAO,aAAIg1C,EAA4Bh1C,IAGzC60C,GAAoB1rC,OAAS,CAC3Bxb,KAAM,YAGOknD,U,OC3FfY,YACE,CACEC,YAAaC,GACbxsC,OAAQwsC,GAA0BxsC,QAEpC,CAAEysC,WAAY,gBAGhBH,YAAS,CACPh1C,MAAO+1B,GACPrtB,OAAQqtB,GAAqBrtB,SAG/BssC,YAAS,CACPh1C,MAAO+iC,GACPr6B,OAAQq6B,GAAyBr6B,SAGnCssC,YAAS,CACPh1C,MAAOurC,GACP7iC,OAAQ6iC,GAAe7iC,SAGzBssC,YAAS,CACPh1C,MAAOovC,GACP1mC,OAAQ0mC,GAAsB1mC,SAGhCssC,YAAS,CACPh1C,MAAOozC,GACP1qC,OAAQ0qC,GAAe1qC,SAGzBssC,YAAS,CACPh1C,MAAO6yB,GACPnqB,OAAQmqB,GAAiCnqB,OACzC0sC,aAAa,IAGfC,IAASC,OAAO,kBAAC,GAAD,MAAS1hC,SAAS2hC,eAAe,SRyE3C,kBAAmB/hC,WACrBA,UAAUgiC,cAAcC,MACrB//C,MAAK,SAAAggD,GACJA,EAAaC,gBAEdnjB,OAAM,SAAAojB,GACLthC,QAAQshC,MAAMA,EAAMC,c","file":"static/js/main.529ee68c.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/enhancer-view-2.5240166b.png\";","module.exports = __webpack_public_path__ + \"static/media/enhancer-view-3.bf2e34ef.png\";","module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/enhancer-view-5.cf1c5548.png\";","module.exports = __webpack_public_path__ + \"static/media/gene-view-1.0cd2047f.png\";","module.exports = __webpack_public_path__ + \"static/media/gene-view-2.a8614234.png\";","import React from 'react';\nimport Backdrop from '@material-ui/core/Backdrop';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme) => ({\n  backdrop: {\n    zIndex: theme.zIndex.drawer + 1,\n    color: '#bbb',\n    backgroundColor: '#fff',\n  },\n}));\n\nconst AppInitializing = () => {\n  const classes = useStyles();\n\n  return (\n    <div className=\"full-wh\">\n      <Backdrop className={classes.backdrop} open={true}>\n        <CircularProgress color=\"inherit\" />\n      </Backdrop>\n    </div>\n  );\n};\n\nexport default AppInitializing;\n","import React from 'react';\nimport './AppError.css';\n\nconst AppInitializing = () => (\n  <div className=\"full-wh app-error\">\n    <span>Failed to initialize!</span>\n  </div>\n);\n\nexport default AppInitializing;\n","import React, { createContext } from 'react';\n\nconst ChromInfoContext = createContext();\n\nexport default function ChromInfoProvider({ children, chromInfo }) {\n  return (\n    <ChromInfoContext.Provider value={chromInfo}>\n      {children}\n    </ChromInfoContext.Provider>\n  );\n}\n\nfunction useChromInfo() {\n  const context = React.useContext(ChromInfoContext);\n  if (context === undefined) {\n    throw new Error('useChromInfo must be used within a ChromInfoContext');\n  }\n  return context;\n}\n\nexport { useChromInfo };\n","import { useState, useEffect } from 'react';\n\nexport default function useDebounce(value, delay) {\n  const [debouncedValue, setDebouncedValue] = useState(value);\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n\n  return debouncedValue;\n}\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useRecoilState, useRecoilValue } from 'recoil';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport CheckBoxIcon from '@material-ui/icons/CheckBox';\nimport CheckBoxOutlineBlankIcon from '@material-ui/icons/CheckBoxOutlineBlank';\nimport IndeterminateCheckBoxIcon from '@material-ui/icons/IndeterminateCheckBox';\nimport FilterListIcon from '@material-ui/icons/FilterList';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport Grid from '@material-ui/core/Grid';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport useDebounce from './use-debounce';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    position: 'relative',\n  },\n  filterBar: {\n    position: 'sticky',\n    zIndex: 1,\n    top: '8px',\n    '&:before': {\n      content: '\"\"',\n      position: 'absolute',\n      zIndex: 0,\n      top: '-9px',\n      right: '-8px',\n      left: '-8px',\n      bottom: 0,\n      background: 'white',\n    },\n  },\n  checkbox: {\n    marginTop: -6,\n    marginBottom: -6,\n  },\n  checkboxLabel: {\n    fontSize: '0.8rem',\n    marginLeft: -6,\n  },\n  nestedCheckbox: {\n    marginLeft: 4,\n  },\n  visible: {\n    transition: '.3s ease transform, .3s ease height',\n    transform: 'scale(1, 1)',\n    height: '1.625rem',\n  },\n  invisible: {\n    transition: '.3s ease transform, .3s ease height',\n    transform: 'scale(1, 0)',\n    height: '0rem',\n  },\n}));\n\nconst Option = React.memo(function Option({\n  filterState,\n  name,\n  stateWithName,\n  group,\n  stateWithGroup,\n  colorCheckbox,\n  colorText,\n}) {\n  const filter = useRecoilValue(filterState);\n  const [state, setState] = useRecoilState(stateWithName(name));\n  const [groupState, setGroupState] = useRecoilState(stateWithGroup(group));\n  const nameLowerCase = useMemo(() => name.toLowerCase(), [name]);\n\n  const changeHandler = useCallback(\n    (event) => {\n      setState((currState) => ({\n        ...currState,\n        checked: event.target.checked,\n      }));\n      setGroupState((currGroupState) => {\n        const newGroupState = {\n          ...currGroupState,\n          n: currGroupState.n + (event.target.checked ? 1 : -1),\n        };\n        switch (newGroupState.n) {\n          case currGroupState.N:\n            newGroupState.checked = true;\n            break;\n          case 0:\n            newGroupState.checked = false;\n            break;\n          default:\n            newGroupState.checked = undefined;\n            break;\n        }\n        return newGroupState;\n      });\n    },\n    [setState, setGroupState]\n  );\n\n  useEffect(() => {\n    if (groupState.checked === true) {\n      setState((currState) => ({\n        ...currState,\n        checked: true,\n      }));\n    } else if (groupState.checked === false) {\n      setState((currState) => ({\n        ...currState,\n        checked: false,\n      }));\n    }\n  }, [groupState, setState]);\n\n  useEffect(() => {\n    setState((currState) => ({\n      ...currState,\n      visible: !filter.length || nameLowerCase.includes(filter),\n    }));\n  }, [filter, nameLowerCase, setState]);\n\n  const classes = useStyles();\n\n  return (\n    <div className={state.visible ? classes.visible : classes.invisible}>\n      <FormControlLabel\n        key={name}\n        className={`${classes.checkbox} ${classes.nestedCheckbox}`}\n        control={\n          <Checkbox\n            style={{\n              color: colorCheckbox,\n            }}\n            icon={<CheckBoxOutlineBlankIcon fontSize=\"small\" />}\n            checkedIcon={<CheckBoxIcon fontSize=\"small\" />}\n            checked={state.checked}\n            onChange={changeHandler}\n            name={name}\n          />\n        }\n        label={\n          <Typography\n            className={classes.checkboxLabel}\n            noWrap\n            style={{\n              color: colorText,\n            }}\n          >\n            {name}\n          </Typography>\n        }\n      />\n    </div>\n  );\n});\n\nconst OptionGroup = React.memo(function OptionGroup({\n  group,\n  stateWithGroup,\n  colorCheckbox,\n  colorText,\n}) {\n  const [state, setState] = useRecoilState(stateWithGroup(group));\n\n  const changeHandler = useCallback(\n    (event) => {\n      setState((currState) => ({\n        ...currState,\n        checked: event.target.checked,\n        n: event.target.checked ? currState.N : 0,\n      }));\n    },\n    [setState]\n  );\n\n  const classes = useStyles();\n\n  return (\n    <FormControlLabel\n      className={classes.checkbox}\n      control={\n        <Checkbox\n          style={{ color: colorCheckbox }}\n          icon={\n            state.checked === false ? (\n              <CheckBoxOutlineBlankIcon fontSize=\"small\" />\n            ) : (\n              <IndeterminateCheckBoxIcon fontSize=\"small\" />\n            )\n          }\n          checkedIcon={<CheckBoxIcon fontSize=\"small\" />}\n          checked={state.checked === true}\n          onChange={changeHandler}\n          name={group.name}\n        />\n      }\n      label={\n        <Typography\n          className={classes.checkboxLabel}\n          noWrap\n          style={{ color: colorText }}\n        >\n          <strong>{group.name}</strong>{' '}\n          <span>\n            ({state.n}/{state.N})\n          </span>\n        </Typography>\n      }\n    />\n  );\n});\n\nconst NestedCheckboxList = React.memo(function NestedCheckboxList({\n  filterState,\n  optionWithName,\n  optionGroupWithGroup,\n  filterLabel = 'Filter',\n  groupedOptions = [],\n  optionToGroup = {},\n  groupColors = [],\n  groupColorsDark = [],\n}) {\n  const [globalFilter, setGlobalFilter] = useRecoilState(filterState);\n  const [filter, setFilter] = useState(globalFilter);\n  const filterDb = useDebounce(filter, 350);\n\n  const filterChangeHandler = useCallback(\n    (event) => {\n      setFilter(event.target.value.toLowerCase());\n    },\n    [setFilter]\n  );\n\n  useEffect(() => {\n    setGlobalFilter(filterDb);\n  }, [filterDb, setGlobalFilter]);\n\n  const classes = useStyles();\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.filterBarBg} />\n      <FormControl\n        className={classes.filterBar}\n        variant=\"outlined\"\n        margin=\"dense\"\n        fullWidth\n      >\n        <InputLabel htmlFor=\"filter\">\n          <Grid container direction=\"row\" alignItems=\"center\">\n            <FilterListIcon fontSize=\"small\" />\n            <span style={{ marginLeft: 3 }}>{filterLabel}</span>\n          </Grid>\n        </InputLabel>\n        <OutlinedInput\n          id=\"filter\"\n          label={\n            <Grid container direction=\"row\" alignItems=\"center\">\n              <FilterListIcon fontSize=\"small\" />\n              <span style={{ marginLeft: 3 }}>{filterLabel}</span>\n            </Grid>\n          }\n          onChange={filterChangeHandler}\n          value={filter}\n        />\n      </FormControl>\n      <FormGroup>\n        {groupedOptions.map((group, i) => (\n          <React.Fragment key={group.name}>\n            <OptionGroup\n              key={group.name}\n              group={group}\n              stateWithGroup={optionGroupWithGroup}\n              colorCheckbox={groupColors[i % groupColors.length] || 'inherit'}\n              colorText={\n                groupColorsDark[i % groupColorsDark.length] || 'inherit'\n              }\n            />\n            {group.options.map((option) => (\n              <Option\n                filterState={filterState}\n                key={option}\n                name={option}\n                stateWithName={optionWithName}\n                group={group}\n                stateWithGroup={optionGroupWithGroup}\n                colorCheckbox={groupColors[i % groupColors.length] || 'inherit'}\n                colorText={\n                  groupColorsDark[i % groupColorsDark.length] || 'inherit'\n                }\n              />\n            ))}\n          </React.Fragment>\n        ))}\n      </FormGroup>\n    </div>\n  );\n});\n\nexport default NestedCheckboxList;\n","import PropTypes from 'prop-types';\nimport React from 'react';\n\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme) => ({\n  logo: {\n    height: '100%',\n    padding: '0.1em',\n    alignItems: 'center',\n    fontSize: '1em',\n    lineHeight: '1em',\n    fontWeight: 'bold',\n  },\n  logoAbc: {\n    fontSize: '2.75em',\n    letterSpacing: '-0.075rem',\n    paddingRight: '0.125em',\n    fontWeight: 900,\n  },\n  logoEnhancer: {\n    alignItems: 'flex-start',\n  },\n}));\n\nconst Logo = (props) => {\n  const classes = useStyles();\n\n  return (\n    <Grid container className={classes.logo} style={props.styles}>\n      <Grid item className={classes.logoAbc}>\n        ABC\n      </Grid>\n      <Grid item>\n        <Grid container direction=\"column\" className={classes.logoEnhancer}>\n          <Grid item>Enhancer-Gene</Grid>\n          <Grid item>Connections</Grid>\n        </Grid>\n      </Grid>\n    </Grid>\n  );\n};\n\nLogo.defaultProps = {\n  styles: {},\n};\n\nLogo.propTypes = {\n  styles: PropTypes.object,\n};\n\nexport default Logo;\n","import React, { useCallback, useState } from 'react';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport ClearIcon from '@material-ui/icons/Clear';\nimport InsertDriveFileIcon from '@material-ui/icons/InsertDriveFile';\n\nconst FileInput = React.memo(\n  React.forwardRef(function FileInput(props, ref) {\n    const {\n      onChange: changeHandler,\n      onClear: clearHandler,\n      className = '',\n      label = 'Select',\n      accept = '*',\n      color = 'default',\n      Icon = InsertDriveFileIcon,\n    } = props;\n\n    // We will spread any other props onto the root component. However, some\n    // props can mess things up so we will remove them in the following lines\n    const otherProps = { ...props };\n    delete otherProps.onChange;\n    delete otherProps.onClear;\n    delete otherProps.className;\n    delete otherProps.file;\n    delete otherProps.label;\n    delete otherProps.accept;\n    delete otherProps.color;\n    delete otherProps.Icon;\n\n    const [file, setFile] = useState(props.file || null);\n\n    const localChangeHandler = useCallback(\n      (event) => {\n        const fileList = event.target.files;\n        setFile(fileList[0]);\n        if (changeHandler) changeHandler(fileList[0], event);\n      },\n      [changeHandler]\n    );\n\n    const clearFile = useCallback(() => {\n      setFile(null);\n      if (clearHandler) clearHandler();\n    }, [clearHandler]);\n\n    return (\n      <ButtonGroup {...otherProps} className=\"r\" ref={ref}>\n        <Button\n          variant={file ? 'outlined' : 'contained'}\n          component=\"label\"\n          className={className}\n          color={color}\n          disableElevation\n          startIcon={<Icon />}\n        >\n          <input\n            accept={accept}\n            type=\"file\"\n            onChange={localChangeHandler}\n            hidden\n          />\n          {file ? file.name : label}\n        </Button>\n        <Button\n          variant=\"contained\"\n          disabled={!file}\n          onClick={clearFile}\n          disableElevation\n        >\n          <ClearIcon fontSize=\"inherit\" />\n        </Button>\n      </ButtonGroup>\n    );\n  })\n);\n\nexport default FileInput;\n","import { identity } from '@flekschas/utils';\nimport queryString from 'query-string';\n\nexport const contains = (a, b) => a[0] <= b[0] && a[1] >= b[1];\n\nexport const createColorTexture = (PIXI, colors) => {\n  const colorTexRes = Math.max(2, Math.ceil(Math.sqrt(colors.length)));\n  const rgba = new Float32Array(colorTexRes ** 2 * 4);\n  colors.forEach((color, i) => {\n    // eslint-disable-next-line prefer-destructuring\n    rgba[i * 4] = color[0]; // r\n    // eslint-disable-next-line prefer-destructuring\n    rgba[i * 4 + 1] = color[1]; // g\n    // eslint-disable-next-line prefer-destructuring\n    rgba[i * 4 + 2] = color[2]; // b\n    // eslint-disable-next-line prefer-destructuring\n    rgba[i * 4 + 3] = color[3]; // a\n  });\n\n  return [PIXI.Texture.fromBuffer(rgba, colorTexRes, colorTexRes), colorTexRes];\n};\n\nexport const dashedXLineTo = (graphics, xStart, xEnd, y, dashSize) => {\n  const diff = xEnd - xStart;\n  const direction = Math.sign(diff);\n  const width = Math.abs(diff);\n  const stepSize = dashSize * 2;\n  const numSteps = Math.ceil(width / stepSize);\n  for (let i = 0; i < numSteps; i++) {\n    graphics.moveTo(xStart + i * stepSize * direction, y);\n    graphics.lineTo(xStart + (i * stepSize + dashSize) * direction, y);\n  }\n};\n\nexport const download = (filename, stringOrBlob) => {\n  const blob =\n    typeof stringOrBlob === 'string'\n      ? new Blob([stringOrBlob], { type: 'application/octet-stream' })\n      : stringOrBlob;\n  if (window.navigator.msSaveOrOpenBlob) {\n    window.navigator.msSaveBlob(blob, filename);\n  } else {\n    const elem = window.document.createElement('a');\n    elem.href = window.URL.createObjectURL(blob);\n    elem.download = filename;\n    document.body.appendChild(elem);\n    elem.click();\n    document.body.removeChild(elem);\n    URL.revokeObjectURL(elem.href);\n  }\n};\n\nexport const getQueryStringValue = (key, decoder = identity) =>\n  decoder(queryString.parse(window.location.search)[key]);\n\nexport const setQueryStringValue = (key, value, encoder = identity) => {\n  const values = queryString.parse(window.location.search);\n  const newQsValue = queryString.stringify(\n    {\n      ...values,\n      [key]: encoder(value),\n    },\n    { strict: false }\n  );\n  const url = `${window.location.origin}${window.location.pathname}?${newQsValue}`;\n  window.history.pushState({ path: url }, '', url);\n};\n\nexport const toAbsPosition = (position, chromInfo) => {\n  let absPosition;\n  if (position.indexOf && position.indexOf(':') >= 0) {\n    const [chrom, pos] = position.split(':');\n    absPosition = chromInfo.chrPositions[chrom].pos + +pos;\n  } else {\n    absPosition = +position;\n  }\n  return absPosition;\n};\n\nexport const toFixed = (number, decimals, forced) => {\n  let string = number.toFixed(decimals);\n  if (!forced) {\n    while (string[string.length - 1] === '0') {\n      string = string.substring(0, string.length - 1);\n    }\n    if (string[string.length - 1] === '.') {\n      string = string.substring(0, string.length - 1);\n    }\n  }\n  return string;\n};\n\nexport const scaleBand = () => {\n  let domain = [];\n  let fixedBandwidth = null;\n  let bandwidth = 1;\n  let range = [0, 1];\n  let rangeSize = range[1] - range[0];\n  let paddingInner = [];\n  // If `true` the padding will begin before the first bar!\n  let paddingInnerZeroBased = false;\n  let totalWidth = 0;\n\n  const sum = (a, b) => a + b;\n  const getBandwidth = () => fixedBandwidth || bandwidth;\n\n  const update = () => {\n    rangeSize = range[1] - range[0];\n\n    const totalPaddingInner = paddingInner.reduce(sum, 0);\n    bandwidth = (rangeSize - totalPaddingInner) / domain.length;\n    totalWidth = totalPaddingInner + domain.length * getBandwidth();\n  };\n\n  const scale = (v) => {\n    const idx = domain.indexOf(v);\n\n    if (idx === -1) return undefined;\n\n    return (\n      idx * getBandwidth() +\n      paddingInner.slice(0, idx + paddingInnerZeroBased).reduce(sum, 0)\n    );\n  };\n\n  scale.domain = (newDomain) => {\n    if (newDomain) {\n      domain = [...newDomain];\n      update();\n      return scale;\n    }\n\n    return domain;\n  };\n\n  scale.range = (newRange) => {\n    if (newRange) {\n      range = [...newRange];\n      update();\n      return scale;\n    }\n\n    return range;\n  };\n\n  scale.bandwidth = () => getBandwidth();\n\n  scale.fixedBandwidth = (newFixedBandwidth) => {\n    if (newFixedBandwidth) {\n      fixedBandwidth = newFixedBandwidth;\n      update();\n      return scale;\n    }\n\n    return newFixedBandwidth;\n  };\n\n  scale.totalWidth = () => totalWidth;\n\n  scale.rangeSize = () => rangeSize;\n\n  scale.paddingInner = (newPaddingInner) => {\n    if (newPaddingInner) {\n      paddingInner = newPaddingInner;\n      update();\n      return scale;\n    }\n\n    return paddingInner;\n  };\n\n  scale.paddingInnerZeroBased = (newPaddingInnerZeroBased) => {\n    if (newPaddingInnerZeroBased) {\n      paddingInnerZeroBased = newPaddingInnerZeroBased;\n      update();\n      return scale;\n    }\n\n    return paddingInnerZeroBased;\n  };\n\n  return scale;\n};\n\nexport const stringifySvg = (svg) =>\n  new window.XMLSerializer().serializeToString(svg);\n\nexport const booleanQueryStringDecoder = (v) =>\n  v === undefined ? undefined : v === 'true';\n\nexport const customBooleanQueryStringDecoder = (excluded = []) => {\n  const s = excluded.reduce((_s, v) => {\n    _s.add(v);\n    return _s;\n  }, new Set());\n  return (v) => {\n    if (v === undefined || s.has(v)) return v;\n    return v === 'true';\n  };\n};\n\nexport const isChrRange = (chrRange) =>\n  chrRange.match(/^chr(\\d+)[:.](\\d+)(([-~+])(\\d+))?(-chr(\\d+)[:.](\\d+))?$/);\n\nexport const getIntervalCenter = (interval) =>\n  interval[0] + (interval[1] - interval[0]) / 2;\n\nexport const chrPosUrlDecoder = (chrPos) =>\n  chrPos ? chrPos.replace('.', ':') : chrPos;\n\nexport const chrPosUrlEncoder = (chrPos) =>\n  chrPos ? chrPos.replace(':', '.') : chrPos;\n\nexport const chrPosAdd = (chrPos, value) => {\n  if (!chrPos) return chrPos;\n\n  const [chrom, pos] = chrPos.split(':');\n\n  return `${chrom}:${+pos + +value}`;\n};\n\nexport const chrRangePosUrlDecoder = (chrRangePos) => {\n  if (!chrRangePos) return chrRangePos;\n\n  let [start, end] = chrRangePos.split('-');\n  let range = null;\n\n  [start, range] = chrPosUrlDecoder(start).split('~');\n\n  if (end) {\n    end = chrPosUrlDecoder(end);\n  } else if (range) {\n    end = chrPosAdd(start, range);\n  } else {\n    end = chrPosAdd(start, 1);\n  }\n\n  return [start, end];\n};\n\nexport const chrRangePosEncoder = (\n  chrRangePos,\n  chrPosEncoder = identity,\n  lengthOperator = '+'\n) => {\n  if (!chrRangePos) return chrRangePos;\n\n  const [startChrom, startPos] = chrRangePos[0].split(':');\n  const [endChrom, endPos] = chrRangePos[1].split(':');\n\n  if (startChrom === endChrom) {\n    const length = Math.abs(+endPos - +startPos);\n\n    if (length < 2) return chrPosEncoder(chrRangePos[0]);\n\n    if (length < 100000)\n      return `${chrPosEncoder(chrRangePos[0])}${lengthOperator}${length}`;\n\n    return `${chrPosEncoder(chrRangePos[0])}-${endPos}`;\n  }\n\n  return chrRangePos.map(chrPosEncoder).join('-');\n};\n\nexport const chrRangePosUrlEncoder = (chrRangePos) =>\n  chrRangePosEncoder(chrRangePos, chrPosUrlEncoder, '~');\n","import { globalPubSub } from 'pub-sub-es';\nimport IntervalTree from '@flatten-js/interval-tree';\n\nimport { toAbsPosition } from './utils';\n\nasync function loadFile(\n  file,\n  chromInfo,\n  { header = true, columnImportance = 7 } = {}\n) {\n  const tree = new IntervalTree();\n  const text = await file.text();\n  const lines = text.split(/\\r\\n|\\n/);\n  for (let i = +header; i < lines.length; i++) {\n    const fields = lines[i].split('\\t');\n    const chromOffset = toAbsPosition(`${fields[0]}:0`, chromInfo);\n    const startAbs = toAbsPosition(`${fields[0]}:${fields[1]}`, chromInfo);\n    const endAbs = toAbsPosition(`${fields[0]}:${fields[2]}`, chromInfo);\n    tree.insert([startAbs, endAbs], {\n      chrOffset: chromOffset,\n      xStart: startAbs,\n      xEnd: endAbs,\n      importance: +fields[columnImportance],\n      uid: `${file.name}-${i}`,\n      name: fields[3],\n      fields,\n    });\n  }\n  return tree;\n}\n\nconst createLocalBedDataServer = (\n  file,\n  id,\n  chromInfo,\n  tilesetInfo,\n  options\n) => {\n  const whenIndex = loadFile(file, chromInfo, options);\n\n  const requestTileHandler = ({ fileId, z, x, requestId }) => {\n    if (fileId !== id) return;\n    whenIndex.then((index) => {\n      const tileWidth = tilesetInfo.max_width / 2 ** z;\n      const start = tileWidth * x;\n      const end = start + tileWidth;\n      const results = index.search([start, end]);\n      globalPubSub.publish(`localBed:tile:${requestId}`, results);\n    });\n  };\n\n  const requestTilesetInfoHandler = ({ fileId, requestId }) => {\n    if (fileId !== id) return;\n    globalPubSub.publish(`localBed:tilesetInfo:${requestId}`, tilesetInfo);\n  };\n\n  const subscriptionTile = globalPubSub.subscribe(\n    'localBed:requestTile',\n    requestTileHandler\n  );\n\n  const subscriptionTilesetInfo = globalPubSub.subscribe(\n    'localBed:requestTilesetInfo',\n    requestTilesetInfoHandler\n  );\n\n  const destroy = () => {\n    globalPubSub.unsubscribe(subscriptionTile);\n    globalPubSub.unsubscribe(subscriptionTilesetInfo);\n  };\n\n  return {\n    destroy,\n  };\n};\n\nexport default createLocalBedDataServer;\n","import { useCallback, useMemo, useState } from 'react';\nimport { useRecoilState, useRecoilValue } from 'recoil';\n\nimport { getQueryStringValue, setQueryStringValue } from './utils';\n\nexport default function useQueryStringWithReactState(\n  key,\n  initialValue,\n  { encoder, decoder } = {}\n) {\n  const _initialValue =\n    getQueryStringValue(key, decoder) === undefined\n      ? initialValue\n      : getQueryStringValue(key, decoder);\n\n  const [value, setValue] = useState(_initialValue);\n\n  const onSetValue = useCallback(\n    (newValue) => {\n      setValue(newValue);\n      setQueryStringValue(key, newValue, encoder);\n    },\n    [key, encoder]\n  );\n\n  // Set initial value\n  setQueryStringValue(key, value, encoder);\n\n  return [value, onSetValue];\n}\n\nexport function useRecoilQueryString(key, atom, encoder) {\n  const [value, setValue] = useRecoilState(atom);\n\n  const onSetValue = useCallback(\n    (newValue) => {\n      setValue(newValue);\n      setQueryStringValue(key, newValue, encoder);\n    },\n    [key, encoder, setValue]\n  );\n\n  return [value, onSetValue];\n}\n\nexport function useRecoilQueryStringSyncher(key, atom, encoder) {\n  const value = useRecoilValue(atom);\n\n  useMemo(() => {\n    setQueryStringValue(key, value, encoder);\n  }, [key, encoder, value]);\n}\n","export const DRAWER_WIDTH = 240;\n\nexport const EPS = 1e-6;\n\nexport const SVG_SKELETON = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg\n    xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n    xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"_WIDTH_px\" height=\"_HEIGHT_px\">\n    <g id=\"enhancer-plot\">\n    _ENHANCER_\n    </g>\n    <g id=\"enhancer-gene-plot\" transform=\"translate(0, _ENHANCER_GENE_Y_)\">\n    _ENHANCER_GENE_\n    </g>\n    <g id=\"dna-accessibility-plot\" transform=\"translate(_DNA_ACCESS_X_, 0)\">\n    _DNA_ACCESS_\n    </g>\n</svg>`;\n\nexport const DEFAULT_COLOR_MAP = [\n  // '#c17da5', // pink\n  '#c76526', // red\n  '#6fb2e4', // light blue\n  '#eee462', // yellow\n  '#469b76', // green\n  '#3170ad', // dark blue\n  '#dca237', // orange\n  '#000000', // black\n  '#999999', // gray\n];\n\nexport const DEFAULT_COLOR_MAP_DARK = [\n  // '#a1688a', // pink\n  '#a65420', // red\n  '#4a7798', // light blue\n  '#999026', // yellow\n  '#3a8162', // green\n  '#295d90', // dark blue\n  '#b7872e', // orange\n  '#000000', // black\n  '#666666', // gray\n];\n\nexport const DEFAULT_COLOR_MAP_LIGHT = [\n  // '#f5e9f0', // pink\n  '#f6e5db', // red\n  '#e7f2fb', // light blue\n  '#f2eda9', // yellow\n  '#e0eee8', // green\n  '#dde7f1', // dark blue\n  '#f5e4c4', // orange\n  '#d5d5d5', // black\n  '#ffffff', // gray\n];\n\nexport const GENE_SEARCH_URL =\n  'https://higlass.io/api/v1/suggest/?d=OHJakQICQD6gTD7skx4EWA';\n\nexport const VARIANT_SEARCH_URL =\n  'https://resgen.io/api/v1/suggest/?d=VF5-RDXWTxidGMJU7FeaxA';\n\nexport const DEFAULT_STRATIFICATION = {\n  categoryField: 10,\n  axisShowGroupSeparator: true,\n  axisNoGroupColor: false,\n  groups: [\n    {\n      label: 'Mononuclear Phagocytes',\n      categories: [\n        'THP1_LPS_4hr-Engreitz',\n        'THP_pmaLPS_ATAC_6h',\n        'CD14-positive_monocyte_treated_with_LPS_4h-Novakovic2016',\n        'CD14-positive_monocyte_treated_with_BG_1h-Novakovic2016',\n        'CD14-positive_monocyte_treated_with_RPMI_d6-Novakovic2016',\n        'THP1-Engreitz',\n        'THP_pmaLPS_ATAC_96h',\n        'CD14-positive_monocyte_treated_with_BG_d1-Novakovic2016',\n        'THP_pmaLPS_ATAC_72h',\n        'THP-1_monocyte-VanBortle2017',\n        'CD14-positive_monocyte_treated_with_LPS_d1-Novakovic2016',\n        'CD14-positive_monocyte-ENCODE',\n        'THP_pmaLPS_ATAC_2h',\n        'dendritic_cell_treated_with_Lipopolysaccharide_0_ng-mL_for_0_hour-Garber2017',\n        'CD14-positive_monocyte_treated_with_RPMI_1h-Novakovic2016',\n        'U937_LPS_4hr-Engreitz',\n        'CD14-positive_monocyte-Novakovic2016',\n        'dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_6_hour-Garber2017',\n        'CD14-positive_monocyte_treated_with_BG_4h-Novakovic2016',\n        'THP_pmaLPS_ATAC_0h',\n        'HAP1',\n        'THP-1_macrophage-VanBortle2017',\n        'dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_1_hour-Garber2017',\n        'U937-Engreitz',\n        'CD14-positive_monocyte_treated_with_RPMI_d1-Novakovic2016',\n        'CD14-positive_monocyte_treated_with_RPMI_4h-Novakovic2016',\n        'CD14-positive_monocyte_treated_with_LPS_d6-Novakovic2016',\n        'CD14-positive_monocyte_treated_with_LPS_1h-Novakovic2016',\n        'THP_pmaLPS_ATAC_24h',\n        'THP_pmaLPS_ATAC_1h',\n        'dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_2_hour-Garber2017',\n        'CD14-positive_monocyte_treated_with_BG_d6-Novakovic2016',\n        'dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_30_minute-Garber2017',\n        'THP_pmaLPS_ATAC_120h',\n        'dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_4_hour-Garber2017',\n        'THP_pmaLPS_ATAC_48h',\n        'CD14-positive_monocytes-Roadmap',\n        'THP_pmaLPS_ATAC_12h', // monoctye\n      ],\n    },\n    {\n      label: 'B Cells',\n      categories: [\n        'Karpas-422-ENCODE', // b-cell cell line\n        'BJAB-Engreitz',\n        'BJAB_anti-IgM_anti-CD40_4hr-Engreitz',\n        'B_cell-ENCODE',\n        'OCI-LY7-ENCODE',\n        'GM12878-Roadmap',\n        'MM.1S-ENCODE',\n        'CD19-positive_B_cell-Roadmap',\n        'CD8-positive_alpha-beta_T_cell-ENCODE',\n      ],\n    },\n    {\n      label: 'T Cells',\n      categories: [\n        'Jurkat_anti-CD3_PMA_4hr-Engreitz', // t-cell\n        'Jurkat-Engreitz',\n        'CD3-positive_T_cell-Roadmap',\n        'CD4-positive_helper_T_cell-ENCODE',\n        'CD8-positive_alpha-beta_T_cell-Corces2016',\n        'thymus_fetal-Roadmap',\n        'CD4-positive_helper_T_cell-Corces2016',\n        'T-cell-ENCODE',\n      ],\n    },\n    {\n      label: 'Other haematopoietic cells',\n      categories: [\n        'spleen-ENCODE',\n        'K562-Roadmap',\n        'CD56-positive_natural_killer_cells-Roadmap',\n        'erythroblast-Corces2016',\n        'CD34-positive_mobilized-Roadmap',\n        'megakaryocyte-erythroid_progenitor-Corces2016',\n        'natural_killer_cell-Corces2016',\n        'IMR90-Roadmap',\n      ],\n    },\n    {\n      label: 'Fibroblasts',\n      categories: [\n        'foreskin_fibroblast-Roadmap',\n        'fibroblast_of_dermis-Roadmap',\n        'fibroblast_of_arm-ENCODE',\n        'astrocyte-ENCODE',\n        'fibroblast_of_lung-Roadmap',\n      ],\n    },\n    {\n      label: 'Epithelial',\n      categories: [\n        'small_intestine_fetal-Roadmap',\n        'epithelial_cell_of_prostate-ENCODE',\n        'HCT116-ENCODE',\n        'MCF-7-ENCODE',\n        'adrenal_gland_fetal-ENCODE',\n        'H7',\n        'keratinocyte-Roadmap',\n        'MCF10A-Ji2017',\n        'pancreas-Roadmap',\n        'mammary_epithelial_cell-Roadmap',\n        'stomach-Roadmap',\n        'LoVo',\n        'A549_treated_with_ethanol_0.02_percent_for_1_hour-Roadmap',\n        'PC-9-ENCODE',\n        'H1-hESC-Roadmap',\n        'thyroid_gland-ENCODE',\n        'HT29',\n        'MDA-MB-231',\n        'iPS_DF_19.11_Cell_Line-Roadmap',\n        'large_intestine_fetal-Roadmap',\n        'Panc1-ENCODE',\n        'adrenal_gland-ENCODE',\n        'MCF10A_treated_with_TAM24hr-Ji2017',\n        'trophoblast_cell-ENCODE',\n        'H1_BMP4_Derived_Trophoblast_Cultured_Cells-Roadmap',\n        'uterus-ENCODE',\n        'body_of_pancreas-ENCODE',\n        'stomach_fetal-Roadmap',\n        'H9-Roadmap',\n        'transverse_colon-ENCODE',\n        'H1_BMP4_Derived_Mesendoderm_Cultured_Cells-Roadmap',\n        'breast_epithelium-ENCODE',\n        'induced_pluripotent_stem_cell-ENCODE',\n        'LNCAP',\n        'H1_Derived_Mesenchymal_Stem_Cells-Roadmap',\n        'ovary-Roadmap',\n        'sigmoid_colon-ENCODE',\n        'skeletal_muscle_myoblast-Roadmap',\n        'bipolar_neuron_from_iPSC-ENCODE',\n        'coronary_artery_smooth_muscle_cell-Miller2016',\n        'SK-N-SH-ENCODE',\n        'muscle_of_trunk_fetal-Roadmap',\n      ],\n    },\n    {\n      label: 'Other',\n      categories: [\n        'adipose_tissue-ENCODE',\n        'HeLa-S3-Roadmap',\n        'hepatocyte-ENCODE',\n        'heart_ventricle-ENCODE',\n        'spinal_cord_fetal-ENCODE',\n        'coronary_artery-ENCODE',\n        'HepG2-Roadmap',\n        'muscle_of_leg_fetal-Roadmap',\n        'gastrocnemius_medialis-ENCODE',\n        'brite_adipose-Loft2014',\n        'placenta-Roadmap',\n        'liver-ENCODE',\n        'A673-ENCODE',\n        'white_adipose-Loft2014',\n        'cardiac_muscle_cell-ENCODE',\n        'osteoblast-ENCODE',\n        'H1_Derived_Neuronal_Progenitor_Cultured_Cells-Roadmap',\n        'endothelial_cell_of_umbilical_vein-Roadmap',\n        'NCCIT',\n        'myotube_originated_from_skeletal_muscle_myoblast-Roadmap',\n        'psoas_muscle-Roadmap',\n        'endothelial_cell_of_umbilical_vein_vegf_stim_4_hours-zhang2013',\n        'endothelial_cell_of_umbilical_vein_vegf_stim_12_hours-zhang2013',\n      ],\n    },\n  ],\n};\n\nexport const GROUPED_SAMPLE_OPTIONS = DEFAULT_STRATIFICATION.groups.map(\n  (group) => ({\n    name: group.label,\n    options: group.categories,\n  })\n);\n\nexport const SAMPLE_TO_GROUP = GROUPED_SAMPLE_OPTIONS.reduce(\n  (sampleToGroup, group) => {\n    group.options.forEach((option) => {\n      sampleToGroup[option] = group.name;\n    });\n    return sampleToGroup;\n  },\n  {}\n);\n\nexport const SAMPLES = GROUPED_SAMPLE_OPTIONS.flatMap((group) => group.options);\n\nexport const SAMPLE_IDX = SAMPLES.reduce((idxs, sample, idx) => {\n  idxs[sample] = idx;\n  return idxs;\n}, {});\n\nexport const DEFAULT_X_DOMAIN_START = 1761366260;\nexport const DEFAULT_X_DOMAIN_END = 1761603836;\n\nexport const DEFAULT_VARIANT_TRACK_SERVER = 'https://resgen.io/api/v1';\n\nexport const VARIANT_TRACK_ABBR_TO_SERVER = {\n  rg: 'https://resgen.io/api/v1',\n  hg: 'https://higlass.io/api/v1',\n};\n\nexport const VARIANT_TRACK_SERVER_TO_ABBR = Object.entries(\n  VARIANT_TRACK_ABBR_TO_SERVER\n).reduce((map, [abbr, server]) => {\n  map[server] = abbr;\n  return map;\n}, {});\n\nexport const DEFAULT_VARIANT_TRACK_SERVER_ABBR =\n  VARIANT_TRACK_SERVER_TO_ABBR[DEFAULT_VARIANT_TRACK_SERVER];\n\nexport const DEFAULT_VARIANT_TRACK_PVAL_COL = 7;\n\nexport const DEFAULT_VARIANT_TRACK_PPROB_COL = 8;\n\nexport const DEFAULT_VARIANT_TRACKS = [\n  {\n    server: 'https://resgen.io/api/v1',\n    tilesetUid: 'VF5-RDXWTxidGMJU7FeaxA',\n    columnPvalue: 7,\n    columnPosteriorProbability: 8,\n    markColor: 'black',\n    label: 'IBD Variants',\n  },\n];\n\nexport const DEFAULT_VARIANT_TRACK_DEF = {\n  type: 'point-annotation',\n  height: 32,\n  options: {\n    axisPositionHorizontal: 'right',\n    markColor: 'black',\n    markColorFocus: '#cc0078',\n    markSize: 2,\n    markOpacity: 0.33,\n    markOpacityFocus: 0.66,\n    valueColumn: 7,\n    name: 'Variants',\n    labelPosition: 'topLeft',\n    labelColor: 'black',\n    labelOpacity: 0.33,\n    showMousePosition: true,\n    showGlobalMousePosition: true,\n    mousePositionColor: 'black',\n    toolTip: {\n      name: {\n        field: 3,\n      },\n      value: {\n        field: 6,\n        numDecimals: 2,\n      },\n      other: [\n        {\n          label: 'Post. Prob.',\n          field: 7,\n          numDecimals: 2,\n        },\n      ],\n    },\n  },\n};\n\nexport const LOCAL_BED_TILESET_INFO_HG19 = {\n  zoom_step: 1,\n  max_length: 3137161265,\n  assembly: 'hg19',\n  chrom_names:\n    'chr1\\tchr2\\tchr3\\tchr4\\tchr5\\tchr6\\tchr7\\tchr8\\tchr9\\tchr10\\tchr11\\tchr12\\tchr13\\tchr14\\tchr15\\tchr16\\tchr17\\tchr18\\tchr19\\tchr20\\tchr21\\tchr22\\tchrX\\tchrY\\tchrM\\tchr6_ssto_hap7\\tchr6_mcf_hap5\\tchr6_cox_hap2\\tchr6_mann_hap4\\tchr6_apd_hap1\\tchr6_qbl_hap6\\tchr6_dbb_hap3\\tchr17_ctg5_hap1\\tchr4_ctg9_hap1\\tchr1_gl000192_random\\tchrUn_gl000225\\tchr4_gl000194_random\\tchr4_gl000193_random\\tchr9_gl000200_random\\tchrUn_gl000222\\tchrUn_gl000212\\tchr7_gl000195_random\\tchrUn_gl000223\\tchrUn_gl000224\\tchrUn_gl000219\\tchr17_gl000205_random\\tchrUn_gl000215\\tchrUn_gl000216\\tchrUn_gl000217\\tchr9_gl000199_random\\tchrUn_gl000211\\tchrUn_gl000213\\tchrUn_gl000220\\tchrUn_gl000218\\tchr19_gl000209_random\\tchrUn_gl000221\\tchrUn_gl000214\\tchrUn_gl000228\\tchrUn_gl000227\\tchr1_gl000191_random\\tchr19_gl000208_random\\tchr9_gl000198_random\\tchr17_gl000204_random\\tchrUn_gl000233\\tchrUn_gl000237\\tchrUn_gl000230\\tchrUn_gl000242\\tchrUn_gl000243\\tchrUn_gl000241\\tchrUn_gl000236\\tchrUn_gl000240\\tchr17_gl000206_random\\tchrUn_gl000232\\tchrUn_gl000234\\tchr11_gl000202_random\\tchrUn_gl000238\\tchrUn_gl000244\\tchrUn_gl000248\\tchr8_gl000196_random\\tchrUn_gl000249\\tchrUn_gl000246\\tchr17_gl000203_random\\tchr8_gl000197_random\\tchrUn_gl000245\\tchrUn_gl000247\\tchr9_gl000201_random\\tchrUn_gl000235\\tchrUn_gl000239\\tchr21_gl000210_random\\tchrUn_gl000231\\tchrUn_gl000229\\tchrUn_gl000226\\tchr18_gl000207_random',\n  chrom_sizes:\n    '249250621\\t243199373\\t198022430\\t191154276\\t180915260\\t171115067\\t159138663\\t146364022\\t141213431\\t135534747\\t135006516\\t133851895\\t115169878\\t107349540\\t102531392\\t90354753\\t81195210\\t78077248\\t59128983\\t63025520\\t48129895\\t51304566\\t155270560\\t59373566\\t16571\\t4928567\\t4833398\\t4795371\\t4683263\\t4622290\\t4611984\\t4610396\\t1680828\\t590426\\t547496\\t211173\\t191469\\t189789\\t187035\\t186861\\t186858\\t182896\\t180455\\t179693\\t179198\\t174588\\t172545\\t172294\\t172149\\t169874\\t166566\\t164239\\t161802\\t161147\\t159169\\t155397\\t137718\\t129120\\t128374\\t106433\\t92689\\t90085\\t81310\\t45941\\t45867\\t43691\\t43523\\t43341\\t42152\\t41934\\t41933\\t41001\\t40652\\t40531\\t40103\\t39939\\t39929\\t39786\\t38914\\t38502\\t38154\\t37498\\t37175\\t36651\\t36422\\t36148\\t34474\\t33824\\t27682\\t27386\\t19913\\t15008\\t4262',\n  tile_size: 1024.0,\n  max_zoom: 22,\n  max_width: 4294967296.0,\n  min_pos: [1],\n  max_pos: [3137161265],\n  header:\n    'chrom1\\tstart1\\tend1\\tchrom2\\tstart2\\tend2\\ttargetGene\\tscore\\tstrand1\\tstrand2\\tcellType',\n  version: 2,\n  coordSystem: '',\n};\n\nexport const DEFAULT_VIEW_CONFIG_ENHANCER = {\n  editable: false,\n  trackSourceServers: ['//higlass.io/api/v1'],\n  views: [\n    {\n      uid: 'context',\n      genomePositionSearchBox: {\n        autocompleteServer: '//higlass.io/api/v1',\n        autocompleteId: 'OHJakQICQD6gTD7skx4EWA',\n        chromInfoServer: '//higlass.io/api/v1',\n        chromInfoId: 'hg19',\n        visible: true,\n      },\n      chromInfoPath: '//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv',\n      tracks: {\n        top: [\n          {\n            type: 'combined',\n            uid: 'chroms-viewport',\n            height: 12,\n            contents: [\n              {\n                type: 'horizontal-chromosome-labels',\n                options: {\n                  // tickPositions: 'ends',\n                  color: '#999999',\n                  stroke: 'white',\n                  fontSize: 10,\n                  fontIsLeftAligned: true,\n                  showMousePosition: false,\n                  mousePositionColor: '#000000',\n                },\n                tilesetUid: 'ADfY_RtsQR6oKOMyrq6qhw',\n                height: 12,\n                server: 'https://resgen.io/api/v1',\n                uid: 'chroms',\n              },\n              {\n                uid: 'viewport-details-chroms',\n                type: 'viewport-projection-horizontal',\n                fromViewUid: 'details',\n                height: 12,\n                options: {\n                  projectionFillColor: '#cc0078',\n                  projectionStrokeColor: '#cc0078',\n                  projectionFillOpacity: 0.3,\n                  projectionStrokeOpacity: 0.3,\n                  strokeWidth: 1,\n                },\n              },\n            ],\n          },\n          {\n            type: 'combined',\n            uid: 'genes-tss-viewport',\n            height: 48,\n            contents: [\n              {\n                type: 'horizontal-gene-annotations',\n                uid: 'genes',\n                height: 48,\n                server: 'https://resgen.io/api/v1',\n                tilesetUid: 'NCifnbrKQu6j-ohVWJLoJw',\n                options: {\n                  fontSize: 9,\n                  plusStrandColor: 'black',\n                  minusStrandColor: 'black',\n                  geneAnnotationHeight: 10,\n                  geneLabelPosition: 'outside',\n                  geneStrandSpacing: 0.5,\n                  showMousePosition: true,\n                  showGlobalMousePosition: true,\n                  mousePositionColor: 'black',\n                },\n              },\n              {\n                type: 'tss',\n                uid: 'tss',\n                height: 48,\n                // server: 'http://localhost:9876/api/v1',\n                // tilesetUid: 'RefSeqCurated170308bedCollapsedGeneBoundsTSS500bp',\n                server: 'https://resgen.io/api/v1',\n                // tilesetUid: 'VMZDLKrtQDmJMSjg7Ds4yA',\n                tilesetUid: 'QRtec09sQjuVmUaB_uUFEw', // with scores for prioritization\n                options: {\n                  fontSize: 9,\n                  plusStrandColor: 'black',\n                  minusStrandColor: 'black',\n                  geneAnnotationHeight: 12,\n                  geneLabelPosition: 'outside',\n                  geneStrandSpacing: 2,\n                  maxPerTile: 25,\n                },\n              },\n              {\n                uid: 'viewport-details-genes',\n                type: 'viewport-projection-horizontal',\n                fromViewUid: 'details',\n                height: 48,\n                options: {\n                  projectionFillColor: '#cc0078',\n                  projectionStrokeColor: '#cc0078',\n                  projectionFillOpacity: 0.3,\n                  projectionStrokeOpacity: 0.3,\n                  strokeWidth: 1,\n                },\n              },\n            ],\n          },\n          {\n            type: 'combined',\n            uid: 'variants',\n            height: 32,\n            contents: [\n              {\n                type: 'point-annotation',\n                uid: 'ibd-snps',\n                // server: 'http://localhost:9876/api/v1',\n                // tilesetUid: 'IBDCombinedset1-2variantonly-pval',\n                server: 'https://resgen.io/api/v1',\n                tilesetUid: 'VF5-RDXWTxidGMJU7FeaxA',\n                height: 32,\n                options: {\n                  axisPositionHorizontal: 'right',\n                  markColor: 'black',\n                  markColorFocus: '#cc0078',\n                  markSize: 2,\n                  markOpacity: 0.33,\n                  markOpacityFocus: 0.66,\n                  // axisPositionHorizontal: 'right',\n                  valueColumn: 7,\n                  focusRegion: [\n                    1680373143 + 81046453 - 25,\n                    1680373143 + 81046453 + 25,\n                  ],\n                  name: 'IBD Variants',\n                  labelPosition: 'topLeft',\n                  labelColor: '#757575',\n                  showMousePosition: true,\n                  showGlobalMousePosition: true,\n                  mousePositionColor: 'black',\n                  toolTip: {\n                    name: {\n                      field: 3,\n                    },\n                    value: {\n                      field: 6,\n                      numDecimals: 2,\n                    },\n                    other: [\n                      {\n                        label: 'Post. Prob.',\n                        field: 7,\n                        numDecimals: 2,\n                      },\n                    ],\n                  },\n                },\n              },\n            ],\n          },\n          {\n            type: 'combined',\n            uid: 'arcs-stacked-bars',\n            height: 72,\n            contents: [\n              {\n                type: '1d-arcs',\n                uid: 'arcs',\n                server: 'https://resgen.io/api/v1',\n                tilesetUid: 'GOxTKzoLSsuw0BaG6eBrXw',\n                height: 72,\n                options: {\n                  labelPosition: 'hidden',\n                  strokeColor: '#808080',\n                  strokeWidth: 1,\n                  strokeOpacity: 0.05,\n                  arcStyle: 'circle',\n                  startField: 1,\n                  endField: 4,\n                  filter: {\n                    set: SAMPLES,\n                    field: 10,\n                  },\n                },\n              },\n              {\n                type: 'stacked-bar',\n                // server: 'http://localhost:9876/api/v1',\n                // tilesetUid: 'AllPredictionsAvgHiCABC0015minus150ForABCPaperV2hg19beddb',\n                server: 'https://resgen.io/api/v1',\n                // tilesetUid: 'P0Ng5fhvQWeO7dlpx0FknA', // all chroms\n                // tilesetUid: 'PGXLE50tQyOayNXKUnX4fQ', // just chr10\n                // tilesetUid: 'AaJojHeORzKyiag1pSlAag', // bed\n                tilesetUid: 'GOxTKzoLSsuw0BaG6eBrXw', // improved bed\n                height: 72,\n                uid: 'stacked-bars',\n                options: {\n                  binSize: 4,\n                  axisAlign: 'right',\n                  axisPositionHorizontal: 'right',\n                  labelPosition: 'topLeft',\n                  markColor: 'black',\n                  markColorFocus: '#cc0078',\n                  markSize: 4,\n                  markOpacity: 0.33,\n                  labelColor: 'black',\n                  offsetField: 3,\n                  startField: 4,\n                  endField: 5,\n                  importanceField: 7,\n                  importanceDomain: [0, 1],\n                  focusRegion: [\n                    1680373143 + 81046453 - 25,\n                    1680373143 + 81046453 + 25,\n                  ],\n                  name: 'Enhancer regions',\n                  stratification: DEFAULT_STRATIFICATION,\n                  showMousePosition: true,\n                  showGlobalMousePosition: true,\n                  mousePositionColor: 'black',\n                },\n              },\n            ],\n          },\n          {\n            type: 'stratified-bed',\n            // server: 'http://localhost:9876/api/v1',\n            // tilesetUid: 'AllPredictionsAvgHiCABC0015minus150ForABCPaperV2hg19beddb',\n            server: 'https://resgen.io/api/v1',\n            // tilesetUid: 'P0Ng5fhvQWeO7dlpx0FknA', // all chroms\n            // tilesetUid: 'PGXLE50tQyOayNXKUnX4fQ', // just chr10\n            // tilesetUid: 'AaJojHeORzKyiag1pSlAag', // bed\n            tilesetUid: 'GOxTKzoLSsuw0BaG6eBrXw', // improved bed\n            height: 413,\n            uid: 'indicatorByCellTypes',\n            options: {\n              axisAlign: 'right',\n              legendAlign: 'left',\n              labelPosition: 'hidden',\n              markColor: 'black',\n              markColorHighlight: '#bf0071',\n              markColorDehighlight: '#bbbbbb',\n              markSize: 4,\n              markMinWidth: 4,\n              markHeight: 3,\n              rowHeight: 3,\n              markOpacity: 0.33,\n              arcStyle: 'indicator',\n              indicatorStyle: 'category-rect',\n              labelColor: 'black',\n              geneField: 6,\n              importanceField: 7,\n              importanceDomain: [0, 1],\n              // focusRegion: [\n              //   1680373143 + 81046453 - 25,\n              //   1680373143 + 81046453 + 25,\n              // ],\n              name: 'By Celltype',\n              axisPositionHorizontal: 'right',\n              stratification: DEFAULT_STRATIFICATION,\n              showMousePosition: true,\n              showGlobalMousePosition: true,\n              mousePositionColor: 'black',\n            },\n          },\n        ],\n      },\n      overlays: [\n        {\n          uid: 'region-focus',\n          includes: [\n            'genes-tss-viewport',\n            'variants',\n            'arcs-stacked-bars',\n            'indicatorByCellTypes',\n          ],\n          options: {\n            extent: [[1680373143 + 81046453, 1680373143 + 81046454]],\n            minWidth: 3,\n            fill: '#cc0078',\n            fillOpacity: 0.05,\n            strokeWidth: 0,\n            outline: '#cc0078',\n            outlineOpacity: 0.33,\n            outlineWidth: 1,\n            outlinePos: ['left', 'right'],\n          },\n        },\n        {\n          uid: 'gene-focus',\n          includes: ['genes-tss-viewport'],\n          options: {\n            extent: [],\n            minWidth: 3,\n            fill: '#cc0078',\n            fillOpacity: 0.25,\n            stroke: '#cc0078',\n            strokeWidth: 0,\n            outlineWidth: 0,\n          },\n        },\n        {\n          uid: 'tss-overlays',\n          includes: [\n            'chroms',\n            'genes-tss-viewport',\n            'variants',\n            'arcs-stacked-bars',\n            'indicatorByCellTypes',\n          ],\n          options: {\n            extent: [],\n            minWidth: 1,\n            fill: 'black',\n            fillOpacity: 0.05,\n            strokeWidth: 0,\n            outline: 'black',\n            outlineOpacity: 0.1,\n            outlineWidth: 1,\n            outlinePos: ['left'],\n          },\n        },\n      ],\n      metaTracks: [\n        {\n          uid: 'tss-overlays-meta',\n          type: 'annotation-overlay',\n          overlaysTrack: 'tss-overlays',\n          options: {\n            annotationTracks: ['tss'],\n          },\n        },\n      ],\n      layout: {\n        w: 12,\n        h: 12,\n        x: 0,\n        y: 0,\n      },\n      initialXDomain: [DEFAULT_X_DOMAIN_START, DEFAULT_X_DOMAIN_END],\n      initialYDomain: [DEFAULT_X_DOMAIN_START, DEFAULT_X_DOMAIN_END],\n    },\n  ],\n};\n\nexport const DEFAULT_DNA_ACCESSIBILITY_ROW_SELECTION = [\n  120,\n  36,\n  54,\n  20,\n  80,\n  35,\n  101,\n  49,\n  44,\n  23,\n  30,\n  66,\n  5,\n  26,\n  15,\n  105,\n  57,\n  56,\n  74,\n  84,\n  79,\n  93,\n  106,\n  107,\n  34,\n  28,\n  25,\n  55,\n  121,\n  94,\n  58,\n  69,\n  67,\n  63,\n  126,\n  71,\n  72,\n  47,\n  11,\n  46,\n  39,\n  113,\n  29,\n  60,\n  45,\n  76,\n  21,\n  103,\n  129,\n  13,\n  128,\n  90,\n  104,\n  32,\n  109,\n  27,\n  9,\n  130,\n  95,\n  86,\n  53,\n  73,\n  50,\n  48,\n  78,\n  14,\n  92,\n  124,\n  31,\n  114,\n  64,\n  88,\n  12,\n  10,\n  38,\n  68,\n  3,\n  111,\n  70,\n  22,\n  61,\n  98,\n  6,\n  123,\n  118,\n  43,\n  37,\n  65,\n  81,\n  62,\n  33,\n  1,\n  24,\n  122,\n  83,\n  75,\n  112,\n  40,\n  97,\n  16,\n  117,\n  87,\n  19,\n  125,\n  7,\n  102,\n  116,\n  77,\n  8,\n  17,\n  82,\n  115,\n  89,\n  119,\n  18,\n  4,\n  108,\n  59,\n  127,\n  91,\n  0,\n  100,\n  85,\n  110,\n  99,\n  2,\n  96,\n  51,\n  41,\n  52,\n  42,\n];\n\nexport const DEFAULT_DNA_ACCESSIBILITY_ROW_CATEGORIES = DEFAULT_STRATIFICATION.groups.reduce(\n  (row, group, index) => {\n    const category = {\n      label: group.label,\n      color: group.axisLabelColor,\n      background: group.axisLabelBackground,\n      index,\n    };\n    group.categories.forEach((sample) => {\n      row[sample] = category;\n    });\n    return row;\n  },\n  {}\n);\n\nexport const DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY = {\n  zoomFixed: false,\n  editable: false,\n  trackSourceServers: ['//higlass.io/api/v1'],\n  views: [\n    {\n      uid: 'details',\n      chromInfoPath: '//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv',\n      tracks: {\n        top: [\n          {\n            uid: 'chroms',\n            type: 'horizontal-chromosome-labels',\n            server: 'https://resgen.io/api/v1',\n            tilesetUid: 'ADfY_RtsQR6oKOMyrq6qhw',\n            height: 17,\n            options: {\n              // tickPositions: 'ends',\n              color: '#999999',\n              stroke: 'white',\n              fontSize: 10,\n              fontIsLeftAligned: true,\n              showMousePosition: false,\n              mousePositionColor: '#000000',\n            },\n          },\n          {\n            uid: 'genes',\n            type: 'horizontal-gene-annotations',\n            server: 'https://resgen.io/api/v1',\n            tilesetUid: 'NCifnbrKQu6j-ohVWJLoJw',\n            height: 48,\n            options: {\n              fontSize: 9,\n              plusStrandColor: 'black',\n              minusStrandColor: 'black',\n              geneAnnotationHeight: 10,\n              geneLabelPosition: 'outside',\n              geneStrandSpacing: 0.5,\n              showMousePosition: true,\n              showGlobalMousePosition: true,\n              mousePositionColor: 'black',\n            },\n          },\n          {\n            type: 'combined',\n            uid: 'variants',\n            height: 32,\n            contents: [\n              {\n                type: 'point-annotation',\n                uid: 'ibd-snps',\n                // server: 'http://localhost:9876/api/v1',\n                // tilesetUid: 'IBDCombinedset1-2variantonly-pval',\n                server: 'https://resgen.io/api/v1',\n                tilesetUid: 'VF5-RDXWTxidGMJU7FeaxA',\n                height: 32,\n                options: {\n                  axisPositionHorizontal: 'right',\n                  markColor: 'black',\n                  markColorFocus: '#cc0078',\n                  markSize: 2,\n                  markOpacity: 0.33,\n                  markOpacityFocus: 0.66,\n                  // axisPositionHorizontal: 'right',\n                  valueColumn: 7,\n                  focusRegion: [\n                    1680373143 + 81046453 - 25,\n                    1680373143 + 81046453 + 25,\n                  ],\n                  name: 'IBD Variants',\n                  labelPosition: 'topLeft',\n                  labelColor: '#757575',\n                  showMousePosition: true,\n                  showGlobalMousePosition: true,\n                  mousePositionColor: 'black',\n                  toolTip: {\n                    name: {\n                      field: 3,\n                    },\n                    value: {\n                      field: 6,\n                      numDecimals: 2,\n                    },\n                    other: [\n                      {\n                        label: 'Post. Prob.',\n                        field: 7,\n                        numDecimals: 2,\n                      },\n                    ],\n                  },\n                },\n              },\n            ],\n          },\n          {\n            uid: 'dna-accessibility',\n            type: 'ridge-plot',\n            // server: 'http://localhost:9876/api/v1',\n            // tilesetUid: 'test',\n            server: 'https://resgen.io/api/v1',\n            tilesetUid: 'Uz1_tEABQf-uzktblvBKSQ',\n            // height: 403,\n            height: 131 * (24 - 6) + 6,\n            options: {\n              name: 'DNA Accessibility',\n              labelPosition: 'outerBottom',\n              labelShowResolution: false,\n              labelShowAssembly: false,\n              markArea: true,\n              markColor: '#444444',\n              markResolution: 256,\n              valueScaling: 'exponential',\n              colorRange: ['#ffffff', '#000000'],\n              rowHeight: 24,\n              rowPadding: -6,\n              rowNormalization: true,\n              rowSelections: DEFAULT_DNA_ACCESSIBILITY_ROW_SELECTION,\n              rowIdToCategory: {\n                fn: 'replace',\n                args: ['.accessibility', ''],\n              },\n              rowCategories: DEFAULT_DNA_ACCESSIBILITY_ROW_CATEGORIES,\n              showRowLabels: true,\n              rowLabelSize: 10,\n              showMousePosition: true,\n              showGlobalMousePosition: true,\n              mousePositionColor: 'black',\n            },\n          },\n        ],\n      },\n      overlays: [\n        {\n          uid: 'region-focus',\n          includes: ['genes', 'variants', 'dna-accessibility'],\n          options: {\n            extent: [],\n            minWidth: 3,\n            fill: '#cc0078',\n            fillOpacity: 0.05,\n            strokeWidth: 0,\n            outline: '#cc0078',\n            outlineOpacity: 0.33,\n            outlineWidth: 1,\n            outlinePos: ['left', 'right'],\n          },\n        },\n      ],\n      layout: {\n        w: 12,\n        h: 12,\n        x: 0,\n        y: 0,\n      },\n      initialXDomain: [\n        1680373143 + 81046453 - 500,\n        1680373143 + 81046454 + 500,\n      ],\n      initialYDomain: [\n        1680373143 + 81046453 - 500,\n        1680373143 + 81046454 + 500,\n      ],\n    },\n  ],\n};\n\nexport const IGNORED_FOCUS_ELEMENTS = new Set(['input', 'textarea']);\n\nexport const HIGLASS_PAN_ZOOM = 'panZoom';\n\nexport const HIGLASS_SELECT = 'select';\n","import { deepClone, isFunction } from '@flekschas/utils';\n\nimport { getIntervalCenter } from './utils';\n\nimport { DEFAULT_VARIANT_TRACK_DEF } from './constants';\n\nconst getFocusGeneRegion = (viewConfig) => {\n  return viewConfig.views[0].overlays[1] &&\n    viewConfig.views[0].overlays[1].options.extent &&\n    viewConfig.views[0].overlays[1].options.extent.length\n    ? [...viewConfig.views[0].overlays[1].options.extent[0]]\n    : null;\n};\n\nconst getFocusVariantRegion = (viewConfig) => {\n  const track = viewConfig.views[0].tracks.top[2];\n  let focusRegion = null;\n\n  if (track.type === 'combined') {\n    if (!track.contents[0]) return focusRegion;\n    focusRegion = track.contents[0].options.focusRegion;\n  } else {\n    focusRegion = track.options.focusRegion;\n  }\n\n  return focusRegion ? [...focusRegion] : focusRegion;\n};\n\nexport const updateViewConfigVariantTracks = (variantTrackConfigs) => (\n  viewConfig\n) => {\n  const track = viewConfig.views[0].tracks.top[2];\n\n  if (track.type === 'combined') {\n    track.contents = variantTrackConfigs.reduce((tracks, trackConfig) => {\n      const variantTrack = deepClone(DEFAULT_VARIANT_TRACK_DEF);\n      if (trackConfig.server && trackConfig.tilesetUid) {\n        variantTrack.server = trackConfig.server;\n        variantTrack.tilesetUid = trackConfig.tilesetUid;\n        variantTrack.uid = `variants-${trackConfig.tilesetUid}`;\n        if (trackConfig.label) {\n          variantTrack.options.name = trackConfig.label;\n        } else {\n          // Lets rely on the tileset name\n          delete variantTrack.options.name;\n        }\n        tracks.push(variantTrack);\n      } else if (trackConfig.file) {\n        variantTrack.data = { type: 'localBed', id: trackConfig.file.name };\n        variantTrack.uid = `variants-${trackConfig.file.name}`;\n        variantTrack.options.name = trackConfig.label || 'Variants';\n        tracks.push(variantTrack);\n      }\n      return tracks;\n    }, []);\n\n    track.height = (track.contents.length > 0) * 32;\n  }\n\n  return viewConfig;\n};\n\nexport const updateViewConfigFocusRegion = (region, trackIdxs = []) => (\n  viewConfig\n) => {\n  const delFocusRegion = (track, focusRegion) => {\n    if (track.type === 'combined') {\n      track.contents.forEach((childTrack) => {\n        delete childTrack.options.focusRegion;\n      });\n    } else {\n      delete track.options.focusRegion;\n    }\n  };\n\n  const setFocusRegion = (track, focusRegion) => {\n    if (track.type === 'combined') {\n      track.contents.forEach((childTrack) => {\n        childTrack.options.focusRegion = focusRegion;\n      });\n    } else {\n      track.options.focusRegion = focusRegion;\n    }\n  };\n\n  if (!Array.isArray(region) || region === null) {\n    trackIdxs.forEach((trackIdx) => {\n      delFocusRegion(viewConfig.views[0].tracks.top[trackIdx]);\n    });\n    viewConfig.views[0].overlays[0].options.extent = [];\n  } else {\n    const focusRegion = [region[0] - 0.5, region[1] - 0.5];\n\n    trackIdxs.forEach((trackIdx) => {\n      setFocusRegion(viewConfig.views[0].tracks.top[trackIdx], focusRegion);\n    });\n\n    viewConfig.views[0].overlays[0].options.extent = [focusRegion];\n  }\n\n  return viewConfig;\n};\n\nexport const updateViewConfigVariantYScale = (yScale) => (viewConfig) => {\n  const track = viewConfig.views[0].tracks.top[2];\n\n  if (track.type === 'combined') {\n    track.contents.forEach((childTrack) => {\n      childTrack.options.valueColumn = yScale === 'pValue' ? 7 : 8;\n    });\n  } else {\n    track.options.valueColumn = yScale === 'pValue' ? 7 : 8;\n  }\n\n  return viewConfig;\n};\n\nexport const updateViewConfigXDomain = (\n  newXDomainStart,\n  newXDomainEnd,\n  { force = false } = {}\n) => (viewConfig) => {\n  const _force = force === true || (isFunction(force) && force());\n\n  const xDomain = [...viewConfig.views[0].initialXDomain];\n  const focusGeneRegion = getFocusGeneRegion(viewConfig);\n  const focusVariantRegion = getFocusVariantRegion(viewConfig);\n\n  if (!Number.isNaN(+newXDomainStart)) {\n    xDomain[0] = newXDomainStart;\n  }\n  if (!Number.isNaN(+newXDomainEnd)) {\n    xDomain[1] = newXDomainEnd;\n  }\n\n  if (focusGeneRegion && !_force) {\n    xDomain[0] = focusGeneRegion[0] - 100000;\n    xDomain[1] = focusGeneRegion[1] + 100000;\n  }\n\n  if (focusVariantRegion && !_force) {\n    xDomain[0] = Math.min(xDomain[0], focusVariantRegion[0] - 100000);\n    xDomain[1] = Math.max(xDomain[1], focusVariantRegion[1] + 100000);\n  }\n\n  viewConfig.views[0].initialXDomain = xDomain;\n\n  return viewConfig;\n};\n\nexport const updateViewConfigFocusGene = (gene, start, end) => (viewConfig) => {\n  const n = viewConfig.views[0].tracks.top.length;\n\n  if (gene) {\n    viewConfig.views[0].tracks.top[n - 1].options.focusGene = gene;\n    viewConfig.views[0].overlays[1].options.extent = [[start, end]];\n  } else {\n    delete viewConfig.views[0].tracks.top[n - 1].options.focusGene;\n    delete viewConfig.views[0].overlays[1].options.extent;\n  }\n\n  return viewConfig;\n};\n\nexport const getDnaAccessXDomain = (\n  focusRegionAbs,\n  focusGeneStart,\n  focusGeneEnd,\n  xDomainStartAbs,\n  xDomainEndAbs\n) => {\n  const enhancerViewRange = xDomainEndAbs - xDomainStartAbs;\n  const enhancerViewCenter = xDomainStartAbs + enhancerViewRange / 2;\n\n  if (focusRegionAbs) {\n    const focusRegionCenter = getIntervalCenter(focusRegionAbs);\n    if (\n      enhancerViewRange < 5000 &&\n      Math.abs(enhancerViewCenter - focusRegionCenter) < 1000\n    ) {\n      return [xDomainStartAbs, xDomainEndAbs];\n    }\n    return [focusRegionAbs[0] - 2500, focusRegionAbs[1] + 2500];\n  }\n\n  if (focusGeneStart && focusGeneEnd) {\n    const midPos = focusGeneStart + (focusGeneEnd - focusGeneStart) / 2;\n\n    if (\n      enhancerViewRange < 5000 &&\n      enhancerViewCenter > focusGeneStart &&\n      enhancerViewCenter < focusGeneEnd\n    ) {\n      return [xDomainStartAbs, xDomainEndAbs];\n    }\n\n    return [midPos - 2500, midPos + 2500];\n  }\n\n  return [xDomainStartAbs, xDomainEndAbs];\n};\n","import { atom, selector } from 'recoil';\nimport { memoize } from 'lodash-es';\nimport { deepClone, identity } from '@flekschas/utils';\n\nimport {\n  useRecoilQueryString,\n  useRecoilQueryStringSyncher,\n} from './use-query-string';\n\nimport {\n  booleanQueryStringDecoder,\n  customBooleanQueryStringDecoder,\n  getQueryStringValue,\n  toAbsPosition,\n  isChrRange,\n  chrPosUrlDecoder,\n  chrPosUrlEncoder,\n  chrRangePosUrlDecoder,\n  chrRangePosUrlEncoder,\n  chrRangePosEncoder,\n} from './utils';\n\nimport {\n  DEFAULT_X_DOMAIN_START,\n  DEFAULT_X_DOMAIN_END,\n  DEFAULT_VARIANT_TRACKS,\n  DEFAULT_VARIANT_TRACK_SERVER_ABBR,\n  DEFAULT_VARIANT_TRACK_PVAL_COL,\n  DEFAULT_VARIANT_TRACK_PPROB_COL,\n  VARIANT_TRACK_ABBR_TO_SERVER,\n  VARIANT_TRACK_SERVER_TO_ABBR,\n  GROUPED_SAMPLE_OPTIONS,\n  SAMPLES,\n} from './constants';\n\nimport { getDnaAccessXDomain } from './view-config';\n\nconst getDefault = (key, initialValue, decoder) => {\n  const qVal = getQueryStringValue(key, decoder);\n  return qVal === undefined ? initialValue : qVal;\n};\n\nconst showWelcomeDecoder = customBooleanQueryStringDecoder(['intro']);\n\nconst variantTracksDecoder = (v) => {\n  if (!v) return undefined;\n\n  // tilesetId:rg:7:8\n  const [\n    tilesetUid,\n    serverAbbr = DEFAULT_VARIANT_TRACK_SERVER_ABBR,\n    columnPvalue = DEFAULT_VARIANT_TRACK_PVAL_COL,\n    columnPosteriorProbability = DEFAULT_VARIANT_TRACK_PPROB_COL,\n  ] = v.split(':');\n\n  const server = VARIANT_TRACK_ABBR_TO_SERVER[serverAbbr];\n\n  if (tilesetUid === undefined) return tilesetUid;\n\n  return [\n    {\n      server,\n      tilesetUid,\n      columnPvalue,\n      columnPosteriorProbability,\n      markColor: 'black',\n    },\n  ];\n};\n\nconst variantTracksEncoder = (v) => {\n  if (!v || !Array.isArray(v) || v.length > 1) return '';\n\n  const { tilesetUid } = v[0];\n  const serverAbbr =\n    VARIANT_TRACK_SERVER_TO_ABBR[v[0].server] ===\n    DEFAULT_VARIANT_TRACK_SERVER_ABBR\n      ? null\n      : VARIANT_TRACK_SERVER_TO_ABBR[v[0].server];\n  const pValCol =\n    v[0].columnPvalue === DEFAULT_VARIANT_TRACK_PVAL_COL\n      ? null\n      : v[0].columnPvalue;\n  const pProbCol =\n    v[0].columnPosteriorProbability === DEFAULT_VARIANT_TRACK_PPROB_COL\n      ? null\n      : v[0].columnPosteriorProbability;\n\n  if (!tilesetUid || serverAbbr === undefined) return '';\n\n  return [tilesetUid, serverAbbr, pValCol, pProbCol].filter(identity).join(':');\n};\n\n// Atoms\nexport const sampleFilterState = atom({\n  key: 'sampleFilterState',\n  default: '',\n});\n\nexport const sampleSelectionState = selector({\n  key: 'sampleSelection',\n  get: ({ get }) => SAMPLES.map((name) => get(sampleWithName(name)).checked),\n});\n\nexport const selectedSamplesState = selector({\n  key: 'selectedSamples',\n  get: ({ get }) => SAMPLES.filter((name) => get(sampleWithName(name)).checked),\n});\n\nexport const sampleWithName = memoize((name) =>\n  atom({\n    key: `sample-${name}`,\n    default: {\n      checked: true,\n      visible: true,\n    },\n  })\n);\n\nexport const sampleGroupWithGroup = memoize(\n  (group) =>\n    atom({\n      key: `sampleGroup-${group.name}`,\n      default: {\n        checked: true,\n        visible: true,\n        n: group.options.length,\n        N: group.options.length,\n      },\n    }),\n  (group) => group.name\n);\n\nexport const sampleGroupSelectionSizesState = selector({\n  key: 'sampleGroupSelectionSizes',\n  get: ({ get }) =>\n    GROUPED_SAMPLE_OPTIONS.reduce((sizes, group) => {\n      sizes[group.name] = get(sampleGroupWithGroup(group)).n;\n      return sizes;\n    }, {}),\n});\n\nexport const variantTracksState = atom({\n  key: 'variantTracks',\n  default: getDefault(\n    'vt',\n    deepClone(DEFAULT_VARIANT_TRACKS),\n    variantTracksDecoder\n  ),\n});\n\nexport const showVariantsSettingsState = atom({\n  key: 'showVariantsSettings',\n  default: false,\n});\n\nexport const showWelcomeState = atom({\n  key: 'showWelcome',\n  default: getDefault('w', true, showWelcomeDecoder),\n});\n\nexport const dnaAccessLabelStyleState = atom({\n  key: 'dnaAccessLabelStyle',\n  default: getDefault('dal', 'indicator'),\n});\n\nexport const dnaAccessRowNormState = atom({\n  key: 'dnaAccessRowNorm',\n  default: getDefault('darn', true, booleanQueryStringDecoder),\n});\n\nexport const dnaAccessLabelShowInfoState = atom({\n  key: 'dnaAccessLabelShowInfos',\n  default: getDefault('dai', true, booleanQueryStringDecoder),\n});\n\nexport const focusGeneState = atom({\n  key: 'focusGene',\n  default: getDefault('g', ''),\n});\n\nexport const focusGeneOptionState = atom({\n  key: 'focusGeneOption',\n  default: null,\n});\n\nexport const focusRegionState = atom({\n  key: `focusRegion`,\n  default: getDefault('f', 'rs1250566', (v) =>\n    v && isChrRange(v) ? chrRangePosUrlDecoder(v) : v\n  ),\n});\n\nexport const focusRegionOptionState = atom({\n  key: `focusRegionOption`,\n  default: getDefault('f', null, (v) => {\n    if (!v || !isChrRange(v)) return null;\n\n    const [start, end] = chrRangePosUrlDecoder(v);\n\n    if (!start || !end) return null;\n\n    const [chrStart, txStart] = start.split(':');\n    const [chrEnd, txEnd] = end.split(':');\n\n    return {\n      chrStart,\n      chrEnd,\n      txStart: +txStart,\n      txEnd: +txEnd,\n      geneName: chrRangePosEncoder([start, end]),\n      type: 'region',\n    };\n  }),\n});\n\nexport const variantYScaleState = atom({\n  key: 'variantYScale',\n  default: getDefault('vy', 'pValue'),\n});\n\nexport const enhancerRegionsHideUnfocusedState = atom({\n  key: 'enhancerRegionsHideUnfocused',\n  default: getDefault('erhu', false, booleanQueryStringDecoder),\n});\n\nexport const enhancerRegionsColorEncodingState = atom({\n  key: 'enhancerRegionsColorEncoding',\n  default: getDefault('erc', 'solid'),\n});\n\nexport const enhancerRegionsShowInfoState = atom({\n  key: 'enhancerRegionsShowInfos',\n  default: getDefault('eri', true, booleanQueryStringDecoder),\n});\n\nexport const enhancerGenesShowInfoState = atom({\n  key: 'enhancerGenesShowInfos',\n  default: getDefault('egi', true, booleanQueryStringDecoder),\n});\n\nexport const enhancerGenesPaddingState = atom({\n  key: 'enhancerGenesPadding',\n  default: getDefault('egp', false, booleanQueryStringDecoder),\n});\n\nexport const enhancerGenesCellEncodingState = atom({\n  key: 'enhancerGenesCellEncoding',\n  default: getDefault('egce', 'number'),\n});\n\nexport const enhancerGenesSvgState = atom({\n  key: 'enhancerGenesSvg',\n  default: null,\n});\nexport const higlassEnhancerRegionsState = atom({\n  key: 'higlassEnhancerRegions',\n  default: null,\n});\n\nexport const higlassDnaAccessState = atom({\n  key: 'higlassDnaAccess',\n  default: null,\n});\n\n// Dynamic state\nexport const xDomainStartWithAssembly = memoize(\n  (chromInfo) =>\n    atom({\n      key: `xDomainStart-${chromInfo.totalLength}`,\n      default: getDefault(\n        'xs',\n        chromInfo.absToChr(DEFAULT_X_DOMAIN_START).slice(0, 2).join(':'),\n        chrPosUrlDecoder\n      ),\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\nexport const xDomainEndWithAssembly = memoize(\n  (chromInfo) =>\n    atom({\n      key: `xDomainEnd-${chromInfo.totalLength}`,\n      default: getDefault(\n        'xe',\n        chromInfo.absToChr(DEFAULT_X_DOMAIN_END).slice(0, 2).join(':'),\n        chrPosUrlDecoder\n      ),\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\n// Derived state\nexport const xDomainStartAbsWithAssembly = memoize(\n  (chromInfo) =>\n    selector({\n      key: `xDomainStartAbs-${chromInfo.totalLength}`,\n      get: ({ get }) => {\n        const xDomainStart = get(xDomainStartWithAssembly(chromInfo));\n        return toAbsPosition(xDomainStart, chromInfo);\n      },\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\nexport const xDomainEndAbsWithAssembly = memoize(\n  (chromInfo) =>\n    selector({\n      key: `xDomainEndAbs-${chromInfo.totalLength}`,\n      get: ({ get }) => {\n        const xDomainEnd = get(xDomainEndWithAssembly(chromInfo));\n        return toAbsPosition(xDomainEnd, chromInfo);\n      },\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\nexport const focusGeneStartWithAssembly = memoize(\n  (chromInfo) =>\n    selector({\n      key: `focusGeneStart-${chromInfo.totalLength}`,\n      get: ({ get }) => {\n        const focusGeneOption = get(focusGeneOptionState);\n        return focusGeneOption\n          ? toAbsPosition(\n              `${focusGeneOption.chr}:${focusGeneOption.txStart}`,\n              chromInfo\n            )\n          : null;\n      },\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\nexport const focusGeneEndWithAssembly = memoize(\n  (chromInfo) =>\n    selector({\n      key: `focusGeneEnd-${chromInfo.totalLength}`,\n      get: ({ get }) => {\n        const focusGeneOption = get(focusGeneOptionState);\n        return focusGeneOption\n          ? toAbsPosition(\n              `${focusGeneOption.chr}:${focusGeneOption.txEnd}`,\n              chromInfo\n            )\n          : null;\n      },\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\nexport const focusRegionAbsWithAssembly = memoize(\n  (chromInfo) =>\n    selector({\n      key: `focusRegionAbs-${chromInfo.totalLength}`,\n      get: ({ get }) => {\n        const focusRegionOption = get(focusRegionOptionState);\n\n        if (!focusRegionOption) return null;\n\n        if (focusRegionOption.chrStart)\n          return [\n            toAbsPosition(\n              `${focusRegionOption.chrStart}:${focusRegionOption.txStart}`,\n              chromInfo\n            ),\n            toAbsPosition(\n              `${focusRegionOption.chrEnd}:${focusRegionOption.txEnd}`,\n              chromInfo\n            ),\n          ];\n\n        const startAbs = toAbsPosition(\n          `${focusRegionOption.chr}:${focusRegionOption.txStart}`,\n          chromInfo\n        );\n\n        return [startAbs, startAbs + 1];\n      },\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\nexport const focusRegionRelState = selector({\n  key: 'focusVariantRel',\n  get: ({ get }) => {\n    const focusRegionOption = get(focusRegionOptionState);\n\n    if (!focusRegionOption) return null;\n\n    if (\n      focusRegionOption.chrStart &&\n      focusRegionOption.chrEnd &&\n      focusRegionOption.chrStart !== focusRegionOption.chrEnd\n    )\n      // The relative position doesn't exist because the selected region\n      // stretches across chromsomes\n      return Number.NaN;\n\n    if (focusRegionOption.chrStart) {\n      return (\n        +focusRegionOption.txStart +\n        (+focusRegionOption.txEnd - +focusRegionOption.txStart) / 2\n      );\n    }\n\n    return +focusRegionOption.txStart;\n  },\n});\n\nexport const focusRegionStrState = selector({\n  key: 'focusRegionStr',\n  get: ({ get }) => {\n    const focusRegionOption = get(focusRegionOptionState);\n\n    if (!focusRegionOption) return null;\n\n    const chrRange = focusRegionOption.chrStart\n      ? [\n          `${focusRegionOption.chrStart}:${focusRegionOption.txStart}`,\n          `${focusRegionOption.chrEnd}:${focusRegionOption.txEnd}`,\n        ]\n      : [\n          `${focusRegionOption.chr}:${focusRegionOption.txStart}`,\n          `${focusRegionOption.chr}:${focusRegionOption.txEnd}`,\n        ];\n\n    return chrRangePosEncoder(chrRange);\n  },\n});\n\nexport const dnaAccessXDomainWithAssembly = memoize(\n  (chromInfo) =>\n    selector({\n      key: 'dnaAccessXDomain',\n      get: ({ get }) => {\n        const focusRegionAbs = get(focusRegionAbsWithAssembly(chromInfo));\n        const focusGeneStart = get(focusGeneStartWithAssembly(chromInfo));\n        const focusGeneEnd = get(focusGeneEndWithAssembly(chromInfo));\n        const xDomainStartAbs = get(xDomainStartAbsWithAssembly(chromInfo));\n        const xDomainEndAbs = get(xDomainEndAbsWithAssembly(chromInfo));\n\n        return getDnaAccessXDomain(\n          focusRegionAbs,\n          focusGeneStart,\n          focusGeneEnd,\n          xDomainStartAbs,\n          xDomainEndAbs\n        );\n      },\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\n/*\n Predefined Hooks\n */\nexport const useVariantTracks = () =>\n  useRecoilQueryString('vt', variantTracksState, variantTracksEncoder);\nexport const useVariantTracksSyncher = () =>\n  useRecoilQueryStringSyncher('vt', variantTracksState, variantTracksEncoder);\n\nexport const useShowWelcome = () => useRecoilQueryString('w', showWelcomeState);\nexport const useShowWelcomeSyncher = () =>\n  useRecoilQueryStringSyncher('w', showWelcomeState);\n\nexport const useFocusGene = () => useRecoilQueryString('g', focusGeneState);\nexport const useFocusGeneSyncher = () =>\n  useRecoilQueryStringSyncher('g', focusGeneState);\n\nexport const useFocusRegion = (chromInfo) =>\n  useRecoilQueryString('f', focusRegionState, (v) =>\n    Array.isArray(v) ? chrRangePosUrlEncoder(v) : v\n  );\nexport const useFocusRegionSyncher = (chromInfo) =>\n  useRecoilQueryStringSyncher('f', focusRegionState, (v) =>\n    Array.isArray(v) ? chrRangePosUrlEncoder(v) : v\n  );\n\nexport const useDnaAccessLabelStyle = () =>\n  useRecoilQueryString('dal', dnaAccessLabelStyleState);\nexport const useDnaAccessLabelStyleSyncher = () =>\n  useRecoilQueryStringSyncher('dal', dnaAccessLabelStyleState);\n\nexport const useDnaAccessRowNorm = () =>\n  useRecoilQueryString('darn', dnaAccessRowNormState);\nexport const useDnaAccessRowNormSyncher = () =>\n  useRecoilQueryStringSyncher('darn', dnaAccessRowNormState);\n\nexport const useDnaAccessShowInfos = () =>\n  useRecoilQueryString('dai', dnaAccessLabelShowInfoState);\nexport const useDnaAccessShowInfosSyncher = () =>\n  useRecoilQueryStringSyncher('dai', dnaAccessLabelShowInfoState);\n\nexport const useXDomainStartWithAssembly = (chromInfo) =>\n  useRecoilQueryString(\n    's',\n    xDomainStartWithAssembly(chromInfo),\n    chrPosUrlEncoder\n  );\nexport const useXDomainStartWithAssemblySyncher = (chromInfo) =>\n  useRecoilQueryStringSyncher(\n    's',\n    xDomainStartWithAssembly(chromInfo),\n    chrPosUrlEncoder\n  );\n\nexport const useXDomainEndWithAssembly = (chromInfo) =>\n  useRecoilQueryString(\n    'e',\n    xDomainEndWithAssembly(chromInfo),\n    chrPosUrlEncoder\n  );\nexport const useXDomainEndWithAssemblySyncher = (chromInfo) =>\n  useRecoilQueryStringSyncher(\n    'e',\n    xDomainEndWithAssembly(chromInfo),\n    chrPosUrlEncoder\n  );\n\nexport const useEnhancerRegionsShowInfos = () =>\n  useRecoilQueryString('eri', enhancerRegionsShowInfoState);\nexport const useEnhancerRegionsShowInfosSyncher = () =>\n  useRecoilQueryStringSyncher('eri', enhancerRegionsShowInfoState);\n\nexport const useEnhancerRegionsHideUnfocused = () =>\n  useRecoilQueryString('eri', enhancerRegionsHideUnfocusedState);\nexport const useEnhancerRegionsHideUnfocusedSyncher = () =>\n  useRecoilQueryStringSyncher('eri', enhancerRegionsHideUnfocusedState);\n\nexport const useEnhancerRegionsColorEncoding = () =>\n  useRecoilQueryString('eri', enhancerRegionsColorEncodingState);\nexport const useEnhancerRegionsColorEncodingSyncher = () =>\n  useRecoilQueryStringSyncher('eri', enhancerRegionsColorEncodingState);\n\nexport const useEnhancerGenesShowInfos = () =>\n  useRecoilQueryString('egi', enhancerGenesShowInfoState);\nexport const useEnhancerGenesShowInfosSyncher = () =>\n  useRecoilQueryStringSyncher('egi', enhancerGenesShowInfoState);\n\nexport const useEnhancerGenesPadding = () =>\n  useRecoilQueryString('egp', enhancerGenesPaddingState);\nexport const useEnhancerGenesPaddingSyncher = () =>\n  useRecoilQueryStringSyncher('egp', enhancerGenesPaddingState);\n\nexport const useEnhancerGenesCellEncoding = () =>\n  useRecoilQueryString('egce', enhancerGenesCellEncodingState);\nexport const useEnhancerGenesCellEncodingSyncher = () =>\n  useRecoilQueryStringSyncher('egce', enhancerGenesCellEncodingState);\n\nexport const useVariantYScale = () =>\n  useRecoilQueryString('vs', variantYScaleState);\nexport const useVariantYScaleSyncher = () =>\n  useRecoilQueryStringSyncher('vs', variantYScaleState);\n","import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { useRecoilState } from 'recoil';\nimport { deepClone, isString } from '@flekschas/utils';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport TextField from '@material-ui/core/TextField';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport FileInput from './FileInput';\nimport { useChromInfo } from './ChromInfoProvider';\nimport createLocalBedDataServer from './local-bed-data-server';\n\nimport {\n  focusRegionOptionState,\n  useFocusRegion,\n  useVariantTracks,\n} from './state';\n\nimport { LOCAL_BED_TILESET_INFO_HG19 } from './constants';\n\nimport { chrRangePosEncoder } from './utils';\n\nconst useStyles = makeStyles((theme) => ({\n  note: {\n    color: theme.palette.grey['400'],\n    marginTop: '1em',\n  },\n  title: {\n    fontSize: '1.5rem',\n    fontWeight: 700,\n    margin: '0.5rem 0 0 0',\n  },\n  buttonNormal: {\n    minWidth: '10.5rem',\n    margin: '0 0.5rem',\n  },\n  buttonActive: {\n    minWidth: '10.5rem',\n    marginLeft: '0.5rem',\n    color: 'white',\n    background: '#cc0078 linear-gradient(45deg, #cc0078 30%, #cc0066 90%)',\n    boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .3)',\n    '&:hover': {\n      boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .5)',\n      background: '#d90080 linear-gradient(45deg, #d90080 30%, #d9006c 90%)',\n    },\n    '&:focus': {\n      boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .5)',\n    },\n  },\n  trackList: {\n    margin: '16px 0',\n  },\n}));\n\nconst useStylesTrackConfig = makeStyles((theme) => ({\n  icon: {\n    color: theme.palette.grey['400'],\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  grow: {\n    flex: 1,\n  },\n  separator: {\n    padding: '0 8px',\n  },\n  server: {\n    flex: 1,\n    marginRight: '2px',\n  },\n  tilesetUid: {\n    flex: 1,\n    marginLeft: '2px',\n  },\n  propInput: {\n    flex: 1,\n    marginLeft: '2px',\n    marginRight: '2px',\n    '&:first-child': {\n      marginLeft: 0,\n    },\n    '&:last-child': {\n      marginRight: 0,\n    },\n  },\n}));\n\nconst useStylesTooltipVisible = makeStyles((theme) => ({\n  arrow: {\n    color: 'black',\n  },\n  tooltip: {\n    backgroundColor: 'black',\n  },\n}));\n\nconst useStylesTooltipHidden = makeStyles((theme) => ({\n  tooltip: {\n    display: 'none',\n  },\n}));\n\nconst TrackConfig = React.memo(function TrackConfig({ config, onChange }) {\n  const [state, setState] = useState(config);\n\n  const propertyChangeHandler = (property) => (event) => {\n    // eslint-disable-next-line prefer-destructuring\n    const value = event.target.value;\n    setState((currState) => ({\n      ...currState,\n      [property]: value,\n    }));\n  };\n\n  const serverChangeHandler = (event) => {\n    const server = event.target.value;\n    setState((currState) => ({\n      ...currState,\n      server,\n      file: undefined,\n    }));\n  };\n\n  const tilesetUidChangeHandler = (event) => {\n    const tilesetUid = event.target.value;\n    setState((currState) => ({\n      ...currState,\n      tilesetUid,\n      file: undefined,\n    }));\n  };\n\n  const fileChangeHandler = (file) => {\n    setState((currState) => ({\n      ...currState,\n      file,\n      server: undefined,\n      tilesetUid: undefined,\n    }));\n  };\n\n  const fileClearHandler = () => {\n    setState((currState) => ({\n      ...currState,\n      file: undefined,\n    }));\n  };\n\n  useEffect(() => {\n    if (state !== config) onChange(state);\n  }, [onChange, state, config]);\n\n  const isRemote = Boolean(state.server || state.tilesetUid);\n  const isLocal = Boolean(state.whatever);\n\n  const classes = useStylesTrackConfig();\n  const classesTooltipVisible = useStylesTooltipVisible();\n  const classesTooltipHidden = useStylesTooltipHidden();\n\n  return (\n    <React.Fragment>\n      <Grid alignItems=\"center\" container>\n        <Grid className={classes.grow} item>\n          <Grid alignItems=\"center\" container>\n            <Tooltip\n              classes={isLocal ? classesTooltipVisible : classesTooltipHidden}\n              title=\"Setting a server will clear the file!\"\n              placement=\"top\"\n              arrow\n            >\n              <TextField\n                label=\"Server URL\"\n                variant=\"outlined\"\n                size=\"small\"\n                value={state.server || ''}\n                onChange={serverChangeHandler}\n                className={classes.server}\n              />\n            </Tooltip>\n            <Tooltip\n              classes={isLocal ? classesTooltipVisible : classesTooltipHidden}\n              title=\"Setting a tileset ID will clear the file!\"\n              placement=\"top\"\n              arrow\n            >\n              <TextField\n                label=\"Tileset ID\"\n                variant=\"outlined\"\n                size=\"small\"\n                value={state.tilesetUid || ''}\n                onChange={tilesetUidChangeHandler}\n                className={classes.tilesetUid}\n              />\n            </Tooltip>\n          </Grid>\n        </Grid>\n        <Grid item>\n          <Typography className={classes.separator}>or</Typography>\n        </Grid>\n        <Grid item>\n          <Tooltip\n            classes={isRemote ? classesTooltipVisible : classesTooltipHidden}\n            title=\"Selecting a file will clear the server and tileset ID!\"\n            placement=\"top\"\n            arrow\n          >\n            <FileInput\n              file={state.file}\n              onChange={fileChangeHandler}\n              onClear={fileClearHandler}\n            />\n          </Tooltip>\n        </Grid>\n      </Grid>\n      <Grid alignItems=\"center\" container>\n        <TextField\n          label=\"Name\"\n          variant=\"outlined\"\n          margin=\"normal\"\n          size=\"small\"\n          value={state.label || ''}\n          onChange={propertyChangeHandler('label')}\n          className={classes.propInput}\n        />\n        <TextField\n          label=\"Column P-Value\"\n          variant=\"outlined\"\n          margin=\"normal\"\n          size=\"small\"\n          type=\"number\"\n          min=\"1\"\n          step=\"1\"\n          value={state.columnPvalue || 7}\n          onChange={propertyChangeHandler('columnPvalue')}\n          className={classes.propInput}\n        />\n        <TextField\n          label=\"Column Post. Prob\"\n          variant=\"outlined\"\n          margin=\"normal\"\n          size=\"small\"\n          type=\"number\"\n          min=\"1\"\n          step=\"1\"\n          value={state.columnPosteriorProbability || 8}\n          onChange={propertyChangeHandler('columnPosteriorProbability')}\n          className={classes.propInput}\n        />\n      </Grid>\n    </React.Fragment>\n  );\n});\n\nconst VariantsSettings = React.memo(function VariantsSettings({\n  closeHandler,\n}) {\n  const chromInfo = useChromInfo();\n\n  const setFocusRegion = useFocusRegion()[1];\n  const [variantTracks, setVariantTracks] = useVariantTracks();\n\n  const [focusRegionOption, setFocusRegionOption] = useRecoilState(\n    focusRegionOptionState\n  );\n\n  const [tmpVariantTracks, setTmpVariantTracks] = useState(() =>\n    deepClone(variantTracks)\n  );\n  const [changed, setChanged] = useState(false);\n  const variantTrackServers = useRef([]);\n  const currVariantTracks = useRef(variantTracks);\n\n  useEffect(() => {\n    currVariantTracks.current = variantTracks;\n  }, [variantTracks]);\n\n  const changeTmpVariantTracks = useCallback(\n    (i) => (newTrackConfig) => {\n      setTmpVariantTracks((currTmpVariantTracks) => {\n        const newTmpVariantTracks = [...currTmpVariantTracks];\n        newTmpVariantTracks[i] = newTrackConfig;\n        return newTmpVariantTracks;\n      });\n      setChanged(true);\n    },\n    []\n  );\n\n  const saveHandler = useCallback(() => {\n    const newVariantTracks = deepClone(tmpVariantTracks);\n\n    // Destroy old servers\n    variantTrackServers.current.forEach((server) => {\n      server.destroy();\n    });\n\n    // Create new servers\n    variantTrackServers.current = newVariantTracks.reduce(\n      (servers, trackConfig) => {\n        if (trackConfig.file) {\n          const tilesetInfo = {\n            ...LOCAL_BED_TILESET_INFO_HG19,\n            name: trackConfig.file,\n          };\n          servers.push(\n            createLocalBedDataServer(\n              trackConfig.file,\n              trackConfig.file.name,\n              chromInfo,\n              tilesetInfo,\n              {\n                header: true,\n                columnImportance: 7,\n              }\n            )\n          );\n        }\n        return servers;\n      },\n      []\n    );\n    setVariantTracks(newVariantTracks);\n    if (\n      newVariantTracks.some(\n        (newTrackConfig, i) =>\n          newTrackConfig.server !== currVariantTracks.current[i].server\n      ) ||\n      newVariantTracks.some(\n        (newTrackConfig, i) =>\n          newTrackConfig.tilesetUid !== currVariantTracks.current[i].tilesetUid\n      ) ||\n      newVariantTracks.some(\n        (newTrackConfig, i) =>\n          newTrackConfig.file !== currVariantTracks.current[i].file\n      )\n    ) {\n      setFocusRegion((currFocusRegion) => {\n        if (isString(currFocusRegion)) {\n          return [\n            `${focusRegionOption.chrStart}:${focusRegionOption.txStart}`,\n            `${focusRegionOption.chrEnd}:${focusRegionOption.txEnd}`,\n          ];\n        }\n        return currFocusRegion;\n      });\n      setFocusRegionOption((currFocusRegionOption) => {\n        if (currFocusRegionOption.chr) {\n          return {\n            chrStart: currFocusRegionOption.chr,\n            chrEnd: currFocusRegionOption.chr,\n            txStart: currFocusRegionOption.txStart,\n            txEnd: currFocusRegionOption.txEnd,\n            geneName: chrRangePosEncoder([\n              `${currFocusRegionOption.chr}:${currFocusRegionOption.txStart}`,\n              `${currFocusRegionOption.chr}:${currFocusRegionOption.txEnd}`,\n            ]),\n            type: 'region',\n          };\n        }\n        return currFocusRegionOption;\n      });\n    }\n    closeHandler();\n  }, [\n    chromInfo,\n    tmpVariantTracks,\n    closeHandler,\n    focusRegionOption,\n    setVariantTracks,\n    setFocusRegion,\n    setFocusRegionOption,\n  ]);\n\n  const classes = useStyles();\n\n  return (\n    <React.Fragment>\n      <Typography\n        id=\"title\"\n        align=\"center\"\n        variant=\"h5\"\n        component=\"h2\"\n        noWrap\n        className={classes.title}\n      >\n        Variant Track\n      </Typography>\n      <p id=\"description\">\n        Variants can be loaded from a remote{' '}\n        <code>\n          <a\n            href=\"https://docs.higlass.io/data_preparation.html#bed-files\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            .beddb\n          </a>\n        </code>{' '}\n        or a local <code>.bed</code> file. To access a remote file, please enter\n        the URL of the{' '}\n        <a\n          href=\"https://docs.higlass.io/higlass_server.html\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          HiGlass server\n        </a>{' '}\n        and the track ID. To access a local file please select it with via the\n        file selection.\n      </p>\n      <div className={classes.trackList}>\n        {tmpVariantTracks.map((variantTrackConfig, i) => (\n          <TrackConfig\n            key={i}\n            config={variantTrackConfig}\n            onChange={changeTmpVariantTracks(i)}\n          />\n        ))}\n      </div>\n      <Typography align=\"center\">\n        <Button\n          className={classes.buttonNormal}\n          onClick={closeHandler}\n          variant=\"contained\"\n          disableElevation\n        >\n          Cancel\n        </Button>\n        <Button\n          className={changed ? classes.buttonActive : classes.buttonNormal}\n          onClick={changed ? saveHandler : closeHandler}\n          variant=\"contained\"\n          disableElevation\n        >\n          {changed ? 'Save' : 'Okay'}\n        </Button>\n      </Typography>\n    </React.Fragment>\n  );\n});\n\nexport default VariantsSettings;\n","import Button from '@material-ui/core/Button';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\nimport React from 'react';\nimport { useRecoilValue } from 'recoil';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport Logo from './Logo';\n\nimport { showWelcomeState } from './state';\n\nimport imgEnhancerView1 from './images/enhancer-view-1.png';\nimport imgEnhancerView2 from './images/enhancer-view-2.png';\nimport imgEnhancerView3 from './images/enhancer-view-3.png';\nimport imgEnhancerView4 from './images/enhancer-view-4.png';\nimport imgEnhancerView5 from './images/enhancer-view-5.png';\nimport imgGeneView1 from './images/gene-view-1.png';\nimport imgGeneView2 from './images/gene-view-2.png';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    '&>p': {\n      fontSize: '1.125em',\n    },\n  },\n  title: {\n    display: 'flex',\n    justifyContent: 'center',\n    margin: theme.spacing(2, 0, 3),\n  },\n  note: {\n    color: theme.palette.grey['400'],\n    marginTop: '1em',\n  },\n  icon: {\n    color: theme.palette.grey['400'],\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  showIntro: {\n    minWidth: '10.5rem',\n    marginRight: '0.5rem',\n  },\n  startExploring: {\n    minWidth: '10.5rem',\n    marginLeft: '0.5rem',\n    color: 'white',\n    background: '#cc0078 linear-gradient(45deg, #cc0078 30%, #cc0066 90%)',\n    boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .3)',\n    '&:hover': {\n      boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .5)',\n      background: '#d90080 linear-gradient(45deg, #d90080 30%, #d9006c 90%)',\n    },\n    '&:focus': {\n      boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .5)',\n    },\n  },\n  introTitle: {\n    fontSize: '2.75em',\n    letterSpacing: '-0.075rem',\n    fontWeight: 900,\n    textTransform: 'uppercase',\n    '&+h3': {\n      marginTop: 16,\n    },\n  },\n  introHeadline: {\n    fontSize: '1.5em',\n    fontWeight: 700,\n    margin: theme.spacing(6, 0, 2, 0),\n  },\n  introSubHeadline: {\n    fontSize: '1.125em',\n    fontWeight: 700,\n    margin: theme.spacing(2, 0, 1, 0),\n  },\n  introStartExploring: {\n    margin: theme.spacing(4, 0, 2, 0),\n  },\n  figure: {\n    margin: theme.spacing(4, 6),\n    '& img': {\n      width: '100%',\n      height: 'auto',\n    },\n  },\n}));\n\nconst Welcome = React.memo(function Welcome({\n  closeHandler,\n  openIntroHandler,\n}) {\n  const showWelcome = useRecoilValue(showWelcomeState);\n\n  const classes = useStyles();\n\n  if (showWelcome === 'intro')\n    return (\n      <div className={classes.root}>\n        <Typography\n          id=\"intro-title\"\n          align=\"center\"\n          variant=\"h2\"\n          component=\"h2\"\n          noWrap\n          className={classes.introTitle}\n        >\n          Introduction\n        </Typography>\n        <Typography\n          id=\"intro-enhancer-view\"\n          align=\"center\"\n          variant=\"h3\"\n          component=\"h3\"\n          noWrap\n          className={classes.introHeadline}\n        >\n          1. Enhancer-Centered View\n        </Typography>\n        <p>\n          The goal of this web application is to provide a visual interface to\n          enhancer-gene connections predicted by the{' '}\n          <em>Activity-By-Contact</em> (ABC) model. Enhancers are genomic\n          regions that have the ability to regulate the activity of nearby\n          genes. One way to visualize this regulatory connection is by drawing\n          an arc between the enhancer region and the gene as follows:\n        </p>\n        <figure className={classes.figure}>\n          <img src={imgEnhancerView1} alt=\"Enhancer-Gene Connection Overview\" />\n        </figure>\n        <p>\n          However, enhancers are not always active in every cell type or state.\n          Hence, in reality the looks more like below where <em>Enhancer 1</em>{' '}\n          is entirely inactive in <em>Sample 1</em> while <em>Sample 2</em> is\n          inactive in <em>Sample 3</em>.\n        </p>\n        <figure className={classes.figure}>\n          <img\n            src={imgEnhancerView2}\n            alt=\"Enhancer-Gene Connection By Sample\"\n          />\n        </figure>\n        <p>\n          Since we have predicted enhancer-gene connections across 131 samples,\n          showing all arcs at once or having a separate arc track for each\n          sample is not very effective visually. In other words, it would either\n          be hard to differentiate samples in case we show all arcs in one track\n          or it would be impossible to get a complete overview due the vertical\n          space consumption if we showed a separate arc track for each sample.\n        </p>\n        <p>\n          Therefore, we separately visualize the distribution of outgoing and\n          incoming arcs as shown below. Each sample is represented by a row and\n          an active enhancer region (outgoing arc) is displayed as a rectangle.\n          For the regulated genes, we are drawing a bar that encodes the number\n          of enhancers (i.e., incoming arcs) regulating this gene as the height.\n        </p>\n        <figure className={classes.figure}>\n          <img\n            src={imgEnhancerView3}\n            alt=\"Optimized Enhancer-Gene Connection Representation\"\n          />\n        </figure>\n        <p>\n          While we loose some details (no worries, we will bring those details\n          back), this representation is visually much more scalable. To make\n          this visualization more effective we can sort similar samples into\n          groups and add color to help distinguish between the different sample\n          groups.\n        </p>\n        <figure className={classes.figure}>\n          <img\n            src={imgEnhancerView4}\n            alt=\"Sample-Grouped Enhancer-Gene Connection Representation\"\n          />\n        </figure>\n        <p>\n          As mentioned above, by separetly visualizing the distribution of\n          enhancer regions and the distribution of sample groups regulating\n          genes, we are loosing the information which enhancer region regulates\n          which gene. We're going to bring this information back by allowing you\n          to focus on specific regions and sample groups. For instance, in the\n          following example we focused on <em>Gene 2</em>, which will\n          subsequently highlight all enhancers regulating this gene (shown in\n          pink) and also bring back the arcs to hint at enhancers outside the\n          current field of view.\n        </p>\n        <figure className={classes.figure}>\n          <img\n            src={imgEnhancerView5}\n            alt=\"Focused Enhancer-Gene Connection Representation\"\n          />\n        </figure>\n        <p>\n          In the application there are two ways to enable focusing. First, you\n          can click on one of the following visual elements: a gene, a variant,\n          or an enhancer region. To select a custom focus region you can also\n          brush on the genomic position track. Second, you can search for and\n          enter a gene (e.g., PPIF), variant (e.g., rs1250566), or custom region\n          (e.g., chr1:1-chr2:2, chr10:81230693-80993117, or\n          chr10:81230693+10000) in the search bar at the top.\n        </p>\n        <Typography\n          id=\"intro-enhancer-view-sample-filtering\"\n          align=\"center\"\n          variant=\"h4\"\n          component=\"h4\"\n          noWrap\n          className={classes.introSubHeadline}\n        >\n          Sample Filtering\n        </Typography>\n        <p>\n          In addition to focusing on certain enhancer-gene connections, you can\n          also filter out samples using the list on the side bar. Note that the\n          filtering will be applied to all visualizations including the\n          Gene-Centered View and the DNA Accessibility View.\n        </p>\n        <Typography\n          id=\"intro-enhancer-view-genetic-variations\"\n          align=\"center\"\n          variant=\"h4\"\n          component=\"h4\"\n          noWrap\n          className={classes.introSubHeadline}\n        >\n          Custom Genetic Variations\n        </Typography>\n        <p>\n          To identify critical enhancers, our application includes a track for\n          displaying genetic point variations, e.g., disease risk variants.\n          These variants are visualized as points that are position either by\n          their associated p-value or posterior probability along the y-axis. By\n          default, we show <abbr title=\"\">IBD</abbr>\n          -associated variants but you can load your variants if you like by\n          clicking on <em>Edit Variants</em> in the side bar. There are two\n          options for loading custom variants. You can either specify the URL of\n          a{' '}\n          <a\n            href=\"https://docs.higlass.io/higlass_server.html\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            HiGlass server\n          </a>{' '}\n          (which is the underlying genome browser toolkit we are using) and\n          tileset UUID of your{' '}\n          <a\n            href=\"https://docs.higlass.io/data_preparation.html#bed-files\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            <code>.beddb</code> track\n          </a>\n          . Or you can load a local\n          <a\n            href=\"https://bedtools.readthedocs.io/en/latest/content/general-usage.html#bed-format\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            <code>.bed</code> file\n          </a>{' '}\n          from your computer. Make sure to specify the correct column number for\n          the p-value and posterior probability!\n        </p>\n        <p>\n          <strong>Experimental:</strong> If you want to share a view with a\n          custom variant track with your colleagues can either setup your own\n          HiGlass server or you can use{' '}\n          <a href=\"https://resgen.io\" target=\"_blank\" rel=\"noopener noreferrer\">\n            Resgen.io\n          </a>\n          &mdash;a service for hosting and visualizing genomic data.\n        </p>\n        <Typography\n          id=\"intro-enhancer-view-settings\"\n          align=\"center\"\n          variant=\"h4\"\n          component=\"h4\"\n          noWrap\n          className={classes.introSubHeadline}\n        >\n          Settings\n        </Typography>\n        <p>\n          Finally, you can adjust the color encoding of the rectangles\n          representing enhancer regions via the settings menu (click on{' '}\n          <IconButton size=\"small\" className={classes.icon}>\n            <SettingsIcon fontSize=\"inherit\" />\n          </IconButton>\n          ). By default (<em>Solid</em>) we render rectangles in a solid color\n          whenever a region is predicted to regulate at least one gene.\n          Alternatively you can choose to encode number of regulated genes as\n          the color (<em>Number of predictions</em>). In this case, darker\n          rectangles hint at enhancers that regulate many genes. Additionally,\n          you can also color rectangles by the highest ABC prediction score (\n          <em>Highest prediction score</em>) or the ABC prediction score of the\n          connection to the closest gene (<em>Closest prediction score</em>).\n        </p>\n        <Typography\n          id=\"intro-gene-view\"\n          align=\"center\"\n          variant=\"h3\"\n          component=\"h3\"\n          noWrap\n          className={classes.introHeadline}\n        >\n          2. Gene-Centered View\n        </Typography>\n        <p>\n          Sometimes it can be insightful to gain an overview of all upstream and\n          downstream genes that are regulated by a specific enhancer region.\n          That's what this view is for. In the tabular layout, each row\n          corresponds to a sample group and the columns represent the genes\n          ordered by distance to the enhancer region, which is shown as the\n          center column. Hence, genes to the left are upstream of the enhancer\n          and genes to the right are downstream. The number of genes/columns is\n          limited by the available screen space. For instance, consider the\n          following situation, where the numbers in the cells indicate the\n          number of enhancer-gene connections across the three sample groups.\n        </p>\n        <figure className={classes.figure}>\n          <img src={imgGeneView1} alt=\"Gene-Centered View Setup\" />\n        </figure>\n        <p>\n          To make this view more effective, the cells encode the percentage of\n          samples within a sample group that contain a predicted enhancer-gene\n          connection as the rectangle area.\n        </p>\n        <figure className={classes.figure}>\n          <img src={imgGeneView2} alt=\"Gene-Centered View Visualization\" />\n        </figure>\n        <p>\n          For instance, in the example above, <em>Group A&mdash;Gene 2</em> is\n          the largest rectangle because three out of four sample from{' '}\n          <em>Group A</em> regulate <em>Gene 2</em>. On the other hand,{' '}\n          <em>Group C&mdash;Gene 3</em> is the smallest rectangle because only\n          one out of 5 samples from <em>Group C</em> regulate <em>Gene 3</em>.\n        </p>\n        <p>\n          For more detais on which exact sample contains a prediction you can\n          mouse over a cell.\n        </p>\n        <Typography\n          id=\"intro-gene-view-settings\"\n          align=\"center\"\n          variant=\"h4\"\n          component=\"h4\"\n          noWrap\n          className={classes.introSubHeadline}\n        >\n          Settings\n        </Typography>\n        <p>\n          This view offers a couple of additional cell encoding to provide\n          different perspectives of the gene regulation landscape of a specific\n          enhancer. The rectangle size can also encode the absolute number of\n          predicted enhancer-gene connections by sample group (\n          <em>Abs. number of predictions</em>).\n        </p>\n        <p>\n          Additionally, you can look at the distribution of enhancer-gene\n          connections by their ABC prediction score as a{' '}\n          <a\n            href=\"https://flowingdata.com/2016/09/08/beeswarm-plot-in-r-to-show-distributions/\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            bee swarm plot\n          </a>\n          (<em>Distribution by prediction score</em>). With this setting, each\n          enhancer-gene connection is represented as a small dot and positioned\n          on the cell's y-axis by it's ABC prediction score. The closer the dot\n          is placed to the top of the cell the higher the prediction score. The\n          dots' x position is determined by the number of other dots with a\n          similar prediction score. In other words the more dots stack along a\n          cell's x-axis the more enhancer-gene Connections have the same\n          prediction score.\n        </p>\n        <p>\n          The final visual encoding (<em>Sample array</em>) visualizes\n          enhancer-gene connections as filled cells within an invisible grid\n          where each sample has a fixed position across all genes. Think of a\n          microarray or well plate where each sample allocates a fixed well and\n          lights up when this samples contains a enhancer-gene connection. The\n          benefit of this encoding is that it allows you to quickly scan cross a\n          row to see of the focused enhancer is regulating other genes in the\n          same sample. You can even mouse over a well in the array view and it\n          highlight the well across the entire row.\n        </p>\n        <Typography\n          id=\"intro-dna-accessibility-view\"\n          align=\"center\"\n          variant=\"h3\"\n          component=\"h3\"\n          noWrap\n          className={classes.introHeadline}\n        >\n          3. DNA Accessibility View\n        </Typography>\n        <p>\n          Since the ABC model relies on the DNaseI hypersensitivy, we provide\n          an accompanying view of the DNA accessibility across all samples for\n          quick visual debugging of predicted enhancer regions. The DNase- or\n          ATAC-seq measurements, are visualized as a vertically-stacked list of\n          line charts. Each row corresponds to a sample and the order of samples\n          is the same as in the <em>Enhancer-Centered View</em>. By default,\n          each row is individually normalized to focus on shape similarities\n          rather than the absolute magnitude (i.e., read count). This behavior\n          can be adjusted view the settings.\n        </p>\n        <Typography align=\"center\" className={classes.introStartExploring}>\n          <Button\n            className={classes.startExploring}\n            onClick={closeHandler}\n            variant=\"contained\"\n            disableElevation\n          >\n            Start Exploring!\n          </Button>\n        </Typography>\n        <Typography align=\"center\" className={classes.note}>\n          <em>\n            You can reopen this tutorial by clicking on \"ABC Enhancer-Gene\n            Connections\" in the upper left corner!\n          </em>\n        </Typography>\n      </div>\n    );\n\n  return (\n    <div className={classes.root}>\n      <Typography\n        id=\"title\"\n        align=\"center\"\n        variant=\"h5\"\n        component=\"h2\"\n        noWrap\n        className={classes.title}\n      >\n        <Logo\n          styles={{\n            width: 'auto',\n          }}\n        />\n      </Typography>\n      <p id=\"description\">\n        This web application visualizes genome-wide enhancer-gene connections\n        that were predicted with the <em>Activity-By-Contact</em> (ABC) model.\n        You can interactively browse the entire human genome and filter\n        enhancers by region, gene, or containing variant.\n      </p>\n      <p>\n        For information regarding the ABC model please refer to our initial\n        publication:{' '}\n        <a\n          href=\"https://www.nature.com/articles/s41588-019-0538-0\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          Fulco et al., Activity-by-contact model of enhancerpromoter\n          regulation from thousands of CRISPR perturbations,{' '}\n          <em>Nature Genetics</em> (2019)\n        </a>\n        .\n      </p>\n      <p>\n        For more information about this web application, please click on{' '}\n        <em>Show Introduction</em>. If you find a bug or have a question, please{' '}\n        <a\n          href=\"https://github.com/flekschas/enhancer-gene-vis/issues\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          open an issue on GitHub\n        </a>\n        .\n      </p>\n      <Typography align=\"center\">\n        <Button\n          className={classes.showIntro}\n          onClick={openIntroHandler}\n          variant=\"contained\"\n          disableElevation\n        >\n          Show Introduction\n        </Button>\n        <Button\n          className={classes.startExploring}\n          onClick={closeHandler}\n          variant=\"contained\"\n          disableElevation\n        >\n          Start Exploring!\n        </Button>\n      </Typography>\n    </div>\n  );\n});\n\nexport default Welcome;\n","import React, { createContext, useCallback, useState } from 'react';\nimport Backdrop from '@material-ui/core/Backdrop';\nimport Fade from '@material-ui/core/Fade';\nimport Modal from '@material-ui/core/Modal';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst ModalContext = createContext();\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: '4rem',\n  },\n  paper: {\n    backgroundColor: theme.palette.background.paper,\n    borderRadius: '0.25rem',\n    boxShadow: theme.shadows[4],\n    maxWidth: '60rem',\n    maxHeight: 'calc(100vh - 8rem)',\n    overflow: 'auto',\n    padding: theme.spacing(2, 4),\n    outline: 0,\n  },\n}));\n\nexport default function ModalProvider({ children }) {\n  const [Component, setComponent] = useState(null);\n  const [customCloseHandler, setCustomCloseHandler] = useState(null);\n  const [customProps, setCustomProps] = useState(null);\n\n  const showModal = useCallback(\n    (\n      newComponent = null,\n      newCustomCloseHandler = null,\n      newCustomProps = {}\n    ) => {\n      setComponent(newComponent);\n      setCustomCloseHandler(() => newCustomCloseHandler);\n      setCustomProps(newCustomProps);\n    },\n    []\n  );\n\n  const closeHandler = useCallback(() => {\n    setComponent(null);\n    setCustomCloseHandler(null);\n  }, []);\n\n  const classes = useStyles();\n\n  const open = Boolean(Component);\n\n  return (\n    <ModalContext.Provider value={showModal}>\n      {children}\n      <Modal\n        aria-labelledby=\"modal-title\"\n        aria-describedby=\"modal-description\"\n        className={classes.root}\n        open={open}\n        onClose={customCloseHandler || closeHandler}\n        closeAfterTransition\n        BackdropComponent={Backdrop}\n        BackdropProps={{\n          timeout: 250,\n        }}\n      >\n        <Fade in={open}>\n          <div className={classes.paper}>\n            {open && (\n              <Component\n                {...customProps}\n                closeHandler={customCloseHandler || closeHandler}\n              />\n            )}\n          </div>\n        </Fade>\n      </Modal>\n    </ModalContext.Provider>\n  );\n}\n\nfunction useShowModal() {\n  const context = React.useContext(ModalContext);\n  if (context === undefined) {\n    throw new Error('useShowModal must be used within a ModalContext');\n  }\n  return context;\n}\n\nexport { useShowModal };\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useRecoilState, useRecoilValue } from 'recoil';\nimport { isString, nthIndexOf } from '@flekschas/utils';\n\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport Divider from '@material-ui/core/Divider';\nimport Drawer from '@material-ui/core/Drawer';\nimport FormControl from '@material-ui/core/FormControl';\nimport Grid from '@material-ui/core/Grid';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\nimport ButtonBase from '@material-ui/core/ButtonBase';\nimport { makeStyles } from '@material-ui/core/styles';\nimport SettingsIcon from '@material-ui/icons/Settings';\n\nimport CheckboxList from './CheckboxList';\nimport Logo from './Logo';\nimport VariantsSettings from './VariantsSettings';\nimport Welcome from './Welcome';\nimport { useChromInfo } from './ChromInfoProvider';\nimport { useShowModal } from './ModalProvider';\n\nimport {\n  enhancerGenesSvgState,\n  higlassEnhancerRegionsState,\n  higlassDnaAccessState,\n  sampleFilterState,\n  sampleWithName,\n  sampleGroupWithGroup,\n  showVariantsSettingsState,\n  useXDomainStartWithAssembly,\n  useXDomainEndWithAssembly,\n  useShowWelcome,\n} from './state';\n\nimport { download, stringifySvg } from './utils';\n\nimport {\n  DEFAULT_COLOR_MAP_DARK,\n  DEFAULT_COLOR_MAP,\n  DEFAULT_VIEW_CONFIG_ENHANCER,\n  DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY,\n  SVG_SKELETON,\n  DRAWER_WIDTH,\n  GROUPED_SAMPLE_OPTIONS,\n  SAMPLE_TO_GROUP,\n} from './constants';\n\nconst useStyles = makeStyles((theme) => ({\n  h1: {\n    height: '100%',\n    margin: '0',\n    padding: '0',\n    fontSize: '1rem',\n    lineHeight: '1rem',\n    fontWeight: 'bold',\n  },\n  drawer: {\n    width: DRAWER_WIDTH,\n    flexShrink: 0,\n  },\n  drawerGrid: {\n    height: '100%',\n  },\n  drawerPaper: {\n    width: DRAWER_WIDTH,\n  },\n  settings: {\n    position: 'relative',\n    flexGrow: 1,\n  },\n  globalSettingsTitle: {\n    padding: '3px 8px 4px 8px',\n    margin: 0,\n    '& h6': {\n      fontSize: '0.8rem',\n      fontWeight: 'bold',\n    },\n  },\n  settingsContent: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    overflow: 'hidden auto',\n  },\n  toolbar: theme.mixins.toolbar,\n  grow: {\n    flexGrow: 1,\n  },\n  titleBar: {\n    position: 'relative',\n    padding: '2px',\n    fontSize: '0.8rem',\n    background: theme.palette.grey['100'],\n  },\n  titleBarText: {\n    fontSize: '0.8rem',\n  },\n  titleBarContainer: {\n    width: 'auto',\n  },\n  titleBarTitle: {\n    padding: '0 2px',\n    fontWeight: 900,\n  },\n  titleBarIcon: {\n    color: theme.palette.grey['400'],\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  titleBarIconActive: {\n    color: 'black',\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  globalSettingsFirstBox: {\n    margin: theme.spacing(0, 1, 1, 1),\n  },\n}));\n\nconst extractCoreFromHiGlassSvg = (svg) => {\n  const fifthLn = nthIndexOf(svg, '\\n', 4);\n  const lastLn = svg.lastIndexOf('\\n');\n  const width = +svg.substring(\n    svg.indexOf('width=\"') + 7,\n    svg.indexOf('px', svg.indexOf('width=\"') + 7)\n  );\n  const height = +svg.substring(\n    svg.indexOf('height=\"') + 8,\n    svg.indexOf('px', svg.indexOf('height=\"') + 8)\n  );\n  return {\n    core: svg.substring(fifthLn + 1, lastLn),\n    width,\n    height,\n  };\n};\n\nconst extractCoreFromStringifiedSvg = (svg) => {\n  const firstSvgClosingBracket = svg.indexOf('>');\n  const lastSvgOpeningBracket = svg.lastIndexOf('</svg>');\n  const [width, height] = svg\n    .substring(\n      svg.indexOf('viewbox=\"') + 9,\n      svg.indexOf('\"', svg.indexOf('viewbox=\"') + 9)\n    )\n    .split(' ')\n    .slice(2);\n  return {\n    core: svg.substring(firstSvgClosingBracket + 1, lastSvgOpeningBracket),\n    width: +width,\n    height: +height,\n  };\n};\n\nconst AppSidebar = React.memo(function AppSidebar() {\n  const chromInfo = useChromInfo();\n  const showModal = useShowModal();\n\n  const [xDomainStart, setXDomainStart] = useXDomainStartWithAssembly(\n    chromInfo\n  );\n  const [xDomainEnd, setXDomainEnd] = useXDomainEndWithAssembly(chromInfo);\n  const [showWelcome, setShowWelcome] = useShowWelcome();\n  const [showVariantsSettings, setShowVariantsSettings] = useRecoilState(\n    showVariantsSettingsState\n  );\n\n  const higlassEnhancerRegions = useRecoilValue(higlassEnhancerRegionsState);\n  const higlassDnaAccess = useRecoilValue(higlassDnaAccessState);\n  const enhancerGenesSvg = useRecoilValue(enhancerGenesSvgState);\n\n  const [userChangedDomain, setUserChangedDomain] = useState(0);\n\n  const numericalXDomainStart = useMemo(\n    () =>\n      isString(xDomainStart) && xDomainStart.indexOf(':') >= 0\n        ? chromInfo.chrToAbs([\n            xDomainStart.split(':')[0],\n            +xDomainStart.split(':')[1],\n          ])\n        : +xDomainStart,\n    [xDomainStart, chromInfo]\n  );\n\n  const numericalXDomainEnd = useMemo(\n    () =>\n      isString(xDomainEnd) && xDomainEnd.indexOf(':') >= 0\n        ? chromInfo.chrToAbs([\n            xDomainEnd.split(':')[0],\n            +xDomainEnd.split(':')[1],\n          ])\n        : +xDomainEnd,\n    [xDomainEnd, chromInfo]\n  );\n\n  const xDomainStartChangeHandler = useCallback(\n    (event) => {\n      setXDomainStart(event.target.value);\n      setUserChangedDomain(2);\n    },\n    [setXDomainStart]\n  );\n\n  const xDomainEndChangeHandler = useCallback(\n    (event) => {\n      setXDomainEnd(event.target.value);\n      setUserChangedDomain(2);\n    },\n    [setXDomainEnd]\n  );\n\n  useEffect(() => {\n    setUserChangedDomain((curr) => Math.max(0, curr - 1));\n  }, [xDomainStart, xDomainEnd]);\n\n  const higlassEnhancerZoomToXDomain = (event) => {\n    if (!higlassEnhancerRegions) return;\n\n    const xDomain = [\n      ...higlassEnhancerRegions.getViewConfig().views[0].initialXDomain,\n    ];\n\n    if (!Number.isNaN(+numericalXDomainStart)) {\n      xDomain[0] = numericalXDomainStart;\n    }\n    if (!Number.isNaN(+numericalXDomainEnd)) {\n      xDomain[1] = numericalXDomainEnd;\n    }\n\n    higlassEnhancerRegions.zoomTo(\n      'context',\n      xDomain[0],\n      xDomain[1],\n      xDomain[0],\n      xDomain[1],\n      2000\n    );\n  };\n\n  const closeWelcome = useCallback(() => {\n    setShowWelcome(false);\n  }, [setShowWelcome]);\n\n  const openWelcome = useCallback(() => {\n    setShowWelcome(true);\n  }, [setShowWelcome]);\n\n  const openWelcomeIntro = useCallback(() => {\n    setShowWelcome('intro');\n  }, [setShowWelcome]);\n\n  useEffect(() => {\n    if (showWelcome)\n      showModal(Welcome, closeWelcome, {\n        openIntroHandler: openWelcomeIntro,\n      });\n    else showModal();\n  }, [showWelcome, showModal, closeWelcome, openWelcomeIntro]);\n\n  const closeVariantsSettings = useCallback(() => {\n    setShowVariantsSettings(false);\n  }, [setShowVariantsSettings]);\n\n  const openVariantsSettings = useCallback(() => {\n    setShowVariantsSettings(true);\n  }, [setShowVariantsSettings]);\n\n  useEffect(() => {\n    if (showVariantsSettings) {\n      showModal(VariantsSettings, closeVariantsSettings);\n    } else if (!showWelcome) {\n      showModal();\n    }\n  }, [showWelcome, showVariantsSettings, showModal, closeVariantsSettings]);\n\n  const mergeSvgs = (enhancerSvg, dnaAccessSvg, enhancerGeneSvg) => {\n    const {\n      core: enhancerSvgCore,\n      width: enhancerWidth,\n      height: enhancerHeight,\n    } = extractCoreFromHiGlassSvg(enhancerSvg);\n    const {\n      core: dnaAccessSvgCore,\n      width: dnaAccessWidth,\n      height: dnaAccessHeight,\n    } = extractCoreFromHiGlassSvg(dnaAccessSvg);\n    const {\n      core: enhancerGeneSvgCore = null,\n      height: enhancerGeneHeight = 0,\n    } = enhancerGeneSvg ? extractCoreFromStringifiedSvg(enhancerGeneSvg) : {};\n\n    const actualEnhancerHeight = DEFAULT_VIEW_CONFIG_ENHANCER.views[0].tracks.top.reduce(\n      (height, track) => height + track.height,\n      0\n    );\n    const actualDnaAccessHeight = DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY.views[0].tracks.top.reduce(\n      (height, track) => height + track.height,\n      0\n    );\n    const padding = 24;\n\n    let mergedSvg = SVG_SKELETON;\n    mergedSvg = mergedSvg.replace(\n      '_WIDTH_',\n      enhancerWidth + dnaAccessWidth + padding\n    );\n    mergedSvg = mergedSvg.replace(\n      '_HEIGHT_',\n      Math.max(\n        enhancerHeight + enhancerGeneHeight + padding,\n        dnaAccessHeight,\n        actualEnhancerHeight + enhancerGeneHeight + padding,\n        actualDnaAccessHeight\n      )\n    );\n    mergedSvg = mergedSvg.replace('_ENHANCER_', enhancerSvgCore);\n    mergedSvg = mergedSvg.replace(\n      '_ENHANCER_GENE_Y_',\n      enhancerHeight + padding\n    );\n    mergedSvg = mergedSvg.replace('_ENHANCER_GENE_', enhancerGeneSvgCore);\n    mergedSvg = mergedSvg.replace('_DNA_ACCESS_X_', enhancerWidth + padding);\n    mergedSvg = mergedSvg.replace('_DNA_ACCESS_', dnaAccessSvgCore);\n\n    if (enhancerGeneSvgCore === null) {\n      mergedSvg = mergedSvg.replace('_ENHANCER_GENE_', '');\n    } else {\n      mergedSvg = mergedSvg.replace('_ENHANCER_GENE_', enhancerGeneSvgCore);\n    }\n\n    return mergedSvg;\n  };\n\n  const higlassExportAsSvg = () => {\n    if (!higlassEnhancerRegions || !higlassDnaAccess) {\n      console.warn('One of the HiGlass instances is not available');\n      return;\n    }\n\n    const mergedSvg = mergeSvgs(\n      higlassEnhancerRegions.exportAsSvg(),\n      higlassDnaAccess.exportAsSvg(),\n      enhancerGenesSvg ? stringifySvg(enhancerGenesSvg) : null\n    );\n\n    download(\n      'abc-enhancers.svg',\n      new Blob([mergedSvg], { type: 'image/svg+xml' })\n    );\n  };\n\n  // Run on every render\n  const classes = useStyles();\n\n  return (\n    <Drawer\n      className={classes.drawer}\n      variant=\"permanent\"\n      classes={{\n        paper: classes.drawerPaper,\n      }}\n      anchor=\"left\"\n    >\n      <Grid container direction=\"column\" className={classes.drawerGrid}>\n        <Grid item>\n          <ButtonBase\n            className={classes.toolbar}\n            style={{ width: '100%' }}\n            onClick={openWelcome}\n          >\n            <h1 className={classes.h1}>\n              <Logo />\n            </h1>\n          </ButtonBase>\n          <Divider />\n        </Grid>\n        <Grid container item className={classes.grow} direction=\"column\">\n          <Grid item>\n            <Box m={1}>\n              <Box m={0}>\n                <FormControl variant=\"outlined\" margin=\"dense\" fullWidth>\n                  <InputLabel htmlFor=\"x-domain-start\">Region Start</InputLabel>\n                  <OutlinedInput\n                    id=\"x-domain-start\"\n                    label=\"Region Start\"\n                    onChange={xDomainStartChangeHandler}\n                    value={xDomainStart}\n                  />\n                </FormControl>\n              </Box>\n              <Box m={0}>\n                <FormControl variant=\"outlined\" margin=\"dense\" fullWidth>\n                  <InputLabel htmlFor=\"x-domain-end\">Region End</InputLabel>\n                  <OutlinedInput\n                    id=\"x-domain-end\"\n                    label=\"Region End\"\n                    onChange={xDomainEndChangeHandler}\n                    value={xDomainEnd}\n                  />\n                </FormControl>\n              </Box>\n              {userChangedDomain > 0 && (\n                <Box m={0}>\n                  <Button\n                    variant=\"contained\"\n                    margin=\"dense\"\n                    onClick={higlassEnhancerZoomToXDomain}\n                    fullWidth\n                    disableElevation\n                    size=\"small\"\n                  >\n                    Go\n                  </Button>\n                </Box>\n              )}\n            </Box>\n            <Divider />\n            <Box m={1}>\n              <Button\n                variant=\"contained\"\n                margin=\"dense\"\n                fullWidth\n                disableElevation\n                size=\"small\"\n                startIcon={<SettingsIcon />}\n                onClick={openVariantsSettings}\n              >\n                Edit Variants\n              </Button>\n            </Box>\n            <Divider />\n          </Grid>\n          <Grid item className={classes.settings}>\n            <Box m={0} className={classes.settingsContent}>\n              <Box className={classes.globalSettingsFirstBox}>\n                <CheckboxList\n                  filterState={sampleFilterState}\n                  filterLabel=\"Filter Samples\"\n                  optionWithName={sampleWithName}\n                  optionGroupWithGroup={sampleGroupWithGroup}\n                  groupedOptions={GROUPED_SAMPLE_OPTIONS}\n                  optionToGroup={SAMPLE_TO_GROUP}\n                  groupColors={DEFAULT_COLOR_MAP}\n                  groupColorsDark={DEFAULT_COLOR_MAP_DARK}\n                />\n              </Box>\n            </Box>\n          </Grid>\n          <Grid item>\n            <Divider />\n            <Box m={1}>\n              <Button\n                variant=\"contained\"\n                margin=\"dense\"\n                onClick={higlassExportAsSvg}\n                fullWidth\n                disableElevation\n                size=\"small\"\n              >\n                Export as SVG\n              </Button>\n            </Box>\n          </Grid>\n        </Grid>\n      </Grid>\n    </Drawer>\n  );\n});\n\nexport default AppSidebar;\n","import PropTypes from 'prop-types';\nimport React, { useEffect, useState } from 'react';\nimport TextField from '@material-ui/core/TextField';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Grid from '@material-ui/core/Grid';\nimport Chip from '@material-ui/core/Chip';\nimport SvgIcon from '@material-ui/core/SvgIcon';\nimport FlashOnIcon from '@material-ui/icons/FlashOn';\nimport FilterCenterFocusIcon from '@material-ui/icons/FilterCenterFocus';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { identity } from '@flekschas/utils';\n\nimport useDebounce from './use-debounce';\n\nconst useStyles = makeStyles((theme) => ({\n  inputRoot: {\n    background: 'white !important',\n    borderTopLeftRadius: 0,\n    borderTopRightRadius: 0,\n    '&::before': {\n      borderBottomWidth: 0,\n      boxShadow: '0 1px 0 0 rgba(0, 0, 0, 0)',\n      transition: 'boxShadow 0.2s ease',\n    },\n    '&:hover::before': {\n      borderBottomWidth: 0,\n      boxShadow: '0 1px 0 0 rgba(0, 0, 0, 1)',\n    },\n  },\n  focused: {\n    boxShadow: '0 1px 0 0 rgba(0, 0, 0, 1)',\n  },\n  input: {\n    height: 35,\n    padding: '6px 0 6px',\n  },\n  textFieldRoot: {\n    '& .MuiFormLabel-root': {\n      color: 'black',\n      fontWeight: 'bold',\n      transform: 'translate(12px, 21px) scale(1.25)',\n    },\n    '& .MuiInputLabel-shrink': {\n      fontWeight: 'normal',\n    },\n  },\n}));\n\nconst fetchJsonFromUrl = async (url, query) => {\n  if (typeof url === 'string') {\n    const response = await fetch(`${url}&ac=${query || ''}`);\n    return response.json();\n  }\n  const response = await fetch(`${url.url}&ac=${query || ''}`);\n  const results = await response.json();\n  return results.map((result) => {\n    result.type = url.type;\n    return result;\n  });\n};\n\nfunction GeneIcon(props) {\n  return (\n    <SvgIcon viewBox=\"0 0 16 16\" {...props}>\n      <path d=\"M5.03 14.378A7.33 7.33 0 003.423 16h2.42a7.762 7.762 0 011.281-.774 13.241 13.241 0 01-1.863-1.016c-.078.054-.156.11-.233.168zM5.766 0l.219.174a8.754 8.754 0 001.636.92l.024.008c.797.24 1.507.627 2.023.933.325.18.674.4 1.024.66 1.825 1.363 2.79 3.22 2.79 5.367 0 2.062-.962 3.89-2.782 5.286-.061.048-.125.094-.186.139a10.45 10.45 0 00-1.895-.955 8.17 8.17 0 001.69-1.162h-3.92a6.191 6.191 0 01-1.199-1.15h6.093a4.054 4.054 0 00.603-1.747H3.839c.072.656.307 1.239.636 1.747h.011c.282.438.628.822.991 1.15H5.47l.74.584c.831.588 1.573.893 1.636.92a9.358 9.358 0 012.847 1.504A7.38 7.38 0 0112.3 16H9.879l-.759-.5a7.876 7.876 0 00-1.256-.594 11.833 11.833 0 01-2.07-1.04l.017-.009c-1.567-.999-3.571-2.851-3.571-5.794 0-2.149.964-4.005 2.79-5.367.076-.058.154-.113.231-.167.495.32 1.143.698 1.863 1.015a7.677 7.677 0 00-1.296.786c-.043.032-.083.066-.125.098h3.318c.535.336.999.727 1.364 1.149H4.598a4.215 4.215 0 00-.721 1.748h7.97l-.038-.195a3.527 3.527 0 00-.306-.904 4.417 4.417 0 00-.378-.65l-.01-.007a5.793 5.793 0 00-1.081-1.13l-.14-.109a7.236 7.236 0 00-.722-.48l-.031-.02a7.942 7.942 0 00-1.276-.607 10.278 10.278 0 01-1.257-.57C5.728 2.218 4.31 1.364 3.281 0h2.486zm6.267 0a7.808 7.808 0 01-1.743 1.707A10.443 10.443 0 008.396.752 8.592 8.592 0 009.592 0h2.442z\" />\n    </SvgIcon>\n  );\n}\n\nfunction GeneOption(props) {\n  return (\n    <Grid\n      key={props.option.geneName}\n      container\n      direction=\"row\"\n      alignItems=\"center\"\n    >\n      <GeneIcon fontSize=\"small\" />\n      <span>{props.option.geneName}</span>\n    </Grid>\n  );\n}\n\nfunction VariantOption(props) {\n  return (\n    <Grid\n      key={props.option.geneName}\n      container\n      direction=\"row\"\n      alignItems=\"center\"\n    >\n      <FlashOnIcon fontSize=\"small\" />\n      <span>{props.option.geneName}</span>\n    </Grid>\n  );\n}\n\nfunction RegionOption(props) {\n  return (\n    <Grid\n      key={props.option.geneName}\n      container\n      direction=\"row\"\n      alignItems=\"center\"\n    >\n      <FilterCenterFocusIcon fontSize=\"small\" />\n      <span>{props.option.geneName}</span>\n    </Grid>\n  );\n}\n\nfunction Option(props) {\n  if (props.option.type === 'gene') return <GeneOption option={props.option} />;\n  if (props.option.type === 'variant')\n    return <VariantOption option={props.option} />;\n  if (props.option.type === 'region')\n    return <RegionOption option={props.option} />;\n  return <div>{props.option.geneName}</div>;\n}\n\nfunction getIcon(icon) {\n  switch (icon) {\n    case 'gene':\n      return <GeneIcon />;\n\n    case 'variant':\n      return <FlashOnIcon />;\n\n    case 'region':\n      return <FilterCenterFocusIcon />;\n\n    default:\n      return undefined;\n  }\n}\n\nexport default function SearchField(props) {\n  const [open, setOpen] = useState(false);\n  const [options, setOptions] = useState([]);\n  const [searchQuery, setSearchQuery] = useState(props.inputValue);\n  const debouncedSearchQuery = useDebounce(searchQuery, 250);\n  const loading = open && options.length === 0;\n  const classes = useStyles();\n  const autocompleteClasses = { ...classes };\n  delete autocompleteClasses.textFieldRoot;\n\n  const { customSearch, searchUrl } = props;\n\n  useEffect(() => {\n    let active = true;\n\n    if (!open) return undefined;\n\n    setOptions([]);\n\n    const whenResults = Array.isArray(searchUrl)\n      ? searchUrl.map((url) => fetchJsonFromUrl(url, debouncedSearchQuery))\n      : [fetchJsonFromUrl(searchUrl, debouncedSearchQuery)];\n\n    if (customSearch) whenResults.push(customSearch(debouncedSearchQuery));\n\n    Promise.all(whenResults).then((results) => {\n      if (active) setOptions(results.flat().filter(identity));\n    });\n\n    return () => {\n      active = false;\n    };\n  }, [searchUrl, customSearch, open, debouncedSearchQuery]);\n\n  useEffect(() => {\n    if (!open) {\n      setOptions([]);\n    }\n  }, [open]);\n\n  const value =\n    props.multiple && !Array.isArray(props.value) ? [props.value] : props.value;\n\n  let autocompleteOptions = value && options.length === 0 ? value : options;\n  autocompleteOptions = Array.isArray(autocompleteOptions)\n    ? autocompleteOptions\n    : [autocompleteOptions];\n\n  return (\n    <Autocomplete\n      classes={props.larger ? autocompleteClasses : {}}\n      multiple={props.multiple}\n      onChange={(event, newValue) => {\n        props.onChange(newValue);\n      }}\n      value={value}\n      onInputChange={(event, newInputValue) => {\n        if (event) setSearchQuery(newInputValue);\n      }}\n      fullWidth={props.fullWidth}\n      style={{ width: props.fullWidth ? 'auto' : props.width }}\n      open={open}\n      onOpen={() => {\n        setOpen(true);\n      }}\n      onClose={() => {\n        setOpen(false);\n      }}\n      getOptionSelected={(option, _value) =>\n        option.geneName === _value.geneName\n      }\n      getOptionLabel={(option) => (option ? option.geneName : '')}\n      options={autocompleteOptions}\n      loading={loading}\n      renderInput={(params) => (\n        <TextField\n          {...params}\n          className={props.larger ? classes.textFieldRoot : ''}\n          id={props.id}\n          label={props.label}\n          variant={props.variant}\n          size={props.size}\n          InputProps={{\n            ...params.InputProps,\n            endAdornment: (\n              <React.Fragment>\n                {loading ? (\n                  <CircularProgress color=\"inherit\" size={20} />\n                ) : null}\n                {params.InputProps.endAdornment}\n              </React.Fragment>\n            ),\n          }}\n        />\n      )}\n      renderOption={(option) => <Option option={option} />}\n      renderTags={(v, getTagProps) =>\n        v.map((option, index) => (\n          <Chip\n            icon={getIcon(option.type)}\n            key={option.geneName}\n            label={option.geneName}\n            {...getTagProps({ index })}\n          />\n        ))\n      }\n    />\n  );\n}\n\nSearchField.defaultProps = {\n  fullWidth: true,\n  id: '',\n  label: '',\n  multiple: false,\n  onChange: identity,\n  size: 'small',\n  value: null,\n  variant: 'outlined',\n  width: '10rem',\n};\n\nSearchField.propTypes = {\n  customSearch: PropTypes.func,\n  fullWidth: PropTypes.bool,\n  id: PropTypes.string,\n  label: PropTypes.oneOfType([PropTypes.string, PropTypes.node]),\n  multiple: PropTypes.bool,\n  onChange: PropTypes.func,\n  searchUrl: PropTypes.oneOfType([\n    PropTypes.arrayOf(\n      PropTypes.oneOfType([\n        PropTypes.shape({\n          url: PropTypes.string,\n          type: PropTypes.string,\n        }),\n        PropTypes.string,\n      ])\n    ),\n    PropTypes.string,\n  ]).isRequired,\n  size: PropTypes.string,\n  value: PropTypes.oneOfType([PropTypes.array, PropTypes.object]),\n  variant: PropTypes.string,\n  width: PropTypes.string,\n};\n","import { useRef, useEffect } from 'react';\n\nexport default function usePrevious(value) {\n  const ref = useRef();\n  useEffect(() => {\n    ref.current = value;\n  });\n  return ref.current;\n}\n","import React, { useMemo } from 'react';\nimport { useRecoilState } from 'recoil';\n\nimport AppBar from '@material-ui/core/AppBar';\nimport FormControl from '@material-ui/core/FormControl';\nimport Grid from '@material-ui/core/Grid';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport { makeStyles } from '@material-ui/core/styles';\nimport SearchIcon from '@material-ui/icons/Search';\n\nimport SearchField from './SearchField';\n\nimport usePrevious from './use-previous';\n\nimport {\n  focusGeneOptionState,\n  // focusVariantOptionState,\n  focusRegionOptionState,\n  useFocusGene,\n  // useFocusVariant,\n  useFocusRegion,\n} from './state';\n\nimport { DRAWER_WIDTH, GENE_SEARCH_URL, VARIANT_SEARCH_URL } from './constants';\n\nimport { isChrRange } from './utils';\n\nconst useStyles = makeStyles((theme) => ({\n  appBar: {\n    width: `calc(100% - ${DRAWER_WIDTH}px)`,\n    marginLeft: DRAWER_WIDTH,\n    color: theme.palette.common.black,\n    backgroundColor: theme.palette.common.white,\n    boxShadow: `0 1px 0 0 ${theme.palette.grey['300']}`,\n  },\n  toolbarExtra: {\n    paddingLeft: 0,\n    paddingRight: 0,\n    alignItems: 'flex-end',\n  },\n}));\n\nconst locationSearch = async (query) => {\n  if (!query) return undefined;\n\n  const match = isChrRange(query);\n\n  if (!match) return undefined;\n\n  const startChr = match[1];\n  const startPos = +match[2];\n  const endChr = match[7] || match[1];\n\n  let endPos =\n    match[8] ||\n    (match[4] === '~' || match[4] === '+' ? startPos + +match[5] : +match[5]);\n\n  endPos = Number.isNaN(endPos) ? startPos + 1 : endPos;\n\n  if (startChr && startPos && endChr && endPos) {\n    return [\n      {\n        chrStart: `chr${startChr}`,\n        chrEnd: `chr${endChr}`,\n        txStart: startPos,\n        txEnd: endPos,\n        geneName: query,\n        type: 'region',\n      },\n    ];\n  }\n\n  return undefined;\n};\n\nconst AppTopbar = React.memo(function AppTopbar() {\n  const [focusGene, setFocusGene] = useFocusGene();\n  // const [focusVariant, setFocusVariant] = useFocusVariant();\n  const [focusRegion, setFocusRegion] = useFocusRegion();\n\n  const [focusGeneOption, setFocusGeneOption] = useRecoilState(\n    focusGeneOptionState\n  );\n  const [focusRegionOption, setFocusRegionOption] = useRecoilState(\n    focusRegionOptionState\n  );\n\n  const prevFocusGeneOption = usePrevious(focusGeneOption);\n  // const prevFocusVariantOption = usePrevious(focusVariantOption);\n  const prevFocusRegionOption = usePrevious(focusRegionOption);\n\n  // Derived State\n  const focusOptions = useMemo(\n    () => {\n      const _focusOptions = [];\n      // At first we add the focus element that has not changed!\n      if (focusGeneOption && focusGeneOption === prevFocusGeneOption)\n        _focusOptions.push(focusGeneOption);\n      if (focusRegionOption && focusRegionOption === prevFocusRegionOption)\n        _focusOptions.push(focusRegionOption);\n      // Subsequently, we add the focused element that has changed!\n      if (focusGeneOption && focusGeneOption !== prevFocusGeneOption)\n        _focusOptions.push(focusGeneOption);\n      if (focusRegionOption && focusRegionOption !== prevFocusRegionOption)\n        _focusOptions.push(focusRegionOption);\n      return _focusOptions;\n    },\n    // `prevFocusGeneOption` and `prevFocusVariantOption` are ommitted\n    // on purpose to avoid circular updates.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [focusGeneOption, focusRegionOption]\n  );\n\n  const clearFocusGene = () => {\n    setFocusGene('');\n    setFocusGeneOption(null);\n  };\n\n  const clearFocusRegion = () => {\n    setFocusRegion('');\n    setFocusRegionOption(null);\n  };\n\n  const focusOptionChangeHandler = (newOptions) => {\n    if (newOptions.length) {\n      const newFocusElements = {};\n      // We only allow exactly two options!\n      newOptions.slice(newOptions.length - 2).forEach((newOption) => {\n        switch (newOption.type) {\n          case 'gene':\n            newFocusElements.gene = newOption;\n            if (focusGene !== newOption.geneName) {\n              setFocusGene(newOption.geneName);\n              setFocusGeneOption(newOption);\n            }\n            break;\n\n          case 'variant':\n            newFocusElements.variant = newOption;\n            if (focusRegion !== newOption.geneName) {\n              setFocusRegion(newOption.geneName);\n              setFocusRegionOption(newOption);\n            }\n            break;\n\n          case 'region':\n            newFocusElements.region = newOption;\n            if (focusRegion !== newOption.geneName) {\n              setFocusRegion([\n                `${newOption.chrStart}:${newOption.txStart}`,\n                `${newOption.chrEnd}:${newOption.txEnd}`,\n              ]);\n              setFocusRegionOption(newOption);\n            }\n            break;\n\n          default:\n            // eslint-disable-next-line no-console\n            console.warn('Unknown focus element', newOption);\n            break;\n        }\n      });\n      // Unset focus elements\n      if (focusGene && !newFocusElements.gene) clearFocusGene();\n      if (focusRegion && !newFocusElements.region && !newFocusElements.variant)\n        clearFocusRegion();\n    } else {\n      clearFocusGene();\n      clearFocusRegion();\n    }\n  };\n\n  const classes = useStyles();\n\n  return (\n    <AppBar position=\"fixed\" className={classes.appBar}>\n      <Toolbar\n        classes={{\n          root: classes.toolbarExtra,\n        }}\n      >\n        <FormControl fullWidth>\n          <SearchField\n            label={\n              <Grid container direction=\"row\" alignItems=\"center\">\n                <SearchIcon fontSize=\"small\" />\n                <span style={{ marginLeft: 3 }}>Gene, Variant, or Region</span>\n              </Grid>\n            }\n            customSearch={locationSearch}\n            searchUrl={[\n              { url: GENE_SEARCH_URL, type: 'gene' },\n              { url: VARIANT_SEARCH_URL, type: 'variant' },\n            ]}\n            onChange={focusOptionChangeHandler}\n            value={focusOptions}\n            variant=\"filled\"\n            larger\n            fullWidth\n            multiple\n          />\n        </FormControl>\n      </Toolbar>\n    </AppBar>\n  );\n});\n\nexport default AppTopbar;\n","import React from 'react';\nimport { useRecoilValue } from 'recoil';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport {\n  enhancerRegionsShowInfoState,\n  focusRegionState,\n  focusGeneState,\n} from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n    justifyContent: 'space-between',\n  },\n  text: {\n    fontSize: '0.8rem',\n  },\n  black: {\n    color: 'black',\n  },\n  gray: {\n    color: theme.palette.grey['400'],\n  },\n  pink: {\n    color: '#cc0078',\n  },\n}));\n\nconst EnhancerRegionsInfo = React.memo(function EnhancerRegionsInfo() {\n  const showInfo = useRecoilValue(enhancerRegionsShowInfoState);\n  const focusGene = useRecoilValue(focusGeneState);\n  const focusRegion = useRecoilValue(focusRegionState);\n\n  const classes = useStyles();\n\n  if (!showInfo) return '';\n\n  return (\n    <React.Fragment>\n      {focusGene && focusRegion && (\n        <Typography className={classes.text} noWrap>\n          <span className={classes.pink}></span> Enhancers containing{' '}\n          <em>{focusRegion}</em> and predicted to regulate <em>{focusGene}</em>\n        </Typography>\n      )}\n      {focusGene && !focusRegion && (\n        <Typography className={classes.text} noWrap>\n          <span className={classes.pink}></span> Enhancers predicted to\n          regulate <em>{focusGene}</em>\n        </Typography>\n      )}\n      {!focusGene && focusRegion && (\n        <Typography className={classes.text} noWrap>\n          <span className={classes.pink}></span> Enhancers containing{' '}\n          <em>{focusRegion}</em>\n        </Typography>\n      )}\n      {focusGene || focusRegion ? (\n        <Typography className={classes.text} noWrap>\n          <span className={classes.gray}></span> All other predicted enhancers\n        </Typography>\n      ) : (\n        <Typography className={classes.text} noWrap>\n          <span className={classes.black}></span> All predicted enhancers\n        </Typography>\n      )}\n    </React.Fragment>\n  );\n});\n\nexport default EnhancerRegionsInfo;\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\n\nconst EnhancerRegionsInfo = React.memo(function EnhancerRegionsInfo() {\n  return (\n    <React.Fragment>\n      <Typography>\n        This panel visualizes the predicted enhancers by sample type as a\n        matrix-like track. Each rectangle representes an enhancer. Promoter\n        regions are indicated by translucent light gray overlays.\n      </Typography>\n      <Typography>\n        {' '}\n        You can filter enhancers via their target gene or by variant (the dot\n        plot below the gene annotations). Click on a variant or gene to select\n        it. Selections are shown in pink/red.\n      </Typography>\n    </React.Fragment>\n  );\n});\n\nexport default EnhancerRegionsInfo;\n","import React, { useCallback } from 'react';\nimport Box from '@material-ui/core/Box';\nimport IconButton from '@material-ui/core/IconButton';\nimport RadioButtonCheckedIcon from '@material-ui/icons/RadioButtonChecked';\nimport RadioButtonUncheckedIcon from '@material-ui/icons/RadioButtonUnchecked';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport RadioGroup from '@material-ui/core/RadioGroup';\nimport Switch from '@material-ui/core/Switch';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport {\n  useEnhancerRegionsHideUnfocused,\n  useEnhancerRegionsColorEncoding,\n  useVariantYScale,\n} from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  iconRadioLegend: {\n    margin: theme.spacing(2, 0, 0.25, 0),\n  },\n}));\n\nconst EnhancerRegionsInfo = React.memo(function EnhancerRegionsInfo() {\n  const [variantYScale, setVariantYScale] = useVariantYScale();\n  const [hideUnfocused, setHideUnfocused] = useEnhancerRegionsHideUnfocused();\n  const [colorEncoding, setColorEncoding] = useEnhancerRegionsColorEncoding();\n\n  const hideUnfocusedChangeHandler = useCallback(\n    (event) => {\n      setHideUnfocused(event.target.checked);\n    },\n    [setHideUnfocused]\n  );\n\n  const changeVariantYScale = useCallback(\n    (value) => () => {\n      setVariantYScale(value);\n    },\n    [setVariantYScale]\n  );\n\n  const changeColorEncoding = useCallback(\n    (value) => () => {\n      setColorEncoding(value);\n    },\n    [setColorEncoding]\n  );\n\n  const classes = useStyles();\n\n  return (\n    <React.Fragment>\n      <Box m={1}>\n        <FormControlLabel\n          control={\n            <Switch\n              checked={hideUnfocused}\n              onChange={hideUnfocusedChangeHandler}\n              name=\"hideUnfocused\"\n            />\n          }\n          label=\"Hide unfocused enhancer regions\"\n        />\n      </Box>\n      <Box m={1}>\n        <FormControl component=\"fieldset\">\n          <FormLabel component=\"legend\" className={classes.iconRadioLegend}>\n            Variant y-scale\n          </FormLabel>\n          <RadioGroup\n            aria-label=\"variantYScale\"\n            name=\"variantYScale\"\n            value={variantYScale}\n          >\n            <FormControlLabel\n              label=\"p-value\"\n              value=\"pValue\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeVariantYScale('pValue')}\n                >\n                  {variantYScale === 'pValue' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Posterior probability\"\n              value=\"posteriorProbability\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeVariantYScale('posteriorProbability')}\n                >\n                  {variantYScale === 'posteriorProbability' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n          </RadioGroup>\n        </FormControl>\n      </Box>\n      <Box m={1}>\n        <FormControl component=\"fieldset\">\n          <FormLabel component=\"legend\" className={classes.iconRadioLegend}>\n            Matrix colorEncoding\n          </FormLabel>\n          <RadioGroup\n            aria-label=\"colorEncoding\"\n            name=\"colorEncoding\"\n            value={colorEncoding}\n          >\n            <FormControlLabel\n              label=\"Solid\"\n              value=\"solid\"\n              className={classes.iconRadio}\n              control={\n                <IconButton size=\"small\" onClick={changeColorEncoding('solid')}>\n                  {colorEncoding === 'solid' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Number of predictions\"\n              value=\"frequency\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeColorEncoding('frequency')}\n                >\n                  {colorEncoding === 'frequency' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Highest prediction score\"\n              value=\"highestImportance\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeColorEncoding('highestImportance')}\n                >\n                  {colorEncoding === 'highestImportance' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Closest prediction score\"\n              value=\"closestImportance\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeColorEncoding('closestImportance')}\n                >\n                  {colorEncoding === 'closestImportance' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n          </RadioGroup>\n        </FormControl>\n      </Box>\n    </React.Fragment>\n  );\n});\n\nexport default EnhancerRegionsInfo;\n","import React, { useCallback, useMemo, useState } from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport IconButton from '@material-ui/core/IconButton';\nimport HelpIcon from '@material-ui/icons/Help';\nimport InfoIcon from '@material-ui/icons/Info';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport Popover from '@material-ui/core/Popover';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme) => ({\n  grow: {\n    flexGrow: 1,\n  },\n  bar: {\n    position: 'relative',\n    padding: '2px',\n    fontSize: '0.8rem',\n    background: theme.palette.grey['100'],\n  },\n  title: {\n    fontSize: '0.8rem',\n    padding: '0 2px',\n    fontWeight: 900,\n  },\n  icon: {\n    color: theme.palette.grey['400'],\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  iconActive: {\n    color: theme.palette.grey['600'],\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  popeover: {\n    '& > *': {\n      maxWidth: '20rem',\n      padding: '0.5rem',\n      fontSize: '0.8rem',\n      '&+p': {\n        paddingTop: 0,\n      },\n    },\n  },\n  info: {\n    '&> *': {\n      padding: '0 2px',\n    },\n    '&> *:last-child': {\n      borderBottom: `1px solid ${theme.palette.grey['100']}`,\n    },\n  },\n}));\n\nconst TitleBar = React.memo(function TitleBar({\n  id,\n  title,\n  Info,\n  Help,\n  Settings,\n  useShowInfo,\n  popoverDirection = 'bottom',\n}) {\n  const [showInfo, setShowInfo] = useShowInfo();\n  const [helpAnchorEl, setHelpAnchorEl] = useState();\n  const [settingsAnchorEl, setSettingsAnchorEl] = useState();\n\n  const infoToggleHandler = useCallback(() => {\n    setShowInfo((show) => !(show === true || show === 'true'));\n  }, [setShowInfo]);\n\n  const helpOpenHandler = useCallback((event) => {\n    setHelpAnchorEl(event.currentTarget);\n  }, []);\n\n  const helpCloseHandler = useCallback(() => {\n    setHelpAnchorEl(null);\n  }, []);\n\n  const settingsOpenHandler = useCallback((event) => {\n    setSettingsAnchorEl(event.currentTarget);\n  }, []);\n\n  const settingsCloseHandler = useCallback(() => {\n    setSettingsAnchorEl(null);\n  }, []);\n\n  const helpId = useMemo(() => `${id}-help`, [id]);\n  const settingsId = useMemo(() => `${id}-settings`, [id]);\n\n  const anchorOriginVertical = useMemo(\n    () => (popoverDirection === 'bottom' ? 'bottom' : 'top'),\n    [popoverDirection]\n  );\n  const transformOriginVertical = useMemo(\n    () => (popoverDirection === 'bottom' ? 'top' : 'bottom'),\n    [popoverDirection]\n  );\n\n  // On every render\n  const classes = useStyles();\n\n  const helpOpen = Boolean(helpAnchorEl);\n  const settingsOpen = Boolean(settingsAnchorEl);\n\n  const iconInfoClass = showInfo ? classes.iconActive : classes.icon;\n  const iconHelpClass = helpOpen ? classes.iconActive : classes.icon;\n  const iconSettingsClass = settingsOpen ? classes.iconActive : classes.icon;\n\n  return (\n    <Grid item className={classes.root}>\n      <Grid\n        item\n        className={classes.bar}\n        container\n        alignItems=\"center\"\n        wrap=\"nowrap\"\n      >\n        <Grid\n          item\n          container\n          alignItems=\"center\"\n          wrap=\"nowrap\"\n          className={classes.grow}\n        >\n          <Typography component=\"h3\" className={classes.title} noWrap>\n            {title}:\n          </Typography>\n        </Grid>\n        <Grid item>\n          <Grid container alignItems=\"center\" wrap=\"nowrap\">\n            <IconButton\n              aria-label=\"details\"\n              className={iconInfoClass}\n              size=\"small\"\n              onClick={infoToggleHandler}\n            >\n              <InfoIcon fontSize=\"inherit\" />\n            </IconButton>\n            <IconButton\n              aria-label=\"help\"\n              aria-describedby={helpId}\n              className={iconHelpClass}\n              size=\"small\"\n              onClick={helpOpenHandler}\n            >\n              <HelpIcon fontSize=\"inherit\" />\n            </IconButton>\n            <Popover\n              id={helpId}\n              open={helpOpen}\n              anchorEl={helpAnchorEl}\n              onClose={helpCloseHandler}\n              anchorOrigin={{\n                vertical: anchorOriginVertical,\n                horizontal: 'right',\n              }}\n              transformOrigin={{\n                vertical: transformOriginVertical,\n                horizontal: 'right',\n              }}\n            >\n              <div className={classes.popeover}>\n                <Help />\n              </div>\n            </Popover>\n            <IconButton\n              aria-label=\"settings\"\n              aria-describedby={settingsId}\n              className={iconSettingsClass}\n              size=\"small\"\n              onClick={settingsOpenHandler}\n            >\n              <SettingsIcon fontSize=\"inherit\" />\n            </IconButton>\n            <Popover\n              id={helpId}\n              open={settingsOpen}\n              anchorEl={settingsAnchorEl}\n              onClose={settingsCloseHandler}\n              anchorOrigin={{\n                vertical: anchorOriginVertical,\n                horizontal: 'right',\n              }}\n              transformOrigin={{\n                vertical: transformOriginVertical,\n                horizontal: 'right',\n              }}\n            >\n              <div className={classes.popeover}>\n                <Settings />\n              </div>\n            </Popover>\n          </Grid>\n        </Grid>\n      </Grid>\n      <Grid item className={classes.info}>\n        {showInfo && <Info />}\n      </Grid>\n    </Grid>\n  );\n});\n\nexport default TitleBar;\n","import React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { useRecoilValue, useSetRecoilState, useRecoilState } from 'recoil';\nimport { HiGlassComponent } from 'higlass';\nimport { debounce, deepClone, isParentOf, pipe, sum } from '@flekschas/utils';\n\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport { useChromInfo } from './ChromInfoProvider';\nimport EnhancerRegionsInfo from './EnhancerRegionsInfo';\nimport EnhancerRegionsHelp from './EnhancerRegionsHelp';\nimport EnhancerRegionsSettings from './EnhancerRegionsSettings';\nimport TitleBar from './TitleBar';\n\nimport {\n  enhancerRegionsColorEncodingState,\n  enhancerRegionsHideUnfocusedState,\n  focusGeneEndWithAssembly,\n  focusGeneOptionState,\n  focusGeneStartWithAssembly,\n  focusRegionOptionState,\n  focusRegionAbsWithAssembly,\n  higlassEnhancerRegionsState,\n  sampleGroupSelectionSizesState,\n  selectedSamplesState,\n  useEnhancerRegionsShowInfos,\n  useFocusGene,\n  useFocusRegion,\n  useXDomainEndWithAssembly,\n  useXDomainStartWithAssembly,\n  variantTracksState,\n  variantYScaleState,\n  xDomainEndAbsWithAssembly,\n  xDomainStartAbsWithAssembly,\n} from './state';\n\nimport {\n  updateViewConfigFocusGene,\n  updateViewConfigFocusRegion,\n  updateViewConfigVariantYScale,\n  updateViewConfigXDomain,\n  updateViewConfigVariantTracks,\n} from './view-config';\n\nimport {\n  DEFAULT_VIEW_CONFIG_ENHANCER,\n  HIGLASS_PAN_ZOOM,\n  HIGLASS_SELECT,\n  IGNORED_FOCUS_ELEMENTS,\n} from './constants';\n\nimport { chrRangePosEncoder } from './utils';\n\nimport 'higlass/dist/hglib.css';\n\nimport './EnhancerRegions.css';\n\nconst useStyles = makeStyles((theme) => ({\n  grow: {\n    flexGrow: 1,\n  },\n  fullWidthHeight: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n  },\n  higlassContainer: {\n    position: 'relative',\n    minHeight: '100%',\n    overflow: 'hidden',\n  },\n  panZoomTip: {\n    position: 'absolute',\n    zIndex: 11,\n    top: 0,\n    left: 0,\n    right: 0,\n    padding: '0 2px',\n    fontSize: '0.8rem',\n    lineHeight: '1.5rem',\n    background: theme.palette.grey['100'],\n    textAlign: 'center',\n    boxShadow: '0 1px 3px 0 rgba(0, 0, 0, 0.1)',\n    opacity: 1,\n    animation: '0.75s ease 3s 1 running forwards fadeout',\n    '-webkit-touch-callout': 'none',\n    '-webkit-user-select': 'none',\n    '-khtml-user-select': 'none',\n    '-moz-user-select': 'none',\n    '-ms-user-select': 'none',\n    userSelect: 'none',\n    transition: '0.25s ease opacity, 0.25s ease transform',\n    '&:hover': {\n      opacity: 0,\n    },\n  },\n  panZoomTipNormal: {\n    color: theme.palette.grey['600'],\n  },\n  panZoomTipNormalHover: {\n    fontWeight: 'bold',\n    color: 'black',\n    background: '#aaa',\n    animation: '0.75s ease 5s 1 running forwards fadeout',\n  },\n  panZoomTipActive: {\n    color: 'white',\n    background: '#dd55a5',\n    animation: '0.75s ease 5s 1 running forwards fadeout',\n  },\n  panZoomTipActiveHover: {\n    fontWeight: 'bold',\n    color: 'white',\n    background: '#cc0078',\n    animation: '0.75s ease 5s 1 running forwards fadeout',\n  },\n}));\n\nconst updateViewConfigFocusStyle = (hideUnfocused) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[4].options.focusStyle = hideUnfocused\n    ? 'filtering'\n    : 'highlighting';\n  viewConfig.views[0].tracks.top[4].options.stratification.axisNoGroupColor = !hideUnfocused;\n\n  return viewConfig;\n};\n\nconst updateViewConfigColorEncoding = (coloring) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[4].options.opacityEncoding = coloring;\n  return viewConfig;\n};\n\nconst updateViewConfigFilter = (selectedSamples) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[3].contents[0].options.filter = {\n    set: selectedSamples,\n    field: 10,\n  };\n  viewConfig.views[0].tracks.top[3].contents[1].options.filter = {\n    set: selectedSamples,\n    field: 10,\n  };\n  viewConfig.views[0].tracks.top[4].options.filter = {\n    set: selectedSamples,\n    field: 10,\n  };\n  return viewConfig;\n};\n\nconst updateViewConfigMatrixHeight = (numSamples) => (viewConfig) => {\n  const matrixTrack = viewConfig.views[0].tracks.top[4];\n  matrixTrack.height = numSamples * matrixTrack.options.markHeight + 14;\n  return viewConfig;\n};\n\nconst EnhancerRegion = React.memo((props) => {\n  const chromInfo = useChromInfo();\n\n  const [focusGeneOption, setFocusGeneOption] = useRecoilState(\n    focusGeneOptionState\n  );\n\n  const setFocusGene = useFocusGene()[1];\n  const setFocusRegion = useFocusRegion()[1];\n  const setXDomainStart = useXDomainStartWithAssembly(chromInfo)[1];\n  const setXDomainEnd = useXDomainEndWithAssembly(chromInfo)[1];\n  const setFocusRegionOption = useSetRecoilState(focusRegionOptionState);\n  const setHiglass = useSetRecoilState(higlassEnhancerRegionsState);\n\n  const variantTracks = useRecoilValue(variantTracksState);\n  const hideUnfocused = useRecoilValue(enhancerRegionsHideUnfocusedState);\n  const variantYScale = useRecoilValue(variantYScaleState);\n  const colorEncoding = useRecoilValue(enhancerRegionsColorEncodingState);\n  const focusRegionAbs = useRecoilValue(focusRegionAbsWithAssembly(chromInfo));\n  const xDomainStartAbs = useRecoilValue(\n    xDomainStartAbsWithAssembly(chromInfo)\n  );\n  const xDomainEndAbs = useRecoilValue(xDomainEndAbsWithAssembly(chromInfo));\n  const focusGeneStart = useRecoilValue(focusGeneStartWithAssembly(chromInfo));\n  const focusGeneEnd = useRecoilValue(focusGeneEndWithAssembly(chromInfo));\n  const sampleGroupSelectionSizes = useRecoilValue(\n    sampleGroupSelectionSizesState\n  );\n  const selectedSamples = useRecoilValue(selectedSamplesState);\n\n  const [higlassMouseOver, setHiglassMouseOver] = useState(false);\n  const [higlassFocus, setHiglassFocus] = useState(false);\n  const higlassApi = useRef(null);\n  const higlassRangeSelection = useRef(null);\n  const higlassListeners = useRef([]);\n  const higlassContainerRef = useRef(null);\n  const higlassEnhancerClickSelection = useRef(null);\n  const higlassMouseDown = useRef(false);\n  const higlassNumMouseOver = useRef(0);\n  const higlassNumFocus = useRef(0);\n  const higlassNumFocusMouseOut = useRef(0);\n\n  const shouldSkipUpdatingXDomain = () => {\n    if (higlassEnhancerClickSelection.current) {\n      higlassEnhancerClickSelection.current = false;\n      return true;\n    }\n    return false;\n  };\n\n  const numSamples = useMemo(\n    () => sum(Object.values(sampleGroupSelectionSizes)),\n    [sampleGroupSelectionSizes]\n  );\n\n  useEffect(() => {\n    higlassNumMouseOver.current += higlassMouseOver;\n  }, [higlassMouseOver]);\n\n  useEffect(() => {\n    higlassNumFocus.current += higlassFocus;\n  }, [higlassFocus]);\n\n  useEffect(() => {\n    if (higlassFocus) higlassNumFocusMouseOut.current += !higlassMouseOver;\n    else higlassNumFocusMouseOut.current = 0;\n  }, [higlassFocus, higlassMouseOver]);\n\n  const viewConfig = useMemo(\n    () =>\n      pipe(\n        updateViewConfigVariantTracks(variantTracks),\n        updateViewConfigFocusGene(\n          focusGeneOption ? focusGeneOption.geneName : null,\n          focusGeneStart,\n          focusGeneEnd\n        ),\n        updateViewConfigFocusRegion(focusRegionAbs, [2, 4]),\n        updateViewConfigFocusStyle(hideUnfocused),\n        updateViewConfigColorEncoding(colorEncoding),\n        updateViewConfigVariantYScale(variantYScale),\n        updateViewConfigXDomain(xDomainStartAbs, xDomainEndAbs, {\n          force: shouldSkipUpdatingXDomain,\n        }),\n        updateViewConfigFilter(selectedSamples),\n        updateViewConfigMatrixHeight(numSamples)\n      )(deepClone(DEFAULT_VIEW_CONFIG_ENHANCER)),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [\n      // `xDomainStartAbs` and `xDomainEndAbs` are ommitted on purpose to avoid\n      // updating the view-config on every pan or zoom event.\n      variantTracks,\n      focusGeneOption,\n      focusGeneStart,\n      focusGeneEnd,\n      focusRegionAbs,\n      hideUnfocused,\n      colorEncoding,\n      variantYScale,\n      selectedSamples,\n      numSamples,\n    ]\n  );\n\n  const viewConfigHeight = useMemo(\n    () =>\n      viewConfig.views[0].tracks.top.reduce(\n        (height, track) => height + track.height,\n        0\n      ),\n    [viewConfig]\n  );\n\n  const higlassBlockClasses = useMemo(\n    () => (higlassFocus ? 'higlass-block focus' : 'higlass-block'),\n    [higlassFocus]\n  );\n\n  // HiGlass Functions\n  const higlassClickHandler = (event) => {\n    if (event.type === 'gene-annotation') {\n      setFocusGene(event.payload.name);\n      higlassEnhancerClickSelection.current = true;\n      setFocusGeneOption({\n        chr: event.payload.fields[0],\n        txStart: event.payload.fields[1],\n        txEnd: event.payload.fields[2],\n        geneName: event.payload.name,\n        type: 'gene',\n      });\n    } else if (event.type === 'snp') {\n      setFocusRegion(event.payload.name);\n      higlassEnhancerClickSelection.current = true;\n      setFocusRegionOption({\n        chr: event.payload.fields[0],\n        txStart: event.payload.fields[1],\n        txEnd: event.payload.fields[2],\n        geneName: event.payload.name,\n        score: event.payload.importance,\n        type: 'variant',\n      });\n    } else if (event.type === 'annotation' && event.payload.item) {\n      setFocusRegionOption({\n        chrStart: event.payload.item.fields[0],\n        txStart: +event.payload.item.fields[1],\n        chrEnd: event.payload.item.fields[0],\n        txEnd: +event.payload.item.fields[2],\n        geneName: chrRangePosEncoder([\n          `${event.payload.item.fields[0]}:${event.payload.item.fields[1]}`,\n          `${event.payload.item.fields[0]}:${event.payload.item.fields[2]}`,\n        ]),\n        type: 'region',\n      });\n    }\n  };\n\n  const higlassLocationChangeHandler = (event) => {\n    const [newXDomainStart, newXDomainEnd] = event.xDomain.map((absPos) =>\n      chromInfo.absToChr(absPos).slice(0, 2).join(':')\n    );\n    setXDomainStart(newXDomainStart);\n    setXDomainEnd(newXDomainEnd);\n  };\n  const higlassLocationChangeHandlerDb = debounce(\n    higlassLocationChangeHandler,\n    250\n  );\n\n  const higlassRangeSelectionHandler = (event) => {\n    if (event.dataRange[0]) [higlassRangeSelection.current] = event.dataRange;\n  };\n\n  const windowMouseDownClearHandler = useCallback((e) => {\n    if (!isParentOf(e.target, higlassContainerRef.current)) {\n      setHiglassFocus(false);\n    }\n  }, []);\n\n  useEffect(\n    () => {\n      window.addEventListener('mouseup', windowMouseDownClearHandler);\n      window.addEventListener('blur', windowMouseDownClearHandler);\n\n      return () => {\n        window.removeEventListener('mouseup', windowMouseDownClearHandler);\n        window.removeEventListener('blur', windowMouseDownClearHandler);\n      };\n    },\n    // Execute only once on initialization\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n\n  const higlassMouseDownHandler = useCallback(() => {\n    higlassMouseDown.current = true;\n  }, []);\n\n  const higlassInitHandler = useCallback(\n    (higlassInstance) => {\n      if (higlassInstance !== null) {\n        setHiglass(higlassInstance.api);\n        higlassApi.current = higlassInstance.api;\n        higlassInstance.api.setRangeSelectionToInt();\n        higlassListeners.current.push(\n          higlassInstance.api.on('click', higlassClickHandler)\n        );\n        higlassListeners.current.push(\n          higlassInstance.api.on(\n            'location',\n            higlassLocationChangeHandlerDb,\n            'context'\n          )\n        );\n        higlassListeners.current.push(\n          higlassInstance.api.on(\n            'rangeSelection',\n            higlassRangeSelectionHandler,\n            'context'\n          )\n        );\n        higlassInstance.api\n          .getComponent()\n          .element.addEventListener('mousedown', higlassMouseDownHandler);\n      }\n    },\n    // Execute only once on initialization\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n\n  const higlassFocusHandler = () => {\n    setHiglassFocus(true);\n  };\n\n  const higlassBlurHandler = () => {\n    if (!higlassMouseDown.current) {\n      setHiglassFocus(false);\n    }\n  };\n\n  const higlassContainerMouseEnterHandler = () => {\n    setHiglassMouseOver(true);\n  };\n\n  const higlassContainerMouseLeaveHandler = () => {\n    setHiglassMouseOver(false);\n  };\n\n  // On init only\n  useEffect(\n    () => {\n      function keydownHandler(event) {\n        if (\n          IGNORED_FOCUS_ELEMENTS.has(\n            document.activeElement.tagName.toLowerCase()\n          )\n        )\n          return;\n\n        event.preventDefault();\n\n        if (event.altKey) higlassApi.current.activateTool(HIGLASS_SELECT);\n      }\n\n      function keyupHandler(event) {\n        if (\n          IGNORED_FOCUS_ELEMENTS.has(\n            document.activeElement.tagName.toLowerCase()\n          )\n        )\n          return;\n\n        event.preventDefault();\n\n        if (higlassRangeSelection.current) {\n          const chrRange = higlassRangeSelection.current.map(\n            chromInfo.absToChr\n          );\n          const [chrStart, txStart] = chrRange[0];\n          const [chrEnd, txEnd] = chrRange[1];\n          setFocusRegion([`${chrStart}:${txStart}`, `${chrEnd}:${txEnd}`]);\n          setFocusRegionOption({\n            chrStart,\n            txStart,\n            chrEnd,\n            txEnd,\n            geneName: chrRangePosEncoder([\n              `${chrStart}:${txStart}`,\n              `${chrEnd}:${txEnd}`,\n            ]),\n            type: 'region',\n          });\n        }\n\n        higlassRangeSelection.current = null;\n        higlassApi.current.activateTool(HIGLASS_PAN_ZOOM);\n      }\n\n      document.addEventListener('keydown', keydownHandler);\n      document.addEventListener('keyup', keyupHandler);\n\n      return () => {\n        document.removeEventListener('keydown', keydownHandler);\n        document.removeEventListener('keyup', keyupHandler);\n      };\n    },\n    // Execute only once on initialization\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [chromInfo]\n  );\n\n  // Unmount\n  useEffect(\n    () => () => {\n      if (higlassApi.current) {\n        higlassListeners.current.forEach(({ event, handler }) => {\n          higlassApi.current.off(event, handler);\n        });\n        higlassApi.current\n          .getComponent()\n          .element.removeEventListener('mousedown', higlassMouseDownHandler);\n        higlassApi.current.destroy();\n      }\n    },\n    // Execute only once on initialization\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n\n  // Run on every render\n  const classes = useStyles();\n\n  return (\n    <div className={classes.root}>\n      <TitleBar\n        id=\"enhancer-regions\"\n        title=\"Enhancer Regions\"\n        useShowInfo={useEnhancerRegionsShowInfos}\n        Info={EnhancerRegionsInfo}\n        Help={EnhancerRegionsHelp}\n        Settings={EnhancerRegionsSettings}\n      />\n      <div\n        className={`higlass-container ${classes.higlassContainer}`}\n        onMouseEnter={higlassContainerMouseEnterHandler}\n        onMouseLeave={higlassContainerMouseLeaveHandler}\n        ref={higlassContainerRef}\n        style={{ height: `${viewConfigHeight}px` }}\n      >\n        {higlassFocus &&\n          !higlassMouseOver &&\n          higlassNumFocus.current < 2 &&\n          higlassNumFocusMouseOut.current < 1 && (\n            <Typography\n              // Just a hack to trigger a dom rerendering which in turn\n              // triggers the fadeout animation\n              component=\"div\"\n              className={`panZoomTip ${classes.panZoomTip} ${classes.panZoomTipActive}`}\n              noWrap\n            >\n              Click outside to deactivate pan & zoom!\n            </Typography>\n          )}\n        {higlassFocus &&\n          higlassMouseOver &&\n          higlassNumFocus.current < 2 &&\n          higlassNumFocusMouseOut.current < 1 && (\n            <Typography\n              // Just a hack to trigger a dom rerendering which in turn\n              // triggers the fadeout animation\n              component=\"span\"\n              className={`panZoomTip ${classes.panZoomTip} ${classes.panZoomTipActiveHover}`}\n              noWrap\n            >\n              You can now pan & zoom the plot!\n            </Typography>\n          )}\n        {!higlassFocus && higlassMouseOver && higlassNumMouseOver.current < 2 && (\n          <Typography\n            // Just a hack to trigger a dom rerendering which in turn\n            // triggers the fadeout animation\n            component=\"div\"\n            className={`panZoomTip ${classes.panZoomTip} ${classes.panZoomTipNormalHover}`}\n            noWrap\n          >\n            Click to activate pan & zoom!\n          </Typography>\n        )}\n        {!higlassFocus && !higlassMouseOver && higlassNumMouseOver.current < 2 && (\n          <Typography\n            // Just a hack to trigger a dom rerendering which in turn\n            // triggers the fadeout animation\n            component=\"span\"\n            className={`panZoomTip ${classes.panZoomTip} ${classes.panZoomTipNormal}`}\n            noWrap\n          >\n            This plot is interactive!\n          </Typography>\n        )}\n        <div\n          className={higlassBlockClasses}\n          onMouseDown={higlassMouseDownHandler}\n          onFocus={higlassFocusHandler}\n          onBlur={higlassBlurHandler}\n          tabIndex=\"0\"\n        />\n        <HiGlassComponent\n          ref={higlassInitHandler}\n          viewConfig={viewConfig}\n          options={{\n            sizeMode: 'bounded',\n            globalMousePosition: true,\n          }}\n        />\n      </div>\n    </div>\n  );\n});\n\nexport default EnhancerRegion;\n","import React from 'react';\nimport { useRecoilValue } from 'recoil';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport {\n  enhancerGenesCellEncodingState,\n  enhancerGenesShowInfoState,\n  focusRegionState,\n  focusRegionStrState,\n} from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n    justifyContent: 'space-between',\n  },\n  text: {\n    fontSize: '0.8rem',\n    verticalAlign: 'center',\n  },\n  placeholder: {\n    fontStyle: 'italic',\n    color: theme.palette.grey['600'],\n  },\n  small: {\n    fontSize: '0.5em',\n    lineHeight: '2em',\n  },\n  medium: {\n    fontSize: '1em',\n    lineHeight: '1em',\n  },\n  large: {\n    fontSize: '1.5em',\n    lineHeight: '0.6667em',\n    marginLeft: '-0.05rem',\n    marginRight: '0.1rem',\n  },\n}));\n\nconst EnhancerRegionsInfo = React.memo(function EnhancerRegionsInfo() {\n  const showInfo = useRecoilValue(enhancerGenesShowInfoState);\n  const focusRegion = useRecoilValue(focusRegionState);\n  const focusRegionStr = useRecoilValue(focusRegionStrState);\n  const cellEncoding = useRecoilValue(enhancerGenesCellEncodingState);\n\n  const classes = useStyles();\n\n  if (!showInfo) return '';\n\n  return (\n    <div>\n      {!focusRegion && (\n        <Grid\n          container\n          justify=\"center\"\n          alignItems=\"center\"\n          className={classes.placeholder}\n        >\n          <Typography className={classes.text}>\n            Select a variant or focus region to see details\n          </Typography>\n        </Grid>\n      )}\n      {focusRegion && cellEncoding === 'number' && (\n        <React.Fragment>\n          <Typography className={classes.text}>\n            <span className={classes.small}></span>\n            <span className={classes.medium}></span>\n            <span className={classes.large}></span>\n            <strong>Absolute number</strong> of enhancer-gene connections\n            overlapping <em>{focusRegionStr}</em> by sample groups across\n            up/downstream genes.\n          </Typography>\n        </React.Fragment>\n      )}\n      {focusRegion && cellEncoding === 'percent' && (\n        <React.Fragment>\n          <Typography className={classes.text}>\n            <span className={classes.small}></span>\n            <span className={classes.medium}></span>\n            <span className={classes.large}></span>\n            <strong>Percentage</strong> of enhancer-gene connections overlapping{' '}\n            <em>{focusRegionStr}</em> within a sample group across up/downstream\n            genes.\n          </Typography>\n        </React.Fragment>\n      )}\n      {focusRegion && cellEncoding === 'distribution' && (\n        <React.Fragment>\n          <Typography className={classes.text}>\n            <strong>Distribution</strong> of the prediction scores of\n            enhancer-gene connections overlapping <em>{focusRegionStr}</em> by\n            sample group across up/downstream genes.\n          </Typography>\n        </React.Fragment>\n      )}\n      {focusRegion && cellEncoding === 'array' && (\n        <React.Fragment>\n          <Typography className={classes.text}>\n            <span></span>\n            <strong>Presence</strong> of enhancer-gene connections overlapping{' '}\n            <em>{focusRegionStr}</em> by samples across sample groups and\n            up/downstream genes.\n          </Typography>\n        </React.Fragment>\n      )}\n    </div>\n  );\n});\n\nexport default EnhancerRegionsInfo;\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\n\nconst EnhancerRegionsHelp = React.memo(function EnhancerRegionsHelp() {\n  return (\n    <React.Fragment>\n      <Typography>...</Typography>\n    </React.Fragment>\n  );\n});\n\nexport default EnhancerRegionsHelp;\n","import Switch from '@material-ui/core/Switch';\nimport { withStyles } from '@material-ui/core/styles';\n\nconst AntSwitch = withStyles((theme) => ({\n  root: {\n    width: 36,\n    height: 24,\n    padding: 4,\n    margin: '-4px 0 -4px -4px',\n    display: 'flex',\n    borderRadius: 24,\n    transition: 'background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n    '&:hover': {\n      backgroundColor: 'rgba(0, 0, 0, 0.04)',\n    },\n  },\n  switchBase: {\n    top: 4,\n    left: 4,\n    padding: 2,\n    color: theme.palette.grey[500],\n    '&$checked': {\n      transform: 'translateX(12px)',\n      color: theme.palette.common.white,\n      '& + $track': {\n        opacity: 1,\n        backgroundColor: theme.palette.primary.main,\n        borderColor: theme.palette.primary.main,\n      },\n    },\n  },\n  thumb: {\n    width: 12,\n    height: 12,\n    boxShadow: 'none',\n  },\n  track: {\n    border: `1px solid ${theme.palette.grey[500]}`,\n    borderRadius: 16 / 2,\n    opacity: 1,\n    backgroundColor: theme.palette.common.white,\n  },\n  checked: {},\n}))(Switch);\n\nexport default AntSwitch;\n","import React from 'react';\nimport Box from '@material-ui/core/Box';\nimport IconButton from '@material-ui/core/IconButton';\nimport RadioButtonCheckedIcon from '@material-ui/icons/RadioButtonChecked';\nimport RadioButtonUncheckedIcon from '@material-ui/icons/RadioButtonUnchecked';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport RadioGroup from '@material-ui/core/RadioGroup';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport AntSwitch from './AntSwitch';\n\nimport { useEnhancerGenesCellEncoding, useEnhancerGenesPadding } from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  iconRadio: {\n    padding: theme.spacing(0.5, 0),\n    marginLeft: -theme.spacing(1) / 2,\n    '& .MuiFormControlLabel-label': {\n      lineHeight: 1.2,\n    },\n  },\n  iconRadioActive: {\n    color: 'black',\n  },\n  iconRadioLegend: {\n    margin: theme.spacing(2, 0, 0.25, 0),\n  },\n  switch: {\n    margin: 0,\n  },\n}));\n\nconst EnhancerGenesSettings = React.memo(function EnhancerGenesSettings() {\n  const [cellEncoding, setCellEncoding] = useEnhancerGenesCellEncoding();\n  const [padding, setPadding] = useEnhancerGenesPadding();\n\n  const changeCellEncoding = (value) => () => {\n    setCellEncoding(value);\n  };\n\n  const changePadding = (event) => {\n    setPadding(event.target.checked);\n  };\n\n  const classes = useStyles();\n\n  return (\n    <React.Fragment>\n      <Box m={1}>\n        <FormControlLabel\n          className={classes.switch}\n          control={\n            <AntSwitch checked={padding} onChange={changePadding} name=\"true\" />\n          }\n          label=\"Gene padding\"\n        />\n      </Box>\n      <Box m={1}>\n        <FormControl component=\"fieldset\">\n          <FormLabel component=\"legend\" className={classes.iconRadioLegend}>\n            Gene Cell Encoding\n          </FormLabel>\n          <RadioGroup\n            aria-label=\"cellEncoding\"\n            name=\"cellEncoding\"\n            value={cellEncoding}\n          >\n            <FormControlLabel\n              label=\"Abs. number of predictions\"\n              value=\"number\"\n              className={classes.iconRadio}\n              control={\n                <IconButton size=\"small\" onClick={changeCellEncoding('number')}>\n                  {cellEncoding === 'number' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Rel. number of predictions per group\"\n              value=\"percent\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeCellEncoding('percent')}\n                >\n                  {cellEncoding === 'percent' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Distribution by prediction score\"\n              value=\"distribution\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeCellEncoding('distribution')}\n                >\n                  {cellEncoding === 'distribution' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Sample array\"\n              value=\"array\"\n              className={classes.iconRadio}\n              control={\n                <IconButton size=\"small\" onClick={changeCellEncoding('array')}>\n                  {cellEncoding === 'array' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n          </RadioGroup>\n        </FormControl>\n      </Box>\n    </React.Fragment>\n  );\n});\n\nexport default EnhancerGenesSettings;\n","import React, { createContext, useCallback, useState } from 'react';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst TooltipContext = createContext();\n\nconst useStyles = makeStyles({\n  root: {\n    position: 'fixed',\n    zIndex: 10,\n    width: 1,\n    height: 1,\n    background: 'black',\n    fontWeight: 'normal',\n    pointerEvents: 'none',\n    '& strong': {\n      fontWeight: 'bold',\n    },\n  },\n});\n\nexport default function TooltipProvider({ children }) {\n  const [localState, setLocalState] = useState({\n    show: false,\n    title: '',\n    x: 0,\n    y: 0,\n    arrow: true,\n    placement: 'bottom',\n    classes: {},\n  });\n\n  const showTooltip = useCallback(\n    (\n      x,\n      y,\n      title,\n      { arrow = false, placement = 'bottom', classes = {} } = {}\n    ) => {\n      if (Number.isNaN(+x) || Number.isNaN(+y) || !title) {\n        // Close tooltip\n        setLocalState({\n          show: false,\n          title: '',\n          x: 0,\n          y: 0,\n          arrow: true,\n          placement: 'bottom',\n          classes: {},\n        });\n      } else {\n        // Open tooltip\n        setLocalState({\n          show: true,\n          x,\n          y,\n          title,\n          arrow,\n          placement,\n          classes,\n        });\n      }\n    },\n    []\n  );\n\n  const classes = useStyles();\n\n  return (\n    <TooltipContext.Provider value={showTooltip}>\n      {children}\n      <Tooltip\n        open={localState.show}\n        title={localState.title}\n        arrow={localState.arrow}\n        placement={localState.placement}\n        classes={localState.classes}\n      >\n        <div\n          className={classes.root}\n          style={{\n            top: localState.y,\n            left: localState.x,\n          }}\n        />\n      </Tooltip>\n    </TooltipContext.Provider>\n  );\n}\n\nfunction useShowTooltip() {\n  const context = React.useContext(TooltipContext);\n  if (context === undefined) {\n    throw new Error('useShowTooltip must be used within a TooltipContext');\n  }\n  return context;\n}\n\nexport { useShowTooltip };\n","import { identity, range } from '@flekschas/utils';\nimport { axisRight, scaleLinear, scaleLog, select } from 'd3';\nimport React, {\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useMemo,\n  useState,\n} from 'react';\nimport { useRecoilValue, useRecoilState } from 'recoil';\nimport TinyQueue from 'tinyqueue';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport { useChromInfo } from './ChromInfoProvider';\nimport { useShowTooltip } from './TooltipProvider';\n\nimport {\n  enhancerGenesCellEncodingState,\n  enhancerGenesPaddingState,\n  enhancerGenesSvgState,\n  focusRegionAbsWithAssembly,\n  focusRegionRelState,\n  focusRegionState,\n  focusRegionStrState,\n  sampleSelectionState,\n  sampleGroupSelectionSizesState,\n} from './state';\n\nimport {\n  DEFAULT_COLOR_MAP,\n  DEFAULT_COLOR_MAP_DARK,\n  DEFAULT_COLOR_MAP_LIGHT,\n  DEFAULT_STRATIFICATION,\n  DEFAULT_VIEW_CONFIG_ENHANCER,\n  SAMPLE_IDX,\n} from './constants';\nimport { scaleBand } from './utils';\nimport usePrevious from './use-previous';\n\nimport './EnhancerGenesPlot.css';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    color: theme.palette.grey['300'],\n    minHeight: '6rem',\n  },\n  plot: {\n    position: 'relative',\n    flexGrow: 1,\n  },\n  plotSvg: {\n    width: '100%',\n    height: '100%',\n  },\n}));\n\nconst useTooltipStyles = DEFAULT_COLOR_MAP_LIGHT.map((color, i) =>\n  makeStyles((theme) => ({\n    arrow: {\n      color,\n    },\n    tooltip: {\n      color: DEFAULT_COLOR_MAP_DARK[i],\n      backgroundColor: color,\n      boxShadow: '0 0 3px 0 rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(0, 0, 0, 0.05)',\n      '& .value': {\n        color: 'white',\n        background: DEFAULT_COLOR_MAP_DARK[i],\n        padding: '0 0.25em',\n        borderRadius: '0.25rem',\n      },\n    },\n  }))\n);\n\nconst {\n  server,\n  tilesetUid: uuid,\n} = DEFAULT_VIEW_CONFIG_ENHANCER.views[0].tracks.top[3].contents[1];\n\nconst fetchTiles = async (tileIds) => {\n  const response = await fetch(\n    `${server}/tiles/?${tileIds.map((tileId) => `d=${tileId}`).join('&')}`\n  );\n  return response.json();\n};\n\nconst categories = {};\nconst samples = {};\n\nDEFAULT_STRATIFICATION.groups.forEach((group, i) => {\n  categories[group.label] = {\n    name: group.label,\n    size: group.categories.length,\n    index: i,\n  };\n\n  group.categories.forEach((category, j) => {\n    samples[category] = {\n      category: categories[group.label],\n      index: j,\n    };\n  });\n});\n\nconst getMinTileSize = (tilesetInfo) =>\n  tilesetInfo.max_width / 2 ** tilesetInfo.max_zoom;\n\nconst filterIntervalsByRange = (tile, absRange) =>\n  tile.filter(\n    (interval) => interval.xEnd >= absRange[0] && interval.xStart < absRange[1]\n  );\n\n// From https://observablehq.com/@d3/beeswarm\nconst dodge = (data, radius, yScale) => {\n  const radius2 = radius ** 2;\n  const circles = data\n    .map((d) => ({ y: yScale(d.value), data: d }))\n    .sort((a, b) => a.y - b.y);\n  const epsilon = 1e-3;\n  let head = null;\n  let tail = null;\n\n  // Returns true if circle x,y intersects with any circle in the queue.\n  function intersects(x, y) {\n    let a = head;\n    while (a) {\n      if (radius2 - epsilon > (a.x - x) ** 2 + (a.y - y) ** 2) {\n        return true;\n      }\n      a = a.next;\n    }\n    return false;\n  }\n\n  // Place each circle sequentially.\n  for (const b of circles) {\n    // Remove circles from the queue that cant intersect the new circle b.\n    while (head && head.y < b.y - radius2) head = head.next;\n\n    // Choose the minimum non-intersecting tangent.\n    if (intersects((b.x = 0), b.y)) {\n      let a = head;\n      b.x = Infinity;\n      do {\n        const x = a.x + Math.sqrt(radius2 - (a.y - b.y) ** 2);\n        if (x < b.x && !intersects(x, b.y)) b.x = x;\n        a = a.next;\n      } while (a);\n    }\n\n    // Add b to the queue.\n    b.next = null;\n    // eslint-disable-next-line no-multi-assign\n    if (head === null) head = tail = b;\n    // eslint-disable-next-line no-multi-assign\n    else tail = tail.next = b;\n  }\n\n  return circles;\n};\n\nconst plotEnhancerGeneConnections = (\n  node,\n  width,\n  data,\n  {\n    geneCellEncoding = 'distribution',\n    prevGeneCellEncoding,\n    genePadding = false,\n    showTooltip = identity,\n    tooltipClasses = [],\n    position = '',\n    focusRegion = null,\n  } = {}\n) => {\n  if (!width || !data) return;\n\n  const svg = select(node);\n\n  const paddingTop = 60;\n  const paddingBottom = 60;\n  const circleRadius = 1;\n  const circlePadding = 0.5;\n  const rowHeight = 36;\n  const geneLabelPadding = 3;\n  const beeswarmPadding = 1;\n  const distanceBarWidth = 6;\n  const distPaddingRange = [0, 20];\n  const height =\n    Object.values(categories).length * rowHeight + paddingTop + paddingBottom;\n\n  svg.attr('viewbox', `0 0 ${width} ${height}`).attr('height', height);\n\n  const maxCatgorySize = Object.values(data.categoryAggregation).reduce(\n    (max, cat) => Math.max(max, cat.numEnhancers),\n    0\n  );\n  const categorySizeScale = scaleLog()\n    .domain([1, maxCatgorySize])\n    .range([2, rowHeight])\n    .clamp(true);\n\n  const percentScale = scaleLinear()\n    .domain([0, 1])\n    .range([0, rowHeight])\n    .clamp(true);\n\n  const circleYScalePre = scaleLinear()\n    .domain([0, 1])\n    .range([1, 10])\n    .clamp(true);\n\n  const circleYScalePost = scaleLog()\n    .domain([1, 10])\n    .range([\n      rowHeight - circleRadius - beeswarmPadding,\n      circleRadius + beeswarmPadding,\n    ]);\n\n  const circleYScale = (v) => circleYScalePost(circleYScalePre(v));\n\n  // ---------------------------------------------------------------------------\n  // Gene setup\n  const geneContainerWidth = width / 2 - rowHeight;\n  const maxGenes = Math.floor(geneContainerWidth / rowHeight);\n\n  const genesUpstream = data.genesUpstreamByDist.slice(0, maxGenes).reverse();\n  const genesDownstream = data.genesDownstreamByDist.slice(0, maxGenes);\n\n  const [minRelDistance, maxRelDistance] = [\n    ...genesUpstream,\n    ...genesDownstream,\n  ].reduce(\n    (minMax, gene) => [\n      Math.min(minMax[0], gene.relDistance),\n      Math.max(minMax[1], gene.relDistance),\n    ],\n    [Infinity, 0]\n  );\n\n  const paddingScale = scaleLinear()\n    .domain([minRelDistance, maxRelDistance])\n    .range(distPaddingRange);\n\n  const genesUpstreamPadding = genePadding\n    ? genesUpstream.map((d) => Math.round(paddingScale(d.relDistance)))\n    : [];\n  const genesUpstreamScale = scaleBand()\n    .domain(genesUpstream.map((d) => d.name))\n    .range([0, width / 2 - rowHeight / 2])\n    .paddingInner(genesUpstreamPadding);\n\n  const genesDownstreamPadding = genePadding\n    ? genesDownstream.map((d) => Math.round(paddingScale(d.relDistance)))\n    : [];\n  const genesDownstreamScale = scaleBand()\n    .domain(genesDownstream.map((d) => d.name))\n    .range([0, width / 2 - rowHeight / 2])\n    .paddingInner(genesDownstreamPadding)\n    .paddingInnerZeroBased(true);\n\n  const bandwidth = Math.min(\n    genesUpstreamScale.bandwidth(),\n    genesDownstreamScale.bandwidth()\n  );\n\n  genesUpstreamScale.fixedBandwidth(bandwidth);\n  genesDownstreamScale.fixedBandwidth(bandwidth);\n\n  const genesUpstreamLeftPad = Math.max(\n    0,\n    genesUpstreamScale.rangeSize() - genesUpstreamScale.totalWidth()\n  );\n\n  const minVisibleAbsDist = Math.min(\n    genesUpstream.reduce(\n      (minDist, gene) => Math.min(minDist, gene.absDistance),\n      Infinity\n    ),\n    genesDownstream.reduce(\n      (minDist, gene) => Math.min(minDist, gene.absDistance),\n      Infinity\n    )\n  );\n\n  const maxVisibleAbsDist = Math.max(\n    genesUpstream.reduce(\n      (maxDist, gene) => Math.max(maxDist, gene.absDistance),\n      0\n    ),\n    genesDownstream.reduce(\n      (maxDist, gene) => Math.max(maxDist, gene.absDistance),\n      0\n    )\n  );\n\n  const distanceHeightScale = scaleLinear()\n    .domain([minVisibleAbsDist, maxVisibleAbsDist])\n    .range([2, paddingBottom]);\n\n  const plotBeeswarm = (selection, { isRightAligned = false } = {}) => {\n    selection\n      .attr(\n        'fill',\n        (d, i) => DEFAULT_COLOR_MAP_DARK[i % DEFAULT_COLOR_MAP_DARK.length]\n      )\n      .selectAll('circle')\n      .data((d) => dodge(d, circleRadius * 2 + circlePadding, circleYScale))\n      .join('circle')\n      .attr('cx', (d) =>\n        isRightAligned\n          ? genesUpstreamScale.bandwidth() - (d.x + 2 * beeswarmPadding)\n          : d.x + circleRadius + beeswarmPadding\n      )\n      .attr('cy', (d) => d.y)\n      .attr('r', circleRadius);\n  };\n\n  const getArrayNumCols = (genes) => {\n    const maxSize = Object.values(genes[0].samplesByCategory).reduce(\n      (max, cat) => Math.max(max, cat.size),\n      0\n    );\n    return Math.ceil(Math.sqrt((maxSize * bandwidth) / rowHeight));\n  };\n\n  const plotArray = (\n    selection,\n    numCols,\n    {\n      instanceCache = {},\n      onMouseEnter = identity,\n      onMouseLeave = identity,\n      tooltipTitleGetter = null,\n    } = {}\n  ) => {\n    const cellSize = bandwidth / numCols;\n\n    const indexToX = (index) => (index % numCols) * cellSize;\n    const indexToY = (index) => Math.floor(index / numCols) * cellSize;\n\n    instanceCache.current = selection\n      .attr(\n        'fill',\n        (d, i) => DEFAULT_COLOR_MAP_DARK[i % DEFAULT_COLOR_MAP_DARK.length]\n      )\n      .selectAll('rect')\n      .data(\n        (d) => d,\n        (d) => `${d.gene}|${d.sample}`\n      )\n      .join('rect')\n      .attr('x', (d) => indexToX(samples[d.sample].index))\n      .attr('y', (d) => indexToY(samples[d.sample].index))\n      .attr('width', cellSize)\n      .attr('height', cellSize)\n      .on('mouseenter', (event, d) => {\n        const bBox = event.target.getBoundingClientRect();\n        const title =\n          (tooltipTitleGetter && tooltipTitleGetter(d)) || d.value.toFixed(3);\n        showTooltip(bBox.x + bBox.width / 2, bBox.y, title, {\n          arrow: true,\n          placement: 'top',\n          classes:\n            tooltipClasses[\n              categories[d.sampleCategory].index % tooltipClasses.length\n            ],\n        });\n        onMouseEnter(d);\n      })\n      .on('mouseleave', (d) => {\n        showTooltip();\n        onMouseLeave(d);\n      });\n  };\n\n  const arrayTooltipTitleGetter = (d) => (\n    <React.Fragment>\n      The enhancer overlapping <strong>{position}</strong>\n      {focusRegion ? ` (${focusRegion})` : ''} is predicted to regulate{' '}\n      <strong>{d.gene}</strong> in sample <strong>{d.sample}</strong> with a\n      score of <strong className=\"value\">{d.value.toFixed(3)}</strong>.\n    </React.Fragment>\n  );\n\n  const geneArrayInstances = {\n    upstream: { current: null },\n    downstream: { current: null },\n  };\n\n  const geneArrayInstanceMouseEnterHandler = (dHovering) => {\n    const opacity = (d) => (d.sample === dHovering.sample ? 1 : 0.2);\n    geneArrayInstances.upstream.current.attr('opacity', opacity);\n    geneArrayInstances.downstream.current.attr('opacity', opacity);\n  };\n\n  const geneArrayInstanceMouseLeaveHandler = () => {\n    geneArrayInstances.upstream.current.attr('opacity', 1);\n    geneArrayInstances.downstream.current.attr('opacity', 1);\n  };\n\n  const plotBox = (\n    selection,\n    valueScale,\n    valueGetter,\n    {\n      cellWidth = rowHeight,\n      fillColor = DEFAULT_COLOR_MAP_LIGHT,\n      textColor = DEFAULT_COLOR_MAP_DARK,\n      showText = true,\n      showZero = true,\n      showTooltip: showTooltipOnMouseEnter = false,\n      tooltipTitleGetter = null,\n    } = {}\n  ) => {\n    const bg = selection\n      .selectAll('.bg')\n      .data((d) => [d])\n      .join('rect')\n      .attr('class', 'bg')\n      .attr('fill', (d) => fillColor[d.row % fillColor.length])\n      .attr('x', (d) => (cellWidth - valueScale(valueGetter(d))) / 2)\n      .attr('y', (d) => (rowHeight - valueScale(valueGetter(d))) / 2)\n      .attr('width', (d) => valueScale(valueGetter(d)))\n      .attr('height', (d) => valueScale(valueGetter(d)))\n      .attr('opacity', (d) => +(valueGetter(d) > 0));\n\n    if (showTooltipOnMouseEnter) {\n      bg.on('mouseenter', (event, d) => {\n        const bBox = event.target.getBoundingClientRect();\n        const title =\n          (tooltipTitleGetter && tooltipTitleGetter(d)) || valueGetter(d);\n        showTooltip(bBox.x + bBox.width / 2, bBox.y, title, {\n          arrow: true,\n          placement: 'top',\n          classes: tooltipClasses[d.row % tooltipClasses.length],\n        });\n      }).on('mouseleave', () => {\n        showTooltip();\n      });\n    } else {\n      bg.on('mouseenter', null).on('mouseleave', null);\n    }\n\n    if (showText) {\n      selection\n        .selectAll('.box-text')\n        .data((d) => [d])\n        .join('text')\n        .attr('class', 'box-text')\n        .attr('fill', (d) => textColor[d.row % textColor.length])\n        .attr('style', 'font-size: 12px; font-weight: bold;')\n        .attr('dominant-baseline', 'middle')\n        .attr('text-anchor', 'middle')\n        .attr('x', cellWidth / 2)\n        .attr('y', rowHeight / 2)\n        .attr('opacity', (d) => +(valueGetter(d) > 0 || showZero))\n        .text((d) => valueGetter(d));\n    }\n  };\n\n  const boxTooltipTitleGetter = (d) => (\n    <React.Fragment>\n      <strong className=\"value\">{d.length}</strong> out of {d.size}{' '}\n      <em>{Object.values(categories)[d.row].name}</em> samples have predicted\n      enhancer activity.\n    </React.Fragment>\n  );\n\n  // ---------------------------------------------------------------------------\n  // Category summary\n  const enhancerG = svg\n    .select('#enhancers')\n    .attr('transform', `translate(${width / 2 - rowHeight / 2}, 0)`);\n\n  // Draw background\n  const enhancerGCellG = enhancerG\n    .selectAll('.enhancer-gene-aggregate')\n    .data(\n      Object.values(data.categoryAggregation).map((d, i) => {\n        // Little hacky but necessary unfortunately\n        d.row = i;\n        return d;\n      }),\n      (d) => d.category.name\n    )\n    .join('g')\n    .attr('class', 'enhancer-gene-aggregate')\n    .attr('transform', (d, i) => `translate(0, ${i * rowHeight + paddingTop})`);\n\n  plotBox(enhancerGCellG, categorySizeScale, (d) => d.numEnhancers);\n\n  // Draw border\n  svg\n    .select('#enhancers')\n    .selectAll('.enhancer-box-border')\n    .data(Object.values(categories), (d) => d.name)\n    .join('rect')\n    .attr('class', 'enhancer-box-border')\n    .attr('fill', 'none')\n    .attr(\n      'stroke',\n      (d, i) => DEFAULT_COLOR_MAP_LIGHT[i % DEFAULT_COLOR_MAP_LIGHT.length]\n    )\n    .attr('stroke-width', '1')\n    .attr('x', 0)\n    .attr('y', (d, i) => i * rowHeight + paddingTop)\n    .attr('width', rowHeight)\n    .attr('height', rowHeight);\n\n  // ---------------------------------------------------------------------------\n  // Draw upstream genes\n\n  const genesUpstreamG = svg\n    .select('#genes-upstream')\n    .selectAll('.gene-upstream')\n    .data(genesUpstream, (d) => d.name)\n    .join('g')\n    .attr('class', 'gene-upstream')\n    .attr(\n      'transform',\n      (d) =>\n        `translate(${genesUpstreamLeftPad + genesUpstreamScale(d.name)}, 0)`\n    );\n\n  // Draw labels\n  const geneLabelX = genesUpstreamScale.bandwidth() / 2;\n  const geneLabelY = paddingTop - geneLabelPadding;\n  genesUpstreamG\n    // the join is needed to avoid appending more and more text elements on\n    // subsequent calls of this function, which would happen if we used\n    // `append()` instead.\n    .selectAll('.gene-upstream-label')\n    .data((d) => [d])\n    .join('text')\n    .attr('class', 'gene-label gene-upstream-label')\n    .attr('style', 'font-size: 9px;')\n    .attr('transform', `translate(${geneLabelX},${geneLabelY}) rotate(-90)`)\n    .attr('fill', 'black')\n    .attr('dominant-baseline', 'middle')\n    .text((d) => d.name);\n\n  // Draw cell\n  const genesUpstreamGCellG = genesUpstreamG\n    .selectAll('.gene-upstream-cell')\n    .data(\n      (d) =>\n        Object.values(d.samplesByCategory).map((item, i) => {\n          // Little hacky but necessary unfortunately\n          item.row = i;\n          return item;\n        }),\n      (d) => d.name\n    )\n    .join('g')\n    .attr('class', 'gene-upstream-cell')\n    .attr('transform', (d, i) => `translate(0, ${i * rowHeight + paddingTop})`);\n\n  if (geneCellEncoding !== prevGeneCellEncoding) {\n    genesUpstreamGCellG.selectAll('*').remove();\n  }\n\n  switch (geneCellEncoding) {\n    case 'distribution':\n      plotBeeswarm(genesUpstreamGCellG, { isRightAligned: true });\n      break;\n\n    case 'array':\n      plotArray(genesUpstreamGCellG, getArrayNumCols(genesUpstream), {\n        tooltipTitleGetter: arrayTooltipTitleGetter,\n        instanceCache: geneArrayInstances.upstream,\n        onMouseEnter: geneArrayInstanceMouseEnterHandler,\n        onMouseLeave: geneArrayInstanceMouseLeaveHandler,\n      });\n      break;\n\n    case 'number':\n    case 'percent':\n    default: {\n      const valueScale =\n        geneCellEncoding === 'percent' ? percentScale : categorySizeScale;\n\n      const valueGetter =\n        geneCellEncoding === 'percent'\n          ? (d) => d.length / d.size\n          : (d) => d.length;\n\n      plotBox(genesUpstreamGCellG, valueScale, valueGetter, {\n        showText: false,\n        cellWidth: genesUpstreamScale.bandwidth(),\n        fillColor: DEFAULT_COLOR_MAP,\n        showTooltip: true,\n        tooltipTitleGetter: boxTooltipTitleGetter,\n      });\n\n      break;\n    }\n  }\n\n  // Draw border\n  genesUpstreamG\n    .selectAll('.gene-upstream-border')\n    .data(Object.values(categories), (d) => d.name)\n    .join('rect')\n    .attr('class', 'gene-upstream-border')\n    .attr('fill', 'none')\n    .attr(\n      'stroke',\n      (d, i) => DEFAULT_COLOR_MAP_LIGHT[i % DEFAULT_COLOR_MAP_LIGHT.length]\n    )\n    .attr('stroke-width', '1')\n    .attr('x', 0)\n    .attr('y', (d, i) => i * rowHeight + paddingTop)\n    .attr('width', genesUpstreamScale.bandwidth())\n    .attr('height', rowHeight);\n\n  // Draw distance bars\n  genesUpstreamG\n    // Same reason we're using a join here as for the text labels above\n    .selectAll('.gene-upstream-distance-bar')\n    .data((d) => [d])\n    .join('rect')\n    .attr('class', 'gene-upstream-distance-bar')\n    .attr('fill', '#bbbbbb')\n    .attr('x', genesUpstreamScale.bandwidth() / 2 - distanceBarWidth / 2)\n    .attr('y', Object.values(categories).length * rowHeight + paddingTop)\n    .attr('width', distanceBarWidth)\n    .attr('height', (d) => distanceHeightScale(d.absDistance));\n\n  // ---------------------------------------------------------------------------\n  // Draw downstream genes\n  svg\n    .select('#genes-downstream')\n    .attr('transform', `translate(${width / 2 + rowHeight / 2}, 0)`);\n\n  const genesDownstreamG = svg\n    .select('#genes-downstream')\n    .selectAll('.gene-downstream')\n    .data(genesDownstream, (d) => d.name)\n    .join('g')\n    .attr('class', 'gene-downstream')\n    .attr('transform', (d) => `translate(${genesDownstreamScale(d.name)}, 0)`);\n\n  // Draw labels\n  genesDownstreamG\n    .selectAll('.gene-downstream-label')\n    .data((d) => [d])\n    .join('text')\n    .attr('class', 'gene-label gene-downstream-label')\n    .attr('style', 'font-size: 9px;')\n    .attr('transform', `translate(${geneLabelX},${geneLabelY}) rotate(-90)`)\n    .attr('fill', 'black')\n    .attr('dominant-baseline', 'middle')\n    .text((d) => d.name);\n\n  // Draw cell\n  const genesDownstreamGCellG = genesDownstreamG\n    .selectAll('.gene-downstream-cell')\n    .data(\n      (d) =>\n        Object.values(d.samplesByCategory).map((item, i) => {\n          // Little hacky but necessary unfortunately\n          item.row = i;\n          return item;\n        }),\n      (d) => d.name\n    )\n    .join('g')\n    .attr('class', 'gene-downstream-cell')\n    .attr('transform', (d, i) => `translate(0, ${i * rowHeight + paddingTop})`);\n\n  if (geneCellEncoding !== prevGeneCellEncoding) {\n    genesDownstreamGCellG.selectAll('*').remove();\n  }\n\n  switch (geneCellEncoding) {\n    case 'distribution':\n      plotBeeswarm(genesDownstreamGCellG);\n      break;\n\n    case 'array':\n      plotArray(genesDownstreamGCellG, getArrayNumCols(genesDownstream), {\n        tooltipTitleGetter: arrayTooltipTitleGetter,\n        instanceCache: geneArrayInstances.downstream,\n        onMouseEnter: geneArrayInstanceMouseEnterHandler,\n        onMouseLeave: geneArrayInstanceMouseLeaveHandler,\n      });\n      break;\n\n    case 'number':\n    case 'percent':\n    default: {\n      const valueScale =\n        geneCellEncoding === 'percent' ? percentScale : categorySizeScale;\n\n      const valueGetter =\n        geneCellEncoding === 'percent'\n          ? (d) => d.length / d.size\n          : (d) => d.length;\n\n      plotBox(genesDownstreamGCellG, valueScale, valueGetter, {\n        showText: false,\n        cellWidth: genesDownstreamScale.bandwidth(),\n        fillColor: DEFAULT_COLOR_MAP,\n        showTooltip: true,\n        tooltipTitleGetter: boxTooltipTitleGetter,\n      });\n\n      break;\n    }\n  }\n\n  // Draw border\n  genesDownstreamG\n    .selectAll('.gene-downstream-border')\n    .data(Object.values(categories), (d) => d.name)\n    .join('rect')\n    .attr('class', 'gene-downstream-border')\n    .attr('fill', 'none')\n    .attr(\n      'stroke',\n      (d, i) => DEFAULT_COLOR_MAP_LIGHT[i % DEFAULT_COLOR_MAP_LIGHT.length]\n    )\n    .attr('stroke-width', '1')\n    .attr('x', 0)\n    .attr('y', (d, i) => i * rowHeight + paddingTop)\n    .attr('width', genesDownstreamScale.bandwidth())\n    .attr('height', rowHeight);\n\n  // Draw distance bars\n  genesDownstreamG\n    // Same reason we're using a join here as for the text labels above\n    .selectAll('.gene-downstream-distance-bar')\n    .data((d) => [d])\n    .join('rect')\n    .attr('class', 'gene-downstream-distance-bar')\n    .attr('fill', '#bbbbbb')\n    .attr('x', genesDownstreamScale.bandwidth() / 2 - distanceBarWidth / 2)\n    .attr('y', Object.values(categories).length * rowHeight + paddingTop)\n    .attr('width', distanceBarWidth)\n    .attr('height', (d) => distanceHeightScale(d.absDistance));\n\n  // ---------------------------------------------------------------------------\n  // Draw gene distance axis\n\n  const distRange = Math.ceil((maxVisibleAbsDist - minVisibleAbsDist) / 1e5);\n  const distStep = Math.ceil(distRange / 4);\n  const tickValues =\n    distRange <= 1\n      ? [minVisibleAbsDist, maxVisibleAbsDist]\n      : Array(4)\n          .fill()\n          .map(\n            (v, i) =>\n              Math.ceil(minVisibleAbsDist / 1e5) * 1e5 + i * (distStep * 1e5)\n          );\n\n  svg\n    .select('#gene-distance-axis')\n    .attr(\n      'transform',\n      `translate(0, ${\n        Object.values(categories).length * rowHeight + paddingTop\n      })`\n    )\n    .call(\n      axisRight(distanceHeightScale)\n        .tickSize(width)\n        .tickFormat(function geneDistanceAxisTickFormat(d) {\n          const s = (d / 1e6).toFixed(1);\n          return this.parentNode.nextSibling\n            ? s\n            : `${s} Mbp distance to enhancer`;\n        })\n        .tickValues(tickValues)\n    )\n    .call((g) => g.select('.domain').remove())\n    .call((g) =>\n      g\n        .selectAll('.tick line')\n        .attr('stroke', '#bbbbbb')\n        .attr('stroke-width', 0.5)\n        .attr('stroke-dasharray', '4,4')\n    )\n    .call((g) =>\n      g\n        .selectAll('.tick text')\n        .attr('fill', '#bbbbbb')\n        .attr('x', width / 2)\n        .attr('dy', 1)\n        .attr('text-anchor', 'middle')\n        .attr('dominant-baseline', 'hanging')\n    );\n};\n\nconst EnhancerGenesPlot = React.memo(function EnhancerGenesPlot() {\n  const chromInfo = useChromInfo();\n  const showTooltip = useShowTooltip();\n\n  const sampleSelection = useRecoilValue(sampleSelectionState);\n  const sampleGroupSelectionSizes = useRecoilValue(\n    sampleGroupSelectionSizesState\n  );\n  const geneCellEncoding = useRecoilValue(enhancerGenesCellEncodingState);\n  const absRange = useRecoilValue(focusRegionAbsWithAssembly(chromInfo));\n  const focusRegion = useRecoilValue(focusRegionState);\n  const relPosition = useRecoilValue(focusRegionRelState);\n  const strPosition = useRecoilValue(focusRegionStrState);\n  const genePadding = useRecoilValue(enhancerGenesPaddingState);\n\n  const [plotEl, setPlotEl] = useRecoilState(enhancerGenesSvgState);\n\n  const [tile, setTile] = useState(null);\n  const [isLoadingTile, setIsLoadingTile] = useState(null);\n  const [tilesetInfo, setTilesetInfo] = useState(null);\n  const [width, setWidth] = useState(null);\n  const prevWidth = usePrevious(width);\n  const prevGeneCellEncoding = usePrevious(geneCellEncoding);\n\n  useEffect(() => {\n    // Determine highest resolution tiles\n    let active = true;\n\n    if (absRange === null || tilesetInfo === null) return undefined;\n\n    const [absStart, absEnd] = absRange;\n    const regionLength = Math.abs(absEnd - absStart);\n\n    const minTileSize = getMinTileSize(tilesetInfo);\n\n    const k = 5;\n    const zoomOutLevel = Math.max(\n      0,\n      Math.ceil(Math.log2(regionLength / minTileSize / k))\n    );\n    const zoomLevel = tilesetInfo.max_zoom - zoomOutLevel;\n\n    const tileSize = minTileSize * 2 ** zoomOutLevel;\n\n    const tileXPosStart = Math.floor(absStart / tileSize);\n    const tileXPosEnd = Math.floor(absEnd / tileSize);\n\n    const tileIds = range(tileXPosStart, tileXPosEnd + 1).reduce(\n      (ids, xPos) => {\n        ids.push(`${uuid}.${zoomLevel}.${xPos}`);\n        return ids;\n      },\n      []\n    );\n\n    setIsLoadingTile(true);\n    fetchTiles(tileIds).then((tiles) => {\n      if (active) {\n        setIsLoadingTile(false);\n        setTile(filterIntervalsByRange(Object.values(tiles).flat(), absRange));\n      }\n    });\n\n    return () => {\n      active = false;\n    };\n  }, [absRange, tilesetInfo]);\n\n  const plotElRef = useCallback(\n    (node) => {\n      setPlotEl(node);\n    },\n    [setPlotEl]\n  );\n\n  // Derived State\n  const isInit = useMemo(() => !!tilesetInfo, [tilesetInfo]);\n\n  const data = useMemo(\n    () => {\n      if (!tile) return undefined;\n\n      let maxScore = 0;\n      let minAbsDistance = Infinity;\n      let maxAbsDistance = 0;\n      const genes = {};\n      const categoryAggregation = {};\n\n      Object.entries(categories).forEach(([name, category]) => {\n        categoryAggregation[name] = {\n          category,\n          numEnhancers: 0,\n        };\n      });\n\n      const distComparator = (a, b) => a.absDistance - b.absDistance;\n      const genesUpstreamByDist = new TinyQueue([], distComparator);\n      const genesDownstreamByDist = new TinyQueue([], distComparator);\n\n      tile.forEach((entry) => {\n        const sample = entry.fields[10];\n\n        // Exclude samples that have been deselected\n        if (!sampleSelection[SAMPLE_IDX[sample]]) return;\n\n        const geneName = entry.fields[6];\n\n        if (!genes[geneName]) {\n          const relGenePos = +entry.fields[4];\n          const distance = relGenePos - relPosition;\n          const isDownstream = distance > 0;\n          const absDistance = Math.abs(distance);\n          genes[geneName] = {\n            name: geneName,\n            position: relGenePos,\n            absDistance,\n            isDownstream,\n            samplesByCategory: {},\n          };\n\n          Object.values(categories).forEach(({ name, size }) => {\n            genes[geneName].samplesByCategory[name] = [];\n            genes[geneName].samplesByCategory[name].size =\n              sampleGroupSelectionSizes[name];\n          });\n\n          minAbsDistance = Math.min(minAbsDistance, absDistance);\n          maxAbsDistance = Math.max(maxAbsDistance, absDistance);\n\n          if (isDownstream) genesDownstreamByDist.push(genes[geneName]);\n          else genesUpstreamByDist.push(genes[geneName]);\n        }\n\n        genes[geneName].samplesByCategory[samples[sample].category.name].push({\n          gene: geneName,\n          sample,\n          sampleCategory: samples[sample].category.name,\n          value: entry.importance,\n        });\n        maxScore = Math.max(maxScore, entry.importance);\n        categoryAggregation[samples[sample].category.name].numEnhancers++;\n      });\n\n      const genesDownstreamByDistArr = [];\n      while (genesDownstreamByDist.length)\n        genesDownstreamByDistArr.push(genesDownstreamByDist.pop());\n\n      const genesUpstreamByDistArr = [];\n      while (genesUpstreamByDist.length)\n        genesUpstreamByDistArr.push(genesUpstreamByDist.pop());\n\n      genesDownstreamByDistArr.forEach((gene, i) => {\n        const prevGene = genesDownstreamByDistArr[i - 1];\n        gene.relDistance =\n          gene.position - ((prevGene && prevGene.position) || relPosition);\n      });\n\n      genesUpstreamByDistArr.forEach((gene, i) => {\n        const prevGene = genesDownstreamByDistArr[i - 1];\n        gene.relDistance =\n          ((prevGene && prevGene.position) || relPosition) - gene.position;\n      });\n\n      return {\n        minAbsDistance,\n        maxAbsDistance,\n        maxScore,\n        genes,\n        genesDownstreamByDist: genesDownstreamByDistArr,\n        genesUpstreamByDist: genesUpstreamByDistArr,\n        categoryAggregation,\n      };\n    },\n    // `relPosition` is excluded on purpose because `tile` is already updated\n    // when `relPosition` updates\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [tile, sampleGroupSelectionSizes, sampleSelection]\n  );\n\n  // Initialization\n  useEffect(\n    () => {\n      (async () => {\n        const response = await fetch(`${server}/tileset_info/?d=${uuid}`);\n        const results = await response.json();\n\n        if (results[uuid]) setTilesetInfo(results[uuid]);\n      })();\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n\n  // Rendering\n  const classes = useStyles();\n\n  useLayoutEffect(\n    () => {\n      if (!plotEl) return undefined;\n\n      const measure = () =>\n        window.requestAnimationFrame(() => {\n          const currWidth = plotEl.getBoundingClientRect().width;\n          if (currWidth !== prevWidth) setWidth(currWidth);\n        });\n\n      measure();\n\n      window.addEventListener('resize', measure);\n      window.addEventListener('orientationchange', measure);\n\n      return () => {\n        window.removeEventListener('resize', measure);\n        window.removeEventListener('orientationchange', measure);\n      };\n    },\n    // `prevWidth` is ommitted on purpose to avoid circular updates.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [plotEl]\n  );\n\n  const tooltipClasses = [];\n  for (let i = 0; i < useTooltipStyles.length; i++) {\n    tooltipClasses.push(useTooltipStyles[i]());\n  }\n\n  useEffect(\n    () => {\n      plotEnhancerGeneConnections(plotEl, width, data, {\n        geneCellEncoding,\n        prevGeneCellEncoding,\n        genePadding,\n        showTooltip,\n        classes,\n        tooltipClasses,\n        position: strPosition,\n        focusRegion,\n      });\n    },\n    // `prevGeneCellEncoding` is ommitted on purpose to avoid circular updates.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [plotEl, width, data, geneCellEncoding, genePadding, showTooltip]\n  );\n\n  return (\n    <Grid\n      className={classes.root}\n      container\n      justify=\"center\"\n      alignItems=\"center\"\n    >\n      {isInit && !isLoadingTile ? (\n        <Grid item className={classes.plot}>\n          <svg ref={plotElRef} className={classes.plotSvg}>\n            <g id=\"enhancers\"></g>\n            <g id=\"gene-distance-axis\"></g>\n            <g id=\"genes-upstream\"></g>\n            <g id=\"genes-downstream\"></g>\n          </svg>\n        </Grid>\n      ) : (\n        <CircularProgress color=\"inherit\" />\n      )}\n    </Grid>\n  );\n});\n\nexport default EnhancerGenesPlot;\n","import React from 'react';\nimport { useRecoilValue } from 'recoil';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport EnhancerGenesInfo from './EnhancerGenesInfo';\nimport EnhancerGenesHelp from './EnhancerGenesHelp';\nimport EnhancerGenesSettings from './EnhancerGenesSettings';\nimport EnhancerGenesPlot from './EnhancerGenesPlot';\nimport TitleBar from './TitleBar';\n\nimport { focusRegionState, useEnhancerGenesShowInfos } from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  plot: {\n    minHeight: '6rem',\n  },\n}));\n\nconst EnhancerGenes = React.memo(function EnhancerGenes() {\n  const focusRegion = useRecoilValue(focusRegionState);\n\n  const classes = useStyles();\n\n  return (\n    <div>\n      <TitleBar\n        id=\"enhancer-gene\"\n        title=\"Enhancer-Gene Connections\"\n        popoverDirection=\"top\"\n        useShowInfo={useEnhancerGenesShowInfos}\n        Info={EnhancerGenesInfo}\n        Help={EnhancerGenesHelp}\n        Settings={EnhancerGenesSettings}\n      />\n      <div className={classes.plot}>{focusRegion && <EnhancerGenesPlot />}</div>\n    </div>\n  );\n});\n\nexport default EnhancerGenes;\n","import React from 'react';\nimport { useRecoilValue } from 'recoil';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport { useChromInfo } from './ChromInfoProvider';\n\nimport {\n  dnaAccessLabelShowInfoState,\n  dnaAccessXDomainWithAssembly,\n} from './state';\n\nimport { toFixed } from './utils';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n    justifyContent: 'space-between',\n  },\n  text: {\n    fontSize: '0.8rem',\n  },\n}));\n\nconst DnaAccessibilityInfo = React.memo(function DnaAccessibilityInfo() {\n  const chromInfo = useChromInfo();\n\n  const showInfo = useRecoilValue(dnaAccessLabelShowInfoState);\n  const xDomainAbs = useRecoilValue(dnaAccessXDomainWithAssembly(chromInfo));\n\n  const classes = useStyles();\n\n  const dnaAccessibilityRegionSize = Math.round(\n    (xDomainAbs[1] - xDomainAbs[0]) / 1000\n  );\n\n  if (!showInfo) return '';\n\n  return (\n    <div className={classes.root}>\n      <span></span>\n      <Typography align=\"center\" className={classes.text} noWrap>\n        {toFixed(dnaAccessibilityRegionSize, 1)}{' '}\n        <abbr title=\"kilo base pairs\">Kbp</abbr>\n      </Typography>\n      <span></span>\n    </div>\n  );\n});\n\nexport default DnaAccessibilityInfo;\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\n\nconst DnaAccessibilityHelp = React.memo(function DnaAccessibilityHelp() {\n  return (\n    <Typography>\n      This panel visualizes the DNA accessibility of all 131 samples. Each track\n      is individually normalized. Mouse over a track to see the underlying\n      value. To focus on a specific locus specify a focus variant.\n    </Typography>\n  );\n});\n\nexport default DnaAccessibilityHelp;\n","import React from 'react';\nimport Box from '@material-ui/core/Box';\nimport IconButton from '@material-ui/core/IconButton';\nimport RadioButtonCheckedIcon from '@material-ui/icons/RadioButtonChecked';\nimport RadioButtonUncheckedIcon from '@material-ui/icons/RadioButtonUnchecked';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport RadioGroup from '@material-ui/core/RadioGroup';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport AntSwitch from './AntSwitch';\n\nimport { useDnaAccessLabelStyle, useDnaAccessRowNorm } from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  iconRadioLegend: {\n    margin: theme.spacing(2, 0, 0.25, 0),\n  },\n  switch: {\n    margin: 0,\n  },\n}));\n\nconst DnaAccessibilitySettings = React.memo(\n  function DnaAccessibilitySettings() {\n    const [\n      dnaAccessLabelStyle,\n      setDnaAccessLabelStyle,\n    ] = useDnaAccessLabelStyle();\n    const [dnaAccessRowNorm, setDnaAccessRowNorm] = useDnaAccessRowNorm();\n\n    const changeDnaAccessLabelStyle = (value) => () => {\n      setDnaAccessLabelStyle(value);\n    };\n\n    const changeDnaAccessRowNorm = (event) => {\n      setDnaAccessRowNorm(event.target.checked);\n    };\n\n    // On every render\n    const classes = useStyles();\n\n    return (\n      <React.Fragment>\n        <Box m={1}>\n          <FormControlLabel\n            className={classes.switch}\n            control={\n              <AntSwitch\n                checked={dnaAccessRowNorm}\n                onChange={changeDnaAccessRowNorm}\n                name=\"true\"\n              />\n            }\n            label=\"Row-wise normalization\"\n          />\n        </Box>\n        <Box m={1}>\n          <FormControl component=\"fieldset\">\n            <FormLabel component=\"legend\" className={classes.iconRadioLegend}>\n              Labels\n            </FormLabel>\n            <RadioGroup\n              aria-label=\"dnaAccessLabelStyle\"\n              name=\"dnaAccessLabelStyle\"\n              value={dnaAccessLabelStyle}\n            >\n              <FormControlLabel\n                label=\"Indicator\"\n                value=\"indicator\"\n                className={classes.iconRadio}\n                control={\n                  <IconButton\n                    size=\"small\"\n                    onClick={changeDnaAccessLabelStyle('indicator')}\n                  >\n                    {dnaAccessLabelStyle === 'indicator' ? (\n                      <RadioButtonCheckedIcon\n                        className={classes.iconRadioActive}\n                        fontSize=\"inherit\"\n                      />\n                    ) : (\n                      <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                    )}\n                  </IconButton>\n                }\n              />\n              <FormControlLabel\n                label=\"Text\"\n                value=\"text\"\n                className={classes.iconRadio}\n                control={\n                  <IconButton\n                    size=\"small\"\n                    onClick={changeDnaAccessLabelStyle('text')}\n                  >\n                    {dnaAccessLabelStyle === 'text' ? (\n                      <RadioButtonCheckedIcon\n                        className={classes.iconRadioActive}\n                        fontSize=\"inherit\"\n                      />\n                    ) : (\n                      <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                    )}\n                  </IconButton>\n                }\n              />\n              <FormControlLabel\n                label=\"Hidden\"\n                value=\"hidden\"\n                className={classes.iconRadio}\n                control={\n                  <IconButton\n                    size=\"small\"\n                    onClick={changeDnaAccessLabelStyle('hidden')}\n                  >\n                    {dnaAccessLabelStyle === 'hidden' ? (\n                      <RadioButtonCheckedIcon\n                        className={classes.iconRadioActive}\n                        fontSize=\"inherit\"\n                      />\n                    ) : (\n                      <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                    )}\n                  </IconButton>\n                }\n              />\n            </RadioGroup>\n          </FormControl>\n        </Box>\n      </React.Fragment>\n    );\n  }\n);\n\nexport default DnaAccessibilitySettings;\n","import React, { useCallback, useEffect, useMemo, useRef } from 'react';\nimport { useRecoilValue, useSetRecoilState } from 'recoil';\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { deepClone, pipe } from '@flekschas/utils';\nimport { HiGlassComponent } from 'higlass';\n\nimport { useChromInfo } from './ChromInfoProvider';\nimport DnaAccessibilityInfo from './DnaAccessibilityInfo';\nimport DnaAccessibilityHelp from './DnaAccessibilityHelp';\nimport DnaAccessibilitySettings from './DnaAccessibilitySettings';\n\nimport TitleBar from './TitleBar';\n\nimport {\n  dnaAccessLabelStyleState,\n  dnaAccessRowNormState,\n  dnaAccessXDomainWithAssembly,\n  focusRegionAbsWithAssembly,\n  higlassDnaAccessState,\n  sampleSelectionState,\n  useDnaAccessShowInfos,\n  variantTracksState,\n  variantYScaleState,\n} from './state';\n\nimport {\n  DEFAULT_DNA_ACCESSIBILITY_ROW_SELECTION,\n  DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY,\n} from './constants';\nimport useDebounce from './use-debounce';\n\nimport {\n  updateViewConfigFocusRegion,\n  updateViewConfigVariantYScale,\n  updateViewConfigXDomain,\n  updateViewConfigVariantTracks,\n} from './view-config';\n\nimport 'higlass/dist/hglib.css';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n  },\n  grow: {\n    flexGrow: 1,\n  },\n}));\n\nconst updateViewConfigDnaAccessLabels = (labels) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[3].options.showRowLabels =\n    !labels || labels === 'hidden' ? false : labels;\n  return viewConfig;\n};\n\nconst updateViewConfigDnaAccessRowNorm = (rowNorm) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[3].options.rowNormalization = rowNorm;\n  return viewConfig;\n};\n\nconst updateViewConfigRowSelection = (selection) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[3].options.rowSelections = DEFAULT_DNA_ACCESSIBILITY_ROW_SELECTION.filter(\n    (rowId, i) => selection[i]\n  );\n  return viewConfig;\n};\n\nconst DnaAccessibility = React.memo(function DnaAccessibility() {\n  const chromInfo = useChromInfo();\n\n  const setHiglassDnaAccess = useSetRecoilState(higlassDnaAccessState);\n\n  const sampleSelection = useRecoilValue(sampleSelectionState);\n  const labelStyle = useRecoilValue(dnaAccessLabelStyleState);\n  const rowNorm = useRecoilValue(dnaAccessRowNormState);\n  const variantYScale = useRecoilValue(variantYScaleState);\n  const variantTracks = useRecoilValue(variantTracksState);\n  const focusRegionAbs = useRecoilValue(focusRegionAbsWithAssembly(chromInfo));\n\n  const higlassApi = useRef(null);\n\n  const xDomainAbsDb = useDebounce(\n    useRecoilValue(dnaAccessXDomainWithAssembly(chromInfo)),\n    500\n  );\n\n  const higlassInitHandler = useCallback(\n    (higlassInstance) => {\n      if (higlassInstance !== null) {\n        setHiglassDnaAccess(higlassInstance.api);\n        higlassApi.current = higlassInstance.api;\n      }\n    },\n    [setHiglassDnaAccess]\n  );\n\n  const viewConfig = useMemo(\n    () =>\n      pipe(\n        updateViewConfigVariantTracks(variantTracks),\n        updateViewConfigFocusRegion(focusRegionAbs, [2]),\n        updateViewConfigVariantYScale(variantYScale),\n        updateViewConfigDnaAccessLabels(labelStyle),\n        updateViewConfigDnaAccessRowNorm(rowNorm),\n        updateViewConfigXDomain(...xDomainAbsDb, { force: true }),\n        updateViewConfigRowSelection(sampleSelection)\n      )(deepClone(DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY)),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [\n      // `xDomainStartAbs` and `xDomainEndAbs` are ommitted on purpose to avoid\n      // updating the view-config on every pan or zoom event.\n      variantTracks,\n      focusRegionAbs,\n      xDomainAbsDb,\n      variantYScale,\n      labelStyle,\n      sampleSelection,\n      rowNorm,\n    ]\n  );\n\n  // Unmount\n  useEffect(\n    () => () => {\n      if (higlassApi.current) {\n        higlassApi.current.destroy();\n      }\n    },\n    // Execute only once on initialization\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n\n  // On every render\n  const classes = useStyles();\n\n  return (\n    <Grid container direction=\"column\" className={classes.root}>\n      <TitleBar\n        id=\"dna-accessibility\"\n        title=\"DNA Accessibility\"\n        useShowInfo={useDnaAccessShowInfos}\n        Info={DnaAccessibilityInfo}\n        Help={DnaAccessibilityHelp}\n        Settings={DnaAccessibilitySettings}\n      />\n      <Grid item container direction=\"column\" className={classes.grow}>\n        <HiGlassComponent\n          ref={higlassInitHandler}\n          viewConfig={viewConfig}\n          options={{\n            sizeMode: 'scroll',\n            pixelPreciseMarginPadding: true,\n            containerPaddingX: 0,\n            containerPaddingY: 0,\n            viewMarginTop: 0,\n            viewMarginBottom: 0,\n            viewMarginLeft: 0,\n            viewMarginRight: 0,\n            viewPaddingTop: 0,\n            viewPaddingBottom: 0,\n            viewPaddingLeft: 0,\n            viewPaddingRight: 16,\n            globalMousePosition: true,\n          }}\n        />\n      </Grid>\n    </Grid>\n  );\n});\n\nexport default DnaAccessibility;\n","import React, { useEffect } from 'react';\nimport { useRecoilState } from 'recoil';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { isString } from '@flekschas/utils';\n\nimport AppSidebar from './AppSidebar';\nimport AppTopbar from './AppTopbar';\nimport EnhancerRegions from './EnhancerRegions';\nimport EnhancerGenes from './EnhancerGenes';\nimport DnaAccessibility from './DnaAccessibility';\nimport ModalProvider from './ModalProvider';\nimport TooltipProvider from './TooltipProvider';\n\nimport { useChromInfo } from './ChromInfoProvider';\n\nimport {\n  focusGeneOptionState,\n  focusRegionOptionState,\n  useFocusGene,\n  useFocusRegion,\n  useVariantTracksSyncher,\n  useShowWelcomeSyncher,\n  useFocusGeneSyncher,\n  useFocusRegionSyncher,\n  useDnaAccessLabelStyleSyncher,\n  useDnaAccessRowNormSyncher,\n  useDnaAccessShowInfosSyncher,\n  useXDomainStartWithAssemblySyncher,\n  useXDomainEndWithAssemblySyncher,\n  useEnhancerRegionsShowInfosSyncher,\n  useEnhancerRegionsHideUnfocusedSyncher,\n  useEnhancerRegionsColorEncodingSyncher,\n  useEnhancerGenesShowInfosSyncher,\n  useEnhancerGenesPaddingSyncher,\n  useEnhancerGenesCellEncodingSyncher,\n  useVariantYScaleSyncher,\n} from './state';\n\nimport { GENE_SEARCH_URL, VARIANT_SEARCH_URL } from './constants';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    position: 'absolute',\n    display: 'flex',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n  },\n  toolbar: theme.mixins.toolbar,\n  content: {\n    flexGrow: 1,\n    padding: theme.spacing(1),\n    backgroundColor: 'white',\n  },\n  grow: {\n    flexGrow: 1,\n  },\n  separator: {\n    zIndex: 1,\n    margin: `-${theme.spacing(1)}px 0`,\n    width: 1,\n    background: theme.palette.grey['300'],\n  },\n  enhancerWrapper: {\n    position: 'relative',\n    flexGrow: 1,\n    margin: '-8px 0 -8px -8px',\n  },\n  enhancer: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    overflowY: 'auto',\n    '&> div': {\n      minHeight: '100%',\n    },\n  },\n  enhancerRegions: {\n    position: 'relative',\n    flexGrow: 1,\n  },\n  enhancerGenes: {\n    position: 'relative',\n  },\n  dnaAccessibility: {\n    position: 'relative',\n    width: '20rem',\n    margin: '-8px -8px -8px 0',\n  },\n}));\n\nconst AppMain = React.memo(function AppMain() {\n  const chromInfo = useChromInfo();\n\n  // Initialize query strings\n  useVariantTracksSyncher();\n  useShowWelcomeSyncher();\n  useFocusGeneSyncher();\n  useFocusRegionSyncher();\n  useDnaAccessLabelStyleSyncher();\n  useDnaAccessRowNormSyncher();\n  useDnaAccessShowInfosSyncher();\n  useEnhancerRegionsShowInfosSyncher();\n  useEnhancerRegionsHideUnfocusedSyncher();\n  useEnhancerRegionsColorEncodingSyncher();\n  useEnhancerGenesShowInfosSyncher();\n  useEnhancerGenesPaddingSyncher();\n  useEnhancerGenesCellEncodingSyncher();\n  useVariantYScaleSyncher();\n  useXDomainStartWithAssemblySyncher(chromInfo);\n  useXDomainEndWithAssemblySyncher(chromInfo);\n\n  const [focusGene, setFocusGene] = useFocusGene();\n  const [focusRegion, setFocusRegion] = useFocusRegion();\n\n  const [focusGeneOption, setFocusGeneOption] = useRecoilState(\n    focusGeneOptionState\n  );\n  const [focusRegionOption, setFocusRegionOption] = useRecoilState(\n    focusRegionOptionState\n  );\n\n  const clearFocusGene = () => {\n    setFocusGene('');\n    setFocusGeneOption(null);\n  };\n\n  const focusGeneChangeHandler = (newValue) => {\n    if (newValue) {\n      setFocusGene(newValue.geneName);\n      setFocusGeneOption(newValue);\n    } else {\n      clearFocusGene();\n    }\n  };\n\n  const clearFocusRegion = () => {\n    setFocusRegion('');\n    setFocusRegionOption(null);\n  };\n\n  const focusRegionChangeHandler = (newValue) => {\n    if (newValue) {\n      setFocusRegion(newValue.geneName);\n      setFocusRegionOption(newValue);\n    } else {\n      clearFocusRegion();\n    }\n  };\n\n  const classes = useStyles();\n\n  // Initialize focus gene/variant options\n  useEffect(\n    () => {\n      (async () => {\n        if (focusGene && !focusGeneOption) {\n          const r = await fetch(`${GENE_SEARCH_URL}&ac=${focusGene}`);\n          const results = await r.json();\n          const result = results[0];\n          if (result) {\n            result.type = 'gene';\n            focusGeneChangeHandler(results[0]);\n          }\n        }\n        if (focusRegion && isString(focusRegion) && !focusRegionOption) {\n          const r = await fetch(`${VARIANT_SEARCH_URL}&ac=${focusRegion}`);\n          const results = await r.json();\n          const result = results[0];\n          if (result) {\n            result.type = 'variant';\n            focusRegionChangeHandler(results[0]);\n          }\n        }\n      })();\n    },\n    // Execute only once on initialization\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n\n  return (\n    <div className={classes.root}>\n      <ModalProvider>\n        <CssBaseline />\n        <AppTopbar />\n        <AppSidebar />\n        <TooltipProvider>\n          <Grid\n            container\n            direction=\"column\"\n            className={classes.content}\n            wrap=\"nowrap\"\n          >\n            <div className={classes.toolbar} />\n            <Grid container className={classes.grow} wrap=\"nowrap\">\n              <div className={classes.enhancerWrapper}>\n                <div className={classes.enhancer}>\n                  <Grid container direction=\"column\">\n                    <Grid item className={classes.enhancerRegions}>\n                      <EnhancerRegions />\n                    </Grid>\n                    <Grid item className={classes.enhancerGenes}>\n                      <EnhancerGenes />\n                    </Grid>\n                  </Grid>\n                </div>\n              </div>\n              <div className={classes.separator} />\n              <div className={classes.dnaAccessibility}>\n                <DnaAccessibility />\n              </div>\n            </Grid>\n          </Grid>\n        </TooltipProvider>\n      </ModalProvider>\n    </div>\n  );\n});\n\nexport default AppMain;\n","import React from 'react';\n\nconst withEither = (ifEitherFn, EitherComponent) => (Component) => (props) =>\n  ifEitherFn(props) ? <EitherComponent {...props} /> : <Component {...props} />;\n\nexport default withEither;\n","import React, { useState, useEffect } from 'react';\nimport { RecoilRoot } from 'recoil';\nimport { ChromosomeInfo } from 'higlass';\nimport { pipe } from '@flekschas/utils';\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\n\nimport AppInitializing from './AppInitializing';\nimport AppError from './AppError';\nimport ChromInfoProvider from './ChromInfoProvider';\nimport AppMain from './AppMain';\nimport withEither from './with-either';\n\nimport './App.css';\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: '#000',\n    },\n    secondary: {\n      main: '#000',\n    },\n  },\n});\n\nconst App = () => {\n  const [chromInfo, setChromInfo] = useState(null);\n\n  useEffect(() => {\n    ChromosomeInfo('https://s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv')\n      .then((_chromInfo) => {\n        if (_chromInfo.totalLength === undefined) {\n          // Monkey patch: chrom sizes were actually unavailable...\n          // Also see https://github.com/higlass/higlass/issues/957\n          setChromInfo(false);\n        } else {\n          setChromInfo(_chromInfo);\n        }\n      })\n      .catch(() => {\n        setChromInfo(false);\n      });\n  }, []);\n\n  const Main = pipe(\n    withEither(() => chromInfo === null, AppInitializing),\n    withEither(() => chromInfo === false, AppError)\n  )(AppMain);\n\n  return (\n    <div className=\"App\">\n      <RecoilRoot>\n        <ThemeProvider theme={theme}>\n          <ChromInfoProvider chromInfo={chromInfo}>\n            <Main />\n          </ChromInfoProvider>\n        </ThemeProvider>\n      </RecoilRoot>\n    </div>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","function createAnnotationOverlayMetaTrack(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  // Services\n  const { pubSub } = HGC.services;\n\n  class AnnotationOverlayMetaTrack {\n    constructor(context, options) {\n      const { definition, getTrackObject, onNewTilesLoaded: animate } = context;\n\n      this.animate = animate;\n      this.options = options;\n\n      this.overlaysTrack = getTrackObject(definition.overlaysTrack);\n\n      if (!this.overlaysTrack) {\n        console.warn(\n          `Overlays track (uid: ${definition.overlaysTrack}) not found`\n        );\n        return;\n      }\n\n      this.annotationTrackIds = new Set();\n      this.annotationTracks = definition.options.annotationTracks\n        .map((uid) => {\n          const track = getTrackObject(uid);\n\n          if (!track) {\n            console.warn(`Child track (uid: ${uid}) not found`);\n          } else {\n            this.annotationTrackIds.add(track.uuid);\n          }\n\n          return track;\n        })\n        .filter((track) => track);\n\n      this.tilesDrawnEndHandlerBound = this.tilesDrawnEndHandler.bind(this);\n\n      this.drawnAnnotations = new Map();\n      this.tracksDrawingTiles = new Set();\n\n      this.pubSubs = [];\n\n      // Augment annotation tracks\n      this.annotationTracks.forEach((track) => {\n        track.subscribe('tilesDrawn', this.tilesDrawnEndHandlerBound);\n      });\n    }\n\n    /**\n     * Remove this track.\n     */\n    remove() {\n      this.pubSubs.forEach(pubSub.unsubscribe);\n      this.pubSubs = undefined;\n      this.annotationTracks.forEach((track) => {\n        track.unsubscribe('tileDrawn', this.annotationsDrawnHandlerBound);\n      });\n    }\n\n    tilesDrawnEndHandler({ uuid, annotations = [] }) {\n      if (!this.annotationTrackIds.has(uuid)) return;\n\n      this.tracksDrawingTiles.add(uuid);\n\n      annotations.forEach(({ xStartAbs, xEndAbs, data }) => {\n        this.drawnAnnotations.set(data.uid, [xStartAbs, xEndAbs]);\n      });\n\n      if (!(this.tracksDrawingTiles.size % this.annotationTracks.length)) {\n        this.updateOverlays();\n      }\n    }\n\n    updateOverlays() {\n      this.overlaysTrack.options.extent = Array.from(\n        this.drawnAnnotations.values()\n      );\n      this.overlaysTrack.draw();\n      this.tracksDrawingTiles.clear();\n      this.drawnAnnotations.clear();\n    }\n  }\n\n  return new AnnotationOverlayMetaTrack(...args);\n}\n\ncreateAnnotationOverlayMetaTrack.config = {\n  type: 'annotation-overlay',\n  availableOptions: ['annotationTracks'],\n  defaultOptions: {\n    annotationTracks: [],\n  },\n};\n\nexport default createAnnotationOverlayMetaTrack;\n","import {\n  identity,\n  maxNan,\n  maxVector,\n  meanNan,\n  minNan,\n  sumNan,\n} from '@flekschas/utils';\nimport { line } from 'd3';\n\nimport {\n  DEFAULT_COLOR_MAP,\n  DEFAULT_COLOR_MAP_LIGHT,\n  DEFAULT_COLOR_MAP_DARK,\n} from './constants';\n\nconst FLOAT_BYTES = Float32Array.BYTES_PER_ELEMENT;\n\nconst VS = `precision mediump float;\n\n  attribute vec2 aPrevPosition;\n  attribute vec2 aCurrPosition;\n  attribute vec2 aNextPosition;\n  attribute float aOffsetSign;\n  attribute float aColorIndex;\n\n  uniform sampler2D uAreaColorTex;\n  uniform float uAreaColorTexRes;\n  uniform mat3 projectionMatrix;\n  uniform mat3 translationMatrix;\n\n  uniform vec4 uLineColor;\n  uniform vec4 uNaNColor;\n  uniform float uWidth;\n  uniform int uMiter;\n\n  varying vec4 vColor;\n\n  void main(void)\n  {\n    mat3 model = projectionMatrix * translationMatrix;\n\n    if (aColorIndex <= -0.5) {\n      // Render line\n      vColor = vec4(uLineColor.rgb, 1.0);\n\n      vec4 prevGlPos = vec4((model * vec3(aPrevPosition, 1.0)).xy, 0.0, 1.0);\n      vec4 currGlPos = vec4((model * vec3(aCurrPosition, 1.0)).xy, 0.0, 1.0);\n      vec4 nextGlPos = vec4((model * vec3(aNextPosition, 1.0)).xy, 0.0, 1.0);\n\n      // Calculate the direction\n      vec2 dir = vec2(0.0);\n\n      if (currGlPos == prevGlPos) {\n        // start point uses (next - current)\n        dir = normalize(nextGlPos.xy - currGlPos.xy);\n      }\n      else if (currGlPos == nextGlPos) {\n        // end point uses (current - previous)\n        dir = normalize(currGlPos.xy - prevGlPos.xy);\n      }\n      else {\n        // somewhere in middle, needs a join:\n        // get directions from (C - B) and (B - A)\n        vec2 dirA = normalize((currGlPos.xy - prevGlPos.xy));\n        if (uMiter == 1) {\n          vec2 dirB = normalize((nextGlPos.xy - currGlPos.xy));\n          // now compute the miter join normal and length\n          vec2 tangent = normalize(dirA + dirB);\n          vec2 perp = vec2(-dirA.y, dirA.x);\n          vec2 miter = vec2(-tangent.y, tangent.x);\n          dir = tangent;\n        } else {\n          dir = dirA;\n        }\n      }\n\n      float width = (projectionMatrix * vec3(uWidth, 0.0, 0.0)).x / 2.0;\n\n      vec2 normal = vec2(-dir.y, dir.x) * width;\n      // normal.x /= aspectRatio;\n      vec4 offset = vec4(normal * aOffsetSign, 0.0, 0.0);\n      gl_Position = currGlPos + offset;\n    } else {\n      // Render area\n      float colorRowIndex = aColorIndex / uAreaColorTexRes;\n\n      vec2 colorTexIndex = vec2(\n        (aColorIndex / uAreaColorTexRes) - colorRowIndex,\n        colorRowIndex / uAreaColorTexRes\n      );\n      vColor = texture2D(uAreaColorTex, colorTexIndex);\n\n      gl_Position = vec4((model * vec3(aCurrPosition, 1.0)).xy, 0.0, 1.0);\n    }\n  }\n`;\n\nconst FS = `precision mediump float;\n\n  varying vec4 vColor;\n\n  void main() {\n    gl_FragColor = vColor;\n  }\n`;\n\nconst TILE_SIZE = 256;\n\nconst COLORMAP_GRAYS = Array(127)\n  .fill()\n  .map((x, i) => {\n    const gray = (1 - i / 127) * 0.5 + 0.5;\n    return [gray, gray, gray, 1];\n  });\n\nconst getMax = (fetchedTiles) =>\n  Object.values(fetchedTiles).reduce(\n    (maxValue, tile) => Math.max(maxValue, tile.tileData.maxNonZero),\n    -Infinity\n  );\n\nconst getNumRows = (fetchedTiles) =>\n  Object.values(fetchedTiles)[0].tileData.coarseShape[0];\n\nconst getRowMaxs = (fetchedTiles) =>\n  maxVector(\n    Object.values(fetchedTiles).map((tile) => tile.tileData.maxValueByRow)\n  );\n\nconst scaleGraphics = (graphics, xScale, drawnAtScale) => {\n  const tileK =\n    (drawnAtScale.domain()[1] - drawnAtScale.domain()[0]) /\n    (xScale.domain()[1] - xScale.domain()[0]);\n  const newRange = xScale.domain().map(drawnAtScale);\n\n  const posOffset = newRange[0];\n  graphics.scale.x = tileK;\n  graphics.position.x = -posOffset * tileK;\n};\n\nconst getNumPointsPerRow = (numRows, positions, markArea) =>\n  positions.length / numRows / 4 / (1 + markArea) - 2;\n\nconst createRidgePlotTrack = function createRidgePlotTrack(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  const { PIXI } = HGC.libraries;\n  const { format } = HGC.libraries.d3Format;\n  const { scaleLinear } = HGC.libraries.d3Scale;\n  const { tileProxy } = HGC.services;\n\n  const createColorTexture = (colors) => {\n    const colorTexRes = Math.max(2, Math.ceil(Math.sqrt(colors.length)));\n    const rgba = new Float32Array(colorTexRes ** 2 * 4);\n    colors.forEach((color, i) => {\n      // eslint-disable-next-line prefer-destructuring\n      rgba[i * 4] = color[0]; // r\n      // eslint-disable-next-line prefer-destructuring\n      rgba[i * 4 + 1] = color[1]; // g\n      // eslint-disable-next-line prefer-destructuring\n      rgba[i * 4 + 2] = color[2]; // b\n      // eslint-disable-next-line prefer-destructuring\n      rgba[i * 4 + 3] = color[3]; // a\n    });\n\n    return [\n      PIXI.Texture.fromBuffer(rgba, colorTexRes, colorTexRes),\n      colorTexRes,\n    ];\n  };\n\n  class RidgePlotTrack extends HGC.tracks.HorizontalLine1DPixiTrack {\n    constructor(context, options) {\n      super(context, options);\n      this.updateOptions();\n\n      this.pLoading = new PIXI.Graphics();\n      this.pLoading.position.x = 0;\n      this.pLoading.position.y = 0;\n      this.pMasked.addChild(this.pLoading);\n\n      this.loadIndicator = new PIXI.Text('Loading data...', {\n        fontSize: this.labelSize || 10,\n        fill: 0x808080,\n      });\n      this.pLoading.addChild(this.loadIndicator);\n    }\n\n    initTile(tile) {\n      this.coarsifyTileValues(tile);\n    }\n\n    destroyTile() {}\n\n    binsPerTile() {\n      return this.tilesetInfo.bins_per_dimension || TILE_SIZE;\n    }\n\n    /**\n     * From HeatmapTiledPixiTrack\n     */\n    getTilePosAndDimensions(zoomLevel, tilePos, binsPerTileIn) {\n      const binsPerTile = binsPerTileIn || this.binsPerTile();\n\n      if (this.tilesetInfo.resolutions) {\n        const sortedResolutions = this.tilesetInfo.resolutions\n          .map((x) => +x)\n          .sort((a, b) => b - a);\n\n        const chosenResolution = sortedResolutions[zoomLevel];\n\n        const tileWidth = chosenResolution * binsPerTile;\n        const tileHeight = tileWidth;\n\n        const tileX = chosenResolution * binsPerTile * tilePos[0];\n        const tileY = chosenResolution * binsPerTile * tilePos[1];\n\n        return {\n          tileX,\n          tileY,\n          tileWidth,\n          tileHeight,\n        };\n      }\n\n      const xTilePos = tilePos[0];\n      const yTilePos = tilePos[1];\n\n      const minX = this.tilesetInfo.min_pos[0];\n      const minY = this.options.reverseYAxis\n        ? -this.tilesetInfo.max_pos[1]\n        : this.tilesetInfo.min_pos[1];\n\n      const tileWidth = this.tilesetInfo.max_width / 2 ** zoomLevel;\n      const tileHeight = this.tilesetInfo.max_width / 2 ** zoomLevel;\n\n      const tileX = minX + xTilePos * tileWidth;\n      const tileY = minY + yTilePos * tileHeight;\n\n      return {\n        tileX,\n        tileY,\n        tileWidth,\n        tileHeight,\n      };\n    }\n\n    updateOptions() {\n      this.selectRowsAggregationMode =\n        this.options.selectRowsAggregationMode || 'mean';\n\n      switch (this.selectRowsAggregationMode) {\n        case 'max':\n          this.selectRowsAggregationFn = maxNan;\n          break;\n\n        case 'min':\n          this.selectRowsAggregationFn = minNan;\n          break;\n\n        case 'sum':\n          this.selectRowsAggregationFn = sumNan;\n          break;\n\n        case 'mean':\n        default:\n          this.selectRowsAggregationFn = meanNan;\n          break;\n      }\n\n      this.markArea = !!this.options.markArea;\n\n      this.markAreaColor = 'grays';\n\n      this.markColor = HGC.utils.colorToHex(this.options.markColor || 'black');\n\n      this.markColorRgbNorm = this.options.markColor\n        ? HGC.utils\n            .colorToRgba(this.options.markColor)\n            .slice(0, 3)\n            .map((x) => Math.min(1, Math.max(0, x / 255)))\n        : [0, 0, 0];\n\n      [this.markColorTex, this.markColorTexRes] = createColorTexture([\n        ...COLORMAP_GRAYS,\n      ]);\n\n      this.markNumColors = COLORMAP_GRAYS.length;\n\n      this.markOpacity = Number.isNaN(+this.options.markOpacity)\n        ? 1\n        : Math.min(1, Math.max(0, +this.options.markOpacity));\n\n      this.markSize = this.options.markSize || 2;\n\n      // Number of line segments\n      const oldMarkResolution = this.markResolution;\n      this.markResolution = Math.max(\n        1,\n        Math.min(TILE_SIZE, this.options.markResolution || TILE_SIZE / 4)\n      );\n      // Given 100 (rows) x 256 (tile size). At a resolution of 1 we need:\n      // 100 x (256 / 4) x 4 = 25,600 vertices\n\n      const oldRowHeight = this.rowHeight;\n      this.rowHeight = Number.isNaN(+this.options.rowHeight)\n        ? 'auto'\n        : +this.options.rowHeight;\n\n      const oldRowPadding = this.rowPadding;\n      this.rowPadding =\n        this.rowHeight === 'auto' ? 0 : this.options.rowPadding || 0;\n\n      const oldRowNormalization = this.rowNormalization;\n      this.rowNormalization = this.options.rowNormalization || false;\n\n      const oldRowSelections = this.rowSelections;\n      this.rowSelections =\n        this.options.rowSelections || this.rowSelections || [];\n\n      const oldShowRowLabels = this.showRowLabels;\n      this.showRowLabels = this.options.showRowLabels;\n\n      if (\n        oldMarkResolution !== this.markResolution ||\n        oldRowSelections !== this.rowSelections\n      ) {\n        this.updateTiles();\n        this.updateRowLabels();\n        this.drawLabel();\n      }\n\n      if (\n        oldRowHeight !== this.rowHeight ||\n        oldRowPadding !== this.rowPadding ||\n        oldRowNormalization !== this.rowNormalization\n      ) {\n        this.updateScales();\n      }\n\n      if (oldShowRowLabels !== this.showRowLabels) {\n        this.updateRowLabels();\n        this.drawLabel();\n      }\n\n      this.rowLabelAlign = this.options.rowLabelAlign || 'left';\n      this.rowLabelSize = this.options.rowLabelSize || 12;\n\n      this.rowCategories = this.options.rowCategories || {};\n      this.rowIdToCategory = (id) => id.substring(0, id.length - 14);\n      this.rowIdToCategory = this.options.rowIdToCategory\n        ? (id) =>\n            id[this.options.rowIdToCategory.fn](\n              ...this.options.rowIdToCategory.args\n            )\n        : identity;\n    }\n\n    removeRowLabels() {\n      while (this.pAxis.children.length) {\n        this.pAxis.removeChildAt(0);\n      }\n      if (this.rowLabels) {\n        this.rowLabels.forEach((rowLabel) => {\n          rowLabel.destroy();\n        });\n        this.rowLabels = undefined;\n      }\n    }\n\n    updateRowLabels() {\n      if (!this.tilesetInfo || !this.tilesetInfo.row_infos) return;\n\n      const labels = this.rowSelections.length\n        ? this.rowSelections.map((rowIndex) =>\n            this.tilesetInfo.row_infos[rowIndex] === undefined\n              ? '?'\n              : this.rowIdToCategory(this.tilesetInfo.row_infos[rowIndex].id)\n          )\n        : this.tilesetInfo.row_infos.map(({ id }) => this.rowIdToCategory(id));\n\n      this.removeRowLabels();\n\n      if (this.showRowLabels === 'indicator') {\n        this.rowLabels = labels.map((label) => {\n          const indicator = new PIXI.Sprite(PIXI.Texture.WHITE);\n          indicator.width = this.rowLabelSize / 2;\n          indicator.height = this.rowLabelSize;\n          indicator.tint = this.rowCategories[label]\n            ? HGC.utils.colorToHex(\n                this.rowCategories[label].axisLabelColor ||\n                  DEFAULT_COLOR_MAP[\n                    this.rowCategories[label].index % DEFAULT_COLOR_MAP.length\n                  ]\n              )\n            : 0x808080;\n          return indicator;\n        });\n      } else if (this.showRowLabels) {\n        this.rowLabels = labels.map(\n          (label) =>\n            new PIXI.Text(label, {\n              fontSize: this.rowLabelSize,\n              align: this.rowLabelAlign === 'right' ? 'right' : 'left',\n              fill: this.rowCategories[label]\n                ? HGC.utils.colorToHex(\n                    this.rowCategories[label].axisLabelColor ||\n                      DEFAULT_COLOR_MAP_DARK[\n                        this.rowCategories[label].index %\n                          DEFAULT_COLOR_MAP_DARK.length\n                      ]\n                  )\n                : 0x808080,\n            })\n        );\n      }\n    }\n\n    drawLabel() {\n      if (!this.showRowLabels) {\n        if (this.rowLabels) {\n          while (this.pAxis.children.length) {\n            this.pAxis.removeChildAt(0);\n          }\n        }\n        return;\n      }\n      if (this.showRowLabels && !this.rowLabels) this.updateRowLabels();\n      if (!this.rowLabels) return;\n\n      const [width] = this.dimensions;\n      const [left, top] = this.position;\n\n      this.pAxis.position.x = this.axisAlign === 'right' ? left + width : left;\n      this.pAxis.position.y = top;\n\n      this.pAxis.clear();\n      let yStart = 0;\n\n      const xLabelOffset = this.axisAlign === 'right' ? -3 : 3;\n      const [, rowStepHeight] = this.getRowHeight();\n      const rowStepYCenter = rowStepHeight / 2;\n\n      this.rowLabels.forEach((label, i) => {\n        label.x = xLabelOffset;\n        label.y = yStart - this.rowPadding + rowStepYCenter;\n        label.anchor.x = this.axisAlign === 'right' ? 1 : 0;\n        label.anchor.y = 0.5;\n\n        yStart += rowStepHeight;\n\n        this.pAxis.addChild(label);\n      });\n    }\n\n    rerender(newOptions) {\n      this.options = newOptions;\n      this.updateOptions();\n      this.updateExistingGraphics();\n    }\n\n    hasFetchedTiles() {\n      return Object.values(this.fetchedTiles).length;\n    }\n\n    coarsifyTileValues(tile) {\n      const { tileX, tileWidth } = this.getTilePosAndDimensions(\n        tile.tileData.zoomLevel,\n        tile.tileData.tilePos\n      );\n      const [numRows] = tile.tileData.shape;\n      const binSizePx = Math.floor(TILE_SIZE / this.markResolution);\n      const binSizeBp = tileWidth / this.markResolution;\n      const binSizeBpHalf = binSizeBp / 2;\n\n      // Determine bin boundaries\n      tile.tileData.binXPos = Array(this.markResolution).fill();\n      for (let i = 0; i <= this.markResolution; i++) {\n        tile.tileData.binXPos[i] = tileX + binSizeBp * i + binSizeBpHalf;\n      }\n\n      // 1. Coarsify the dense matrix according to `this.markResolution`\n      tile.tileData.valuesByRow = Array(numRows)\n        .fill()\n        .map(() => []);\n      tile.tileData.maxValueByRow = Array(numRows).fill(-Infinity);\n\n      for (let i = 0; i < numRows; i++) {\n        for (let j = 0; j < TILE_SIZE; j += binSizePx) {\n          const meanValue = meanNan(\n            tile.tileData.dense.subarray(\n              i * TILE_SIZE + j,\n              i * TILE_SIZE + j + binSizePx\n            )\n          );\n          tile.tileData.valuesByRow[i].push(meanValue);\n          tile.tileData.maxValueByRow[i] =\n            meanValue > tile.tileData.maxValueByRow[i]\n              ? meanValue\n              : tile.tileData.maxValueByRow[i];\n        }\n      }\n\n      // 2. Sort rows\n      if (this.rowSelections.length) {\n        tile.tileData.valuesByRow = this.rowSelections\n          .map((rowIdx) => tile.tileData.valuesByRow[rowIdx])\n          .filter(identity);\n        tile.tileData.maxValueByRow = this.rowSelections\n          .map((rowIdx) => tile.tileData.maxValueByRow[rowIdx])\n          .filter(identity);\n      }\n\n      // 3. Set out shape\n      tile.tileData.coarseShape = [\n        tile.tileData.valuesByRow.length,\n        this.markResolution,\n      ];\n    }\n\n    updateTiles() {\n      Object.values(this.fetchedTiles).forEach(\n        this.coarsifyTileValues.bind(this)\n      );\n    }\n\n    updateScales() {\n      const fetchedTiles = Object.values(this.fetchedTiles);\n\n      if (!fetchedTiles.length) return;\n\n      const numRows = getNumRows(fetchedTiles);\n\n      const [rowHeight] = this.getRowHeight();\n\n      const actualTrackHeight = this.getTrackHeight(numRows, rowHeight);\n\n      const globalMax = getMax(this.fetchedTiles);\n\n      this.valueScale = scaleLinear()\n        .domain([0, globalMax])\n        .range([rowHeight, 0]);\n      this.colorIndexScale = scaleLinear()\n        .domain([0, globalMax])\n        .range([0, this.markNumColors])\n        .clamp(true);\n\n      if (this.rowNormalization) {\n        const rowMaxs = getRowMaxs(this.fetchedTiles);\n        this.rowValueScales = {};\n        this.rowColorIndexScales = {};\n        for (let i = 0; i < numRows; i++) {\n          this.rowValueScales[i] = scaleLinear()\n            .domain([0, rowMaxs[i]])\n            .range([rowHeight, 0]);\n          this.rowColorIndexScales[i] = scaleLinear()\n            .domain([0, rowMaxs[i]])\n            .range([0, this.markNumColors])\n            .clamp(true);\n        }\n        this.valueScaleByRow = (value, row) =>\n          Number.isNaN(value) ? rowHeight : this.rowValueScales[row](value);\n        this.colorIndexScaleByRow = (value, row) =>\n          Number.isNaN(value) ? -2 : this.rowColorIndexScales[row](value);\n      } else {\n        this.valueScaleByRow = (value, row) =>\n          Number.isNaN(value) ? rowHeight : this.valueScale(value);\n        this.colorIndexScaleByRow = (value, row) =>\n          Number.isNaN(value) ? -2 : this.colorIndexScale(value);\n      }\n\n      this.rowScale = scaleLinear()\n        .domain([0, numRows])\n        .range([0, actualTrackHeight + this.rowPadding]);\n    }\n\n    tilesToData(tiles, { markArea, maxRows = Infinity, rowHeight } = {}) {\n      if (!tiles.length) return [];\n\n      const numRows = Math.min(maxRows, getNumRows(tiles));\n\n      const positionsByRow = Array(numRows)\n        .fill()\n        .map(() => []);\n      const colorIndicesByRow = Array(numRows)\n        .fill()\n        .map(() => []);\n      const offsetSignsByRow = Array(numRows)\n        .fill()\n        .map(() => []);\n\n      tiles.forEach((tile) => {\n        tile.tileData.valuesByRow.forEach((values, i) => {\n          if (i >= maxRows) return;\n          values.forEach((value, j) => {\n            const x = this._xScale(tile.tileData.binXPos[j]);\n            const yStart = this.rowScale(i);\n            const y = yStart + this.valueScaleByRow(value, i);\n            // We're duplicating the point as for every point on the line we\n            // need two x,y vertices to render triangles.\n            positionsByRow[i].push(x, y, x, y);\n            colorIndicesByRow[i].push(-1, -1); // -1 refers to the line color\n            offsetSignsByRow[i].push(1, -1);\n\n            if (markArea) {\n              positionsByRow[i].push(x, y, x, yStart + rowHeight);\n              colorIndicesByRow[i].push(this.colorIndexScaleByRow(value, i), 0);\n              offsetSignsByRow[i].push(0, 0);\n            }\n          });\n        });\n      });\n\n      const size2d = markArea ? 8 : 4;\n      const size1d = markArea ? 4 : 2;\n\n      // For each row, duplicate the first and last point\n      for (let i = 0; i < numRows; i++) {\n        // Add first point pair to the beginning of the array\n        positionsByRow[i].unshift(...positionsByRow[i].slice(0, size2d));\n\n        // The very first duplicated point positions do not matter as\n        // we offset the buffer reading. Subsequent dupliations need to be\n        // taken into account though.\n        if (i > 0) {\n          colorIndicesByRow[i].unshift(\n            ...colorIndicesByRow[i].slice(0, size1d)\n          );\n          offsetSignsByRow[i].unshift(...offsetSignsByRow[i].slice(0, size1d));\n        }\n\n        // Add last point pair to the end of the array\n        positionsByRow[i].push(...positionsByRow[i].slice(-size2d));\n        colorIndicesByRow[i].push(...colorIndicesByRow[i].slice(-size1d));\n        offsetSignsByRow[i].push(...offsetSignsByRow[i].slice(-size1d));\n      }\n\n      return [\n        new Float32Array(positionsByRow.flatMap(identity)),\n        new Float32Array(colorIndicesByRow.flatMap(identity)),\n        new Float32Array(offsetSignsByRow.flatMap(identity)),\n      ];\n    }\n\n    toLineIndices(numRows, numPointsPerRow, markArea) {\n      const verticesPerLine = markArea ? 12 : 6;\n      const verticesPerPoint = markArea ? 4 : 2;\n      const indices = new Uint32Array(\n        (numPointsPerRow - 1) * numRows * verticesPerLine\n      );\n      let k = 0;\n\n      if (markArea) {\n        // Draw a line and area\n        for (let i = 0; i < numRows; i++) {\n          for (let j = 0; j < numPointsPerRow - 1; j++) {\n            // The `+2` comes from the fact that for each row of points we\n            // duplicate the first and last point.\n            const pointOffset = i * (numPointsPerRow + 2) * verticesPerPoint;\n            const p1a = pointOffset + j * verticesPerPoint;\n            const p1b = p1a + 1;\n            const p1c = p1a + 2;\n            const p1d = p1a + 3;\n            const p2a = p1a + 4;\n            const p2b = p1a + 5;\n            const p2c = p1a + 6;\n            const p2d = p1a + 7;\n\n            const indexOffset = k * verticesPerLine;\n            // Area\n            indices[indexOffset] = p1c;\n            indices[indexOffset + 1] = p1d;\n            indices[indexOffset + 2] = p2c;\n            indices[indexOffset + 3] = p2c;\n            indices[indexOffset + 4] = p1d;\n            indices[indexOffset + 5] = p2d;\n            // Line\n            indices[indexOffset + 6] = p1a;\n            indices[indexOffset + 7] = p1b;\n            indices[indexOffset + 8] = p2a;\n            indices[indexOffset + 9] = p2a;\n            indices[indexOffset + 10] = p1b;\n            indices[indexOffset + 11] = p2b;\n\n            k++;\n          }\n        }\n      } else {\n        // Just draw a line\n        for (let i = 0; i < numRows; i++) {\n          for (let j = 0; j < numPointsPerRow - 1; j++) {\n            // The `+2` comes from the fact that for each row of points we\n            // duplicate the first and last point.\n            const pointOffset = i * (numPointsPerRow + 2) * verticesPerPoint;\n            const p1a = pointOffset + j * verticesPerPoint;\n            const p1b = p1a + 1;\n            const p2a = p1a + 2;\n            const p2b = p1a + 3;\n\n            const indexOffset = k * verticesPerLine;\n            indices[indexOffset] = p1a;\n            indices[indexOffset + 1] = p1b;\n            indices[indexOffset + 2] = p2a;\n            indices[indexOffset + 3] = p2a;\n            indices[indexOffset + 4] = p1b;\n            indices[indexOffset + 5] = p2b;\n\n            k++;\n          }\n        }\n      }\n\n      return indices;\n    }\n\n    getRowHeight(numRows) {\n      const [, visibleTrackHeight] = this.dimensions;\n\n      return this.rowHeight === 'auto'\n        ? [\n            Math.floor(visibleTrackHeight / numRows),\n            Math.floor(visibleTrackHeight / numRows),\n          ]\n        : [this.rowHeight, this.rowHeight + this.rowPadding];\n    }\n\n    getTrackHeight(numRows, rowHeight) {\n      const [, visibleTrackHeight] = this.dimensions;\n\n      return this.rowHeight === 'auto'\n        ? visibleTrackHeight\n        : rowHeight * numRows + this.rowPadding * (numRows - 1);\n    }\n\n    renderLines() {\n      this.drawnAtScale = scaleLinear()\n        .domain([...this.xScale().domain()])\n        .range([...this.xScale().range()]);\n\n      const tiles = Object.values(this.fetchedTiles);\n\n      const numRows = getNumRows(tiles);\n      const [rowHeight] = this.getRowHeight(numRows);\n\n      const [positions, colorIndices, offsetSigns] = this.tilesToData(tiles, {\n        maxRows: numRows,\n        markArea: this.markArea,\n        rowHeight,\n      });\n\n      const numPointsPerRow = getNumPointsPerRow(\n        numRows,\n        positions,\n        this.markArea\n      );\n\n      const indices = this.toLineIndices(\n        numRows,\n        numPointsPerRow,\n        this.markArea\n      );\n\n      const uniforms = new PIXI.UniformGroup({\n        uLineColor: [...this.markColorRgbNorm, 1.0],\n        uNaNColor: [1.0, 1.0, 1.0, 1.0],\n        uAreaColorTex: this.markColorTex,\n        uAreaColorTexRes: this.markColorTexRes,\n        uWidth: 0.25,\n        uMiter: 1,\n      });\n\n      const shader = PIXI.Shader.from(VS, FS, uniforms);\n\n      const geometry = new PIXI.Geometry();\n      const numCoords = 2;\n      const numVerticesPoint = this.markArea ? 4 : 2;\n      geometry.addAttribute(\n        'aPrevPosition',\n        positions,\n        2, // size\n        false, // normalize\n        PIXI.TYPES.FLOAT, // type\n        FLOAT_BYTES * numCoords, // stride\n        0 // offset/start\n      );\n      geometry.addAttribute(\n        'aCurrPosition',\n        positions,\n        2, // size\n        false, // normalize\n        PIXI.TYPES.FLOAT, // type\n        FLOAT_BYTES * numCoords, // stride\n        // note that each point is duplicated, hence we need to skip over the first two\n        FLOAT_BYTES * numCoords * numVerticesPoint // offset/start\n      );\n      geometry.addAttribute(\n        'aNextPosition',\n        positions,\n        2, // size\n        false, // normalize\n        PIXI.TYPES.FLOAT, // type\n        FLOAT_BYTES * 2, // stride\n        // note that each point is duplicated, hence we need to skip over the first four\n        FLOAT_BYTES * numCoords * numVerticesPoint * 2 // offset/start\n      );\n      geometry.addAttribute('aOffsetSign', offsetSigns, 1);\n      geometry.addAttribute('aColorIndex', colorIndices, 1);\n      geometry.addIndex(indices);\n\n      const mesh = new PIXI.Mesh(geometry, shader);\n\n      const newGraphics = new PIXI.Graphics();\n      newGraphics.addChild(mesh);\n\n      // eslint-disable-next-line\n      this.pMain.x = this.position[0];\n\n      if (this.lineGraphics) {\n        this.pMain.removeChild(this.lineGraphics);\n        this.lineGraphics.destroy();\n      }\n\n      this.pMain.addChild(newGraphics);\n      this.lineGraphics = newGraphics;\n\n      scaleGraphics(this.lineGraphics, this._xScale, this.drawnAtScale);\n\n      this.draw();\n      this.animate();\n    }\n\n    // Called whenever a new tile comes in\n    updateExistingGraphics() {\n      this.updateLoadIndicator();\n      if (!this.hasFetchedTiles()) return;\n      this.updateScales();\n      this.renderLines();\n    }\n\n    updateLoadIndicator() {\n      const [left, top] = this.position;\n      this.pLoading.position.x = left + 6;\n      this.pLoading.position.y = top + 6;\n\n      if (this.fetching.size) {\n        this.pLoading.addChild(this.loadIndicator);\n      } else {\n        this.pLoading.removeChild(this.loadIndicator);\n      }\n    }\n\n    refreshTiles() {\n      super.refreshTiles();\n      this.updateLoadIndicator();\n    }\n\n    setPosition(newPosition) {\n      super.setPosition(newPosition);\n\n      [this.pMain.position.x, this.pMain.position.y] = this.position;\n    }\n\n    zoomed(newXScale, newYScale) {\n      this.xScale(newXScale);\n      this.yScale(newYScale);\n\n      if (this.lineGraphics) {\n        scaleGraphics(this.lineGraphics, newXScale, this.drawnAtScale);\n      }\n\n      this.refreshTiles();\n      this.draw();\n    }\n\n    /**\n     * Return the data currently visible at position X and Y\n     *\n     * @param {Number} trackX: The x position relative to the track's start and end\n     * @param {Number} trakcY: The y position relative to the track's start and end\n     */\n    getVisibleData(trackX, trackY) {\n      if (!this.hasFetchedTiles()) return '';\n\n      const zoomLevel = this.calculateZoomLevel();\n\n      const numRows = getNumRows(this.fetchedTiles);\n      const [, rowStepHeight] = this.getRowHeight(numRows);\n\n      // the width of the tile in base pairs\n      const tileWidth = tileProxy.calculateTileWidth(\n        this.tilesetInfo,\n        zoomLevel,\n        this.tilesetInfo.tile_size\n      );\n\n      // the position of the tile containing the query position\n      const tilePos = this._xScale.invert(trackX) / tileWidth;\n\n      // the position of query within the tile\n      let posInTileX =\n        this.tilesetInfo.tile_size * (tilePos - Math.floor(tilePos));\n      // const posInTileYNormalized = trackY / this.dimensions[1];\n      // The first track doesn't apply padding so we have to shift padding\n      // to the mouse position once\n      const rowIndex = Math.floor(\n        Math.max(0, (trackY + this.rowPadding) / rowStepHeight)\n      );\n      const rowSelection = this.rowSelections[rowIndex];\n      const tileId = this.tileToLocalId([zoomLevel, Math.floor(tilePos)]);\n      const fetchedTile = this.fetchedTiles[tileId];\n      const colIndex =\n        Math.floor(posInTileX) / Math.floor(TILE_SIZE / this.markResolution);\n\n      let text = '';\n      let value = '<em>unknown</em>';\n\n      if (rowSelection === undefined) return text;\n\n      if (fetchedTile) {\n        if (!this.tilesetInfo.shape) {\n          posInTileX =\n            fetchedTile.tileData.dense.length * (tilePos - Math.floor(tilePos));\n        }\n\n        let index = null;\n        if (this.tilesetInfo.shape) {\n          // Accomodate data from vector sources\n          if (\n            Array.isArray(rowSelection) &&\n            this.options.selectRowsAggregationMethod === 'client'\n          ) {\n            // Need to aggregate, so `index` will actually be an array.\n            index = rowSelection.map(\n              (rowI) =>\n                this.tilesetInfo.shape[0] * rowI + Math.floor(posInTileX)\n            );\n          } else if (\n            rowSelection &&\n            this.options.selectRowsAggregationMethod === 'client'\n          ) {\n            index =\n              this.tilesetInfo.shape[0] * rowSelection + Math.floor(posInTileX);\n          } else {\n            // No need to aggregate, `index` will contain a single item.\n            index =\n              this.tilesetInfo.shape[0] * rowIndex + Math.floor(posInTileX);\n          }\n        } else {\n          index =\n            fetchedTile.tileData.dense.length * rowIndex +\n            Math.floor(posInTileX);\n        }\n\n        if (Array.isArray(index)) {\n          const values = index.map((i) => fetchedTile.tileData.dense[i]);\n          value = format('.3f')(this.selectRowsAggregationFn(values));\n          text = value;\n\n          text += '<br/>';\n          text += `${index.length}-item ${this.options.selectRowsAggregationMode}`;\n        } else {\n          value = format('.3f')(\n            fetchedTile.tileData.valuesByRow[rowIndex][colIndex]\n          );\n          text = value;\n\n          if (Array.isArray(rowSelection)) {\n            value += '<br/>';\n            value += `${rowSelection.length}-item ${this.options.selectRowsAggregationMode}`;\n          }\n        }\n      }\n\n      // add information about the row\n      if (this.tilesetInfo.row_infos) {\n        let rowInfo = '';\n\n        if (rowSelection !== undefined) {\n          rowInfo = this.tilesetInfo.row_infos[rowSelection];\n        }\n\n        const label =\n          typeof rowInfo === 'object'\n            ? this.rowIdToCategory(rowInfo.id)\n            : rowInfo;\n\n        const color = this.rowCategories[label]\n          ? this.rowCategories[label].axisLabelColor ||\n            DEFAULT_COLOR_MAP_DARK[\n              this.rowCategories[label].index % DEFAULT_COLOR_MAP_DARK.length\n            ]\n          : '#666666';\n\n        const background = this.rowCategories[label]\n          ? this.rowCategories[label].axisLabelColor ||\n            DEFAULT_COLOR_MAP_LIGHT[\n              this.rowCategories[label].index % DEFAULT_COLOR_MAP_LIGHT.length\n            ]\n          : '#ffffff';\n\n        return `<div style=\"margin: -0.25rem; padding: 0 0.25rem; background: ${background}\"><strong style=\"color: ${color};\">${label}:</strong> ${value}</div>`;\n      }\n\n      return text;\n    }\n\n    /**\n     * Get some information to display when the mouse is over this\n     * track\n     *\n     * @param {Number} trackX: the x position of the mouse over the track\n     * @param {Number} trackY: the y position of the mouse over the track\n     *\n     * @return {string}: A HTML string containing the information to display\n     *\n     */\n    getMouseOverHtml(trackX, trackY) {\n      if (!this.tilesetInfo) return '';\n\n      return this.getVisibleData(trackX, trackY);\n    }\n\n    exportSVG() {\n      const svgns = 'http://www.w3.org/2000/svg';\n\n      let track = null;\n      let base = null;\n\n      [base, track] = super.exportSVG();\n\n      base.setAttribute('class', 'ridge-plot-track');\n      const output = document.createElement('g');\n\n      track.appendChild(output);\n      output.setAttribute(\n        'transform',\n        `translate(${this.position[0]}, ${this.position[1]})`\n      );\n\n      const tiles = Object.values(this.fetchedTiles);\n\n      const numRows = getNumRows(tiles);\n      const [rowHeight] = this.getRowHeight(numRows);\n      const stride = this.markArea ? 8 : 4;\n\n      const [positions] = this.tilesToData(tiles, {\n        maxRows: numRows,\n        markArea: this.markArea,\n        rowHeight,\n      });\n\n      const createLine = line()\n        .x((d) => d[0])\n        .y((d) => d[1]);\n\n      const posPerRow = positions.length / numRows;\n\n      const posToPoints = (pos) => {\n        const arr = [];\n        const start = stride;\n        const end = pos.length - stride;\n\n        for (let i = start; i < end; i += stride) {\n          arr.push([pos[i], pos[i + 1]]);\n        }\n\n        return arr;\n      };\n\n      let fill = this.markArea\n        ? (this.options.colorRange && this.options.colorRange[0]) || '#ffffff'\n        : 'none';\n      if (this.markArea && this.options.colorRange) {\n        const numColors = this.options.colorRange.length;\n        const defs = document.createElementNS(svgns, 'defs');\n        const linearGradient = document.createElementNS(\n          svgns,\n          'linearGradient'\n        );\n        linearGradient.setAttribute('id', 'RidgePlotGradient');\n        linearGradient.setAttribute('x1', '0');\n        linearGradient.setAttribute('y1', '1');\n        linearGradient.setAttribute('x2', '0');\n        linearGradient.setAttribute('y2', '0');\n        this.options.colorRange.forEach((color, i) => {\n          const stop = document.createElementNS(svgns, 'stop');\n          stop.setAttribute(\n            'offset',\n            `${Math.round((i / (numColors - 1)) * 100)}%`\n          );\n          stop.setAttribute('stop-color', color);\n          linearGradient.appendChild(stop);\n        });\n        defs.appendChild(linearGradient);\n        base.insertBefore(defs, base.firstChild);\n        fill = 'url(#RidgePlotGradient)';\n      }\n\n      for (let i = 0; i < numRows; i++) {\n        const arr = posToPoints(\n          positions.subarray(i * posPerRow, (i + 1) * posPerRow)\n        );\n\n        const l = document.createElement('path');\n        let d = createLine(arr);\n\n        const y0 = this.rowScale(i) + this.valueScaleByRow(0, i);\n\n        // We extend the line a little to the left and right and anchor them at\n        // y = 0 to avoid weird glitches with the fill.\n        const firstComma = d.indexOf(',');\n        const firstX = +d.substring(1, firstComma);\n        const firstY = +d.substring(firstComma + 1, d.indexOf('L'));\n        d = `M${firstX - 1},${y0}L${firstX - 1},${firstY}L${d.substring(1)}`;\n        const lastComma = d.lastIndexOf(',');\n        const lastX = +d.substring(d.lastIndexOf('L') + 1, lastComma);\n        const lastY = +d.substring(lastComma + 1);\n        d += `L${lastX + 1},${lastY}L${lastX + 1},${y0}`;\n\n        l.setAttribute('d', d);\n        l.setAttribute('fill', fill);\n        l.setAttribute('stroke', this.options.markColor || 'black');\n        l.setAttribute('stroke-width', (this.options.markSize || 2) / 8);\n\n        output.appendChild(l);\n      }\n\n      return [base, track];\n    }\n  }\n\n  return new RidgePlotTrack(...args);\n};\n\ncreateRidgePlotTrack.config = {\n  type: 'ridge-plot',\n  datatype: ['multivec'],\n  orientation: '1d',\n  name: 'RidgePlot',\n};\n\nexport default createRidgePlotTrack;\n","import IntervalTree from '@flatten-js/interval-tree';\n\nimport {\n  DEFAULT_COLOR_MAP,\n  DEFAULT_COLOR_MAP_DARK,\n  DEFAULT_COLOR_MAP_LIGHT,\n  EPS,\n} from './constants';\nimport { dashedXLineTo, toFixed } from './utils';\n\nconst intersects = (a, b) => a[0] < b[1] && a[1] >= b[0];\n\nconst VS = `\n  precision mediump float;\n  attribute vec2 aPosition;\n  attribute float aOpacity;\n  attribute float aHighlight;\n\n  uniform mat3 projectionMatrix;\n  uniform mat3 translationMatrix;\n  uniform float uPointSize;\n\n  varying float vHighlight;\n  varying float vOpacity;\n\n  void main(void)\n  {\n    vHighlight = aHighlight;\n    vOpacity = aOpacity;\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n    gl_PointSize = uPointSize;\n  }\n`;\n\nconst FS = `\n  precision mediump float;\n\n  uniform vec4 uColor;\n  uniform vec4 uColorHighlight;\n\n  varying float vHighlight;\n  varying float vOpacity;\n\n  void main() {\n    float isNotFocused = 1.0 - vHighlight;\n\n    float r = uColor.r * isNotFocused + uColorHighlight.r * vHighlight;\n    float g = uColor.g * isNotFocused + uColorHighlight.g * vHighlight;\n    float b = uColor.b * isNotFocused + uColorHighlight.b * vHighlight;\n\n    gl_FragColor = vec4(r, g, b, 1.0) * vOpacity;\n  }\n`;\n\n// prettier-ignore\nconst pointToPosition = (pt) => [\n  // top-left\n  pt.cX - pt.widthHalf, pt.y,\n  // top-right\n  pt.cX + pt.widthHalf, pt.y,\n  // bottom-right\n  pt.cX + pt.widthHalf, pt.y + pt.height,\n  // pt.cX + pt.widthHalf, pt.y + pt.height,\n  // bottom-left\n  pt.cX - pt.widthHalf, pt.y + pt.height,\n  // pt.cX - pt.widthHalf, pt.y,\n];\n\nconst pointToIndex = (pt, i) => {\n  const base = i * 4;\n  return [base, base + 1, base + 2, base + 2, base + 3, base];\n};\n\nconst pointToOpacity = (pt) => [pt.opacity, pt.opacity, pt.opacity, pt.opacity];\n\nconst pointToHighlight = (pt) => [\n  pt.highlight,\n  pt.highlight,\n  pt.highlight,\n  pt.highlight,\n];\n\nconst getItemDistance = (item) =>\n  Math.abs(\n    +item.fields[1] +\n      (+item.fields[2] - +item.fields[1]) / 2 -\n      (+item.fields[4] + (+item.fields[4] - +item.fields[5]) / 2)\n  );\n\nconst getMaxDistance = (fetchedTiles) =>\n  Object.values(fetchedTiles).reduce(\n    (maxDist, tile) =>\n      Math.max(\n        maxDist,\n        tile.tileData.reduce(\n          (maxDistItem, item) => Math.max(maxDistItem, item.distance),\n          0\n        )\n      ),\n    0\n  );\n\nconst scaleScalableGraphics = (graphics, xScale, drawnAtScale) => {\n  const tileK =\n    (drawnAtScale.domain()[1] - drawnAtScale.domain()[0]) /\n    (xScale.domain()[1] - xScale.domain()[0]);\n  const newRange = xScale.domain().map(drawnAtScale);\n\n  const posOffset = newRange[0];\n  graphics.scale.x = tileK;\n  graphics.position.x = -posOffset * tileK;\n};\n\nconst getRegionId = (item) =>\n  `${item.fields[0]}:${item.fields[1]}-${item.fields[2]}`;\n\nconst createStratifiedBedTrack = function createStratifiedBedTrack(\n  HGC,\n  ...args\n) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  const { PIXI } = HGC.libraries;\n  const { scaleLinear, scaleLog } = HGC.libraries.d3Scale;\n  const { tileProxy } = HGC.services;\n  const { MAX_CLICK_DELAY } = HGC.configs;\n\n  const opacityLogScale = scaleLog()\n    .domain([1, 10])\n    .range([0.1, 1])\n    .clamp(true);\n\n  class StratifiedBedTrack extends HGC.tracks.HorizontalLine1DPixiTrack {\n    constructor(context, options) {\n      super(context, options);\n\n      this.pLegend = new PIXI.Graphics();\n      this.pMasked.addChild(this.pLegend);\n\n      this.legendMin = Infinity;\n      this.legendMax = -Infinity;\n\n      // Needed for interaction tracking because interaction tracking on the\n      // mesh causes errors...\n      this.bg = new PIXI.Sprite(PIXI.Texture.WHITE);\n      [this.bg.width, this.bg.height] = this.dimensions;\n      this.bg.interactive = true;\n      this.bg.interactiveChildren = false;\n      this.bg.alpha = 0;\n\n      let mousedownTime = performance.now();\n      this.bg.mousedown = () => {\n        mousedownTime = performance.now();\n      };\n      this.bg.mouseup = (e) => {\n        if (performance.now() - mousedownTime < MAX_CLICK_DELAY)\n          this.clickHandler(e);\n      };\n\n      this.updateOptions();\n\n      this.pLoading = new PIXI.Graphics();\n      this.pLoading.position.x = 0;\n      this.pLoading.position.y = 0;\n      this.pMasked.addChild(this.pLoading);\n\n      this.loadIndicator = new PIXI.Text('Loading data...', {\n        fontSize: this.labelSize || 10,\n        fill: 0x808080,\n      });\n      this.pLoading.addChild(this.loadIndicator);\n    }\n\n    initTile(tile) {\n      const intervals = [];\n\n      tile.intervalTree = new IntervalTree(intervals);\n\n      tile.tileData.forEach((item, i) => {\n        item.distance = getItemDistance(item) || -1;\n        item.cX = item.xStart + (item.xEnd - item.xStart) / 2;\n        item.regionId = getRegionId(item);\n        item.isLeftToRight = item.xStart < item.xEnd;\n        tile.intervalTree.insert([item.xStart, item.xEnd], i);\n      });\n    }\n\n    updateStratificationOption() {\n      if (!this.options.stratification) {\n        this.categoryField = undefined;\n        this.categoryToGroup = undefined;\n        this.groupToColor = undefined;\n        this.numGroups = 0;\n        this.numCategories = 0;\n        this.groupLabels = [];\n        return;\n      }\n\n      this.categoryField = this.options.stratification.categoryField;\n      this.getCategory = (item) =>\n        item.fields[this.categoryField].toLowerCase();\n      this.categoryToGroup = new Map();\n      this.categoryToY = new Map();\n      this.yToCategory = new Map();\n      this.groupToColor = new Map();\n\n      this.groupSizes = this.options.stratification.groups.map(\n        (group) =>\n          group.categories.filter((category) => this.valueFilter(category))\n            .length\n      );\n      this.filteredGroups = this.options.stratification.groups.filter(\n        (group, i) => this.groupSizes[i] > 0\n      );\n      this.numGroups = this.filteredGroups.length;\n      this.numCategories = this.groupSizes.reduce(\n        (numCategories, groupSize) => numCategories + groupSize,\n        0\n      );\n      this.groupLabels = this.options.stratification.groups.map(\n        (group, i) => group.label || `Group ${i}`\n      );\n\n      let k = 0;\n      this.options.stratification.groups.forEach((group, i) => {\n        this.groupToColor.set(i, [\n          HGC.utils.colorToHex(\n            group.color || DEFAULT_COLOR_MAP[i % DEFAULT_COLOR_MAP.length]\n          ),\n          HGC.utils.colorToHex(\n            group.backgroundColor ||\n              DEFAULT_COLOR_MAP_LIGHT[i % DEFAULT_COLOR_MAP_LIGHT.length]\n          ),\n          HGC.utils.colorToHex(\n            group.backgroundColor ||\n              DEFAULT_COLOR_MAP_DARK[i % DEFAULT_COLOR_MAP_DARK.length]\n          ),\n        ]);\n        group.categories\n          .filter((category) => this.valueFilter(category))\n          .forEach((category, j) => {\n            const cat = category.toLowerCase();\n            this.categoryToGroup.set(cat, i);\n            this.categoryToY.set(cat, k + j);\n            this.yToCategory.set(k + j, cat);\n          });\n        k += this.groupSizes[i];\n      });\n\n      this.groupLabelsPixiText = this.groupLabels.map(\n        (label, i) =>\n          new PIXI.Text(label, {\n            fontSize: this.labelSize,\n            align: this.axisAlign === 'right' ? 'right' : 'left',\n            fill: HGC.utils.colorToHex(\n              this.options.stratification.groups[i].axisLabelColor ||\n                DEFAULT_COLOR_MAP_DARK[i % DEFAULT_COLOR_MAP_DARK.length]\n            ),\n          })\n      );\n    }\n\n    updateOptions() {\n      this.axisAlign = this.options.axisAlign || 'left';\n\n      this.labelColor = HGC.utils.colorToHex(\n        this.options.labelColor || 'black'\n      );\n\n      this.labelSize = this.options.labelSize || 12;\n\n      this.markColor = HGC.utils.colorToHex(this.options.markColor || 'black');\n\n      this.markColorRgbNorm = this.options.markColor\n        ? HGC.utils\n            .colorToRgba(this.options.markColor)\n            .slice(0, 3)\n            .map((x) => Math.min(1, Math.max(0, x / 255)))\n        : [0, 0, 0];\n\n      this.markOpacity = Number.isNaN(+this.options.markOpacity)\n        ? 1\n        : Math.min(1, Math.max(0, +this.options.markOpacity));\n\n      this.markSize = this.options.markSize || 2;\n      this.markMinWidth = this.options.markMinWidth || this.markSize;\n      this.markHeight = this.options.markHeight || this.markSize;\n\n      this.rowHeight = this.options.rowHeight || this.markHeight;\n\n      this.markColorHighlight = HGC.utils.colorToHex(\n        this.options.markColorHighlight || 'red'\n      );\n\n      this.markColorHighlightRgbNorm = this.options.markColorHighlight\n        ? HGC.utils\n            .colorToRgba(this.options.markColorHighlight)\n            .slice(0, 3)\n            .map((x) => Math.min(1, Math.max(0, x / 255)))\n        : [1, 0, 0];\n\n      this.markColorDehighlight = HGC.utils.colorToHex(\n        this.options.markColorDehighlight || '#999999'\n      );\n\n      this.markColorDehighlightRgbNorm = this.options.markColorDehighlight\n        ? HGC.utils\n            .colorToRgba(this.options.markColorDehighlight)\n            .slice(0, 3)\n            .map((x) => Math.min(1, Math.max(0, x / 255)))\n        : [0.6, 0.6, 0.6];\n\n      this.markOpacityFocus = Number.isNaN(+this.options.markOpacityFocus)\n        ? this.markOpacity\n        : Math.min(1, Math.max(0, +this.options.markOpacityFocus));\n\n      this.filterSet =\n        this.options.filter && this.options.filter.set\n          ? this.options.filter.set.reduce((s, include) => {\n              s.add(include);\n              return s;\n            }, new Set())\n          : null;\n\n      this.filterField = this.options.filter && this.options.filter.field;\n\n      this.valueFilter = this.filterSet\n        ? (value) => this.filterSet.has(value)\n        : () => true;\n\n      this.itemFilter =\n        this.valueFilter && this.filterField\n          ? (item) => this.valueFilter(item.fields[this.filterField])\n          : () => true;\n\n      this.getImportance = this.options.importanceField\n        ? (item) => +item.fields[this.options.importanceField]\n        : (item) => item.distance;\n\n      this.opacityEncoding = this.options.opacityEncoding || 'solid';\n\n      switch (this.opacityEncoding) {\n        case 'frequency':\n          this.opacityScale = () => 0.1;\n          break;\n\n        case 'highestImportance':\n        case 'closestImportance': {\n          const importanceDomain = this.options.importanceDomain || [1, 1000];\n          const opacityLinearScale = scaleLinear()\n            .domain(importanceDomain)\n            .range([1, 10]);\n          this.opacityScale = (x) => opacityLogScale(opacityLinearScale(x));\n          break;\n        }\n\n        case 'solid':\n        default:\n          this.opacityScale = () => 1;\n          break;\n      }\n\n      this.focusRegion = this.options.focusRegion\n        ? this.options.focusRegion\n        : [Infinity, Infinity];\n\n      this.getRegion = this.options.focusRegion\n        ? (item) => [item.xStart, item.xEnd]\n        : undefined;\n\n      this.focusGene = this.options.focusGene\n        ? this.options.focusGene.toLowerCase()\n        : undefined;\n\n      this.getGene = this.options.geneField\n        ? (item) => item.fields[this.options.geneField].toLowerCase()\n        : undefined;\n\n      this.focusStyle = this.options.focusStyle\n        ? this.options.focusStyle.toLowerCase()\n        : undefined;\n\n      this.minImportance = this.options.minImportance || 0;\n\n      this.updateStratificationOption();\n    }\n\n    rerender(newOptions) {\n      this.options = newOptions;\n      this.updateOptions();\n      this.updateExistingGraphics();\n    }\n\n    hasFetchedTiles() {\n      return Object.values(this.fetchedTiles).length;\n    }\n\n    updateScales() {\n      const fetchedTiles = Object.values(this.fetchedTiles);\n\n      if (!fetchedTiles.length) return;\n\n      const [, height] = this.dimensions;\n\n      this.maxDist = getMaxDistance(this.fetchedTiles);\n\n      this.heightScale = scaleLinear()\n        .domain([0, this.maxDist])\n        .range([Math.min(12, height / 10), height]);\n\n      this.categoryHeightScale = scaleLinear()\n        .domain([0, this.numCategories])\n        .range([0, this.numCategories * this.rowHeight]);\n\n      this.valueScale = scaleLinear()\n        .domain([0, this.maxDist])\n        .range([height, 0]);\n\n      this.valueScaleInverted = scaleLinear()\n        .domain([0, this.maxDist])\n        .range([0, height]);\n    }\n\n    itemToIndicatorCategory(item, isHighlighting) {\n      return {\n        cX: this._xScale(item.cX),\n        y: this.categoryHeightScale(\n          this.categoryToY.get(this.getCategory(item))\n        ),\n        opacity: this.opacityScale(this.getImportance(item)),\n        highlight: isHighlighting && item.__focus,\n        widthHalf: Math.max(\n          this.markMinWidth / 2,\n          Math.abs(this._xScale(item.xStart) - this._xScale(item.xEnd)) / 2\n        ),\n        height: this.markHeight,\n        __item: item,\n      };\n    }\n\n    isItemInFocus() {\n      if (\n        this.getGene &&\n        this.focusGene &&\n        this.getRegion &&\n        this.focusRegion\n      ) {\n        return (item) => {\n          item.__focus =\n            this.getGene(item) === this.focusGene &&\n            intersects(this.getRegion(item), this.focusRegion);\n          return item.__focus;\n        };\n      }\n\n      if (this.getGene && this.focusGene) {\n        return (item) => {\n          item.__focus = this.getGene(item) === this.focusGene;\n          return item.__focus;\n        };\n      }\n\n      if (this.getRegion && this.focusRegion) {\n        return (item) => {\n          item.__focus = intersects(this.getRegion(item), this.focusRegion);\n          return item.__focus;\n        };\n      }\n\n      return (item) => {\n        item.__focus = false;\n        // If no focus was defined, we include all intervals\n        return true;\n      };\n    }\n\n    itemToIndicatorReducer(focusFilterFn, addFn) {\n      if (this.focusStyle === 'highlighting') {\n        return (filteredItems, item, i) => {\n          focusFilterFn(item);\n          if (this.itemFilter(item)) addFn(filteredItems, item);\n          return filteredItems;\n        };\n      }\n\n      return (filteredItems, item) => {\n        if (focusFilterFn(item) && this.itemFilter(item))\n          addFn(filteredItems, item);\n        return filteredItems;\n      };\n    }\n\n    getPoints(isHighlighting) {\n      let reducerVar = [];\n      let addFn = (accumulator, item) =>\n        accumulator.push(this.itemToIndicatorCategory(item, isHighlighting));\n\n      if (this.opacityEncoding === 'highestImportance') {\n        reducerVar = {};\n        addFn = (accumulator, item) => {\n          if (accumulator[item.regionId]) {\n            const i1 = this.getImportance(accumulator[item.regionId].__item);\n            const i2 = this.getImportance(item);\n            if (i2 > i1) {\n              accumulator[item.regionId] = this.itemToIndicatorCategory(\n                item,\n                isHighlighting\n              );\n            }\n          } else {\n            accumulator[item.regionId] = this.itemToIndicatorCategory(\n              item,\n              isHighlighting\n            );\n          }\n        };\n      } else if (this.opacityEncoding === 'closestImportance') {\n        reducerVar = {};\n        addFn = (accumulator, item) => {\n          if (\n            !accumulator[item.regionId] ||\n            item.distance < accumulator[item.regionId].__item.distance\n          ) {\n            accumulator[item.regionId] = this.itemToIndicatorCategory(\n              item,\n              isHighlighting\n            );\n          }\n        };\n      }\n\n      const focusFilterFn = this.isItemInFocus();\n      const dataToPoint = this.itemToIndicatorReducer(focusFilterFn, addFn);\n\n      return Object.values(this.fetchedTiles).flatMap((tile) =>\n        Object.values(tile.tileData.reduce(dataToPoint, reducerVar))\n      );\n    }\n\n    renderIndicatorPoints() {\n      this.drawnAtScale = scaleLinear()\n        .domain([...this.xScale().domain()])\n        .range([...this.xScale().range()]);\n\n      const isHighlighting = !!(\n        this.focusStyle === 'highlighting' &&\n        ((this.focusGene && this.getGene) ||\n          (this.focusRegion && this.getRegion))\n      );\n\n      const points = this.getPoints(isHighlighting);\n\n      const positions = new Float32Array(points.flatMap(pointToPosition));\n      const indices = new Uint16Array(points.flatMap(pointToIndex));\n      const opacities = new Float32Array(points.flatMap(pointToOpacity));\n      const highlights = new Float32Array(points.flatMap(pointToHighlight));\n\n      const uniforms = new PIXI.UniformGroup({\n        uColor: isHighlighting\n          ? [...this.markColorDehighlightRgbNorm, this.markOpacity]\n          : [...this.markColorRgbNorm, this.markOpacity],\n        uColorHighlight: [...this.markColorHighlightRgbNorm, this.markOpacity],\n        uHighlighting: isHighlighting,\n      });\n\n      const shader = PIXI.Shader.from(VS, FS, uniforms);\n\n      const geometry = new PIXI.Geometry();\n      geometry.addAttribute('aPosition', positions, 2);\n      geometry.addAttribute('aOpacity', opacities, 1);\n      geometry.addAttribute('aHighlight', highlights, 1);\n      geometry.addIndex(indices);\n\n      const mesh = new PIXI.Mesh(geometry, shader);\n\n      const newGraphics = new PIXI.Graphics();\n      newGraphics.addChild(this.bg);\n      newGraphics.addChild(mesh);\n\n      [this.bg.width, this.bg.height] = this.dimensions;\n\n      // eslint-disable-next-line\n      this.pMain.x = this.position[0];\n\n      if (this.indicatorPointGraphics) {\n        this.indicatorPointGraphics.removeChild(this.bg);\n        this.pMain.removeChild(this.indicatorPointGraphics);\n      }\n\n      this.pMain.addChild(newGraphics);\n      this.indicatorPointGraphics = newGraphics;\n\n      scaleScalableGraphics(\n        this.indicatorPointGraphics,\n        this._xScale,\n        this.drawnAtScale\n      );\n\n      this.draw();\n      this.animate();\n    }\n\n    renderIndicatorCategoryAxis() {\n      const [width] = this.dimensions;\n      const [left, top] = this.position;\n\n      this.pAxis.position.x = this.axisAlign === 'right' ? left + width : left;\n      this.pAxis.position.y = top;\n\n      this.pAxis.clear();\n      let yStart = 0;\n      let yEnd = 0;\n\n      const xTickOffset = this.axisAlign === 'right' ? -5 : 5;\n      const xTickEnd = this.axisAlign === 'right' ? -width : width;\n      const xLabelOffset = this.axisAlign === 'right' ? -3 : 3;\n      const numAxisLabels = this.pAxis.children.length;\n\n      this.pAxis.lineStyle(1, 0x000000, 1.0, 0.0);\n\n      this.groupLabelsPixiText.forEach((labelPixiText, i) => {\n        if (numAxisLabels < i + 1) {\n          this.pAxis.addChild(labelPixiText);\n        }\n\n        // Don't ask me why but somehow after `labelPixiText` was added to\n        // `this.pAxis` the object is not the same as `this.pAxis.children[i]`\n        // anymore and subsequent changes were ineffective\n        const text = this.pAxis.children[i];\n\n        if (this.groupSizes[i] === 0) {\n          text.alpha = 0;\n          return;\n        }\n\n        const height = this.categoryHeightScale(this.groupSizes[i]);\n        yEnd += height;\n        text.x = xLabelOffset;\n        text.y = yStart + height / 2;\n        text.anchor.x = this.axisAlign === 'right' ? 1 : 0;\n        text.anchor.y = 0.5;\n        text.alpha = 1;\n\n        if (this.options.focusStyle === 'highlighting') {\n          this.pAxis.beginFill(0xffffff, 0.66);\n        } else {\n          this.pAxis.beginFill(this.groupToColor.get(i)[1], 0.66);\n        }\n\n        this.pAxis.lineStyle(0);\n        if (this.axisAlign === 'right') {\n          this.pAxis.drawRect(\n            text.x - text.width,\n            text.y - text.height / 2,\n            text.width,\n            text.height\n          );\n        } else {\n          this.pAxis.drawRect(\n            text.x,\n            text.y - text.height / 2,\n            text.width,\n            text.height\n          );\n        }\n        this.pAxis.endFill();\n\n        this.pAxis.lineStyle(1, 0x000000, 1.0, 0.0);\n        this.pAxis.moveTo(0, yStart);\n        this.pAxis.lineTo(xTickOffset, yStart);\n\n        if (this.options.stratification.axisShowGroupSeparator) {\n          dashedXLineTo(this.pAxis, 0, xTickEnd, yStart, 5);\n        }\n\n        yStart = yEnd;\n      });\n\n      this.pAxis.moveTo(0, 0);\n      this.pAxis.lineTo(0, yEnd);\n      this.pAxis.lineTo(xTickOffset, yEnd);\n\n      if (this.options.stratification.axisShowGroupSeparator) {\n        dashedXLineTo(this.pAxis, 0, xTickEnd, yEnd, 5);\n      }\n    }\n\n    renderIndicatorLegend() {\n      this.pLegend.clear();\n\n      if (this.opacityEncoding.indexOf('Importance') === -1) {\n        if (this.legendMinText) {\n          this.pLegend.removeChild(this.legendMinText);\n          this.legendMinText.destroy();\n          this.legendMinText = undefined;\n        }\n        if (this.legendMaxText) {\n          this.pLegend.removeChild(this.legendMaxText);\n          this.legendMaxText.destroy();\n          this.legendMaxText = undefined;\n        }\n        return;\n      }\n\n      const padding = 6;\n      const [width] = this.dimensions;\n      const [left, top] = this.position;\n      const [, y] = this.categoryHeightScale.range();\n      const isRightAligned = this.options.legendAlign === 'right';\n      const isHighlighting = !!(\n        this.focusStyle === 'highlighting' &&\n        ((this.focusGene && this.getGene) ||\n          (this.focusRegion && this.getRegion))\n      );\n\n      this.pLegend.position.x = isRightAligned ? left + width : left;\n\n      const [minValue, maxValue] = this.options.importanceDomain || [1, 1000];\n\n      if (Math.abs(minValue - this.legendMin) > EPS) {\n        if (this.legendMinText) {\n          this.pLegend.removeChild(this.legendMinText);\n          this.legendMinText.destroy();\n        }\n        this.legendMinText = new PIXI.Text(toFixed(minValue, 3), {\n          fontSize: this.labelSize,\n          align: isRightAligned ? 'right' : 'left',\n          fill: 0x808080,\n        });\n        this.legendMinText.x = 0;\n        this.legendMinText.y = padding / 2;\n        this.legendMinText.anchor.x = isRightAligned ? 1 : 0;\n        this.pLegend.addChild(this.legendMinText);\n      }\n\n      if (Math.abs(maxValue - this.legendMax) > EPS) {\n        if (this.legendMaxText) {\n          this.pLegend.removeChild(this.legendMaxText);\n          this.legendMaxText.destroy();\n        }\n        this.legendMaxText = new PIXI.Text(toFixed(maxValue, 3), {\n          fontSize: this.labelSize,\n          align: isRightAligned ? 'right' : 'left',\n          fill: 0x808080,\n        });\n        this.legendMaxText.x = 0;\n        this.legendMaxText.y = padding / 2;\n        this.legendMaxText.anchor.x = isRightAligned ? 1 : 0;\n        this.pLegend.addChild(this.legendMaxText);\n      }\n\n      const legendRectWidth = 42;\n      const minTextWidth = this.legendMinText.getBounds().width;\n      const maxTextWidth = this.legendMaxText.getBounds().width;\n      const offset = isRightAligned\n        ? -(maxTextWidth + legendRectWidth + padding)\n        : minTextWidth + 2 * padding;\n\n      const rectHeight = 18 + (isHighlighting * padding) / 2;\n\n      this.pLegend.beginFill(0xffffff);\n      this.pLegend.lineStyle(1, 0xcccccc);\n      if (isRightAligned) {\n        this.legendMinText.x = offset - padding;\n        this.pLegend.drawRoundedRect(\n          -(legendRectWidth + minTextWidth + maxTextWidth + 3 * padding + 0.5),\n          0,\n          legendRectWidth + minTextWidth + maxTextWidth + 3 * padding,\n          rectHeight,\n          3\n        );\n      } else {\n        this.legendMaxText.x = offset + legendRectWidth + 2 * padding;\n        this.pLegend.drawRoundedRect(\n          0.5,\n          0,\n          legendRectWidth + minTextWidth + maxTextWidth + 3 * padding,\n          18 + (isHighlighting * padding) / 2,\n          3\n        );\n      }\n      this.pLegend.endFill();\n      this.pLegend.lineStyle(0);\n\n      for (let i = 0; i < 5; i++) {\n        const opacity = this.opacityScale(minValue + (i / 4) * maxValue);\n\n        this.pLegend.beginFill(this.markColor, opacity);\n        this.pLegend.drawRect(\n          i * 9 + offset,\n          padding / 2 + !isHighlighting * 3,\n          6,\n          6\n        );\n        this.pLegend.endFill();\n\n        if (isHighlighting) {\n          this.pLegend.beginFill(this.markColorHighlight, opacity);\n          this.pLegend.drawRect(i * 9 + offset, padding / 2 + 9, 6, 6);\n          this.pLegend.endFill();\n        }\n      }\n\n      if (isRightAligned) {\n        this.legendMinText.x = offset - padding;\n        this.legendMaxText.x = -padding / 2;\n      } else {\n        this.legendMinText.x = padding / 2;\n        this.legendMaxText.x = offset + legendRectWidth + padding;\n      }\n\n      this.pLegend.position.y = top + y - padding - rectHeight;\n    }\n\n    updateIndicators() {\n      this.renderIndicatorCategoryAxis();\n      this.renderIndicatorLegend();\n      this.renderIndicatorPoints();\n    }\n\n    updateLoadIndicator() {\n      const [left, top] = this.position;\n      this.pLoading.position.x = left + 6;\n      this.pLoading.position.y = top + 6;\n\n      if (this.fetching.size) {\n        this.pLoading.addChild(this.loadIndicator);\n      } else {\n        this.pLoading.removeChild(this.loadIndicator);\n      }\n    }\n\n    // Called whenever a new tile comes in\n    updateExistingGraphics() {\n      this.updateLoadIndicator();\n      if (!this.hasFetchedTiles()) return;\n      this.updateScales();\n      this.updateIndicators();\n    }\n\n    // Gets called on every draw call\n    drawTile(tile) {\n      tile.graphics.clear();\n\n      this.updateLoadIndicator();\n\n      if (!this.options.stratification.axisNoGroupColor) {\n        let yStart = 0;\n        let yEnd = 0;\n        this.groupSizes.forEach((size, i) => {\n          yEnd += this.categoryHeightScale(size);\n\n          tile.graphics.beginFill(this.groupToColor.get(i)[1]);\n          tile.graphics.drawRect(\n            0,\n            yStart,\n            this.dimensions[0],\n            Math.abs(yEnd - yStart)\n          );\n\n          yStart = yEnd;\n        });\n        tile.graphics.endFill();\n      }\n    }\n\n    getElementAtPosition(relX, relY) {\n      if (!this.tilesetInfo) return undefined;\n\n      const zoomLevel = this.calculateZoomLevel();\n      const tileWidth = tileProxy.calculateTileWidth(\n        this.tilesetInfo,\n        zoomLevel,\n        this.tilesetInfo.tile_size\n      );\n\n      // the position of the tile containing the query position\n      const tileId = this.tileToLocalId([\n        zoomLevel,\n        Math.floor(this._xScale.invert(relX) / tileWidth),\n      ]);\n      const fetchedTile = this.fetchedTiles[tileId];\n\n      if (!fetchedTile) return undefined;\n\n      const category = this.yToCategory.get(\n        Math.floor(this.categoryHeightScale.invert(relY))\n      );\n\n      const xAbsLo = this._xScale.invert(relX - 1);\n      const xAbsHi = this._xScale.invert(relX + 1);\n\n      let foundItem;\n      fetchedTile.intervalTree.search([xAbsLo, xAbsHi]).forEach((idx) => {\n        const item = fetchedTile.tileData[idx];\n        if (this.getCategory(item) === category) {\n          foundItem = item;\n          return true;\n        }\n        return false;\n      });\n\n      return {\n        item: foundItem,\n        category,\n        tileId,\n      };\n    }\n\n    getMouseOverHtml(relX, relY) {\n      const element = this.getElementAtPosition(relX, relY);\n\n      if (!element) return '';\n\n      const { item, category } = element;\n\n      if (item) {\n        const [, bg, text] = this.groupToColor.get(\n          this.categoryToGroup.get(category)\n        );\n        const colorHex = `#${text.toString(16)}`;\n        const bgHex = `#${bg.toString(16)}`;\n        const value = this.getImportance(item).toFixed(2);\n        return `<div style=\"margin: -0.25rem; padding: 0 0.25rem; background: ${bgHex}\"><strong style=\"color: ${colorHex};\">${category}:</strong> ${value}</div>`;\n      }\n\n      return '';\n    }\n\n    clickHandler(event) {\n      const [offsetX, offsetY] = this.position;\n      const relX = event.data.global.x - offsetX;\n      const relY = event.data.global.y - offsetY;\n\n      const element = this.getElementAtPosition(relX, relY);\n\n      if (element) {\n        this.pubSub.publish('app.click', {\n          type: 'annotation',\n          event,\n          payload: element,\n        });\n      }\n    }\n\n    setPosition(newPosition) {\n      super.setPosition(newPosition);\n\n      [this.pMain.position.x, this.pMain.position.y] = this.position;\n    }\n\n    zoomed(newXScale, newYScale) {\n      this.xScale(newXScale);\n      this.yScale(newYScale);\n\n      if (this.indicatorPointGraphics) {\n        scaleScalableGraphics(\n          this.indicatorPointGraphics,\n          newXScale,\n          this.drawnAtScale\n        );\n      }\n\n      this.refreshTiles();\n      this.draw();\n    }\n\n    refreshTiles() {\n      super.refreshTiles();\n      this.updateLoadIndicator();\n    }\n\n    renderIndicatorCategoryAxisAsSvg() {\n      const gAxis = document.createElement('g');\n      gAxis.setAttribute('id', 'axis');\n\n      const [width] = this.dimensions;\n      const [left, top] = this.position;\n\n      this.pAxis.position.x = this.axisAlign === 'right' ? left + width : left;\n      this.pAxis.position.y = top;\n\n      gAxis.setAttribute(\n        'transform',\n        `translate(${this.pAxis.position.x}, ${this.pAxis.position.y})`\n      );\n\n      let yStart = 0;\n      let yEnd = 0;\n\n      const xTickOffset = this.axisAlign === 'right' ? -5 : 5;\n      const xTickEnd = this.axisAlign === 'right' ? -width : width;\n      const xLabelOffset = this.axisAlign === 'right' ? -3 : 3;\n\n      const createRect = (x, y, w, h, f, o) => {\n        const r = document.createElement('rect');\n\n        r.setAttribute('x', x);\n        r.setAttribute('y', y);\n        r.setAttribute('width', w);\n        r.setAttribute('height', h);\n        r.setAttribute('fill', f);\n        r.setAttribute('fill-opacity', o);\n        r.setAttribute('stroke-width', 0);\n\n        return r;\n      };\n\n      const createText = (pixiText) => {\n        const t = document.createElement('text');\n\n        t.setAttribute('x', pixiText.x);\n        t.setAttribute('y', pixiText.y + pixiText.height / (4 / 1));\n        t.setAttribute('fill', pixiText._style._fill);\n        t.setAttribute(\n          'text-anchor',\n          pixiText._style._align === 'right' ? 'end' : 'start'\n        );\n        t.setAttribute('style', `font: ${pixiText._font};`);\n\n        t.textContent = pixiText.text;\n\n        return t;\n      };\n\n      const createLine = ({\n        stroke = '#000000',\n        strokeWidth = 1,\n        strokeDasharray = null,\n      } = {}) => (x1, y1, x2, y2) => {\n        const l = document.createElement('line');\n\n        l.setAttribute('x1', x1);\n        l.setAttribute('y1', y1);\n        l.setAttribute('x2', x2);\n        l.setAttribute('y2', y2);\n        l.setAttribute('stroke', stroke);\n        l.setAttribute('stroke-width', strokeWidth);\n\n        if (strokeDasharray)\n          l.setAttribute('stroke-dasharray', strokeDasharray);\n\n        return l;\n      };\n\n      const createDashedLine = createLine({ strokeDasharray: '5' });\n\n      const isHighlighting = this.options.focusStyle === 'highlighting';\n      const backgroundOpacity = 0.66;\n\n      this.groupLabelsPixiText.forEach((labelPixiText, i) => {\n        const height = this.categoryHeightScale(this.groupSizes[i]);\n        yEnd += height;\n        labelPixiText.x = xLabelOffset;\n        labelPixiText.y = yStart + height / 2;\n\n        // Background color\n        const backgroundColor = isHighlighting\n          ? '#ffffff'\n          : `#${this.groupToColor.get(i)[1].toString(16)}`;\n\n        if (this.axisAlign === 'right') {\n          gAxis.appendChild(\n            createRect(\n              labelPixiText.x - labelPixiText.width,\n              labelPixiText.y - labelPixiText.height / (4 / 1),\n              labelPixiText.width,\n              labelPixiText.height,\n              backgroundColor,\n              backgroundOpacity\n            )\n          );\n        } else {\n          gAxis.appendChild(\n            createRect(\n              labelPixiText.x,\n              labelPixiText.y - labelPixiText.height / (4 / 1),\n              labelPixiText.width,\n              labelPixiText.height,\n              backgroundColor,\n              backgroundOpacity\n            )\n          );\n        }\n\n        gAxis.appendChild(createText(labelPixiText));\n\n        gAxis.appendChild(createLine()(0, yStart, xTickOffset, yStart));\n\n        if (this.options.stratification.axisShowGroupSeparator) {\n          gAxis.appendChild(createDashedLine(0, yStart, xTickEnd, yStart));\n        }\n\n        yStart = yEnd;\n      });\n\n      gAxis.appendChild(createLine()(0, 0, 0, yEnd));\n\n      if (this.options.stratification.axisShowGroupSeparator) {\n        gAxis.appendChild(createDashedLine(0, yEnd, xTickEnd, yEnd));\n      }\n\n      return gAxis;\n    }\n\n    /**\n     * Export an SVG representation of this track\n     *\n     * @returns {Array} The two returned DOM nodes are both SVG\n     * elements [base,track]. Base is a parent which contains track as a\n     * child. Track is clipped with a clipping rectangle contained in base.\n     *\n     */\n    exportSVG() {\n      let track = null;\n      let base = null;\n\n      [base, track] = super.superSVG();\n\n      base.setAttribute('class', 'exported-stratified-bed-track');\n      const output = document.createElement('g');\n\n      track.appendChild(output);\n      output.setAttribute(\n        'transform',\n        `translate(${this.position[0]},${this.position[1]})`\n      );\n\n      const isHighlighting = !!(\n        this.focusStyle === 'highlighting' &&\n        ((this.focusGene && this.getGene) ||\n          (this.focusRegion && this.getRegion))\n      );\n\n      const points = this.getPoints(isHighlighting);\n      const color = isHighlighting\n        ? this.options.markColorDehighlight || '#999999'\n        : this.options.markColor || 'black';\n      const colorHighlight = this.options.markColorHighlight || 'red';\n\n      points.forEach(({ cX, y, widthHalf, opacity, highlight, height }, i) => {\n        const r = document.createElement('rect');\n\n        r.setAttribute('x', cX - widthHalf);\n        r.setAttribute('y', y);\n        r.setAttribute('width', widthHalf * 2);\n        r.setAttribute('height', height);\n        r.setAttribute('fill', highlight ? colorHighlight : color);\n        r.setAttribute('fill-opacity', opacity);\n        r.setAttribute('stroke-width', 0);\n\n        output.appendChild(r);\n      });\n\n      base.appendChild(this.renderIndicatorCategoryAxisAsSvg());\n\n      return [base, track];\n    }\n  }\n\n  return new StratifiedBedTrack(...args);\n};\n\nconst icon =\n  '<svg viewBox=\"0 0 16 16\" xmlns=\"http://www.w3.org/2000/svg\" fill-rule=\"evenodd\" clip-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"1.5\"><path d=\"M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268\" fill=\"none\" stroke=\"currentColor\"/><path d=\"M10.5 3.5v12\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-dasharray=\"1,2,0,0\"/><path d=\"M5.5 13.5V6\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-width=\".9969299999999999\" stroke-dasharray=\"1.71,3.43,0,0\"/><path d=\"M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z\" fill=\"currentColor\"/><path d=\"M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z\" fill=\"currentColor\"/></svg>';\n\ncreateStratifiedBedTrack.config = {\n  type: 'stratified-bed',\n  datatype: ['arcs', 'bedlike'],\n  orientation: '1d',\n  name: 'Arcs1D',\n  thumbnail: new DOMParser().parseFromString(icon, 'text/xml').documentElement,\n  availableOptions: [\n    'arcStyle',\n    'flip1D',\n    'labelPosition',\n    'labelColor',\n    'labelTextOpacity',\n    'labelBackgroundOpacity',\n    'trackBorderWidth',\n    'trackBorderColor',\n  ],\n  defaultOptions: {\n    arcStyle: 'ellipse',\n    flip1D: 'no',\n    labelColor: 'black',\n    labelPosition: 'hidden',\n    trackBorderWidth: 0,\n    trackBorderColor: 'black',\n  },\n  optionsInfo: {\n    arcStyle: {\n      name: 'Arc Style',\n      inlineOptions: {\n        circle: {\n          name: 'Circle',\n          value: 'circle',\n        },\n        ellipse: {\n          name: 'Ellipse',\n          value: 'ellipse',\n        },\n      },\n    },\n  },\n};\n\nexport default createStratifiedBedTrack;\n","const MAX_RADIUS = 2;\nconst MAX_RADIUS_EXTENSION = 2;\n\n// const VS = `\n//   attribute vec2 aPosition;\n\n//   uniform mat3 projectionMatrix;\n//   uniform mat3 translationMatrix;\n//   uniform float uPointSize;\n//   uniform vec4 uColor;\n\n//   varying vec4 vColor;\n\n//   void main(void)\n//   {\n//     vColor = uColor;\n//     gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n//     gl_PointSize = uPointSize;\n//   }\n// `;\n\n// const FS_ROUND = `\n//   #ifdef GL_OES_standard_derivatives\n//   #extension GL_OES_standard_derivatives : enable\n//   #endif\n\n//   precision mediump float;\n\n//   varying vec4 vColor;\n\n//   void main() {\n//     float r = 0.0, delta = 0.0, alpha = 1.0;\n//     vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n//     r = dot(cxy, cxy);\n\n//     #ifdef GL_OES_standard_derivatives\n//       delta = fwidth(r);\n//       alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n//     #endif\n\n//     gl_FragColor = vec4(vColor.rgb, alpha * vColor.a);\n//   }\n// `;\n\n// const FS_SQUARE = `\n//   precision mediump float;\n//   varying vec4 vColor;\n\n//   void main() {\n//     gl_FragColor = vec4(vColor.rgb, vColor.a);\n//   }\n// `;\n\n// const DEFAULT_GROUP_COLORS = [\n//   '#c17da5',\n//   '#c76526',\n//   '#dca237',\n//   '#eee462',\n//   '#469b76',\n//   '#3170ad',\n//   '#6fb2e4',\n//   '#000000',\n//   '#999999',\n// ];\n\n// const DEFAULT_GROUP_COLORS_DARK = [\n//   '#a1688a',\n//   '#a65420',\n//   '#b7872e',\n//   '#9f9841',\n//   '#3a8162',\n//   '#295d90',\n//   '#4a7798',\n//   '#000000',\n//   '#666666',\n// ];\n\n// const DEFAULT_GROUP_COLORS_LIGHT = [\n//   '#f5e9f0',\n//   '#f6e5db',\n//   '#f9f0de',\n//   '#fcfbe5',\n//   '#e0eee8',\n//   '#dde7f1',\n//   '#e7f2fb',\n//   '#d5d5d5',\n//   '#ffffff',\n// ];\n\n// const scaleScalableGraphics = (graphics, xScale, drawnAtScale) => {\n//   const tileK =\n//     (drawnAtScale.domain()[1] - drawnAtScale.domain()[0]) /\n//     (xScale.domain()[1] - xScale.domain()[0]);\n//   const newRange = xScale.domain().map(drawnAtScale);\n\n//   const posOffset = newRange[0];\n//   graphics.scale.x = tileK;\n//   graphics.position.x = -posOffset * tileK;\n// };\n\nconst createSnpTrack = function createSnpTrack(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  const { range } = HGC.libraries.d3Array;\n  const { scaleBand } = HGC.libraries.d3Scale;\n  const { tileProxy } = HGC.services;\n  const { colorToHex } = HGC.utils;\n\n  class SnpTrack extends HGC.tracks.BedLikeTrack {\n    setValueScale() {\n      this.valueScale = null;\n      if (this.options && this.options.valueColumn) {\n        const min = this.options.colorEncodingRange\n          ? +this.options.colorEncodingRange[0]\n          : this.minVisibleValueInTiles(+this.options.valueColumn);\n        const max = this.options.colorEncodingRange\n          ? +this.options.colorEncodingRange[1]\n          : this.maxVisibleValueInTiles(+this.options.valueColumn);\n\n        if (this.options.valueColumn) {\n          [this.valueScale] = this.makeValueScale(\n            min,\n            this.calculateMedianVisibleValue(+this.options.valueColumn),\n            max,\n            2\n          );\n        }\n      }\n    }\n\n    finalDotYPos(y, r) {\n      return Math.max(r, Math.min(this.dimensions[1] - r, y));\n    }\n\n    drawPoly(tile, xStartPos, xEndPos, rectY, doubleRadius = false) {\n      // prettier-ignore\n      const drawnPoly = [\n        // left top\n        xStartPos, rectY,\n        // right top\n        xEndPos, rectY,\n        // right bottom\n        xEndPos, this.dimensions[1],\n         // left bottom\n        xStartPos, this.dimensions[1]\n      ];\n\n      const anchorRadius = Math.max(MAX_RADIUS, xEndPos - xStartPos);\n      const radius = anchorRadius * (1 + MAX_RADIUS_EXTENSION * doubleRadius);\n\n      tile.rectGraphics.drawCircle(\n        xStartPos,\n        this.finalDotYPos(rectY, anchorRadius),\n        radius\n      );\n\n      return drawnPoly;\n    }\n\n    renderRows(tile, rows, maxRows, startY, endY, fill) {\n      const zoomLevel = +tile.tileId.split('.')[0];\n\n      this.initialize();\n\n      const rowScale = scaleBand()\n        .domain(range(maxRows))\n        .range([startY, endY])\n        .paddingInner(0);\n\n      const focusRegion = this.options.focusRegion || [Infinity, Infinity];\n\n      const circleDraws = [];\n      const circleFocusDraws = [];\n\n      for (let j = 0; j < rows.length; j++) {\n        for (let i = 0; i < rows[j].length; i++) {\n          const td = rows[j][i].value;\n          const geneInfo = td.fields;\n\n          // the returned positions are chromosome-based and they need to\n          // be converted to genome-based\n          const chrOffset = +td.chrOffset;\n          const txStart = +geneInfo[1] + chrOffset;\n          const txEnd = +geneInfo[2] + chrOffset;\n          let yMiddle = rowScale(j) + rowScale.step() / 2;\n\n          if (this.valueScale) {\n            yMiddle = this.valueScale(+geneInfo[+this.options.valueColumn - 1]);\n          }\n\n          const rectY = yMiddle;\n          const xStartPos = this._xScale(txStart);\n          const xEndPos = this._xScale(txEnd);\n\n          // don't draw anything that has already been drawn\n          if (\n            !(\n              zoomLevel in this.drawnRects &&\n              td.uid in this.drawnRects[zoomLevel]\n            )\n          ) {\n            if (!this.drawnRects[zoomLevel]) this.drawnRects[zoomLevel] = {};\n\n            const circleDraw = [xStartPos, xEndPos, rectY, td, txStart, txEnd];\n\n            if (txStart <= focusRegion[1] && txEnd >= focusRegion[0]) {\n              circleFocusDraws.push(circleDraw);\n            } else {\n              circleDraws.push(circleDraw);\n            }\n          }\n        }\n\n        // 1. draw white background to make clicking easier\n        tile.rectGraphics.lineStyle(0);\n        tile.rectGraphics.beginFill(0xffffff);\n        circleDraws.forEach((circleDraw) => {\n          this.drawPoly(\n            tile,\n            circleDraw[0],\n            circleDraw[1],\n            circleDraw[2],\n            true\n          );\n        });\n\n        // 2. Now draw the normal circles\n        let color = this.options.markColor || 'black';\n        let opacity = this.options.fillOpacity || 0.3;\n        tile.rectGraphics.lineStyle(1, colorToHex(color), opacity);\n        tile.rectGraphics.beginFill(colorToHex(color), opacity);\n        circleDraws.forEach((circleDraw) => {\n          const drawnPoly = this.drawPoly(\n            tile,\n            circleDraw[0],\n            circleDraw[1],\n            circleDraw[2]\n          );\n          this.drawnRects[zoomLevel][circleDraw[4].uid] = [\n            drawnPoly,\n            {\n              start: circleDraw[4],\n              end: circleDraw[5],\n              value: circleDraw[3],\n              tile,\n              fill,\n            },\n            tile.tileId,\n          ];\n        });\n\n        // 2. Now draw the focused circles\n        color = this.options.markColorFocus || 'red';\n        opacity = this.options.markOpacityFocus || 0.6;\n        tile.rectGraphics.lineStyle(1, colorToHex(color), opacity);\n        tile.rectGraphics.beginFill(colorToHex(color), opacity);\n        circleFocusDraws.forEach((circleDraw) => {\n          const drawnPoly = this.drawPoly(\n            tile,\n            circleDraw[0],\n            circleDraw[1],\n            circleDraw[2]\n          );\n          this.drawnRects[zoomLevel][circleDraw[4].uid] = [\n            drawnPoly,\n            {\n              start: circleDraw[4],\n              end: circleDraw[5],\n              value: circleDraw[3],\n              tile,\n              fill,\n            },\n            tile.tileId,\n          ];\n        });\n        tile.rectGraphics.endFill();\n      }\n\n      tile.rectGraphics.interactive = true;\n      tile.rectGraphics.buttonMode = true;\n      tile.rectGraphics.mouseup = (event) => {\n        if (this.hoveringSnp) {\n          this.pubSub.publish('app.click', {\n            type: 'snp',\n            event,\n            payload: this.hoveringSnp,\n          });\n        }\n      };\n\n      return [circleDraws, circleFocusDraws];\n    }\n\n    /**\n     * Shows value and type for each bar\n     *\n     * @param trackX relative x-coordinate of mouse\n     * @param trackY relative y-coordinate of mouse\n     * @returns string with embedded values and svg square for color\n     */\n    getMouseOverHtml(trackX, trackY) {\n      this.hoveringSnp = undefined;\n\n      if (!this.tilesetInfo || !this.options.toolTip || !this.valueScale)\n        return '';\n\n      const zoomLevel = this.calculateZoomLevel();\n      const tileWidth = tileProxy.calculateTileWidth(\n        this.tilesetInfo,\n        zoomLevel,\n        this.tilesetInfo.tile_size\n      );\n\n      // the position of the tile containing the query position\n      const genomePos = this._xScale.invert(trackX);\n      const relTilePos = genomePos / tileWidth;\n      const tilePos = Math.floor(relTilePos);\n      const tileId = this.tileToLocalId([zoomLevel, tilePos]);\n      const fetchedTile = this.fetchedTiles[tileId];\n\n      if (!fetchedTile) return '';\n\n      let minDist = 3;\n      fetchedTile.tileData.forEach((item) => {\n        const dist = Math.abs(this._xScale(item.xStart) - trackX);\n        if (dist < minDist) {\n          this.hoveringSnp = item;\n          minDist = dist;\n        }\n      });\n\n      if (!this.hoveringSnp) return '';\n\n      const itemY = this.finalDotYPos(\n        this.valueScale(this.hoveringSnp.importance),\n        2\n      );\n\n      if (\n        Math.abs(itemY - (trackY - 1)) >\n        MAX_RADIUS * (MAX_RADIUS_EXTENSION + 1)\n      )\n        return '';\n\n      const name = this.hoveringSnp.fields[this.options.toolTip.name.field];\n      const value = (+this.hoveringSnp.fields[\n        this.options.toolTip.value.field\n      ]).toFixed(this.options.toolTip.value.numDecimals || 2);\n      let otherStr = '';\n\n      if (this.options.toolTip.other) {\n        this.options.toolTip.other.forEach((other) => {\n          const label = other.label || '';\n          const v = (+this.hoveringSnp.fields[other.field]).toFixed(\n            other.numDecimals || 2\n          );\n          otherStr += `${label}: ${v};`;\n        });\n        otherStr = ` (${otherStr.substr(0, otherStr.length - 1)})`;\n      }\n\n      return `<div><strong>${name}:</strong> ${value}${otherStr}</div>`;\n    }\n\n    /**\n     * Export an SVG representation of this track\n     *\n     * @returns {Array} The two returned DOM nodes are both SVG\n     * elements [base,track]. Base is a parent which contains track as a\n     * child. Track is clipped with a clipping rectangle contained in base.\n     *\n     */\n    exportSVG() {\n      let track = null;\n      let base = null;\n\n      [base, track] = super.exportSVG();\n\n      base.setAttribute('class', 'exported-snp-track');\n      const output = document.createElement('g');\n\n      track.appendChild(output);\n      output.setAttribute(\n        'transform',\n        `translate(${this.position[0]},${this.position[1]})`\n      );\n\n      this.visibleAndFetchedTiles()\n        .filter((tile) => tile.plusStrandRows)\n        .forEach((tile) => {\n          // call drawTile with storePolyStr = true so that\n          // we record path strings to use in the SVG\n          const [circles, focusedCircles] = this.renderRows(\n            tile,\n            tile.plusStrandRows,\n            tile.plusStrandRows.length,\n            0,\n            this.dimensions[1],\n            'blue'\n          );\n\n          circles.forEach((circle) => {\n            const c = document.createElement('circle');\n            c.setAttribute('fill', this.options.markColor || 'black');\n            c.setAttribute('stroke-width', 0);\n            c.setAttribute('opacity', this.options.markOpacity || 0.33);\n            c.setAttribute('r', this.options.markSize);\n            c.setAttribute('cx', circle[0]);\n            c.setAttribute('cy', circle[2]);\n            output.appendChild(c);\n          });\n\n          focusedCircles.forEach((circle) => {\n            const c = document.createElement('circle');\n            c.setAttribute('fill', this.options.markColorFocus || 'red');\n            c.setAttribute('stroke-width', 0);\n            c.setAttribute('opacity', this.options.markOpacityFocus || 0.66);\n            c.setAttribute('r', this.options.markSize + 1);\n            c.setAttribute('cx', circle[0]);\n            c.setAttribute('cy', circle[2]);\n            output.appendChild(c);\n          });\n        });\n\n      const gAxis = document.createElement('g');\n      gAxis.setAttribute('id', 'axis');\n\n      // append the axis to base so that it's not clipped\n      base.appendChild(gAxis);\n      gAxis.setAttribute(\n        'transform',\n        `translate(${this.axis.pAxis.position.x}, ${this.axis.pAxis.position.y})`\n      );\n\n      if (\n        this.options.axisPositionHorizontal === 'left' ||\n        this.options.axisPositionVertical === 'top'\n      ) {\n        const gDrawnAxis = this.axis.exportAxisLeftSVG(\n          this.valueScale,\n          this.dimensions[1]\n        );\n        gAxis.appendChild(gDrawnAxis);\n      } else if (\n        this.options.axisPositionHorizontal === 'right' ||\n        this.options.axisPositionVertical === 'bottom'\n      ) {\n        const gDrawnAxis = this.axis.exportAxisRightSVG(\n          this.valueScale,\n          this.dimensions[1]\n        );\n        gAxis.appendChild(gDrawnAxis);\n      }\n\n      return [base, track];\n    }\n  }\n\n  return new SnpTrack(...args);\n};\n\nconst icon =\n  '<svg viewBox=\"0 0 16 16\" xmlns=\"http://www.w3.org/2000/svg\" fill-rule=\"evenodd\" clip-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"1.5\"><path d=\"M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268\" fill=\"none\" stroke=\"currentColor\"/><path d=\"M10.5 3.5v12\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-dasharray=\"1,2,0,0\"/><path d=\"M5.5 13.5V6\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-width=\".9969299999999999\" stroke-dasharray=\"1.71,3.43,0,0\"/><path d=\"M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z\" fill=\"currentColor\"/><path d=\"M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z\" fill=\"currentColor\"/></svg>';\n\ncreateSnpTrack.config = {\n  type: 'point-annotation',\n  datatype: ['arcs', 'bedlike'],\n  orientation: '1d',\n  name: 'Arcs1D',\n  thumbnail: new DOMParser().parseFromString(icon, 'text/xml').documentElement,\n  availableOptions: [\n    'arcStyle',\n    'flip1D',\n    'labelPosition',\n    'labelColor',\n    'labelTextOpacity',\n    'labelBackgroundOpacity',\n    'strokeColor',\n    'strokeWidth',\n    'trackBorderWidth',\n    'trackBorderColor',\n  ],\n  defaultOptions: {\n    arcStyle: 'ellipse',\n    flip1D: 'no',\n    labelColor: 'black',\n    labelPosition: 'hidden',\n    strokeColor: 'black',\n    strokeWidth: 1,\n    trackBorderWidth: 0,\n    trackBorderColor: 'black',\n  },\n  optionsInfo: {\n    arcStyle: {\n      name: 'Arc Style',\n      inlineOptions: {\n        circle: {\n          name: 'Circle',\n          value: 'circle',\n        },\n        ellipse: {\n          name: 'Ellipse',\n          value: 'ellipse',\n        },\n      },\n    },\n  },\n};\n\nexport default createSnpTrack;\n","import {\n  DEFAULT_COLOR_MAP,\n  DEFAULT_COLOR_MAP_DARK,\n  DEFAULT_COLOR_MAP_LIGHT,\n} from './constants';\nimport { createColorTexture } from './utils';\n\nconst DEFAULT_TILE_SIZE = 1024;\n\nconst DEFAULT_BIN_SIZE = 8; // 8 \"tile-pixels\" make up one bin by default\n\nconst VS = `\nprecision mediump float;\nattribute vec2 aPosition;\nattribute float aColorIdx;\nattribute float aFocused;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform sampler2D uColorMapTex;\nuniform float uColorMapTexRes;\nuniform sampler2D uColorMapFocusTex;\nuniform float uColorMapFocusTexRes;\n\nvarying vec4 vColor;\nvarying vec4 vColorFocused;\nvarying float vFocused;\n\nvoid main(void)\n{\n  // Half a texel (i.e., pixel in texture coordinates)\n  float eps = 0.5 / uColorMapTexRes;\n  float colorRowIndex = floor((aColorIdx + eps) / uColorMapTexRes);\n  vec2 colorTexIndex = vec2(\n    (aColorIdx / uColorMapTexRes) - colorRowIndex + eps,\n    (colorRowIndex / uColorMapTexRes) + eps\n  );\n  vColor = texture2D(uColorMapTex, colorTexIndex);\n\n  float eps2 = 0.5 / uColorMapFocusTexRes;\n  float colorRowIndex2 = floor((aColorIdx + eps2) / uColorMapFocusTexRes);\n  vec2 colorTexIndex2 = vec2(\n    (aColorIdx / uColorMapFocusTexRes) - colorRowIndex2 + eps2,\n    (colorRowIndex2 / uColorMapFocusTexRes) + eps2\n  );\n  vColorFocused = texture2D(uColorMapFocusTex, colorTexIndex2);\n\n  vFocused = aFocused;\n\n  gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n}\n`;\n\nconst FS = `\n  precision mediump float;\n\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vFocused;\n\n  void main() {\n    float isNotFocused = 1.0 - vFocused;\n\n    float r = vColor.r * isNotFocused + vColorFocused.r * vFocused;\n    float g = vColor.g * isNotFocused + vColorFocused.g * vFocused;\n    float b = vColor.b * isNotFocused + vColorFocused.b * vFocused;\n\n    gl_FragColor = vec4(r, g, b, 1.0);\n  }\n`;\n\nconst getIs2d = (tile) =>\n  tile.tileData.length && tile.tileData[0].yStart !== undefined;\n\nconst get1dStart = (item) => item.xStart;\n\nconst get2dStart = (item) => item.xStart + (item.xEnd - item.xStart) / 2;\n\nconst get1dEnd = (item) => item.xEnd;\n\nconst get2dEnd = (item) => item.yStart + (item.yEnd - item.yStart) / 2;\n\nconst getHistMax = (fetchedTiles) =>\n  fetchedTiles.reduce(\n    (histMax, tile) => Math.max(histMax, tile.histogramMax),\n    0\n  );\n\nconst scaleScalableGraphics = (graphics, xScale, drawnAtScale) => {\n  const tileK =\n    (drawnAtScale.domain()[1] - drawnAtScale.domain()[0]) /\n    (xScale.domain()[1] - xScale.domain()[0]);\n  const newRange = xScale.domain().map(drawnAtScale);\n\n  const posOffset = newRange[0];\n  graphics.scale.x = tileK;\n  graphics.position.x = -posOffset * tileK;\n};\n\n// prettier-ignore\nconst segmentToPosition = (segment) => [\n  segment.xStart, segment.yStart,\n  segment.xEnd, segment.yStart,\n  segment.xEnd, segment.yEnd,\n  segment.xStart, segment.yStart,\n  segment.xStart, segment.yEnd,\n  segment.xEnd, segment.yEnd,\n];\n\nconst segmentToColorIdx = (segment) => [\n  segment.colorIdx,\n  segment.colorIdx,\n  segment.colorIdx,\n  segment.colorIdx,\n  segment.colorIdx,\n  segment.colorIdx,\n];\n\nconst segmentToFocused = (segment) => [\n  segment.focused,\n  segment.focused,\n  segment.focused,\n  segment.focused,\n  segment.focused,\n  segment.focused,\n];\n\nconst createStackedBarTrack = function createStackedBarTrack(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  const { PIXI } = HGC.libraries;\n  const { scaleLinear, scaleLog } = HGC.libraries.d3Scale;\n  const { tileProxy } = HGC.services;\n  const { colorToHex } = HGC.utils;\n\n  const opacityLogScale = scaleLog()\n    .domain([1, 10])\n    .range([0.1, 1])\n    .clamp(true);\n\n  const toRgbNorm = (color) =>\n    HGC.utils\n      .colorToRgba(color)\n      .slice(0, 3)\n      .map((x) => Math.min(1, Math.max(0, x / 255)));\n\n  class StackedBarTrack extends HGC.tracks.HorizontalLine1DPixiTrack {\n    constructor(context, options) {\n      super(context, options);\n\n      this.updateOptions();\n\n      this.pLoading = new PIXI.Graphics();\n      this.pLoading.position.x = 0;\n      this.pLoading.position.y = 0;\n      this.pMasked.addChild(this.pLoading);\n\n      this.loadIndicator = new PIXI.Text('Loading data...', {\n        fontSize: this.labelSize || 10,\n        fill: 0x808080,\n      });\n      this.pLoading.addChild(this.loadIndicator);\n    }\n\n    initTile(tile) {\n      const is2d = getIs2d(tile);\n      const getStart = is2d ? get2dStart : get1dStart;\n      const getEnd = is2d ? get2dEnd : get1dEnd;\n\n      tile.tileData.forEach((item) => {\n        item.start = getStart(item);\n        item.end = getEnd(item);\n        item.isLeftToRight = item.start < item.end;\n      });\n\n      tile.histogramMax = 0;\n\n      this.updateTileFocusMap(tile);\n    }\n\n    updateTileHistogram(tile) {\n      const { tileX, tileWidth } = this.getTilePosAndDimensions(\n        tile.tileData.zoomLevel,\n        tile.tileData.tilePos\n      );\n      const binSize = tileWidth / this.numBins;\n\n      tile.binXPos = new Float32Array(this.numBins + 1);\n      tile.histogram1d = new Float32Array(this.numBins);\n      tile.histogram2d = new Float32Array(this.numBins * this.numGroups);\n      tile.histogram2dNumPred = new Uint8Array(this.numBins * this.numGroups);\n\n      let max = 0;\n\n      // Determine bin boundaries\n      for (let i = 0; i <= this.numBins; i++) {\n        tile.binXPos[i] = tileX + binSize * i;\n      }\n\n      const categoryBinHash = new Map();\n      const maxBinId = this.numBins - 1;\n\n      tile.tileData.filter(this.itemFilter).forEach((item) => {\n        const group = this.categoryToGroup.get(\n          item.fields[this.categoryField].toLowerCase()\n        );\n        const binStart = Math.max(\n          0,\n          Math.min(\n            maxBinId,\n            Math.round((this.getStart(item) - tileX) / binSize)\n          )\n        );\n        const binEnd = Math.max(\n          0,\n          Math.min(maxBinId, Math.round((this.getEnd(item) - tileX) / binSize))\n        );\n        const numBins = Math.abs(binEnd - binStart);\n        const score = this.getImportance(item);\n        const category = this.getCategory(item);\n        const base = group * this.numBins;\n\n        for (let i = 0; i <= numBins; i++) {\n          const bin = binStart + i;\n          const histIdx = base + bin;\n\n          const binHash = categoryBinHash.get(category) || {};\n\n          // Make sure we count multiple enhancer predictions of the same\n          // biosample and bin only once (i.e., summing up)\n          if (!binHash[bin]) {\n            binHash[bin] = binHash[bin] || score > 0;\n            tile.histogram2dNumPred[histIdx] += binHash[bin];\n            categoryBinHash.set(category, binHash);\n          }\n\n          tile.histogram2d[histIdx] += score;\n          tile.histogram1d[bin] += score;\n\n          max = Math.max(max, tile.histogram1d[bin]);\n        }\n      });\n\n      tile.histogramMax = max;\n    }\n\n    updateHistograms() {\n      Object.values(this.fetchedTiles).forEach(\n        this.updateTileHistogram.bind(this)\n      );\n    }\n\n    updateTileFocusMap(tile) {\n      tile.focusMap = new Float32Array(this.numBins);\n\n      const { tileX, tileWidth } = this.getTilePosAndDimensions(\n        tile.tileData.zoomLevel,\n        tile.tileData.tilePos\n      );\n\n      if (\n        tileX <= this.focusRegion[1] &&\n        tileX + tileWidth >= this.focusRegion[0]\n      ) {\n        const binSize = tileWidth / this.numBins;\n\n        const binStart = Math.max(\n          0,\n          Math.round((this.focusRegion[0] - tileX) / binSize)\n        );\n        const binEnd = Math.min(\n          this.numBins - 1,\n          Math.round((this.focusRegion[1] - tileX) / binSize)\n        );\n        const numBins = Math.abs(binEnd - binStart);\n\n        for (let i = 0; i <= numBins; i++) {\n          tile.focusMap[i] = 1;\n        }\n      }\n    }\n\n    updateFocusMap() {\n      Object.values(this.fetchedTiles).forEach(\n        this.updateTileFocusMap.bind(this)\n      );\n    }\n\n    updateStratificationOption() {\n      if (!this.options.stratification) {\n        this.categoryField = undefined;\n        this.categoryToGroup = undefined;\n        this.groupToColor = undefined;\n        this.numGroups = 0;\n        this.numFilteredGroups = 0;\n        this.numCategories = 0;\n        this.groupLabels = [];\n        return;\n      }\n\n      this.categoryField = this.options.stratification.categoryField;\n      this.getCategory = (item) =>\n        item.fields[this.categoryField].toLowerCase();\n      this.categoryToGroup = new Map();\n      this.categoryToY = new Map();\n      this.groupToColor = new Map();\n\n      this.groupSizes = this.options.stratification.groups.map(\n        (group) =>\n          group.categories.filter((category) => this.valueFilter(category))\n            .length\n      );\n      this.filteredGroups = this.options.stratification.groups.filter(\n        (group, i) => this.groupSizes[i] > 0\n      );\n      this.numGroups = this.options.stratification.groups.length;\n      this.numFilteredGroups = this.filteredGroups.length;\n      this.numCategories = this.groupSizes.reduce(\n        (numCategories, groupSize) => numCategories + groupSize,\n        0\n      );\n      this.groupLabels = this.options.stratification.groups.map(\n        (group, i) => group.label || `Group ${i}`\n      );\n\n      let k = 0;\n      this.options.stratification.groups.forEach((group, i) => {\n        this.groupToColor.set(i, [\n          colorToHex(\n            group.color || DEFAULT_COLOR_MAP[i % DEFAULT_COLOR_MAP.length]\n          ),\n          colorToHex(\n            group.backgroundColor ||\n              DEFAULT_COLOR_MAP_LIGHT[i % DEFAULT_COLOR_MAP_LIGHT.length]\n          ),\n        ]);\n        group.categories\n          .filter((category) => this.valueFilter(category))\n          .forEach((category, j) => {\n            this.categoryToGroup.set(category.toLowerCase(), i);\n            this.categoryToY.set(category.toLowerCase(), k + j);\n          });\n        k += this.groupSizes[i];\n      });\n\n      this.groupLabelsPixiText = this.groupLabels.map(\n        (label, i) =>\n          new PIXI.Text(label, {\n            fontSize: this.labelSize,\n            // fill: this.labelColor,\n            align: this.axisAlign === 'right' ? 'right' : 'left',\n            fill: colorToHex(\n              this.options.stratification.groups[i].axisLabelColor ||\n                DEFAULT_COLOR_MAP_DARK[i % DEFAULT_COLOR_MAP_DARK.length]\n            ),\n          })\n      );\n    }\n\n    updateOptions() {\n      this.axisAlign = this.options.axisAlign || 'left';\n\n      this.labelColor = colorToHex(this.options.labelColor || 'black');\n\n      this.labelSize = this.options.labelSize || 12;\n\n      this.colorMap = this.options.colorMap || [...DEFAULT_COLOR_MAP];\n\n      this.colorMapRgbNorm = this.colorMap.map(toRgbNorm);\n\n      [this.colorMapTex, this.colorMapTexRes] = createColorTexture(\n        PIXI,\n        this.colorMapRgbNorm\n      );\n\n      this.colorMapFocus = this.options.colorMapFocus || [\n        ...DEFAULT_COLOR_MAP_DARK,\n      ];\n\n      this.colorMapFocusRgbNorm = this.colorMapFocus.map(toRgbNorm);\n\n      [this.colorMapFocusTex, this.colorMapFocusTexRes] = createColorTexture(\n        PIXI,\n        this.colorMapFocusRgbNorm\n      );\n\n      this.markColor = colorToHex(this.options.markColor || 'black');\n\n      this.markColorRgbNorm = this.options.markColor\n        ? toRgbNorm(this.options.markColor)\n        : [0, 0, 0];\n\n      this.markOpacity = Number.isNaN(+this.options.markOpacity)\n        ? 1\n        : Math.min(1, Math.max(0, +this.options.markOpacity));\n\n      this.markSize = this.options.markSize || 2;\n\n      this.markColorFocus = colorToHex(this.options.markColorFocus || 'red');\n\n      this.markColorFocusRgbNorm = this.options.markColorFocus\n        ? toRgbNorm(this.options.markColorFocus)\n        : [1, 0, 0];\n\n      this.markOpacityFocus = Number.isNaN(+this.options.markOpacityFocus)\n        ? this.markOpacity\n        : Math.min(1, Math.max(0, +this.options.markOpacityFocus));\n\n      this.markSizeFocus = this.options.markSizeFocus || this.markSize;\n\n      this.binSize = this.options.binSize || DEFAULT_BIN_SIZE;\n\n      this.numBins = this.tilesetInfo\n        ? Math.round(this.tilesetInfo.tile_size / this.binSize)\n        : DEFAULT_TILE_SIZE / this.binSize;\n\n      this.getOffset = this.options.offsetField\n        ? (item) => this.chromOffsets[item.fields[this.options.offsetField]]\n        : () => 0;\n\n      this.getStart = this.options.startField\n        ? (item) => this.getOffset(item) + +item.fields[this.options.startField]\n        : (item) => item.xStart;\n\n      this.getEnd = this.options.endField\n        ? (item) => this.getOffset(item) + +item.fields[this.options.endField]\n        : (item) => item.xEnd;\n\n      this.getImportance = this.options.importanceField\n        ? (item) => +item.fields[this.options.importanceField]\n        : () => 1;\n\n      const importanceDomain = this.options.importanceDomain || [1000, 1];\n\n      this.filterSet =\n        this.options.filter && this.options.filter.set\n          ? this.options.filter.set.reduce((s, include) => {\n              s.add(include);\n              return s;\n            }, new Set())\n          : null;\n\n      this.filterField = this.options.filter && this.options.filter.field;\n\n      this.valueFilter = this.filterSet\n        ? (value) => this.filterSet.has(value)\n        : () => true;\n\n      this.itemFilter =\n        this.valueFilter && this.filterField\n          ? (item) => this.valueFilter(item.fields[this.filterField])\n          : () => true;\n\n      const opacityLinearScale = scaleLinear()\n        .domain(importanceDomain)\n        .range([1, 10]);\n\n      this.opacityScale = (x) => opacityLogScale(opacityLinearScale(x));\n\n      this.focusRegion = this.options.focusRegion\n        ? this.options.focusRegion\n        : [Infinity, Infinity];\n\n      this.focusGene = this.options.focusGene\n        ? this.options.focusGene.toLowerCase()\n        : undefined;\n\n      this.minImportance = this.options.minImportance || 0;\n\n      this.updateStratificationOption();\n\n      this.updateFocusMap();\n      this.updateHistograms();\n      this.updateScales();\n    }\n\n    updateLoadIndicator() {\n      const [left, top] = this.position;\n      this.pLoading.position.x = left + 6;\n      this.pLoading.position.y = top + 6;\n\n      if (this.fetching.size) {\n        this.pLoading.addChild(this.loadIndicator);\n      } else {\n        this.pLoading.removeChild(this.loadIndicator);\n      }\n    }\n\n    computeChromOffets() {\n      if (!this.tilesetInfo) return;\n      const chroms = this.tilesetInfo.chrom_names.split('\\t');\n      const chromSizes = this.tilesetInfo.chrom_sizes\n        .split('\\t')\n        .map((size) => +size);\n      // eslint-disable-next-line prefer-destructuring\n      this.chromOffsets = chroms.reduce(\n        ([offsets, cumSum], chrom, i) => {\n          offsets[chrom] = cumSum;\n          return [offsets, cumSum + chromSizes[i]];\n        },\n        [{}, 0]\n      )[0];\n    }\n\n    refreshTiles(...brgs) {\n      super.refreshTiles(...brgs);\n      this.computeChromOffets();\n      this.updateLoadIndicator();\n      if (this.tilesetInfo) {\n        const oldNumBins = this.numBins;\n        this.numBins = Math.round(this.tilesetInfo.tile_size / this.binSize);\n        if (oldNumBins !== this.numBins) {\n          this.updateHistograms();\n          this.updateScales();\n        }\n      }\n    }\n\n    rerender(newOptions) {\n      this.options = newOptions;\n      this.updateOptions();\n      this.updateExistingGraphics();\n    }\n\n    updateScales() {\n      const fetchedTiles = Object.values(this.fetchedTiles);\n\n      if (!fetchedTiles.length) return;\n\n      const [, height] = this.dimensions;\n\n      this.histMax = getHistMax(fetchedTiles);\n\n      this.heightScale = scaleLinear()\n        .domain([0, this.histMax])\n        .range([height, 0]);\n\n      this.valueScale = this.heightScale;\n\n      this.valueScaleInverted = scaleLinear()\n        .domain([0, this.histMax])\n        .range([0, height]);\n    }\n\n    itemToPoint(item) {\n      return {\n        xStart: this._xScale(item.start),\n        xEnd: this._xScale(item.start),\n        yStart: this.heightScale(\n          this.categoryToY.get(item.fields[this.categoryField].toLowerCase())\n        ),\n        yEnd: () => {},\n        opacity: this.opacityScale(this.getImportance(item)),\n        focused:\n          item.xStart <= this.focusRegion[1] &&\n          item.xEnd >= this.focusRegion[0],\n      };\n    }\n\n    histToSegments(tile) {\n      const segments = [];\n\n      for (let i = 0; i < this.numBins; i++) {\n        let cumHeight = 0;\n        if (tile.histogram1d[i] > 0) {\n          for (let j = 0; j < this.numGroups; j++) {\n            const height = tile.histogram2d[j * this.numBins + i];\n\n            if (height) {\n              segments.push({\n                xStart: this._xScale(tile.binXPos[i]),\n                xEnd: this._xScale(tile.binXPos[i + 1]),\n                yStart: this.heightScale(cumHeight),\n                yEnd: this.heightScale(cumHeight + height),\n                colorIdx: j % this.colorMap.length,\n                focused: tile.focusMap[i],\n              });\n\n              cumHeight += height;\n            }\n          }\n        }\n      }\n\n      return segments;\n    }\n\n    renderStackedBars() {\n      this.drawnAtScale = scaleLinear()\n        .domain([...this.xScale().domain()])\n        .range([...this.xScale().range()]);\n\n      const segments = Object.values(this.fetchedTiles).flatMap(\n        this.histToSegments.bind(this)\n      );\n\n      const positions = new Float32Array(segments.flatMap(segmentToPosition));\n      const colorIdxs = new Float32Array(segments.flatMap(segmentToColorIdx));\n      const focused = new Float32Array(segments.flatMap(segmentToFocused));\n\n      const uniforms = new PIXI.UniformGroup({\n        uColorMapTex: this.colorMapTex,\n        uColorMapTexRes: this.colorMapTexRes,\n        uColorMapFocus: this.colorMapFocusTex,\n        uColorMapFocusTexRes: this.colorMapFocusTexRes,\n      });\n\n      const shader = PIXI.Shader.from(VS, FS, uniforms);\n\n      const geometry = new PIXI.Geometry();\n      geometry.addAttribute('aPosition', positions, 2);\n      geometry.addAttribute('aColorIdx', colorIdxs, 1);\n      geometry.addAttribute('aFocused', focused, 1);\n\n      const mesh = new PIXI.Mesh(\n        geometry,\n        shader,\n        new PIXI.State(),\n        PIXI.DRAW_MODES.TRIANGLES\n      );\n\n      const newGraphics = new PIXI.Graphics();\n      newGraphics.addChild(mesh);\n\n      // eslint-disable-next-line\n      this.pMain.x = this.position[0];\n\n      if (this.indicatorPointGraphics) {\n        this.pMain.removeChild(this.indicatorPointGraphics);\n      }\n\n      this.pMain.addChild(newGraphics);\n      this.indicatorPointGraphics = newGraphics;\n\n      scaleScalableGraphics(\n        this.indicatorPointGraphics,\n        this._xScale,\n        this.drawnAtScale\n      );\n\n      this.draw();\n      this.animate();\n    }\n\n    renderTrack() {\n      this.drawAxis(this.valueScaleInverted);\n      this.renderStackedBars();\n    }\n\n    hasFetchedTiles() {\n      return Object.values(this.fetchedTiles).length;\n    }\n\n    // Called whenever a new tile comes in\n    updateExistingGraphics() {\n      this.updateLoadIndicator();\n      if (!this.hasFetchedTiles()) return;\n      this.updateHistograms();\n      this.updateScales();\n      this.renderTrack();\n    }\n\n    /**\n     * Shows value and type for each bar\n     *\n     * @param trackX relative x-coordinate of mouse\n     * @param trackY relative y-coordinate of mouse\n     * @returns string with embedded values and svg square for color\n     */\n    getMouseOverHtml(trackX, trackY) {\n      if (!this.tilesetInfo) return '';\n\n      const zoomLevel = this.calculateZoomLevel();\n      const tileWidth = tileProxy.calculateTileWidth(\n        this.tilesetInfo,\n        zoomLevel,\n        this.tilesetInfo.tile_size\n      );\n\n      // the position of the tile containing the query position\n      const relTilePos = this._xScale.invert(trackX) / tileWidth;\n      const tilePos = Math.floor(relTilePos);\n      const tileId = this.tileToLocalId([zoomLevel, tilePos]);\n      const fetchedTile = this.fetchedTiles[tileId];\n\n      if (!fetchedTile) return '';\n\n      const relPos = relTilePos - tilePos;\n      const binXPos = Math.floor(this.numBins * relPos);\n\n      const rowCumSum = [];\n      const rowNumPred = [];\n      let totalPred = 0;\n      let sum = 0;\n      for (let i = 0; i < this.numGroups; i++) {\n        sum += fetchedTile.histogram2d[i * this.numBins + binXPos];\n        const numPred =\n          fetchedTile.histogram2dNumPred[i * this.numBins + binXPos];\n        rowNumPred.push(numPred);\n        totalPred += numPred;\n        rowCumSum.push(sum);\n      }\n\n      const relYPos = this.heightScale.invert(trackY);\n      const group = rowCumSum.findIndex((cumHeight) => cumHeight > relYPos);\n\n      if (group >= 0) {\n        const [color, bg] = this.groupToColor.get(group);\n        const colorHex = `#${color.toString(16)}`;\n        const bgHex = `#${bg.toString(16)}`;\n        const value =\n          fetchedTile.histogram2dNumPred[group * this.numBins + binXPos];\n        return `<div style=\"margin: -0.25rem; padding: 0 0.25rem; background: ${bgHex}\"><strong style=\"color: ${colorHex};\">${this.groupLabels[group]}:</strong> ${value} of ${totalPred} samples</div>`;\n      }\n\n      return '';\n    }\n\n    setPosition(newPosition) {\n      super.setPosition(newPosition);\n\n      [this.pMain.position.x, this.pMain.position.y] = this.position;\n    }\n\n    zoomed(newXScale, newYScale) {\n      this.xScale(newXScale);\n      this.yScale(newYScale);\n\n      if (this.indicatorPointGraphics) {\n        scaleScalableGraphics(\n          this.indicatorPointGraphics,\n          newXScale,\n          this.drawnAtScale\n        );\n      }\n\n      this.refreshTiles();\n      this.draw();\n    }\n\n    /**\n     * Export an SVG representation of this track\n     *\n     * @returns {Array} The two returned DOM nodes are both SVG\n     * elements [base,track]. Base is a parent which contains track as a\n     * child. Track is clipped with a clipping rectangle contained in base.\n     *\n     */\n    exportSVG() {\n      let track = null;\n      let base = null;\n\n      [base, track] = super.superSVG();\n\n      base.setAttribute('class', 'exported-stacked-bar-track');\n      const output = document.createElement('g');\n\n      track.appendChild(output);\n      output.setAttribute(\n        'transform',\n        `translate(${this.position[0]},${this.position[1]})`\n      );\n\n      const segments = Object.values(this.fetchedTiles).flatMap(\n        this.histToSegments.bind(this)\n      );\n\n      segments.forEach(({ xStart, xEnd, yStart, yEnd, colorIdx }) => {\n        const r = document.createElement('rect');\n\n        r.setAttribute('x', xEnd);\n        r.setAttribute('y', yEnd);\n        r.setAttribute('width', Math.abs(xEnd - xStart));\n        r.setAttribute('height', Math.abs(yEnd - yStart));\n        r.setAttribute('fill', this.colorMap[colorIdx]);\n        r.setAttribute('stroke-width', 0);\n\n        output.appendChild(r);\n      });\n\n      const gAxis = document.createElement('g');\n      gAxis.setAttribute('id', 'axis');\n\n      // append the axis to base so that it's not clipped\n      base.appendChild(gAxis);\n      gAxis.setAttribute(\n        'transform',\n        `translate(${this.axis.pAxis.position.x}, ${this.axis.pAxis.position.y})`\n      );\n\n      if (\n        this.options.axisPositionHorizontal === 'left' ||\n        this.options.axisPositionVertical === 'top'\n      ) {\n        const gDrawnAxis = this.axis.exportAxisLeftSVG(\n          this.valueScale,\n          this.dimensions[1]\n        );\n        gAxis.appendChild(gDrawnAxis);\n      } else if (\n        this.options.axisPositionHorizontal === 'right' ||\n        this.options.axisPositionVertical === 'bottom'\n      ) {\n        const gDrawnAxis = this.axis.exportAxisRightSVG(\n          this.valueScale,\n          this.dimensions[1]\n        );\n        gAxis.appendChild(gDrawnAxis);\n      }\n\n      return [base, track];\n    }\n  }\n\n  return new StackedBarTrack(...args);\n};\n\nconst icon =\n  '<svg viewBox=\"0 0 16 16\" xmlns=\"http://www.w3.org/2000/svg\" fill-rule=\"evenodd\" clip-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"1.5\"><path d=\"M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268\" fill=\"none\" stroke=\"currentColor\"/><path d=\"M10.5 3.5v12\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-dasharray=\"1,2,0,0\"/><path d=\"M5.5 13.5V6\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-width=\".9969299999999999\" stroke-dasharray=\"1.71,3.43,0,0\"/><path d=\"M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z\" fill=\"currentColor\"/><path d=\"M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z\" fill=\"currentColor\"/></svg>';\n\ncreateStackedBarTrack.config = {\n  type: 'stacked-bar',\n  datatype: ['bedlike'],\n  orientation: '1d',\n  name: 'Advanced Stacked Bars Track',\n  thumbnail: new DOMParser().parseFromString(icon, 'text/xml').documentElement,\n  availableOptions: [\n    'flip1D',\n    'labelPosition',\n    'labelColor',\n    'labelTextOpacity',\n    'labelBackgroundOpacity',\n    'strokeColor',\n    'strokeWidth',\n    'trackBorderWidth',\n    'trackBorderColor',\n  ],\n  defaultOptions: {\n    flip1D: 'no',\n    labelColor: 'black',\n    labelPosition: 'hidden',\n    strokeColor: 'black',\n    strokeWidth: 1,\n    trackBorderWidth: 0,\n    trackBorderColor: 'black',\n  },\n};\n\nexport default createStackedBarTrack;\n","import createPubSub from 'pub-sub-es';\nimport { sortedIndex } from 'lodash-es';\n\nfunction createTssTrack(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  class TssTrack extends HGC.tracks.BedLikeTrack {\n    constructor(context, options) {\n      super(context, options);\n\n      const { publish, subscribe, unsubscribe } = createPubSub();\n      this.publish = publish;\n      this.subscribe = subscribe;\n      this.unsubscribe = unsubscribe;\n\n      this.collectAnnotationsBound = this.collectAnnotations.bind(this);\n\n      this.updateOptions();\n    }\n\n    updateOptions() {\n      this.options.maxPerTile = this.options.maxPerTile || 50;\n    }\n\n    drawPoly() {}\n\n    renderRows() {}\n\n    collectAnnotations(tile) {\n      const zoomLevel = +tile.tileId.split('.')[0];\n\n      this.initialize();\n\n      const focusRegion = this.options.focusRegion || [Infinity, Infinity];\n\n      const annotations = [];\n\n      const rows = [\n        ...(tile.plusStrandRows || []),\n        ...(tile.minusStrandRows || []),\n      ];\n\n      const sortedIdxs = [];\n      const sortedValues = [];\n\n      for (let j = 0; j < rows.length; j++) {\n        for (let i = 0; i < rows[j].length; i++) {\n          const td = rows[j][i].value;\n          const geneInfo = td.fields;\n\n          // the returned positions are chromosome-based and they need to\n          // be converted to genome-based\n          const chrOffset = +td.chrOffset;\n          const txStart = +geneInfo[1] + chrOffset;\n          const txEnd = +geneInfo[2] + chrOffset;\n\n          const xStartPos = this._xScale(txStart);\n          const xEndPos = this._xScale(txEnd);\n\n          // don't draw anything that has already been drawn\n          if (\n            !(\n              zoomLevel in this.drawnRects &&\n              td.uid in this.drawnRects[zoomLevel]\n            )\n          ) {\n            if (!this.drawnRects[zoomLevel]) this.drawnRects[zoomLevel] = {};\n\n            const circleDraw = {\n              xStartScreen: xStartPos,\n              xEndScreen: xEndPos,\n              xStartAbs: txStart,\n              xEndAbs: txEnd,\n              data: td,\n              isFocused: txStart <= focusRegion[1] && txEnd >= focusRegion[0],\n            };\n\n            const idx = sortedIndex(sortedValues, td.importance);\n            sortedValues.splice(idx, 0, td.importance);\n            sortedIdxs.splice(idx, 0, annotations.push(circleDraw) - 1);\n          }\n        }\n      }\n\n      if (annotations.length <= this.options.maxPerTile) return annotations;\n\n      return sortedIdxs\n        .slice(0, this.options.maxPerTile)\n        .map((idx) => annotations[idx]);\n    }\n\n    rerender() {\n      this.updateOptions();\n      this.updateExistingGraphics();\n    }\n\n    updateExistingGraphics() {\n      super.updateExistingGraphics();\n      const annotations = Object.values(this.visibleAndFetchedTiles())\n        .map(this.collectAnnotationsBound)\n        .reduce(\n          (allAnnotations, tileAnnotations) =>\n            allAnnotations.concat(tileAnnotations),\n          []\n        );\n      this.publish('tilesDrawn', { uuid: this.uuid, annotations });\n    }\n\n    getMouseOverHtml() {\n      return '';\n    }\n  }\n\n  return new TssTrack(...args);\n}\n\ncreateTssTrack.config = {\n  type: 'tss',\n  datatype: ['bedlike'],\n};\n\nexport default createTssTrack;\n","import { globalPubSub } from 'pub-sub-es';\n\n// Timeout requests after 10 seconds\nconst T_TIMEOUT = 10000;\n\nconst LocalCsvDataFetcher = function LocalCsvDataFetcher(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  const createRandomId = () => Math.random().toString(36).substring(2);\n\n  class LocalBedDataFetcherClass {\n    constructor(dataConfig) {\n      this.dataConfig = dataConfig;\n    }\n\n    tilesetInfo(callback) {\n      this.tilesetInfoLoading = true;\n\n      if (!this.tilesetInfoData) {\n        this.tilesetInfoData = new Promise((resolve, reject) => {\n          const requestId = createRandomId();\n          const timeoutId = setTimeout(\n            () =>\n              reject(\n                new Error(\n                  `Could not load tileset info for ${this.dataConfig.id}`\n                )\n              ),\n            T_TIMEOUT\n          );\n          globalPubSub.subscribe(\n            `localBed:tilesetInfo:${requestId}`,\n            (tilesetInfo) => {\n              clearTimeout(timeoutId);\n              this.tilesetInfoLoading = false;\n              resolve(tilesetInfo);\n            },\n            1\n          );\n          globalPubSub.publish('localBed:requestTilesetInfo', {\n            fileId: this.dataConfig.id,\n            requestId,\n          });\n        });\n      }\n\n      this.tilesetInfoData.then((tilesetInfoData) => {\n        callback(tilesetInfoData);\n      });\n    }\n\n    /** We expect there to be a tilesetUid in the provided tilesetInfo\n     * and tiles data since tileResponseToData needs it\n     *\n     * It is also easier for users to paste in request responses for debugging.\n     */\n    fetchTilesDebounced(loadHandler, tileIds) {\n      Promise.all(tileIds.map((tileId) => this.tile(tileId.split('.')))).then(\n        (tiles) => {\n          loadHandler(\n            tiles.reduce((response, tile, i) => {\n              response[tileIds[i]] = tile;\n              return response;\n            }, {})\n          );\n        }\n      );\n    }\n\n    tile([z, x]) {\n      return new Promise((resolve, reject) => {\n        const requestId = createRandomId();\n        const timeoutId = setTimeout(\n          () =>\n            reject(\n              new Error(\n                `Could not load tile ${z}.${x} for ${this.dataConfig.id} (request: ${requestId})`\n              )\n            ),\n          T_TIMEOUT\n        );\n        globalPubSub.subscribe(\n          `localBed:tile:${requestId}`,\n          (tile) => {\n            clearTimeout(timeoutId);\n            resolve(tile);\n          },\n          1\n        );\n        globalPubSub.publish('localBed:requestTile', {\n          fileId: this.dataConfig.id,\n          z: +z,\n          x: +x,\n          requestId,\n        });\n      });\n    }\n  }\n\n  return new LocalBedDataFetcherClass(...args);\n};\n\nLocalCsvDataFetcher.config = {\n  type: 'localBed',\n};\n\nexport default LocalCsvDataFetcher;\n","import register from 'higlass-register';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'higlass-arcs';\n\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nimport createAnnotationOverlayMetaTrack from './annotation-overlay-meta-track';\nimport createRidgePlotTrack from './ridge-plot-track';\nimport createStratifiedBedTrack from './stratified-bed-track';\nimport createSnpTrack from './snp-track';\nimport createStackedBarTrack from './stacked-bar-track';\nimport createTssTrack from './tss-track';\n\nimport createLocalBedDataFetcher from './local-bed-data-fetcher';\n\nimport './index.css';\n\nregister(\n  {\n    dataFetcher: createLocalBedDataFetcher,\n    config: createLocalBedDataFetcher.config,\n  },\n  { pluginType: 'dataFetcher' }\n);\n\nregister({\n  track: createRidgePlotTrack,\n  config: createRidgePlotTrack.config,\n});\n\nregister({\n  track: createStratifiedBedTrack,\n  config: createStratifiedBedTrack.config,\n});\n\nregister({\n  track: createSnpTrack,\n  config: createSnpTrack.config,\n});\n\nregister({\n  track: createStackedBarTrack,\n  config: createStackedBarTrack.config,\n});\n\nregister({\n  track: createTssTrack,\n  config: createTssTrack.config,\n});\n\nregister({\n  track: createAnnotationOverlayMetaTrack,\n  config: createAnnotationOverlayMetaTrack.config,\n  isMetaTrack: true,\n});\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}