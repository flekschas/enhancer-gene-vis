(this["webpackJsonpenhancer-gene-vis"]=this["webpackJsonpenhancer-gene-vis"]||[]).push([[0],{329:function(e,t,i){e.exports=i(441)},423:function(e,t,i){},435:function(e,t,i){},436:function(e,t,i){},437:function(e,t,i){},439:function(e,t,i){},441:function(e,t,i){"use strict";i.r(t);var a=i(64),n=i(0),o=i.n(n),r=i(17),s=i.n(r),c=i(7),l=i(12),u=i(98),h=i(21),d=i(246),p=i(496),m=i(481),f=i(483),g=i(479),b=Object(g.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#bbb",backgroundColor:"#fff"}}})),v=function(){var e=b();return o.a.createElement("div",{className:"full-wh"},o.a.createElement(m.a,{className:e.backdrop,open:!0},o.a.createElement(f.a,{color:"inherit"})))},x=(i(423),function(){return o.a.createElement("div",{className:"full-wh app-error"},o.a.createElement("span",null,"Failed to initialize!"))}),y=Object(n.createContext)();function w(e){var t=e.children,i=e.chromInfo;return o.a.createElement(y.Provider,{value:i},t)}function k(){var e=o.a.useContext(y);if(void 0===e)throw new Error("useChromInfo must be used within a ChromInfoContext");return e}var C=i(25),E=i.n(C),O=i(45),S=i(495),j=i(486),_=i(18),T=i(498),A=i(447),M=i(491),R=i(504),N=i(502),I=i(485),L=i(503),z=i(251),P=i(147),D=i.n(P),F=i(14),G=i(501),H=i(187),B=i.n(H),W=i(186),U=i.n(W),V=i(236),q=i.n(V),X=i(188),Y=i.n(X),Z=i(484),J=i(487),K=i(444);function Q(e,t){var i=Object(n.useState)(e),a=Object(c.a)(i,2),o=a[0],r=a[1];return Object(n.useEffect)((function(){var i=setTimeout((function(){r(e)}),t);return function(){clearTimeout(i)}}),[e,t]),o}var $=Object(g.a)((function(e){return{root:{position:"relative"},filterBar:{position:"sticky",zIndex:1,top:"8px","&:before":{content:'""',position:"absolute",zIndex:0,top:"-9px",right:"-8px",left:"-8px",bottom:0,background:"white"}},checkbox:{marginTop:-6,marginBottom:-6},checkboxLabel:{fontSize:"0.8rem",marginLeft:-6},nestedCheckbox:{marginLeft:4},visible:{transition:".3s ease transform, .3s ease height",transform:"scale(1, 1)",height:"1.625rem"},invisible:{transition:".3s ease transform, .3s ease height",transform:"scale(1, 0)",height:"0rem"}}})),ee=o.a.memo((function(e){var t=e.filterState,i=e.name,a=e.stateWithName,r=e.group,s=e.stateWithGroup,u=e.colorCheckbox,h=e.colorText,d=Object(l.e)(t),p=Object(l.d)(a(i)),m=Object(c.a)(p,2),f=m[0],g=m[1],b=Object(l.d)(s(r)),v=Object(c.a)(b,2),x=v[0],y=v[1],w=Object(n.useMemo)((function(){return i.toLowerCase()}),[i]),k=Object(n.useCallback)((function(e){g((function(t){return Object(F.a)(Object(F.a)({},t),{},{checked:e.target.checked})})),y((function(t){var i=Object(F.a)(Object(F.a)({},t),{},{n:t.n+(e.target.checked?1:-1)});switch(i.n){case t.N:i.checked=!0;break;case 0:i.checked=!1;break;default:i.checked=void 0}return i}))}),[g,y]);Object(n.useEffect)((function(){!0===x.checked?g((function(e){return Object(F.a)(Object(F.a)({},e),{},{checked:!0})})):!1===x.checked&&g((function(e){return Object(F.a)(Object(F.a)({},e),{},{checked:!1})}))}),[x,g]),Object(n.useEffect)((function(){g((function(e){return Object(F.a)(Object(F.a)({},e),{},{visible:!d.length||w.includes(d)})}))}),[d,w,g]);var C=$();return o.a.createElement("div",{className:f.visible?C.visible:C.invisible},o.a.createElement(Z.a,{key:i,className:"".concat(C.checkbox," ").concat(C.nestedCheckbox),control:o.a.createElement(G.a,{style:{color:u},icon:o.a.createElement(U.a,{fontSize:"small"}),checkedIcon:o.a.createElement(B.a,{fontSize:"small"}),checked:f.checked,onChange:k,name:i}),label:o.a.createElement(K.a,{className:C.checkboxLabel,noWrap:!0,style:{color:h}},i)}))})),te=o.a.memo((function(e){var t=e.group,i=e.stateWithGroup,a=e.colorCheckbox,r=e.colorText,s=Object(l.d)(i(t)),u=Object(c.a)(s,2),h=u[0],d=u[1],p=Object(n.useCallback)((function(e){d((function(t){return Object(F.a)(Object(F.a)({},t),{},{checked:e.target.checked,n:e.target.checked?t.N:0})}))}),[d]),m=$();return o.a.createElement(Z.a,{className:m.checkbox,control:o.a.createElement(G.a,{style:{color:a},icon:!1===h.checked?o.a.createElement(U.a,{fontSize:"small"}):o.a.createElement(q.a,{fontSize:"small"}),checkedIcon:o.a.createElement(B.a,{fontSize:"small"}),checked:!0===h.checked,onChange:p,name:t.name}),label:o.a.createElement(K.a,{className:m.checkboxLabel,noWrap:!0,style:{color:r}},o.a.createElement("strong",null,t.name)," ",o.a.createElement("span",null,"(",h.n,"/",h.N,")"))})})),ie=o.a.memo((function(e){var t=e.filterState,i=e.optionWithName,a=e.optionGroupWithGroup,r=e.filterLabel,s=void 0===r?"Filter":r,u=e.groupedOptions,h=void 0===u?[]:u,d=(e.optionToGroup,e.groupColors),p=void 0===d?[]:d,m=e.groupColorsDark,f=void 0===m?[]:m,g=Object(l.d)(t),b=Object(c.a)(g,2),v=b[0],x=b[1],y=Object(n.useState)(v),w=Object(c.a)(y,2),k=w[0],C=w[1],E=Q(k,350),O=Object(n.useCallback)((function(e){C(e.target.value.toLowerCase())}),[C]);Object(n.useEffect)((function(){x(E)}),[E,x]);var S=$();return o.a.createElement("div",{className:S.root},o.a.createElement("div",{className:S.filterBarBg}),o.a.createElement(N.a,{className:S.filterBar,variant:"outlined",margin:"dense",fullWidth:!0},o.a.createElement(I.a,{htmlFor:"filter"},o.a.createElement(j.a,{container:!0,direction:"row",alignItems:"center"},o.a.createElement(Y.a,{fontSize:"small"}),o.a.createElement("span",{style:{marginLeft:3}},s))),o.a.createElement(L.a,{id:"filter",label:o.a.createElement(j.a,{container:!0,direction:"row",alignItems:"center"},o.a.createElement(Y.a,{fontSize:"small"}),o.a.createElement("span",{style:{marginLeft:3}},s)),onChange:O,value:k})),o.a.createElement(J.a,null,h.map((function(e,n){return o.a.createElement(o.a.Fragment,{key:e.name},o.a.createElement(te,{key:e.name,group:e,stateWithGroup:a,colorCheckbox:p[n%p.length]||"inherit",colorText:f[n%f.length]||"inherit"}),e.options.map((function(r){return o.a.createElement(ee,{filterState:t,key:r,name:r,stateWithName:i,group:e,stateWithGroup:a,colorCheckbox:p[n%p.length]||"inherit",colorText:f[n%f.length]||"inherit"})})))}))))})),ae=Object(g.a)((function(e){return{logo:{height:"100%",padding:"0.1em",alignItems:"center",fontSize:"1em",lineHeight:"1em",fontWeight:"bold"},logoAbc:{fontSize:"2.75em",letterSpacing:"-0.075rem",paddingRight:"0.125em",fontWeight:900},logoEnhancer:{alignItems:"flex-start"}}})),ne=function(e){var t=ae();return o.a.createElement(j.a,{container:!0,className:t.logo,style:e.styles},o.a.createElement(j.a,{item:!0,className:t.logoAbc},"ABC"),o.a.createElement(j.a,{item:!0},o.a.createElement(j.a,{container:!0,direction:"column",className:t.logoEnhancer},o.a.createElement(j.a,{item:!0},"Enhancer-Gene"),o.a.createElement(j.a,{item:!0},"Connections"))))};ne.defaultProps={styles:{}};var oe=ne,re=i(39),se=i(499),ce=i(489),le=i(488),ue=i(238),he=i.n(ue),de=i(237),pe=i.n(de),me=o.a.memo(o.a.forwardRef((function(e,t){var i=e.onChange,a=e.onClear,r=e.className,s=void 0===r?"":r,l=e.label,u=void 0===l?"Select":l,h=e.accept,d=void 0===h?"*":h,p=e.color,m=void 0===p?"default":p,f=e.Icon,g=void 0===f?pe.a:f,b=Object(F.a)({},e);delete b.onChange,delete b.onClear,delete b.className,delete b.file,delete b.label,delete b.accept,delete b.color,delete b.Icon;var v=Object(n.useState)(e.file||null),x=Object(c.a)(v,2),y=x[0],w=x[1],k=Object(n.useCallback)((function(e){var t=e.target.files;w(t[0]),i&&i(t[0],e)}),[i]),C=Object(n.useCallback)((function(){w(null),a&&a()}),[a]);return o.a.createElement(le.a,Object.assign({},b,{className:"r",ref:t}),o.a.createElement(A.a,{variant:y?"outlined":"contained",component:"label",className:s,color:m,disableElevation:!0,startIcon:o.a.createElement(g,null)},o.a.createElement("input",{accept:d,type:"file",onChange:k,hidden:!0}),y?y.name:u),o.a.createElement(A.a,{variant:"contained",disabled:!y,onClick:C,disableElevation:!0},o.a.createElement(he.a,{fontSize:"inherit"})))}))),fe=i(43),ge=i(239),be=i(148),ve=i.n(be),xe=function(e,t){return e[0]<=t[0]&&e[1]>=t[1]},ye=function(e,t){var i=Math.max(2,Math.ceil(Math.sqrt(t.length))),a=new Float32Array(4*Math.pow(i,2));return t.forEach((function(e,t){a[4*t]=e[0],a[4*t+1]=e[1],a[4*t+2]=e[2],a[4*t+3]=e[3]})),[e.Texture.fromBuffer(a,i,i),i]},we=function(e,t,i,a,n){for(var o=i-t,r=Math.sign(o),s=Math.abs(o),c=2*n,l=Math.ceil(s/c),u=0;u<l;u++)e.moveTo(t+u*c*r,a),e.lineTo(t+(u*c+n)*r,a)},ke=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.c;return t(ve.a.parse(window.location.search)[e])},Ce=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h.c,a=ve.a.parse(window.location.search),n=ve.a.stringify(Object(F.a)(Object(F.a)({},a),{},Object(re.a)({},e,i(t))),{strict:!1}),o="".concat(window.location.origin).concat(window.location.pathname,"?").concat(n);window.history.pushState({path:o},"",o)},Ee=function(e,t){var i;if(e.indexOf&&e.indexOf(":")>=0){var a=e.split(":"),n=Object(c.a)(a,2),o=n[0],r=n[1];i=t.chrPositions[o].pos+ +r}else i=+e;return i},Oe=function(e,t,i){var a=e.toFixed(t);if(!i){for(;"0"===a[a.length-1];)a=a.substring(0,a.length-1);"."===a[a.length-1]&&(a=a.substring(0,a.length-1))}return a},Se=function(){var e=[],t=null,i=1,a=[0,1],n=a[1]-a[0],o=[],r=!1,s=0,c=function(e,t){return e+t},l=function(){return t||i},u=function(){n=a[1]-a[0];var t=o.reduce(c,0);i=(n-t)/e.length,s=t+e.length*l()},h=function(t){var i=e.indexOf(t);if(-1!==i)return i*l()+o.slice(0,i+r).reduce(c,0)};return h.domain=function(t){return t?(e=Object(_.a)(t),u(),h):e},h.range=function(e){return e?(a=Object(_.a)(e),u(),h):a},h.bandwidth=function(){return l()},h.fixedBandwidth=function(e){return e?(t=e,u(),h):e},h.totalWidth=function(){return s},h.rangeSize=function(){return n},h.paddingInner=function(e){return e?(o=e,u(),h):o},h.paddingInnerZeroBased=function(e){return e?(r=e,u(),h):r},h},je=function(e){return void 0===e?void 0:"true"===e};function _e(){return(_e=Object(O.a)(E.a.mark((function e(t,i){var a,n,o,r,s,c,l,u,h,d,p,m,f,g=arguments;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g.length>2&&void 0!==g[2]?g[2]:{},n=a.header,o=void 0===n||n,r=a.columnImportance,s=void 0===r?7:r,c=new ge.a,e.next=4,t.text();case 4:for(l=e.sent,u=l.split(/\r\n|\n/),h=+o;h<u.length;h++)d=u[h].split("\t"),p=Ee("".concat(d[0],":0"),i),m=Ee("".concat(d[0],":").concat(d[1]),i),f=Ee("".concat(d[0],":").concat(d[2]),i),c.insert([m,f],{chrOffset:p,xStart:m,xEnd:f,importance:+d[s],uid:"".concat(t.name,"-").concat(h),name:d[3],fields:d});return e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Te=function(e,t,i,a,n){var o=function(e,t){return _e.apply(this,arguments)}(e,i,n),r=fe.b.subscribe("localBed:requestTile",(function(e){var i=e.fileId,n=e.z,r=e.x,s=e.requestId;i===t&&o.then((function(e){var t=a.max_width/Math.pow(2,n),i=t*r,o=i+t,c=e.search([i,o]);fe.b.publish("localBed:tile:".concat(s),c)}))})),s=fe.b.subscribe("localBed:requestTilesetInfo",(function(e){var i=e.fileId,n=e.requestId;i===t&&fe.b.publish("localBed:tilesetInfo:".concat(n),a)}));return{destroy:function(){fe.b.unsubscribe(r),fe.b.unsubscribe(s)}}};function Ae(e){var t=Object(n.useRef)();return Object(n.useEffect)((function(){t.current=e})),t.current}var Me=i(497);function Re(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.encoder,o=(i.decoder,Object(l.d)(t)),r=Object(c.a)(o,2),s=r[0],u=r[1],h=Object(n.useCallback)((function(t){u(t),Ce(e,t,a)}),[e,a,u]);return Ce(e,s,a),[s,h]}var Ne=1e-6,Ie=["#c76526","#6fb2e4","#eee462","#469b76","#3170ad","#dca237","#000000","#999999"],Le=["#a65420","#4a7798","#999026","#3a8162","#295d90","#b7872e","#000000","#666666"],ze=["#f6e5db","#e7f2fb","#f2eda9","#e0eee8","#dde7f1","#f5e4c4","#d5d5d5","#ffffff"],Pe="https://higlass.io/api/v1/suggest/?d=OHJakQICQD6gTD7skx4EWA",De="https://resgen.io/api/v1/suggest/?d=VF5-RDXWTxidGMJU7FeaxA",Fe={categoryField:10,axisShowGroupSeparator:!0,axisNoGroupColor:!1,groups:[{label:"Mononuclear Phagocytes",categories:["THP1_LPS_4hr-Engreitz","THP_pmaLPS_ATAC_6h","CD14-positive_monocyte_treated_with_LPS_4h-Novakovic2016","CD14-positive_monocyte_treated_with_BG_1h-Novakovic2016","CD14-positive_monocyte_treated_with_RPMI_d6-Novakovic2016","THP1-Engreitz","THP_pmaLPS_ATAC_96h","CD14-positive_monocyte_treated_with_BG_d1-Novakovic2016","THP_pmaLPS_ATAC_72h","THP-1_monocyte-VanBortle2017","CD14-positive_monocyte_treated_with_LPS_d1-Novakovic2016","CD14-positive_monocyte-ENCODE","THP_pmaLPS_ATAC_2h","dendritic_cell_treated_with_Lipopolysaccharide_0_ng-mL_for_0_hour-Garber2017","CD14-positive_monocyte_treated_with_RPMI_1h-Novakovic2016","U937_LPS_4hr-Engreitz","CD14-positive_monocyte-Novakovic2016","dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_6_hour-Garber2017","CD14-positive_monocyte_treated_with_BG_4h-Novakovic2016","THP_pmaLPS_ATAC_0h","HAP1","THP-1_macrophage-VanBortle2017","dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_1_hour-Garber2017","U937-Engreitz","CD14-positive_monocyte_treated_with_RPMI_d1-Novakovic2016","CD14-positive_monocyte_treated_with_RPMI_4h-Novakovic2016","CD14-positive_monocyte_treated_with_LPS_d6-Novakovic2016","CD14-positive_monocyte_treated_with_LPS_1h-Novakovic2016","THP_pmaLPS_ATAC_24h","THP_pmaLPS_ATAC_1h","dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_2_hour-Garber2017","CD14-positive_monocyte_treated_with_BG_d6-Novakovic2016","dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_30_minute-Garber2017","THP_pmaLPS_ATAC_120h","dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_4_hour-Garber2017","THP_pmaLPS_ATAC_48h","CD14-positive_monocytes-Roadmap","THP_pmaLPS_ATAC_12h"]},{label:"B Cells",categories:["Karpas-422-ENCODE","BJAB-Engreitz","BJAB_anti-IgM_anti-CD40_4hr-Engreitz","B_cell-ENCODE","OCI-LY7-ENCODE","GM12878-Roadmap","MM.1S-ENCODE","CD19-positive_B_cell-Roadmap","CD8-positive_alpha-beta_T_cell-ENCODE"]},{label:"T Cells",categories:["Jurkat_anti-CD3_PMA_4hr-Engreitz","Jurkat-Engreitz","CD3-positive_T_cell-Roadmap","CD4-positive_helper_T_cell-ENCODE","CD8-positive_alpha-beta_T_cell-Corces2016","thymus_fetal-Roadmap","CD4-positive_helper_T_cell-Corces2016","T-cell-ENCODE"]},{label:"Other haematopoietic cells",categories:["spleen-ENCODE","K562-Roadmap","CD56-positive_natural_killer_cells-Roadmap","erythroblast-Corces2016","CD34-positive_mobilized-Roadmap","megakaryocyte-erythroid_progenitor-Corces2016","natural_killer_cell-Corces2016","IMR90-Roadmap"]},{label:"Fibroblasts",categories:["foreskin_fibroblast-Roadmap","fibroblast_of_dermis-Roadmap","fibroblast_of_arm-ENCODE","astrocyte-ENCODE","fibroblast_of_lung-Roadmap"]},{label:"Epithelial",categories:["small_intestine_fetal-Roadmap","epithelial_cell_of_prostate-ENCODE","HCT116-ENCODE","MCF-7-ENCODE","adrenal_gland_fetal-ENCODE","H7","keratinocyte-Roadmap","MCF10A-Ji2017","pancreas-Roadmap","mammary_epithelial_cell-Roadmap","stomach-Roadmap","LoVo","A549_treated_with_ethanol_0.02_percent_for_1_hour-Roadmap","PC-9-ENCODE","H1-hESC-Roadmap","thyroid_gland-ENCODE","HT29","MDA-MB-231","iPS_DF_19.11_Cell_Line-Roadmap","large_intestine_fetal-Roadmap","Panc1-ENCODE","adrenal_gland-ENCODE","MCF10A_treated_with_TAM24hr-Ji2017","trophoblast_cell-ENCODE","H1_BMP4_Derived_Trophoblast_Cultured_Cells-Roadmap","uterus-ENCODE","body_of_pancreas-ENCODE","stomach_fetal-Roadmap","H9-Roadmap","transverse_colon-ENCODE","H1_BMP4_Derived_Mesendoderm_Cultured_Cells-Roadmap","breast_epithelium-ENCODE","induced_pluripotent_stem_cell-ENCODE","LNCAP","H1_Derived_Mesenchymal_Stem_Cells-Roadmap","ovary-Roadmap","sigmoid_colon-ENCODE","skeletal_muscle_myoblast-Roadmap","bipolar_neuron_from_iPSC-ENCODE","coronary_artery_smooth_muscle_cell-Miller2016","SK-N-SH-ENCODE","muscle_of_trunk_fetal-Roadmap"]},{label:"Other",categories:["adipose_tissue-ENCODE","HeLa-S3-Roadmap","hepatocyte-ENCODE","heart_ventricle-ENCODE","spinal_cord_fetal-ENCODE","coronary_artery-ENCODE","HepG2-Roadmap","muscle_of_leg_fetal-Roadmap","gastrocnemius_medialis-ENCODE","brite_adipose-Loft2014","placenta-Roadmap","liver-ENCODE","A673-ENCODE","white_adipose-Loft2014","cardiac_muscle_cell-ENCODE","osteoblast-ENCODE","H1_Derived_Neuronal_Progenitor_Cultured_Cells-Roadmap","endothelial_cell_of_umbilical_vein-Roadmap","NCCIT","myotube_originated_from_skeletal_muscle_myoblast-Roadmap","psoas_muscle-Roadmap","endothelial_cell_of_umbilical_vein_vegf_stim_4_hours-zhang2013","endothelial_cell_of_umbilical_vein_vegf_stim_12_hours-zhang2013"]}]},Ge=Fe.groups.map((function(e){return{name:e.label,options:e.categories}})),He=Ge.reduce((function(e,t){return t.options.forEach((function(i){e[i]=t.name})),e}),{}),Be=Ge.flatMap((function(e){return e.options})),We={type:"point-annotation",height:32,options:{axisPositionHorizontal:"right",markColor:"black",markColorFocus:"#cc0078",markSize:2,markOpacity:.33,markOpacityFocus:.66,valueColumn:7,name:"Variants",labelPosition:"topLeft",labelColor:"black",labelOpacity:.33,showMousePosition:!0,showGlobalMousePosition:!0,mousePositionColor:"black",toolTip:{name:{field:3},value:{field:6,numDecimals:2},other:[{label:"Post. Prob.",field:7,numDecimals:2}]}}},Ue={zoom_step:1,max_length:3137161265,assembly:"hg19",chrom_names:"chr1\tchr2\tchr3\tchr4\tchr5\tchr6\tchr7\tchr8\tchr9\tchr10\tchr11\tchr12\tchr13\tchr14\tchr15\tchr16\tchr17\tchr18\tchr19\tchr20\tchr21\tchr22\tchrX\tchrY\tchrM\tchr6_ssto_hap7\tchr6_mcf_hap5\tchr6_cox_hap2\tchr6_mann_hap4\tchr6_apd_hap1\tchr6_qbl_hap6\tchr6_dbb_hap3\tchr17_ctg5_hap1\tchr4_ctg9_hap1\tchr1_gl000192_random\tchrUn_gl000225\tchr4_gl000194_random\tchr4_gl000193_random\tchr9_gl000200_random\tchrUn_gl000222\tchrUn_gl000212\tchr7_gl000195_random\tchrUn_gl000223\tchrUn_gl000224\tchrUn_gl000219\tchr17_gl000205_random\tchrUn_gl000215\tchrUn_gl000216\tchrUn_gl000217\tchr9_gl000199_random\tchrUn_gl000211\tchrUn_gl000213\tchrUn_gl000220\tchrUn_gl000218\tchr19_gl000209_random\tchrUn_gl000221\tchrUn_gl000214\tchrUn_gl000228\tchrUn_gl000227\tchr1_gl000191_random\tchr19_gl000208_random\tchr9_gl000198_random\tchr17_gl000204_random\tchrUn_gl000233\tchrUn_gl000237\tchrUn_gl000230\tchrUn_gl000242\tchrUn_gl000243\tchrUn_gl000241\tchrUn_gl000236\tchrUn_gl000240\tchr17_gl000206_random\tchrUn_gl000232\tchrUn_gl000234\tchr11_gl000202_random\tchrUn_gl000238\tchrUn_gl000244\tchrUn_gl000248\tchr8_gl000196_random\tchrUn_gl000249\tchrUn_gl000246\tchr17_gl000203_random\tchr8_gl000197_random\tchrUn_gl000245\tchrUn_gl000247\tchr9_gl000201_random\tchrUn_gl000235\tchrUn_gl000239\tchr21_gl000210_random\tchrUn_gl000231\tchrUn_gl000229\tchrUn_gl000226\tchr18_gl000207_random",chrom_sizes:"249250621\t243199373\t198022430\t191154276\t180915260\t171115067\t159138663\t146364022\t141213431\t135534747\t135006516\t133851895\t115169878\t107349540\t102531392\t90354753\t81195210\t78077248\t59128983\t63025520\t48129895\t51304566\t155270560\t59373566\t16571\t4928567\t4833398\t4795371\t4683263\t4622290\t4611984\t4610396\t1680828\t590426\t547496\t211173\t191469\t189789\t187035\t186861\t186858\t182896\t180455\t179693\t179198\t174588\t172545\t172294\t172149\t169874\t166566\t164239\t161802\t161147\t159169\t155397\t137718\t129120\t128374\t106433\t92689\t90085\t81310\t45941\t45867\t43691\t43523\t43341\t42152\t41934\t41933\t41001\t40652\t40531\t40103\t39939\t39929\t39786\t38914\t38502\t38154\t37498\t37175\t36651\t36422\t36148\t34474\t33824\t27682\t27386\t19913\t15008\t4262",tile_size:1024,max_zoom:22,max_width:4294967296,min_pos:[1],max_pos:[3137161265],header:"chrom1\tstart1\tend1\tchrom2\tstart2\tend2\ttargetGene\tscore\tstrand1\tstrand2\tcellType",version:2,coordSystem:""},Ve={editable:!1,trackSourceServers:["//higlass.io/api/v1"],views:[{uid:"context",genomePositionSearchBox:{autocompleteServer:"//higlass.io/api/v1",autocompleteId:"OHJakQICQD6gTD7skx4EWA",chromInfoServer:"//higlass.io/api/v1",chromInfoId:"hg19",visible:!0},chromInfoPath:"//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv",tracks:{top:[{type:"combined",uid:"chroms-viewport",height:12,contents:[{type:"horizontal-chromosome-labels",options:{color:"#999999",stroke:"white",fontSize:10,fontIsLeftAligned:!0,showMousePosition:!1,mousePositionColor:"#000000"},tilesetUid:"ADfY_RtsQR6oKOMyrq6qhw",height:12,server:"https://resgen.io/api/v1",uid:"chroms"},{uid:"viewport-details-chroms",type:"viewport-projection-horizontal",fromViewUid:"details",height:12,options:{projectionFillColor:"#cc0078",projectionStrokeColor:"#cc0078",projectionFillOpacity:.3,projectionStrokeOpacity:.3,strokeWidth:1}}]},{type:"combined",uid:"genes-tss-viewport",height:48,contents:[{type:"horizontal-gene-annotations",uid:"genes",height:48,server:"https://resgen.io/api/v1",tilesetUid:"NCifnbrKQu6j-ohVWJLoJw",options:{fontSize:9,plusStrandColor:"black",minusStrandColor:"black",geneAnnotationHeight:10,geneLabelPosition:"outside",geneStrandSpacing:.5,showMousePosition:!0,showGlobalMousePosition:!0,mousePositionColor:"black"}},{type:"tss",uid:"tss",height:48,server:"https://resgen.io/api/v1",tilesetUid:"VMZDLKrtQDmJMSjg7Ds4yA",options:{fontSize:9,plusStrandColor:"black",minusStrandColor:"black",geneAnnotationHeight:12,geneLabelPosition:"outside",geneStrandSpacing:2}},{uid:"viewport-details-genes",type:"viewport-projection-horizontal",fromViewUid:"details",height:48,options:{projectionFillColor:"#cc0078",projectionStrokeColor:"#cc0078",projectionFillOpacity:.3,projectionStrokeOpacity:.3,strokeWidth:1}}]},{type:"combined",uid:"variants",height:32,contents:[{type:"point-annotation",uid:"ibd-snps",server:"https://resgen.io/api/v1",tilesetUid:"VF5-RDXWTxidGMJU7FeaxA",height:32,options:{axisPositionHorizontal:"right",markColor:"black",markColorFocus:"#cc0078",markSize:2,markOpacity:.33,markOpacityFocus:.66,valueColumn:7,focusRegion:[1761419571,1761419621],name:"IBD Variants",labelPosition:"topLeft",labelColor:"#757575",showMousePosition:!0,showGlobalMousePosition:!0,mousePositionColor:"black",toolTip:{name:{field:3},value:{field:6,numDecimals:2},other:[{label:"Post. Prob.",field:7,numDecimals:2}]}}}]},{type:"stacked-bar",server:"https://resgen.io/api/v1",tilesetUid:"GOxTKzoLSsuw0BaG6eBrXw",height:72,uid:"stacked-bars",options:{binSize:4,axisAlign:"right",axisPositionHorizontal:"right",labelPosition:"hidden",markColor:"black",markColorFocus:"#cc0078",markSize:4,markOpacity:.33,arcStyle:"indicator",indicatorStyle:"category-rect",labelColor:"black",trackBorderWidth:0,trackBorderColor:"black",geneField:6,importanceField:7,importanceDomain:[0,1],focusRegion:[1761419571,1761419621],name:"By Celltype",stratification:Fe,showMousePosition:!0,showGlobalMousePosition:!0,mousePositionColor:"black"}},{type:"stratified-bed",server:"https://resgen.io/api/v1",tilesetUid:"GOxTKzoLSsuw0BaG6eBrXw",height:413,uid:"indicatorByCellTypes",options:{axisAlign:"right",legendAlign:"left",labelPosition:"hidden",markColor:"black",markColorHighlight:"#bf0071",markColorDehighlight:"#bbbbbb",markSize:4,markMinWidth:4,markHeight:3,rowHeight:3,markOpacity:.33,arcStyle:"indicator",indicatorStyle:"category-rect",labelColor:"black",geneField:6,importanceField:7,importanceDomain:[0,1],name:"By Celltype",axisPositionHorizontal:"right",stratification:Fe,showMousePosition:!0,showGlobalMousePosition:!0,mousePositionColor:"black"}}]},overlays:[{uid:"region-focus",includes:["chroms-viewport","genes-tss-viewport","variants","stacked-bars","indicatorByCellTypes"],options:{extent:[[1761419596,1761419597]],minWidth:3,fill:"#cc0078",fillOpacity:.05,strokeWidth:0,outline:"#cc0078",outlineOpacity:.33,outlineWidth:1,outlinePos:["left","right"]}},{uid:"gene-focus",includes:["genes-tss-viewport"],options:{extent:[],minWidth:3,fill:"#cc0078",fillOpacity:.25,stroke:"#cc0078",strokeWidth:0,outlineWidth:0}},{uid:"tss-overlays",includes:["chroms","genes-tss-viewport","variants","stacked-bars","indicatorByCellTypes"],options:{extent:[],minWidth:1,fill:"black",fillOpacity:.05,strokeWidth:0,outline:"black",outlineOpacity:.1,outlineWidth:1,outlinePos:["left"]}}],metaTracks:[{uid:"tss-overlays-meta",type:"annotation-overlay",overlaysTrack:"tss-overlays",options:{annotationTracks:["tss"]}}],layout:{w:12,h:12,x:0,y:0},initialXDomain:[1761366260,1761603836],initialYDomain:[1761366260,1761603836]}]},qe=[120,36,54,20,80,35,101,49,44,23,30,66,5,26,15,105,57,56,74,84,79,93,106,107,34,28,25,55,121,94,58,69,67,63,126,71,72,47,11,46,39,113,29,60,45,76,21,103,129,13,128,90,104,32,109,27,9,130,95,86,53,73,50,48,78,14,92,124,31,114,64,88,12,10,38,68,3,111,70,22,61,98,6,123,118,43,37,65,81,62,33,1,24,122,83,75,112,40,97,16,117,87,19,125,7,102,116,77,8,17,82,115,89,119,18,4,108,59,127,91,0,100,85,110,99,2,96,51,41,52,42],Xe=Fe.groups.reduce((function(e,t,i){var a={label:t.label,color:t.axisLabelColor,background:t.axisLabelBackground,index:i};return t.categories.forEach((function(t){e[t]=a})),e}),{}),Ye={zoomFixed:!1,editable:!1,trackSourceServers:["//higlass.io/api/v1"],views:[{uid:"details",chromInfoPath:"//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv",tracks:{top:[{uid:"chroms",type:"horizontal-chromosome-labels",server:"https://resgen.io/api/v1",tilesetUid:"ADfY_RtsQR6oKOMyrq6qhw",height:17,options:{color:"#999999",stroke:"white",fontSize:10,fontIsLeftAligned:!0,showMousePosition:!1,mousePositionColor:"#000000"}},{uid:"genes",type:"horizontal-gene-annotations",server:"https://resgen.io/api/v1",tilesetUid:"NCifnbrKQu6j-ohVWJLoJw",height:48,options:{fontSize:9,plusStrandColor:"black",minusStrandColor:"black",geneAnnotationHeight:10,geneLabelPosition:"outside",geneStrandSpacing:.5,showMousePosition:!0,showGlobalMousePosition:!0,mousePositionColor:"black"}},{type:"combined",uid:"variants",height:32,contents:[{type:"point-annotation",uid:"ibd-snps",server:"https://resgen.io/api/v1",tilesetUid:"VF5-RDXWTxidGMJU7FeaxA",height:32,options:{axisPositionHorizontal:"right",markColor:"black",markColorFocus:"#cc0078",markSize:2,markOpacity:.33,markOpacityFocus:.66,valueColumn:7,focusRegion:[1761419571,1761419621],name:"IBD Variants",labelPosition:"topLeft",labelColor:"#757575",showMousePosition:!0,showGlobalMousePosition:!0,mousePositionColor:"black",toolTip:{name:{field:3},value:{field:6,numDecimals:2},other:[{label:"Post. Prob.",field:7,numDecimals:2}]}}}]},{uid:"dna-accessibility",type:"ridge-plot",server:"https://resgen.io/api/v1",tilesetUid:"Uz1_tEABQf-uzktblvBKSQ",height:2364,options:{name:"DNA Accessibility",labelPosition:"outerBottom",labelShowResolution:!1,labelShowAssembly:!1,markArea:!0,markColor:"#444444",markResolution:256,valueScaling:"exponential",colorRange:["#ffffff","#000000"],rowHeight:24,rowPadding:-6,rowNormalization:!0,rowSelections:qe,rowIdToCategory:{fn:"replace",args:[".accessibility",""]},rowCategories:Xe,showRowLabels:!0,rowLabelSize:10,showMousePosition:!0,showGlobalMousePosition:!0,mousePositionColor:"black"}}]},overlays:[{uid:"region-focus",includes:["chroms","genes","variants","dna-accessibility"],options:{extent:[],minWidth:3,fill:"#cc0078",fillOpacity:.05,strokeWidth:0,outline:"#cc0078",outlineOpacity:.33,outlineWidth:1,outlinePos:["left","right"]}}],layout:{w:12,h:12,x:0,y:0},initialXDomain:[1761419096,1761420097],initialYDomain:[1761419096,1761420097]}]},Ze=function(e,t,i){return void 0===ke(e,i)?t:ke(e,i)},Je=function(e){return e?e.replace(":","."):e},Ke=function(e){return e?e.replace(".",":"):e},Qe=Object(l.b)({key:"sampleFilterState",default:""}),$e=Object(l.c)({key:"sampleSelection",get:function(e){var t=e.get;return Be.map((function(e){return t(et(e)).checked}))}}),et=Object(Me.a)((function(e){return Object(l.b)({key:"sample-".concat(e),default:{checked:!0,visible:!0}})})),tt=Object(Me.a)((function(e){return Object(l.b)({key:"sampleGroup-".concat(e.name),default:{checked:!0,visible:!0,n:e.options.length,N:e.options.length}})}),(function(e){return e.name})),it=Object(l.b)({key:"variantTracks",default:Object(h.b)([{server:"https://resgen.io/api/v1",tilesetUid:"VF5-RDXWTxidGMJU7FeaxA",columnPvalue:7,columnPosteriorProbability:8,markColor:"black",label:"IBD Variants"}])}),at=Object(l.b)({key:"showVariantsSettings",default:!1}),nt=Object(l.b)({key:"showWelcome",default:Ze("w",!0,je)}),ot=Object(l.b)({key:"dnaAccessLabelStyle",default:Ze("dal","indicator")}),rt=Object(l.b)({key:"dnaAccessLabelShowInfos",default:Ze("dai",!0,je)}),st=Object(l.b)({key:"focusGene",default:Ze("g","")}),ct=Object(l.b)({key:"focusGeneOption",default:null}),lt=Object(l.b)({key:"focusVariant",default:Ze("v","rs1250566")}),ut=Object(l.b)({key:"focusVariantOption",default:null}),ht=(Object(l.b)({key:"focusRegionOption",default:null}),Object(l.b)({key:"variantYScale",default:Ze("vy","pValue")})),dt=Object(l.b)({key:"enhancerRegionsHideUnfocused",default:Ze("erhu",!1,je)}),pt=Object(l.b)({key:"enhancerRegionsColorEncoding",default:Ze("erc","solid")}),mt=Object(l.b)({key:"enhancerRegionsShowInfos",default:Ze("eri",!0,je)}),ft=Object(l.b)({key:"enhancerGenesShowInfos",default:Ze("egi",!0,je)}),gt=Object(l.b)({key:"enhancerGenesPadding",default:Ze("egp",!1,je)}),bt=Object(l.b)({key:"enhancerGenesCellEncoding",default:Ze("egce","number")}),vt=Object(l.b)({key:"enhancerGenesSvg",default:null}),xt=Object(l.b)({key:"higlassEnhancerRegions",default:null}),yt=Object(l.b)({key:"higlassDnaAccess",default:null}),wt=Object(Me.a)((function(e){return Object(l.b)({key:"xDomainStart-".concat(e.totalLength),default:Ze("xs",e.absToChr(1761366260).slice(0,2).join(":"),Ke)})}),(function(e){return e.totalLength})),kt=Object(Me.a)((function(e){return Object(l.b)({key:"xDomainEnd-".concat(e.totalLength),default:Ze("xe",e.absToChr(1761603836).slice(0,2).join(":"),Ke)})}),(function(e){return e.totalLength})),Ct=Object(Me.a)((function(e){return Object(l.c)({key:"xDomainStartAbs-".concat(e.totalLength),get:function(t){var i=(0,t.get)(wt(e));return Ee(i,e)}})}),(function(e){return e.totalLength})),Et=Object(Me.a)((function(e){return Object(l.c)({key:"xDomainEndAbs-".concat(e.totalLength),get:function(t){var i=(0,t.get)(kt(e));return Ee(i,e)}})}),(function(e){return e.totalLength})),Ot=Object(Me.a)((function(e){return Object(l.c)({key:"focusGeneStart-".concat(e.totalLength),get:function(t){var i=(0,t.get)(ct);return i?Ee("".concat(i.chr,":").concat(i.txStart),e):null}})}),(function(e){return e.totalLength})),St=Object(Me.a)((function(e){return Object(l.c)({key:"focusGeneEnd-".concat(e.totalLength),get:function(t){var i=(0,t.get)(ct);return i?Ee("".concat(i.chr,":").concat(i.txEnd),e):null}})}),(function(e){return e.totalLength})),jt=Object(Me.a)((function(e){return Object(l.c)({key:"focusVariantPosition-".concat(e.totalLength),get:function(t){var i=(0,t.get)(ut);return i?Ee("".concat(i.chr,":").concat(i.txStart),e):null}})})),_t=Object(l.c)({key:"focusVariantRelPosition",get:function(e){var t=(0,e.get)(ut);return t?+t.txStart:null}}),Tt=Object(l.c)({key:"focusVariantStrPosition",get:function(e){var t=(0,e.get)(ut);return t?"".concat(t.chr,":").concat(t.txStart):null}}),At=function(){return Re("g",st)},Mt=function(){return Re("v",lt)},Rt=function(){return Re("dai",rt,{decoder:je})},Nt=function(e){return Re("s",wt(e),{encoder:Je})},It=function(e){return Re("e",kt(e),{encoder:Je})},Lt=function(){return Re("eri",mt,{decoder:je})},zt=function(){return Re("egi",ft,{decoder:je})},Pt=Object(g.a)((function(e){return{note:{color:e.palette.grey[400],marginTop:"1em"},title:{fontSize:"1.5rem",fontWeight:700,margin:"0.5rem 0 0 0"},buttonNormal:{minWidth:"10.5rem",margin:"0 0.5rem"},buttonActive:{minWidth:"10.5rem",marginLeft:"0.5rem",color:"white",background:"#cc0078 linear-gradient(45deg, #cc0078 30%, #cc0066 90%)",boxShadow:"0 1px 6px 1px rgba(255, 76, 151, .3)","&:hover":{boxShadow:"0 1px 6px 1px rgba(255, 76, 151, .5)",background:"#d90080 linear-gradient(45deg, #d90080 30%, #d9006c 90%)"},"&:focus":{boxShadow:"0 1px 6px 1px rgba(255, 76, 151, .5)"}},trackList:{margin:"16px 0"}}})),Dt=Object(g.a)((function(e){return{icon:{color:e.palette.grey[400],"&:hover":{color:"black"}},grow:{flex:1},separator:{padding:"0 8px"},server:{flex:1,marginRight:"2px"},tilesetUid:{flex:1,marginLeft:"2px"},propInput:{flex:1,marginLeft:"2px",marginRight:"2px","&:first-child":{marginLeft:0},"&:last-child":{marginRight:0}}}})),Ft=Object(g.a)((function(e){return{arrow:{color:"black"},tooltip:{backgroundColor:"black"}}})),Gt=Object(g.a)((function(e){return{tooltip:{display:"none"}}})),Ht=o.a.memo((function(e){var t=e.config,i=e.onChange,a=Object(n.useState)(t),r=Object(c.a)(a,2),s=r[0],l=r[1],u=function(e){return function(t){var i=t.target.value;l((function(t){return Object(F.a)(Object(F.a)({},t),{},Object(re.a)({},e,i))}))}};Object(n.useEffect)((function(){s!==t&&i(s)}),[i,s,t]);var h=Boolean(s.server||s.tilesetUid),d=Boolean(s.whatever),p=Dt(),m=Ft(),f=Gt();return o.a.createElement(o.a.Fragment,null,o.a.createElement(j.a,{alignItems:"center",container:!0},o.a.createElement(j.a,{className:p.grow,item:!0},o.a.createElement(j.a,{alignItems:"center",container:!0},o.a.createElement(ce.a,{classes:d?m:f,title:"Setting a server will clear the file!",placement:"top",arrow:!0},o.a.createElement(se.a,{label:"Server URL",variant:"outlined",size:"small",value:s.server||"",onChange:function(e){var t=e.target.value;l((function(e){return Object(F.a)(Object(F.a)({},e),{},{server:t,file:void 0})}))},className:p.server})),o.a.createElement(ce.a,{classes:d?m:f,title:"Setting a tileset ID will clear the file!",placement:"top",arrow:!0},o.a.createElement(se.a,{label:"Tileset ID",variant:"outlined",size:"small",value:s.tilesetUid||"",onChange:function(e){var t=e.target.value;l((function(e){return Object(F.a)(Object(F.a)({},e),{},{tilesetUid:t,file:void 0})}))},className:p.tilesetUid})))),o.a.createElement(j.a,{item:!0},o.a.createElement(K.a,{className:p.separator},"or")),o.a.createElement(j.a,{item:!0},o.a.createElement(ce.a,{classes:h?m:f,title:"Selecting a file will clear the server and tileset ID!",placement:"top",arrow:!0},o.a.createElement(me,{file:s.file,onChange:function(e){l((function(t){return Object(F.a)(Object(F.a)({},t),{},{file:e,server:void 0,tilesetUid:void 0})}))},onClear:function(){l((function(e){return Object(F.a)(Object(F.a)({},e),{},{file:void 0})}))}})))),o.a.createElement(j.a,{alignItems:"center",container:!0},o.a.createElement(se.a,{label:"Name",variant:"outlined",margin:"normal",size:"small",value:s.label||"",onChange:u("label"),className:p.propInput}),o.a.createElement(se.a,{label:"Column P-Value",variant:"outlined",margin:"normal",size:"small",type:"number",min:"1",step:"1",value:s.columnPvalue||7,onChange:u("columnPvalue"),className:p.propInput}),o.a.createElement(se.a,{label:"Column Post. Prob",variant:"outlined",margin:"normal",size:"small",type:"number",min:"1",step:"1",value:s.columnPosteriorProbability||8,onChange:u("columnPosteriorProbability"),className:p.propInput})))})),Bt=o.a.memo((function(e){var t=e.closeHandler,i=k(),a=Mt()[1],r=Object(l.d)(it),s=Object(c.a)(r,2),u=s[0],d=s[1],p=Object(n.useState)((function(){return Object(h.b)(u)})),m=Object(c.a)(p,2),f=m[0],g=m[1],b=Object(n.useState)(!1),v=Object(c.a)(b,2),x=v[0],y=v[1],w=Object(n.useRef)([]),C=Object(n.useRef)(u);Object(n.useEffect)((function(){C.current=u}),[u]);var E=Object(n.useCallback)((function(e){return function(t){g((function(i){var a=Object(_.a)(i);return a[e]=t,a})),y(!0)}}),[]),O=Object(n.useCallback)((function(){var e=Object(h.b)(f);w.current.forEach((function(e){e.destroy()})),w.current=e.reduce((function(e,t){if(t.file){var a=Object(F.a)(Object(F.a)({},Ue),{},{name:t.file});e.push(Te(t.file,t.file.name,i,a,{header:!0,columnImportance:7}))}return e}),[]),d(e),(e.some((function(e,t){return e.server!==C.current[t].server}))||e.some((function(e,t){return e.tilesetUid!==C.current[t].tilesetUid}))||e.some((function(e,t){return e.file!==C.current[t].file})))&&a(null),t()}),[i,f,t,d,a]),S=Pt();return o.a.createElement(o.a.Fragment,null,o.a.createElement(K.a,{id:"title",align:"center",variant:"h5",component:"h2",noWrap:!0,className:S.title},"Variant Track"),o.a.createElement("p",{id:"description"},"Variants can be loaded from a remote"," ",o.a.createElement("code",null,o.a.createElement("a",{href:"https://docs.higlass.io/data_preparation.html#bed-files",target:"_blank",rel:"noopener noreferrer"},".beddb"))," ","or a local ",o.a.createElement("code",null,".bed")," file. To access a remote file, please enter the URL of the"," ",o.a.createElement("a",{href:"https://docs.higlass.io/higlass_server.html",target:"_blank",rel:"noopener noreferrer"},"HiGlass server")," ","and the track ID. To access a local file please select it with via the file selection."),o.a.createElement("div",{className:S.trackList},f.map((function(e,t){return o.a.createElement(Ht,{key:t,config:e,onChange:E(t)})}))),o.a.createElement(K.a,{align:"center"},o.a.createElement(A.a,{className:S.buttonNormal,onClick:t,variant:"contained",disableElevation:!0},"Cancel"),o.a.createElement(A.a,{className:x?S.buttonActive:S.buttonNormal,onClick:x?O:t,variant:"contained",disableElevation:!0},x?"Save":"Okay")))})),Wt=Object(g.a)((function(e){return{root:{"&>p":{fontSize:"1.125em"}},title:{display:"flex",justifyContent:"center",margin:e.spacing(2,0,3)},note:{color:e.palette.grey[400],marginTop:"1em"},showTutorial:{minWidth:"10.5rem",marginRight:"0.5rem"},startExploring:{minWidth:"10.5rem",marginLeft:"0.5rem",color:"white",background:"#cc0078 linear-gradient(45deg, #cc0078 30%, #cc0066 90%)",boxShadow:"0 1px 6px 1px rgba(255, 76, 151, .3)","&:hover":{boxShadow:"0 1px 6px 1px rgba(255, 76, 151, .5)",background:"#d90080 linear-gradient(45deg, #d90080 30%, #d9006c 90%)"},"&:focus":{boxShadow:"0 1px 6px 1px rgba(255, 76, 151, .5)"}}}})),Ut=o.a.memo((function(e){var t=e.closeHandler,i=Object(n.useState)(!1),a=Object(c.a)(i,2),r=a[0],s=a[1],l=Wt();return r?o.a.createElement("div",{className:l.root},o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),o.a.createElement(K.a,{align:"center"},o.a.createElement(A.a,{className:l.startExploring,onClick:t,variant:"contained",disableElevation:!0},"Start Exploring!")),o.a.createElement(K.a,{align:"center",className:l.note},o.a.createElement("em",null,'You can reopen this tutorial by clicking on "ABC Enhancer-Gene Connections" in the upper left corner!'))):o.a.createElement("div",{className:l.root},o.a.createElement(K.a,{id:"title",align:"center",variant:"h5",component:"h2",noWrap:!0,className:l.title},o.a.createElement(oe,{styles:{width:"auto"}})),o.a.createElement("p",{id:"description"},"This web application visualizes genome-wide enhancer-gene interactions that were predicted with the ",o.a.createElement("em",null,"Activity-By-Contact")," (ABC) model. You can interactively browse the entire human genome and filter enhancers by gene and containing variant."),o.a.createElement("p",null,"For information regarding the ABC model please refer to our initial publication:"," ",o.a.createElement("a",{href:"https://www.nature.com/articles/s41588-019-0538-0",target:"_blank",rel:"noopener noreferrer"},"Fulco et al., Activity-by-contact model of enhancer\u2013promoter regulation from thousands of CRISPR perturbations,"," ",o.a.createElement("em",null,"Nature Genetics")," (2019)"),"."),o.a.createElement(K.a,{align:"center"},o.a.createElement(A.a,{className:l.showTutorial,onClick:function(){return s(!0)},variant:"contained",disableElevation:!0},"Show Tutorial"),o.a.createElement(A.a,{className:l.startExploring,onClick:t,variant:"contained",disableElevation:!0},"Start Exploring!")))})),Vt=i(443),qt=i(451),Xt=Object(n.createContext)(),Yt=Object(g.a)((function(e){return{root:{display:"flex",alignItems:"center",justifyContent:"center",padding:"4rem"},paper:{backgroundColor:e.palette.background.paper,borderRadius:"0.25rem",boxShadow:e.shadows[4],maxWidth:"60rem",maxHeight:"calc(100vh - 8rem)",overflow:"auto",padding:e.spacing(2,4),outline:0}}}));function Zt(e){var t=e.children,i=Object(n.useState)(null),a=Object(c.a)(i,2),r=a[0],s=a[1],l=Object(n.useState)(null),u=Object(c.a)(l,2),h=u[0],d=u[1],p=Object(n.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;s(e),d((function(){return t}))}),[]),f=Object(n.useCallback)((function(){s(null),d(null)}),[]),g=Yt(),b=Boolean(r);return o.a.createElement(Xt.Provider,{value:p},t,o.a.createElement(qt.a,{"aria-labelledby":"modal-title","aria-describedby":"modal-description",className:g.root,open:b,onClose:h||f,closeAfterTransition:!0,BackdropComponent:m.a,BackdropProps:{timeout:250}},o.a.createElement(Vt.a,{in:b},o.a.createElement("div",{className:g.paper},b&&o.a.createElement(r,{closeHandler:h||f})))))}var Jt=Object(g.a)((function(e){return{h1:{height:"100%",margin:"0",padding:"0",fontSize:"1rem",lineHeight:"1rem",fontWeight:"bold"},drawer:{width:240,flexShrink:0},drawerGrid:{height:"100%"},drawerPaper:{width:240},settings:{position:"relative",flexGrow:1},globalSettingsTitle:{padding:"3px 8px 4px 8px",margin:0,"& h6":{fontSize:"0.8rem",fontWeight:"bold"}},settingsContent:{position:"absolute",top:0,right:0,bottom:0,left:0,overflow:"hidden auto"},toolbar:e.mixins.toolbar,grow:{flexGrow:1},titleBar:{position:"relative",padding:"2px",fontSize:"0.8rem",background:e.palette.grey[100]},titleBarText:{fontSize:"0.8rem"},titleBarContainer:{width:"auto"},titleBarTitle:{padding:"0 2px",fontWeight:900},titleBarIcon:{color:e.palette.grey[400],"&:hover":{color:"black"}},titleBarIconActive:{color:"black","&:hover":{color:"black"}},globalSettingsFirstBox:{margin:e.spacing(0,1,1,1)}}})),Kt=function(e){var t=Object(h.k)(e,"\n",4),i=e.lastIndexOf("\n"),a=+e.substring(e.indexOf('width="')+7,e.indexOf("px",e.indexOf('width="')+7)),n=+e.substring(e.indexOf('height="')+8,e.indexOf("px",e.indexOf('height="')+8));return{core:e.substring(t+1,i),width:a,height:n}},Qt=o.a.memo((function(){var e=k(),t=function(){var e=o.a.useContext(Xt);if(void 0===e)throw new Error("useShowModal must be used within a ModalContext");return e}(),i=Nt(e),a=Object(c.a)(i,2),r=a[0],s=a[1],u=It(e),d=Object(c.a)(u,2),p=d[0],m=d[1],f=Re("w",nt,{decoder:je}),g=Object(c.a)(f,2),b=g[0],v=g[1],x=Object(l.d)(at),y=Object(c.a)(x,2),w=y[0],C=y[1],E=Object(l.e)(xt),O=Object(l.e)(yt),S=Object(l.e)(vt),P=Object(n.useState)(0),F=Object(c.a)(P,2),G=F[0],H=F[1],B=Object(n.useMemo)((function(){return Object(h.f)(r)&&r.indexOf(":")>=0?e.chrToAbs([r.split(":")[0],+r.split(":")[1]]):+r}),[r,e]),W=Object(n.useMemo)((function(){return Object(h.f)(p)&&p.indexOf(":")>=0?e.chrToAbs([p.split(":")[0],+p.split(":")[1]]):+p}),[p,e]),U=Object(n.useCallback)((function(e){s(e.target.value),H(2)}),[s]),V=Object(n.useCallback)((function(e){m(e.target.value),H(2)}),[m]);Object(n.useEffect)((function(){H((function(e){return Math.max(0,e-1)}))}),[r,p]);var q=Object(n.useCallback)((function(){v(!1)}),[v]),X=Object(n.useCallback)((function(){v(!0)}),[v]);Object(n.useEffect)((function(){b?t(Ut,q):t()}),[b,t,q]);var Y=Object(n.useCallback)((function(){C(!1)}),[C]),Z=Object(n.useCallback)((function(){C(!0)}),[C]);Object(n.useEffect)((function(){w?t(Bt,Y):b||t()}),[b,w,t,Y]);var J=function(e,t,i){var a=Kt(e),n=a.core,o=a.width,r=a.height,s=Kt(t),l=s.core,u=s.width,h=s.height,d=i?function(e){var t=e.indexOf(">"),i=e.lastIndexOf("</svg>"),a=e.substring(e.indexOf('viewbox="')+9,e.indexOf('"',e.indexOf('viewbox="')+9)).split(" ").slice(2),n=Object(c.a)(a,2),o=n[0],r=n[1];return{core:e.substring(t+1,i),width:+o,height:+r}}(i):{},p=d.core,m=void 0===p?null:p,f=d.height,g=void 0===f?0:f,b=Ve.views[0].tracks.top.reduce((function(e,t){return e+t.height}),0),v=Ye.views[0].tracks.top.reduce((function(e,t){return e+t.height}),0),x='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg\n    xmlns:xlink="http://www.w3.org/1999/xlink"\n    xmlns="http://www.w3.org/2000/svg" version="1.1" width="_WIDTH_px" height="_HEIGHT_px">\n    <g id="enhancer-plot">\n    _ENHANCER_\n    </g>\n    <g id="enhancer-gene-plot" transform="translate(0, _ENHANCER_GENE_Y_)">\n    _ENHANCER_GENE_\n    </g>\n    <g id="dna-accessibility-plot" transform="translate(_DNA_ACCESS_X_, 0)">\n    _DNA_ACCESS_\n    </g>\n</svg>';return x=(x=(x=(x=(x=(x=(x=x.replace("_WIDTH_",o+u+24)).replace("_HEIGHT_",Math.max(r+g+24,h,b+g+24,v))).replace("_ENHANCER_",n)).replace("_ENHANCER_GENE_Y_",r+24)).replace("_ENHANCER_GENE_",m)).replace("_DNA_ACCESS_X_",o+24)).replace("_DNA_ACCESS_",l),x=null===m?x.replace("_ENHANCER_GENE_",""):x.replace("_ENHANCER_GENE_",m)},K=Jt();return o.a.createElement(R.a,{className:K.drawer,variant:"permanent",classes:{paper:K.drawerPaper},anchor:"left"},o.a.createElement(j.a,{container:!0,direction:"column",className:K.drawerGrid},o.a.createElement(j.a,{item:!0},o.a.createElement(z.a,{className:K.toolbar,style:{width:"100%"},onClick:X},o.a.createElement("h1",{className:K.h1},o.a.createElement(oe,null))),o.a.createElement(M.a,null)),o.a.createElement(j.a,{container:!0,item:!0,className:K.grow,direction:"column"},o.a.createElement(j.a,{item:!0},o.a.createElement(T.a,{m:1},o.a.createElement(T.a,{m:0},o.a.createElement(N.a,{variant:"outlined",margin:"dense",fullWidth:!0},o.a.createElement(I.a,{htmlFor:"x-domain-start"},"Region Start"),o.a.createElement(L.a,{id:"x-domain-start",label:"Region Start",onChange:U,value:r}))),o.a.createElement(T.a,{m:0},o.a.createElement(N.a,{variant:"outlined",margin:"dense",fullWidth:!0},o.a.createElement(I.a,{htmlFor:"x-domain-end"},"Region End"),o.a.createElement(L.a,{id:"x-domain-end",label:"Region End",onChange:V,value:p}))),G>0&&o.a.createElement(T.a,{m:0},o.a.createElement(A.a,{variant:"contained",margin:"dense",onClick:function(e){if(E){var t=Object(_.a)(E.getViewConfig().views[0].initialXDomain);Number.isNaN(+B)||(t[0]=B),Number.isNaN(+W)||(t[1]=W),E.zoomTo("context",t[0],t[1],t[0],t[1],2e3)}},fullWidth:!0,disableElevation:!0,size:"small"},"Go"))),o.a.createElement(M.a,null),o.a.createElement(T.a,{m:1},o.a.createElement(A.a,{variant:"contained",margin:"dense",fullWidth:!0,disableElevation:!0,size:"small",startIcon:o.a.createElement(D.a,null),onClick:Z},"Edit Variants")),o.a.createElement(M.a,null)),o.a.createElement(j.a,{item:!0,className:K.settings},o.a.createElement(T.a,{m:0,className:K.settingsContent},o.a.createElement(T.a,{className:K.globalSettingsFirstBox},o.a.createElement(ie,{filterState:Qe,filterLabel:"Filter Samples",optionWithName:et,optionGroupWithGroup:tt,groupedOptions:Ge,optionToGroup:He,groupColors:Ie,groupColorsDark:Le})))),o.a.createElement(j.a,{item:!0},o.a.createElement(M.a,null),o.a.createElement(T.a,{m:1},o.a.createElement(A.a,{variant:"contained",margin:"dense",onClick:function(){if(E&&O){var e,t=J(E.exportAsSvg(),O.exportAsSvg(),S?(e=S,(new window.XMLSerializer).serializeToString(e)):null);!function(e,t){var i="string"===typeof t?new Blob([t],{type:"application/octet-stream"}):t;if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(i,e);else{var a=window.document.createElement("a");a.href=window.URL.createObjectURL(i),a.download=e,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(a.href)}}("abc-enhancers.svg",new Blob([t],{type:"image/svg+xml"}))}else console.warn("One of the HiGlass instances is not available")},fullWidth:!0,disableElevation:!0,size:"small"},"Export as SVG"))))))})),$t=i(492),ei=i(493),ti=i(242),ii=i.n(ti),ai=i(500),ni=i(506),oi=i(141),ri=i(189),si=i.n(ri),ci=Object(g.a)((function(e){return{inputRoot:{background:"white !important",borderTopLeftRadius:0,borderTopRightRadius:0,"&::before":{borderBottomWidth:0,boxShadow:"0 1px 0 0 rgba(0, 0, 0, 0)",transition:"boxShadow 0.2s ease"},"&:hover::before":{borderBottomWidth:0,boxShadow:"0 1px 0 0 rgba(0, 0, 0, 1)"}},focused:{boxShadow:"0 1px 0 0 rgba(0, 0, 0, 1)"},input:{height:35,padding:"6px 0 6px"},textFieldRoot:{"& .MuiFormLabel-root":{color:"black",fontWeight:"bold",transform:"translate(12px, 21px) scale(1.25)"},"& .MuiInputLabel-shrink":{fontWeight:"normal"}}}})),li=function(){var e=Object(O.a)(E.a.mark((function e(t,i){var a,n,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=5;break}return e.next=3,fetch("".concat(t,"&ac=").concat(i||""));case 3:return a=e.sent,e.abrupt("return",a.json());case 5:return e.next=7,fetch("".concat(t.url,"&ac=").concat(i||""));case 7:return n=e.sent,e.next=10,n.json();case 10:return o=e.sent,e.abrupt("return",o.map((function(e){return e.type=t.type,e})));case 12:case"end":return e.stop()}}),e)})));return function(t,i){return e.apply(this,arguments)}}();function ui(e){return o.a.createElement(oi.a,Object.assign({viewBox:"0 0 16 16"},e),o.a.createElement("path",{d:"M5.03 14.378A7.33 7.33 0 003.423 16h2.42a7.762 7.762 0 011.281-.774 13.241 13.241 0 01-1.863-1.016c-.078.054-.156.11-.233.168zM5.766 0l.219.174a8.754 8.754 0 001.636.92l.024.008c.797.24 1.507.627 2.023.933.325.18.674.4 1.024.66 1.825 1.363 2.79 3.22 2.79 5.367 0 2.062-.962 3.89-2.782 5.286-.061.048-.125.094-.186.139a10.45 10.45 0 00-1.895-.955 8.17 8.17 0 001.69-1.162h-3.92a6.191 6.191 0 01-1.199-1.15h6.093a4.054 4.054 0 00.603-1.747H3.839c.072.656.307 1.239.636 1.747h.011c.282.438.628.822.991 1.15H5.47l.74.584c.831.588 1.573.893 1.636.92a9.358 9.358 0 012.847 1.504A7.38 7.38 0 0112.3 16H9.879l-.759-.5a7.876 7.876 0 00-1.256-.594 11.833 11.833 0 01-2.07-1.04l.017-.009c-1.567-.999-3.571-2.851-3.571-5.794 0-2.149.964-4.005 2.79-5.367.076-.058.154-.113.231-.167.495.32 1.143.698 1.863 1.015a7.677 7.677 0 00-1.296.786c-.043.032-.083.066-.125.098h3.318c.535.336.999.727 1.364 1.149H4.598a4.215 4.215 0 00-.721 1.748h7.97l-.038-.195a3.527 3.527 0 00-.306-.904 4.417 4.417 0 00-.378-.65l-.01-.007a5.793 5.793 0 00-1.081-1.13l-.14-.109a7.236 7.236 0 00-.722-.48l-.031-.02a7.942 7.942 0 00-1.276-.607 10.278 10.278 0 01-1.257-.57C5.728 2.218 4.31 1.364 3.281 0h2.486zm6.267 0a7.808 7.808 0 01-1.743 1.707A10.443 10.443 0 008.396.752 8.592 8.592 0 009.592 0h2.442z"}))}function hi(e){return o.a.createElement(j.a,{key:e.option.geneName,container:!0,direction:"row",alignItems:"center"},o.a.createElement(ui,{fontSize:"small"}),o.a.createElement("span",null,e.option.geneName))}function di(e){return o.a.createElement(j.a,{key:e.option.geneName,container:!0,direction:"row",alignItems:"center"},o.a.createElement(si.a,{fontSize:"small"}),o.a.createElement("span",null,e.option.geneName))}function pi(e){return"gene"===e.option.type?o.a.createElement(hi,{option:e.option}):"variant"===e.option.type?o.a.createElement(di,{option:e.option}):o.a.createElement("div",null,e.option.geneName)}function mi(e){var t=Object(n.useState)(!1),i=Object(c.a)(t,2),a=i[0],r=i[1],s=Object(n.useState)([]),l=Object(c.a)(s,2),u=l[0],d=l[1],p=Object(n.useState)(e.inputValue),m=Object(c.a)(p,2),g=m[0],b=m[1],v=Q(g,250),x=a&&0===u.length,y=ci(),w=Object(F.a)({},y);delete w.textFieldRoot;var k=e.customSearch,C=e.searchUrl;Object(n.useEffect)((function(){var e=!0;if(a){d([]);var t=Array.isArray(C)?C.map((function(e){return li(e,v)})):[li(C,v)];return k&&t.push(k(v)),Promise.all(t).then((function(t){e&&d(t.flat().filter(h.c))})),function(){e=!1}}}),[C,k,a,v]),Object(n.useEffect)((function(){a||d([])}),[a]);var E=e.multiple&&!Array.isArray(e.value)?[e.value]:e.value,O=E&&0===u.length?E:u;return O=Array.isArray(O)?O:[O],o.a.createElement(ai.a,{classes:e.larger?w:{},multiple:e.multiple,onChange:function(t,i){e.onChange(i)},value:E,onInputChange:function(e,t){e&&b(t)},fullWidth:e.fullWidth,style:{width:e.fullWidth?"auto":e.width},open:a,onOpen:function(){r(!0)},onClose:function(){r(!1)},getOptionSelected:function(e,t){return e.geneName===t.geneName},getOptionLabel:function(e){return e?e.geneName:""},options:O,loading:x,renderInput:function(t){return o.a.createElement(se.a,Object.assign({},t,{className:e.larger?y.textFieldRoot:"",id:e.id,label:e.label,variant:e.variant,size:e.size,InputProps:Object(F.a)(Object(F.a)({},t.InputProps),{},{endAdornment:o.a.createElement(o.a.Fragment,null,x?o.a.createElement(f.a,{color:"inherit",size:20}):null,t.InputProps.endAdornment)})}))},renderOption:function(e){return o.a.createElement(pi,{option:e})},renderTags:function(e,t){return e.map((function(e,i){return o.a.createElement(ni.a,Object.assign({icon:"gene"===e.type?o.a.createElement(ui,null):o.a.createElement(si.a,null),key:e.geneName,label:e.geneName},t({index:i})))}))}})}mi.defaultProps={fullWidth:!0,id:"",label:"",multiple:!1,onChange:h.c,size:"small",value:null,variant:"outlined",width:"10rem"};var fi=Object(g.a)((function(e){return{appBar:{width:"calc(100% - ".concat(240,"px)"),marginLeft:240,color:e.palette.common.black,backgroundColor:e.palette.common.white,boxShadow:"0 1px 0 0 ".concat(e.palette.grey[300])},toolbarExtra:{paddingLeft:0,paddingRight:0,alignItems:"flex-end"}}})),gi=function(){var e=Object(O.a)(E.a.mark((function e(t){var i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",void 0);case 2:if(!(i=t.match(/^chr(\d+):(\d)+$/))||!(+i[1]>0&&+i[1]<23||"x"===+i[1].toLowerCase()||"y"===+i[1].toLowerCase())){e.next=5;break}return e.abrupt("return",[{chr:"chr".concat(i[1]),txStart:+i[2],txEnd:+i[2]+1,score:0,geneName:t,type:"nucleotide"}]);case 5:return e.abrupt("return",void 0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),bi=o.a.memo((function(){var e=At(),t=Object(c.a)(e,2),i=t[0],a=t[1],r=Mt(),s=Object(c.a)(r,2),u=s[0],h=s[1],d=Object(l.d)(ct),p=Object(c.a)(d,2),m=p[0],f=p[1],g=Object(l.d)(ut),b=Object(c.a)(g,2),v=b[0],x=b[1],y=Ae(m),w=Ae(v),k=Object(n.useMemo)((function(){var e=[];return m&&m===y&&e.push(m),v&&v===w&&e.push(v),m&&m!==y&&e.push(m),v&&v!==w&&e.push(v),e}),[m,v]),C=function(){a(""),f(null)},E=function(){h(""),x(null)},O=fi();return o.a.createElement($t.a,{position:"fixed",className:O.appBar},o.a.createElement(ei.a,{classes:{root:O.toolbarExtra}},o.a.createElement(N.a,{fullWidth:!0},o.a.createElement(mi,{label:o.a.createElement(j.a,{container:!0,direction:"row",alignItems:"center"},o.a.createElement(ii.a,{fontSize:"small"}),o.a.createElement("span",{style:{marginLeft:3}},"Gene or Variant")),customSearch:gi,searchUrl:[{url:Pe,type:"gene"},{url:De,type:"variant"}],onChange:function(e){if(e.length){var t={};e.slice(e.length-2).forEach((function(e){switch(e.type){case"gene":t.gene=e,i!==e.geneName&&(a(e.geneName),f(e));break;case"variant":t.variant=e,u!==e.geneName&&(h(e.geneName),x(e));break;default:console.warn("Unknown focus element",e)}})),i&&!t.gene&&C(),u&&!t.variant&&E()}else C(),E()},value:k,variant:"filled",larger:!0,fullWidth:!0,multiple:!0}))))})),vi=Object(g.a)((function(e){return{root:{display:"flex",justifyContent:"space-between"},text:{fontSize:"0.8rem"},black:{color:"black"},gray:{color:e.palette.grey[400]},pink:{color:"#cc0078"}}})),xi=o.a.memo((function(){var e=Object(l.e)(mt),t=Object(l.e)(st),i=Object(l.e)(lt),a=vi();return e?o.a.createElement(o.a.Fragment,null,t&&i&&o.a.createElement(K.a,{className:a.text,noWrap:!0},o.a.createElement("span",{className:a.pink},"\u25a0")," Enhancers containing"," ",o.a.createElement("em",null,i)," and predicted to regulate ",o.a.createElement("em",null,t)),t&&!i&&o.a.createElement(K.a,{className:a.text,noWrap:!0},o.a.createElement("span",{className:a.pink},"\u25a0")," Enhancers predicted to regulate ",o.a.createElement("em",null,t)),!t&&i&&o.a.createElement(K.a,{className:a.text,noWrap:!0},o.a.createElement("span",{className:a.pink},"\u25a0")," Enhancers containing"," ",o.a.createElement("em",null,i)),t||i?o.a.createElement(K.a,{className:a.text,noWrap:!0},o.a.createElement("span",{className:a.gray},"\u25a0")," All other predicted enhancers"):o.a.createElement(K.a,{className:a.text,noWrap:!0},o.a.createElement("span",{className:a.black},"\u25a0")," All predicted enhancers")):""})),yi=o.a.memo((function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(K.a,null,"This panel visualizes the predicted enhancers by sample type as a matrix-like track. Each rectangle representes an enhancer. Promoter regions are indicated by translucent light gray overlays."),o.a.createElement(K.a,null," ","You can filter enhancers via their target gene or by variant (the dot plot below the gene annotations). Click on a variant or gene to select it. Selections are shown in pink/red."))})),wi=i(445),ki=i(37),Ci=i.n(ki),Ei=i(38),Oi=i.n(Ei),Si=i(446),ji=i(507),_i=i(494),Ti=Object(g.a)((function(e){return{iconRadioLegend:{margin:e.spacing(2,0,.25,0)}}})),Ai=o.a.memo((function(){var e=Re("vs",ht),t=Object(c.a)(e,2),i=t[0],a=t[1],r=Re("eri",dt,{decoder:je}),s=Object(c.a)(r,2),l=s[0],u=s[1],h=Re("eri",pt),d=Object(c.a)(h,2),p=d[0],m=d[1],f=Object(n.useCallback)((function(e){u(e.target.checked)}),[u]),g=Object(n.useCallback)((function(e){return function(){a(e)}}),[a]),b=Object(n.useCallback)((function(e){return function(){m(e)}}),[m]),v=Ti();return o.a.createElement(o.a.Fragment,null,o.a.createElement(T.a,{m:1},o.a.createElement(Z.a,{control:o.a.createElement(_i.a,{checked:l,onChange:f,name:"hideUnfocused"}),label:"Hide unfocused enhancer regions"})),o.a.createElement(T.a,{m:1},o.a.createElement(N.a,{component:"fieldset"},o.a.createElement(Si.a,{component:"legend",className:v.iconRadioLegend},"Variant y-scale"),o.a.createElement(ji.a,{"aria-label":"variantYScale",name:"variantYScale",value:i},o.a.createElement(Z.a,{label:"p-value",value:"pValue",className:v.iconRadio,control:o.a.createElement(wi.a,{size:"small",onClick:g("pValue")},"pValue"===i?o.a.createElement(Ci.a,{className:v.iconRadioActive,fontSize:"inherit"}):o.a.createElement(Oi.a,{fontSize:"inherit"}))}),o.a.createElement(Z.a,{label:"Posterior probability",value:"posteriorProbability",className:v.iconRadio,control:o.a.createElement(wi.a,{size:"small",onClick:g("posteriorProbability")},"posteriorProbability"===i?o.a.createElement(Ci.a,{className:v.iconRadioActive,fontSize:"inherit"}):o.a.createElement(Oi.a,{fontSize:"inherit"}))})))),o.a.createElement(T.a,{m:1},o.a.createElement(N.a,{component:"fieldset"},o.a.createElement(Si.a,{component:"legend",className:v.iconRadioLegend},"Matrix colorEncoding"),o.a.createElement(ji.a,{"aria-label":"colorEncoding",name:"colorEncoding",value:p},o.a.createElement(Z.a,{label:"Solid",value:"solid",className:v.iconRadio,control:o.a.createElement(wi.a,{size:"small",onClick:b("solid")},"solid"===p?o.a.createElement(Ci.a,{className:v.iconRadioActive,fontSize:"inherit"}):o.a.createElement(Oi.a,{fontSize:"inherit"}))}),o.a.createElement(Z.a,{label:"Number of predictions",value:"frequency",className:v.iconRadio,control:o.a.createElement(wi.a,{size:"small",onClick:b("frequency")},"frequency"===p?o.a.createElement(Ci.a,{className:v.iconRadioActive,fontSize:"inherit"}):o.a.createElement(Oi.a,{fontSize:"inherit"}))}),o.a.createElement(Z.a,{label:"Highest prediction score",value:"highestImportance",className:v.iconRadio,control:o.a.createElement(wi.a,{size:"small",onClick:b("highestImportance")},"highestImportance"===p?o.a.createElement(Ci.a,{className:v.iconRadioActive,fontSize:"inherit"}):o.a.createElement(Oi.a,{fontSize:"inherit"}))}),o.a.createElement(Z.a,{label:"Prediction score of the closest connection",value:"closestImportance",className:v.iconRadio,control:o.a.createElement(wi.a,{size:"small",onClick:b("closestImportance")},"closestImportance"===p?o.a.createElement(Ci.a,{className:v.iconRadioActive,fontSize:"inherit"}):o.a.createElement(Oi.a,{fontSize:"inherit"}))})))))})),Mi=i(244),Ri=i.n(Mi),Ni=i(243),Ii=i.n(Ni),Li=i(490),zi=Object(g.a)((function(e){return{grow:{flexGrow:1},bar:{position:"relative",padding:"2px",fontSize:"0.8rem",background:e.palette.grey[100]},title:{fontSize:"0.8rem",padding:"0 2px",fontWeight:900},icon:{color:e.palette.grey[400],"&:hover":{color:"black"}},iconActive:{color:e.palette.grey[600],"&:hover":{color:"black"}},popeover:{"& > *":{maxWidth:"20rem",padding:"0.5rem",fontSize:"0.8rem","&+p":{paddingTop:0}}},info:{"&> *":{padding:"0 2px"},"&> *:last-child":{borderBottom:"1px solid ".concat(e.palette.grey[100])}}}})),Pi=o.a.memo((function(e){var t=e.id,i=e.title,a=e.Info,r=e.Help,s=e.Settings,l=e.useShowInfo,u=e.popoverDirection,h=void 0===u?"bottom":u,d=l(),p=Object(c.a)(d,2),m=p[0],f=p[1],g=Object(n.useState)(),b=Object(c.a)(g,2),v=b[0],x=b[1],y=Object(n.useState)(),w=Object(c.a)(y,2),k=w[0],C=w[1],E=Object(n.useCallback)((function(){f((function(e){return!(!0===e||"true"===e)}))}),[f]),O=Object(n.useCallback)((function(e){x(e.currentTarget)}),[]),S=Object(n.useCallback)((function(){x(null)}),[]),_=Object(n.useCallback)((function(e){C(e.currentTarget)}),[]),T=Object(n.useCallback)((function(){C(null)}),[]),A=Object(n.useMemo)((function(){return"".concat(t,"-help")}),[t]),M=Object(n.useMemo)((function(){return"".concat(t,"-settings")}),[t]),R=Object(n.useMemo)((function(){return"bottom"===h?"bottom":"top"}),[h]),N=Object(n.useMemo)((function(){return"bottom"===h?"top":"bottom"}),[h]),I=zi(),L=Boolean(v),z=Boolean(k),P=m?I.iconActive:I.icon,F=L?I.iconActive:I.icon,G=z?I.iconActive:I.icon;return o.a.createElement(j.a,{item:!0,className:I.root},o.a.createElement(j.a,{item:!0,className:I.bar,container:!0,alignItems:"center",wrap:"nowrap"},o.a.createElement(j.a,{item:!0,container:!0,alignItems:"center",wrap:"nowrap",className:I.grow},o.a.createElement(K.a,{component:"h3",className:I.title,noWrap:!0},i,":")),o.a.createElement(j.a,{item:!0},o.a.createElement(j.a,{container:!0,alignItems:"center",wrap:"nowrap"},o.a.createElement(wi.a,{"aria-label":"details",className:P,size:"small",onClick:E},o.a.createElement(Ii.a,{fontSize:"inherit"})),o.a.createElement(wi.a,{"aria-label":"help","aria-describedby":A,className:F,size:"small",onClick:O},o.a.createElement(Ri.a,{fontSize:"inherit"})),o.a.createElement(Li.a,{id:A,open:L,anchorEl:v,onClose:S,anchorOrigin:{vertical:R,horizontal:"right"},transformOrigin:{vertical:N,horizontal:"right"}},o.a.createElement("div",{className:I.popeover},o.a.createElement(r,null))),o.a.createElement(wi.a,{"aria-label":"settings","aria-describedby":M,className:G,size:"small",onClick:_},o.a.createElement(D.a,{fontSize:"inherit"})),o.a.createElement(Li.a,{id:A,open:z,anchorEl:k,onClose:T,anchorOrigin:{vertical:R,horizontal:"right"},transformOrigin:{vertical:N,horizontal:"right"}},o.a.createElement("div",{className:I.popeover},o.a.createElement(s,null)))))),o.a.createElement(j.a,{item:!0,className:I.info},m&&o.a.createElement(a,null)))})),Di=function(e){return e.views[0].overlays[1]&&e.views[0].overlays[1].options.extent&&e.views[0].overlays[1].options.extent.length?Object(_.a)(e.views[0].overlays[1].options.extent[0]):null},Fi=function(e){var t=e.views[0].tracks.top[2],i=null;if("combined"===t.type){if(!t.contents[0])return i;i=t.contents[0].options.focusRegion}else i=t.options.focusRegion;return i?Object(_.a)(i):i},Gi=function(e){return function(t){var i=t.views[0].tracks.top[2];return"combined"===i.type&&(i.contents=e.reduce((function(e,t){var i=Object(h.b)(We);return t.server&&t.tilesetUid?(i.server=t.server,i.tilesetUid=t.tilesetUid,i.uid="variants-".concat(t.tilesetUid),i.options.name=t.label||"Variants",e.push(i)):t.file&&(i.data={type:"localBed",id:t.file.name},i.uid="variants-".concat(t.file.name),i.options.name=t.label||"Variants",e.push(i)),e}),[]),i.height=32*(i.contents.length>0)),t}},Hi=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(i){if(Number.isNaN(+e)||null===e)t.forEach((function(e){var t;"combined"===(t=i.views[0].tracks.top[e]).type?t.contents.forEach((function(e){delete e.options.focusRegion})):delete t.options.focusRegion})),i.views[0].overlays[0].options.extent=[];else{var a=[e-.5,e+.5];t.forEach((function(e){!function(e,t){"combined"===e.type?e.contents.forEach((function(e){e.options.focusRegion=t})):e.options.focusRegion=t}(i.views[0].tracks.top[e],a)})),i.views[0].overlays[0].options.extent=[a]}return i}},Bi=function(e){return function(t){var i=t.views[0].tracks.top[2];return"combined"===i.type?i.contents.forEach((function(t){t.options.valueColumn="pValue"===e?7:8})):i.options.valueColumn="pValue"===e?7:8,t}},Wi=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.force,n=void 0!==a&&a;return function(i){var a=!0===n||Object(h.d)(n)&&n(),o=Object(_.a)(i.views[0].initialXDomain),r=Di(i),s=Fi(i);return Number.isNaN(+e)||(o[0]=e),Number.isNaN(+t)||(o[1]=t),r&&!a&&(o[0]=r[0]-1e5,o[1]=r[1]+1e5),s&&!a&&(o[0]=Math.min(o[0],s[0]-1e5),o[1]=Math.max(o[1],s[1]+1e5)),i.views[0].initialXDomain=o,i}},Ui=(i(232),i(435),Object(g.a)((function(e){return{grow:{flexGrow:1},fullWidthHeight:{position:"absolute",top:0,right:0,bottom:0,left:0},higlassContainer:{position:"relative",minHeight:"100%",overflow:"hidden"},panZoomTip:{position:"absolute",zIndex:11,top:0,left:0,right:0,padding:"0 2px",fontSize:"0.8rem",lineHeight:"1.5rem",background:e.palette.grey[100],textAlign:"center",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)",opacity:1,animation:"0.75s ease 3s 1 running forwards fadeout","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none",userSelect:"none",transition:"0.25s ease opacity, 0.25s ease transform","&:hover":{opacity:0}},panZoomTipNormal:{color:e.palette.grey[600]},panZoomTipNormalHover:{fontWeight:"bold",color:"black",background:"#aaa",animation:"0.75s ease 5s 1 running forwards fadeout"},panZoomTipActive:{color:"white",background:"#dd55a5",animation:"0.75s ease 5s 1 running forwards fadeout"},panZoomTipActiveHover:{fontWeight:"bold",color:"white",background:"#cc0078",animation:"0.75s ease 5s 1 running forwards fadeout"}}}))),Vi=o.a.memo((function(e){var t=k(),i=Object(l.d)(ct),a=Object(c.a)(i,2),r=a[0],s=a[1],d=At()[1],p=Mt()[1],m=Nt(t)[1],f=It(t)[1],g=Object(l.f)(ut),b=Object(l.f)(xt),v=Object(l.e)(it),x=Object(l.e)(dt),y=Object(l.e)(ht),w=Object(l.e)(pt),C=Object(l.e)(jt(t)),E=Object(l.e)(Ct(t)),O=Object(l.e)(Et(t)),S=Object(l.e)(Ot(t)),j=Object(l.e)(St(t)),_=Object(n.useState)(!1),T=Object(c.a)(_,2),A=T[0],M=T[1],R=Object(n.useState)(!1),N=Object(c.a)(R,2),I=N[0],L=N[1],z=Object(n.useRef)(null),P=Object(n.useRef)(null),D=Object(n.useRef)(!1),F=Object(n.useRef)(0),G=Object(n.useRef)(0),H=Object(n.useRef)(0),B=function(){return!!P.current&&(P.current=!1,!0)};Object(n.useEffect)((function(){F.current+=A}),[A]),Object(n.useEffect)((function(){G.current+=I}),[I]),Object(n.useEffect)((function(){I?H.current+=!A:H.current=0}),[I,A]);var W=Object(n.useMemo)((function(){return Object(h.l)(Gi(v),(t=r?r.geneName:null,i=S,a=j,function(e){var n=e.views[0].tracks.top.length;return t?(e.views[0].tracks.top[n-1].options.focusGene=t,e.views[0].overlays[1].options.extent=[[i,a]]):(delete e.views[0].tracks.top[n-1].options.focusGene,delete e.views[0].overlays[1].options.extent),e}),Hi(C,[2,4]),function(e){return function(t){return t.views[0].tracks.top[4].options.focusStyle=e?"filtering":"highlighting",t.views[0].tracks.top[4].options.stratification.axisNoGroupColor=!e,t}}(x),(e=w,function(t){return t.views[0].tracks.top[4].options.opacityEncoding=e,t}),Bi(y),Wi(E,O,{force:B}))(Object(h.b)(Ve));var e,t,i,a}),[v,r,S,j,C,x,w,y]),U=Object(n.useMemo)((function(){return W.views[0].tracks.top.reduce((function(e,t){return e+t.height}),0)}),[W]),V=Object(n.useMemo)((function(){return I?"higlass-block focus":"higlass-block"}),[I]),q=function(e){"gene-annotation"===e.type?(d(e.payload.name),P.current=!0,s({chr:e.payload.fields[0],txStart:e.payload.fields[1],txEnd:e.payload.fields[2],geneName:e.payload.name,type:"gene"})):"snp"===e.type?(p(e.payload.name),P.current=!0,g({chr:e.payload.fields[0],txStart:e.payload.fields[1],txEnd:e.payload.fields[2],geneName:e.payload.name,score:e.payload.importance,type:"variant"})):"annotation"===e.type&&console.log("clicked on annotation",e.payload)},X=Object(h.a)((function(e){var i=e.xDomain.map((function(e){return t.absToChr(e).slice(0,2).join(":")})),a=Object(c.a)(i,2),n=a[0],o=a[1];m(n),f(o)}),250),Y=Object(n.useCallback)((function(e){Object(h.e)(e.target,z.current)||L(!1),D.current=!1}),[]);Object(n.useEffect)((function(){window.addEventListener("mouseup",Y),window.addEventListener("blur",Y)}),[]);var Z=Object(n.useCallback)((function(){D.current=!0}),[]),J=Object(n.useCallback)((function(e){null!==e&&(b(e.api),e.api.on("click",q),e.api.on("location",X,"context"),e.api.getComponent().element.addEventListener("mousedown",Z))}),[]),Q=Ui();return o.a.createElement("div",{className:Q.root},o.a.createElement(Pi,{id:"enhancer-regions",title:"Enhancer Regions",useShowInfo:Lt,Info:xi,Help:yi,Settings:Ai}),o.a.createElement("div",{className:"higlass-container ".concat(Q.higlassContainer),onMouseEnter:function(){M(!0)},onMouseLeave:function(){M(!1)},ref:z,style:{height:"".concat(U,"px")}},I&&!A&&G.current<2&&H.current<1&&o.a.createElement(K.a,{component:"div",className:"panZoomTip ".concat(Q.panZoomTip," ").concat(Q.panZoomTipActive),noWrap:!0},"Click outside to deactivate pan & zoom!"),I&&A&&G.current<2&&H.current<1&&o.a.createElement(K.a,{component:"span",className:"panZoomTip ".concat(Q.panZoomTip," ").concat(Q.panZoomTipActiveHover),noWrap:!0},"You can now pan & zoom the plot!"),!I&&A&&F.current<2&&o.a.createElement(K.a,{component:"div",className:"panZoomTip ".concat(Q.panZoomTip," ").concat(Q.panZoomTipNormalHover),noWrap:!0},"Click to activate pan & zoom!"),!I&&!A&&F.current<2&&o.a.createElement(K.a,{component:"span",className:"panZoomTip ".concat(Q.panZoomTip," ").concat(Q.panZoomTipNormal),noWrap:!0},"This plot is interactive!"),o.a.createElement("div",{className:V,onMouseDown:Z,onFocus:function(){L(!0)},onBlur:function(){D.current||L(!1)},tabIndex:"0"}),o.a.createElement(u.HiGlassComponent,{ref:J,viewConfig:W,options:{sizeMode:"bounded",globalMousePosition:!0}})))})),qi=Object(g.a)((function(e){return{root:{display:"flex",justifyContent:"space-between"},text:{fontSize:"0.8rem"},placeholder:{fontStyle:"italic",color:e.palette.grey[600]}}})),Xi=o.a.memo((function(){var e=Object(l.e)(ft),t=Object(l.e)(lt),i=qi();return e?o.a.createElement("div",null,t?o.a.createElement(K.a,{className:i.text},"Enhancer regions overlapping ",o.a.createElement("em",null,t)," and its predicted connections to upstream (left) and downstream (right) genes."):o.a.createElement(j.a,{container:!0,justify:"center",alignItems:"center",className:i.placeholder},o.a.createElement(K.a,{className:i.text},"Select a variant to see details"))):""})),Yi=o.a.memo((function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(K.a,null,"..."))})),Zi=Object(g.a)((function(e){return{iconRadio:{padding:e.spacing(.5,0),marginLeft:-e.spacing(1)/2,"& .MuiFormControlLabel-label":{lineHeight:1.2}},iconRadioActive:{color:"black"},iconRadioLegend:{margin:e.spacing(2,0,.25,0)}}})),Ji=o.a.memo((function(){var e=Re("egce",bt),t=Object(c.a)(e,2),i=t[0],a=t[1],r=Re("egp",gt,{decoder:je}),s=Object(c.a)(r,2),l=s[0],u=s[1],h=Object(n.useCallback)((function(e){return function(){a(e)}}),[a]),d=Object(n.useCallback)((function(e){return function(){u(e)}}),[u]),p=Zi();return o.a.createElement(o.a.Fragment,null,o.a.createElement(T.a,{m:1},o.a.createElement(Z.a,{control:o.a.createElement(_i.a,{checked:l,onChange:d,name:"true"}),label:"Gene padding"})),o.a.createElement(T.a,{m:1},o.a.createElement(N.a,{component:"fieldset"},o.a.createElement(Si.a,{component:"legend",className:p.iconRadioLegend},"Gene Cell Encoding"),o.a.createElement(ji.a,{"aria-label":"cellEncoding",name:"cellEncoding",value:i},o.a.createElement(Z.a,{label:"Number of predictions",value:"number",className:p.iconRadio,control:o.a.createElement(wi.a,{size:"small",onClick:h("number")},"number"===i?o.a.createElement(Ci.a,{className:p.iconRadioActive,fontSize:"inherit"}):o.a.createElement(Oi.a,{fontSize:"inherit"}))}),o.a.createElement(Z.a,{label:"Percentage of samples with predictions",value:"percent",className:p.iconRadio,control:o.a.createElement(wi.a,{size:"small",onClick:h("percent")},"percent"===i?o.a.createElement(Ci.a,{className:p.iconRadioActive,fontSize:"inherit"}):o.a.createElement(Oi.a,{fontSize:"inherit"}))}),o.a.createElement(Z.a,{label:"Distribution by prediction score",value:"distribution",className:p.iconRadio,control:o.a.createElement(wi.a,{size:"small",onClick:h("distribution")},"distribution"===i?o.a.createElement(Ci.a,{className:p.iconRadioActive,fontSize:"inherit"}):o.a.createElement(Oi.a,{fontSize:"inherit"}))}),o.a.createElement(Z.a,{label:"Sample array",value:"array",className:p.iconRadio,control:o.a.createElement(wi.a,{size:"small",onClick:h("array")},"array"===i?o.a.createElement(Ci.a,{className:p.iconRadioActive,fontSize:"inherit"}):o.a.createElement(Oi.a,{fontSize:"inherit"}))})))))})),Ki=i(19),Qi=i(55),$i=i(190),ea=Object(n.createContext)(),ta=Object(g.a)({root:{position:"fixed",zIndex:10,width:1,height:1,background:"black",fontWeight:"normal",pointerEvents:"none","& strong":{fontWeight:"bold"}}});function ia(e){var t=e.children,i=Object(n.useState)({show:!1,title:"",x:0,y:0,arrow:!0,placement:"bottom",classes:{}}),a=Object(c.a)(i,2),r=a[0],s=a[1],l=Object(n.useCallback)((function(e,t,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=a.arrow,o=void 0!==n&&n,r=a.placement,c=void 0===r?"bottom":r,l=a.classes,u=void 0===l?{}:l;Number.isNaN(+e)||Number.isNaN(+t)||!i?s({show:!1,title:"",x:0,y:0,arrow:!0,placement:"bottom",classes:{}}):s({show:!0,x:e,y:t,title:i,arrow:o,placement:c,classes:u})}),[]),u=ta();return o.a.createElement(ea.Provider,{value:l},t,o.a.createElement(ce.a,{open:r.show,title:r.title,arrow:r.arrow,placement:r.placement,classes:r.classes},o.a.createElement("div",{className:u.root,style:{top:r.y,left:r.x}})))}i(436);var aa=Object(g.a)((function(e){return{root:{color:e.palette.grey[300],minHeight:"6rem"},plot:{position:"relative",flexGrow:1},plotSvg:{width:"100%",height:"100%"}}})),na=ze.map((function(e,t){return Object(g.a)((function(i){return{arrow:{color:e},tooltip:{color:Le[t],backgroundColor:e,boxShadow:"0 0 3px 0 rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(0, 0, 0, 0.05)","& .value":{color:"white",background:Le[t],padding:"0 0.25em",borderRadius:"0.25rem"}}}}))})),oa=Ve.views[0].tracks.top[3],ra=oa.server,sa=oa.tilesetUid,ca=function(){var e=Object(O.a)(E.a.mark((function e(t){var i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(ra,"/tiles/?d=").concat(t));case 2:return i=e.sent,e.abrupt("return",i.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),la={},ua={};Fe.groups.forEach((function(e,t){la[e.label]={name:e.label,size:e.categories.length,index:t},e.categories.forEach((function(t,i){ua[t]={category:la[e.label],index:i}}))}));var ha=function(e,t,i){var a=Math.pow(t,2),n=e.map((function(e){return{y:i(e.value),data:e}})).sort((function(e,t){return e.y-t.y})),o=null,r=null;function s(e,t){for(var i=o;i;){if(a-.001>Math.pow(i.x-e,2)+Math.pow(i.y-t,2))return!0;i=i.next}return!1}var c,l=Object(Ki.a)(n);try{for(l.s();!(c=l.n()).done;){for(var u=c.value;o&&o.y<u.y-a;)o=o.next;if(s(u.x=0,u.y)){var h=o;u.x=1/0;do{var d=h.x+Math.sqrt(a-Math.pow(h.y-u.y,2));d<u.x&&!s(d,u.y)&&(u.x=d),h=h.next}while(h)}u.next=null,null===o?o=r=u:r=r.next=u}}catch(p){l.e(p)}finally{l.f()}return n},da=o.a.memo((function(){var e=k(),t=function(){var e=o.a.useContext(ea);if(void 0===e)throw new Error("useShowTooltip must be used within a TooltipContext");return e}(),i=Object(l.e)(bt),a=Object(l.e)(jt(e)),r=Object(l.e)(_t),s=Object(l.e)(Tt),u=Object(l.e)(gt),d=Object(l.e)(lt),p=Object(l.d)(vt),m=Object(c.a)(p,2),g=m[0],b=m[1],v=Object(n.useState)(null),x=Object(c.a)(v,2),y=x[0],w=x[1],C=Object(n.useState)(null),S=Object(c.a)(C,2),T=S[0],A=S[1],M=Object(n.useState)(null),R=Object(c.a)(M,2),N=R[0],I=R[1],L=Object(n.useState)(null),z=Object(c.a)(L,2),P=z[0],D=z[1],F=Ae(P),G=Ae(i);Object(n.useEffect)((function(){var e=!0;if(null!==a&&null!==N){var t=function(e){return e.max_width/Math.pow(2,e.max_zoom)}(N),i=Math.floor(a/t),n="".concat(sa,".").concat(N.max_zoom,".").concat(i);return A(!0),ca(n).then((function(t){e&&(A(!1),w(function(e,t){return e.filter((function(e){return t>=e.xStart&&t<=e.xEnd}))}(t[n],a)))})),function(){e=!1}}}),[a,N]);var H=Object(n.useCallback)((function(e){b(e)}),[b]),B=Object(n.useMemo)((function(){return!!N}),[N]),W=Object(n.useMemo)((function(){if(y){var e=0,t=1/0,i=0,a={},n={};Object.entries(la).forEach((function(e){var t=Object(c.a)(e,2),i=t[0],a=t[1];n[i]={category:a,numEnhancers:0}}));var o=function(e,t){return e.absDistance-t.absDistance},s=new $i.a([],o),l=new $i.a([],o);y.forEach((function(o){var c=o.fields[6];if(!a[c]){var u=+o.fields[4],h=u-r,d=h>0,p=Math.abs(h);a[c]={name:c,position:u,absDistance:p,isDownstream:d,samplesByCategory:{}},Object.values(la).forEach((function(e){var t=e.name,i=e.size;a[c].samplesByCategory[t]=[],a[c].samplesByCategory[t].size=i})),t=Math.min(t,p),i=Math.max(i,p),d?l.push(a[c]):s.push(a[c])}var m=o.fields[10];a[c].samplesByCategory[ua[m].category.name].push({gene:c,sample:m,sampleCategory:ua[m].category.name,value:o.importance}),e=Math.max(e,o.importance),n[ua[m].category.name].numEnhancers++}));for(var u=[];l.length;)u.push(l.pop());for(var h=[];s.length;)h.push(s.pop());return u.forEach((function(e,t){var i=u[t-1];e.relDistance=e.position-(i&&i.position||r)})),h.forEach((function(e,t){var i=u[t-1];e.relDistance=(i&&i.position||r)-e.position})),{minAbsDistance:t,maxAbsDistance:i,maxScore:e,genes:a,genesDownstreamByDist:u,genesUpstreamByDist:h,categoryAggregation:n}}}),[y]);Object(n.useEffect)((function(){Object(O.a)(E.a.mark((function e(){var t,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(ra,"/tileset_info/?d=").concat(sa));case 2:return t=e.sent,e.next=5,t.json();case 5:(i=e.sent)[sa]&&I(i[sa]);case 7:case"end":return e.stop()}}),e)})))()}),[]);var U=aa();Object(n.useLayoutEffect)((function(){if(g){var e=function(){return window.requestAnimationFrame((function(){var e=g.getBoundingClientRect().width;e!==F&&D(e)}))};return e(),window.addEventListener("resize",e),window.addEventListener("orientationchange",e),function(){window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}}}),[g]);for(var V=[],q=0;q<na.length;q++)V.push(na[q]());return Object(n.useEffect)((function(){!function(e,t,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=a.geneCellEncoding,r=void 0===n?"distribution":n,s=a.prevGeneCellEncoding,l=a.genePadding,u=void 0!==l&&l,d=a.showTooltip,p=void 0===d?h.c:d,m=a.tooltipClasses,f=void 0===m?[]:m,g=a.position,b=void 0===g?"":g,v=a.variant,x=void 0===v?null:v;if(t&&i){var y=Object(Qi.e)(e),w=60,k=60,C=1,E=.5,O=36,S=3,j=1,T=6,A=[0,20],M=Object.values(la).length*O+w+k;y.attr("viewbox","0 0 ".concat(t," ").concat(M)).attr("height",M);var R=Object.values(i.categoryAggregation).reduce((function(e,t){return Math.max(e,t.numEnhancers)}),0),N=Object(Qi.d)().domain([1,R]).range([2,O]).clamp(!0),I=Object(Qi.c)().domain([0,1]).range([0,O]).clamp(!0),L=Object(Qi.c)().domain([0,1]).range([1,10]).clamp(!0),z=Object(Qi.d)().domain([1,10]).range([O-C-j,C+j]),P=function(e){return z(L(e))},D=t/2-O,F=Math.floor(D/O),G=i.genesUpstreamByDist.slice(0,F).reverse(),H=i.genesDownstreamByDist.slice(0,F),B=[].concat(Object(_.a)(G),Object(_.a)(H)).reduce((function(e,t){return[Math.min(e[0],t.relDistance),Math.max(e[1],t.relDistance)]}),[1/0,0]),W=Object(c.a)(B,2),U=W[0],V=W[1],q=Object(Qi.c)().domain([U,V]).range(A),X=u?G.map((function(e){return Math.round(q(e.relDistance))})):[],Y=Se().domain(G.map((function(e){return e.name}))).range([0,t/2-O/2]).paddingInner(X),Z=u?H.map((function(e){return Math.round(q(e.relDistance))})):[],J=Se().domain(H.map((function(e){return e.name}))).range([0,t/2-O/2]).paddingInner(Z).paddingInnerZeroBased(!0),K=Math.min(Y.bandwidth(),J.bandwidth());Y.fixedBandwidth(K),J.fixedBandwidth(K);var Q=Math.max(0,Y.rangeSize()-Y.totalWidth()),$=Math.min(G.reduce((function(e,t){return Math.min(e,t.absDistance)}),1/0),H.reduce((function(e,t){return Math.min(e,t.absDistance)}),1/0)),ee=Math.max(G.reduce((function(e,t){return Math.max(e,t.absDistance)}),0),H.reduce((function(e,t){return Math.max(e,t.absDistance)}),0)),te=Object(Qi.c)().domain([$,ee]).range([2,k]),ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.isRightAligned,a=void 0!==i&&i;e.attr("fill",(function(e,t){return Le[t%Le.length]})).selectAll("circle").data((function(e){return ha(e,2*C+E,P)})).join("circle").attr("cx",(function(e){return a?Y.bandwidth()-(e.x+2*j):e.x+C+j})).attr("cy",(function(e){return e.y})).attr("r",C)},ae=function(e){var t=Object.values(e[0].samplesByCategory).reduce((function(e,t){return Math.max(e,t.size)}),0);return Math.ceil(Math.sqrt(t*K/O))},ne=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.instanceCache,n=void 0===a?{}:a,o=i.onMouseEnter,r=void 0===o?h.c:o,s=i.onMouseLeave,c=void 0===s?h.c:s,l=i.tooltipTitleGetter,u=void 0===l?null:l,d=K/t,m=function(e){return e%t*d},g=function(e){return Math.floor(e/t)*d};n.current=e.attr("fill",(function(e,t){return Le[t%Le.length]})).selectAll("rect").data((function(e){return e}),(function(e){return"".concat(e.gene,"|").concat(e.sample)})).join("rect").attr("x",(function(e){return m(ua[e.sample].index)})).attr("y",(function(e){return g(ua[e.sample].index)})).attr("width",d).attr("height",d).on("mouseenter",(function(e,t){var i=e.target.getBoundingClientRect(),a=u&&u(t)||t.value.toFixed(3);p(i.x+i.width/2,i.y,a,{arrow:!0,placement:"top",classes:f[la[t.sampleCategory].index%f.length]}),r(t)})).on("mouseleave",(function(e){p(),c(e)}))},oe=function(e){return o.a.createElement(o.a.Fragment,null,"The enhancer overlapping ",o.a.createElement("strong",null,b),x?" (".concat(x,")"):""," is predicted to regulate"," ",o.a.createElement("strong",null,e.gene)," in sample ",o.a.createElement("strong",null,e.sample)," with a score of ",o.a.createElement("strong",{className:"value"},e.value.toFixed(3)),".")},re={upstream:{current:null},downstream:{current:null}},se=function(e){var t=function(t){return t.sample===e.sample?1:.2};re.upstream.current.attr("opacity",t),re.downstream.current.attr("opacity",t)},ce=function(){re.upstream.current.attr("opacity",1),re.downstream.current.attr("opacity",1)},le=function(e,t,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=a.cellWidth,o=void 0===n?O:n,r=a.fillColor,s=void 0===r?ze:r,c=a.textColor,l=void 0===c?Le:c,u=a.showText,h=void 0===u||u,d=a.showZero,m=void 0===d||d,g=a.showTooltip,b=void 0!==g&&g,v=a.tooltipTitleGetter,x=void 0===v?null:v,y=e.selectAll(".bg").data((function(e){return[e]})).join("rect").attr("class","bg").attr("fill",(function(e){return s[e.row%s.length]})).attr("x",(function(e){return(o-t(i(e)))/2})).attr("y",(function(e){return(O-t(i(e)))/2})).attr("width",(function(e){return t(i(e))})).attr("height",(function(e){return t(i(e))})).attr("opacity",(function(e){return+(i(e)>0)}));b?y.on("mouseenter",(function(e,t){var a=e.target.getBoundingClientRect(),n=x&&x(t)||i(t);p(a.x+a.width/2,a.y,n,{arrow:!0,placement:"top",classes:f[t.row%f.length]})})).on("mouseleave",(function(){p()})):y.on("mouseenter",null).on("mouseleave",null),h&&e.selectAll(".box-text").data((function(e){return[e]})).join("text").attr("class","box-text").attr("fill",(function(e){return l[e.row%l.length]})).attr("style","font-size: 12px; font-weight: bold;").attr("dominant-baseline","middle").attr("text-anchor","middle").attr("x",o/2).attr("y",O/2).attr("opacity",(function(e){return+(i(e)>0||m)})).text((function(e){return i(e)}))},ue=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement("strong",{className:"value"},e.length)," out of ",e.size," ",o.a.createElement("em",null,Object.values(la)[e.row].name)," samples have predicted enhancer activity.")},he=y.select("#enhancers").attr("transform","translate(".concat(t/2-O/2,", 0)")),de=he.selectAll(".enhancer-gene-aggregate").data(Object.values(i.categoryAggregation).map((function(e,t){return e.row=t,e})),(function(e){return e.category.name})).join("g").attr("class","enhancer-gene-aggregate").attr("transform",(function(e,t){return"translate(0, ".concat(t*O+w,")")}));le(de,N,(function(e){return e.numEnhancers})),y.select("#enhancers").selectAll(".enhancer-box-border").data(Object.values(la),(function(e){return e.name})).join("rect").attr("class","enhancer-box-border").attr("fill","none").attr("stroke",(function(e,t){return ze[t%ze.length]})).attr("stroke-width","1").attr("x",0).attr("y",(function(e,t){return t*O+w})).attr("width",O).attr("height",O);var pe=y.select("#genes-upstream").selectAll(".gene-upstream").data(G,(function(e){return e.name})).join("g").attr("class","gene-upstream").attr("transform",(function(e){return"translate(".concat(Q+Y(e.name),", 0)")})),me=Y.bandwidth()/2,fe=w-S;pe.selectAll(".gene-upstream-label").data((function(e){return[e]})).join("text").attr("class","gene-label gene-upstream-label").attr("style","font-size: 9px;").attr("transform","translate(".concat(me,",").concat(fe,") rotate(-90)")).attr("fill","black").attr("dominant-baseline","middle").text((function(e){return e.name}));var ge=pe.selectAll(".gene-upstream-cell").data((function(e){return Object.values(e.samplesByCategory).map((function(e,t){return e.row=t,e}))}),(function(e){return e.name})).join("g").attr("class","gene-upstream-cell").attr("transform",(function(e,t){return"translate(0, ".concat(t*O+w,")")}));switch(r!==s&&ge.selectAll("*").remove(),r){case"distribution":ie(ge,{isRightAligned:!0});break;case"array":ne(ge,ae(G),{tooltipTitleGetter:oe,instanceCache:re.upstream,onMouseEnter:se,onMouseLeave:ce});break;case"number":case"percent":default:var be="percent"===r?I:N,ve="percent"===r?function(e){return e.length/e.size}:function(e){return e.length};le(ge,be,ve,{showText:!1,cellWidth:Y.bandwidth(),fillColor:Ie,showTooltip:!0,tooltipTitleGetter:ue})}pe.selectAll(".gene-upstream-border").data(Object.values(la),(function(e){return e.name})).join("rect").attr("class","gene-upstream-border").attr("fill","none").attr("stroke",(function(e,t){return ze[t%ze.length]})).attr("stroke-width","1").attr("x",0).attr("y",(function(e,t){return t*O+w})).attr("width",Y.bandwidth()).attr("height",O),pe.selectAll(".gene-upstream-distance-bar").data((function(e){return[e]})).join("rect").attr("class","gene-upstream-distance-bar").attr("fill","#bbbbbb").attr("x",Y.bandwidth()/2-T/2).attr("y",Object.values(la).length*O+w).attr("width",T).attr("height",(function(e){return te(e.absDistance)})),y.select("#genes-downstream").attr("transform","translate(".concat(t/2+O/2,", 0)"));var xe=y.select("#genes-downstream").selectAll(".gene-downstream").data(H,(function(e){return e.name})).join("g").attr("class","gene-downstream").attr("transform",(function(e){return"translate(".concat(J(e.name),", 0)")}));xe.selectAll(".gene-downstream-label").data((function(e){return[e]})).join("text").attr("class","gene-label gene-downstream-label").attr("style","font-size: 9px;").attr("transform","translate(".concat(me,",").concat(fe,") rotate(-90)")).attr("fill","black").attr("dominant-baseline","middle").text((function(e){return e.name}));var ye=xe.selectAll(".gene-downstream-cell").data((function(e){return Object.values(e.samplesByCategory).map((function(e,t){return e.row=t,e}))}),(function(e){return e.name})).join("g").attr("class","gene-downstream-cell").attr("transform",(function(e,t){return"translate(0, ".concat(t*O+w,")")}));switch(r!==s&&ye.selectAll("*").remove(),r){case"distribution":ie(ye);break;case"array":ne(ye,ae(H),{tooltipTitleGetter:oe,instanceCache:re.downstream,onMouseEnter:se,onMouseLeave:ce});break;case"number":case"percent":default:var we="percent"===r?I:N,ke="percent"===r?function(e){return e.length/e.size}:function(e){return e.length};le(ye,we,ke,{showText:!1,cellWidth:J.bandwidth(),fillColor:Ie,showTooltip:!0,tooltipTitleGetter:ue})}xe.selectAll(".gene-downstream-border").data(Object.values(la),(function(e){return e.name})).join("rect").attr("class","gene-downstream-border").attr("fill","none").attr("stroke",(function(e,t){return ze[t%ze.length]})).attr("stroke-width","1").attr("x",0).attr("y",(function(e,t){return t*O+w})).attr("width",J.bandwidth()).attr("height",O),xe.selectAll(".gene-downstream-distance-bar").data((function(e){return[e]})).join("rect").attr("class","gene-downstream-distance-bar").attr("fill","#bbbbbb").attr("x",J.bandwidth()/2-T/2).attr("y",Object.values(la).length*O+w).attr("width",T).attr("height",(function(e){return te(e.absDistance)}));var Ce=Math.ceil((ee-$)/1e5),Ee=Math.ceil(Ce/4),Oe=Ce<=1?[$,ee]:Array(4).fill().map((function(e,t){return 1e5*Math.ceil($/1e5)+t*(1e5*Ee)}));y.select("#gene-distance-axis").attr("transform","translate(0, ".concat(Object.values(la).length*O+w,")")).call(Object(Qi.a)(te).tickSize(t).tickFormat((function(e){var t=(e/1e5).toFixed(0);return this.parentNode.nextSibling?t:"".concat(t," kbps distance to enhancer")})).tickValues(Oe)).call((function(e){return e.select(".domain").remove()})).call((function(e){return e.selectAll(".tick line").attr("stroke","#bbbbbb").attr("stroke-width",.5).attr("stroke-dasharray","4,4")})).call((function(e){return e.selectAll(".tick text").attr("fill","#bbbbbb").attr("x",t/2).attr("dy",1).attr("text-anchor","middle").attr("dominant-baseline","hanging")}))}}(g,P,W,{geneCellEncoding:i,prevGeneCellEncoding:G,genePadding:u,showTooltip:t,classes:U,tooltipClasses:V,position:s,variant:d})}),[g,P,W,i,u,t]),o.a.createElement(j.a,{className:U.root,container:!0,justify:"center",alignItems:"center"},B&&!T?o.a.createElement(j.a,{item:!0,className:U.plot},o.a.createElement("svg",{ref:H,className:U.plotSvg},o.a.createElement("g",{id:"enhancers"}),o.a.createElement("g",{id:"gene-distance-axis"}),o.a.createElement("g",{id:"genes-upstream"}),o.a.createElement("g",{id:"genes-downstream"}))):o.a.createElement(f.a,{color:"inherit"}))})),pa=Object(g.a)((function(e){return{root:{},plot:{minHeight:"6rem"}}})),ma=o.a.memo((function(){var e=Object(l.e)(lt),t=pa();return o.a.createElement("div",{className:t.root},o.a.createElement(Pi,{id:"enhancer-gene",title:"Enhancer-Gene Connections",popoverDirection:"top",useShowInfo:zt,Info:Xi,Help:Yi,Settings:Ji}),o.a.createElement("div",{className:t.plot},e&&o.a.createElement(da,null)))})),fa=Object(g.a)((function(e){return{root:{display:"flex",justifyContent:"space-between"},text:{fontSize:"0.8rem"}}})),ga=o.a.memo((function(){var e=k(),t=Object(l.e)(rt),i=Object(l.e)(jt(e)),a=Object(l.e)(Ct(e)),r=Object(l.e)(Et(e)),s=fa(),c=Object(n.useMemo)((function(){return i?5:Math.round((r-a)/1e3)}),[i,a,r]);return t?o.a.createElement("div",{className:s.root},o.a.createElement("span",null,"\u251c"),o.a.createElement(K.a,{align:"center",className:s.text,noWrap:!0},Oe(c,1)," ",o.a.createElement("abbr",{title:"kilo base pairs"},"kbp")),o.a.createElement("span",null,"\u2524")):""})),ba=o.a.memo((function(){return o.a.createElement(K.a,null,"This panel visualizes the DNA accessibility of all 131 samples. Each track is individually normalized. Mouse over a track to see the underlying value. To focus on a specific locus specify a focus variant.")})),va=Object(g.a)((function(e){return{iconRadioLegend:{margin:e.spacing(2,0,.25,0)}}})),xa=o.a.memo((function(){var e=Re("dal",ot),t=Object(c.a)(e,2),i=t[0],a=t[1],r=Object(n.useCallback)((function(e){return function(){a(e)}}),[a]),s=va();return o.a.createElement(o.a.Fragment,null,o.a.createElement(T.a,{m:1},o.a.createElement(N.a,{component:"fieldset"},o.a.createElement(Si.a,{component:"legend",className:s.iconRadioLegend},"Labels"),o.a.createElement(ji.a,{"aria-label":"dnaAccessLabelStyle",name:"dnaAccessLabelStyle",value:i},o.a.createElement(Z.a,{label:"Indicator",value:"indicator",className:s.iconRadio,control:o.a.createElement(wi.a,{size:"small",onClick:r("indicator")},"indicator"===i?o.a.createElement(Ci.a,{className:s.iconRadioActive,fontSize:"inherit"}):o.a.createElement(Oi.a,{fontSize:"inherit"}))}),o.a.createElement(Z.a,{label:"Text",value:"text",className:s.iconRadio,control:o.a.createElement(wi.a,{size:"small",onClick:r("text")},"text"===i?o.a.createElement(Ci.a,{className:s.iconRadioActive,fontSize:"inherit"}):o.a.createElement(Oi.a,{fontSize:"inherit"}))}),o.a.createElement(Z.a,{label:"Hidden",value:"hidden",className:s.iconRadio,control:o.a.createElement(wi.a,{size:"small",onClick:r("hidden")},"hidden"===i?o.a.createElement(Ci.a,{className:s.iconRadioActive,fontSize:"inherit"}):o.a.createElement(Oi.a,{fontSize:"inherit"}))})))))})),ya=Object(g.a)((function(e){return{root:{position:"absolute",top:0,right:0,bottom:0,left:0},grow:{flexGrow:1}}})),wa=function(e,t,i,a,n){var o=n-a,r=a+o/2;if(e)return o<5e3&&Math.abs(r-e)<1e3?[a,n]:[e-2500,e+2500];if(t&&i){var s=t+(i-t)/2;return o<5e3&&r>t&&r<i?[a,n]:[s-2500,s+2500]}return[a,n]},ka=o.a.memo((function(){var e=k(),t=Object(l.f)(yt),i=Object(l.e)($e),a=Object(l.e)(ot),r=Object(l.e)(ht),s=Object(l.e)(it),c=Object(l.e)(Ot(e)),d=Object(l.e)(St(e)),p=Object(l.e)(jt(e)),m=Q(Object(l.e)(Ct(e)),500),f=Q(Object(l.e)(Et(e)),500),g=Object(n.useCallback)((function(e){null!==e&&t(e.api)}),[t]),b=Object(n.useMemo)((function(){return Object(h.l)(Gi(s),Hi(p,[2]),Bi(r),(t=a,function(e){return e.views[0].tracks.top[3].options.showRowLabels=!(!t||"hidden"===t)&&t,e}),function(){return Wi.apply(void 0,Object(_.a)(wa.apply(void 0,arguments)).concat([{force:!0}]))}(p,c,d,m,f),(e=i,function(t){return t.views[0].tracks.top[3].options.rowSelections=qe.filter((function(t,i){return e[i]})),t}))(Object(h.b)(Ye));var e,t}),[s,p,c,d,m,f,r,a,e,i]),v=ya();return o.a.createElement(j.a,{container:!0,direction:"column",className:v.root},o.a.createElement(Pi,{id:"dna-accessibility",title:"DNA Accessibility",useShowInfo:Rt,Info:ga,Help:ba,Settings:xa}),o.a.createElement(j.a,{item:!0,container:!0,direction:"column",className:v.grow},o.a.createElement(u.HiGlassComponent,{ref:g,viewConfig:b,options:{sizeMode:"scroll",pixelPreciseMarginPadding:!0,containerPaddingX:0,containerPaddingY:0,viewMarginTop:0,viewMarginBottom:0,viewMarginLeft:0,viewMarginRight:0,viewPaddingTop:0,viewPaddingBottom:0,viewPaddingLeft:0,viewPaddingRight:16,globalMousePosition:!0}})))})),Ca=Object(g.a)((function(e){return{root:{position:"absolute",display:"flex",top:0,right:0,bottom:0,left:0},toolbar:e.mixins.toolbar,content:{flexGrow:1,padding:e.spacing(1),backgroundColor:"white"},grow:{flexGrow:1},separator:{zIndex:1,margin:"-".concat(e.spacing(1),"px 0"),width:1,background:e.palette.grey[300]},enhancerWrapper:{position:"relative",flexGrow:1,margin:"-8px 0 -8px -8px"},enhancer:{position:"absolute",top:0,right:0,bottom:0,left:0,overflowY:"auto","&> div":{minHeight:"100%"}},enhancerRegions:{position:"relative",flexGrow:1},enhancerGenes:{position:"relative"},dnaAccessibility:{position:"relative",width:"20rem",margin:"-8px -8px -8px 0"}}})),Ea=o.a.memo((function(){var e=At(),t=Object(c.a)(e,2),i=t[0],a=t[1],r=Mt(),s=Object(c.a)(r,2),u=s[0],h=s[1],d=Object(l.d)(ct),p=Object(c.a)(d,2),m=p[0],f=p[1],g=Object(l.d)(ut),b=Object(c.a)(g,2),v=b[0],x=b[1],y=function(e){e?(a(e.geneName),f(e)):(a(""),f(null))},w=function(e){e?(h(e.geneName),x(e)):(h(""),x(null))},k=Ca();return Object(n.useEffect)((function(){Object(O.a)(E.a.mark((function e(){var t,a,n,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i||m){e.next=10;break}return e.next=3,fetch("".concat(Pe,"&ac=").concat(i));case 3:return t=e.sent,e.next=6,t.json();case 6:a=e.sent,a[0].type="gene",y(a[0]);case 10:if(!u||v){e.next=20;break}return e.next=13,fetch("".concat(De,"&ac=").concat(u));case 13:return n=e.sent,e.next=16,n.json();case 16:o=e.sent,o[0].type="variant",w(o[0]);case 20:case"end":return e.stop()}}),e)})))()}),[]),o.a.createElement("div",{className:k.root},o.a.createElement(Zt,null,o.a.createElement(S.a,null),o.a.createElement(bi,null),o.a.createElement(Qt,null),o.a.createElement(ia,null,o.a.createElement(j.a,{container:!0,direction:"column",className:k.content,wrap:"nowrap"},o.a.createElement("div",{className:k.toolbar}),o.a.createElement(j.a,{container:!0,className:k.grow,wrap:"nowrap"},o.a.createElement("div",{className:k.enhancerWrapper},o.a.createElement("div",{className:k.enhancer},o.a.createElement(j.a,{container:!0,direction:"column"},o.a.createElement(j.a,{item:!0,className:k.enhancerRegions},o.a.createElement(Vi,null)),o.a.createElement(j.a,{item:!0,className:k.enhancerGenes},o.a.createElement(ma,null))))),o.a.createElement("div",{className:k.separator}),o.a.createElement("div",{className:k.dnaAccessibility},o.a.createElement(ka,null)))))))})),Oa=function(e,t){return function(i){return function(a){return e(a)?o.a.createElement(t,a):o.a.createElement(i,a)}}},Sa=(i(437),Object(d.a)({palette:{primary:{main:"#000"},secondary:{main:"#000"}}})),ja=function(){var e=Object(n.useState)(null),t=Object(c.a)(e,2),i=t[0],a=t[1];Object(n.useEffect)((function(){Object(u.ChromosomeInfo)("https://s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv").then((function(e){void 0===e.totalLength?a(!1):a(e)})).catch((function(){a(!1)}))}),[]);var r=Object(h.l)(Oa((function(){return null===i}),v),Oa((function(){return!1===i}),x))(Ea);return o.a.createElement("div",{className:"App"},o.a.createElement(l.a,null,o.a.createElement(p.a,{theme:Sa},o.a.createElement(w,{chromInfo:i},o.a.createElement(r,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var _a=i(34),Ta=i(26),Aa=i(28);function Ma(e){if(!(this instanceof Ma?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var t=e.services.pubSub,i=function(){function e(t,i){var a=this;Object(Ta.a)(this,e);var n=t.definition,o=t.getTrackObject,r=t.onNewTilesLoaded;this.animate=r,this.options=i,this.overlaysTrack=o(n.overlaysTrack),this.overlaysTrack?(this.annotationTrackIds=new Set,this.annotationTracks=n.options.annotationTracks.map((function(e){var t=o(e);return t?a.annotationTrackIds.add(t.uuid):console.warn("Child track (uid: ".concat(e,") not found")),t})).filter((function(e){return e})),this.annotationDrawnHandlerBound=this.annotationDrawnHandler.bind(this),this.tilesDrawnEndHandlerBound=this.tilesDrawnEndHandler.bind(this),this.drawnAnnotations=new Map,this.tracksDrawingTiles=new Set,this.pubSubs=[],this.annotationTracks.forEach((function(e){e.subscribe("annotationDrawn",a.annotationDrawnHandlerBound),e.subscribe("tilesDrawn",a.tilesDrawnEndHandlerBound)}))):console.warn("Overlays track (uid: ".concat(n.overlaysTrack,") not found"))}return Object(Aa.a)(e,[{key:"annotationDrawnHandler",value:function(e){var t=e.xStartAbs,i=e.xEndAbs,a=e.data;this.drawnAnnotations.set(a.uid,[t,i])}},{key:"remove",value:function(){var e=this;this.pubSubs.forEach(t.unsubscribe),this.pubSubs=void 0,this.annotationTracks.forEach((function(t){t.unsubscribe("annotationDrawn",e.annotationDrawnHandlerBound)}))}},{key:"tilesDrawnEndHandler",value:function(e){var t=e.uuid;this.annotationTrackIds.has(t)&&(this.tracksDrawingTiles.add(t),this.tracksDrawingTiles.size%this.annotationTracks.length||this.updateOverlays())}},{key:"updateOverlays",value:function(){this.overlaysTrack.options.extent=Array.from(this.drawnAnnotations.values()),this.overlaysTrack.draw(),this.tracksDrawingTiles.clear()}}]),e}(),a=arguments.length,n=new Array(a>1?a-1:0),o=1;o<a;o++)n[o-1]=arguments[o];return Object(_a.a)(i,n)}Ma.config={type:"annotation-overlay",availableOptions:["annotationTracks"],defaultOptions:{annotationTracks:[]}};var Ra=Ma,Na=i(33),Ia=i(27),La=i(31),za=i(32),Pa=Float32Array.BYTES_PER_ELEMENT,Da="precision mediump float;\n\n  attribute vec2 aPrevPosition;\n  attribute vec2 aCurrPosition;\n  attribute vec2 aNextPosition;\n  attribute float aOffsetSign;\n  attribute float aColorIndex;\n\n  uniform sampler2D uAreaColorTex;\n  uniform float uAreaColorTexRes;\n  uniform mat3 projectionMatrix;\n  uniform mat3 translationMatrix;\n\n  uniform vec4 uLineColor;\n  uniform vec4 uNaNColor;\n  uniform float uWidth;\n  uniform int uMiter;\n\n  varying vec4 vColor;\n\n  void main(void)\n  {\n    mat3 model = projectionMatrix * translationMatrix;\n\n    if (aColorIndex <= -0.5) {\n      // Render line\n      vColor = vec4(uLineColor.rgb, 1.0);\n\n      vec4 prevGlPos = vec4((model * vec3(aPrevPosition, 1.0)).xy, 0.0, 1.0);\n      vec4 currGlPos = vec4((model * vec3(aCurrPosition, 1.0)).xy, 0.0, 1.0);\n      vec4 nextGlPos = vec4((model * vec3(aNextPosition, 1.0)).xy, 0.0, 1.0);\n\n      // Calculate the direction\n      vec2 dir = vec2(0.0);\n\n      if (currGlPos == prevGlPos) {\n        // start point uses (next - current)\n        dir = normalize(nextGlPos.xy - currGlPos.xy);\n      }\n      else if (currGlPos == nextGlPos) {\n        // end point uses (current - previous)\n        dir = normalize(currGlPos.xy - prevGlPos.xy);\n      }\n      else {\n        // somewhere in middle, needs a join:\n        // get directions from (C - B) and (B - A)\n        vec2 dirA = normalize((currGlPos.xy - prevGlPos.xy));\n        if (uMiter == 1) {\n          vec2 dirB = normalize((nextGlPos.xy - currGlPos.xy));\n          // now compute the miter join normal and length\n          vec2 tangent = normalize(dirA + dirB);\n          vec2 perp = vec2(-dirA.y, dirA.x);\n          vec2 miter = vec2(-tangent.y, tangent.x);\n          dir = tangent;\n        } else {\n          dir = dirA;\n        }\n      }\n\n      float width = (projectionMatrix * vec3(uWidth, 0.0, 0.0)).x / 2.0;\n\n      vec2 normal = vec2(-dir.y, dir.x) * width;\n      // normal.x /= aspectRatio;\n      vec4 offset = vec4(normal * aOffsetSign, 0.0, 0.0);\n      gl_Position = currGlPos + offset;\n    } else {\n      // Render area\n      float colorRowIndex = aColorIndex / uAreaColorTexRes;\n\n      vec2 colorTexIndex = vec2(\n        (aColorIndex / uAreaColorTexRes) - colorRowIndex,\n        colorRowIndex / uAreaColorTexRes\n      );\n      vColor = texture2D(uAreaColorTex, colorTexIndex);\n\n      gl_Position = vec4((model * vec3(aCurrPosition, 1.0)).xy, 0.0, 1.0);\n    }\n  }\n",Fa="precision mediump float;\n\n  varying vec4 vColor;\n\n  void main() {\n    gl_FragColor = vColor;\n  }\n",Ga=Array(127).fill().map((function(e,t){var i=.5*(1-t/127)+.5;return[i,i,i,1]})),Ha=function(e){return Object.values(e).reduce((function(e,t){return Math.max(e,t.tileData.maxNonZero)}),-1/0)},Ba=function(e){return Object.values(e)[0].tileData.coarseShape[0]},Wa=function(e){return Object(h.h)(Object.values(e).map((function(e){return e.tileData.maxValueByRow})))},Ua=function(e,t,i){var a=(i.domain()[1]-i.domain()[0])/(t.domain()[1]-t.domain()[0]),n=t.domain().map(i)[0];e.scale.x=a,e.position.x=-n*a},Va=function(e,t,i){return t.length/e/4/(1+i)-2},qa=function e(t){if(!(this instanceof e?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var i=t.libraries.PIXI,a=t.libraries.d3Format.format,n=t.libraries.d3Scale.scaleLinear,o=t.services.tileProxy,r=function(e){var t=Math.max(2,Math.ceil(Math.sqrt(e.length))),a=new Float32Array(4*Math.pow(t,2));return e.forEach((function(e,t){a[4*t]=e[0],a[4*t+1]=e[1],a[4*t+2]=e[2],a[4*t+3]=e[3]})),[i.Texture.fromBuffer(a,t,t),t]},s=function(e){Object(La.a)(l,e);var s=Object(za.a)(l);function l(e,t){var a;return Object(Ta.a)(this,l),(a=s.call(this,e,t)).updateOptions(),a.pLoading=new i.Graphics,a.pLoading.position.x=0,a.pLoading.position.y=0,a.pMasked.addChild(a.pLoading),a.loadIndicator=new i.Text("Loading data...",{fontSize:a.labelSize||10,fill:8421504}),a.pLoading.addChild(a.loadIndicator),a}return Object(Aa.a)(l,[{key:"initTile",value:function(e){this.coarsifyTileValues(e)}},{key:"destroyTile",value:function(){}},{key:"binsPerTile",value:function(){return this.tilesetInfo.bins_per_dimension||256}},{key:"getTilePosAndDimensions",value:function(e,t,i){var a=i||this.binsPerTile();if(this.tilesetInfo.resolutions){var n=this.tilesetInfo.resolutions.map((function(e){return+e})).sort((function(e,t){return t-e}))[e],o=n*a,r=o;return{tileX:n*a*t[0],tileY:n*a*t[1],tileWidth:o,tileHeight:r}}var s=t[0],c=t[1],l=this.tilesetInfo.min_pos[0],u=this.options.reverseYAxis?-this.tilesetInfo.max_pos[1]:this.tilesetInfo.min_pos[1],h=this.tilesetInfo.max_width/Math.pow(2,e),d=this.tilesetInfo.max_width/Math.pow(2,e);return{tileX:l+s*h,tileY:u+c*d,tileWidth:h,tileHeight:d}}},{key:"updateOptions",value:function(){var e=this;switch(this.selectRowsAggregationMode=this.options.selectRowsAggregationMode||"mean",this.selectRowsAggregationMode){case"max":this.selectRowsAggregationFn=h.g;break;case"min":this.selectRowsAggregationFn=h.j;break;case"sum":this.selectRowsAggregationFn=h.m;break;case"mean":default:this.selectRowsAggregationFn=h.i}this.markArea=!!this.options.markArea,this.markAreaColor="grays",this.markColor=t.utils.colorToHex(this.options.markColor||"black"),this.markColorRgbNorm=this.options.markColor?t.utils.colorToRgba(this.options.markColor).slice(0,3).map((function(e){return Math.min(1,Math.max(0,e/255))})):[0,0,0];var i=r(Object(_.a)(Ga)),a=Object(c.a)(i,2);this.markColorTex=a[0],this.markColorTexRes=a[1],this.markNumColors=Ga.length,this.markOpacity=Number.isNaN(+this.options.markOpacity)?1:Math.min(1,Math.max(0,+this.options.markOpacity)),this.markSize=this.options.markSize||2;var n=this.markResolution;this.markResolution=Math.max(1,Math.min(256,this.options.markResolution||64));var o=this.rowHeight;this.rowHeight=Number.isNaN(+this.options.rowHeight)?"auto":+this.options.rowHeight;var s=this.rowPadding;this.rowPadding="auto"===this.rowHeight?0:this.options.rowPadding||0;var l=this.rowNormalization;this.rowNormalization=this.options.rowNormalization||!1;var u=this.rowSelections;this.rowSelections=this.options.rowSelections||this.rowSelections||[];var d=this.showRowLabels;this.showRowLabels=this.options.showRowLabels,n===this.markResolution&&u===this.rowSelections||(this.updateTiles(),this.updateRowLabels(),this.drawLabel()),o===this.rowHeight&&s===this.rowPadding&&l===this.rowNormalization||this.updateScales(),d!==this.showRowLabels&&(this.updateRowLabels(),this.drawLabel()),this.rowLabelAlign=this.options.rowLabelAlign||"left",this.rowLabelSize=this.options.rowLabelSize||12,this.rowCategories=this.options.rowCategories||{},this.rowIdToCategory=function(e){return e.substring(0,e.length-14)},this.rowIdToCategory=this.options.rowIdToCategory?function(t){return t[e.options.rowIdToCategory.fn].apply(t,Object(_.a)(e.options.rowIdToCategory.args))}:h.c}},{key:"removeRowLabels",value:function(){for(;this.pAxis.children.length;)this.pAxis.removeChildAt(0);this.rowLabels&&(this.rowLabels.forEach((function(e){e.destroy()})),this.rowLabels=void 0)}},{key:"updateRowLabels",value:function(){var e=this;if(this.tilesetInfo&&this.tilesetInfo.row_infos){var a=this.rowSelections.length?this.rowSelections.map((function(t){return void 0===e.tilesetInfo.row_infos[t]?"?":e.rowIdToCategory(e.tilesetInfo.row_infos[t].id)})):this.tilesetInfo.row_infos.map((function(t){var i=t.id;return e.rowIdToCategory(i)}));this.removeRowLabels(),"indicator"===this.showRowLabels?this.rowLabels=a.map((function(a){var n=new i.Sprite(i.Texture.WHITE);return n.width=e.rowLabelSize/2,n.height=e.rowLabelSize,n.tint=e.rowCategories[a]?t.utils.colorToHex(e.rowCategories[a].axisLabelColor||Ie[e.rowCategories[a].index%Ie.length]):8421504,n})):this.showRowLabels&&(this.rowLabels=a.map((function(a){return new i.Text(a,{fontSize:e.rowLabelSize,align:"right"===e.rowLabelAlign?"right":"left",fill:e.rowCategories[a]?t.utils.colorToHex(e.rowCategories[a].axisLabelColor||Le[e.rowCategories[a].index%Le.length]):8421504})})))}}},{key:"drawLabel",value:function(){var e=this;if(this.showRowLabels){if(this.showRowLabels&&!this.rowLabels&&this.updateRowLabels(),this.rowLabels){var t=Object(c.a)(this.dimensions,1)[0],i=Object(c.a)(this.position,2),a=i[0],n=i[1];this.pAxis.position.x="right"===this.axisAlign?a+t:a,this.pAxis.position.y=n,this.pAxis.clear();var o=0,r="right"===this.axisAlign?-3:3,s=this.getRowHeight(),l=Object(c.a)(s,2)[1],u=l/2;this.rowLabels.forEach((function(t,i){t.x=r,t.y=o-e.rowPadding+u,t.anchor.x="right"===e.axisAlign?1:0,t.anchor.y=.5,o+=l,e.pAxis.addChild(t)}))}}else if(this.rowLabels)for(;this.pAxis.children.length;)this.pAxis.removeChildAt(0)}},{key:"rerender",value:function(e){this.options=e,this.updateOptions(),this.updateExistingGraphics()}},{key:"hasFetchedTiles",value:function(){return Object.values(this.fetchedTiles).length}},{key:"coarsifyTileValues",value:function(e){var t=this.getTilePosAndDimensions(e.tileData.zoomLevel,e.tileData.tilePos),i=t.tileX,a=t.tileWidth,n=Object(c.a)(e.tileData.shape,1)[0],o=Math.floor(256/this.markResolution),r=a/this.markResolution,s=r/2;e.tileData.binXPos=Array(this.markResolution).fill();for(var l=0;l<=this.markResolution;l++)e.tileData.binXPos[l]=i+r*l+s;e.tileData.valuesByRow=Array(n).fill().map((function(){return[]})),e.tileData.maxValueByRow=Array(n).fill(-1/0);for(var u=0;u<n;u++)for(var d=0;d<256;d+=o){var p=Object(h.i)(e.tileData.dense.subarray(256*u+d,256*u+d+o));e.tileData.valuesByRow[u].push(p),e.tileData.maxValueByRow[u]=p>e.tileData.maxValueByRow[u]?p:e.tileData.maxValueByRow[u]}this.rowSelections.length&&(e.tileData.valuesByRow=this.rowSelections.map((function(t){return e.tileData.valuesByRow[t]})).filter(h.c),e.tileData.maxValueByRow=this.rowSelections.map((function(t){return e.tileData.maxValueByRow[t]})).filter(h.c)),e.tileData.coarseShape=[e.tileData.valuesByRow.length,this.markResolution]}},{key:"updateTiles",value:function(){Object.values(this.fetchedTiles).forEach(this.coarsifyTileValues.bind(this))}},{key:"updateScales",value:function(){var e=this,t=Object.values(this.fetchedTiles);if(t.length){var i=Ba(t),a=this.getRowHeight(),o=Object(c.a)(a,1)[0],r=this.getTrackHeight(i,o),s=Ha(this.fetchedTiles);if(this.valueScale=n().domain([0,s]).range([o,0]),this.colorIndexScale=n().domain([0,s]).range([0,this.markNumColors]).clamp(!0),this.rowNormalization){var l=Wa(this.fetchedTiles);this.rowValueScales={},this.rowColorIndexScales={};for(var u=0;u<i;u++)this.rowValueScales[u]=n().domain([0,l[u]]).range([o,0]),this.rowColorIndexScales[u]=n().domain([0,l[u]]).range([0,this.markNumColors]).clamp(!0);this.valueScaleByRow=function(t,i){return Number.isNaN(t)?o:e.rowValueScales[i](t)},this.colorIndexScaleByRow=function(t,i){return Number.isNaN(t)?-2:e.rowColorIndexScales[i](t)}}else this.valueScaleByRow=function(t,i){return Number.isNaN(t)?o:e.valueScale(t)},this.colorIndexScaleByRow=function(t,i){return Number.isNaN(t)?-2:e.colorIndexScale(t)};this.rowScale=n().domain([0,i]).range([0,r+this.rowPadding])}}},{key:"tilesToData",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=i.markArea,n=i.maxRows,o=void 0===n?1/0:n,r=i.rowHeight;if(!e.length)return[];var s=Math.min(o,Ba(e)),c=Array(s).fill().map((function(){return[]})),l=Array(s).fill().map((function(){return[]})),u=Array(s).fill().map((function(){return[]}));e.forEach((function(e){e.tileData.valuesByRow.forEach((function(i,n){n>=o||i.forEach((function(i,o){var s=t._xScale(e.tileData.binXPos[o]),h=t.rowScale(n),d=h+t.valueScaleByRow(i,n);c[n].push(s,d,s,d),l[n].push(-1,-1),u[n].push(1,-1),a&&(c[n].push(s,d,s,h+r),l[n].push(t.colorIndexScaleByRow(i,n),0),u[n].push(0,0))}))}))}));for(var d=a?8:4,p=a?4:2,m=0;m<s;m++){var f,g,b,v,x,y;if((f=c[m]).unshift.apply(f,Object(_.a)(c[m].slice(0,d))),m>0)(x=l[m]).unshift.apply(x,Object(_.a)(l[m].slice(0,p))),(y=u[m]).unshift.apply(y,Object(_.a)(u[m].slice(0,p)));(g=c[m]).push.apply(g,Object(_.a)(c[m].slice(-d))),(b=l[m]).push.apply(b,Object(_.a)(l[m].slice(-p))),(v=u[m]).push.apply(v,Object(_.a)(u[m].slice(-p)))}return[new Float32Array(c.flatMap(h.c)),new Float32Array(l.flatMap(h.c)),new Float32Array(u.flatMap(h.c))]}},{key:"toLineIndices",value:function(e,t,i){var a=i?12:6,n=i?4:2,o=new Uint32Array((t-1)*e*a),r=0;if(i)for(var s=0;s<e;s++)for(var c=0;c<t-1;c++){var l=s*(t+2)*n+c*n,u=l+1,h=l+2,d=l+3,p=l+4,m=l+5,f=l+6,g=l+7,b=r*a;o[b]=h,o[b+1]=d,o[b+2]=f,o[b+3]=f,o[b+4]=d,o[b+5]=g,o[b+6]=l,o[b+7]=u,o[b+8]=p,o[b+9]=p,o[b+10]=u,o[b+11]=m,r++}else for(var v=0;v<e;v++)for(var x=0;x<t-1;x++){var y=v*(t+2)*n+x*n,w=y+1,k=y+2,C=y+3,E=r*a;o[E]=y,o[E+1]=w,o[E+2]=k,o[E+3]=k,o[E+4]=w,o[E+5]=C,r++}return o}},{key:"getRowHeight",value:function(e){var t=Object(c.a)(this.dimensions,2)[1];return"auto"===this.rowHeight?[Math.floor(t/e),Math.floor(t/e)]:[this.rowHeight,this.rowHeight+this.rowPadding]}},{key:"getTrackHeight",value:function(e,t){var i=Object(c.a)(this.dimensions,2)[1];return"auto"===this.rowHeight?i:t*e+this.rowPadding*(e-1)}},{key:"renderLines",value:function(){this.drawnAtScale=n().domain(Object(_.a)(this.xScale().domain())).range(Object(_.a)(this.xScale().range()));var e=Object.values(this.fetchedTiles),t=Ba(e),a=this.getRowHeight(t),o=Object(c.a)(a,1)[0],r=this.tilesToData(e,{maxRows:t,markArea:this.markArea,rowHeight:o}),s=Object(c.a)(r,3),l=s[0],u=s[1],h=s[2],d=Va(t,l,this.markArea),p=this.toLineIndices(t,d,this.markArea),m=new i.UniformGroup({uLineColor:[].concat(Object(_.a)(this.markColorRgbNorm),[1]),uNaNColor:[1,1,1,1],uAreaColorTex:this.markColorTex,uAreaColorTexRes:this.markColorTexRes,uWidth:.25,uMiter:1}),f=i.Shader.from(Da,Fa,m),g=new i.Geometry,b=this.markArea?4:2;g.addAttribute("aPrevPosition",l,2,!1,i.TYPES.FLOAT,2*Pa,0),g.addAttribute("aCurrPosition",l,2,!1,i.TYPES.FLOAT,2*Pa,2*Pa*b),g.addAttribute("aNextPosition",l,2,!1,i.TYPES.FLOAT,2*Pa,2*Pa*b*2),g.addAttribute("aOffsetSign",h,1),g.addAttribute("aColorIndex",u,1),g.addIndex(p);var v=new i.Mesh(g,f),x=new i.Graphics;x.addChild(v),this.pMain.x=this.position[0],this.lineGraphics&&(this.pMain.removeChild(this.lineGraphics),this.lineGraphics.destroy()),this.pMain.addChild(x),this.lineGraphics=x,Ua(this.lineGraphics,this._xScale,this.drawnAtScale),this.draw(),this.animate()}},{key:"updateExistingGraphics",value:function(){this.updateLoadIndicator(),this.hasFetchedTiles()&&(this.updateScales(),this.renderLines())}},{key:"updateLoadIndicator",value:function(){var e=Object(c.a)(this.position,2),t=e[0],i=e[1];this.pLoading.position.x=t+6,this.pLoading.position.y=i+6,this.fetching.size?this.pLoading.addChild(this.loadIndicator):this.pLoading.removeChild(this.loadIndicator)}},{key:"refreshTiles",value:function(){Object(Na.a)(Object(Ia.a)(l.prototype),"refreshTiles",this).call(this),this.updateLoadIndicator()}},{key:"setPosition",value:function(e){Object(Na.a)(Object(Ia.a)(l.prototype),"setPosition",this).call(this,e);var t=Object(c.a)(this.position,2);this.pMain.position.x=t[0],this.pMain.position.y=t[1]}},{key:"zoomed",value:function(e,t){this.xScale(e),this.yScale(t),this.lineGraphics&&Ua(this.lineGraphics,e,this.drawnAtScale),this.refreshTiles(),this.draw()}},{key:"getVisibleData",value:function(e,t){var i=this;if(!this.hasFetchedTiles())return"";var n=this.calculateZoomLevel(),r=Ba(this.fetchedTiles),s=this.getRowHeight(r),l=Object(c.a)(s,2)[1],u=o.calculateTileWidth(this.tilesetInfo,n,this.tilesetInfo.tile_size),h=this._xScale.invert(e)/u,d=this.tilesetInfo.tile_size*(h-Math.floor(h)),p=Math.floor(Math.max(0,(t+this.rowPadding)/l)),m=this.rowSelections[p],f=this.tileToLocalId([n,Math.floor(h)]),g=this.fetchedTiles[f],b="",v="<em>unknown</em>";if(void 0===m)return b;if(g){this.tilesetInfo.shape||(d=g.tileData.dense.length*(h-Math.floor(h)));var x=null;if(x=this.tilesetInfo.shape?Array.isArray(m)&&"client"===this.options.selectRowsAggregationMethod?m.map((function(e){return i.tilesetInfo.shape[0]*e+Math.floor(d)})):m&&"client"===this.options.selectRowsAggregationMethod?this.tilesetInfo.shape[0]*m+Math.floor(d):this.tilesetInfo.shape[0]*p+Math.floor(d):g.tileData.dense.length*p+Math.floor(d),Array.isArray(x)){var y=x.map((function(e){return g.tileData.dense[e]}));b=v=a(".3f")(this.selectRowsAggregationFn(y)),b+="<br/>",b+="".concat(x.length,"-item ").concat(this.options.selectRowsAggregationMode)}else b=v=a(".3f")(g.tileData.dense[x]),Array.isArray(m)&&(v+="<br/>",v+="".concat(m.length,"-item ").concat(this.options.selectRowsAggregationMode))}if(this.tilesetInfo.row_infos){var w="";void 0!==m&&(w=this.tilesetInfo.row_infos[m]);var k="object"===typeof w?this.rowIdToCategory(w.id):w,C=this.rowCategories[k]?this.rowCategories[k].axisLabelColor||Le[this.rowCategories[k].index%Le.length]:"#666666",E=this.rowCategories[k]?this.rowCategories[k].axisLabelColor||ze[this.rowCategories[k].index%ze.length]:"#ffffff";return'<div style="margin: -0.25rem; padding: 0 0.25rem; background: '.concat(E,'"><strong style="color: ').concat(C,';">').concat(k,":</strong> ").concat(v,"</div>")}return b}},{key:"getMouseOverHtml",value:function(e,t){return this.tilesetInfo?this.getVisibleData(e,t):""}},{key:"exportSVG",value:function(){var e="http://www.w3.org/2000/svg",t=null,i=null,a=Object(Na.a)(Object(Ia.a)(l.prototype),"exportSVG",this).call(this),n=Object(c.a)(a,2);i=n[0],t=n[1],i.setAttribute("class","ridge-plot-track");var o=document.createElement("g");t.appendChild(o),o.setAttribute("transform","translate(".concat(this.position[0],", ").concat(this.position[1],")"));var r=Object.values(this.fetchedTiles),s=Ba(r),u=this.getRowHeight(s),h=Object(c.a)(u,1)[0],d=this.markArea?8:4,p=this.tilesToData(r,{maxRows:s,markArea:this.markArea,rowHeight:h}),m=Object(c.a)(p,1)[0],f=Object(Qi.b)().x((function(e){return e[0]})).y((function(e){return e[1]})),g=m.length/s,b=function(e){for(var t=[],i=d,a=e.length-d,n=i;n<a;n+=d)t.push([e[n],e[n+1]]);return t},v=this.markArea?this.options.colorRange&&this.options.colorRange[0]||"#ffffff":"none";if(this.markArea&&this.options.colorRange){var x=this.options.colorRange.length,y=document.createElementNS(e,"defs"),w=document.createElementNS(e,"linearGradient");w.setAttribute("id","RidgePlotGradient"),w.setAttribute("x1","0"),w.setAttribute("y1","1"),w.setAttribute("x2","0"),w.setAttribute("y2","0"),this.options.colorRange.forEach((function(t,i){var a=document.createElementNS(e,"stop");a.setAttribute("offset","".concat(Math.round(i/(x-1)*100),"%")),a.setAttribute("stop-color",t),w.appendChild(a)})),y.appendChild(w),i.insertBefore(y,i.firstChild),v="url(#RidgePlotGradient)"}for(var k=0;k<s;k++){var C=b(m.subarray(k*g,(k+1)*g)),E=document.createElement("path"),O=f(C),S=this.rowScale(k)+this.valueScaleByRow(0,k),j=O.indexOf(","),_=+O.substring(1,j),T=+O.substring(j+1,O.indexOf("L")),A=(O="M".concat(_-1,",").concat(S,"L").concat(_-1,",").concat(T,"L").concat(O.substring(1))).lastIndexOf(","),M=+O.substring(O.lastIndexOf("L")+1,A),R=+O.substring(A+1);O+="L".concat(M+1,",").concat(R,"L").concat(M+1,",").concat(S),E.setAttribute("d",O),E.setAttribute("fill",v),E.setAttribute("stroke",this.options.markColor||"black"),E.setAttribute("stroke-width",(this.options.markSize||2)/8),o.appendChild(E)}return[i,t]}}]),l}(t.tracks.HorizontalLine1DPixiTrack),l=arguments.length,u=new Array(l>1?l-1:0),d=1;d<l;d++)u[d-1]=arguments[d];return Object(_a.a)(s,u)};qa.config={type:"ridge-plot",datatype:["multivec"],orientation:"1d",name:"RidgePlot"};var Xa=qa,Ya=i(245),Za=i.n(Ya),Ja="\n  precision mediump float;\n  attribute vec2 aPosition;\n  attribute float aOpacity;\n  attribute float aHighlight;\n\n  uniform mat3 projectionMatrix;\n  uniform mat3 translationMatrix;\n  uniform float uPointSize;\n\n  varying float vHighlight;\n  varying float vOpacity;\n\n  void main(void)\n  {\n    vHighlight = aHighlight;\n    vOpacity = aOpacity;\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n    gl_PointSize = uPointSize;\n  }\n",Ka="\n  precision mediump float;\n\n  uniform vec4 uColor;\n  uniform vec4 uColorHighlight;\n\n  varying float vHighlight;\n  varying float vOpacity;\n\n  void main() {\n    float isNotFocused = 1.0 - vHighlight;\n\n    float r = uColor.r * isNotFocused + uColorHighlight.r * vHighlight;\n    float g = uColor.g * isNotFocused + uColorHighlight.g * vHighlight;\n    float b = uColor.b * isNotFocused + uColorHighlight.b * vHighlight;\n\n    gl_FragColor = vec4(r, g, b, 1.0) * vOpacity;\n  }\n",Qa=function(e){return[e.cX-e.widthHalf,e.y,e.cX+e.widthHalf,e.y,e.cX+e.widthHalf,e.y+e.height,e.cX-e.widthHalf,e.y+e.height]},$a=function(e,t){var i=4*t;return[i,i+1,i+2,i+2,i+3,i]},en=function(e){return[e.opacity,e.opacity,e.opacity,e.opacity]},tn=function(e){return[e.highlight,e.highlight,e.highlight,e.highlight]},an=function(e){return Math.abs(+e.fields[1]+(+e.fields[2]-+e.fields[1])/2-(+e.fields[4]+(+e.fields[4]-+e.fields[5])/2))},nn=function(e){return Object.values(e).reduce((function(e,t){return Math.max(e,t.tileData.reduce((function(e,t){return Math.max(e,t.distance)}),0))}),0)},on=function(e,t,i){var a=(i.domain()[1]-i.domain()[0])/(t.domain()[1]-t.domain()[0]),n=t.domain().map(i)[0];e.scale.x=a,e.position.x=-n*a},rn=function(e){return"".concat(e.fields[0],":").concat(e.fields[1],"-").concat(e.fields[2])},sn=function e(t){if(!(this instanceof e?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var i=t.libraries.PIXI,a=t.libraries.d3Scale,n=a.scaleLinear,o=a.scaleLog,r=t.services.tileProxy,s=t.configs.MAX_CLICK_DELAY,l=o().domain([1,10]).range([.1,1]).clamp(!0),u=function(e){Object(La.a)(o,e);var a=Object(za.a)(o);function o(e,t){var n;Object(Ta.a)(this,o),(n=a.call(this,e,t)).pLegend=new i.Graphics,n.pMasked.addChild(n.pLegend),n.legendMin=1/0,n.legendMax=-1/0,n.bg=new i.Sprite(i.Texture.WHITE);var r=Object(c.a)(n.dimensions,2);n.bg.width=r[0],n.bg.height=r[1],n.bg.interactive=!0,n.bg.interactiveChildren=!1,n.bg.alpha=0;var l=performance.now();return n.bg.mousedown=function(){l=performance.now()},n.bg.mouseup=function(e){performance.now()-l<s&&n.clickHandler(e)},n.updateOptions(),n.pLoading=new i.Graphics,n.pLoading.position.x=0,n.pLoading.position.y=0,n.pMasked.addChild(n.pLoading),n.loadIndicator=new i.Text("Loading data...",{fontSize:n.labelSize||10,fill:8421504}),n.pLoading.addChild(n.loadIndicator),n}return Object(Aa.a)(o,[{key:"initTile",value:function(e){var t=[];e.tileData.forEach((function(e,i){e.distance=an(e)||-1,e.cX=e.xStart+(e.xEnd-e.xStart)/2,e.regionId=rn(e),e.isLeftToRight=e.xStart<e.xEnd,t.push([e.xStart,e.xEnd,i])})),e.intervalTree=Za()(t)}},{key:"updateStratificationOption",value:function(){var e=this;if(!this.options.stratification)return this.categoryField=void 0,this.categoryToGroup=void 0,this.groupToColor=void 0,this.numGroups=0,this.numCategories=0,void(this.groupLabels=[]);this.categoryField=this.options.stratification.categoryField,this.getCategory=function(t){return t.fields[e.categoryField].toLowerCase()},this.categoryToGroup=new Map,this.categoryToY=new Map,this.yToCategory=new Map,this.groupToColor=new Map,this.numGroups=this.options.stratification.groups.length,this.groupSizes=this.options.stratification.groups.map((function(e){return e.categories.length})),this.numCategories=this.groupSizes.reduce((function(e,t){return e+t}),0),this.groupLabels=this.options.stratification.groups.map((function(e,t){return e.label||"Group ".concat(t)}));var a=0;this.options.stratification.groups.forEach((function(i,n){e.groupToColor.set(n,[t.utils.colorToHex(i.color||Ie[n%Ie.length]),t.utils.colorToHex(i.backgroundColor||ze[n%Ie.length])]),i.categories.forEach((function(t,i){var o=t.toLowerCase();e.categoryToGroup.set(o,n),e.categoryToY.set(o,a+i),e.yToCategory.set(a+i,o)})),a+=i.categories.length})),this.groupLabelsPixiText=this.groupLabels.map((function(a,n){return new i.Text(a,{fontSize:e.labelSize,align:"right"===e.axisAlign?"right":"left",fill:t.utils.colorToHex(e.options.stratification.groups[n].axisLabelColor||Le[n%Le.length])})}))}},{key:"updateOptions",value:function(){var e=this;switch(this.axisAlign=this.options.axisAlign||"left",this.labelColor=t.utils.colorToHex(this.options.labelColor||"black"),this.labelSize=this.options.labelSize||12,this.markColor=t.utils.colorToHex(this.options.markColor||"black"),this.markColorRgbNorm=this.options.markColor?t.utils.colorToRgba(this.options.markColor).slice(0,3).map((function(e){return Math.min(1,Math.max(0,e/255))})):[0,0,0],this.markOpacity=Number.isNaN(+this.options.markOpacity)?1:Math.min(1,Math.max(0,+this.options.markOpacity)),this.markSize=this.options.markSize||2,this.markMinWidth=this.options.markMinWidth||this.markSize,this.markHeight=this.options.markHeight||this.markSize,this.rowHeight=this.options.rowHeight||this.markHeight,this.markColorHighlight=t.utils.colorToHex(this.options.markColorHighlight||"red"),this.markColorHighlightRgbNorm=this.options.markColorHighlight?t.utils.colorToRgba(this.options.markColorHighlight).slice(0,3).map((function(e){return Math.min(1,Math.max(0,e/255))})):[1,0,0],this.markColorDehighlight=t.utils.colorToHex(this.options.markColorDehighlight||"#999999"),this.markColorDehighlightRgbNorm=this.options.markColorDehighlight?t.utils.colorToRgba(this.options.markColorDehighlight).slice(0,3).map((function(e){return Math.min(1,Math.max(0,e/255))})):[.6,.6,.6],this.markOpacityFocus=Number.isNaN(+this.options.markOpacityFocus)?this.markOpacity:Math.min(1,Math.max(0,+this.options.markOpacityFocus)),this.getImportance=this.options.importanceField?function(t){return+t.fields[e.options.importanceField]}:function(e){return e.distance},this.opacityEncoding=this.options.opacityEncoding||"solid",this.opacityEncoding){case"frequency":this.opacityScale=function(){return.1};break;case"highestImportance":case"closestImportance":var i=this.options.importanceDomain||[1,1e3],a=n().domain(i).range([1,10]);this.opacityScale=function(e){return l(a(e))};break;case"solid":default:this.opacityScale=function(){return 1}}this.focusRegion=this.options.focusRegion?this.options.focusRegion:[1/0,1/0],this.getRegion=this.options.focusRegion?function(e){return[e.xStart,e.xEnd]}:void 0,this.focusGene=this.options.focusGene?this.options.focusGene.toLowerCase():void 0,this.getGene=this.options.geneField?function(t){return t.fields[e.options.geneField].toLowerCase()}:void 0,this.focusStyle=this.options.focusStyle?this.options.focusStyle.toLowerCase():void 0,this.minImportance=this.options.minImportance||0,this.updateStratificationOption()}},{key:"rerender",value:function(e){this.options=e,this.updateOptions(),this.updateExistingGraphics()}},{key:"hasFetchedTiles",value:function(){return Object.values(this.fetchedTiles).length}},{key:"updateScales",value:function(){if(Object.values(this.fetchedTiles).length){var e=Object(c.a)(this.dimensions,2)[1];this.maxDist=nn(this.fetchedTiles),this.heightScale=n().domain([0,this.maxDist]).range([Math.min(12,e/10),e]),this.categoryHeightScale=n().domain([0,this.numCategories]).range([0,this.numCategories*this.rowHeight]),this.valueScale=n().domain([0,this.maxDist]).range([e,0]),this.valueScaleInverted=n().domain([0,this.maxDist]).range([0,e])}}},{key:"itemToIndicatorCategory",value:function(e,t){return{cX:this._xScale(e.cX),y:this.categoryHeightScale(this.categoryToY.get(this.getCategory(e))),opacity:this.opacityScale(this.getImportance(e)),highlight:t&&e.__focus,widthHalf:Math.max(this.markMinWidth/2,Math.abs(this._xScale(e.xStart)-this._xScale(e.xEnd))/2),height:this.markHeight,__item:e}}},{key:"isItemInFocus",value:function(){var e=this;return this.getGene&&this.focusGene&&this.getRegion&&this.focusRegion?function(t){return t.__focus=e.getGene(t)===e.focusGene&&xe(e.getRegion(t),e.focusRegion),t.__focus}:this.getGene&&this.focusGene?function(t){return t.__focus=e.getGene(t)===e.focusGene,t.__focus}:this.getRegion&&this.focusRegion?function(t){return t.__focus=xe(e.getRegion(t),e.focusRegion),t.__focus}:function(e){return e.__focus=!1,!0}}},{key:"itemToIndicatorReducer",value:function(e,t){return"highlighting"===this.focusStyle?function(i,a){return e(a),t(i,a),i}:function(i,a){return e(a)&&t(i,a),i}}},{key:"getPoints",value:function(e){var t=this,i=[],a=function(i,a){return i.push(t.itemToIndicatorCategory(a,e))};"highestImportance"===this.opacityEncoding?(i={},a=function(i,a){if(i[a.regionId]){var n=t.getImportance(i[a.regionId].__item);t.getImportance(a)>n&&(i[a.regionId]=t.itemToIndicatorCategory(a,e))}else i[a.regionId]=t.itemToIndicatorCategory(a,e)}):"closestImportance"===this.opacityEncoding&&(i={},a=function(i,a){(!i[a.regionId]||a.distance<i[a.regionId].__item.distance)&&(i[a.regionId]=t.itemToIndicatorCategory(a,e))});var n=this.isItemInFocus(),o=this.itemToIndicatorReducer(n,a);return Object.values(this.fetchedTiles).flatMap((function(e){return Object.values(e.tileData.reduce(o,i))}))}},{key:"renderIndicatorPoints",value:function(){this.drawnAtScale=n().domain(Object(_.a)(this.xScale().domain())).range(Object(_.a)(this.xScale().range()));var e=!("highlighting"!==this.focusStyle||!(this.focusGene&&this.getGene||this.focusRegion&&this.getRegion)),t=this.getPoints(e),a=new Float32Array(t.flatMap(Qa)),o=new Uint16Array(t.flatMap($a)),r=new Float32Array(t.flatMap(en)),s=new Float32Array(t.flatMap(tn)),l=new i.UniformGroup({uColor:[].concat(e?Object(_.a)(this.markColorDehighlightRgbNorm):Object(_.a)(this.markColorRgbNorm),[this.markOpacity]),uColorHighlight:[].concat(Object(_.a)(this.markColorHighlightRgbNorm),[this.markOpacity]),uHighlighting:e}),u=i.Shader.from(Ja,Ka,l),h=new i.Geometry;h.addAttribute("aPosition",a,2),h.addAttribute("aOpacity",r,1),h.addAttribute("aHighlight",s,1),h.addIndex(o);var d=new i.Mesh(h,u),p=new i.Graphics;p.addChild(this.bg),p.addChild(d);var m=Object(c.a)(this.dimensions,2);this.bg.width=m[0],this.bg.height=m[1],this.pMain.x=this.position[0],this.indicatorPointGraphics&&(this.indicatorPointGraphics.removeChild(this.bg),this.pMain.removeChild(this.indicatorPointGraphics)),this.pMain.addChild(p),this.indicatorPointGraphics=p,on(this.indicatorPointGraphics,this._xScale,this.drawnAtScale),this.draw(),this.animate()}},{key:"renderIndicatorCategoryAxis",value:function(){var e=this,t=Object(c.a)(this.dimensions,1)[0],i=Object(c.a)(this.position,2),a=i[0],n=i[1];this.pAxis.position.x="right"===this.axisAlign?a+t:a,this.pAxis.position.y=n,this.pAxis.clear();var o=0,r=0,s="right"===this.axisAlign?-5:5,l="right"===this.axisAlign?-t:t,u="right"===this.axisAlign?-3:3,h=this.pAxis.children.length;this.pAxis.lineStyle(1,0,1,0),this.groupLabelsPixiText.forEach((function(t,i){var a=e.categoryHeightScale(e.groupSizes[i]);r+=a,t.x=u,t.y=o+a/2,t.anchor.x="right"===e.axisAlign?1:0,t.anchor.y=.5,"highlighting"===e.options.focusStyle?e.pAxis.beginFill(16777215,.66):e.pAxis.beginFill(e.groupToColor.get(i)[1],.66),e.pAxis.lineStyle(0),"right"===e.axisAlign?e.pAxis.drawRect(t.x-t.width,t.y-t.height/2,t.width,t.height):e.pAxis.drawRect(t.x,t.y-t.height/2,t.width,t.height),e.pAxis.endFill(),h<i+1&&e.pAxis.addChild(t),e.pAxis.lineStyle(1,0,1,0),e.pAxis.moveTo(0,o),e.pAxis.lineTo(s,o),e.options.stratification.axisShowGroupSeparator&&we(e.pAxis,0,l,o,5),o=r})),this.pAxis.moveTo(0,0),this.pAxis.lineTo(0,r),this.pAxis.lineTo(s,r),this.options.stratification.axisShowGroupSeparator&&we(this.pAxis,0,l,r,5)}},{key:"renderIndicatorLegend",value:function(){if(this.pLegend.clear(),-1===this.opacityEncoding.indexOf("Importance"))return this.legendMinText&&(this.pLegend.removeChild(this.legendMinText),this.legendMinText.destroy(),this.legendMinText=void 0),void(this.legendMaxText&&(this.pLegend.removeChild(this.legendMaxText),this.legendMaxText.destroy(),this.legendMaxText=void 0));var e=Object(c.a)(this.dimensions,1)[0],t=Object(c.a)(this.position,2),a=t[0],n=t[1],o=this.categoryHeightScale.range(),r=Object(c.a)(o,2)[1],s="right"===this.options.legendAlign,l=!("highlighting"!==this.focusStyle||!(this.focusGene&&this.getGene||this.focusRegion&&this.getRegion));this.pLegend.position.x=s?a+e:a;var u=this.options.importanceDomain||[1,1e3],h=Object(c.a)(u,2),d=h[0],p=h[1];Math.abs(d-this.legendMin)>Ne&&(this.legendMinText&&(this.pLegend.removeChild(this.legendMinText),this.legendMinText.destroy()),this.legendMinText=new i.Text(Oe(d,3),{fontSize:this.labelSize,align:s?"right":"left",fill:8421504}),this.legendMinText.x=0,this.legendMinText.y=3,this.legendMinText.anchor.x=s?1:0,this.pLegend.addChild(this.legendMinText)),Math.abs(p-this.legendMax)>Ne&&(this.legendMaxText&&(this.pLegend.removeChild(this.legendMaxText),this.legendMaxText.destroy()),this.legendMaxText=new i.Text(Oe(p,3),{fontSize:this.labelSize,align:s?"right":"left",fill:8421504}),this.legendMaxText.x=0,this.legendMaxText.y=3,this.legendMaxText.anchor.x=s?1:0,this.pLegend.addChild(this.legendMaxText));var m=this.legendMinText.getBounds().width,f=this.legendMaxText.getBounds().width,g=s?-(f+42+6):m+12,b=18+6*l/2;this.pLegend.beginFill(16777215),this.pLegend.lineStyle(1,13421772),s?(this.legendMinText.x=g-6,this.pLegend.drawRoundedRect(-(42+m+f+18+.5),0,42+m+f+18,b,3)):(this.legendMaxText.x=g+42+12,this.pLegend.drawRoundedRect(.5,0,42+m+f+18,18+6*l/2,3)),this.pLegend.endFill(),this.pLegend.lineStyle(0);for(var v=0;v<5;v++){var x=this.opacityScale(d+v/4*p);this.pLegend.beginFill(this.markColor,x),this.pLegend.drawRect(9*v+g,3+3*!l,6,6),this.pLegend.endFill(),l&&(this.pLegend.beginFill(this.markColorHighlight,x),this.pLegend.drawRect(9*v+g,12,6,6),this.pLegend.endFill())}s?(this.legendMinText.x=g-6,this.legendMaxText.x=-3):(this.legendMinText.x=3,this.legendMaxText.x=g+42+6),this.pLegend.position.y=n+r-6-b}},{key:"updateIndicators",value:function(){this.renderIndicatorCategoryAxis(),this.renderIndicatorLegend(),this.renderIndicatorPoints()}},{key:"updateLoadIndicator",value:function(){var e=Object(c.a)(this.position,2),t=e[0],i=e[1];this.pLoading.position.x=t+6,this.pLoading.position.y=i+6,this.fetching.size?this.pLoading.addChild(this.loadIndicator):this.pLoading.removeChild(this.loadIndicator)}},{key:"updateExistingGraphics",value:function(){this.updateLoadIndicator(),this.hasFetchedTiles()&&(this.updateScales(),this.updateIndicators())}},{key:"drawTile",value:function(e){var t=this;if(e.graphics.clear(),this.updateLoadIndicator(),!this.options.stratification.axisNoGroupColor){var i=0,a=0;this.groupSizes.forEach((function(n,o){a+=t.categoryHeightScale(n),e.graphics.beginFill(t.groupToColor.get(o)[1]),e.graphics.drawRect(0,i,t.dimensions[0],Math.abs(a-i)),i=a})),e.graphics.endFill()}}},{key:"getElementAtPosition",value:function(e,t){var i=this;if(this.tilesetInfo){var a=this.calculateZoomLevel(),n=r.calculateTileWidth(this.tilesetInfo,a,this.tilesetInfo.tile_size),o=this.tileToLocalId([a,Math.floor(this._xScale.invert(e)/n)]),s=this.fetchedTiles[o];if(s){var c,l=this.yToCategory.get(Math.floor(this.categoryHeightScale.invert(t))),u=this._xScale.invert(e-1),h=this._xScale.invert(e+1);return s.intervalTree.queryInterval(u,h,(function(e){var t=s.tileData[e[2]];return i.getCategory(t)===l&&(c=t,!0)})),{item:c,category:l,tileId:o}}}}},{key:"getMouseOverHtml",value:function(e,t){var i=this.getElementAtPosition(e,t);if(!i)return"";var a=i.item,n=i.category;if(a){var o=this.groupToColor.get(this.categoryToGroup.get(n)),r=Object(c.a)(o,2),s=r[0],l=r[1],u="#".concat(s.toString(16)),h="#".concat(l.toString(16)),d=this.getImportance(a).toFixed(2);return'<div style="margin: -0.25rem; padding: 0 0.25rem; background: '.concat(h,'"><strong style="color: ').concat(u,';">').concat(n,":</strong> ").concat(d,"</div>")}return""}},{key:"clickHandler",value:function(e){var t=Object(c.a)(this.position,2),i=t[0],a=t[1],n=e.data.global.x-i,o=e.data.global.y-a,r=this.getElementAtPosition(n,o);r&&this.pubSub.publish("app.click",{type:"annotation",event:e,payload:r})}},{key:"setPosition",value:function(e){Object(Na.a)(Object(Ia.a)(o.prototype),"setPosition",this).call(this,e);var t=Object(c.a)(this.position,2);this.pMain.position.x=t[0],this.pMain.position.y=t[1]}},{key:"zoomed",value:function(e,t){this.xScale(e),this.yScale(t),this.indicatorPointGraphics&&on(this.indicatorPointGraphics,e,this.drawnAtScale),this.refreshTiles(),this.draw()}},{key:"refreshTiles",value:function(){Object(Na.a)(Object(Ia.a)(o.prototype),"refreshTiles",this).call(this),this.updateLoadIndicator()}},{key:"renderIndicatorCategoryAxisAsSvg",value:function(){var e=this,t=document.createElement("g");t.setAttribute("id","axis");var i=Object(c.a)(this.dimensions,1)[0],a=Object(c.a)(this.position,2),n=a[0],o=a[1];this.pAxis.position.x="right"===this.axisAlign?n+i:n,this.pAxis.position.y=o,t.setAttribute("transform","translate(".concat(this.pAxis.position.x,", ").concat(this.pAxis.position.y,")"));var r=0,s=0,l="right"===this.axisAlign?-5:5,u="right"===this.axisAlign?-i:i,h="right"===this.axisAlign?-3:3,d=function(e,t,i,a,n,o){var r=document.createElement("rect");return r.setAttribute("x",e),r.setAttribute("y",t),r.setAttribute("width",i),r.setAttribute("height",a),r.setAttribute("fill",n),r.setAttribute("fill-opacity",o),r.setAttribute("stroke-width",0),r},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.stroke,i=void 0===t?"#000000":t,a=e.strokeWidth,n=void 0===a?1:a,o=e.strokeDasharray,r=void 0===o?null:o;return function(e,t,a,o){var s=document.createElement("line");return s.setAttribute("x1",e),s.setAttribute("y1",t),s.setAttribute("x2",a),s.setAttribute("y2",o),s.setAttribute("stroke",i),s.setAttribute("stroke-width",n),r&&s.setAttribute("stroke-dasharray",r),s}},m=p({strokeDasharray:"5"}),f="highlighting"===this.options.focusStyle;return this.groupLabelsPixiText.forEach((function(i,a){var n=e.categoryHeightScale(e.groupSizes[a]);s+=n,i.x=h,i.y=r+n/2;var o=f?"#ffffff":"#".concat(e.groupToColor.get(a)[1].toString(16));"right"===e.axisAlign?t.appendChild(d(i.x-i.width,i.y-i.height/4,i.width,i.height,o,.66)):t.appendChild(d(i.x,i.y-i.height/4,i.width,i.height,o,.66)),t.appendChild(function(e){var t=document.createElement("text");return t.setAttribute("x",e.x),t.setAttribute("y",e.y+e.height/4),t.setAttribute("fill",e._style._fill),t.setAttribute("text-anchor","right"===e._style._align?"end":"start"),t.setAttribute("style","font: ".concat(e._font,";")),t.textContent=e.text,t}(i)),t.appendChild(p()(0,r,l,r)),e.options.stratification.axisShowGroupSeparator&&t.appendChild(m(0,r,u,r)),r=s})),t.appendChild(p()(0,0,0,s)),this.options.stratification.axisShowGroupSeparator&&t.appendChild(m(0,s,u,s)),t}},{key:"exportSVG",value:function(){var e=null,t=null,i=Object(Na.a)(Object(Ia.a)(o.prototype),"superSVG",this).call(this),a=Object(c.a)(i,2);t=a[0],e=a[1],t.setAttribute("class","exported-stratified-bed-track");var n=document.createElement("g");e.appendChild(n),n.setAttribute("transform","translate(".concat(this.position[0],",").concat(this.position[1],")"));var r=!("highlighting"!==this.focusStyle||!(this.focusGene&&this.getGene||this.focusRegion&&this.getRegion)),s=this.getPoints(r),l=r?this.options.markColorDehighlight||"#999999":this.options.markColor||"black",u=this.options.markColorHighlight||"red";return s.forEach((function(e,t){var i=e.cX,a=e.y,o=e.widthHalf,r=e.opacity,s=e.highlight,c=e.height,h=document.createElement("rect");h.setAttribute("x",i-o),h.setAttribute("y",a),h.setAttribute("width",2*o),h.setAttribute("height",c),h.setAttribute("fill",s?u:l),h.setAttribute("fill-opacity",r),h.setAttribute("stroke-width",0),n.appendChild(h)})),t.appendChild(this.renderIndicatorCategoryAxisAsSvg()),[t,e]}}]),o}(t.tracks.HorizontalLine1DPixiTrack),h=arguments.length,d=new Array(h>1?h-1:0),p=1;p<h;p++)d[p-1]=arguments[p];return Object(_a.a)(u,d)};sn.config={type:"stratified-bed",datatype:["arcs","bedlike"],orientation:"1d",name:"Arcs1D",thumbnail:(new DOMParser).parseFromString('<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5"><path d="M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268" fill="none" stroke="currentColor"/><path d="M10.5 3.5v12" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-dasharray="1,2,0,0"/><path d="M5.5 13.5V6" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-width=".9969299999999999" stroke-dasharray="1.71,3.43,0,0"/><path d="M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z" fill="currentColor"/><path d="M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z" fill="currentColor"/></svg>',"text/xml").documentElement,availableOptions:["arcStyle","flip1D","labelPosition","labelColor","labelTextOpacity","labelBackgroundOpacity","trackBorderWidth","trackBorderColor"],defaultOptions:{arcStyle:"ellipse",flip1D:"no",labelColor:"black",labelPosition:"hidden",trackBorderWidth:0,trackBorderColor:"black"},optionsInfo:{arcStyle:{name:"Arc Style",inlineOptions:{circle:{name:"Circle",value:"circle"},ellipse:{name:"Ellipse",value:"ellipse"}}}}};var cn=sn,ln="\n  precision mediump float;\n  attribute vec2 aPosition;\n  attribute float aOpacity;\n  attribute float aFocused;\n\n  uniform mat3 projectionMatrix;\n  uniform mat3 translationMatrix;\n  uniform float uPointSize;\n  uniform vec4 uColor;\n  uniform vec4 uColorFocused;\n\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vOpacity;\n  varying float vFocused;\n\n  void main(void)\n  {\n    vColor = uColor;\n    vColorFocused = uColorFocused;\n    vOpacity = aOpacity;\n    vFocused = aFocused;\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n    gl_PointSize = uPointSize;\n  }\n",un="\n  #ifdef GL_OES_standard_derivatives\n  #extension GL_OES_standard_derivatives : enable\n  #endif\n\n  precision mediump float;\n\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vOpacity;\n  varying float vFocused;\n\n  void main() {\n    float r = 0.0, delta = 0.0, alpha = 1.0;\n    vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n    r = dot(cxy, cxy);\n\n    #ifdef GL_OES_standard_derivatives\n      delta = fwidth(r);\n      alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n    #endif\n\n    gl_FragColor = vec4(vColor.rgb, alpha * vColor.a);\n  }\n",hn="\n  precision mediump float;\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vOpacity;\n  varying float vFocused;\n\n  void main() {\n    float isNotFocused = 1.0 - vFocused;\n\n    float r = vColor.r * isNotFocused + vColorFocused.r * vFocused;\n    float g = vColor.g * isNotFocused + vColorFocused.g * vFocused;\n    float b = vColor.b * isNotFocused + vColorFocused.b * vFocused;\n\n    gl_FragColor = vec4(r, g, b, 1.0) * vOpacity;\n  }\n",dn=["#c76526","#dca237","#eee462","#469b76","#3170ad","#6fb2e4","#000000","#999999"],pn=["#a65420","#b7872e","#9f9841","#3a8162","#295d90","#4a7798","#000000","#666666"],mn=["#f6e5db","#f9f0de","#fcfbe5","#e0eee8","#dde7f1","#e7f2fb","#d5d5d5","#ffffff"],fn=function(e){return e.tileData.length&&void 0!==e.tileData[0].yStart},gn=function(e){return e.xEnd-e.xStart},bn=function(e){return Math.abs(e.xStart+(e.xEnd-e.xStart)/2-(e.yStart+(e.yEnd-e.yStart)/2))},vn=function(e){return e.xStart},xn=function(e){return e.xStart+(e.xEnd-e.xStart)/2},yn=function(e){return e.xEnd},wn=function(e){return e.yStart+(e.yEnd-e.yStart)/2},kn=function(e){return Object.values(e).reduce((function(e,t){return Math.max(e,t.tileData.reduce((function(e,t){return Math.max(e,t.width)}),0))}),0)},Cn=function(e,t,i){var a=(i.domain()[1]-i.domain()[0])/(t.domain()[1]-t.domain()[0]),n=t.domain().map(i)[0];e.scale.x=a,e.position.x=-n*a},En=function e(t){if(!(this instanceof e?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var i=t.libraries.PIXI,a=t.libraries.d3Scale,n=a.scaleLinear,o=a.scaleLog,r=o().domain([1,10]).range([.1,1]).clamp(!0),s=function(e){Object(La.a)(o,e);var a=Object(za.a)(o);function o(e,t){var i;return Object(Ta.a)(this,o),(i=a.call(this,e,t)).updateOptions(),i}return Object(Aa.a)(o,[{key:"initTile",value:function(e){var t=fn(e),i=t?bn:gn,a=t?xn:vn,n=t?wn:yn;e.tileData.forEach((function(e){e.width=i(e),e.start=a(e),e.end=n(e),e.isLeftToRight=e.start<e.end}))}},{key:"updateTileWidthHistogram",value:function(e){var t=Math.max(this.dimensions[1]/this.pointSize),i=this.maxWidth/t,a=0;e.widthHistogramLeft=new Uint32Array(t),e.widthHistogramRight=new Uint32Array(t),e.tileData.forEach((function(t){var n=Math.round(t.width/i);t.histPos=t.isLeftToRight?e.widthHistogramRight[n]++:e.widthHistogramLeft[n]++,a=a>t.histPos?a:t.histPos})),e.widthHistogramMax=a}},{key:"updateWidthHistograms",value:function(){Object.values(this.fetchedTiles).forEach(this.updateTileWidthHistogram.bind(this))}},{key:"updateStratificationOption",value:function(){var e=this;if(!this.options.stratification)return this.categoryField=void 0,this.categoryToGroup=void 0,this.groupToColor=void 0,this.numGroups=0,this.numCategories=0,void(this.groupLabels=[]);this.categoryField=this.options.stratification.categoryField,this.categoryToGroup=new Map,this.categoryToY=new Map,this.groupToColor=new Map,this.numGroups=this.options.stratification.groups.length,this.groupSizes=this.options.stratification.groups.map((function(e){return e.categories.length})),this.numCategories=this.groupSizes.reduce((function(e,t){return e+t}),0),this.groupLabels=this.options.stratification.groups.map((function(e,t){return e.label||"Group ".concat(t)}));var a=0;this.options.stratification.groups.forEach((function(i,n){e.groupToColor.set(n,[t.utils.colorToHex(i.color||dn[n%dn.length]),t.utils.colorToHex(i.backgroundColor||mn[n%dn.length])]),i.categories.forEach((function(t,i){e.categoryToGroup.set(t.toLowerCase(),n),e.categoryToY.set(t.toLowerCase(),a+i)})),a+=i.categories.length})),this.groupLabelsPixiText=this.groupLabels.map((function(a,n){return new i.Text(a,{fontSize:e.labelSize,align:"right"===e.axisAlign?"right":"left",fill:t.utils.colorToHex(e.options.stratification.groups[n].axisLabelColor||pn[n%pn.length])})}))}},{key:"updateOptions",value:function(){var e=this;this.axisAlign=this.options.axisAlign||"left",this.labelColor=t.utils.colorToHex(this.options.labelColor||"black"),this.labelSize=this.options.labelSize||12,this.markColor=t.utils.colorToHex(this.options.markColor||"black"),this.markColorRgbNorm=this.options.markColor?t.utils.colorToRgba(this.options.markColor).slice(0,3).map((function(e){return Math.min(1,Math.max(0,e/255))})):[0,0,0],this.markOpacity=Number.isNaN(+this.options.markOpacity)?1:Math.min(1,Math.max(0,+this.options.markOpacity)),this.markSize=this.options.markSize||2,this.markColorFocus=t.utils.colorToHex(this.options.markColorFocus||"red"),this.markColorFocusRgbNorm=this.options.markColorFocus?t.utils.colorToRgba(this.options.markColorFocus).slice(0,3).map((function(e){return Math.min(1,Math.max(0,e/255))})):[1,0,0],this.markOpacityFocus=Number.isNaN(+this.options.markOpacityFocus)?this.markOpacity:Math.min(1,Math.max(0,+this.options.markOpacityFocus)),this.markSizeFocus=this.options.markSizeFocus||this.markSize,this.strokeColor=this.markColor||t.utils.colorToHex(this.options.strokeColor||"black"),this.strokeWidth=this.options.strokeWidth||this.markSize,this.getImportance=this.options.importanceField?function(t){return+t.fields[e.options.importanceField]}:function(e){return e.width};var i=this.options.importanceDomain||[1e3,1],a=n().domain(i).range([1,10]);this.opacityScale=function(e){return r(a(e))},this.focusRegion=this.options.focusRegion?this.options.focusRegion:[1/0,1/0],this.focusGene=this.options.focusGene?this.options.focusGene.toLowerCase():void 0,this.getGene=this.options.geneField?function(t){return t.fields[e.options.geneField].toLowerCase()}:void 0,this.minImportance=this.options.minImportance||0,this.updateStratificationOption(),this.updateWidthHistograms()}},{key:"rerender",value:function(e){this.options=e,this.updateOptions(),this.updateExistingGraphics()}},{key:"updateScales",value:function(){if(Object.values(this.fetchedTiles).length){var e=Object(c.a)(this.dimensions,2)[1],t=this.markSize/2;this.maxWidth=kn(this.fetchedTiles),this.heightScale=n().domain([0,this.maxWidth]).range([Math.min(12,e/10),e]),this.fullHeightScale=n().domain([this.maxWidth,0]).range([Math.min(t,e/10),Math.max(e-t,9*e/10)]),this.fullHeightScaleInverted=n().domain([0,this.maxWidth]).range([Math.min(t,e/10),Math.max(e-t,9*e/10)]),this.incomingHeightScale=n().domain([0,this.maxWidth]).range([e/2,e]),this.outgoingHeightScale=n().domain([0,this.maxWidth]).range([e/2,0]),this.categoryHeightScale=n().domain([0,this.numCategories]).range([0,this.numCategories*this.markSize]),this.valueScale=n().domain([0,this.maxWidth]).range([e,0]),this.valueScaleInverted=n().domain([0,this.maxWidth]).range([0,e])}}},{key:"itemToIndicatorDiverging",value:function(e){return{startX:this._xScale(e.start),endX:this._xScale(e.end),startY:this.outgoingHeightScale(e.width),endY:this.incomingHeightScale(e.width),opacity:this.opacityScale(this.getImportance(e)),size:this.markSize}}},{key:"itemToIndicatorStart",value:function(e){return{x:this._xScale(e.start),y:this.fullHeightScale(e.width),opacity:this.opacityScale(this.getImportance(e)),size:this.markSize}}},{key:"itemToIndicatorEnd",value:function(e){return{x:this._xScale(e.end),y:this.fullHeightScaleInverted(e.width),opacity:this.opacityScale(this.getImportance(e)),size:this.markSize}}},{key:"itemToIndicatorCategory",value:function(e){return{cX:this._xScale(e.start),cY:this.categoryHeightScale(this.categoryToY.get(e.fields[this.categoryField].toLowerCase())),wHalf:Math.max(this.markSize/2,Math.abs(this._xScale(e.xStart)-this._xScale(e.xEnd))/2),opacity:this.opacityScale(this.getImportance(e)),focused:e.xStart<=this.focusRegion[1]&&e.xEnd>=this.focusRegion[0],size:this.markSize,sizeHalf:this.markSize/2}}},{key:"itemToIndicatorReducer",value:function(e){var t=this;return this.getGene&&this.focusGene?function(i,a){return t.getGene(a)===t.focusGene&&i.push(e(a)),i}:function(t,i){return t.push(e(i)),t}}},{key:"renderIndicatorPoints",value:function(e,t,a,o){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=r.vertexShader,c=void 0===s?ln:s,l=r.fragmentShader,u=void 0===l?un:l,h=r.drawTriangles,d=void 0!==h&&h;this.drawnAtScale=n().domain(Object(_.a)(this.xScale().domain())).range(Object(_.a)(this.xScale().range()));var p=Object.values(this.fetchedTiles).flatMap((function(t){return t.tileData.reduce(e,[])})),m=new Float32Array(p.flatMap(t)),f=new Float32Array(p.flatMap(a)),g=new Float32Array(p.flatMap(o)),b=new i.UniformGroup({uPointSize:this.markSize,uColor:[].concat(Object(_.a)(this.markColorRgbNorm),[this.markOpacity]),uColorFocused:[].concat(Object(_.a)(this.markColorFocusRgbNorm),[this.markOpacity])}),v=i.Shader.from(c,u,b),x=new i.Geometry;x.addAttribute("aPosition",m,2),x.addAttribute("aOpacity",f,1),x.addAttribute("aFocused",g,1);var y=new i.Mesh(x,v,new i.State,d?i.DRAW_MODES.TRIANGLES:i.DRAW_MODES.POINTS),w=new i.Graphics;w.addChild(y),this.pMain.x=this.position[0],this.indicatorPointGraphics&&this.pMain.removeChild(this.indicatorPointGraphics),this.pMain.addChild(w),this.indicatorPointGraphics=w,Cn(this.indicatorPointGraphics,this._xScale,this.drawnAtScale),this.draw(),this.animate()}},{key:"renderIndicatorDistanceAxis",value:function(e){this.drawAxis(e)}},{key:"renderIndicatorCategoryAxis",value:function(){var e=this,t=Object(c.a)(this.dimensions,1)[0],i=Object(c.a)(this.position,2),a=i[0],n=i[1];this.pAxis.position.x="right"===this.axisAlign?a+t:a,this.pAxis.position.y=n,this.pAxis.clear();var o=0,r=0,s="right"===this.axisAlign?-5:5,l="right"===this.axisAlign?-t:t,u="right"===this.axisAlign?-3:3,h=this.pAxis.children.length;this.pAxis.lineStyle(1,0,1,0),this.groupLabelsPixiText.forEach((function(t,i){var a=e.categoryHeightScale(e.groupSizes[i]);r+=a,t.x=u,t.y=o+a/2,t.anchor.x="right"===e.axisAlign?1:0,t.anchor.y=.5,h<i+1&&e.pAxis.addChild(t),e.pAxis.moveTo(0,o),e.pAxis.lineTo(s,o),e.options.stratification.axisShowGroupSeparator&&we(e.pAxis,0,l,o,5),o=r})),this.pAxis.moveTo(0,0),this.pAxis.lineTo(0,r),this.pAxis.lineTo(s,r),this.options.stratification.axisShowGroupSeparator&&we(this.pAxis,0,l,r,5)}},{key:"updateIndicators",value:function(){var e=this.itemToIndicatorDiverging.bind(this),t=function(e){return[e.startX,e.startY,e.endX,e.endY]},i=function(e){return e.opacity},a=function(e){return e.focused},n=un,o=!1;"category"===this.options.indicatorStyle?(e=this.itemToIndicatorCategory.bind(this),t=function(e){return[e.cX,e.cY]},n=hn,this.renderIndicatorCategoryAxis(this.valueScaleInverted)):"category-rect"===this.options.indicatorStyle?(e=this.itemToIndicatorCategory.bind(this),t=function(e){return[e.cX-e.wHalf,e.cY,e.cX+e.wHalf,e.cY,e.cX+e.wHalf,e.cY+e.size,e.cX+e.wHalf,e.cY+e.size,e.cX-e.wHalf,e.cY+e.size,e.cX-e.wHalf,e.cY]},i=function(e){return[e.opacity,e.opacity,e.opacity,e.opacity,e.opacity,e.opacity]},a=function(e){return[e.focused,e.focused,e.focused,e.focused,e.focused,e.focused]},n=hn,o=!0,this.renderIndicatorCategoryAxis(this.valueScaleInverted)):"start-only"===this.options.indicatorStyle?(e=this.itemToIndicatorStart.bind(this),t=function(e){return[e.x,e.y]},this.renderIndicatorDistanceAxis(this.valueScale)):"end-only"===this.options.indicatorStyle&&(e=this.itemToIndicatorEnd.bind(this),t=function(e){return[e.x,e.y]},this.renderIndicatorDistanceAxis(this.valueScaleInverted)),e=this.itemToIndicatorReducer(e),this.renderIndicatorPoints(e,t,i,a,{fragmentShader:n,drawTriangles:o})}},{key:"updateExistingGraphics",value:function(){this.updateScales(),this.updateWidthHistograms(),"indicator"===this.options.arcStyle&&this.updateIndicators()}},{key:"drawTile",value:function(e,t){var i=this;if(e.graphics.clear(),e.tileData.length){if("indicator"===this.options.arcStyle){var a=Object(c.a)(this.dimensions,2),n=a[0],o=a[1];if(this.options.indicatorStyle.startsWith("category")){if(!this.options.stratification.axisNoGroupColor){var r=0,s=0;this.groupSizes.forEach((function(t,a){s+=i.categoryHeightScale(t),e.graphics.beginFill(i.groupToColor.get(a)[1]),e.graphics.drawRect(0,r,n,Math.abs(s-r)),r=s})),e.graphics.endFill()}}else{var l=Math.round(o/2)-.5;"start-only"===this.options.indicatorStyle?l=o-.5:"end-only"===this.options.indicatorStyle&&(l=.5),e.graphics.lineStyle(1,0,.2),e.graphics.moveTo(0,l),e.graphics.lineTo(n,l)}}for(var u=0;u<e.tileData.length;u++){var h=e.tileData[u];"circle"===this.options.arcStyle?this.drawCircle(e.graphics,h,t):"indicator"===this.options.arcStyle||this.drawEllipse(e.graphics,h,t)}}}},{key:"drawIndicator",value:function(e,t){var i=this._xScale(t.start),a=this._xScale(t.end),n=this.outgoingHeightScale(t.width),o=this.incomingHeightScale(t.width),r=this.opacityScale(this.getImportance(t));e.lineStyle(0,0,0),e.beginFill(4033753,r),e.drawCircle(i,n,this.pointSize),e.endFill(),e.beginFill(12680613,r),e.drawCircle(a,o,this.pointSize),e.endFill(),t.start<=this.focusRegion[1]&&t.end>=this.focusRegion[0]&&(t.start>=this.focusRegion[0]||t.end<=this.focusRegion[1])&&(e.lineStyle(this.pointSize,12680613,r),e.moveTo(i,o),e.lineTo(a,o),e.endFill())}},{key:"drawCircle",value:function(e,t,i,a){var o=this._xScale(t.start),r=this._xScale(t.end),s=Object(c.a)(this.dimensions,2),l=s[0],u=s[1],h=Object(c.a)(this.position,2)[1],d=(r-o)/2,p=(r-o)/2,m=(p*p+d*d)/(2*d),f=(o+r)/2,g=u-d+m,b="";a&&(b+="M".concat(o,",").concat(h+u)),e.moveTo(o,h+u);var v=Math.max(0,o),x=Math.min(l,r),y=this.markColor,w=this.markSize,k=this.markOpacity;t.start<=this.focusRegion[1]&&t.end>=this.focusRegion[0]&&(t.start>=this.focusRegion[0]||t.end<=this.focusRegion[1])&&(y=this.markColorFocus,w=this.markSizeFocus,k=this.markOpacityFocus),e.lineStyle(w,y,k);var C=Math.acos(Math.min(Math.max(-(v-f)/m,-1),1)),E=Math.acos(Math.min(Math.max(-(x-f)/m,-1),1));this.options.flip&&(g=0,E=-Math.PI,e.moveTo(o,0),a&&(b+="M".concat(o,",0")));for(var O=n().domain([0,9]).range([C,E]),S=0;S<10;S++){var j=f-m*Math.cos(O(S)),_=g-m*Math.sin(O(S));e.lineTo(j,_),a&&(b+="L".concat(j,",").concat(_))}a&&this.polys.push({polyStr:b,opacity:k})}},{key:"drawEllipse",value:function(e,t,i,a,o){var r=this._xScale(t.start),s=this._xScale(t.end),l=Object(c.a)(this.dimensions,2)[1],u=this.heightScale(t.width),h=s-r,d=h/2,p=(r+s)/2,m=l,f=Math.PI,g="";o&&(g+="M".concat(r,",").concat(l)),e.moveTo(r,l),this.options.flip&&(m=0,f=-Math.PI,e.moveTo(r,0),o&&(g+="M".concat(r,",0")));var b=this.markColor,v=this.markSize,x=this.markOpacity;t.start<=this.focusRegion[1]&&t.end>=this.focusRegion[0]&&(t.start>=this.focusRegion[0]||t.end<=this.focusRegion[1])&&(b=this.markColorFocus,v=this.markSizeFocus,x=this.markOpacityFocus),e.lineStyle(v,b,x);for(var y=10*Math.round(Math.abs(h)/200),w=n().domain([0,y-1]).range([0,f]),k=0;k<y;k++){var C=p-d*Math.cos(w(k)),E=m-u*Math.sin(w(k));e.lineTo(C,E),o&&(g+="L".concat(C,",").concat(E))}o&&this.polys.push({polyStr:g,opacity:x})}},{key:"getMouseOverHtml",value:function(){}},{key:"setPosition",value:function(e){Object(Na.a)(Object(Ia.a)(o.prototype),"setPosition",this).call(this,e);var t=Object(c.a)(this.position,2);this.pMain.position.x=t[0],this.pMain.position.y=t[1]}},{key:"zoomed",value:function(e,t){this.xScale(e),this.yScale(t),this.indicatorPointGraphics&&Cn(this.indicatorPointGraphics,e,this.drawnAtScale),this.refreshTiles(),this.draw()}},{key:"exportSVG",value:function(){var e=this,t=null,i=null,a=Object(Na.a)(Object(Ia.a)(o.prototype),"superSVG",this).call(this),n=Object(c.a)(a,2);i=n[0],t=n[1],i.setAttribute("class","exported-arcs-track");var r=document.createElement("g");t.appendChild(r),r.setAttribute("transform","translate(".concat(this.position[0],",").concat(this.position[1],")"));var s=this.options.strokeColor?this.options.strokeColor:"blue",l=this.options.strokeWidth?this.options.strokeWidth:2;return this.visibleAndFetchedTiles().forEach((function(t){e.polys=[],e.drawTile(t,!0);var i,a=Object(Ki.a)(e.polys);try{for(a.s();!(i=a.n()).done;){var n=i.value,o=n.polyStr,c=n.opacity,u=document.createElement("path");u.setAttribute("fill","transparent"),u.setAttribute("stroke",s),u.setAttribute("stroke-width",l),u.setAttribute("opacity",c),u.setAttribute("d",o),r.appendChild(u)}}catch(h){a.e(h)}finally{a.f()}})),[i,t]}}]),o}(t.tracks.HorizontalLine1DPixiTrack),l=arguments.length,u=new Array(l>1?l-1:0),h=1;h<l;h++)u[h-1]=arguments[h];return Object(_a.a)(s,u)};En.config={type:"1d-arcs",datatype:["arcs","bedlike"],orientation:"1d",name:"Arcs1D",thumbnail:(new DOMParser).parseFromString('<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5"><path d="M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268" fill="none" stroke="currentColor"/><path d="M10.5 3.5v12" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-dasharray="1,2,0,0"/><path d="M5.5 13.5V6" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-width=".9969299999999999" stroke-dasharray="1.71,3.43,0,0"/><path d="M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z" fill="currentColor"/><path d="M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z" fill="currentColor"/></svg>',"text/xml").documentElement,availableOptions:["arcStyle","flip1D","labelPosition","labelColor","labelTextOpacity","labelBackgroundOpacity","strokeColor","strokeWidth","trackBorderWidth","trackBorderColor"],defaultOptions:{arcStyle:"ellipse",flip1D:"no",labelColor:"black",labelPosition:"hidden",strokeColor:"black",strokeWidth:1,trackBorderWidth:0,trackBorderColor:"black"},optionsInfo:{arcStyle:{name:"Arc Style",inlineOptions:{circle:{name:"Circle",value:"circle"},ellipse:{name:"Ellipse",value:"ellipse"}}}}};var On=En,Sn=function e(t){if(!(this instanceof e?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var i=t.libraries.d3Array.range,a=t.libraries.d3Scale.scaleBand,n=t.services.tileProxy,o=t.utils.colorToHex,r=function(e){Object(La.a)(r,e);var t=Object(za.a)(r);function r(){return Object(Ta.a)(this,r),t.apply(this,arguments)}return Object(Aa.a)(r,[{key:"setValueScale",value:function(){if(this.valueScale=null,this.options&&this.options.valueColumn){var e=this.options.colorEncodingRange?+this.options.colorEncodingRange[0]:this.minVisibleValueInTiles(+this.options.valueColumn),t=this.options.colorEncodingRange?+this.options.colorEncodingRange[1]:this.maxVisibleValueInTiles(+this.options.valueColumn);if(this.options.valueColumn){var i=this.makeValueScale(e,this.calculateMedianVisibleValue(+this.options.valueColumn),t,2),a=Object(c.a)(i,1);this.valueScale=a[0]}}}},{key:"finalDotYPos",value:function(e,t){return Math.max(t,Math.min(this.dimensions[1]-t,e))}},{key:"drawPoly",value:function(e,t,i,a){var n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=[t,a,i,a,i,this.dimensions[1],t,this.dimensions[1]],r=Math.max(2,i-t),s=r*(1+2*n);return e.rectGraphics.drawCircle(t,this.finalDotYPos(a,r),s),o}},{key:"renderRows",value:function(e,t,n,r,s,c){var l=this,u=+e.tileId.split(".")[0];this.initialize();for(var h=a().domain(i(n)).range([r,s]).paddingInner(0),d=this.options.focusRegion||[1/0,1/0],p=[],m=[],f=0;f<t.length;f++){for(var g=0;g<t[f].length;g++){var b=t[f][g].value,v=b.fields,x=+b.chrOffset,y=+v[1]+x,w=+v[2]+x,k=h(f)+h.step()/2;this.valueScale&&(k=this.valueScale(+v[+this.options.valueColumn-1]));var C=k,E=this._xScale(y),O=this._xScale(w);if(!(u in this.drawnRects)||!(b.uid in this.drawnRects[u])){this.drawnRects[u]||(this.drawnRects[u]={});var S=[E,O,C,b,y,w];y<=d[1]&&w>=d[0]?m.push(S):p.push(S)}}e.rectGraphics.lineStyle(0),e.rectGraphics.beginFill(16777215),p.forEach((function(t){l.drawPoly(e,t[0],t[1],t[2],!0)}));var j=this.options.markColor||"black",_=this.options.fillOpacity||.3;e.rectGraphics.lineStyle(1,o(j),_),e.rectGraphics.beginFill(o(j),_),p.forEach((function(t){var i=l.drawPoly(e,t[0],t[1],t[2]);l.drawnRects[u][t[4].uid]=[i,{start:t[4],end:t[5],value:t[3],tile:e,fill:c},e.tileId]})),j=this.options.markColorFocus||"red",_=this.options.markOpacityFocus||.6,e.rectGraphics.lineStyle(1,o(j),_),e.rectGraphics.beginFill(o(j),_),m.forEach((function(t){var i=l.drawPoly(e,t[0],t[1],t[2]);l.drawnRects[u][t[4].uid]=[i,{start:t[4],end:t[5],value:t[3],tile:e,fill:c},e.tileId]})),e.rectGraphics.endFill()}return e.rectGraphics.interactive=!0,e.rectGraphics.buttonMode=!0,e.rectGraphics.mouseup=function(e){l.hoveringSnp&&l.pubSub.publish("app.click",{type:"snp",event:e,payload:l.hoveringSnp})},[p,m]}},{key:"getMouseOverHtml",value:function(e,t){var i=this;if(this.hoveringSnp=void 0,!this.tilesetInfo||!this.options.toolTip||!this.valueScale)return"";var a=this.calculateZoomLevel(),o=n.calculateTileWidth(this.tilesetInfo,a,this.tilesetInfo.tile_size),r=this._xScale.invert(e)/o,s=Math.floor(r),c=this.tileToLocalId([a,s]),l=this.fetchedTiles[c];if(!l)return"";var u=3;if(l.tileData.forEach((function(t){var a=Math.abs(i._xScale(t.xStart)-e);a<u&&(i.hoveringSnp=t,u=a)})),!this.hoveringSnp)return"";var h=this.finalDotYPos(this.valueScale(this.hoveringSnp.importance),2);if(Math.abs(h-(t-1))>6)return"";var d=this.hoveringSnp.fields[this.options.toolTip.name.field],p=(+this.hoveringSnp.fields[this.options.toolTip.value.field]).toFixed(this.options.toolTip.value.numDecimals||2),m="";return this.options.toolTip.other&&(this.options.toolTip.other.forEach((function(e){var t=e.label||"",a=(+i.hoveringSnp.fields[e.field]).toFixed(e.numDecimals||2);m+="".concat(t,": ").concat(a,";")})),m=" (".concat(m.substr(0,m.length-1),")")),"<div><strong>".concat(d,":</strong> ").concat(p).concat(m,"</div>")}},{key:"exportSVG",value:function(){var e=this,t=null,i=null,a=Object(Na.a)(Object(Ia.a)(r.prototype),"exportSVG",this).call(this),n=Object(c.a)(a,2);i=n[0],t=n[1],i.setAttribute("class","exported-snp-track");var o=document.createElement("g");t.appendChild(o),o.setAttribute("transform","translate(".concat(this.position[0],",").concat(this.position[1],")")),this.visibleAndFetchedTiles().filter((function(e){return e.plusStrandRows})).forEach((function(t){var i=e.renderRows(t,t.plusStrandRows,t.plusStrandRows.length,0,e.dimensions[1],"blue"),a=Object(c.a)(i,2),n=a[0],r=a[1];n.forEach((function(t){var i=document.createElement("circle");i.setAttribute("fill",e.options.markColor||"black"),i.setAttribute("stroke-width",0),i.setAttribute("opacity",e.options.markOpacity||.33),i.setAttribute("r",e.options.markSize),i.setAttribute("cx",t[0]),i.setAttribute("cy",t[2]),o.appendChild(i)})),r.forEach((function(t){var i=document.createElement("circle");i.setAttribute("fill",e.options.markColorFocus||"red"),i.setAttribute("stroke-width",0),i.setAttribute("opacity",e.options.markOpacityFocus||.66),i.setAttribute("r",e.options.markSize+1),i.setAttribute("cx",t[0]),i.setAttribute("cy",t[2]),o.appendChild(i)}))}));var s=document.createElement("g");if(s.setAttribute("id","axis"),i.appendChild(s),s.setAttribute("transform","translate(".concat(this.axis.pAxis.position.x,", ").concat(this.axis.pAxis.position.y,")")),"left"===this.options.axisPositionHorizontal||"top"===this.options.axisPositionVertical){var l=this.axis.exportAxisLeftSVG(this.valueScale,this.dimensions[1]);s.appendChild(l)}else if("right"===this.options.axisPositionHorizontal||"bottom"===this.options.axisPositionVertical){var u=this.axis.exportAxisRightSVG(this.valueScale,this.dimensions[1]);s.appendChild(u)}return[i,t]}}]),r}(t.tracks.BedLikeTrack),s=arguments.length,l=new Array(s>1?s-1:0),u=1;u<s;u++)l[u-1]=arguments[u];return Object(_a.a)(r,l)};Sn.config={type:"point-annotation",datatype:["arcs","bedlike"],orientation:"1d",name:"Arcs1D",thumbnail:(new DOMParser).parseFromString('<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5"><path d="M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268" fill="none" stroke="currentColor"/><path d="M10.5 3.5v12" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-dasharray="1,2,0,0"/><path d="M5.5 13.5V6" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-width=".9969299999999999" stroke-dasharray="1.71,3.43,0,0"/><path d="M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z" fill="currentColor"/><path d="M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z" fill="currentColor"/></svg>',"text/xml").documentElement,availableOptions:["arcStyle","flip1D","labelPosition","labelColor","labelTextOpacity","labelBackgroundOpacity","strokeColor","strokeWidth","trackBorderWidth","trackBorderColor"],defaultOptions:{arcStyle:"ellipse",flip1D:"no",labelColor:"black",labelPosition:"hidden",strokeColor:"black",strokeWidth:1,trackBorderWidth:0,trackBorderColor:"black"},optionsInfo:{arcStyle:{name:"Arc Style",inlineOptions:{circle:{name:"Circle",value:"circle"},ellipse:{name:"Ellipse",value:"ellipse"}}}}};var jn=Sn,_n="\nprecision mediump float;\nattribute vec2 aPosition;\nattribute float aColorIdx;\nattribute float aFocused;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform sampler2D uColorMapTex;\nuniform float uColorMapTexRes;\nuniform sampler2D uColorMapFocusTex;\nuniform float uColorMapFocusTexRes;\n\nvarying vec4 vColor;\nvarying vec4 vColorFocused;\nvarying float vFocused;\n\nvoid main(void)\n{\n  // Half a texel (i.e., pixel in texture coordinates)\n  float eps = 0.5 / uColorMapTexRes;\n  float colorRowIndex = floor((aColorIdx + eps) / uColorMapTexRes);\n  vec2 colorTexIndex = vec2(\n    (aColorIdx / uColorMapTexRes) - colorRowIndex + eps,\n    (colorRowIndex / uColorMapTexRes) + eps\n  );\n  vColor = texture2D(uColorMapTex, colorTexIndex);\n\n  float eps2 = 0.5 / uColorMapFocusTexRes;\n  float colorRowIndex2 = floor((aColorIdx + eps2) / uColorMapFocusTexRes);\n  vec2 colorTexIndex2 = vec2(\n    (aColorIdx / uColorMapFocusTexRes) - colorRowIndex2 + eps2,\n    (colorRowIndex2 / uColorMapFocusTexRes) + eps2\n  );\n  vColorFocused = texture2D(uColorMapFocusTex, colorTexIndex2);\n\n  vFocused = aFocused;\n\n  gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n}\n",Tn="\n  precision mediump float;\n\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vFocused;\n\n  void main() {\n    float isNotFocused = 1.0 - vFocused;\n\n    float r = vColor.r * isNotFocused + vColorFocused.r * vFocused;\n    float g = vColor.g * isNotFocused + vColorFocused.g * vFocused;\n    float b = vColor.b * isNotFocused + vColorFocused.b * vFocused;\n\n    gl_FragColor = vec4(r, g, b, 1.0);\n  }\n",An=function(e){return e.tileData.length&&void 0!==e.tileData[0].yStart},Mn=function(e){return e.xStart},Rn=function(e){return e.xStart+(e.xEnd-e.xStart)/2},Nn=function(e){return e.xEnd},In=function(e){return e.yStart+(e.yEnd-e.yStart)/2},Ln=function(e){return e.reduce((function(e,t){return Math.max(e,t.histogramMax)}),0)},zn=function(e,t,i){var a=(i.domain()[1]-i.domain()[0])/(t.domain()[1]-t.domain()[0]),n=t.domain().map(i)[0];e.scale.x=a,e.position.x=-n*a},Pn=function(e){return[e.xStart,e.yStart,e.xEnd,e.yStart,e.xEnd,e.yEnd,e.xStart,e.yStart,e.xStart,e.yEnd,e.xEnd,e.yEnd]},Dn=function(e){return[e.colorIdx,e.colorIdx,e.colorIdx,e.colorIdx,e.colorIdx,e.colorIdx]},Fn=function(e){return[e.focused,e.focused,e.focused,e.focused,e.focused,e.focused]},Gn=function e(t){if(!(this instanceof e?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var i=t.libraries.PIXI,a=t.libraries.d3Scale,n=a.scaleLinear,o=a.scaleLog,r=t.services.tileProxy,s=t.utils.colorToHex,l=o().domain([1,10]).range([.1,1]).clamp(!0),u=function(e){return t.utils.colorToRgba(e).slice(0,3).map((function(e){return Math.min(1,Math.max(0,e/255))}))},h=function(e){Object(La.a)(a,e);var t=Object(za.a)(a);function a(e,n){var o;return Object(Ta.a)(this,a),(o=t.call(this,e,n)).updateOptions(),o.pLoading=new i.Graphics,o.pLoading.position.x=0,o.pLoading.position.y=0,o.pMasked.addChild(o.pLoading),o.loadIndicator=new i.Text("Loading data...",{fontSize:o.labelSize||10,fill:8421504}),o.pLoading.addChild(o.loadIndicator),o}return Object(Aa.a)(a,[{key:"initTile",value:function(e){var t=An(e),i=t?Rn:Mn,a=t?In:Nn;e.tileData.forEach((function(e){e.start=i(e),e.end=a(e),e.isLeftToRight=e.start<e.end})),e.histogramMax=0,this.updateTileFocusMap(e)}},{key:"updateTileHistogram",value:function(e){var t=this,i=this.getTilePosAndDimensions(e.tileData.zoomLevel,e.tileData.tilePos),a=i.tileX,n=i.tileWidth/this.numBins;e.binXPos=new Float32Array(this.numBins+1),e.histogram1d=new Float32Array(this.numBins),e.histogram2d=new Float32Array(this.numBins*this.numGroups),e.histogram2dNumPred=new Uint8Array(this.numBins*this.numGroups);for(var o=0,r=0;r<=this.numBins;r++)e.binXPos[r]=a+n*r;var s=new Map;e.tileData.forEach((function(i){for(var r=t.categoryToGroup.get(i.fields[t.categoryField].toLowerCase()),c=t.numBins-1,l=Math.max(0,Math.min(c,Math.round((i.xStart-a)/n))),u=Math.max(0,Math.min(c,Math.round((i.xEnd-a)/n))),h=Math.abs(u-l),d=t.getImportance(i),p=t.getCategory(i),m=r*t.numBins,f=0;f<=h;f++){var g=l+f,b=m+g,v=s.get(p)||{};v[g]||(v[g]=v[g]||d>0,e.histogram2dNumPred[b]+=v[g],s.set(p,v)),e.histogram2d[b]+=d,e.histogram1d[g]+=d,o=Math.max(o,e.histogram1d[g])}})),e.histogramMax=o}},{key:"updateHistograms",value:function(){Object.values(this.fetchedTiles).forEach(this.updateTileHistogram.bind(this))}},{key:"updateTileFocusMap",value:function(e){e.focusMap=new Float32Array(this.numBins);var t=this.getTilePosAndDimensions(e.tileData.zoomLevel,e.tileData.tilePos),i=t.tileX,a=t.tileWidth;if(i<=this.focusRegion[1]&&i+a>=this.focusRegion[0])for(var n=a/this.numBins,o=Math.max(0,Math.round((this.focusRegion[0]-i)/n)),r=Math.min(this.numBins-1,Math.round((this.focusRegion[1]-i)/n)),s=Math.abs(r-o),c=0;c<=s;c++)e.focusMap[c]=1}},{key:"updateFocusMap",value:function(){Object.values(this.fetchedTiles).forEach(this.updateTileFocusMap.bind(this))}},{key:"updateStratificationOption",value:function(){var e=this;if(!this.options.stratification)return this.categoryField=void 0,this.categoryToGroup=void 0,this.groupToColor=void 0,this.numGroups=0,this.numCategories=0,void(this.groupLabels=[]);this.categoryField=this.options.stratification.categoryField,this.getCategory=function(t){return t.fields[e.categoryField].toLowerCase()},this.categoryToGroup=new Map,this.categoryToY=new Map,this.groupToColor=new Map,this.numGroups=this.options.stratification.groups.length,this.groupSizes=this.options.stratification.groups.map((function(e){return e.categories.length})),this.numCategories=this.groupSizes.reduce((function(e,t){return e+t}),0),this.groupLabels=this.options.stratification.groups.map((function(e,t){return e.label||"Group ".concat(t)}));var t=0;this.options.stratification.groups.forEach((function(i,a){e.groupToColor.set(a,[s(i.color||Ie[a%Ie.length]),s(i.backgroundColor||ze[a%ze.length])]),i.categories.forEach((function(i,n){e.categoryToGroup.set(i.toLowerCase(),a),e.categoryToY.set(i.toLowerCase(),t+n)})),t+=i.categories.length})),this.groupLabelsPixiText=this.groupLabels.map((function(t,a){return new i.Text(t,{fontSize:e.labelSize,align:"right"===e.axisAlign?"right":"left",fill:s(e.options.stratification.groups[a].axisLabelColor||Le[a%Le.length])})}))}},{key:"updateOptions",value:function(){var e=this;this.axisAlign=this.options.axisAlign||"left",this.labelColor=s(this.options.labelColor||"black"),this.labelSize=this.options.labelSize||12,this.colorMap=this.options.colorMap||Object(_.a)(Ie),this.colorMapRgbNorm=this.colorMap.map(u);var t=ye(i,this.colorMapRgbNorm),a=Object(c.a)(t,2);this.colorMapTex=a[0],this.colorMapTexRes=a[1],this.colorMapFocus=this.options.colorMapFocus||Object(_.a)(Le),this.colorMapFocusRgbNorm=this.colorMapFocus.map(u);var o=ye(i,this.colorMapFocusRgbNorm),r=Object(c.a)(o,2);this.colorMapFocusTex=r[0],this.colorMapFocusTexRes=r[1],this.markColor=s(this.options.markColor||"black"),this.markColorRgbNorm=this.options.markColor?u(this.options.markColor):[0,0,0],this.markOpacity=Number.isNaN(+this.options.markOpacity)?1:Math.min(1,Math.max(0,+this.options.markOpacity)),this.markSize=this.options.markSize||2,this.markColorFocus=s(this.options.markColorFocus||"red"),this.markColorFocusRgbNorm=this.options.markColorFocus?u(this.options.markColorFocus):[1,0,0],this.markOpacityFocus=Number.isNaN(+this.options.markOpacityFocus)?this.markOpacity:Math.min(1,Math.max(0,+this.options.markOpacityFocus)),this.markSizeFocus=this.options.markSizeFocus||this.markSize,this.binSize=this.options.binSize||8,this.numBins=this.tilesetInfo?Math.round(this.tilesetInfo.tile_size/this.binSize):1024/this.binSize,this.getImportance=this.options.importanceField?function(t){return+t.fields[e.options.importanceField]}:function(){return 1};var h=this.options.importanceDomain||[1e3,1],d=n().domain(h).range([1,10]);this.opacityScale=function(e){return l(d(e))},this.focusRegion=this.options.focusRegion?this.options.focusRegion:[1/0,1/0],this.focusGene=this.options.focusGene?this.options.focusGene.toLowerCase():void 0,this.getGene=this.options.geneField?function(t){return t.fields[e.options.geneField].toLowerCase()}:void 0,this.minImportance=this.options.minImportance||0,this.updateStratificationOption(),this.updateFocusMap(),this.updateHistograms(),this.updateScales()}},{key:"updateLoadIndicator",value:function(){var e=Object(c.a)(this.position,2),t=e[0],i=e[1];this.pLoading.position.x=t+6,this.pLoading.position.y=i+6,this.fetching.size?this.pLoading.addChild(this.loadIndicator):this.pLoading.removeChild(this.loadIndicator)}},{key:"refreshTiles",value:function(){for(var e,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];if((e=Object(Na.a)(Object(Ia.a)(a.prototype),"refreshTiles",this)).call.apply(e,[this].concat(i)),this.updateLoadIndicator(),this.tilesetInfo){var o=this.numBins;this.numBins=Math.round(this.tilesetInfo.tile_size/this.binSize),o!==this.numBins&&(this.updateHistograms(),this.updateScales())}}},{key:"rerender",value:function(e){this.options=e,this.updateOptions(),this.updateExistingGraphics()}},{key:"updateScales",value:function(){var e=Object.values(this.fetchedTiles);if(e.length){var t=Object(c.a)(this.dimensions,2)[1];this.histMax=Ln(e),this.heightScale=n().domain([0,this.histMax]).range([t,0]),this.valueScale=this.heightScale,this.valueScaleInverted=n().domain([0,this.histMax]).range([0,t])}}},{key:"itemToPoint",value:function(e){return{xStart:this._xScale(e.start),xEnd:this._xScale(e.start),yStart:this.heightScale(this.categoryToY.get(e.fields[this.categoryField].toLowerCase())),yEnd:function(){},opacity:this.opacityScale(this.getImportance(e)),focused:e.xStart<=this.focusRegion[1]&&e.xEnd>=this.focusRegion[0]}}},{key:"histToSegments",value:function(e){for(var t=[],i=0;i<this.numBins;i++){var a=0;if(e.histogram1d[i]>0)for(var n=0;n<this.numGroups;n++){var o=e.histogram2d[n*this.numBins+i];o&&(t.push({xStart:this._xScale(e.binXPos[i]),xEnd:this._xScale(e.binXPos[i+1]),yStart:this.heightScale(a),yEnd:this.heightScale(a+o),colorIdx:n%this.colorMap.length,focused:e.focusMap[i]}),a+=o)}}return t}},{key:"renderStackedBars",value:function(){this.drawnAtScale=n().domain(Object(_.a)(this.xScale().domain())).range(Object(_.a)(this.xScale().range()));var e=Object.values(this.fetchedTiles).flatMap(this.histToSegments.bind(this)),t=new Float32Array(e.flatMap(Pn)),a=new Float32Array(e.flatMap(Dn)),o=new Float32Array(e.flatMap(Fn)),r=new i.UniformGroup({uColorMapTex:this.colorMapTex,uColorMapTexRes:this.colorMapTexRes,uColorMapFocus:this.colorMapFocusTex,uColorMapFocusTexRes:this.colorMapFocusTexRes}),s=i.Shader.from(_n,Tn,r),c=new i.Geometry;c.addAttribute("aPosition",t,2),c.addAttribute("aColorIdx",a,1),c.addAttribute("aFocused",o,1);var l=new i.Mesh(c,s,new i.State,i.DRAW_MODES.TRIANGLES),u=new i.Graphics;u.addChild(l),this.pMain.x=this.position[0],this.indicatorPointGraphics&&this.pMain.removeChild(this.indicatorPointGraphics),this.pMain.addChild(u),this.indicatorPointGraphics=u,zn(this.indicatorPointGraphics,this._xScale,this.drawnAtScale),this.draw(),this.animate()}},{key:"renderTrack",value:function(){this.drawAxis(this.valueScaleInverted),this.renderStackedBars()}},{key:"hasFetchedTiles",value:function(){return Object.values(this.fetchedTiles).length}},{key:"updateExistingGraphics",value:function(){this.updateLoadIndicator(),this.hasFetchedTiles()&&(this.updateHistograms(),this.updateScales(),this.renderTrack())}},{key:"getMouseOverHtml",value:function(e,t){if(!this.tilesetInfo)return"";var i=this.calculateZoomLevel(),a=r.calculateTileWidth(this.tilesetInfo,i,this.tilesetInfo.tile_size),n=this._xScale.invert(e)/a,o=Math.floor(n),s=this.tileToLocalId([i,o]),l=this.fetchedTiles[s];if(!l)return"";for(var u=n-o,h=Math.floor(this.numBins*u),d=[],p=[],m=0,f=0,g=0;g<this.numGroups;g++){f+=l.histogram2d[g*this.numBins+h];var b=l.histogram2dNumPred[g*this.numBins+h];p.push(b),m+=b,d.push(f)}var v=this.heightScale.invert(t),x=d.findIndex((function(e){return e>v}));if(x>=0){var y=this.groupToColor.get(x),w=Object(c.a)(y,2),k=w[0],C=w[1],E="#".concat(k.toString(16)),O="#".concat(C.toString(16)),S=l.histogram2dNumPred[x*this.numBins+h];return'<div style="margin: -0.25rem; padding: 0 0.25rem; background: '.concat(O,'"><strong style="color: ').concat(E,';">').concat(this.groupLabels[x],":</strong> ").concat(S," of ").concat(m," samples</div>")}return""}},{key:"setPosition",value:function(e){Object(Na.a)(Object(Ia.a)(a.prototype),"setPosition",this).call(this,e);var t=Object(c.a)(this.position,2);this.pMain.position.x=t[0],this.pMain.position.y=t[1]}},{key:"zoomed",value:function(e,t){this.xScale(e),this.yScale(t),this.indicatorPointGraphics&&zn(this.indicatorPointGraphics,e,this.drawnAtScale),this.refreshTiles(),this.draw()}},{key:"exportSVG",value:function(){var e=this,t=null,i=null,n=Object(Na.a)(Object(Ia.a)(a.prototype),"superSVG",this).call(this),o=Object(c.a)(n,2);i=o[0],t=o[1],i.setAttribute("class","exported-stacked-bar-track");var r=document.createElement("g");t.appendChild(r),r.setAttribute("transform","translate(".concat(this.position[0],",").concat(this.position[1],")")),Object.values(this.fetchedTiles).flatMap(this.histToSegments.bind(this)).forEach((function(t){var i=t.xStart,a=t.xEnd,n=t.yStart,o=t.yEnd,s=t.colorIdx,c=document.createElement("rect");c.setAttribute("x",a),c.setAttribute("y",o),c.setAttribute("width",Math.abs(a-i)),c.setAttribute("height",Math.abs(o-n)),c.setAttribute("fill",e.colorMap[s]),c.setAttribute("stroke-width",0),r.appendChild(c)}));var s=document.createElement("g");if(s.setAttribute("id","axis"),i.appendChild(s),s.setAttribute("transform","translate(".concat(this.axis.pAxis.position.x,", ").concat(this.axis.pAxis.position.y,")")),"left"===this.options.axisPositionHorizontal||"top"===this.options.axisPositionVertical){var l=this.axis.exportAxisLeftSVG(this.valueScale,this.dimensions[1]);s.appendChild(l)}else if("right"===this.options.axisPositionHorizontal||"bottom"===this.options.axisPositionVertical){var u=this.axis.exportAxisRightSVG(this.valueScale,this.dimensions[1]);s.appendChild(u)}return[i,t]}}]),a}(t.tracks.HorizontalLine1DPixiTrack),d=arguments.length,p=new Array(d>1?d-1:0),m=1;m<d;m++)p[m-1]=arguments[m];return Object(_a.a)(h,p)};Gn.config={type:"stacked-bar",datatype:["bedlike"],orientation:"1d",name:"Advanced Stacked Bars Track",thumbnail:(new DOMParser).parseFromString('<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5"><path d="M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268" fill="none" stroke="currentColor"/><path d="M10.5 3.5v12" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-dasharray="1,2,0,0"/><path d="M5.5 13.5V6" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-width=".9969299999999999" stroke-dasharray="1.71,3.43,0,0"/><path d="M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z" fill="currentColor"/><path d="M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z" fill="currentColor"/></svg>',"text/xml").documentElement,availableOptions:["arcStyle","flip1D","labelPosition","labelColor","labelTextOpacity","labelBackgroundOpacity","strokeColor","strokeWidth","trackBorderWidth","trackBorderColor"],defaultOptions:{arcStyle:"ellipse",flip1D:"no",labelColor:"black",labelPosition:"hidden",strokeColor:"black",strokeWidth:1,trackBorderWidth:0,trackBorderColor:"black"},optionsInfo:{arcStyle:{name:"Arc Style",inlineOptions:{circle:{name:"Circle",value:"circle"},ellipse:{name:"Ellipse",value:"ellipse"}}}}};var Hn=Gn;function Bn(e){if(!(this instanceof Bn?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var t=function(e){Object(La.a)(i,e);var t=Object(za.a)(i);function i(e,a){var n;Object(Ta.a)(this,i),n=t.call(this,e,a);var o=Object(fe.a)(),r=o.publish,s=o.subscribe,c=o.unsubscribe;return n.publish=r,n.subscribe=s,n.unsubscribe=c,n}return Object(Aa.a)(i,[{key:"drawPoly",value:function(e,t,i,a){var n=[t,a,i,a,i,this.dimensions[1],t,this.dimensions[1]],o=1,r=2;return e.rectGraphics.drawCircle(t,this.finalDotYPos(a,o),r),n}},{key:"renderRows",value:function(e,t,i,a,n,o){var r=this,s=+e.tileId.split(".")[0];this.initialize();for(var c=this.options.focusRegion||[1/0,1/0],l=[],u=[],h=0;h<t.length;h++){for(var d=0;d<t[h].length;d++){var p=t[h][d].value,m=p.fields,f=+p.chrOffset,g=+m[1]+f,b=+m[2]+f,v=this._xScale(g),x=this._xScale(b);if(!(s in this.drawnRects)||!(p.uid in this.drawnRects[s])){this.drawnRects[s]||(this.drawnRects[s]={});var y={xStartScreen:v,xEndScreen:x,xStartAbs:g,xEndAbs:b,data:p};g<=c[1]&&b>=c[0]?u.push(y):l.push(y)}}l.forEach((function(e){r.publish("annotationDrawn",e)}))}}},{key:"rerender",value:function(){this.draw(),this.publish("tilesDrawn",{uuid:this.uuid})}},{key:"updateExistingGraphics",value:function(){Object(Na.a)(Object(Ia.a)(i.prototype),"updateExistingGraphics",this).call(this),this.publish("tilesDrawn",{uuid:this.uuid})}},{key:"getMouseOverHtml",value:function(){return""}}]),i}(e.tracks.BedLikeTrack),i=arguments.length,a=new Array(i>1?i-1:0),n=1;n<i;n++)a[n-1]=arguments[n];return Object(_a.a)(t,a)}Bn.config={type:"tss",datatype:["bedlike"]};var Wn=Bn,Un=function e(t){if(!(this instanceof e?this.constructor:void 0))throw new Error('Uncaught TypeError: Class constructor cannot be invoked without "new"');for(var i=function(){return Math.random().toString(36).substring(2)},a=function(){function e(t){Object(Ta.a)(this,e),this.dataConfig=t}return Object(Aa.a)(e,[{key:"tilesetInfo",value:function(e){var t=this;this.tilesetInfoLoading=!0,this.tilesetInfoData||(this.tilesetInfoData=new Promise((function(e,a){var n=i(),o=setTimeout((function(){return a(new Error("Could not load tileset info for ".concat(t.dataConfig.id)))}),1e4);fe.b.subscribe("localBed:tilesetInfo:".concat(n),(function(i){clearTimeout(o),t.tilesetInfoLoading=!1,e(i)}),1),fe.b.publish("localBed:requestTilesetInfo",{fileId:t.dataConfig.id,requestId:n})}))),this.tilesetInfoData.then((function(t){e(t)}))}},{key:"fetchTilesDebounced",value:function(e,t){var i=this;Promise.all(t.map((function(e){return i.tile(e.split("."))}))).then((function(i){e(i.reduce((function(e,i,a){return e[t[a]]=i,e}),{}))}))}},{key:"tile",value:function(e){var t=this,a=Object(c.a)(e,2),n=a[0],o=a[1];return new Promise((function(e,a){var r=i(),s=setTimeout((function(){return a(new Error("Could not load tile ".concat(n,".").concat(o," for ").concat(t.dataConfig.id," (request: ").concat(r,")")))}),1e4);fe.b.subscribe("localBed:tile:".concat(r),(function(t){clearTimeout(s),e(t)}),1),fe.b.publish("localBed:requestTile",{fileId:t.dataConfig.id,z:+n,x:+o,requestId:r})}))}}]),e}(),n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return Object(_a.a)(a,o)};Un.config={type:"localBed"};var Vn=Un;i(439);Object(a.a)({dataFetcher:Vn,config:Vn.config},{pluginType:"dataFetcher"}),Object(a.a)({track:Xa,config:Xa.config}),Object(a.a)({track:On,config:On.config}),Object(a.a)({track:cn,config:cn.config}),Object(a.a)({track:jn,config:jn.config}),Object(a.a)({track:Hn,config:Hn.config}),Object(a.a)({track:Wn,config:Wn.config}),Object(a.a)({track:Ra,config:Ra.config,isMetaTrack:!0}),s.a.render(o.a.createElement(ja,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[329,1,2]]]);
//# sourceMappingURL=main.ec7da155.chunk.js.map