{"version":3,"sources":["images/enhancer-view-1.png","images/enhancer-view-2.png","images/enhancer-view-3.png","images/enhancer-view-4.png","images/enhancer-view-5.png","images/gene-view-1.png","images/gene-view-2.png","AppInitializing.js","AppError.js","ChromInfoProvider.js","use-debounce.js","CheckboxList.js","Logo.js","FileInput.js","utils.js","local-bed-data-server.js","use-query-string.js","constants.js","state.js","VariantsSettings.js","Welcome.js","ModalProvider.js","AppSidebar.js","SearchField.js","use-previous.js","AppTopbar.js","EnhancerRegionsInfo.js","EnhancerRegionsHelp.js","EnhancerRegionsSettings.js","TitleBar.js","view-config.js","EnhancerRegions.js","EnhancerGenesInfo.js","EnhancerGenesHelp.js","AntSwitch.js","EnhancerGenesSettings.js","TooltipProvider.js","EnhancerGenesPlot.js","EnhancerGenes.js","DnaAccessibilityInfo.js","DnaAccessibilityHelp.js","DnaAccessibilitySettings.js","DnaAccessibility.js","AppMain.js","with-either.js","App.js","serviceWorker.js","annotation-overlay-meta-track.js","ridge-plot-track.js","stratified-bed-track.js","snp-track.js","stacked-bar-track.js","tss-track.js","local-bed-data-fetcher.js","index.js"],"names":["module","exports","useStyles","makeStyles","theme","backdrop","zIndex","drawer","color","backgroundColor","AppInitializing","classes","className","Backdrop","open","CircularProgress","ChromInfoContext","createContext","ChromInfoProvider","children","chromInfo","Provider","value","useChromInfo","context","React","useContext","undefined","Error","useDebounce","delay","useState","debouncedValue","setDebouncedValue","useEffect","handler","setTimeout","clearTimeout","root","position","filterBar","top","content","right","left","bottom","background","checkbox","marginTop","marginBottom","checkboxLabel","fontSize","marginLeft","nestedCheckbox","visible","transition","transform","height","invisible","Option","memo","filterState","name","stateWithName","group","stateWithGroup","colorCheckbox","colorText","filter","useRecoilValue","useRecoilState","state","setState","groupState","setGroupState","nameLowerCase","useMemo","toLowerCase","changeHandler","useCallback","event","currState","checked","target","currGroupState","newGroupState","n","N","length","includes","FormControlLabel","key","control","Checkbox","style","icon","checkedIcon","onChange","label","Typography","noWrap","OptionGroup","NestedCheckboxList","optionWithName","optionGroupWithGroup","filterLabel","groupedOptions","optionToGroup","groupColors","groupColorsDark","globalFilter","setGlobalFilter","setFilter","filterDb","filterChangeHandler","filterBarBg","FormControl","variant","margin","fullWidth","InputLabel","htmlFor","Grid","container","direction","alignItems","OutlinedInput","id","FormGroup","map","i","Fragment","options","option","logo","padding","lineHeight","fontWeight","logoAbc","letterSpacing","paddingRight","logoEnhancer","Logo","props","styles","item","defaultProps","FileInput","forwardRef","ref","clearHandler","onClear","accept","Icon","InsertDriveFileIcon","otherProps","file","setFile","localChangeHandler","fileList","files","clearFile","ButtonGroup","Button","component","disableElevation","startIcon","type","hidden","disabled","onClick","contains","a","b","createColorTexture","PIXI","colors","colorTexRes","Math","max","ceil","sqrt","rgba","Float32Array","forEach","Texture","fromBuffer","dashedXLineTo","graphics","xStart","xEnd","y","dashSize","diff","sign","width","abs","stepSize","numSteps","moveTo","lineTo","getQueryStringValue","decoder","identity","queryString","parse","window","location","search","setQueryStringValue","encoder","values","newQsValue","stringify","strict","url","origin","pathname","history","pushState","path","toAbsPosition","absPosition","indexOf","split","chrom","pos","chrPositions","toFixed","number","decimals","forced","string","substring","scaleBand","domain","fixedBandwidth","bandwidth","range","rangeSize","paddingInner","paddingInnerZeroBased","totalWidth","sum","getBandwidth","update","totalPaddingInner","reduce","scale","v","idx","slice","newDomain","newRange","newFixedBandwidth","newPaddingInner","newPaddingInnerZeroBased","booleanQueryStringDecoder","header","columnImportance","tree","IntervalTree","text","lines","fields","chromOffset","startAbs","endAbs","insert","chrOffset","importance","uid","createLocalBedDataServer","tilesetInfo","whenIndex","loadFile","subscriptionTile","globalPubSub","subscribe","fileId","z","x","requestId","then","index","tileWidth","max_width","start","end","results","publish","subscriptionTilesetInfo","destroy","unsubscribe","useRecoilQueryString","atom","setValue","newValue","useRecoilQueryStringSyncher","EPS","DEFAULT_COLOR_MAP","DEFAULT_COLOR_MAP_DARK","DEFAULT_COLOR_MAP_LIGHT","GENE_SEARCH_URL","VARIANT_SEARCH_URL","DEFAULT_STRATIFICATION","categoryField","axisShowGroupSeparator","axisNoGroupColor","groups","categories","GROUPED_SAMPLE_OPTIONS","SAMPLE_TO_GROUP","sampleToGroup","SAMPLES","flatMap","SAMPLE_IDX","idxs","sample","VARIANT_TRACK_ABBR_TO_SERVER","rg","hg","VARIANT_TRACK_SERVER_TO_ABBR","Object","entries","abbr","DEFAULT_VARIANT_TRACK_SERVER_ABBR","DEFAULT_VARIANT_TRACK_DEF","axisPositionHorizontal","markColor","markColorFocus","markSize","markOpacity","markOpacityFocus","valueColumn","labelPosition","labelColor","labelOpacity","showMousePosition","showGlobalMousePosition","mousePositionColor","toolTip","field","numDecimals","other","LOCAL_BED_TILESET_INFO_HG19","zoom_step","max_length","assembly","chrom_names","chrom_sizes","tile_size","max_zoom","min_pos","max_pos","version","coordSystem","DEFAULT_VIEW_CONFIG_ENHANCER","editable","trackSourceServers","views","genomePositionSearchBox","autocompleteServer","autocompleteId","chromInfoServer","chromInfoId","chromInfoPath","tracks","contents","stroke","fontIsLeftAligned","tilesetUid","server","fromViewUid","projectionFillColor","projectionStrokeColor","projectionFillOpacity","projectionStrokeOpacity","strokeWidth","plusStrandColor","minusStrandColor","geneAnnotationHeight","geneLabelPosition","geneStrandSpacing","focusRegion","strokeColor","strokeOpacity","arcStyle","startField","endField","set","binSize","axisAlign","offsetField","importanceField","importanceDomain","stratification","legendAlign","markColorHighlight","markColorDehighlight","markMinWidth","markHeight","rowHeight","indicatorStyle","geneField","overlays","extent","minWidth","fill","fillOpacity","outline","outlineOpacity","outlineWidth","outlinePos","metaTracks","overlaysTrack","annotationTracks","layout","w","h","initialXDomain","initialYDomain","DEFAULT_DNA_ACCESSIBILITY_ROW_SELECTION","DEFAULT_DNA_ACCESSIBILITY_ROW_CATEGORIES","row","category","axisLabelColor","axisLabelBackground","DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY","zoomFixed","labelShowResolution","labelShowAssembly","markArea","markResolution","valueScaling","colorRange","rowPadding","rowNormalization","rowSelections","rowIdToCategory","fn","args","rowCategories","showRowLabels","rowLabelSize","getDefault","initialValue","qVal","chrPosUrlEncoder","chrPos","replace","chrPosUrlDecoder","showWelcomeDecoder","excluded","s","_s","add","Set","has","customBooleanQueryStringDecoder","variantTracksEncoder","Array","isArray","serverAbbr","pValCol","columnPvalue","pProbCol","columnPosteriorProbability","join","sampleFilterState","default","sampleSelectionState","selector","get","sampleWithName","selectedSamplesState","memoize","sampleGroupWithGroup","sampleGroupSelectionSizesState","sizes","variantTracksState","deepClone","showVariantsSettingsState","showWelcomeState","dnaAccessLabelStyleState","dnaAccessRowNormState","dnaAccessLabelShowInfoState","focusGeneState","focusGeneOptionState","focusVariantState","focusVariantOptionState","variantYScaleState","enhancerRegionsHideUnfocusedState","enhancerRegionsColorEncodingState","enhancerRegionsShowInfoState","enhancerGenesShowInfoState","enhancerGenesPaddingState","enhancerGenesCellEncodingState","enhancerGenesSvgState","higlassEnhancerRegionsState","higlassDnaAccessState","xDomainStartWithAssembly","totalLength","absToChr","xDomainEndWithAssembly","xDomainStartAbsWithAssembly","xDomainStart","xDomainEndAbsWithAssembly","xDomainEnd","focusGeneStartWithAssembly","focusGeneOption","chr","txStart","focusGeneEndWithAssembly","txEnd","focusVariantPositionWithAssembly","focusVariantOption","focusVariantRelPositionState","focusVariantStrPositionState","useFocusGene","useFocusVariant","useDnaAccessShowInfos","useXDomainStartWithAssembly","useXDomainEndWithAssembly","useEnhancerRegionsShowInfos","useEnhancerGenesShowInfos","note","palette","grey","title","buttonNormal","buttonActive","boxShadow","trackList","useStylesTrackConfig","grow","flex","separator","marginRight","propInput","useStylesTooltipVisible","arrow","tooltip","useStylesTooltipHidden","display","TrackConfig","config","propertyChangeHandler","property","isRemote","Boolean","isLocal","whatever","classesTooltipVisible","classesTooltipHidden","Tooltip","placement","TextField","size","min","step","VariantsSettings","closeHandler","setFocusVariant","variantTracks","setVariantTracks","tmpVariantTracks","setTmpVariantTracks","changed","setChanged","variantTrackServers","useRef","currVariantTracks","current","changeTmpVariantTracks","newTrackConfig","currTmpVariantTracks","newTmpVariantTracks","saveHandler","newVariantTracks","servers","trackConfig","push","some","align","href","rel","variantTrackConfig","justifyContent","spacing","showIntro","startExploring","introTitle","textTransform","introHeadline","introSubHeadline","introStartExploring","figure","Welcome","openIntroHandler","showWelcome","src","imgEnhancerView1","alt","imgEnhancerView2","imgEnhancerView3","imgEnhancerView4","imgEnhancerView5","IconButton","imgGeneView1","imgGeneView2","ModalContext","paper","borderRadius","shadows","maxWidth","maxHeight","overflow","ModalProvider","Component","setComponent","customCloseHandler","setCustomCloseHandler","customProps","setCustomProps","showModal","newComponent","newCustomCloseHandler","newCustomProps","Modal","aria-labelledby","aria-describedby","onClose","closeAfterTransition","BackdropComponent","BackdropProps","timeout","Fade","in","h1","flexShrink","drawerGrid","drawerPaper","settings","flexGrow","globalSettingsTitle","settingsContent","toolbar","mixins","titleBar","titleBarText","titleBarContainer","titleBarTitle","titleBarIcon","titleBarIconActive","globalSettingsFirstBox","extractCoreFromHiGlassSvg","svg","fifthLn","nthIndexOf","lastLn","lastIndexOf","core","AppSidebar","useShowModal","setXDomainStart","setXDomainEnd","setShowWelcome","showVariantsSettings","setShowVariantsSettings","higlassEnhancerRegions","higlassDnaAccess","enhancerGenesSvg","userChangedDomain","setUserChangedDomain","numericalXDomainStart","isString","chrToAbs","numericalXDomainEnd","xDomainStartChangeHandler","xDomainEndChangeHandler","curr","closeWelcome","openWelcome","openWelcomeIntro","closeVariantsSettings","openVariantsSettings","mergeSvgs","enhancerSvg","dnaAccessSvg","enhancerGeneSvg","enhancerSvgCore","enhancerWidth","enhancerHeight","dnaAccessSvgCore","dnaAccessWidth","dnaAccessHeight","firstSvgClosingBracket","lastSvgOpeningBracket","extractCoreFromStringifiedSvg","enhancerGeneSvgCore","enhancerGeneHeight","actualEnhancerHeight","track","actualDnaAccessHeight","mergedSvg","Drawer","anchor","ButtonBase","Divider","Box","m","xDomain","getViewConfig","Number","isNaN","zoomTo","CheckboxList","exportAsSvg","XMLSerializer","serializeToString","filename","stringOrBlob","blob","Blob","navigator","msSaveOrOpenBlob","msSaveBlob","elem","document","createElement","URL","createObjectURL","download","body","appendChild","click","removeChild","revokeObjectURL","console","warn","inputRoot","borderTopLeftRadius","borderTopRightRadius","borderBottomWidth","focused","input","textFieldRoot","fetchJsonFromUrl","query","fetch","response","json","result","GeneIcon","SvgIcon","viewBox","d","GeneOption","geneName","VariantOption","SearchField","setOpen","setOptions","inputValue","searchQuery","setSearchQuery","debouncedSearchQuery","loading","autocompleteClasses","customSearch","searchUrl","active","whenResults","Promise","all","flat","multiple","autocompleteOptions","Autocomplete","larger","onInputChange","newInputValue","onOpen","getOptionSelected","_value","getOptionLabel","renderInput","params","InputProps","endAdornment","renderOption","renderTags","getTagProps","Chip","usePrevious","appBar","common","black","white","toolbarExtra","paddingLeft","locationSearch","match","score","AppTopbar","focusGene","setFocusGene","focusVariant","setFocusGeneOption","setFocusVariantOption","prevFocusGeneOption","prevFocusVariantOption","focusGeneVariantOptions","_focusGeneVariant","clearFocusGene","clearFocusVariant","AppBar","Toolbar","newValues","newFocusElements","gene","gray","pink","EnhancerRegionsInfo","showInfo","iconRadioLegend","variantYScale","setVariantYScale","hideUnfocused","setHideUnfocused","colorEncoding","setColorEncoding","hideUnfocusedChangeHandler","changeVariantYScale","changeColorEncoding","Switch","FormLabel","RadioGroup","aria-label","iconRadio","iconRadioActive","bar","iconActive","popeover","paddingTop","info","borderBottom","TitleBar","Info","Help","Settings","useShowInfo","popoverDirection","setShowInfo","helpAnchorEl","setHelpAnchorEl","settingsAnchorEl","setSettingsAnchorEl","infoToggleHandler","show","helpOpenHandler","currentTarget","helpCloseHandler","settingsOpenHandler","settingsCloseHandler","helpId","settingsId","anchorOriginVertical","transformOriginVertical","helpOpen","settingsOpen","iconInfoClass","iconHelpClass","iconSettingsClass","wrap","Popover","anchorEl","anchorOrigin","vertical","horizontal","transformOrigin","getFocusGeneRegion","viewConfig","getFocusVariantRegion","updateViewConfigVariantTracks","variantTrackConfigs","variantTrack","data","updateViewConfigFocusVariant","trackIdxs","trackIdx","childTrack","setFocusRegion","updateViewConfigVariantYScale","yScale","updateViewConfigXDomain","newXDomainStart","newXDomainEnd","force","_force","isFunction","focusGeneRegion","focusVariantRegion","fullWidthHeight","higlassContainer","minHeight","panZoomTip","textAlign","opacity","animation","userSelect","panZoomTipNormal","panZoomTipNormalHover","panZoomTipActive","panZoomTipActiveHover","EnhancerRegion","useSetRecoilState","setHiglass","focusVariantPosition","xDomainStartAbs","xDomainEndAbs","focusGeneStart","focusGeneEnd","sampleGroupSelectionSizes","selectedSamples","higlassMouseOver","setHiglassMouseOver","higlassFocus","setHiglassFocus","higlassContainerRef","higlassEnhancerClickSelection","higlassMouseDown","higlassNumMouseOver","higlassNumFocus","higlassNumFocusMouseOut","shouldSkipUpdatingXDomain","numSamples","pipe","focusStyle","updateViewConfigFocusStyle","coloring","opacityEncoding","updateViewConfigFilter","matrixTrack","updateViewConfigMatrixHeight","viewConfigHeight","higlassBlockClasses","higlassClickHandler","payload","log","higlassLocationChangeHandlerDb","debounce","absPos","windowMouseDownClearHandler","e","isParentOf","addEventListener","higlassMouseDownHandler","higlassInitHandler","higlassInstance","api","on","getComponent","element","EnhancerRegionsHelp","EnhancerRegionsSettings","onMouseEnter","onMouseLeave","onMouseDown","onFocus","onBlur","tabIndex","sizeMode","globalMousePosition","verticalAlign","placeholder","fontStyle","small","medium","large","cellEncoding","justify","AntSwitch","withStyles","switchBase","primary","main","borderColor","thumb","border","switch","EnhancerGenesSettings","setCellEncoding","setPadding","changeCellEncoding","TooltipContext","pointerEvents","TooltipProvider","localState","setLocalState","showTooltip","plot","plotSvg","useTooltipStyles","uuid","fetchTile","tileId","samples","j","dodge","radius","radius2","circles","sort","head","tail","intersects","next","Infinity","EnhancerGenesPlot","useShowTooltip","sampleSelection","geneCellEncoding","relPosition","strPosition","genePadding","plotEl","setPlotEl","tile","setTile","isLoadingTile","setIsLoadingTile","setTilesetInfo","setWidth","prevWidth","prevGeneCellEncoding","getTileWidth","tileXPos","floor","_tile","entry","filterByPosition","plotElRef","node","isInit","maxScore","minAbsDistance","maxAbsDistance","genes","categoryAggregation","numEnhancers","distComparator","absDistance","genesUpstreamByDist","TinyQueue","genesDownstreamByDist","relGenePos","distance","isDownstream","samplesByCategory","sampleCategory","genesDownstreamByDistArr","pop","genesUpstreamByDistArr","prevGene","relDistance","useLayoutEffect","measure","requestAnimationFrame","currWidth","getBoundingClientRect","removeEventListener","tooltipClasses","select","paddingBottom","circleRadius","circlePadding","geneLabelPadding","beeswarmPadding","distanceBarWidth","distPaddingRange","attr","maxCatgorySize","cat","categorySizeScale","scaleLog","clamp","percentScale","scaleLinear","circleYScalePre","circleYScalePost","circleYScale","geneContainerWidth","maxGenes","genesUpstream","reverse","genesDownstream","minMax","minRelDistance","maxRelDistance","paddingScale","genesUpstreamPadding","round","genesUpstreamScale","genesDownstreamPadding","genesDownstreamScale","genesUpstreamLeftPad","minVisibleAbsDist","minDist","maxVisibleAbsDist","maxDist","distanceHeightScale","plotBeeswarm","selection","isRightAligned","selectAll","getArrayNumCols","maxSize","plotArray","numCols","instanceCache","tooltipTitleGetter","cellSize","indexToX","indexToY","bBox","arrayTooltipTitleGetter","geneArrayInstances","upstream","downstream","geneArrayInstanceMouseEnterHandler","dHovering","geneArrayInstanceMouseLeaveHandler","plotBox","valueScale","valueGetter","cellWidth","fillColor","textColor","showText","showZero","showTooltipOnMouseEnter","bg","boxTooltipTitleGetter","enhancerG","enhancerGCellG","genesUpstreamG","geneLabelX","geneLabelY","genesUpstreamGCellG","remove","genesDownstreamG","genesDownstreamGCellG","distRange","distStep","tickValues","call","axisRight","tickSize","tickFormat","this","parentNode","nextSibling","g","plotEnhancerGeneConnections","EnhancerGenes","EnhancerGenesInfo","EnhancerGenesHelp","DnaAccessibilityInfo","dnaAccessibilityRegionSize","DnaAccessibilityHelp","DnaAccessibilitySettings","dnaAccessLabelStyle","setDnaAccessLabelStyle","dnaAccessRowNorm","setDnaAccessRowNorm","changeDnaAccessLabelStyle","getDnaAccessXDomain","enhancerViewRange","enhancerViewCenter","midPos","DnaAccessibility","setHiglassDnaAccess","labelStyle","rowNorm","xDomainStartAbsDb","xDomainEndAbsDb","labels","updateViewConfigDnaAccessRowNorm","updateViewConfigDnaAccessXDomain","rowId","pixelPreciseMarginPadding","containerPaddingX","containerPaddingY","viewMarginTop","viewMarginBottom","viewMarginLeft","viewMarginRight","viewPaddingTop","viewPaddingBottom","viewPaddingLeft","viewPaddingRight","enhancerWrapper","enhancer","overflowY","enhancerRegions","enhancerGenes","dnaAccessibility","AppMain","useXDomainStartWithAssemblySyncher","useXDomainEndWithAssemblySyncher","focusGeneChangeHandler","focusVariantChangeHandler","r","CssBaseline","withEither","ifEitherFn","EitherComponent","createMuiTheme","secondary","App","setChromInfo","ChromosomeInfo","_chromInfo","catch","Main","AppError","ThemeProvider","hostname","createAnnotationOverlayMetaTrack","HGC","pubSub","services","AnnotationOverlayMetaTrack","definition","getTrackObject","animate","onNewTilesLoaded","annotationTrackIds","annotationDrawnHandlerBound","annotationDrawnHandler","bind","tilesDrawnEndHandlerBound","tilesDrawnEndHandler","drawnAnnotations","Map","tracksDrawingTiles","pubSubs","xStartAbs","xEndAbs","updateOverlays","from","draw","clear","availableOptions","defaultOptions","FLOAT_BYTES","BYTES_PER_ELEMENT","VS","FS","COLORMAP_GRAYS","getMax","fetchedTiles","maxValue","tileData","maxNonZero","getNumRows","coarseShape","getRowMaxs","maxVector","maxValueByRow","scaleGraphics","xScale","drawnAtScale","tileK","posOffset","getNumPointsPerRow","numRows","positions","createRidgePlotTrack","libraries","format","d3Format","d3Scale","tileProxy","RidgePlotTrack","updateOptions","pLoading","Graphics","pMasked","addChild","loadIndicator","Text","labelSize","coarsifyTileValues","bins_per_dimension","zoomLevel","tilePos","binsPerTileIn","binsPerTile","resolutions","chosenResolution","tileHeight","tileX","tileY","xTilePos","yTilePos","minX","minY","reverseYAxis","selectRowsAggregationMode","selectRowsAggregationFn","maxNan","minNan","sumNan","meanNan","markAreaColor","utils","colorToHex","markColorRgbNorm","colorToRgba","markColorTex","markColorTexRes","markNumColors","oldMarkResolution","TILE_SIZE","oldRowHeight","oldRowPadding","oldRowNormalization","oldRowSelections","oldShowRowLabels","updateTiles","updateRowLabels","drawLabel","updateScales","rowLabelAlign","pAxis","removeChildAt","rowLabels","rowLabel","row_infos","rowIndex","removeRowLabels","indicator","Sprite","WHITE","tint","dimensions","yStart","xLabelOffset","getRowHeight","rowStepHeight","rowStepYCenter","newOptions","updateExistingGraphics","getTilePosAndDimensions","shape","binSizePx","binSizeBp","binSizeBpHalf","binXPos","valuesByRow","meanValue","dense","subarray","rowIdx","actualTrackHeight","getTrackHeight","globalMax","colorIndexScale","rowMaxs","rowValueScales","rowColorIndexScales","valueScaleByRow","colorIndexScaleByRow","rowScale","tiles","maxRows","positionsByRow","colorIndicesByRow","offsetSignsByRow","_xScale","size2d","size1d","unshift","numPointsPerRow","verticesPerLine","verticesPerPoint","indices","Uint32Array","k","p1a","p1b","p1c","p1d","p2a","p2b","p2c","p2d","indexOffset","visibleTrackHeight","tilesToData","colorIndices","offsetSigns","toLineIndices","uniforms","UniformGroup","uLineColor","uNaNColor","uAreaColorTex","uAreaColorTexRes","uWidth","uMiter","shader","Shader","geometry","Geometry","numVerticesPoint","addAttribute","TYPES","FLOAT","addIndex","mesh","Mesh","newGraphics","pMain","lineGraphics","updateLoadIndicator","hasFetchedTiles","renderLines","fetching","newPosition","newXScale","newYScale","refreshTiles","trackX","trackY","calculateZoomLevel","calculateTileWidth","invert","posInTileX","rowSelection","tileToLocalId","fetchedTile","colIndex","selectRowsAggregationMethod","rowI","rowInfo","getVisibleData","svgns","base","setAttribute","output","stride","createLine","line","posPerRow","posToPoints","arr","numColors","defs","createElementNS","linearGradient","stop","insertBefore","firstChild","l","y0","firstComma","firstX","firstY","lastComma","lastX","lastY","HorizontalLine1DPixiTrack","datatype","orientation","pointToPosition","pt","cX","widthHalf","pointToIndex","pointToOpacity","pointToHighlight","highlight","getItemDistance","getMaxDistance","maxDistItem","scaleScalableGraphics","getRegionId","createStratifiedBedTrack","MAX_CLICK_DELAY","configs","opacityLogScale","StratifiedBedTrack","pLegend","legendMin","legendMax","interactive","interactiveChildren","alpha","mousedownTime","performance","now","mousedown","mouseup","clickHandler","intervals","regionId","isLeftToRight","intervalTree","createIntervalTree","categoryToGroup","groupToColor","numGroups","numCategories","groupLabels","getCategory","categoryToY","yToCategory","groupSizes","valueFilter","filteredGroups","groupSize","groupLabelsPixiText","markColorHighlightRgbNorm","markColorDehighlightRgbNorm","filterSet","include","filterField","itemFilter","getImportance","opacityScale","opacityLinearScale","getRegion","getGene","minImportance","updateStratificationOption","heightScale","categoryHeightScale","valueScaleInverted","isHighlighting","__focus","__item","focusFilterFn","addFn","filteredItems","reducerVar","accumulator","itemToIndicatorCategory","i1","isItemInFocus","dataToPoint","itemToIndicatorReducer","points","getPoints","Uint16Array","opacities","highlights","uColor","uColorHighlight","uHighlighting","indicatorPointGraphics","yEnd","xTickOffset","xTickEnd","numAxisLabels","lineStyle","labelPixiText","beginFill","drawRect","endFill","legendMinText","legendMaxText","minValue","minTextWidth","getBounds","maxTextWidth","offset","rectHeight","drawRoundedRect","renderIndicatorCategoryAxis","renderIndicatorLegend","renderIndicatorPoints","updateIndicators","relX","relY","foundItem","xAbsLo","xAbsHi","queryInterval","interval","getElementAtPosition","colorHex","toString","bgHex","offsetX","offsetY","global","gAxis","createRect","f","o","strokeDasharray","x1","y1","x2","y2","createDashedLine","pixiText","t","_style","_fill","_align","_font","textContent","createText","colorHighlight","renderIndicatorCategoryAxisAsSvg","thumbnail","DOMParser","parseFromString","documentElement","flip1D","trackBorderWidth","trackBorderColor","optionsInfo","inlineOptions","circle","ellipse","createSnpTrack","d3Array","SnpTrack","colorEncodingRange","minVisibleValueInTiles","maxVisibleValueInTiles","makeValueScale","calculateMedianVisibleValue","xStartPos","xEndPos","rectY","doubleRadius","drawnPoly","anchorRadius","rectGraphics","drawCircle","finalDotYPos","rows","startY","endY","initialize","circleDraws","circleFocusDraws","td","geneInfo","yMiddle","drawnRects","circleDraw","drawPoly","buttonMode","hoveringSnp","relTilePos","dist","itemY","MAX_RADIUS","otherStr","substr","visibleAndFetchedTiles","plusStrandRows","renderRows","focusedCircles","c","axis","axisPositionVertical","gDrawnAxis","exportAxisLeftSVG","exportAxisRightSVG","BedLikeTrack","getIs2d","get1dStart","get2dStart","get1dEnd","get2dEnd","getHistMax","histMax","histogramMax","segmentToPosition","segment","segmentToColorIdx","colorIdx","segmentToFocused","createStackedBarTrack","toRgbNorm","StackedBarTrack","is2d","getStart","getEnd","updateTileFocusMap","numBins","histogram1d","histogram2d","histogram2dNumPred","Uint8Array","categoryBinHash","maxBinId","binStart","binEnd","bin","histIdx","binHash","updateTileHistogram","focusMap","numFilteredGroups","colorMap","colorMapRgbNorm","colorMapTex","colorMapTexRes","colorMapFocus","colorMapFocusRgbNorm","colorMapFocusTex","colorMapFocusTexRes","markColorFocusRgbNorm","markSizeFocus","getOffset","chromOffsets","updateFocusMap","updateHistograms","chroms","chromSizes","offsets","cumSum","brgs","computeChromOffets","oldNumBins","segments","cumHeight","histToSegments","colorIdxs","uColorMapTex","uColorMapTexRes","uColorMapFocus","uColorMapFocusTexRes","State","DRAW_MODES","TRIANGLES","drawAxis","renderStackedBars","renderTrack","relPos","rowCumSum","rowNumPred","totalPred","numPred","relYPos","findIndex","createTssTrack","TssTrack","createPubSub","xStartScreen","xEndScreen","LocalCsvDataFetcher","createRandomId","random","LocalBedDataFetcherClass","dataConfig","callback","tilesetInfoLoading","tilesetInfoData","resolve","reject","timeoutId","loadHandler","tileIds","register","dataFetcher","createLocalBedDataFetcher","pluginType","isMetaTrack","ReactDOM","render","getElementById","serviceWorker","ready","registration","unregister","error","message"],"mappings":"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CACV,wBACA,qBACA,2DACA,0DACA,4DACA,gBACA,sBACA,0DACA,sBACA,+BACA,2DACA,gCACA,qBACA,+EACA,4DACA,wBACA,uCACA,iFACA,0DACA,qBACA,OACA,iCACA,iFACA,gBACA,4DACA,4DACA,2DACA,2DACA,sBACA,qBACA,iFACA,0DACA,oFACA,uBACA,iFACA,sBACA,kCACA,wBAGJ,CACEpN,MAAO,UACPoN,WAAY,CACV,oBACA,gBACA,uCACA,gBACA,iBACA,kBACA,eACA,+BACA,0CAGJ,CACEpN,MAAO,UACPoN,WAAY,CACV,mCACA,kBACA,8BACA,oCACA,4CACA,uBACA,wCACA,kBAGJ,CACEpN,MAAO,6BACPoN,WAAY,CACV,gBACA,eACA,6CACA,0BACA,kCACA,gDACA,iCACA,kBAGJ,CACEpN,MAAO,cACPoN,WAAY,CACV,8BACA,+BACA,2BACA,mBACA,+BAGJ,CACEpN,MAAO,aACPoN,WAAY,CACV,gCACA,qCACA,gBACA,eACA,6BACA,KACA,uBACA,gBACA,mBACA,kCACA,kBACA,OACA,4DACA,cACA,kBACA,uBACA,OACA,aACA,iCACA,gCACA,eACA,uBACA,qCACA,0BACA,qDACA,gBACA,0BACA,wBACA,aACA,0BACA,qDACA,2BACA,uCACA,QACA,4CACA,gBACA,uBACA,mCACA,kCACA,gDACA,iBACA,kCAGJ,CACEpN,MAAO,QACPoN,WAAY,CACV,wBACA,kBACA,oBACA,yBACA,2BACA,yBACA,gBACA,8BACA,gCACA,yBACA,mBACA,eACA,cACA,yBACA,6BACA,oBACA,wDACA,6CACA,QACA,2DACA,uBACA,iEACA,sEAMKC,GAAyBN,GAAuBI,OAAOpL,KAClE,SAACjE,GAAD,MAAY,CACVF,KAAME,EAAMkC,MACZkC,QAASpE,EAAMsP,eAINE,GAAkBD,GAAuBhE,QACpD,SAACkE,EAAezP,GAId,OAHAA,EAAMoE,QAAQoD,SAAQ,SAACnD,GACrBoL,EAAcpL,GAAUrE,EAAMF,QAEzB2P,IAET,IAGWC,GAAUH,GAAuBI,SAAQ,SAAC3P,GAAD,OAAWA,EAAMoE,WAE1DwL,GAAaF,GAAQnE,QAAO,SAACsE,EAAMC,EAAQpE,GAEtD,OADAmE,EAAKC,GAAUpE,EACRmE,IACN,IAOUE,GAA+B,CAC1CC,GAAI,2BACJC,GAAI,6BAGOC,GAA+BC,OAAOC,QACjDL,IACAxE,QAAO,SAACtH,EAAD,GAA0B,IAAD,mBAAlBoM,EAAkB,KAEhC,OADApM,EADgC,MAClBoM,EACPpM,IACN,IAEUqM,GACXJ,GAf0C,4BAgC/BK,GAA4B,CACvChK,KAAM,mBACN9G,OAAQ,GACR2E,QAAS,CACPoM,uBAAwB,QACxBC,UAAW,QACXC,eAAgB,UAChBC,SAAU,EACVC,YAAa,IACbC,iBAAkB,IAClBC,YAAa,EACbhR,KAAM,WACNiR,cAAe,UACfC,WAAY,QACZC,aAAc,IACdC,mBAAmB,EACnBC,yBAAyB,EACzBC,mBAAoB,QACpBC,QAAS,CACPvR,KAAM,CACJwR,MAAO,GAEThU,MAAO,CACLgU,MAAO,EACPC,YAAa,GAEfC,MAAO,CACL,CACEtP,MAAO,cACPoP,MAAO,EACPC,YAAa,OAOVE,GAA8B,CACzCC,UAAW,EACXC,WAAY,WACZC,SAAU,OACVC,YACE,i2CACFC,YACE,8wBACFC,UAAW,KACXC,SAAU,GACVlE,UAAW,WACXmE,QAAS,CAAC,GACVC,QAAS,CAAC,YACVhG,OACE,4FACFiG,QAAS,EACTC,YAAa,IAGFC,GAA+B,CAC1CC,UAAU,EACVC,mBAAoB,CAAC,uBACrBC,MAAO,CACL,CACEzF,IAAK,UACL0F,wBAAyB,CACvBC,mBAAoB,sBACpBC,eAAgB,yBAChBC,gBAAiB,sBACjBC,YAAa,OACbvT,SAAS,GAEXwT,cAAe,oDACfC,OAAQ,CACNtU,IAAK,CACH,CACE8H,KAAM,WACNwG,IAAK,kBACLtN,OAAQ,GACRuT,SAAU,CACR,CACEzM,KAAM,+BACNnC,QAAS,CAEP5H,MAAO,UACPyW,OAAQ,QACR9T,SAAU,GACV+T,mBAAmB,EACnBhC,mBAAmB,EACnBE,mBAAoB,WAEtB+B,WAAY,yBACZ1T,OAAQ,GACR2T,OAAQ,2BACRrG,IAAK,UAEP,CACEA,IAAK,0BACLxG,KAAM,iCACN8M,YAAa,UACb5T,OAAQ,GACR2E,QAAS,CACPkP,oBAAqB,UACrBC,sBAAuB,UACvBC,sBAAuB,GACvBC,wBAAyB,GACzBC,YAAa,MAKrB,CACEnN,KAAM,WACNwG,IAAK,qBACLtN,OAAQ,GACRuT,SAAU,CACR,CACEzM,KAAM,8BACNwG,IAAK,QACLtN,OAAQ,GACR2T,OAAQ,2BACRD,WAAY,yBACZ/O,QAAS,CACPjF,SAAU,EACVwU,gBAAiB,QACjBC,iBAAkB,QAClBC,qBAAsB,GACtBC,kBAAmB,UACnBC,kBAAmB,GACnB7C,mBAAmB,EACnBC,yBAAyB,EACzBC,mBAAoB,UAGxB,CACE7K,KAAM,MACNwG,IAAK,MACLtN,OAAQ,GAGR2T,OAAQ,2BACRD,WAAY,yBACZ/O,QAAS,CACPjF,SAAU,EACVwU,gBAAiB,QACjBC,iBAAkB,QAClBC,qBAAsB,GACtBC,kBAAmB,UACnBC,kBAAmB,IAGvB,CACEhH,IAAK,yBACLxG,KAAM,iCACN8M,YAAa,UACb5T,OAAQ,GACR2E,QAAS,CACPkP,oBAAqB,UACrBC,sBAAuB,UACvBC,sBAAuB,GACvBC,wBAAyB,GACzBC,YAAa,MAKrB,CACEnN,KAAM,WACNwG,IAAK,WACLtN,OAAQ,GACRuT,SAAU,CACR,CACEzM,KAAM,mBACNwG,IAAK,WAGLqG,OAAQ,2BACRD,WAAY,yBACZ1T,OAAQ,GACR2E,QAAS,CACPoM,uBAAwB,QACxBC,UAAW,QACXC,eAAgB,UAChBC,SAAU,EACVC,YAAa,IACbC,iBAAkB,IAElBC,YAAa,EACbkD,YAAa,CACX,WACA,YAEFlU,KAAM,eACNiR,cAAe,UACfC,WAAY,UACZE,mBAAmB,EACnBC,yBAAyB,EACzBC,mBAAoB,QACpBC,QAAS,CACPvR,KAAM,CACJwR,MAAO,GAEThU,MAAO,CACLgU,MAAO,EACPC,YAAa,GAEfC,MAAO,CACL,CACEtP,MAAO,cACPoP,MAAO,EACPC,YAAa,SAQ3B,CACEhL,KAAM,WACNwG,IAAK,oBACLtN,OAAQ,GACRuT,SAAU,CACR,CACEzM,KAAM,UACNwG,IAAK,OACLqG,OAAQ,2BACRD,WAAY,yBACZ1T,OAAQ,GACR2E,QAAS,CACP2M,cAAe,SACfkD,YAAa,UACbP,YAAa,EACbQ,cAAe,IACfC,SAAU,SACVC,WAAY,EACZC,SAAU,EACVjU,OAAQ,CACNkU,IAAK5E,GACL4B,MAAO,MAIb,CACE/K,KAAM,cAGN6M,OAAQ,2BAIRD,WAAY,yBACZ1T,OAAQ,GACRsN,IAAK,eACL3I,QAAS,CACPmQ,QAAS,EACTC,UAAW,QACXhE,uBAAwB,QACxBO,cAAe,UACfN,UAAW,QACXC,eAAgB,UAChBC,SAAU,EACVC,YAAa,IACbI,WAAY,QACZyD,YAAa,EACbL,WAAY,EACZC,SAAU,EACVK,gBAAiB,EACjBC,iBAAkB,CAAC,EAAG,GACtBX,YAAa,CACX,WACA,YAEFlU,KAAM,mBACN8U,eAAgB3F,GAChBiC,mBAAmB,EACnBC,yBAAyB,EACzBC,mBAAoB,YAK5B,CACE7K,KAAM,iBAGN6M,OAAQ,2BAIRD,WAAY,yBACZ1T,OAAQ,IACRsN,IAAK,uBACL3I,QAAS,CACPoQ,UAAW,QACXK,YAAa,OACb9D,cAAe,SACfN,UAAW,QACXqE,mBAAoB,UACpBC,qBAAsB,UACtBpE,SAAU,EACVqE,aAAc,EACdC,WAAY,EACZC,UAAW,EACXtE,YAAa,IACbuD,SAAU,YACVgB,eAAgB,gBAChBnE,WAAY,QACZoE,UAAW,EACXV,gBAAiB,EACjBC,iBAAkB,CAAC,EAAG,GAKtB7U,KAAM,cACN0Q,uBAAwB,QACxBoE,eAAgB3F,GAChBiC,mBAAmB,EACnBC,yBAAyB,EACzBC,mBAAoB,YAK5BiE,SAAU,CACR,CACEtI,IAAK,eACLtL,SAAU,CACR,kBACA,qBACA,WACA,oBACA,wBAEF2C,QAAS,CACPkR,OAAQ,CAAC,CAAC,WAAuB,aACjCC,SAAU,EACVC,KAAM,UACNC,YAAa,IACb/B,YAAa,EACbgC,QAAS,UACTC,eAAgB,IAChBC,aAAc,EACdC,WAAY,CAAC,OAAQ,WAGzB,CACE9I,IAAK,aACLtL,SAAU,CAAC,sBACX2C,QAAS,CACPkR,OAAQ,GACRC,SAAU,EACVC,KAAM,UACNC,YAAa,IACbxC,OAAQ,UACRS,YAAa,EACbkC,aAAc,IAGlB,CACE7I,IAAK,eACLtL,SAAU,CACR,SACA,qBACA,WACA,oBACA,wBAEF2C,QAAS,CACPkR,OAAQ,GACRC,SAAU,EACVC,KAAM,QACNC,YAAa,IACb/B,YAAa,EACbgC,QAAS,QACTC,eAAgB,GAChBC,aAAc,EACdC,WAAY,CAAC,WAInBC,WAAY,CACV,CACE/I,IAAK,oBACLxG,KAAM,qBACNwP,cAAe,eACf3R,QAAS,CACP4R,iBAAkB,CAAC,UAIzBC,OAAQ,CACNC,EAAG,GACHC,EAAG,GACH1I,EAAG,EACH1F,EAAG,GAELqO,eAAgB,CA9agB,WACF,YA8a9BC,eAAgB,CA/agB,WACF,eAmbvBC,GAA0C,CACrD,IACA,GACA,GACA,GACA,GACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,EACA,GACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,IACA,IACA,GACA,GACA,GACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,IACA,IACA,GACA,IACA,GACA,IACA,GACA,IACA,GACA,EACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,IACA,GACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,EACA,IACA,GACA,GACA,GACA,GACA,EACA,IACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,EACA,GACA,IACA,GACA,GACA,IACA,GACA,GACA,GACA,IACA,GACA,GACA,IACA,EACA,IACA,IACA,GACA,EACA,GACA,GACA,IACA,GACA,IACA,GACA,EACA,IACA,GACA,IACA,GACA,EACA,IACA,GACA,IACA,GACA,EACA,GACA,GACA,GACA,GACA,IAGWC,GAA2CtH,GAAuBI,OAAO9D,QACpF,SAACiL,EAAKxW,EAAO4N,GACX,IAAM6I,EAAW,CACfvU,MAAOlC,EAAMkC,MACb1F,M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","file":"static/js/main.b3a999af.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABjYAAAD/CAMAAABlyR/QAAAAkFBMVEVHcEzv7+/f39+/v7+vr6+fn5+QkJB/f39vb29gYGBQUFBAQEAgICAAAAAwMDDPz88QEBCgoKBfX19PT0+AgICwsLCPj49wcHBxcXG+vr4BAQHe3t6urq7Ozs7u7u7///+Ojo6enp4hISFBQUERERFeXl5RUVECAgIxMTGxsbH9/f1hYWHNzc3d3d3AwMChoaHQftsbAAAAAXRSTlMAQObYZgAAH+FJREFUeAHs3eli4rizBXCpZO0rXGbm/d/0Yqf/reAYYjpukOzz+zT74g46lEoqMwAAuI/THAOAAwMgIiEGKZXWxlrrvPdhFL8RrpL33lmrtZZyEAKRAgCwO5yyGDNiDIg0hsPGQvDeGi0HkTkDAIAOEQkptbHOjzHxSmOEaDUIYgAA0DbKwxgVP06KEub+MECcViIzAABoCCch1ZgV5alcmBoURmslpRyEEDRi36ArcTVIqbW21vk1ERW81UPm7H0AAIDy+rAoIfkxI5QcRCb6C/8tQkilrXv4n1O8UeKl4QEAADwPytgUvk8K7+yUE0TspUgMUlufyvvCAwAASEht3Te1RUhTVIhMrAVZjPmxmHDJ6b+QHQAAQFlq68PjusIaJQci1qgslPFpIeU2zQ4AAGxGPaouSnJWy4E460UelPNf/oeSPWX25wAAkBdSP+hdlDCmhSDOOpWFdmn+P+WUYH8AAAB5Ue62LaxR+znFKqTxs+jwClUHAMCP86JMcUGc7VCW5zRrdpyI3QKgqyx+yUTE2WEB0NS/iIuCs0ru/44cF/q235GMYBPAuAMfwoOrSN4arTAHDVBgxBKckQOxI8nqJjyLO3F2QECDrJeSnh1js+P8AATGnQKjBGtkJnZQWboSK3+o7SqoH4ufKN7p4QiHugGBEdzYvmAglEdyHA0XyqZVb3mZpBBCidXBJhEAAqMki7y4xYdzQHIcBUmTHow7GMTd9jf/fg5a8WbIbDcAgRGcudfvBvF5LXED2yMgZcvC9ygtBT3/MZvG2CwmkDc9XScFnJKyi4FhERjfI+U/PTFi92VniUE7xIqc59KWbb9H1cltLi1lR9tFPQDPyqSyFBhaElsJSNbPf7p7tIqHGP+PNQMuMfpvcuXiZ5+LrRsRWSjn40zAKII2AQ3aha0CA0iF70oOijEW1gwoMUZ60P82ZdZ+4OwvyQsfRo/hmY1BF8OXrXsYIM6h9sfvLVPNPGDIj2Jc2HIzTUa85DrpPDs8LpTC+3Gx1MUofpvAAOnjL2EhOFKM8R/WCPg33ts0vKkzvBYv3QSYf6WrkdUGwKZU2PZYLdDvkiP8R+zWOcb4L2sEjBG/EO50qct2sZK/fxRBLBiABu84cu4KSozXlxyWvny9tawhaG3kL3dxan+6mHc2F0ieEwagwbsSwxeUGC9G58XgEOOnn8G71V+NcLfQKC2s0jScA4qOd0NilGQxyuAVSIevwcEbOkoFel77CV/3pkRDH2MXYpV0ZvACSIy6KcXgZeTX4Aj1xGdb0NrgKtQeNG9u7LKPVdg41ABoWE4MYu+C4AgX9sHFGCVrAfD4KcP5792ponMHA9CKHRjARqdrXWgyMRAcJzYyMUbDWoHWRpqHhm/67SlZebzpBTYdEmJbTgwER6Lxd2Ir40VgjHB7GxodbP7QzatekBywwUTnBhMD/g2/Wxy5Ht6BN6p3L2toFM17mkZQk4MBPIXXRkaziQFk4iSceGxpvAhaG7y/0KjJ8fyxL4CFbalkmz4rhXscrt4wg/capqMK5Xegs95kE352tgpQZISm72PAEOKkkfEicI5xPj6s7+QwxFYBFBl1onPjQMdfDGsDWhuTctrD1GW8lng9FBmpm0YGkI8Tz+DtKN72NHaSHI+vcwCKjOC62ZYC+vSe9sKagNbGSAu2A8P5y2uJAbf4fOn0tBTwQdlUbvKewdvJ+mFyKrPu8Tp2ud5ZhIPi0qRue99AvsS5Ihm8HXe3lfsO2gKkAs7kAikbuu5kwLnZgfVA8hziJ2EHfQFxLvV4GDE43nSp2b5Uh50McHhPe8vmQ8ntrt4RFg9VciAy5uelgu2zyIAc8IaT1mXlyq4OK1C9zRHQ5TjIEdu0ozsZwHvIexDKxyvHdmJwtctBDPZ9RjO8Z18KAITRfE+rSagHq9guAUkb5s3TzABgk0RIZarcBTsQUTtrF2KwuwNTs1bGZuelAOsZyHA7fuo4SAe0x48QGQmtDKxnsCFK8UYgdiT1YFXCT9geI6N4g1YG1jPY1KnEmTIcbWh/iR+CIga7igy9dWQA1jMY4qiY8ZZlHs5xcmLHwmtZi3NV+4kMJdj+AL17PQMq8crx29dlFWKLuI//7b497gfWGSCJyDgKH0N+fj2DLYUvr8XS8SqxJTT+1XK/e1WhwzYacGkDIuMwRI2B59cz2G7MrWY3/r1X1lHYecFHMqDJ0dvtb0TGseTa5n5+PYNNhKU5U255dr0oB8ht6dHk6GfGVEJkHI+uufH8egYbFXyR2Awf80GwmVMcnfn+z1W1HxwgLn52YgqRgdx4vJ7BRsw8nOsfNuzWJS7Uf3tvcnjBoDl59lI+HLI94LIVE39+PYNN+BjjP8uH2NLxUqMiie54H6ds0wGv8sG55sb69Qy2Mn4CM/uC5iPSuY0jyY6j+eBA/zscdWAI+Hhln1/PYAvxasUf5yleFcEORfh2gwPNDCsRGcdUVyT7/HoGL4sNCgcd7ZLPLQzIBbptZhSH49FHx0O8+g+x8a5NKlo+Gl2QGleE4Hj/Zb6CI1OwfIns8ux6BhtI91tIfnZdg7PXw3lcvP0b/W94nBvr1zPYwP2TaedPf/gUJ95qLQeRiR0O6YDgeP/OFJoZLaORuJIjPTJ24vyH8El8KFT+FzvRIyWlHMTVUOogkfXrGWw034UvHDyo12NCnAveW6OlEHScQXnvDA6cmSoezYxGsiFPwaA+QsF7n0IIJb7Taf16BhsOF3FL4RzqduEDJXln1HCAAHlXcODM1DtesgScaAqIKR+mdCixTWX9egYbkbM6b3S5yXAZVynJjxUIIThggwb4a3em4CMk1JQRKYTYkbB+PYOtpC99JTX7tdBxpKTW1vkU4jeCdz+IDwQHyoy/vzMFnLIYS4nNUqKEq99dCPPRhJgM4gN9wh6iSvwiR0qPfvdLUpzI9esZbIXK7TrI3ZfXmujbk1SchBh/4L6JkOSNEhnBAavw26EhYfudKQTFMJUTLv3xflMIIU3BYH53pjMRcfYW/9UXvq5fz2AbMk7skBmjwZQ4Gr5OgLFsAc9CauN8eJweHMHxANxOQC9WITI2TArrfAh/UD1MATHlw5QOnLXFxquS169nsKWhxJkil27yX9gjJAZ1Pz/KcnggOIArV2L1s9t8wEkMUpu6F7BOCMlbaz4yokZEm2oVEfLz6xlseW+mSrR8k//C1hjrD+fLnfAYBIIDbrsZaIBv0NCWyli3PirKr5iQchBEvc6kCvT0egbbr4OjsM3rYHketF1Mj+T6Lzxk2HjkCA5Nocx4El+fFTUotKo50TGqqbF+PYPNCTMu8SUZ8ahzLth6NT1c2mF21OBgL4MyAyhPe1AplFVJ4aaKQhDtcH8k0Kr17I1A/OhAQhbKpcXs2EFwnNiTMGkKZcZzOP0Ki3VRMdYUmXa8q97LlDyQPx+Du1h5eDPQEYMDk6ZQZqwoLZS2PpRvs8Jbo8eo4IfpxXrOoJsXv/Off9dU53l2BKdyn88EwfEMYQLKjDVpMTYtUlibFexQ8hSiZwYd5YZnm/iaHcUp0fF03CDYeuiAF7d0NwM7Ucb68H1YKCmIH3mMHubZ9vbid7YdoVyYndBVudv3cXhi92Fr6tEVcBQX1oWCsFiD4pVm0A2eto95GoyfVR2n3F1wrL/Gga0pRWwEJKR+XFyUsb0th89hAb631AAp2d8gbm8Kx2AHvpfgwNYUOuDr46KmBUqLe1qadAfiir1Plrc7Vn3tV5GLH+7d/8PWVDp6B5x/bEbdT4uA2qK39Qxq4+Kd0VF6LToEDlUtX+jDEHQalHGp3C8urFFDRlq0up61D485Kx8/8SfCNY6+L/SVxfRHeRGSNSguEBt4zH9lkHYyubfgEGhn1FNTh8wLbVN4aVwAYgOPmW72q4IVvdz/O3ZvnCt/1FNTNS/K3U63UYgLxAYe88uKjvaTA4eq8k07wx3p1BQnqe7mRUhWS/QuXgSxgcdM0neWHDU4LvywtzOKEfxI/e4QFwWUF2+B2MBj5tKVvpKDfO2NH7AFHrQ4+IZUCW7sXrC9w3oG9oo1ajiHT8mRcaiqIXyw5TjtjFpgIC+wnrUOxOfkUNRLcDja+bEpXz7fzuC7Dwybyv39KNYuACSHP3HWNK533xvnyh9mcAhJbcOdy3roX7QMYDiX+D9W9NEbL5edTg45RAucZ2lcuFNg4HwUQBekqx9cQ+1Pqtpji4Mu/vZG32EqjFpgMADoxs2pXH/qozeedzptymux0x5GQAdjVwDIhHqyinoIDks7yYzwOTNof2eJa9MbO1I7AyDOpYuSg3S9/rerzFB8f00MBAbAM/RVd6c/uyg56LyHFocwZZ+ZUfekEBhYz+AAtyrpHHooOXLvLQ5h9nY9o5YYvsS54nccGFjPAI9Z+vu3ANHi2D4zJN9PFyPglBTWMzjiY74pOaxo/vrfBZnxbjQYFxb3pBAYWM/gMI+5lhzphBbHZsSl7OwlfbS0KVWSUdiTwnoGh3vMdC6t71XVFgf1dm6q2P6vgWdpUvlaYmjsSWE9g8M+Zi5D3GgOFFoctKfM4FnZVBa6GIIzwHoGx37MwsVfvGi7xREuncwOKV7w3hNj8aAU+ynAegbyinWvtsfDCS2On8617bsHnqX5mhjoe89hPQMgWYODWIuGulOFzHhd5zs4HK0FgO/OVQVLTbc4LtTorfuO74HTsJAYVj08BgYAkM/PdcexU8WFL71nBhfKfa0x0PgGgCcP5Lb57nHyLR3GFab3zMhf73wHhxrj/9k7DyZHUhiMGnBHUBtfOWz+//9y8zLVx95k09Lce5Wm4iTDK6RP8DwAaHLEQBj3sc4Y/FsoS+U40scAgOfvzFpnx/+EcS9KBjTSEOxfLJUjWanXAABxpKPmFsdZQXBqDObTUsvUt6tIAkD8zu4NEuJfxUEY1+0rZxjuZGT7rW9gP2OqUlGsSrM4Ln/CuM0bGjYHwV3pZFCWuhnsZ8Cf2a/EQRg3nGwGp3w3JVmRKEsB2qhwV/7Mb14cpVLVuqERBzPOCP1cHTJunK9173YGAbQRkvBn1iKOBmPj7ubRI4MNDRdOMbc/ZLxPH3b2ALRxFdGvDcShv1JVNzSmYKaVISuWRp2Mq4g9bQDa8Iv8b7SBOBb5yexvtQGfFvmDjVsKXTemf9Wlhlbd+4+LGNQGoI0+izZtII4Glaqrv+01hXFwBrvfuWnzu89iTxuANnwUaakN/53dDnFoeMPpeMPi1BjsKSNNbRO2H6OIem0A+1nFPktbbSgAcfhZfrL4mxSncgzmlLGUvFQzPmVBG2AxdiuiXxuIQ/8FhyFWExpmlJHjGNyWaw9tgK3YbRttII4YtF5weHzVsb48BOXt7ylt0v2uY7eCNsBm7LaZNhDH7LWGcf1rjfXlGJQnphQoo6w9tAEmY7dNtYE4Jv/2KlVhzCaKUy6MiwZllNgt2gCbsVvV2kAc+itVro8mklPhFJUoo6w9tAE2Y7fttEFg7RBrcVivVIX57qCh91VU368vDNlUGSV2izYI4FqO3RYY92sTP0gnb7xSVcVtB6e3/53XIdtNlVFit2iDcT/bsVu00Xx/VpfGHXL5uZ5x0Ag2mhlp3Dslaw9toA3LsVu0gThWlarDEw8aSelB47CuTOVJy91Y75OgDbRhOXaLNhDHEx6NraJTeQ4GKlM59l7z2kMbaEM/h0XQxob4IclPolf5aGw6PTI6tQxOf2Yqqho+/LwI2kAb5mO3aIM0bl2pOu/+g4Pug4brp1w1M7StPbSBNuzHbtEG4igc7q1Uhag5OhXGRV1lqordog20YY9jlu21Eb/z+0vEkU9O56OxdRtcZ3SqdDOUVqYKXRZ72gD2MzfJvexgizGOo4FHY8M/We1BI5xilZlSx5dJBG2A3X0KbRCqug9fVar28W4YnGPGM2O3aANsTvgp1QbiiF5npcqV6pTGW6d8r/+YUdaePW0AHJLo0wb4QWVv3I9/zkGHMesc7AtjUn7MKHxOYlAbAL0I2iBU9fzIXQzKSlPqjxmFiwjaAPOxW7Shswl9UlepKtWpg9bSVKoLZ4pjt2gD7E/41doAQlVV4HZxOlNTOfbe4NrTrw0AN4uo0kb3nR38PVQV1ElDj87CuCpN7Z3JtYc29MN+VsduNU6JwyXpaXH4MqURtfxUbj9lKaSqA24ydos2mBLXHP1DG/rxo5LeeIhlss/f6ey64U/lVregx95bXXtoA23Yj92iDXrj90jD1WPj2zhDCnmuUlOGY7doA21oj92iDf34pWzRG0sj9a4K4qVz+z/IqgVevehqMXaLNtCG/dgt2qA3XkkjhvtfG2/vjCppazd2izbQhv3YLdrQKY7Ju35OcnOW+XivNFavjcvU6mcKp1QPgdtfe2gDbSiP/qEN273xLI1Ix/ukURovTbHXAi98mUXQBtqwH7vVpI3hOzsoaNiir5U0avyyiTPczhjvk6ANe7Cf1dE/lVPioGmLrqRRE7+xcwc4ahtRHIdtA4WQecTZtBt1yYY2vf8dK7hA5Up4/F993wlGT5r5CekZzVhw92SDsLXb8Gxw6B+N/mfaD3HeW8kGgX6vko10rX80+p9pHocwxyrZIH/tVjaCf2y03Xh7tn2rh9eAM0Wu3coG+at/AdngXHdtvK1gbHX3LeBMaXcvIBswfq4EA//hUnf72yp2ddcSz7QhPz9X5WUDdnN9iGxQD7d1jPWQeKbt+HMu2SBy7TbEp0/DdsjGrR62eCZ3LwHJX/gZs2zIRqcv/JCNQN+NWTZkw92jA18VLyAbsiEb10shG6Frt8YsG7Lh7tFB5hd+xiwbstHpCz8Y8uxnY5YN2ejhx1xQ1m6NWTZkY8HdA2u3K9jthh5kQzas3SIb3w1ZNmTD3aMra7eGLBuyYe2WBazdGrJsyMaCuwfWbg1ZNmTD2i0LWLs1ZNmQDWu3LGDt1pBlQzYW3D2wdmvIsiEb1m5ZwE+NFbQ2rEU2ZMPdQza+XIy5B9mQjfdL8Wzes4L/7baS9DPBB/ImG8iGbIBssALZ6AJkA9mQDZANZEM2QDZANmQD2XiGqVlX68ECrgXca6tMeNGOhiwbsuHu4UXz5yJ5ZMOfi8CQYXoxZNmQDXcPL9oCh2bIsiEb7l5/DDGmsyHLhmz0cE29e3jRXg1ZNmSji78qE160qRmybMiGVVy8aAscDVk2ZMPdw4u2wJdmyLIhGz28t4qEF218MWTZkI0efr5UJrxoh2bIsiEb7h5etCd9f2TIsiEbvv3Di/Y6G7JsyIa7hxftSau4hiwbsmEVFy/a0ZBlQza2ffeQDT84ZEM2ZMMPDoZc48mQZUM23D28aOutAw5sKxtjvyc64ExWcZGN/uuAA1vR6m53W8UfdXdJO5NVXGSj/zrgwFac666NtxWMre6+BZzpw969twE6mlp+Nnith7a/Pdu4a/XwdZNninJtodmAY3w2GOdaWdvkmdIcQ7MBU0vPBvta2deAMwW4tsxswHhKzwanWtUx9Uz5d082CFwHlA2fHp9yz5R/92SDtHVA2fAlwLxPOlPA3QvNBhzm8GxwOF/q6dr5tzHgTFH+njOzAdOlRzaA6yU0G3Dskg3gGJoNmFqPbADXFpoNOHXJBnAKzQbsW49sAD9aZjZgeumTDXD3QrMBh9YjG8DhV2Y2YPqnRzaA6XNoNuD41icb4O5lZgOmXz2yAVz/be/8uxTFsTAcEjEieYVypmUJJacFtsbd2h/f/9tNK5dUbGNrax3s1vv8o+F6EFHyCLyB5pfRBlPrFECeKHETZZoDpqj4T899tMEwvO2xNkZibQBYC9g/b/pCaS7m8b2hGvyYM34ubzf9KhXPB8Oo5lfRBo/B7Ip4OrewK3E1G6DT8bQBnqBDk4nFjzjjZ+hbdw9zQDDMEyKX9v7aYP4Jm0R0yzEbiWsxgPz2EBlAPX0cUISQ5Oc3C3wV11Muc4C1wXAU917aYCqgoaf6hr/BJZAMt9efPX0UV4RYAs7PuN7PUwAda4PhKC5r425sgIKeKmAuiHpd1vSU2upANuVaHPAV9kv/lQLJ05+dEwEkYG70M71tp6OUtcHwmXHWxr1YwjohNE07hKIAIK32jdTMa517Z8z3LRhq9mj7l3LaePoorggQA7MPP/9x2s9l0M+Ol2kkBGvjpyFr/yboM8d6OYp7T20wKawM9HDWWqDLdi0Ds8CuSWfM6wWVg3pQgH76Pz1hP+NCP0Mf+pmaHgFtMKmHvIs2yjQTl/KSfvAyvjZ0CiCNH2LbG18bzAL2yOQ5uj9lNgOaXhuw7UQtgS6iqxi3Sk4a2BdxzApQTx8HDPsZIT/vhZyvD/yM3s9R2M9hbTDwuIM26tUCUFfdfEiPrA365wegeIRtb3xtMAY2kK360vvBql4bb7vmsp9cAVuSSxucXyMczxrFDfv5aLLM0WmZFYAhP6OdqATI934uBj/jhbVxHgDtQDSyNmjH8Oe0sW2JeGxtLIHtNE4ssHqMKO79tcHaMNj2OgdmuyYdxor7o1Qb2H8Nh7ei0M/9heOA4RWNwNY76f2MQz9j52cJbEkuKWvjhpMXI2hjAsDmP6kNda9zGwrYRv1j/mjbHmtjTG1Emz27Xmzt9l2BuSeWst+bng+20LBZMM77ZMg3e6U2DBaHfgb5Gav+4cvgiOiX1gZrI0ZXKP27aINOs9GB098ZObd31AZro8KeZtDDjn8bNMfaSKkpNrBxoG9U4ulY2cu1QX5+/fY0c9kq4A9PLGrwMwY/I7tOG6yNqqz9cr1ee8W6Kiuv6crhkBs1Hf5rJzoS4nZtuPenMi19OFXnFihc/u6z1WXkHS/N3c1W1YNte6yNUbVhv9Fr4xWOkDYWcBxpowA0XxX3h9qQ2GMGPVDNHGvDqWEDxD+rDdbG1Jj1q+lzalSui9wLptWzHK4pjZlW6a79Olhh18IiFsHMW1rRvqHjRm0YM+vfP3blVQ4gqYb+cYGP5tykQu/KxWHorqgPmrFbEwdbZmObx4n5Vg1rY3wMHXOSUtIRpg0ASwS0YT6q30epNsCWxx+d0UbvZ0MHxImANjw/X6EN1oYGUvTrOqKy8XNqlUFf1mTzZV+mjvQVVP7qMukHmTeDz9UGkLr3P1j6tK8n8D9Mijzxs1DSUHkRHTT1MK9wXmsGZI+17bE2xh+34bSRxMSXkDa6mHiR3wd3GymelKw5r43BzzRgPD7yM2nj2M/XaIO1gW6q4oY8AQBvfU5t+D4KlcUdkPXagC0mky2QUsdrdbYvy77cTaVKvMxb9/4efao2gPeJegNSKqOZqrgDFGmrmUjVApq+f2wnqgD9qJZA65WX/WdrAEXzsm/vk9Bv0jzatsfaGAOK1fraePWvhBs6SNWJEHQVw6clSuzF4zacNpyfJyFt5PGAvEIbrA0jvSH5+Ohxs35yQuOMVqSN3WOU91aZ9U1KK7jM2/Ij80bOuEEb5Xfa0GSkqC830ru2gEEu+8Uz9CG29LK4X/qGRvrkkbtSw/DRNZBnpy8k9wBEM8vaGJUVMDvUxpqmEOEkFcEnNoJxwLCf4fzsDlJ5fg4cpMpFGNZGCOBA23pYu9TTglbnqu9p47ZV4iOXIIF0+JqkW/ku7ZaHM283acMRe9Kj40YuyB6R9Nq28Ef/pID0lmdFr949ydw8hk+hgeLkVasfbdtjbYxCDXT1gTZqID2pDRoEGPbPm3hu3Ni/8342rsciwkkq1sYt2ojdkRivX45pOiGBxD24vj9y28A/mi19U64Xp1l+tjZSNxP34KY7UqcNf+nngydU03zZVXPhHEhrIrwI+uFuw8HaGIelu+7tf2hXNx3EsC4C2lDuh1z4e77/zWEk77t1J7URAbkfBnV9U1gblI5kbVwMkGviUm1UZbkJaYOaDgV8dWeuP00bie7JzmrDBW7LRUAb1AycstBAdlIba6B5vG2PtTEOdQOYl3VV6hy2oI0kX61FpXM7PdaGSIG0rOsyRRN9zMUAsw1BOnneKG6wlDg/r+GOUJfk54A2PD+vWRtXnNs4o41qlgNAUBsZNYkYH5jbtRF68Vlt6AV6zmsDHuqUNioDKx/uqrisjfGDzzY5TLTZRga0Qa93V1Knood+9lsBBAtRA5i49zOcn7/u/YzVsTZE6/xsos/WBmtjnQO2adugNtSxNizR3EUbdQrYZtvmF2rDDpzUxhxYPeC2x9oYC7ls7I72f4KI9xO6d9kPDvqr780seUIu7Y7t/8UHynro516dDU4WTvgZjQxow73e6s/d22BtUMKWUkfn9zb8zNv42qCE7W5Cepk2Fl4GL6wNDbw/4l9g1saIZEplUXhCiEgpJQUTJipOnjInP6sTfraDgjW9vvfzi/iell56LayNmP5syzPnNkKn0cfXRkRLf5k28vCa8CmBJnqmbY9h2M/MjdqgnFpYG5SY2qE2MeVc76kNBehT2qDEVN/ebORu8fIz2qgMOikYhmEuhbXhOt4spA2v502xoMzbPbVB+0antLEaxgRNALW3SPZjbaQ0P4ZhmAthbSwpxZaEtTGjcgUkB5k3fa+9jTll8ELaUN5gxWhnEcrs1fMqqA1Ne08MwzA8bqNHntXGCjCv5SZFWBuyQx5XdWkASZm3eF1T5u2Tx23oyVltRB1QlK8aAKJjbYgWSNaiKoCCMntJWVevCyyigDYUgM1AJBiGYfhe4uqsNqIGe96ARUAb7j4OVgcyb5+jDUdyPkm1ondfAFlAGy50t91bIOvglj6gjSU8pHhOGIZhrMdOG9bG/t0lbP8gYpou3+w3CtHZLvrWsvad/ECXSJg0u3ozCWfempAJrP0JbdiB/p2tbd1M3IM/vbPWtlJbu3JJOrfYQ+iu05Ggpovs0Zrw6YvEhdpgGIZhpFLRmXoWzrzdBbc0YSK3eNSkT/e0MMzfzPfQHIF0ffwAAAAASUVORK5CYII=\"","module.exports = __webpack_public_path__ + \"static/media/enhancer-view-2.5240166b.png\";","module.exports = __webpack_public_path__ + \"static/media/enhancer-view-3.bf2e34ef.png\";","module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/enhancer-view-5.cf1c5548.png\";","module.exports = __webpack_public_path__ + \"static/media/gene-view-1.0cd2047f.png\";","module.exports = __webpack_public_path__ + \"static/media/gene-view-2.a8614234.png\";","import React from 'react';\nimport Backdrop from '@material-ui/core/Backdrop';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme) => ({\n  backdrop: {\n    zIndex: theme.zIndex.drawer + 1,\n    color: '#bbb',\n    backgroundColor: '#fff',\n  },\n}));\n\nconst AppInitializing = () => {\n  const classes = useStyles();\n\n  return (\n    <div className=\"full-wh\">\n      <Backdrop className={classes.backdrop} open={true}>\n        <CircularProgress color=\"inherit\" />\n      </Backdrop>\n    </div>\n  );\n};\n\nexport default AppInitializing;\n","import React from 'react';\nimport './AppError.css';\n\nconst AppInitializing = () => (\n  <div className=\"full-wh app-error\">\n    <span>Failed to initialize!</span>\n  </div>\n);\n\nexport default AppInitializing;\n","import React, { createContext } from 'react';\n\nconst ChromInfoContext = createContext();\n\nexport default function ChromInfoProvider({ children, chromInfo }) {\n  return (\n    <ChromInfoContext.Provider value={chromInfo}>\n      {children}\n    </ChromInfoContext.Provider>\n  );\n}\n\nfunction useChromInfo() {\n  const context = React.useContext(ChromInfoContext);\n  if (context === undefined) {\n    throw new Error('useChromInfo must be used within a ChromInfoContext');\n  }\n  return context;\n}\n\nexport { useChromInfo };\n","import { useState, useEffect } from 'react';\n\nexport default function useDebounce(value, delay) {\n  const [debouncedValue, setDebouncedValue] = useState(value);\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n\n  return debouncedValue;\n}\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useRecoilState, useRecoilValue } from 'recoil';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport CheckBoxIcon from '@material-ui/icons/CheckBox';\nimport CheckBoxOutlineBlankIcon from '@material-ui/icons/CheckBoxOutlineBlank';\nimport IndeterminateCheckBoxIcon from '@material-ui/icons/IndeterminateCheckBox';\nimport FilterListIcon from '@material-ui/icons/FilterList';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport Grid from '@material-ui/core/Grid';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport useDebounce from './use-debounce';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    position: 'relative',\n  },\n  filterBar: {\n    position: 'sticky',\n    zIndex: 1,\n    top: '8px',\n    '&:before': {\n      content: '\"\"',\n      position: 'absolute',\n      zIndex: 0,\n      top: '-9px',\n      right: '-8px',\n      left: '-8px',\n      bottom: 0,\n      background: 'white',\n    },\n  },\n  checkbox: {\n    marginTop: -6,\n    marginBottom: -6,\n  },\n  checkboxLabel: {\n    fontSize: '0.8rem',\n    marginLeft: -6,\n  },\n  nestedCheckbox: {\n    marginLeft: 4,\n  },\n  visible: {\n    transition: '.3s ease transform, .3s ease height',\n    transform: 'scale(1, 1)',\n    height: '1.625rem',\n  },\n  invisible: {\n    transition: '.3s ease transform, .3s ease height',\n    transform: 'scale(1, 0)',\n    height: '0rem',\n  },\n}));\n\nconst Option = React.memo(function Option({\n  filterState,\n  name,\n  stateWithName,\n  group,\n  stateWithGroup,\n  colorCheckbox,\n  colorText,\n}) {\n  const filter = useRecoilValue(filterState);\n  const [state, setState] = useRecoilState(stateWithName(name));\n  const [groupState, setGroupState] = useRecoilState(stateWithGroup(group));\n  const nameLowerCase = useMemo(() => name.toLowerCase(), [name]);\n\n  const changeHandler = useCallback(\n    (event) => {\n      setState((currState) => ({\n        ...currState,\n        checked: event.target.checked,\n      }));\n      setGroupState((currGroupState) => {\n        const newGroupState = {\n          ...currGroupState,\n          n: currGroupState.n + (event.target.checked ? 1 : -1),\n        };\n        switch (newGroupState.n) {\n          case currGroupState.N:\n            newGroupState.checked = true;\n            break;\n          case 0:\n            newGroupState.checked = false;\n            break;\n          default:\n            newGroupState.checked = undefined;\n            break;\n        }\n        return newGroupState;\n      });\n    },\n    [setState, setGroupState]\n  );\n\n  useEffect(() => {\n    if (groupState.checked === true) {\n      setState((currState) => ({\n        ...currState,\n        checked: true,\n      }));\n    } else if (groupState.checked === false) {\n      setState((currState) => ({\n        ...currState,\n        checked: false,\n      }));\n    }\n  }, [groupState, setState]);\n\n  useEffect(() => {\n    setState((currState) => ({\n      ...currState,\n      visible: !filter.length || nameLowerCase.includes(filter),\n    }));\n  }, [filter, nameLowerCase, setState]);\n\n  const classes = useStyles();\n\n  return (\n    <div className={state.visible ? classes.visible : classes.invisible}>\n      <FormControlLabel\n        key={name}\n        className={`${classes.checkbox} ${classes.nestedCheckbox}`}\n        control={\n          <Checkbox\n            style={{\n              color: colorCheckbox,\n            }}\n            icon={<CheckBoxOutlineBlankIcon fontSize=\"small\" />}\n            checkedIcon={<CheckBoxIcon fontSize=\"small\" />}\n            checked={state.checked}\n            onChange={changeHandler}\n            name={name}\n          />\n        }\n        label={\n          <Typography\n            className={classes.checkboxLabel}\n            noWrap\n            style={{\n              color: colorText,\n            }}\n          >\n            {name}\n          </Typography>\n        }\n      />\n    </div>\n  );\n});\n\nconst OptionGroup = React.memo(function OptionGroup({\n  group,\n  stateWithGroup,\n  colorCheckbox,\n  colorText,\n}) {\n  const [state, setState] = useRecoilState(stateWithGroup(group));\n\n  const changeHandler = useCallback(\n    (event) => {\n      setState((currState) => ({\n        ...currState,\n        checked: event.target.checked,\n        n: event.target.checked ? currState.N : 0,\n      }));\n    },\n    [setState]\n  );\n\n  const classes = useStyles();\n\n  return (\n    <FormControlLabel\n      className={classes.checkbox}\n      control={\n        <Checkbox\n          style={{ color: colorCheckbox }}\n          icon={\n            state.checked === false ? (\n              <CheckBoxOutlineBlankIcon fontSize=\"small\" />\n            ) : (\n              <IndeterminateCheckBoxIcon fontSize=\"small\" />\n            )\n          }\n          checkedIcon={<CheckBoxIcon fontSize=\"small\" />}\n          checked={state.checked === true}\n          onChange={changeHandler}\n          name={group.name}\n        />\n      }\n      label={\n        <Typography\n          className={classes.checkboxLabel}\n          noWrap\n          style={{ color: colorText }}\n        >\n          <strong>{group.name}</strong>{' '}\n          <span>\n            ({state.n}/{state.N})\n          </span>\n        </Typography>\n      }\n    />\n  );\n});\n\nconst NestedCheckboxList = React.memo(function NestedCheckboxList({\n  filterState,\n  optionWithName,\n  optionGroupWithGroup,\n  filterLabel = 'Filter',\n  groupedOptions = [],\n  optionToGroup = {},\n  groupColors = [],\n  groupColorsDark = [],\n}) {\n  const [globalFilter, setGlobalFilter] = useRecoilState(filterState);\n  const [filter, setFilter] = useState(globalFilter);\n  const filterDb = useDebounce(filter, 350);\n\n  const filterChangeHandler = useCallback(\n    (event) => {\n      setFilter(event.target.value.toLowerCase());\n    },\n    [setFilter]\n  );\n\n  useEffect(() => {\n    setGlobalFilter(filterDb);\n  }, [filterDb, setGlobalFilter]);\n\n  const classes = useStyles();\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.filterBarBg} />\n      <FormControl\n        className={classes.filterBar}\n        variant=\"outlined\"\n        margin=\"dense\"\n        fullWidth\n      >\n        <InputLabel htmlFor=\"filter\">\n          <Grid container direction=\"row\" alignItems=\"center\">\n            <FilterListIcon fontSize=\"small\" />\n            <span style={{ marginLeft: 3 }}>{filterLabel}</span>\n          </Grid>\n        </InputLabel>\n        <OutlinedInput\n          id=\"filter\"\n          label={\n            <Grid container direction=\"row\" alignItems=\"center\">\n              <FilterListIcon fontSize=\"small\" />\n              <span style={{ marginLeft: 3 }}>{filterLabel}</span>\n            </Grid>\n          }\n          onChange={filterChangeHandler}\n          value={filter}\n        />\n      </FormControl>\n      <FormGroup>\n        {groupedOptions.map((group, i) => (\n          <React.Fragment key={group.name}>\n            <OptionGroup\n              key={group.name}\n              group={group}\n              stateWithGroup={optionGroupWithGroup}\n              colorCheckbox={groupColors[i % groupColors.length] || 'inherit'}\n              colorText={\n                groupColorsDark[i % groupColorsDark.length] || 'inherit'\n              }\n            />\n            {group.options.map((option) => (\n              <Option\n                filterState={filterState}\n                key={option}\n                name={option}\n                stateWithName={optionWithName}\n                group={group}\n                stateWithGroup={optionGroupWithGroup}\n                colorCheckbox={groupColors[i % groupColors.length] || 'inherit'}\n                colorText={\n                  groupColorsDark[i % groupColorsDark.length] || 'inherit'\n                }\n              />\n            ))}\n          </React.Fragment>\n        ))}\n      </FormGroup>\n    </div>\n  );\n});\n\nexport default NestedCheckboxList;\n","import PropTypes from 'prop-types';\nimport React from 'react';\n\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme) => ({\n  logo: {\n    height: '100%',\n    padding: '0.1em',\n    alignItems: 'center',\n    fontSize: '1em',\n    lineHeight: '1em',\n    fontWeight: 'bold',\n  },\n  logoAbc: {\n    fontSize: '2.75em',\n    letterSpacing: '-0.075rem',\n    paddingRight: '0.125em',\n    fontWeight: 900,\n  },\n  logoEnhancer: {\n    alignItems: 'flex-start',\n  },\n}));\n\nconst Logo = (props) => {\n  const classes = useStyles();\n\n  return (\n    <Grid container className={classes.logo} style={props.styles}>\n      <Grid item className={classes.logoAbc}>\n        ABC\n      </Grid>\n      <Grid item>\n        <Grid container direction=\"column\" className={classes.logoEnhancer}>\n          <Grid item>Enhancer-Gene</Grid>\n          <Grid item>Connections</Grid>\n        </Grid>\n      </Grid>\n    </Grid>\n  );\n};\n\nLogo.defaultProps = {\n  styles: {},\n};\n\nLogo.propTypes = {\n  styles: PropTypes.object,\n};\n\nexport default Logo;\n","import React, { useCallback, useState } from 'react';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport ClearIcon from '@material-ui/icons/Clear';\nimport InsertDriveFileIcon from '@material-ui/icons/InsertDriveFile';\n\nconst FileInput = React.memo(\n  React.forwardRef(function FileInput(props, ref) {\n    const {\n      onChange: changeHandler,\n      onClear: clearHandler,\n      className = '',\n      label = 'Select',\n      accept = '*',\n      color = 'default',\n      Icon = InsertDriveFileIcon,\n    } = props;\n\n    // We will spread any other props onto the root component. However, some\n    // props can mess things up so we will remove them in the following lines\n    const otherProps = { ...props };\n    delete otherProps.onChange;\n    delete otherProps.onClear;\n    delete otherProps.className;\n    delete otherProps.file;\n    delete otherProps.label;\n    delete otherProps.accept;\n    delete otherProps.color;\n    delete otherProps.Icon;\n\n    const [file, setFile] = useState(props.file || null);\n\n    const localChangeHandler = useCallback(\n      (event) => {\n        const fileList = event.target.files;\n        setFile(fileList[0]);\n        if (changeHandler) changeHandler(fileList[0], event);\n      },\n      [changeHandler]\n    );\n\n    const clearFile = useCallback(() => {\n      setFile(null);\n      if (clearHandler) clearHandler();\n    }, [clearHandler]);\n\n    return (\n      <ButtonGroup {...otherProps} className=\"r\" ref={ref}>\n        <Button\n          variant={file ? 'outlined' : 'contained'}\n          component=\"label\"\n          className={className}\n          color={color}\n          disableElevation\n          startIcon={<Icon />}\n        >\n          <input\n            accept={accept}\n            type=\"file\"\n            onChange={localChangeHandler}\n            hidden\n          />\n          {file ? file.name : label}\n        </Button>\n        <Button\n          variant=\"contained\"\n          disabled={!file}\n          onClick={clearFile}\n          disableElevation\n        >\n          <ClearIcon fontSize=\"inherit\" />\n        </Button>\n      </ButtonGroup>\n    );\n  })\n);\n\nexport default FileInput;\n","import { identity } from '@flekschas/utils';\nimport queryString from 'query-string';\n\nexport const contains = (a, b) => a[0] <= b[0] && a[1] >= b[1];\n\nexport const createColorTexture = (PIXI, colors) => {\n  const colorTexRes = Math.max(2, Math.ceil(Math.sqrt(colors.length)));\n  const rgba = new Float32Array(colorTexRes ** 2 * 4);\n  colors.forEach((color, i) => {\n    // eslint-disable-next-line prefer-destructuring\n    rgba[i * 4] = color[0]; // r\n    // eslint-disable-next-line prefer-destructuring\n    rgba[i * 4 + 1] = color[1]; // g\n    // eslint-disable-next-line prefer-destructuring\n    rgba[i * 4 + 2] = color[2]; // b\n    // eslint-disable-next-line prefer-destructuring\n    rgba[i * 4 + 3] = color[3]; // a\n  });\n\n  return [PIXI.Texture.fromBuffer(rgba, colorTexRes, colorTexRes), colorTexRes];\n};\n\nexport const dashedXLineTo = (graphics, xStart, xEnd, y, dashSize) => {\n  const diff = xEnd - xStart;\n  const direction = Math.sign(diff);\n  const width = Math.abs(diff);\n  const stepSize = dashSize * 2;\n  const numSteps = Math.ceil(width / stepSize);\n  for (let i = 0; i < numSteps; i++) {\n    graphics.moveTo(xStart + i * stepSize * direction, y);\n    graphics.lineTo(xStart + (i * stepSize + dashSize) * direction, y);\n  }\n};\n\nexport const download = (filename, stringOrBlob) => {\n  const blob =\n    typeof stringOrBlob === 'string'\n      ? new Blob([stringOrBlob], { type: 'application/octet-stream' })\n      : stringOrBlob;\n  if (window.navigator.msSaveOrOpenBlob) {\n    window.navigator.msSaveBlob(blob, filename);\n  } else {\n    const elem = window.document.createElement('a');\n    elem.href = window.URL.createObjectURL(blob);\n    elem.download = filename;\n    document.body.appendChild(elem);\n    elem.click();\n    document.body.removeChild(elem);\n    URL.revokeObjectURL(elem.href);\n  }\n};\n\nexport const getQueryStringValue = (key, decoder = identity) =>\n  decoder(queryString.parse(window.location.search)[key]);\n\nexport const setQueryStringValue = (key, value, encoder = identity) => {\n  const values = queryString.parse(window.location.search);\n  const newQsValue = queryString.stringify(\n    {\n      ...values,\n      [key]: encoder(value),\n    },\n    { strict: false }\n  );\n  const url = `${window.location.origin}${window.location.pathname}?${newQsValue}`;\n  window.history.pushState({ path: url }, '', url);\n};\n\nexport const toAbsPosition = (position, chromInfo) => {\n  let absPosition;\n  if (position.indexOf && position.indexOf(':') >= 0) {\n    const [chrom, pos] = position.split(':');\n    absPosition = chromInfo.chrPositions[chrom].pos + +pos;\n  } else {\n    absPosition = +position;\n  }\n  return absPosition;\n};\n\nexport const toFixed = (number, decimals, forced) => {\n  let string = number.toFixed(decimals);\n  if (!forced) {\n    while (string[string.length - 1] === '0') {\n      string = string.substring(0, string.length - 1);\n    }\n    if (string[string.length - 1] === '.') {\n      string = string.substring(0, string.length - 1);\n    }\n  }\n  return string;\n};\n\nexport const scaleBand = () => {\n  let domain = [];\n  let fixedBandwidth = null;\n  let bandwidth = 1;\n  let range = [0, 1];\n  let rangeSize = range[1] - range[0];\n  let paddingInner = [];\n  // If `true` the padding will begin before the first bar!\n  let paddingInnerZeroBased = false;\n  let totalWidth = 0;\n\n  const sum = (a, b) => a + b;\n  const getBandwidth = () => fixedBandwidth || bandwidth;\n\n  const update = () => {\n    rangeSize = range[1] - range[0];\n\n    const totalPaddingInner = paddingInner.reduce(sum, 0);\n    bandwidth = (rangeSize - totalPaddingInner) / domain.length;\n    totalWidth = totalPaddingInner + domain.length * getBandwidth();\n  };\n\n  const scale = (v) => {\n    const idx = domain.indexOf(v);\n\n    if (idx === -1) return undefined;\n\n    return (\n      idx * getBandwidth() +\n      paddingInner.slice(0, idx + paddingInnerZeroBased).reduce(sum, 0)\n    );\n  };\n\n  scale.domain = (newDomain) => {\n    if (newDomain) {\n      domain = [...newDomain];\n      update();\n      return scale;\n    }\n\n    return domain;\n  };\n\n  scale.range = (newRange) => {\n    if (newRange) {\n      range = [...newRange];\n      update();\n      return scale;\n    }\n\n    return range;\n  };\n\n  scale.bandwidth = () => getBandwidth();\n\n  scale.fixedBandwidth = (newFixedBandwidth) => {\n    if (newFixedBandwidth) {\n      fixedBandwidth = newFixedBandwidth;\n      update();\n      return scale;\n    }\n\n    return newFixedBandwidth;\n  };\n\n  scale.totalWidth = () => totalWidth;\n\n  scale.rangeSize = () => rangeSize;\n\n  scale.paddingInner = (newPaddingInner) => {\n    if (newPaddingInner) {\n      paddingInner = newPaddingInner;\n      update();\n      return scale;\n    }\n\n    return paddingInner;\n  };\n\n  scale.paddingInnerZeroBased = (newPaddingInnerZeroBased) => {\n    if (newPaddingInnerZeroBased) {\n      paddingInnerZeroBased = newPaddingInnerZeroBased;\n      update();\n      return scale;\n    }\n\n    return paddingInnerZeroBased;\n  };\n\n  return scale;\n};\n\nexport const stringifySvg = (svg) =>\n  new window.XMLSerializer().serializeToString(svg);\n\nexport const booleanQueryStringDecoder = (v) =>\n  v === undefined ? undefined : v === 'true';\n\nexport const customBooleanQueryStringDecoder = (excluded = []) => {\n  const s = excluded.reduce((_s, v) => {\n    _s.add(v);\n    return _s;\n  }, new Set());\n  return (v) => {\n    if (v === undefined || s.has(v)) return v;\n    return v === 'true';\n  };\n};\n","import { globalPubSub } from 'pub-sub-es';\nimport IntervalTree from '@flatten-js/interval-tree';\n\nimport { toAbsPosition } from './utils';\n\nasync function loadFile(\n  file,\n  chromInfo,\n  { header = true, columnImportance = 7 } = {}\n) {\n  const tree = new IntervalTree();\n  const text = await file.text();\n  const lines = text.split(/\\r\\n|\\n/);\n  for (let i = +header; i < lines.length; i++) {\n    const fields = lines[i].split('\\t');\n    const chromOffset = toAbsPosition(`${fields[0]}:0`, chromInfo);\n    const startAbs = toAbsPosition(`${fields[0]}:${fields[1]}`, chromInfo);\n    const endAbs = toAbsPosition(`${fields[0]}:${fields[2]}`, chromInfo);\n    tree.insert([startAbs, endAbs], {\n      chrOffset: chromOffset,\n      xStart: startAbs,\n      xEnd: endAbs,\n      importance: +fields[columnImportance],\n      uid: `${file.name}-${i}`,\n      name: fields[3],\n      fields,\n    });\n  }\n  return tree;\n}\n\nconst createLocalBedDataServer = (\n  file,\n  id,\n  chromInfo,\n  tilesetInfo,\n  options\n) => {\n  const whenIndex = loadFile(file, chromInfo, options);\n\n  const requestTileHandler = ({ fileId, z, x, requestId }) => {\n    if (fileId !== id) return;\n    whenIndex.then((index) => {\n      const tileWidth = tilesetInfo.max_width / 2 ** z;\n      const start = tileWidth * x;\n      const end = start + tileWidth;\n      const results = index.search([start, end]);\n      globalPubSub.publish(`localBed:tile:${requestId}`, results);\n    });\n  };\n\n  const requestTilesetInfoHandler = ({ fileId, requestId }) => {\n    if (fileId !== id) return;\n    globalPubSub.publish(`localBed:tilesetInfo:${requestId}`, tilesetInfo);\n  };\n\n  const subscriptionTile = globalPubSub.subscribe(\n    'localBed:requestTile',\n    requestTileHandler\n  );\n\n  const subscriptionTilesetInfo = globalPubSub.subscribe(\n    'localBed:requestTilesetInfo',\n    requestTilesetInfoHandler\n  );\n\n  const destroy = () => {\n    globalPubSub.unsubscribe(subscriptionTile);\n    globalPubSub.unsubscribe(subscriptionTilesetInfo);\n  };\n\n  return {\n    destroy,\n  };\n};\n\nexport default createLocalBedDataServer;\n","import { useCallback, useMemo, useState } from 'react';\nimport { useRecoilState, useRecoilValue } from 'recoil';\n\nimport { getQueryStringValue, setQueryStringValue } from './utils';\n\nexport default function useQueryStringWithReactState(\n  key,\n  initialValue,\n  { encoder, decoder } = {}\n) {\n  const _initialValue =\n    getQueryStringValue(key, decoder) === undefined\n      ? initialValue\n      : getQueryStringValue(key, decoder);\n\n  const [value, setValue] = useState(_initialValue);\n\n  const onSetValue = useCallback(\n    (newValue) => {\n      setValue(newValue);\n      setQueryStringValue(key, newValue, encoder);\n    },\n    [key, encoder]\n  );\n\n  // Set initial value\n  setQueryStringValue(key, value, encoder);\n\n  return [value, onSetValue];\n}\n\nexport function useRecoilQueryString(key, atom, encoder) {\n  const [value, setValue] = useRecoilState(atom);\n\n  const onSetValue = useCallback(\n    (newValue) => {\n      setValue(newValue);\n      setQueryStringValue(key, newValue, encoder);\n    },\n    [key, encoder, setValue]\n  );\n\n  return [value, onSetValue];\n}\n\nexport function useRecoilQueryStringSyncher(key, atom, encoder) {\n  const value = useRecoilValue(atom);\n\n  useMemo(() => {\n    setQueryStringValue(key, value, encoder);\n  }, [key, encoder, value]);\n}\n","export const DRAWER_WIDTH = 240;\n\nexport const EPS = 1e-6;\n\nexport const SVG_SKELETON = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg\n    xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n    xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"_WIDTH_px\" height=\"_HEIGHT_px\">\n    <g id=\"enhancer-plot\">\n    _ENHANCER_\n    </g>\n    <g id=\"enhancer-gene-plot\" transform=\"translate(0, _ENHANCER_GENE_Y_)\">\n    _ENHANCER_GENE_\n    </g>\n    <g id=\"dna-accessibility-plot\" transform=\"translate(_DNA_ACCESS_X_, 0)\">\n    _DNA_ACCESS_\n    </g>\n</svg>`;\n\nexport const DEFAULT_COLOR_MAP = [\n  // '#c17da5', // pink\n  '#c76526', // red\n  '#6fb2e4', // light blue\n  '#eee462', // yellow\n  '#469b76', // green\n  '#3170ad', // dark blue\n  '#dca237', // orange\n  '#000000', // black\n  '#999999', // gray\n];\n\nexport const DEFAULT_COLOR_MAP_DARK = [\n  // '#a1688a', // pink\n  '#a65420', // red\n  '#4a7798', // light blue\n  '#999026', // yellow\n  '#3a8162', // green\n  '#295d90', // dark blue\n  '#b7872e', // orange\n  '#000000', // black\n  '#666666', // gray\n];\n\nexport const DEFAULT_COLOR_MAP_LIGHT = [\n  // '#f5e9f0', // pink\n  '#f6e5db', // red\n  '#e7f2fb', // light blue\n  '#f2eda9', // yellow\n  '#e0eee8', // green\n  '#dde7f1', // dark blue\n  '#f5e4c4', // orange\n  '#d5d5d5', // black\n  '#ffffff', // gray\n];\n\nexport const GENE_SEARCH_URL =\n  'https://higlass.io/api/v1/suggest/?d=OHJakQICQD6gTD7skx4EWA';\n\nexport const VARIANT_SEARCH_URL =\n  'https://resgen.io/api/v1/suggest/?d=VF5-RDXWTxidGMJU7FeaxA';\n\nexport const DEFAULT_STRATIFICATION = {\n  categoryField: 10,\n  axisShowGroupSeparator: true,\n  axisNoGroupColor: false,\n  groups: [\n    {\n      label: 'Mononuclear Phagocytes',\n      categories: [\n        'THP1_LPS_4hr-Engreitz',\n        'THP_pmaLPS_ATAC_6h',\n        'CD14-positive_monocyte_treated_with_LPS_4h-Novakovic2016',\n        'CD14-positive_monocyte_treated_with_BG_1h-Novakovic2016',\n        'CD14-positive_monocyte_treated_with_RPMI_d6-Novakovic2016',\n        'THP1-Engreitz',\n        'THP_pmaLPS_ATAC_96h',\n        'CD14-positive_monocyte_treated_with_BG_d1-Novakovic2016',\n        'THP_pmaLPS_ATAC_72h',\n        'THP-1_monocyte-VanBortle2017',\n        'CD14-positive_monocyte_treated_with_LPS_d1-Novakovic2016',\n        'CD14-positive_monocyte-ENCODE',\n        'THP_pmaLPS_ATAC_2h',\n        'dendritic_cell_treated_with_Lipopolysaccharide_0_ng-mL_for_0_hour-Garber2017',\n        'CD14-positive_monocyte_treated_with_RPMI_1h-Novakovic2016',\n        'U937_LPS_4hr-Engreitz',\n        'CD14-positive_monocyte-Novakovic2016',\n        'dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_6_hour-Garber2017',\n        'CD14-positive_monocyte_treated_with_BG_4h-Novakovic2016',\n        'THP_pmaLPS_ATAC_0h',\n        'HAP1',\n        'THP-1_macrophage-VanBortle2017',\n        'dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_1_hour-Garber2017',\n        'U937-Engreitz',\n        'CD14-positive_monocyte_treated_with_RPMI_d1-Novakovic2016',\n        'CD14-positive_monocyte_treated_with_RPMI_4h-Novakovic2016',\n        'CD14-positive_monocyte_treated_with_LPS_d6-Novakovic2016',\n        'CD14-positive_monocyte_treated_with_LPS_1h-Novakovic2016',\n        'THP_pmaLPS_ATAC_24h',\n        'THP_pmaLPS_ATAC_1h',\n        'dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_2_hour-Garber2017',\n        'CD14-positive_monocyte_treated_with_BG_d6-Novakovic2016',\n        'dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_30_minute-Garber2017',\n        'THP_pmaLPS_ATAC_120h',\n        'dendritic_cell_treated_with_Lipopolysaccharide_100_ng-mL_for_4_hour-Garber2017',\n        'THP_pmaLPS_ATAC_48h',\n        'CD14-positive_monocytes-Roadmap',\n        'THP_pmaLPS_ATAC_12h', // monoctye\n      ],\n    },\n    {\n      label: 'B Cells',\n      categories: [\n        'Karpas-422-ENCODE', // b-cell cell line\n        'BJAB-Engreitz',\n        'BJAB_anti-IgM_anti-CD40_4hr-Engreitz',\n        'B_cell-ENCODE',\n        'OCI-LY7-ENCODE',\n        'GM12878-Roadmap',\n        'MM.1S-ENCODE',\n        'CD19-positive_B_cell-Roadmap',\n        'CD8-positive_alpha-beta_T_cell-ENCODE',\n      ],\n    },\n    {\n      label: 'T Cells',\n      categories: [\n        'Jurkat_anti-CD3_PMA_4hr-Engreitz', // t-cell\n        'Jurkat-Engreitz',\n        'CD3-positive_T_cell-Roadmap',\n        'CD4-positive_helper_T_cell-ENCODE',\n        'CD8-positive_alpha-beta_T_cell-Corces2016',\n        'thymus_fetal-Roadmap',\n        'CD4-positive_helper_T_cell-Corces2016',\n        'T-cell-ENCODE',\n      ],\n    },\n    {\n      label: 'Other haematopoietic cells',\n      categories: [\n        'spleen-ENCODE',\n        'K562-Roadmap',\n        'CD56-positive_natural_killer_cells-Roadmap',\n        'erythroblast-Corces2016',\n        'CD34-positive_mobilized-Roadmap',\n        'megakaryocyte-erythroid_progenitor-Corces2016',\n        'natural_killer_cell-Corces2016',\n        'IMR90-Roadmap',\n      ],\n    },\n    {\n      label: 'Fibroblasts',\n      categories: [\n        'foreskin_fibroblast-Roadmap',\n        'fibroblast_of_dermis-Roadmap',\n        'fibroblast_of_arm-ENCODE',\n        'astrocyte-ENCODE',\n        'fibroblast_of_lung-Roadmap',\n      ],\n    },\n    {\n      label: 'Epithelial',\n      categories: [\n        'small_intestine_fetal-Roadmap',\n        'epithelial_cell_of_prostate-ENCODE',\n        'HCT116-ENCODE',\n        'MCF-7-ENCODE',\n        'adrenal_gland_fetal-ENCODE',\n        'H7',\n        'keratinocyte-Roadmap',\n        'MCF10A-Ji2017',\n        'pancreas-Roadmap',\n        'mammary_epithelial_cell-Roadmap',\n        'stomach-Roadmap',\n        'LoVo',\n        'A549_treated_with_ethanol_0.02_percent_for_1_hour-Roadmap',\n        'PC-9-ENCODE',\n        'H1-hESC-Roadmap',\n        'thyroid_gland-ENCODE',\n        'HT29',\n        'MDA-MB-231',\n        'iPS_DF_19.11_Cell_Line-Roadmap',\n        'large_intestine_fetal-Roadmap',\n        'Panc1-ENCODE',\n        'adrenal_gland-ENCODE',\n        'MCF10A_treated_with_TAM24hr-Ji2017',\n        'trophoblast_cell-ENCODE',\n        'H1_BMP4_Derived_Trophoblast_Cultured_Cells-Roadmap',\n        'uterus-ENCODE',\n        'body_of_pancreas-ENCODE',\n        'stomach_fetal-Roadmap',\n        'H9-Roadmap',\n        'transverse_colon-ENCODE',\n        'H1_BMP4_Derived_Mesendoderm_Cultured_Cells-Roadmap',\n        'breast_epithelium-ENCODE',\n        'induced_pluripotent_stem_cell-ENCODE',\n        'LNCAP',\n        'H1_Derived_Mesenchymal_Stem_Cells-Roadmap',\n        'ovary-Roadmap',\n        'sigmoid_colon-ENCODE',\n        'skeletal_muscle_myoblast-Roadmap',\n        'bipolar_neuron_from_iPSC-ENCODE',\n        'coronary_artery_smooth_muscle_cell-Miller2016',\n        'SK-N-SH-ENCODE',\n        'muscle_of_trunk_fetal-Roadmap',\n      ],\n    },\n    {\n      label: 'Other',\n      categories: [\n        'adipose_tissue-ENCODE',\n        'HeLa-S3-Roadmap',\n        'hepatocyte-ENCODE',\n        'heart_ventricle-ENCODE',\n        'spinal_cord_fetal-ENCODE',\n        'coronary_artery-ENCODE',\n        'HepG2-Roadmap',\n        'muscle_of_leg_fetal-Roadmap',\n        'gastrocnemius_medialis-ENCODE',\n        'brite_adipose-Loft2014',\n        'placenta-Roadmap',\n        'liver-ENCODE',\n        'A673-ENCODE',\n        'white_adipose-Loft2014',\n        'cardiac_muscle_cell-ENCODE',\n        'osteoblast-ENCODE',\n        'H1_Derived_Neuronal_Progenitor_Cultured_Cells-Roadmap',\n        'endothelial_cell_of_umbilical_vein-Roadmap',\n        'NCCIT',\n        'myotube_originated_from_skeletal_muscle_myoblast-Roadmap',\n        'psoas_muscle-Roadmap',\n        'endothelial_cell_of_umbilical_vein_vegf_stim_4_hours-zhang2013',\n        'endothelial_cell_of_umbilical_vein_vegf_stim_12_hours-zhang2013',\n      ],\n    },\n  ],\n};\n\nexport const GROUPED_SAMPLE_OPTIONS = DEFAULT_STRATIFICATION.groups.map(\n  (group) => ({\n    name: group.label,\n    options: group.categories,\n  })\n);\n\nexport const SAMPLE_TO_GROUP = GROUPED_SAMPLE_OPTIONS.reduce(\n  (sampleToGroup, group) => {\n    group.options.forEach((option) => {\n      sampleToGroup[option] = group.name;\n    });\n    return sampleToGroup;\n  },\n  {}\n);\n\nexport const SAMPLES = GROUPED_SAMPLE_OPTIONS.flatMap((group) => group.options);\n\nexport const SAMPLE_IDX = SAMPLES.reduce((idxs, sample, idx) => {\n  idxs[sample] = idx;\n  return idxs;\n}, {});\n\nexport const DEFAULT_X_DOMAIN_START = 1761366260;\nexport const DEFAULT_X_DOMAIN_END = 1761603836;\n\nexport const DEFAULT_VARIANT_TRACK_SERVER = 'https://resgen.io/api/v1';\n\nexport const VARIANT_TRACK_ABBR_TO_SERVER = {\n  rg: 'https://resgen.io/api/v1',\n  hg: 'https://higlass.io/api/v1',\n};\n\nexport const VARIANT_TRACK_SERVER_TO_ABBR = Object.entries(\n  VARIANT_TRACK_ABBR_TO_SERVER\n).reduce((map, [abbr, server]) => {\n  map[server] = abbr;\n  return map;\n}, {});\n\nexport const DEFAULT_VARIANT_TRACK_SERVER_ABBR =\n  VARIANT_TRACK_SERVER_TO_ABBR[DEFAULT_VARIANT_TRACK_SERVER];\n\nexport const DEFAULT_VARIANT_TRACK_PVAL_COL = 7;\n\nexport const DEFAULT_VARIANT_TRACK_PPROB_COL = 8;\n\nexport const DEFAULT_VARIANT_TRACKS = [\n  {\n    server: 'https://resgen.io/api/v1',\n    tilesetUid: 'VF5-RDXWTxidGMJU7FeaxA',\n    columnPvalue: 7,\n    columnPosteriorProbability: 8,\n    markColor: 'black',\n    label: 'IBD Variants',\n  },\n];\n\nexport const DEFAULT_VARIANT_TRACK_DEF = {\n  type: 'point-annotation',\n  height: 32,\n  options: {\n    axisPositionHorizontal: 'right',\n    markColor: 'black',\n    markColorFocus: '#cc0078',\n    markSize: 2,\n    markOpacity: 0.33,\n    markOpacityFocus: 0.66,\n    valueColumn: 7,\n    name: 'Variants',\n    labelPosition: 'topLeft',\n    labelColor: 'black',\n    labelOpacity: 0.33,\n    showMousePosition: true,\n    showGlobalMousePosition: true,\n    mousePositionColor: 'black',\n    toolTip: {\n      name: {\n        field: 3,\n      },\n      value: {\n        field: 6,\n        numDecimals: 2,\n      },\n      other: [\n        {\n          label: 'Post. Prob.',\n          field: 7,\n          numDecimals: 2,\n        },\n      ],\n    },\n  },\n};\n\nexport const LOCAL_BED_TILESET_INFO_HG19 = {\n  zoom_step: 1,\n  max_length: 3137161265,\n  assembly: 'hg19',\n  chrom_names:\n    'chr1\\tchr2\\tchr3\\tchr4\\tchr5\\tchr6\\tchr7\\tchr8\\tchr9\\tchr10\\tchr11\\tchr12\\tchr13\\tchr14\\tchr15\\tchr16\\tchr17\\tchr18\\tchr19\\tchr20\\tchr21\\tchr22\\tchrX\\tchrY\\tchrM\\tchr6_ssto_hap7\\tchr6_mcf_hap5\\tchr6_cox_hap2\\tchr6_mann_hap4\\tchr6_apd_hap1\\tchr6_qbl_hap6\\tchr6_dbb_hap3\\tchr17_ctg5_hap1\\tchr4_ctg9_hap1\\tchr1_gl000192_random\\tchrUn_gl000225\\tchr4_gl000194_random\\tchr4_gl000193_random\\tchr9_gl000200_random\\tchrUn_gl000222\\tchrUn_gl000212\\tchr7_gl000195_random\\tchrUn_gl000223\\tchrUn_gl000224\\tchrUn_gl000219\\tchr17_gl000205_random\\tchrUn_gl000215\\tchrUn_gl000216\\tchrUn_gl000217\\tchr9_gl000199_random\\tchrUn_gl000211\\tchrUn_gl000213\\tchrUn_gl000220\\tchrUn_gl000218\\tchr19_gl000209_random\\tchrUn_gl000221\\tchrUn_gl000214\\tchrUn_gl000228\\tchrUn_gl000227\\tchr1_gl000191_random\\tchr19_gl000208_random\\tchr9_gl000198_random\\tchr17_gl000204_random\\tchrUn_gl000233\\tchrUn_gl000237\\tchrUn_gl000230\\tchrUn_gl000242\\tchrUn_gl000243\\tchrUn_gl000241\\tchrUn_gl000236\\tchrUn_gl000240\\tchr17_gl000206_random\\tchrUn_gl000232\\tchrUn_gl000234\\tchr11_gl000202_random\\tchrUn_gl000238\\tchrUn_gl000244\\tchrUn_gl000248\\tchr8_gl000196_random\\tchrUn_gl000249\\tchrUn_gl000246\\tchr17_gl000203_random\\tchr8_gl000197_random\\tchrUn_gl000245\\tchrUn_gl000247\\tchr9_gl000201_random\\tchrUn_gl000235\\tchrUn_gl000239\\tchr21_gl000210_random\\tchrUn_gl000231\\tchrUn_gl000229\\tchrUn_gl000226\\tchr18_gl000207_random',\n  chrom_sizes:\n    '249250621\\t243199373\\t198022430\\t191154276\\t180915260\\t171115067\\t159138663\\t146364022\\t141213431\\t135534747\\t135006516\\t133851895\\t115169878\\t107349540\\t102531392\\t90354753\\t81195210\\t78077248\\t59128983\\t63025520\\t48129895\\t51304566\\t155270560\\t59373566\\t16571\\t4928567\\t4833398\\t4795371\\t4683263\\t4622290\\t4611984\\t4610396\\t1680828\\t590426\\t547496\\t211173\\t191469\\t189789\\t187035\\t186861\\t186858\\t182896\\t180455\\t179693\\t179198\\t174588\\t172545\\t172294\\t172149\\t169874\\t166566\\t164239\\t161802\\t161147\\t159169\\t155397\\t137718\\t129120\\t128374\\t106433\\t92689\\t90085\\t81310\\t45941\\t45867\\t43691\\t43523\\t43341\\t42152\\t41934\\t41933\\t41001\\t40652\\t40531\\t40103\\t39939\\t39929\\t39786\\t38914\\t38502\\t38154\\t37498\\t37175\\t36651\\t36422\\t36148\\t34474\\t33824\\t27682\\t27386\\t19913\\t15008\\t4262',\n  tile_size: 1024.0,\n  max_zoom: 22,\n  max_width: 4294967296.0,\n  min_pos: [1],\n  max_pos: [3137161265],\n  header:\n    'chrom1\\tstart1\\tend1\\tchrom2\\tstart2\\tend2\\ttargetGene\\tscore\\tstrand1\\tstrand2\\tcellType',\n  version: 2,\n  coordSystem: '',\n};\n\nexport const DEFAULT_VIEW_CONFIG_ENHANCER = {\n  editable: false,\n  trackSourceServers: ['//higlass.io/api/v1'],\n  views: [\n    {\n      uid: 'context',\n      genomePositionSearchBox: {\n        autocompleteServer: '//higlass.io/api/v1',\n        autocompleteId: 'OHJakQICQD6gTD7skx4EWA',\n        chromInfoServer: '//higlass.io/api/v1',\n        chromInfoId: 'hg19',\n        visible: true,\n      },\n      chromInfoPath: '//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv',\n      tracks: {\n        top: [\n          {\n            type: 'combined',\n            uid: 'chroms-viewport',\n            height: 12,\n            contents: [\n              {\n                type: 'horizontal-chromosome-labels',\n                options: {\n                  // tickPositions: 'ends',\n                  color: '#999999',\n                  stroke: 'white',\n                  fontSize: 10,\n                  fontIsLeftAligned: true,\n                  showMousePosition: false,\n                  mousePositionColor: '#000000',\n                },\n                tilesetUid: 'ADfY_RtsQR6oKOMyrq6qhw',\n                height: 12,\n                server: 'https://resgen.io/api/v1',\n                uid: 'chroms',\n              },\n              {\n                uid: 'viewport-details-chroms',\n                type: 'viewport-projection-horizontal',\n                fromViewUid: 'details',\n                height: 12,\n                options: {\n                  projectionFillColor: '#cc0078',\n                  projectionStrokeColor: '#cc0078',\n                  projectionFillOpacity: 0.3,\n                  projectionStrokeOpacity: 0.3,\n                  strokeWidth: 1,\n                },\n              },\n            ],\n          },\n          {\n            type: 'combined',\n            uid: 'genes-tss-viewport',\n            height: 48,\n            contents: [\n              {\n                type: 'horizontal-gene-annotations',\n                uid: 'genes',\n                height: 48,\n                server: 'https://resgen.io/api/v1',\n                tilesetUid: 'NCifnbrKQu6j-ohVWJLoJw',\n                options: {\n                  fontSize: 9,\n                  plusStrandColor: 'black',\n                  minusStrandColor: 'black',\n                  geneAnnotationHeight: 10,\n                  geneLabelPosition: 'outside',\n                  geneStrandSpacing: 0.5,\n                  showMousePosition: true,\n                  showGlobalMousePosition: true,\n                  mousePositionColor: 'black',\n                },\n              },\n              {\n                type: 'tss',\n                uid: 'tss',\n                height: 48,\n                // server: 'http://localhost:9876/api/v1',\n                // tilesetUid: 'RefSeqCurated170308bedCollapsedGeneBoundsTSS500bp',\n                server: 'https://resgen.io/api/v1',\n                tilesetUid: 'VMZDLKrtQDmJMSjg7Ds4yA',\n                options: {\n                  fontSize: 9,\n                  plusStrandColor: 'black',\n                  minusStrandColor: 'black',\n                  geneAnnotationHeight: 12,\n                  geneLabelPosition: 'outside',\n                  geneStrandSpacing: 2,\n                },\n              },\n              {\n                uid: 'viewport-details-genes',\n                type: 'viewport-projection-horizontal',\n                fromViewUid: 'details',\n                height: 48,\n                options: {\n                  projectionFillColor: '#cc0078',\n                  projectionStrokeColor: '#cc0078',\n                  projectionFillOpacity: 0.3,\n                  projectionStrokeOpacity: 0.3,\n                  strokeWidth: 1,\n                },\n              },\n            ],\n          },\n          {\n            type: 'combined',\n            uid: 'variants',\n            height: 32,\n            contents: [\n              {\n                type: 'point-annotation',\n                uid: 'ibd-snps',\n                // server: 'http://localhost:9876/api/v1',\n                // tilesetUid: 'IBDCombinedset1-2variantonly-pval',\n                server: 'https://resgen.io/api/v1',\n                tilesetUid: 'VF5-RDXWTxidGMJU7FeaxA',\n                height: 32,\n                options: {\n                  axisPositionHorizontal: 'right',\n                  markColor: 'black',\n                  markColorFocus: '#cc0078',\n                  markSize: 2,\n                  markOpacity: 0.33,\n                  markOpacityFocus: 0.66,\n                  // axisPositionHorizontal: 'right',\n                  valueColumn: 7,\n                  focusRegion: [\n                    1680373143 + 81046453 - 25,\n                    1680373143 + 81046453 + 25,\n                  ],\n                  name: 'IBD Variants',\n                  labelPosition: 'topLeft',\n                  labelColor: '#757575',\n                  showMousePosition: true,\n                  showGlobalMousePosition: true,\n                  mousePositionColor: 'black',\n                  toolTip: {\n                    name: {\n                      field: 3,\n                    },\n                    value: {\n                      field: 6,\n                      numDecimals: 2,\n                    },\n                    other: [\n                      {\n                        label: 'Post. Prob.',\n                        field: 7,\n                        numDecimals: 2,\n                      },\n                    ],\n                  },\n                },\n              },\n            ],\n          },\n          {\n            type: 'combined',\n            uid: 'arcs-stacked-bars',\n            height: 72,\n            contents: [\n              {\n                type: '1d-arcs',\n                uid: 'arcs',\n                server: 'https://resgen.io/api/v1',\n                tilesetUid: 'GOxTKzoLSsuw0BaG6eBrXw',\n                height: 72,\n                options: {\n                  labelPosition: 'hidden',\n                  strokeColor: '#808080',\n                  strokeWidth: 1,\n                  strokeOpacity: 0.05,\n                  arcStyle: 'circle',\n                  startField: 1,\n                  endField: 4,\n                  filter: {\n                    set: SAMPLES,\n                    field: 10,\n                  },\n                },\n              },\n              {\n                type: 'stacked-bar',\n                // server: 'http://localhost:9876/api/v1',\n                // tilesetUid: 'AllPredictionsAvgHiCABC0015minus150ForABCPaperV2hg19beddb',\n                server: 'https://resgen.io/api/v1',\n                // tilesetUid: 'P0Ng5fhvQWeO7dlpx0FknA', // all chroms\n                // tilesetUid: 'PGXLE50tQyOayNXKUnX4fQ', // just chr10\n                // tilesetUid: 'AaJojHeORzKyiag1pSlAag', // bed\n                tilesetUid: 'GOxTKzoLSsuw0BaG6eBrXw', // improved bed\n                height: 72,\n                uid: 'stacked-bars',\n                options: {\n                  binSize: 4,\n                  axisAlign: 'right',\n                  axisPositionHorizontal: 'right',\n                  labelPosition: 'topLeft',\n                  markColor: 'black',\n                  markColorFocus: '#cc0078',\n                  markSize: 4,\n                  markOpacity: 0.33,\n                  labelColor: 'black',\n                  offsetField: 3,\n                  startField: 4,\n                  endField: 5,\n                  importanceField: 7,\n                  importanceDomain: [0, 1],\n                  focusRegion: [\n                    1680373143 + 81046453 - 25,\n                    1680373143 + 81046453 + 25,\n                  ],\n                  name: 'Enhancer regions',\n                  stratification: DEFAULT_STRATIFICATION,\n                  showMousePosition: true,\n                  showGlobalMousePosition: true,\n                  mousePositionColor: 'black',\n                },\n              },\n            ],\n          },\n          {\n            type: 'stratified-bed',\n            // server: 'http://localhost:9876/api/v1',\n            // tilesetUid: 'AllPredictionsAvgHiCABC0015minus150ForABCPaperV2hg19beddb',\n            server: 'https://resgen.io/api/v1',\n            // tilesetUid: 'P0Ng5fhvQWeO7dlpx0FknA', // all chroms\n            // tilesetUid: 'PGXLE50tQyOayNXKUnX4fQ', // just chr10\n            // tilesetUid: 'AaJojHeORzKyiag1pSlAag', // bed\n            tilesetUid: 'GOxTKzoLSsuw0BaG6eBrXw', // improved bed\n            height: 413,\n            uid: 'indicatorByCellTypes',\n            options: {\n              axisAlign: 'right',\n              legendAlign: 'left',\n              labelPosition: 'hidden',\n              markColor: 'black',\n              markColorHighlight: '#bf0071',\n              markColorDehighlight: '#bbbbbb',\n              markSize: 4,\n              markMinWidth: 4,\n              markHeight: 3,\n              rowHeight: 3,\n              markOpacity: 0.33,\n              arcStyle: 'indicator',\n              indicatorStyle: 'category-rect',\n              labelColor: 'black',\n              geneField: 6,\n              importanceField: 7,\n              importanceDomain: [0, 1],\n              // focusRegion: [\n              //   1680373143 + 81046453 - 25,\n              //   1680373143 + 81046453 + 25,\n              // ],\n              name: 'By Celltype',\n              axisPositionHorizontal: 'right',\n              stratification: DEFAULT_STRATIFICATION,\n              showMousePosition: true,\n              showGlobalMousePosition: true,\n              mousePositionColor: 'black',\n            },\n          },\n        ],\n      },\n      overlays: [\n        {\n          uid: 'region-focus',\n          includes: [\n            'chroms-viewport',\n            'genes-tss-viewport',\n            'variants',\n            'arcs-stacked-bars',\n            'indicatorByCellTypes',\n          ],\n          options: {\n            extent: [[1680373143 + 81046453, 1680373143 + 81046454]],\n            minWidth: 3,\n            fill: '#cc0078',\n            fillOpacity: 0.05,\n            strokeWidth: 0,\n            outline: '#cc0078',\n            outlineOpacity: 0.33,\n            outlineWidth: 1,\n            outlinePos: ['left', 'right'],\n          },\n        },\n        {\n          uid: 'gene-focus',\n          includes: ['genes-tss-viewport'],\n          options: {\n            extent: [],\n            minWidth: 3,\n            fill: '#cc0078',\n            fillOpacity: 0.25,\n            stroke: '#cc0078',\n            strokeWidth: 0,\n            outlineWidth: 0,\n          },\n        },\n        {\n          uid: 'tss-overlays',\n          includes: [\n            'chroms',\n            'genes-tss-viewport',\n            'variants',\n            'arcs-stacked-bars',\n            'indicatorByCellTypes',\n          ],\n          options: {\n            extent: [],\n            minWidth: 1,\n            fill: 'black',\n            fillOpacity: 0.05,\n            strokeWidth: 0,\n            outline: 'black',\n            outlineOpacity: 0.1,\n            outlineWidth: 1,\n            outlinePos: ['left'],\n          },\n        },\n      ],\n      metaTracks: [\n        {\n          uid: 'tss-overlays-meta',\n          type: 'annotation-overlay',\n          overlaysTrack: 'tss-overlays',\n          options: {\n            annotationTracks: ['tss'],\n          },\n        },\n      ],\n      layout: {\n        w: 12,\n        h: 12,\n        x: 0,\n        y: 0,\n      },\n      initialXDomain: [DEFAULT_X_DOMAIN_START, DEFAULT_X_DOMAIN_END],\n      initialYDomain: [DEFAULT_X_DOMAIN_START, DEFAULT_X_DOMAIN_END],\n    },\n  ],\n};\n\nexport const DEFAULT_DNA_ACCESSIBILITY_ROW_SELECTION = [\n  120,\n  36,\n  54,\n  20,\n  80,\n  35,\n  101,\n  49,\n  44,\n  23,\n  30,\n  66,\n  5,\n  26,\n  15,\n  105,\n  57,\n  56,\n  74,\n  84,\n  79,\n  93,\n  106,\n  107,\n  34,\n  28,\n  25,\n  55,\n  121,\n  94,\n  58,\n  69,\n  67,\n  63,\n  126,\n  71,\n  72,\n  47,\n  11,\n  46,\n  39,\n  113,\n  29,\n  60,\n  45,\n  76,\n  21,\n  103,\n  129,\n  13,\n  128,\n  90,\n  104,\n  32,\n  109,\n  27,\n  9,\n  130,\n  95,\n  86,\n  53,\n  73,\n  50,\n  48,\n  78,\n  14,\n  92,\n  124,\n  31,\n  114,\n  64,\n  88,\n  12,\n  10,\n  38,\n  68,\n  3,\n  111,\n  70,\n  22,\n  61,\n  98,\n  6,\n  123,\n  118,\n  43,\n  37,\n  65,\n  81,\n  62,\n  33,\n  1,\n  24,\n  122,\n  83,\n  75,\n  112,\n  40,\n  97,\n  16,\n  117,\n  87,\n  19,\n  125,\n  7,\n  102,\n  116,\n  77,\n  8,\n  17,\n  82,\n  115,\n  89,\n  119,\n  18,\n  4,\n  108,\n  59,\n  127,\n  91,\n  0,\n  100,\n  85,\n  110,\n  99,\n  2,\n  96,\n  51,\n  41,\n  52,\n  42,\n];\n\nexport const DEFAULT_DNA_ACCESSIBILITY_ROW_CATEGORIES = DEFAULT_STRATIFICATION.groups.reduce(\n  (row, group, index) => {\n    const category = {\n      label: group.label,\n      color: group.axisLabelColor,\n      background: group.axisLabelBackground,\n      index,\n    };\n    group.categories.forEach((sample) => {\n      row[sample] = category;\n    });\n    return row;\n  },\n  {}\n);\n\nexport const DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY = {\n  zoomFixed: false,\n  editable: false,\n  trackSourceServers: ['//higlass.io/api/v1'],\n  views: [\n    {\n      uid: 'details',\n      chromInfoPath: '//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv',\n      tracks: {\n        top: [\n          {\n            uid: 'chroms',\n            type: 'horizontal-chromosome-labels',\n            server: 'https://resgen.io/api/v1',\n            tilesetUid: 'ADfY_RtsQR6oKOMyrq6qhw',\n            height: 17,\n            options: {\n              // tickPositions: 'ends',\n              color: '#999999',\n              stroke: 'white',\n              fontSize: 10,\n              fontIsLeftAligned: true,\n              showMousePosition: false,\n              mousePositionColor: '#000000',\n            },\n          },\n          {\n            uid: 'genes',\n            type: 'horizontal-gene-annotations',\n            server: 'https://resgen.io/api/v1',\n            tilesetUid: 'NCifnbrKQu6j-ohVWJLoJw',\n            height: 48,\n            options: {\n              fontSize: 9,\n              plusStrandColor: 'black',\n              minusStrandColor: 'black',\n              geneAnnotationHeight: 10,\n              geneLabelPosition: 'outside',\n              geneStrandSpacing: 0.5,\n              showMousePosition: true,\n              showGlobalMousePosition: true,\n              mousePositionColor: 'black',\n            },\n          },\n          {\n            type: 'combined',\n            uid: 'variants',\n            height: 32,\n            contents: [\n              {\n                type: 'point-annotation',\n                uid: 'ibd-snps',\n                // server: 'http://localhost:9876/api/v1',\n                // tilesetUid: 'IBDCombinedset1-2variantonly-pval',\n                server: 'https://resgen.io/api/v1',\n                tilesetUid: 'VF5-RDXWTxidGMJU7FeaxA',\n                height: 32,\n                options: {\n                  axisPositionHorizontal: 'right',\n                  markColor: 'black',\n                  markColorFocus: '#cc0078',\n                  markSize: 2,\n                  markOpacity: 0.33,\n                  markOpacityFocus: 0.66,\n                  // axisPositionHorizontal: 'right',\n                  valueColumn: 7,\n                  focusRegion: [\n                    1680373143 + 81046453 - 25,\n                    1680373143 + 81046453 + 25,\n                  ],\n                  name: 'IBD Variants',\n                  labelPosition: 'topLeft',\n                  labelColor: '#757575',\n                  showMousePosition: true,\n                  showGlobalMousePosition: true,\n                  mousePositionColor: 'black',\n                  toolTip: {\n                    name: {\n                      field: 3,\n                    },\n                    value: {\n                      field: 6,\n                      numDecimals: 2,\n                    },\n                    other: [\n                      {\n                        label: 'Post. Prob.',\n                        field: 7,\n                        numDecimals: 2,\n                      },\n                    ],\n                  },\n                },\n              },\n            ],\n          },\n          {\n            uid: 'dna-accessibility',\n            type: 'ridge-plot',\n            // server: 'http://localhost:9876/api/v1',\n            // tilesetUid: 'test',\n            server: 'https://resgen.io/api/v1',\n            tilesetUid: 'Uz1_tEABQf-uzktblvBKSQ',\n            // height: 403,\n            height: 131 * (24 - 6) + 6,\n            options: {\n              name: 'DNA Accessibility',\n              labelPosition: 'outerBottom',\n              labelShowResolution: false,\n              labelShowAssembly: false,\n              markArea: true,\n              markColor: '#444444',\n              markResolution: 256,\n              valueScaling: 'exponential',\n              colorRange: ['#ffffff', '#000000'],\n              rowHeight: 24,\n              rowPadding: -6,\n              rowNormalization: true,\n              rowSelections: DEFAULT_DNA_ACCESSIBILITY_ROW_SELECTION,\n              rowIdToCategory: {\n                fn: 'replace',\n                args: ['.accessibility', ''],\n              },\n              rowCategories: DEFAULT_DNA_ACCESSIBILITY_ROW_CATEGORIES,\n              showRowLabels: true,\n              rowLabelSize: 10,\n              showMousePosition: true,\n              showGlobalMousePosition: true,\n              mousePositionColor: 'black',\n            },\n          },\n        ],\n      },\n      overlays: [\n        {\n          uid: 'region-focus',\n          includes: ['chroms', 'genes', 'variants', 'dna-accessibility'],\n          options: {\n            extent: [],\n            minWidth: 3,\n            fill: '#cc0078',\n            fillOpacity: 0.05,\n            strokeWidth: 0,\n            outline: '#cc0078',\n            outlineOpacity: 0.33,\n            outlineWidth: 1,\n            outlinePos: ['left', 'right'],\n          },\n        },\n      ],\n      layout: {\n        w: 12,\n        h: 12,\n        x: 0,\n        y: 0,\n      },\n      initialXDomain: [\n        1680373143 + 81046453 - 500,\n        1680373143 + 81046454 + 500,\n      ],\n      initialYDomain: [\n        1680373143 + 81046453 - 500,\n        1680373143 + 81046454 + 500,\n      ],\n    },\n  ],\n};\n","import { atom, selector } from 'recoil';\nimport { memoize } from 'lodash-es';\nimport { deepClone, identity } from '@flekschas/utils';\n\nimport {\n  useRecoilQueryString,\n  useRecoilQueryStringSyncher,\n} from './use-query-string';\n\nimport {\n  booleanQueryStringDecoder,\n  customBooleanQueryStringDecoder,\n  getQueryStringValue,\n  toAbsPosition,\n} from './utils';\n\nimport {\n  DEFAULT_X_DOMAIN_START,\n  DEFAULT_X_DOMAIN_END,\n  DEFAULT_VARIANT_TRACKS,\n  DEFAULT_VARIANT_TRACK_SERVER_ABBR,\n  DEFAULT_VARIANT_TRACK_PVAL_COL,\n  DEFAULT_VARIANT_TRACK_PPROB_COL,\n  VARIANT_TRACK_ABBR_TO_SERVER,\n  VARIANT_TRACK_SERVER_TO_ABBR,\n  GROUPED_SAMPLE_OPTIONS,\n  SAMPLES,\n} from './constants';\n\nconst getDefault = (key, initialValue, decoder) => {\n  const qVal = getQueryStringValue(key, decoder);\n  return qVal === undefined ? initialValue : qVal;\n};\n\nconst chrPosUrlEncoder = (chrPos) =>\n  chrPos ? chrPos.replace(':', '.') : chrPos;\n\nconst chrPosUrlDecoder = (chrPos) =>\n  chrPos ? chrPos.replace('.', ':') : chrPos;\n\nconst showWelcomeDecoder = customBooleanQueryStringDecoder(['intro']);\n\nconst variantTracksDecoder = (v) => {\n  if (!v) return undefined;\n\n  // tilesetId:rg:7:8\n  const [\n    tilesetUid,\n    serverAbbr = DEFAULT_VARIANT_TRACK_SERVER_ABBR,\n    columnPvalue = DEFAULT_VARIANT_TRACK_PVAL_COL,\n    columnPosteriorProbability = DEFAULT_VARIANT_TRACK_PPROB_COL,\n  ] = v.split(':');\n\n  const server = VARIANT_TRACK_ABBR_TO_SERVER[serverAbbr];\n\n  if (tilesetUid === undefined) return tilesetUid;\n\n  return [\n    {\n      server,\n      tilesetUid,\n      columnPvalue,\n      columnPosteriorProbability,\n      markColor: 'black',\n    },\n  ];\n};\n\nconst variantTracksEncoder = (v) => {\n  if (!v || !Array.isArray(v) || v.length > 1) return '';\n\n  const { tilesetUid } = v[0];\n  const serverAbbr =\n    VARIANT_TRACK_SERVER_TO_ABBR[v[0].server] ===\n    DEFAULT_VARIANT_TRACK_SERVER_ABBR\n      ? null\n      : VARIANT_TRACK_SERVER_TO_ABBR[v[0].server];\n  const pValCol =\n    v[0].columnPvalue === DEFAULT_VARIANT_TRACK_PVAL_COL\n      ? null\n      : v[0].columnPvalue;\n  const pProbCol =\n    v[0].columnPosteriorProbability === DEFAULT_VARIANT_TRACK_PPROB_COL\n      ? null\n      : v[0].columnPosteriorProbability;\n\n  if (!tilesetUid || serverAbbr === undefined) return '';\n\n  return [tilesetUid, serverAbbr, pValCol, pProbCol].filter(identity).join(':');\n};\n\n// Atoms\nexport const sampleFilterState = atom({\n  key: 'sampleFilterState',\n  default: '',\n});\n\nexport const sampleSelectionState = selector({\n  key: 'sampleSelection',\n  get: ({ get }) => SAMPLES.map((name) => get(sampleWithName(name)).checked),\n});\n\nexport const selectedSamplesState = selector({\n  key: 'selectedSamples',\n  get: ({ get }) => SAMPLES.filter((name) => get(sampleWithName(name)).checked),\n});\n\nexport const sampleWithName = memoize((name) =>\n  atom({\n    key: `sample-${name}`,\n    default: {\n      checked: true,\n      visible: true,\n    },\n  })\n);\n\nexport const sampleGroupWithGroup = memoize(\n  (group) =>\n    atom({\n      key: `sampleGroup-${group.name}`,\n      default: {\n        checked: true,\n        visible: true,\n        n: group.options.length,\n        N: group.options.length,\n      },\n    }),\n  (group) => group.name\n);\n\nexport const sampleGroupSelectionSizesState = selector({\n  key: 'sampleGroupSelectionSizes',\n  get: ({ get }) =>\n    GROUPED_SAMPLE_OPTIONS.reduce((sizes, group) => {\n      sizes[group.name] = get(sampleGroupWithGroup(group)).n;\n      return sizes;\n    }, {}),\n});\n\nexport const variantTracksState = atom({\n  key: 'variantTracks',\n  default: getDefault(\n    'vt',\n    deepClone(DEFAULT_VARIANT_TRACKS),\n    variantTracksDecoder\n  ),\n});\n\nexport const showVariantsSettingsState = atom({\n  key: 'showVariantsSettings',\n  default: false,\n});\n\nexport const showWelcomeState = atom({\n  key: 'showWelcome',\n  default: getDefault('w', true, showWelcomeDecoder),\n});\n\nexport const dnaAccessLabelStyleState = atom({\n  key: 'dnaAccessLabelStyle',\n  default: getDefault('dal', 'indicator'),\n});\n\nexport const dnaAccessRowNormState = atom({\n  key: 'dnaAccessRowNorm',\n  default: getDefault('darn', true, booleanQueryStringDecoder),\n});\n\nexport const dnaAccessLabelShowInfoState = atom({\n  key: 'dnaAccessLabelShowInfos',\n  default: getDefault('dai', true, booleanQueryStringDecoder),\n});\n\nexport const focusGeneState = atom({\n  key: 'focusGene',\n  default: getDefault('g', ''),\n});\n\nexport const focusGeneOptionState = atom({\n  key: 'focusGeneOption',\n  default: null,\n});\n\nexport const focusVariantState = atom({\n  key: 'focusVariant',\n  default: getDefault('v', 'rs1250566'),\n});\n\nexport const focusVariantOptionState = atom({\n  key: 'focusVariantOption',\n  default: null,\n});\n\nexport const focusRegionOptionState = atom({\n  key: 'focusRegionOption',\n  default: null,\n});\n\nexport const variantYScaleState = atom({\n  key: 'variantYScale',\n  default: getDefault('vy', 'pValue'),\n});\n\nexport const enhancerRegionsHideUnfocusedState = atom({\n  key: 'enhancerRegionsHideUnfocused',\n  default: getDefault('erhu', false, booleanQueryStringDecoder),\n});\n\nexport const enhancerRegionsColorEncodingState = atom({\n  key: 'enhancerRegionsColorEncoding',\n  default: getDefault('erc', 'solid'),\n});\n\nexport const enhancerRegionsShowInfoState = atom({\n  key: 'enhancerRegionsShowInfos',\n  default: getDefault('eri', true, booleanQueryStringDecoder),\n});\n\nexport const enhancerGenesShowInfoState = atom({\n  key: 'enhancerGenesShowInfos',\n  default: getDefault('egi', true, booleanQueryStringDecoder),\n});\n\nexport const enhancerGenesPaddingState = atom({\n  key: 'enhancerGenesPadding',\n  default: getDefault('egp', false, booleanQueryStringDecoder),\n});\n\nexport const enhancerGenesCellEncodingState = atom({\n  key: 'enhancerGenesCellEncoding',\n  default: getDefault('egce', 'number'),\n});\n\nexport const enhancerGenesSvgState = atom({\n  key: 'enhancerGenesSvg',\n  default: null,\n});\nexport const higlassEnhancerRegionsState = atom({\n  key: 'higlassEnhancerRegions',\n  default: null,\n});\n\nexport const higlassDnaAccessState = atom({\n  key: 'higlassDnaAccess',\n  default: null,\n});\n\n// Dynamic state\nexport const xDomainStartWithAssembly = memoize(\n  (chromInfo) =>\n    atom({\n      key: `xDomainStart-${chromInfo.totalLength}`,\n      default: getDefault(\n        'xs',\n        chromInfo.absToChr(DEFAULT_X_DOMAIN_START).slice(0, 2).join(':'),\n        chrPosUrlDecoder\n      ),\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\nexport const xDomainEndWithAssembly = memoize(\n  (chromInfo) =>\n    atom({\n      key: `xDomainEnd-${chromInfo.totalLength}`,\n      default: getDefault(\n        'xe',\n        chromInfo.absToChr(DEFAULT_X_DOMAIN_END).slice(0, 2).join(':'),\n        chrPosUrlDecoder\n      ),\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\n// Derived state\nexport const xDomainStartAbsWithAssembly = memoize(\n  (chromInfo) =>\n    selector({\n      key: `xDomainStartAbs-${chromInfo.totalLength}`,\n      get: ({ get }) => {\n        const xDomainStart = get(xDomainStartWithAssembly(chromInfo));\n        return toAbsPosition(xDomainStart, chromInfo);\n      },\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\nexport const xDomainEndAbsWithAssembly = memoize(\n  (chromInfo) =>\n    selector({\n      key: `xDomainEndAbs-${chromInfo.totalLength}`,\n      get: ({ get }) => {\n        const xDomainEnd = get(xDomainEndWithAssembly(chromInfo));\n        return toAbsPosition(xDomainEnd, chromInfo);\n      },\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\nexport const focusGeneStartWithAssembly = memoize(\n  (chromInfo) =>\n    selector({\n      key: `focusGeneStart-${chromInfo.totalLength}`,\n      get: ({ get }) => {\n        const focusGeneOption = get(focusGeneOptionState);\n        return focusGeneOption\n          ? toAbsPosition(\n              `${focusGeneOption.chr}:${focusGeneOption.txStart}`,\n              chromInfo\n            )\n          : null;\n      },\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\nexport const focusGeneEndWithAssembly = memoize(\n  (chromInfo) =>\n    selector({\n      key: `focusGeneEnd-${chromInfo.totalLength}`,\n      get: ({ get }) => {\n        const focusGeneOption = get(focusGeneOptionState);\n        return focusGeneOption\n          ? toAbsPosition(\n              `${focusGeneOption.chr}:${focusGeneOption.txEnd}`,\n              chromInfo\n            )\n          : null;\n      },\n    }),\n  (chromInfo) => chromInfo.totalLength\n);\n\nexport const focusVariantPositionWithAssembly = memoize((chromInfo) =>\n  selector({\n    key: `focusVariantPosition-${chromInfo.totalLength}`,\n    get: ({ get }) => {\n      const focusVariantOption = get(focusVariantOptionState);\n      return focusVariantOption\n        ? toAbsPosition(\n            `${focusVariantOption.chr}:${focusVariantOption.txStart}`,\n            chromInfo\n          )\n        : null;\n    },\n  })\n);\n\nexport const focusVariantRelPositionState = selector({\n  key: 'focusVariantRelPosition',\n  get: ({ get }) => {\n    const focusVariantOption = get(focusVariantOptionState);\n    return focusVariantOption ? +focusVariantOption.txStart : null;\n  },\n});\n\nexport const focusVariantStrPositionState = selector({\n  key: 'focusVariantStrPosition',\n  get: ({ get }) => {\n    const focusVariantOption = get(focusVariantOptionState);\n    return focusVariantOption\n      ? `${focusVariantOption.chr}:${focusVariantOption.txStart}`\n      : null;\n  },\n});\n\n// Predefined hooks\nexport const useVariantTracks = () =>\n  useRecoilQueryString('vt', variantTracksState, variantTracksEncoder);\nexport const useVariantTracksSyncher = () =>\n  useRecoilQueryStringSyncher('vt', variantTracksState, variantTracksEncoder);\n\nexport const useShowWelcome = () => useRecoilQueryString('w', showWelcomeState);\nexport const useShowWelcomeSyncher = () =>\n  useRecoilQueryStringSyncher('w', showWelcomeState);\n\nexport const useFocusGene = () => useRecoilQueryString('g', focusGeneState);\nexport const useFocusGeneSyncher = () =>\n  useRecoilQueryStringSyncher('g', focusGeneState);\n\nexport const useFocusVariant = () =>\n  useRecoilQueryString('v', focusVariantState);\nexport const useFocusVariantSyncher = () =>\n  useRecoilQueryStringSyncher('v', focusVariantState);\n\nexport const useDnaAccessLabelStyle = () =>\n  useRecoilQueryString('dal', dnaAccessLabelStyleState);\nexport const useDnaAccessLabelStyleSyncher = () =>\n  useRecoilQueryStringSyncher('dal', dnaAccessLabelStyleState);\n\nexport const useDnaAccessRowNorm = () =>\n  useRecoilQueryString('darn', dnaAccessRowNormState);\nexport const useDnaAccessRowNormSyncher = () =>\n  useRecoilQueryStringSyncher('darn', dnaAccessRowNormState);\n\nexport const useDnaAccessShowInfos = () =>\n  useRecoilQueryString('dai', dnaAccessLabelShowInfoState);\nexport const useDnaAccessShowInfosSyncher = () =>\n  useRecoilQueryStringSyncher('dai', dnaAccessLabelShowInfoState);\n\nexport const useXDomainStartWithAssembly = (chromInfo) =>\n  useRecoilQueryString(\n    's',\n    xDomainStartWithAssembly(chromInfo),\n    chrPosUrlEncoder\n  );\nexport const useXDomainStartWithAssemblySyncher = (chromInfo) =>\n  useRecoilQueryStringSyncher(\n    's',\n    xDomainStartWithAssembly(chromInfo),\n    chrPosUrlEncoder\n  );\n\nexport const useXDomainEndWithAssembly = (chromInfo) =>\n  useRecoilQueryString(\n    'e',\n    xDomainEndWithAssembly(chromInfo),\n    chrPosUrlEncoder\n  );\nexport const useXDomainEndWithAssemblySyncher = (chromInfo) =>\n  useRecoilQueryStringSyncher(\n    'e',\n    xDomainEndWithAssembly(chromInfo),\n    chrPosUrlEncoder\n  );\n\nexport const useEnhancerRegionsShowInfos = () =>\n  useRecoilQueryString('eri', enhancerRegionsShowInfoState);\nexport const useEnhancerRegionsShowInfosSyncher = () =>\n  useRecoilQueryStringSyncher('eri', enhancerRegionsShowInfoState);\n\nexport const useEnhancerRegionsHideUnfocused = () =>\n  useRecoilQueryString('eri', enhancerRegionsHideUnfocusedState);\nexport const useEnhancerRegionsHideUnfocusedSyncher = () =>\n  useRecoilQueryStringSyncher('eri', enhancerRegionsHideUnfocusedState);\n\nexport const useEnhancerRegionsColorEncoding = () =>\n  useRecoilQueryString('eri', enhancerRegionsColorEncodingState);\nexport const useEnhancerRegionsColorEncodingSyncher = () =>\n  useRecoilQueryStringSyncher('eri', enhancerRegionsColorEncodingState);\n\nexport const useEnhancerGenesShowInfos = () =>\n  useRecoilQueryString('egi', enhancerGenesShowInfoState);\nexport const useEnhancerGenesShowInfosSyncher = () =>\n  useRecoilQueryStringSyncher('egi', enhancerGenesShowInfoState);\n\nexport const useEnhancerGenesPadding = () =>\n  useRecoilQueryString('egp', enhancerGenesPaddingState);\nexport const useEnhancerGenesPaddingSyncher = () =>\n  useRecoilQueryStringSyncher('egp', enhancerGenesPaddingState);\n\nexport const useEnhancerGenesCellEncoding = () =>\n  useRecoilQueryString('egce', enhancerGenesCellEncodingState);\nexport const useEnhancerGenesCellEncodingSyncher = () =>\n  useRecoilQueryStringSyncher('egce', enhancerGenesCellEncodingState);\n\nexport const useVariantYScale = () =>\n  useRecoilQueryString('vs', variantYScaleState);\nexport const useVariantYScaleSyncher = () =>\n  useRecoilQueryStringSyncher('vs', variantYScaleState);\n","import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { deepClone } from '@flekschas/utils';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport TextField from '@material-ui/core/TextField';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport FileInput from './FileInput';\nimport { useChromInfo } from './ChromInfoProvider';\nimport createLocalBedDataServer from './local-bed-data-server';\n\nimport { useFocusVariant, useVariantTracks } from './state';\n\nimport { LOCAL_BED_TILESET_INFO_HG19 } from './constants';\n\nconst useStyles = makeStyles((theme) => ({\n  note: {\n    color: theme.palette.grey['400'],\n    marginTop: '1em',\n  },\n  title: {\n    fontSize: '1.5rem',\n    fontWeight: 700,\n    margin: '0.5rem 0 0 0',\n  },\n  buttonNormal: {\n    minWidth: '10.5rem',\n    margin: '0 0.5rem',\n  },\n  buttonActive: {\n    minWidth: '10.5rem',\n    marginLeft: '0.5rem',\n    color: 'white',\n    background: '#cc0078 linear-gradient(45deg, #cc0078 30%, #cc0066 90%)',\n    boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .3)',\n    '&:hover': {\n      boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .5)',\n      background: '#d90080 linear-gradient(45deg, #d90080 30%, #d9006c 90%)',\n    },\n    '&:focus': {\n      boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .5)',\n    },\n  },\n  trackList: {\n    margin: '16px 0',\n  },\n}));\n\nconst useStylesTrackConfig = makeStyles((theme) => ({\n  icon: {\n    color: theme.palette.grey['400'],\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  grow: {\n    flex: 1,\n  },\n  separator: {\n    padding: '0 8px',\n  },\n  server: {\n    flex: 1,\n    marginRight: '2px',\n  },\n  tilesetUid: {\n    flex: 1,\n    marginLeft: '2px',\n  },\n  propInput: {\n    flex: 1,\n    marginLeft: '2px',\n    marginRight: '2px',\n    '&:first-child': {\n      marginLeft: 0,\n    },\n    '&:last-child': {\n      marginRight: 0,\n    },\n  },\n}));\n\nconst useStylesTooltipVisible = makeStyles((theme) => ({\n  arrow: {\n    color: 'black',\n  },\n  tooltip: {\n    backgroundColor: 'black',\n  },\n}));\n\nconst useStylesTooltipHidden = makeStyles((theme) => ({\n  tooltip: {\n    display: 'none',\n  },\n}));\n\nconst TrackConfig = React.memo(function TrackConfig({ config, onChange }) {\n  const [state, setState] = useState(config);\n\n  const propertyChangeHandler = (property) => (event) => {\n    // eslint-disable-next-line prefer-destructuring\n    const value = event.target.value;\n    setState((currState) => ({\n      ...currState,\n      [property]: value,\n    }));\n  };\n\n  const serverChangeHandler = (event) => {\n    const server = event.target.value;\n    setState((currState) => ({\n      ...currState,\n      server,\n      file: undefined,\n    }));\n  };\n\n  const tilesetUidChangeHandler = (event) => {\n    const tilesetUid = event.target.value;\n    setState((currState) => ({\n      ...currState,\n      tilesetUid,\n      file: undefined,\n    }));\n  };\n\n  const fileChangeHandler = (file) => {\n    setState((currState) => ({\n      ...currState,\n      file,\n      server: undefined,\n      tilesetUid: undefined,\n    }));\n  };\n\n  const fileClearHandler = () => {\n    setState((currState) => ({\n      ...currState,\n      file: undefined,\n    }));\n  };\n\n  useEffect(() => {\n    if (state !== config) onChange(state);\n  }, [onChange, state, config]);\n\n  const isRemote = Boolean(state.server || state.tilesetUid);\n  const isLocal = Boolean(state.whatever);\n\n  const classes = useStylesTrackConfig();\n  const classesTooltipVisible = useStylesTooltipVisible();\n  const classesTooltipHidden = useStylesTooltipHidden();\n\n  return (\n    <React.Fragment>\n      <Grid alignItems=\"center\" container>\n        <Grid className={classes.grow} item>\n          <Grid alignItems=\"center\" container>\n            <Tooltip\n              classes={isLocal ? classesTooltipVisible : classesTooltipHidden}\n              title=\"Setting a server will clear the file!\"\n              placement=\"top\"\n              arrow\n            >\n              <TextField\n                label=\"Server URL\"\n                variant=\"outlined\"\n                size=\"small\"\n                value={state.server || ''}\n                onChange={serverChangeHandler}\n                className={classes.server}\n              />\n            </Tooltip>\n            <Tooltip\n              classes={isLocal ? classesTooltipVisible : classesTooltipHidden}\n              title=\"Setting a tileset ID will clear the file!\"\n              placement=\"top\"\n              arrow\n            >\n              <TextField\n                label=\"Tileset ID\"\n                variant=\"outlined\"\n                size=\"small\"\n                value={state.tilesetUid || ''}\n                onChange={tilesetUidChangeHandler}\n                className={classes.tilesetUid}\n              />\n            </Tooltip>\n          </Grid>\n        </Grid>\n        <Grid item>\n          <Typography className={classes.separator}>or</Typography>\n        </Grid>\n        <Grid item>\n          <Tooltip\n            classes={isRemote ? classesTooltipVisible : classesTooltipHidden}\n            title=\"Selecting a file will clear the server and tileset ID!\"\n            placement=\"top\"\n            arrow\n          >\n            <FileInput\n              file={state.file}\n              onChange={fileChangeHandler}\n              onClear={fileClearHandler}\n            />\n          </Tooltip>\n        </Grid>\n      </Grid>\n      <Grid alignItems=\"center\" container>\n        <TextField\n          label=\"Name\"\n          variant=\"outlined\"\n          margin=\"normal\"\n          size=\"small\"\n          value={state.label || ''}\n          onChange={propertyChangeHandler('label')}\n          className={classes.propInput}\n        />\n        <TextField\n          label=\"Column P-Value\"\n          variant=\"outlined\"\n          margin=\"normal\"\n          size=\"small\"\n          type=\"number\"\n          min=\"1\"\n          step=\"1\"\n          value={state.columnPvalue || 7}\n          onChange={propertyChangeHandler('columnPvalue')}\n          className={classes.propInput}\n        />\n        <TextField\n          label=\"Column Post. Prob\"\n          variant=\"outlined\"\n          margin=\"normal\"\n          size=\"small\"\n          type=\"number\"\n          min=\"1\"\n          step=\"1\"\n          value={state.columnPosteriorProbability || 8}\n          onChange={propertyChangeHandler('columnPosteriorProbability')}\n          className={classes.propInput}\n        />\n      </Grid>\n    </React.Fragment>\n  );\n});\n\nconst VariantsSettings = React.memo(function VariantsSettings({\n  closeHandler,\n}) {\n  const chromInfo = useChromInfo();\n\n  const setFocusVariant = useFocusVariant()[1];\n  const [variantTracks, setVariantTracks] = useVariantTracks();\n  const [tmpVariantTracks, setTmpVariantTracks] = useState(() =>\n    deepClone(variantTracks)\n  );\n  const [changed, setChanged] = useState(false);\n  const variantTrackServers = useRef([]);\n  const currVariantTracks = useRef(variantTracks);\n\n  useEffect(() => {\n    currVariantTracks.current = variantTracks;\n  }, [variantTracks]);\n\n  const changeTmpVariantTracks = useCallback(\n    (i) => (newTrackConfig) => {\n      setTmpVariantTracks((currTmpVariantTracks) => {\n        const newTmpVariantTracks = [...currTmpVariantTracks];\n        newTmpVariantTracks[i] = newTrackConfig;\n        return newTmpVariantTracks;\n      });\n      setChanged(true);\n    },\n    []\n  );\n\n  const saveHandler = useCallback(() => {\n    const newVariantTracks = deepClone(tmpVariantTracks);\n\n    // Destroy old servers\n    variantTrackServers.current.forEach((server) => {\n      server.destroy();\n    });\n\n    // Create new servers\n    variantTrackServers.current = newVariantTracks.reduce(\n      (servers, trackConfig) => {\n        if (trackConfig.file) {\n          const tilesetInfo = {\n            ...LOCAL_BED_TILESET_INFO_HG19,\n            name: trackConfig.file,\n          };\n          servers.push(\n            createLocalBedDataServer(\n              trackConfig.file,\n              trackConfig.file.name,\n              chromInfo,\n              tilesetInfo,\n              {\n                header: true,\n                columnImportance: 7,\n              }\n            )\n          );\n        }\n        return servers;\n      },\n      []\n    );\n    setVariantTracks(newVariantTracks);\n    if (\n      newVariantTracks.some(\n        (newTrackConfig, i) =>\n          newTrackConfig.server !== currVariantTracks.current[i].server\n      ) ||\n      newVariantTracks.some(\n        (newTrackConfig, i) =>\n          newTrackConfig.tilesetUid !== currVariantTracks.current[i].tilesetUid\n      ) ||\n      newVariantTracks.some(\n        (newTrackConfig, i) =>\n          newTrackConfig.file !== currVariantTracks.current[i].file\n      )\n    ) {\n      setFocusVariant(null);\n    }\n    closeHandler();\n  }, [\n    chromInfo,\n    tmpVariantTracks,\n    closeHandler,\n    setVariantTracks,\n    setFocusVariant,\n  ]);\n\n  const classes = useStyles();\n\n  return (\n    <React.Fragment>\n      <Typography\n        id=\"title\"\n        align=\"center\"\n        variant=\"h5\"\n        component=\"h2\"\n        noWrap\n        className={classes.title}\n      >\n        Variant Track\n      </Typography>\n      <p id=\"description\">\n        Variants can be loaded from a remote{' '}\n        <code>\n          <a\n            href=\"https://docs.higlass.io/data_preparation.html#bed-files\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            .beddb\n          </a>\n        </code>{' '}\n        or a local <code>.bed</code> file. To access a remote file, please enter\n        the URL of the{' '}\n        <a\n          href=\"https://docs.higlass.io/higlass_server.html\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          HiGlass server\n        </a>{' '}\n        and the track ID. To access a local file please select it with via the\n        file selection.\n      </p>\n      <div className={classes.trackList}>\n        {tmpVariantTracks.map((variantTrackConfig, i) => (\n          <TrackConfig\n            key={i}\n            config={variantTrackConfig}\n            onChange={changeTmpVariantTracks(i)}\n          />\n        ))}\n      </div>\n      <Typography align=\"center\">\n        <Button\n          className={classes.buttonNormal}\n          onClick={closeHandler}\n          variant=\"contained\"\n          disableElevation\n        >\n          Cancel\n        </Button>\n        <Button\n          className={changed ? classes.buttonActive : classes.buttonNormal}\n          onClick={changed ? saveHandler : closeHandler}\n          variant=\"contained\"\n          disableElevation\n        >\n          {changed ? 'Save' : 'Okay'}\n        </Button>\n      </Typography>\n    </React.Fragment>\n  );\n});\n\nexport default VariantsSettings;\n","import Button from '@material-ui/core/Button';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\nimport React from 'react';\nimport { useRecoilValue } from 'recoil';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport Logo from './Logo';\n\nimport { showWelcomeState } from './state';\n\nimport imgEnhancerView1 from './images/enhancer-view-1.png';\nimport imgEnhancerView2 from './images/enhancer-view-2.png';\nimport imgEnhancerView3 from './images/enhancer-view-3.png';\nimport imgEnhancerView4 from './images/enhancer-view-4.png';\nimport imgEnhancerView5 from './images/enhancer-view-5.png';\nimport imgGeneView1 from './images/gene-view-1.png';\nimport imgGeneView2 from './images/gene-view-2.png';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    '&>p': {\n      fontSize: '1.125em',\n    },\n  },\n  title: {\n    display: 'flex',\n    justifyContent: 'center',\n    margin: theme.spacing(2, 0, 3),\n  },\n  note: {\n    color: theme.palette.grey['400'],\n    marginTop: '1em',\n  },\n  icon: {\n    color: theme.palette.grey['400'],\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  showIntro: {\n    minWidth: '10.5rem',\n    marginRight: '0.5rem',\n  },\n  startExploring: {\n    minWidth: '10.5rem',\n    marginLeft: '0.5rem',\n    color: 'white',\n    background: '#cc0078 linear-gradient(45deg, #cc0078 30%, #cc0066 90%)',\n    boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .3)',\n    '&:hover': {\n      boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .5)',\n      background: '#d90080 linear-gradient(45deg, #d90080 30%, #d9006c 90%)',\n    },\n    '&:focus': {\n      boxShadow: '0 1px 6px 1px rgba(255, 76, 151, .5)',\n    },\n  },\n  introTitle: {\n    fontSize: '2.75em',\n    letterSpacing: '-0.075rem',\n    fontWeight: 900,\n    textTransform: 'uppercase',\n    '&+h3': {\n      marginTop: 16,\n    },\n  },\n  introHeadline: {\n    fontSize: '1.5em',\n    fontWeight: 700,\n    margin: theme.spacing(6, 0, 2, 0),\n  },\n  introSubHeadline: {\n    fontSize: '1.125em',\n    fontWeight: 700,\n    margin: theme.spacing(2, 0, 1, 0),\n  },\n  introStartExploring: {\n    margin: theme.spacing(4, 0, 2, 0),\n  },\n  figure: {\n    margin: theme.spacing(4, 6),\n    '& img': {\n      width: '100%',\n      height: 'auto',\n    },\n  },\n}));\n\nconst Welcome = React.memo(function Welcome({\n  closeHandler,\n  openIntroHandler,\n}) {\n  const showWelcome = useRecoilValue(showWelcomeState);\n\n  const classes = useStyles();\n\n  if (showWelcome === 'intro')\n    return (\n      <div className={classes.root}>\n        <Typography\n          id=\"intro-title\"\n          align=\"center\"\n          variant=\"h2\"\n          component=\"h2\"\n          noWrap\n          className={classes.introTitle}\n        >\n          Introduction\n        </Typography>\n        <Typography\n          id=\"intro-enhancer-view\"\n          align=\"center\"\n          variant=\"h3\"\n          component=\"h3\"\n          noWrap\n          className={classes.introHeadline}\n        >\n          1. Enhancer-Centered View\n        </Typography>\n        <p>\n          The goal of this web application is to provide a visual interface to\n          enhancer-gene connections predicted by the{' '}\n          <em>Activity-By-Contact</em> (ABC) model. Enhancers are genomic\n          regions that have the ability to regulate the activity of nearby\n          genes. One way to visualize this regulatory connection is by drawing\n          an arc between the enhancer region and the gene as follows:\n        </p>\n        <figure className={classes.figure}>\n          <img src={imgEnhancerView1} alt=\"Enhancer-Gene Connection Overview\" />\n        </figure>\n        <p>\n          However, enhancers are not always active in every cell type or state.\n          Hence, in reality the looks more like below where <em>Enhancer 1</em>{' '}\n          is entirely inactive in <em>Sample 1</em> while <em>Sample 2</em> is\n          inactive in <em>Sample 3</em>.\n        </p>\n        <figure className={classes.figure}>\n          <img\n            src={imgEnhancerView2}\n            alt=\"Enhancer-Gene Connection By Sample\"\n          />\n        </figure>\n        <p>\n          Since we have predicted enhancer-gene connections across 131 samples,\n          showing all arcs at once or having a separate arc track for each\n          sample is not very effective visually. In other words, it would either\n          be hard to differentiate samples in case we show all arcs in one track\n          or it would be impossible to get a complete overview due the vertical\n          space consumption if we showed a separate arc track for each sample.\n        </p>\n        <p>\n          Therefore, we separately visualize the distribution of outgoing and\n          incoming arcs as shown below. Each sample is represented by a row and\n          an active enhancer region (outgoing arc) is displayed as a rectangle.\n          For the regulated genes, we are drawing a bar that encodes the number\n          of enhancers (i.e., incoming arcs) regulating this gene as the height.\n        </p>\n        <figure className={classes.figure}>\n          <img\n            src={imgEnhancerView3}\n            alt=\"Optimized Enhancer-Gene Connection Representation\"\n          />\n        </figure>\n        <p>\n          While we loose some details (no worries, we will bring those details\n          back), this representation is visually much more scalable. To make\n          this visualization more effective we can sort similar samples into\n          groups and add color to help distinguish between the different sample\n          groups.\n        </p>\n        <figure className={classes.figure}>\n          <img\n            src={imgEnhancerView4}\n            alt=\"Sample-Grouped Enhancer-Gene Connection Representation\"\n          />\n        </figure>\n        <p>\n          As mentioned above, by separetly visualizing the distribution of\n          enhancer regions and the distribution of sample groups regulating\n          genes, we are loosing the information which enhancer region regulates\n          which gene. We're going to bring this information back by allowing you\n          to focus on specific regions and sample groups. For instance, in the\n          following example we focused on <em>Gene 2</em>, which will\n          subsequently highlight all enhancers regulating this gene (shown in\n          pink) and also bring back the arcs to hint at enhancers outside the\n          current field of view.\n        </p>\n        <figure className={classes.figure}>\n          <img\n            src={imgEnhancerView5}\n            alt=\"Focused Enhancer-Gene Connection Representation\"\n          />\n        </figure>\n        <p>\n          In the application there are two ways to enable focusing. First, you\n          can click on one of the following visual elements: a gene, a variant,\n          or an enhancer region. To select a custom focus region you can also\n          brush on the genomic position track. Second, you can search for and\n          enter a gene (e.g., PPIF), variant (e.g., rs1250566), or custom region\n          (e.g., chr1:1-chr2:2, chr10:81230693-80993117, or\n          chr10:81230693+10000) in the search bar at the top.\n        </p>\n        <Typography\n          id=\"intro-enhancer-view-sample-filtering\"\n          align=\"center\"\n          variant=\"h4\"\n          component=\"h4\"\n          noWrap\n          className={classes.introSubHeadline}\n        >\n          Sample Filtering\n        </Typography>\n        <p>\n          In addition to focusing on certain enhancer-gene connections, you can\n          also filter out samples using the list on the side bar. Note that the\n          filtering will be applied to all visualizations including the\n          Gene-Centered View and the DNA Accessibility View.\n        </p>\n        <Typography\n          id=\"intro-enhancer-view-genetic-variations\"\n          align=\"center\"\n          variant=\"h4\"\n          component=\"h4\"\n          noWrap\n          className={classes.introSubHeadline}\n        >\n          Custom Genetic Variations\n        </Typography>\n        <p>\n          To identify critical enhancers, our application includes a track for\n          displaying genetic point variations, e.g., disease risk variants.\n          These variants are visualized as points that are position either by\n          their associated p-value or posterior probability along the y-axis. By\n          default, we show <abbr title=\"\">IBD</abbr>\n          -associated variants but you can load your variants if you like by\n          clicking on <em>Edit Variants</em> in the side bar. There are two\n          options for loading custom variants. You can either specify the URL of\n          a{' '}\n          <a\n            href=\"https://docs.higlass.io/higlass_server.html\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            HiGlass server\n          </a>{' '}\n          (which is the underlying genome browser toolkit we are using) and\n          tileset UUID of your{' '}\n          <a\n            href=\"https://docs.higlass.io/data_preparation.html#bed-files\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            <code>.beddb</code> track\n          </a>\n          . Or you can load a local\n          <a\n            href=\"https://bedtools.readthedocs.io/en/latest/content/general-usage.html#bed-format\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            <code>.bed</code> file\n          </a>{' '}\n          from your computer. Make sure to specify the correct column number for\n          the p-value and posterior probability!\n        </p>\n        <p>\n          <strong>Experimental:</strong> If you want to share a view with a\n          custom variant track with your colleagues can either setup your own\n          HiGlass server or you can use{' '}\n          <a href=\"https://resgen.io\" target=\"_blank\" rel=\"noopener noreferrer\">\n            Resgen.io\n          </a>\n          &mdash;a service for hosting and visualizing genomic data.\n        </p>\n        <Typography\n          id=\"intro-enhancer-view-settings\"\n          align=\"center\"\n          variant=\"h4\"\n          component=\"h4\"\n          noWrap\n          className={classes.introSubHeadline}\n        >\n          Settings\n        </Typography>\n        <p>\n          Finally, you can adjust the color encoding of the rectangles\n          representing enhancer regions via the settings menu (click on{' '}\n          <IconButton size=\"small\" className={classes.icon}>\n            <SettingsIcon fontSize=\"inherit\" />\n          </IconButton>\n          ). By default (<em>Solid</em>) we render rectangles in a solid color\n          whenever a region is predicted to regulate at least one gene.\n          Alternatively you can choose to encode number of regulated genes as\n          the color (<em>Number of predictions</em>). In this case, darker\n          rectangles hint at enhancers that regulate many genes. Additionally,\n          you can also color rectangles by the highest ABC prediction score (\n          <em>Highest prediction score</em>) or the ABC prediction score of the\n          connection to the closest gene (<em>Closest prediction score</em>).\n        </p>\n        <Typography\n          id=\"intro-gene-view\"\n          align=\"center\"\n          variant=\"h3\"\n          component=\"h3\"\n          noWrap\n          className={classes.introHeadline}\n        >\n          2. Gene-Centered View\n        </Typography>\n        <p>\n          Sometimes it can be insightful to gain an overview of all upstream and\n          downstream genes that are regulated by a specific enhancer region.\n          That's what this view is for. In the tabular layout, each row\n          corresponds to a sample group and the columns represent the genes\n          ordered by distance to the enhancer region, which is shown as the\n          center column. Hence, genes to the left are upstream of the enhancer\n          and genes to the right are downstream. The number of genes/columns is\n          limited by the available screen space. For instance, consider the\n          following situation, where the numbers in the cells indicate the\n          number of enhancer-gene connections across the three sample groups.\n        </p>\n        <figure className={classes.figure}>\n          <img src={imgGeneView1} alt=\"Gene-Centered View Setup\" />\n        </figure>\n        <p>\n          To make this view more effective, the cells encode the percentage of\n          samples within a sample group that contain a predicted enhancer-gene\n          connection as the rectangle area.\n        </p>\n        <figure className={classes.figure}>\n          <img src={imgGeneView2} alt=\"Gene-Centered View Visualization\" />\n        </figure>\n        <p>\n          For instance, in the example above, <em>Group A&mdash;Gene 2</em> is\n          the largest rectangle because three out of four sample from{' '}\n          <em>Group A</em> regulate <em>Gene 2</em>. On the other hand,{' '}\n          <em>Group C&mdash;Gene 3</em> is the smallest rectangle because only\n          one out of 5 samples from <em>Group C</em> regulate <em>Gene 3</em>.\n        </p>\n        <p>\n          For more detais on which exact sample contains a prediction you can\n          mouse over a cell.\n        </p>\n        <Typography\n          id=\"intro-gene-view-settings\"\n          align=\"center\"\n          variant=\"h4\"\n          component=\"h4\"\n          noWrap\n          className={classes.introSubHeadline}\n        >\n          Settings\n        </Typography>\n        <p>\n          This view offers a couple of additional cell encoding to provide\n          different perspectives of the gene regulation landscape of a specific\n          enhancer. The rectangle size can also encode the absolute number of\n          predicted enhancer-gene connections by sample group (\n          <em>Abs. number of predictions</em>).\n        </p>\n        <p>\n          Additionally, you can look at the distribution of enhancer-gene\n          connections by their ABC prediction score as a{' '}\n          <a\n            href=\"https://flowingdata.com/2016/09/08/beeswarm-plot-in-r-to-show-distributions/\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            bee swarm plot\n          </a>\n          (<em>Distribution by prediction score</em>). With this setting, each\n          enhancer-gene connection is represented as a small dot and positioned\n          on the cell's y-axis by it's ABC prediction score. The closer the dot\n          is placed to the top of the cell the higher the prediction score. The\n          dots' x position is determined by the number of other dots with a\n          similar prediction score. In other words the more dots stack along a\n          cell's x-axis the more enhancer-gene Connections have the same\n          prediction score.\n        </p>\n        <p>\n          The final visual encoding (<em>Sample array</em>) visualizes\n          enhancer-gene connections as filled cells within an invisible grid\n          where each sample has a fixed position across all genes. Think of a\n          microarray or well plate where each sample allocates a fixed well and\n          lights up when this samples contains a enhancer-gene connection. The\n          benefit of this encoding is that it allows you to quickly scan cross a\n          row to see of the focused enhancer is regulating other genes in the\n          same sample. You can even mouse over a well in the array view and it\n          highlight the well across the entire row.\n        </p>\n        <Typography\n          id=\"intro-dna-accessibility-view\"\n          align=\"center\"\n          variant=\"h3\"\n          component=\"h3\"\n          noWrap\n          className={classes.introHeadline}\n        >\n          3. DNA Accessibility View\n        </Typography>\n        <p>\n          Since the ABC model relies on the DNaseI hypersensitivy, we provide\n          an accompanying view of the DNA accessibility across all samples for\n          quick visual debugging of predicted enhancer regions. The DNase- or\n          ATAC-seq measurements, are visualized as a vertically-stacked list of\n          line charts. Each row corresponds to a sample and the order of samples\n          is the same as in the <em>Enhancer-Centered View</em>. By default,\n          each row is individually normalized to focus on shape similarities\n          rather than the absolute magnitude (i.e., read count). This behavior\n          can be adjusted view the settings.\n        </p>\n        <Typography align=\"center\" className={classes.introStartExploring}>\n          <Button\n            className={classes.startExploring}\n            onClick={closeHandler}\n            variant=\"contained\"\n            disableElevation\n          >\n            Start Exploring!\n          </Button>\n        </Typography>\n        <Typography align=\"center\" className={classes.note}>\n          <em>\n            You can reopen this tutorial by clicking on \"ABC Enhancer-Gene\n            Connections\" in the upper left corner!\n          </em>\n        </Typography>\n      </div>\n    );\n\n  return (\n    <div className={classes.root}>\n      <Typography\n        id=\"title\"\n        align=\"center\"\n        variant=\"h5\"\n        component=\"h2\"\n        noWrap\n        className={classes.title}\n      >\n        <Logo\n          styles={{\n            width: 'auto',\n          }}\n        />\n      </Typography>\n      <p id=\"description\">\n        This web application visualizes genome-wide enhancer-gene connections\n        that were predicted with the <em>Activity-By-Contact</em> (ABC) model.\n        You can interactively browse the entire human genome and filter\n        enhancers by region, gene, or containing variant.\n      </p>\n      <p>\n        For information regarding the ABC model please refer to our initial\n        publication:{' '}\n        <a\n          href=\"https://www.nature.com/articles/s41588-019-0538-0\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          Fulco et al., Activity-by-contact model of enhancerpromoter\n          regulation from thousands of CRISPR perturbations,{' '}\n          <em>Nature Genetics</em> (2019)\n        </a>\n        .\n      </p>\n      <p>\n        For more information about this web application, please click on{' '}\n        <em>Show Introduction</em>. If you find a bug or have a question, please{' '}\n        <a\n          href=\"https://github.com/flekschas/enhancer-gene-vis/issues\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          open an issue on GitHub\n        </a>\n        .\n      </p>\n      <Typography align=\"center\">\n        <Button\n          className={classes.showIntro}\n          onClick={openIntroHandler}\n          variant=\"contained\"\n          disableElevation\n        >\n          Show Introduction\n        </Button>\n        <Button\n          className={classes.startExploring}\n          onClick={closeHandler}\n          variant=\"contained\"\n          disableElevation\n        >\n          Start Exploring!\n        </Button>\n      </Typography>\n    </div>\n  );\n});\n\nexport default Welcome;\n","import React, { createContext, useCallback, useState } from 'react';\nimport Backdrop from '@material-ui/core/Backdrop';\nimport Fade from '@material-ui/core/Fade';\nimport Modal from '@material-ui/core/Modal';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst ModalContext = createContext();\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: '4rem',\n  },\n  paper: {\n    backgroundColor: theme.palette.background.paper,\n    borderRadius: '0.25rem',\n    boxShadow: theme.shadows[4],\n    maxWidth: '60rem',\n    maxHeight: 'calc(100vh - 8rem)',\n    overflow: 'auto',\n    padding: theme.spacing(2, 4),\n    outline: 0,\n  },\n}));\n\nexport default function ModalProvider({ children }) {\n  const [Component, setComponent] = useState(null);\n  const [customCloseHandler, setCustomCloseHandler] = useState(null);\n  const [customProps, setCustomProps] = useState(null);\n\n  const showModal = useCallback(\n    (\n      newComponent = null,\n      newCustomCloseHandler = null,\n      newCustomProps = {}\n    ) => {\n      setComponent(newComponent);\n      setCustomCloseHandler(() => newCustomCloseHandler);\n      setCustomProps(newCustomProps);\n    },\n    []\n  );\n\n  const closeHandler = useCallback(() => {\n    setComponent(null);\n    setCustomCloseHandler(null);\n  }, []);\n\n  const classes = useStyles();\n\n  const open = Boolean(Component);\n\n  return (\n    <ModalContext.Provider value={showModal}>\n      {children}\n      <Modal\n        aria-labelledby=\"modal-title\"\n        aria-describedby=\"modal-description\"\n        className={classes.root}\n        open={open}\n        onClose={customCloseHandler || closeHandler}\n        closeAfterTransition\n        BackdropComponent={Backdrop}\n        BackdropProps={{\n          timeout: 250,\n        }}\n      >\n        <Fade in={open}>\n          <div className={classes.paper}>\n            {open && (\n              <Component\n                {...customProps}\n                closeHandler={customCloseHandler || closeHandler}\n              />\n            )}\n          </div>\n        </Fade>\n      </Modal>\n    </ModalContext.Provider>\n  );\n}\n\nfunction useShowModal() {\n  const context = React.useContext(ModalContext);\n  if (context === undefined) {\n    throw new Error('useShowModal must be used within a ModalContext');\n  }\n  return context;\n}\n\nexport { useShowModal };\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useRecoilState, useRecoilValue } from 'recoil';\nimport { isString, nthIndexOf } from '@flekschas/utils';\n\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport Divider from '@material-ui/core/Divider';\nimport Drawer from '@material-ui/core/Drawer';\nimport FormControl from '@material-ui/core/FormControl';\nimport Grid from '@material-ui/core/Grid';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\nimport ButtonBase from '@material-ui/core/ButtonBase';\nimport { makeStyles } from '@material-ui/core/styles';\nimport SettingsIcon from '@material-ui/icons/Settings';\n\nimport CheckboxList from './CheckboxList';\nimport Logo from './Logo';\nimport VariantsSettings from './VariantsSettings';\nimport Welcome from './Welcome';\nimport { useChromInfo } from './ChromInfoProvider';\nimport { useShowModal } from './ModalProvider';\n\nimport {\n  enhancerGenesSvgState,\n  higlassEnhancerRegionsState,\n  higlassDnaAccessState,\n  sampleFilterState,\n  sampleWithName,\n  sampleGroupWithGroup,\n  showVariantsSettingsState,\n  useXDomainStartWithAssembly,\n  useXDomainEndWithAssembly,\n  useShowWelcome,\n} from './state';\n\nimport { download, stringifySvg } from './utils';\n\nimport {\n  DEFAULT_COLOR_MAP_DARK,\n  DEFAULT_COLOR_MAP,\n  DEFAULT_VIEW_CONFIG_ENHANCER,\n  DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY,\n  SVG_SKELETON,\n  DRAWER_WIDTH,\n  GROUPED_SAMPLE_OPTIONS,\n  SAMPLE_TO_GROUP,\n} from './constants';\n\nconst useStyles = makeStyles((theme) => ({\n  h1: {\n    height: '100%',\n    margin: '0',\n    padding: '0',\n    fontSize: '1rem',\n    lineHeight: '1rem',\n    fontWeight: 'bold',\n  },\n  drawer: {\n    width: DRAWER_WIDTH,\n    flexShrink: 0,\n  },\n  drawerGrid: {\n    height: '100%',\n  },\n  drawerPaper: {\n    width: DRAWER_WIDTH,\n  },\n  settings: {\n    position: 'relative',\n    flexGrow: 1,\n  },\n  globalSettingsTitle: {\n    padding: '3px 8px 4px 8px',\n    margin: 0,\n    '& h6': {\n      fontSize: '0.8rem',\n      fontWeight: 'bold',\n    },\n  },\n  settingsContent: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    overflow: 'hidden auto',\n  },\n  toolbar: theme.mixins.toolbar,\n  grow: {\n    flexGrow: 1,\n  },\n  titleBar: {\n    position: 'relative',\n    padding: '2px',\n    fontSize: '0.8rem',\n    background: theme.palette.grey['100'],\n  },\n  titleBarText: {\n    fontSize: '0.8rem',\n  },\n  titleBarContainer: {\n    width: 'auto',\n  },\n  titleBarTitle: {\n    padding: '0 2px',\n    fontWeight: 900,\n  },\n  titleBarIcon: {\n    color: theme.palette.grey['400'],\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  titleBarIconActive: {\n    color: 'black',\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  globalSettingsFirstBox: {\n    margin: theme.spacing(0, 1, 1, 1),\n  },\n}));\n\nconst extractCoreFromHiGlassSvg = (svg) => {\n  const fifthLn = nthIndexOf(svg, '\\n', 4);\n  const lastLn = svg.lastIndexOf('\\n');\n  const width = +svg.substring(\n    svg.indexOf('width=\"') + 7,\n    svg.indexOf('px', svg.indexOf('width=\"') + 7)\n  );\n  const height = +svg.substring(\n    svg.indexOf('height=\"') + 8,\n    svg.indexOf('px', svg.indexOf('height=\"') + 8)\n  );\n  return {\n    core: svg.substring(fifthLn + 1, lastLn),\n    width,\n    height,\n  };\n};\n\nconst extractCoreFromStringifiedSvg = (svg) => {\n  const firstSvgClosingBracket = svg.indexOf('>');\n  const lastSvgOpeningBracket = svg.lastIndexOf('</svg>');\n  const [width, height] = svg\n    .substring(\n      svg.indexOf('viewbox=\"') + 9,\n      svg.indexOf('\"', svg.indexOf('viewbox=\"') + 9)\n    )\n    .split(' ')\n    .slice(2);\n  return {\n    core: svg.substring(firstSvgClosingBracket + 1, lastSvgOpeningBracket),\n    width: +width,\n    height: +height,\n  };\n};\n\nconst AppSidebar = React.memo(function AppSidebar() {\n  const chromInfo = useChromInfo();\n  const showModal = useShowModal();\n\n  const [xDomainStart, setXDomainStart] = useXDomainStartWithAssembly(\n    chromInfo\n  );\n  const [xDomainEnd, setXDomainEnd] = useXDomainEndWithAssembly(chromInfo);\n  const [showWelcome, setShowWelcome] = useShowWelcome();\n  const [showVariantsSettings, setShowVariantsSettings] = useRecoilState(\n    showVariantsSettingsState\n  );\n\n  const higlassEnhancerRegions = useRecoilValue(higlassEnhancerRegionsState);\n  const higlassDnaAccess = useRecoilValue(higlassDnaAccessState);\n  const enhancerGenesSvg = useRecoilValue(enhancerGenesSvgState);\n\n  const [userChangedDomain, setUserChangedDomain] = useState(0);\n\n  const numericalXDomainStart = useMemo(\n    () =>\n      isString(xDomainStart) && xDomainStart.indexOf(':') >= 0\n        ? chromInfo.chrToAbs([\n            xDomainStart.split(':')[0],\n            +xDomainStart.split(':')[1],\n          ])\n        : +xDomainStart,\n    [xDomainStart, chromInfo]\n  );\n\n  const numericalXDomainEnd = useMemo(\n    () =>\n      isString(xDomainEnd) && xDomainEnd.indexOf(':') >= 0\n        ? chromInfo.chrToAbs([\n            xDomainEnd.split(':')[0],\n            +xDomainEnd.split(':')[1],\n          ])\n        : +xDomainEnd,\n    [xDomainEnd, chromInfo]\n  );\n\n  const xDomainStartChangeHandler = useCallback(\n    (event) => {\n      setXDomainStart(event.target.value);\n      setUserChangedDomain(2);\n    },\n    [setXDomainStart]\n  );\n\n  const xDomainEndChangeHandler = useCallback(\n    (event) => {\n      setXDomainEnd(event.target.value);\n      setUserChangedDomain(2);\n    },\n    [setXDomainEnd]\n  );\n\n  useEffect(() => {\n    setUserChangedDomain((curr) => Math.max(0, curr - 1));\n  }, [xDomainStart, xDomainEnd]);\n\n  const higlassEnhancerZoomToXDomain = (event) => {\n    if (!higlassEnhancerRegions) return;\n\n    const xDomain = [\n      ...higlassEnhancerRegions.getViewConfig().views[0].initialXDomain,\n    ];\n\n    if (!Number.isNaN(+numericalXDomainStart)) {\n      xDomain[0] = numericalXDomainStart;\n    }\n    if (!Number.isNaN(+numericalXDomainEnd)) {\n      xDomain[1] = numericalXDomainEnd;\n    }\n\n    higlassEnhancerRegions.zoomTo(\n      'context',\n      xDomain[0],\n      xDomain[1],\n      xDomain[0],\n      xDomain[1],\n      2000\n    );\n  };\n\n  const closeWelcome = useCallback(() => {\n    setShowWelcome(false);\n  }, [setShowWelcome]);\n\n  const openWelcome = useCallback(() => {\n    setShowWelcome(true);\n  }, [setShowWelcome]);\n\n  const openWelcomeIntro = useCallback(() => {\n    setShowWelcome('intro');\n  }, [setShowWelcome]);\n\n  useEffect(() => {\n    if (showWelcome)\n      showModal(Welcome, closeWelcome, {\n        openIntroHandler: openWelcomeIntro,\n      });\n    else showModal();\n  }, [showWelcome, showModal, closeWelcome, openWelcomeIntro]);\n\n  const closeVariantsSettings = useCallback(() => {\n    setShowVariantsSettings(false);\n  }, [setShowVariantsSettings]);\n\n  const openVariantsSettings = useCallback(() => {\n    setShowVariantsSettings(true);\n  }, [setShowVariantsSettings]);\n\n  useEffect(() => {\n    if (showVariantsSettings) {\n      showModal(VariantsSettings, closeVariantsSettings);\n    } else if (!showWelcome) {\n      showModal();\n    }\n  }, [showWelcome, showVariantsSettings, showModal, closeVariantsSettings]);\n\n  const mergeSvgs = (enhancerSvg, dnaAccessSvg, enhancerGeneSvg) => {\n    const {\n      core: enhancerSvgCore,\n      width: enhancerWidth,\n      height: enhancerHeight,\n    } = extractCoreFromHiGlassSvg(enhancerSvg);\n    const {\n      core: dnaAccessSvgCore,\n      width: dnaAccessWidth,\n      height: dnaAccessHeight,\n    } = extractCoreFromHiGlassSvg(dnaAccessSvg);\n    const {\n      core: enhancerGeneSvgCore = null,\n      height: enhancerGeneHeight = 0,\n    } = enhancerGeneSvg ? extractCoreFromStringifiedSvg(enhancerGeneSvg) : {};\n\n    const actualEnhancerHeight = DEFAULT_VIEW_CONFIG_ENHANCER.views[0].tracks.top.reduce(\n      (height, track) => height + track.height,\n      0\n    );\n    const actualDnaAccessHeight = DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY.views[0].tracks.top.reduce(\n      (height, track) => height + track.height,\n      0\n    );\n    const padding = 24;\n\n    let mergedSvg = SVG_SKELETON;\n    mergedSvg = mergedSvg.replace(\n      '_WIDTH_',\n      enhancerWidth + dnaAccessWidth + padding\n    );\n    mergedSvg = mergedSvg.replace(\n      '_HEIGHT_',\n      Math.max(\n        enhancerHeight + enhancerGeneHeight + padding,\n        dnaAccessHeight,\n        actualEnhancerHeight + enhancerGeneHeight + padding,\n        actualDnaAccessHeight\n      )\n    );\n    mergedSvg = mergedSvg.replace('_ENHANCER_', enhancerSvgCore);\n    mergedSvg = mergedSvg.replace(\n      '_ENHANCER_GENE_Y_',\n      enhancerHeight + padding\n    );\n    mergedSvg = mergedSvg.replace('_ENHANCER_GENE_', enhancerGeneSvgCore);\n    mergedSvg = mergedSvg.replace('_DNA_ACCESS_X_', enhancerWidth + padding);\n    mergedSvg = mergedSvg.replace('_DNA_ACCESS_', dnaAccessSvgCore);\n\n    if (enhancerGeneSvgCore === null) {\n      mergedSvg = mergedSvg.replace('_ENHANCER_GENE_', '');\n    } else {\n      mergedSvg = mergedSvg.replace('_ENHANCER_GENE_', enhancerGeneSvgCore);\n    }\n\n    return mergedSvg;\n  };\n\n  const higlassExportAsSvg = () => {\n    if (!higlassEnhancerRegions || !higlassDnaAccess) {\n      console.warn('One of the HiGlass instances is not available');\n      return;\n    }\n\n    const mergedSvg = mergeSvgs(\n      higlassEnhancerRegions.exportAsSvg(),\n      higlassDnaAccess.exportAsSvg(),\n      enhancerGenesSvg ? stringifySvg(enhancerGenesSvg) : null\n    );\n\n    download(\n      'abc-enhancers.svg',\n      new Blob([mergedSvg], { type: 'image/svg+xml' })\n    );\n  };\n\n  // Run on every render\n  const classes = useStyles();\n\n  return (\n    <Drawer\n      className={classes.drawer}\n      variant=\"permanent\"\n      classes={{\n        paper: classes.drawerPaper,\n      }}\n      anchor=\"left\"\n    >\n      <Grid container direction=\"column\" className={classes.drawerGrid}>\n        <Grid item>\n          <ButtonBase\n            className={classes.toolbar}\n            style={{ width: '100%' }}\n            onClick={openWelcome}\n          >\n            <h1 className={classes.h1}>\n              <Logo />\n            </h1>\n          </ButtonBase>\n          <Divider />\n        </Grid>\n        <Grid container item className={classes.grow} direction=\"column\">\n          <Grid item>\n            <Box m={1}>\n              <Box m={0}>\n                <FormControl variant=\"outlined\" margin=\"dense\" fullWidth>\n                  <InputLabel htmlFor=\"x-domain-start\">Region Start</InputLabel>\n                  <OutlinedInput\n                    id=\"x-domain-start\"\n                    label=\"Region Start\"\n                    onChange={xDomainStartChangeHandler}\n                    value={xDomainStart}\n                  />\n                </FormControl>\n              </Box>\n              <Box m={0}>\n                <FormControl variant=\"outlined\" margin=\"dense\" fullWidth>\n                  <InputLabel htmlFor=\"x-domain-end\">Region End</InputLabel>\n                  <OutlinedInput\n                    id=\"x-domain-end\"\n                    label=\"Region End\"\n                    onChange={xDomainEndChangeHandler}\n                    value={xDomainEnd}\n                  />\n                </FormControl>\n              </Box>\n              {userChangedDomain > 0 && (\n                <Box m={0}>\n                  <Button\n                    variant=\"contained\"\n                    margin=\"dense\"\n                    onClick={higlassEnhancerZoomToXDomain}\n                    fullWidth\n                    disableElevation\n                    size=\"small\"\n                  >\n                    Go\n                  </Button>\n                </Box>\n              )}\n            </Box>\n            <Divider />\n            <Box m={1}>\n              <Button\n                variant=\"contained\"\n                margin=\"dense\"\n                fullWidth\n                disableElevation\n                size=\"small\"\n                startIcon={<SettingsIcon />}\n                onClick={openVariantsSettings}\n              >\n                Edit Variants\n              </Button>\n            </Box>\n            <Divider />\n          </Grid>\n          <Grid item className={classes.settings}>\n            <Box m={0} className={classes.settingsContent}>\n              <Box className={classes.globalSettingsFirstBox}>\n                <CheckboxList\n                  filterState={sampleFilterState}\n                  filterLabel=\"Filter Samples\"\n                  optionWithName={sampleWithName}\n                  optionGroupWithGroup={sampleGroupWithGroup}\n                  groupedOptions={GROUPED_SAMPLE_OPTIONS}\n                  optionToGroup={SAMPLE_TO_GROUP}\n                  groupColors={DEFAULT_COLOR_MAP}\n                  groupColorsDark={DEFAULT_COLOR_MAP_DARK}\n                />\n              </Box>\n            </Box>\n          </Grid>\n          <Grid item>\n            <Divider />\n            <Box m={1}>\n              <Button\n                variant=\"contained\"\n                margin=\"dense\"\n                onClick={higlassExportAsSvg}\n                fullWidth\n                disableElevation\n                size=\"small\"\n              >\n                Export as SVG\n              </Button>\n            </Box>\n          </Grid>\n        </Grid>\n      </Grid>\n    </Drawer>\n  );\n});\n\nexport default AppSidebar;\n","import PropTypes from 'prop-types';\nimport React, { useEffect, useState } from 'react';\nimport TextField from '@material-ui/core/TextField';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Grid from '@material-ui/core/Grid';\nimport Chip from '@material-ui/core/Chip';\nimport SvgIcon from '@material-ui/core/SvgIcon';\nimport FlashOnIcon from '@material-ui/icons/FlashOn';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { identity } from '@flekschas/utils';\n\nimport useDebounce from './use-debounce';\n\nconst useStyles = makeStyles((theme) => ({\n  inputRoot: {\n    background: 'white !important',\n    borderTopLeftRadius: 0,\n    borderTopRightRadius: 0,\n    '&::before': {\n      borderBottomWidth: 0,\n      boxShadow: '0 1px 0 0 rgba(0, 0, 0, 0)',\n      transition: 'boxShadow 0.2s ease',\n    },\n    '&:hover::before': {\n      borderBottomWidth: 0,\n      boxShadow: '0 1px 0 0 rgba(0, 0, 0, 1)',\n    },\n  },\n  focused: {\n    boxShadow: '0 1px 0 0 rgba(0, 0, 0, 1)',\n  },\n  input: {\n    height: 35,\n    padding: '6px 0 6px',\n  },\n  textFieldRoot: {\n    '& .MuiFormLabel-root': {\n      color: 'black',\n      fontWeight: 'bold',\n      transform: 'translate(12px, 21px) scale(1.25)',\n    },\n    '& .MuiInputLabel-shrink': {\n      fontWeight: 'normal',\n    },\n  },\n}));\n\nconst fetchJsonFromUrl = async (url, query) => {\n  if (typeof url === 'string') {\n    const response = await fetch(`${url}&ac=${query || ''}`);\n    return response.json();\n  }\n  const response = await fetch(`${url.url}&ac=${query || ''}`);\n  const results = await response.json();\n  return results.map((result) => {\n    result.type = url.type;\n    return result;\n  });\n};\n\nfunction GeneIcon(props) {\n  return (\n    <SvgIcon viewBox=\"0 0 16 16\" {...props}>\n      <path d=\"M5.03 14.378A7.33 7.33 0 003.423 16h2.42a7.762 7.762 0 011.281-.774 13.241 13.241 0 01-1.863-1.016c-.078.054-.156.11-.233.168zM5.766 0l.219.174a8.754 8.754 0 001.636.92l.024.008c.797.24 1.507.627 2.023.933.325.18.674.4 1.024.66 1.825 1.363 2.79 3.22 2.79 5.367 0 2.062-.962 3.89-2.782 5.286-.061.048-.125.094-.186.139a10.45 10.45 0 00-1.895-.955 8.17 8.17 0 001.69-1.162h-3.92a6.191 6.191 0 01-1.199-1.15h6.093a4.054 4.054 0 00.603-1.747H3.839c.072.656.307 1.239.636 1.747h.011c.282.438.628.822.991 1.15H5.47l.74.584c.831.588 1.573.893 1.636.92a9.358 9.358 0 012.847 1.504A7.38 7.38 0 0112.3 16H9.879l-.759-.5a7.876 7.876 0 00-1.256-.594 11.833 11.833 0 01-2.07-1.04l.017-.009c-1.567-.999-3.571-2.851-3.571-5.794 0-2.149.964-4.005 2.79-5.367.076-.058.154-.113.231-.167.495.32 1.143.698 1.863 1.015a7.677 7.677 0 00-1.296.786c-.043.032-.083.066-.125.098h3.318c.535.336.999.727 1.364 1.149H4.598a4.215 4.215 0 00-.721 1.748h7.97l-.038-.195a3.527 3.527 0 00-.306-.904 4.417 4.417 0 00-.378-.65l-.01-.007a5.793 5.793 0 00-1.081-1.13l-.14-.109a7.236 7.236 0 00-.722-.48l-.031-.02a7.942 7.942 0 00-1.276-.607 10.278 10.278 0 01-1.257-.57C5.728 2.218 4.31 1.364 3.281 0h2.486zm6.267 0a7.808 7.808 0 01-1.743 1.707A10.443 10.443 0 008.396.752 8.592 8.592 0 009.592 0h2.442z\" />\n    </SvgIcon>\n  );\n}\n\nfunction GeneOption(props) {\n  return (\n    <Grid\n      key={props.option.geneName}\n      container\n      direction=\"row\"\n      alignItems=\"center\"\n    >\n      <GeneIcon fontSize=\"small\" />\n      <span>{props.option.geneName}</span>\n    </Grid>\n  );\n}\n\nfunction VariantOption(props) {\n  return (\n    <Grid\n      key={props.option.geneName}\n      container\n      direction=\"row\"\n      alignItems=\"center\"\n    >\n      <FlashOnIcon fontSize=\"small\" />\n      <span>{props.option.geneName}</span>\n    </Grid>\n  );\n}\n\nfunction Option(props) {\n  if (props.option.type === 'gene') return <GeneOption option={props.option} />;\n  if (props.option.type === 'variant')\n    return <VariantOption option={props.option} />;\n  return <div>{props.option.geneName}</div>;\n}\n\nexport default function SearchField(props) {\n  const [open, setOpen] = useState(false);\n  const [options, setOptions] = useState([]);\n  const [searchQuery, setSearchQuery] = useState(props.inputValue);\n  const debouncedSearchQuery = useDebounce(searchQuery, 250);\n  const loading = open && options.length === 0;\n  const classes = useStyles();\n  const autocompleteClasses = { ...classes };\n  delete autocompleteClasses.textFieldRoot;\n\n  const { customSearch, searchUrl } = props;\n\n  useEffect(() => {\n    let active = true;\n\n    if (!open) return undefined;\n\n    setOptions([]);\n\n    const whenResults = Array.isArray(searchUrl)\n      ? searchUrl.map((url) => fetchJsonFromUrl(url, debouncedSearchQuery))\n      : [fetchJsonFromUrl(searchUrl, debouncedSearchQuery)];\n\n    if (customSearch) whenResults.push(customSearch(debouncedSearchQuery));\n\n    Promise.all(whenResults).then((results) => {\n      if (active) setOptions(results.flat().filter(identity));\n    });\n\n    return () => {\n      active = false;\n    };\n  }, [searchUrl, customSearch, open, debouncedSearchQuery]);\n\n  useEffect(() => {\n    if (!open) {\n      setOptions([]);\n    }\n  }, [open]);\n\n  const value =\n    props.multiple && !Array.isArray(props.value) ? [props.value] : props.value;\n\n  let autocompleteOptions = value && options.length === 0 ? value : options;\n  autocompleteOptions = Array.isArray(autocompleteOptions)\n    ? autocompleteOptions\n    : [autocompleteOptions];\n\n  return (\n    <Autocomplete\n      classes={props.larger ? autocompleteClasses : {}}\n      multiple={props.multiple}\n      onChange={(event, newValue) => {\n        props.onChange(newValue);\n      }}\n      value={value}\n      onInputChange={(event, newInputValue) => {\n        if (event) setSearchQuery(newInputValue);\n      }}\n      fullWidth={props.fullWidth}\n      style={{ width: props.fullWidth ? 'auto' : props.width }}\n      open={open}\n      onOpen={() => {\n        setOpen(true);\n      }}\n      onClose={() => {\n        setOpen(false);\n      }}\n      getOptionSelected={(option, _value) =>\n        option.geneName === _value.geneName\n      }\n      getOptionLabel={(option) => (option ? option.geneName : '')}\n      options={autocompleteOptions}\n      loading={loading}\n      renderInput={(params) => (\n        <TextField\n          {...params}\n          className={props.larger ? classes.textFieldRoot : ''}\n          id={props.id}\n          label={props.label}\n          variant={props.variant}\n          size={props.size}\n          InputProps={{\n            ...params.InputProps,\n            endAdornment: (\n              <React.Fragment>\n                {loading ? (\n                  <CircularProgress color=\"inherit\" size={20} />\n                ) : null}\n                {params.InputProps.endAdornment}\n              </React.Fragment>\n            ),\n          }}\n        />\n      )}\n      renderOption={(option) => <Option option={option} />}\n      renderTags={(v, getTagProps) =>\n        v.map((option, index) => (\n          <Chip\n            icon={option.type === 'gene' ? <GeneIcon /> : <FlashOnIcon />}\n            key={option.geneName}\n            label={option.geneName}\n            {...getTagProps({ index })}\n          />\n        ))\n      }\n    />\n  );\n}\n\nSearchField.defaultProps = {\n  fullWidth: true,\n  id: '',\n  label: '',\n  multiple: false,\n  onChange: identity,\n  size: 'small',\n  value: null,\n  variant: 'outlined',\n  width: '10rem',\n};\n\nSearchField.propTypes = {\n  customSearch: PropTypes.func,\n  fullWidth: PropTypes.bool,\n  id: PropTypes.string,\n  label: PropTypes.oneOfType([PropTypes.string, PropTypes.node]),\n  multiple: PropTypes.bool,\n  onChange: PropTypes.func,\n  searchUrl: PropTypes.oneOfType([\n    PropTypes.arrayOf(\n      PropTypes.oneOfType([\n        PropTypes.shape({\n          url: PropTypes.string,\n          type: PropTypes.string,\n        }),\n        PropTypes.string,\n      ])\n    ),\n    PropTypes.string,\n  ]).isRequired,\n  size: PropTypes.string,\n  value: PropTypes.oneOfType([PropTypes.array, PropTypes.object]),\n  variant: PropTypes.string,\n  width: PropTypes.string,\n};\n","import { useRef, useEffect } from 'react';\n\nexport default function usePrevious(value) {\n  const ref = useRef();\n  useEffect(() => {\n    ref.current = value;\n  });\n  return ref.current;\n}\n","import React, { useMemo } from 'react';\nimport { useRecoilState } from 'recoil';\n\nimport AppBar from '@material-ui/core/AppBar';\nimport FormControl from '@material-ui/core/FormControl';\nimport Grid from '@material-ui/core/Grid';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport { makeStyles } from '@material-ui/core/styles';\nimport SearchIcon from '@material-ui/icons/Search';\n\nimport SearchField from './SearchField';\n\nimport usePrevious from './use-previous';\n\nimport {\n  focusGeneOptionState,\n  focusVariantOptionState,\n  useFocusGene,\n  useFocusVariant,\n} from './state';\n\nimport { DRAWER_WIDTH, GENE_SEARCH_URL, VARIANT_SEARCH_URL } from './constants';\n\nconst useStyles = makeStyles((theme) => ({\n  appBar: {\n    width: `calc(100% - ${DRAWER_WIDTH}px)`,\n    marginLeft: DRAWER_WIDTH,\n    color: theme.palette.common.black,\n    backgroundColor: theme.palette.common.white,\n    boxShadow: `0 1px 0 0 ${theme.palette.grey['300']}`,\n  },\n  toolbarExtra: {\n    paddingLeft: 0,\n    paddingRight: 0,\n    alignItems: 'flex-end',\n  },\n}));\n\nconst locationSearch = async (query) => {\n  if (!query) return undefined;\n\n  const match = query.match(/^chr(\\d+):(\\d)+$/);\n  if (\n    match &&\n    ((+match[1] > 0 && +match[1] < 23) ||\n      +match[1].toLowerCase() === 'x' ||\n      +match[1].toLowerCase() === 'y')\n  ) {\n    return [\n      {\n        chr: `chr${match[1]}`,\n        txStart: +match[2],\n        txEnd: +match[2] + 1,\n        score: 0,\n        geneName: query,\n        type: 'nucleotide',\n      },\n    ];\n  }\n\n  return undefined;\n};\n\nconst AppTopbar = React.memo(function AppTopbar() {\n  const [focusGene, setFocusGene] = useFocusGene();\n  const [focusVariant, setFocusVariant] = useFocusVariant();\n  const [focusGeneOption, setFocusGeneOption] = useRecoilState(\n    focusGeneOptionState\n  );\n  const [focusVariantOption, setFocusVariantOption] = useRecoilState(\n    focusVariantOptionState\n  );\n\n  const prevFocusGeneOption = usePrevious(focusGeneOption);\n  const prevFocusVariantOption = usePrevious(focusVariantOption);\n\n  // Derived State\n  const focusGeneVariantOptions = useMemo(\n    () => {\n      const _focusGeneVariant = [];\n      // Add the focus element that has not changed first!\n      if (focusGeneOption && focusGeneOption === prevFocusGeneOption)\n        _focusGeneVariant.push(focusGeneOption);\n      if (focusVariantOption && focusVariantOption === prevFocusVariantOption)\n        _focusGeneVariant.push(focusVariantOption);\n      // Now add the focused element that has changed!\n      if (focusGeneOption && focusGeneOption !== prevFocusGeneOption)\n        _focusGeneVariant.push(focusGeneOption);\n      if (focusVariantOption && focusVariantOption !== prevFocusVariantOption)\n        _focusGeneVariant.push(focusVariantOption);\n      return _focusGeneVariant;\n    },\n    // `prevFocusGeneOption` and `prevFocusVariantOption` are ommitted\n    // on purpose to avoid circular updates.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [focusGeneOption, focusVariantOption]\n  );\n\n  const clearFocusGene = () => {\n    setFocusGene('');\n    setFocusGeneOption(null);\n  };\n\n  const clearFocusVariant = () => {\n    setFocusVariant('');\n    setFocusVariantOption(null);\n  };\n\n  const focusGeneVariantChangeHandler = (newValues) => {\n    if (newValues.length) {\n      const newFocusElements = {};\n      // We only allow exactly two selections\n      newValues.slice(newValues.length - 2).forEach((newValue) => {\n        switch (newValue.type) {\n          case 'gene':\n            newFocusElements.gene = newValue;\n            if (focusGene !== newValue.geneName) {\n              setFocusGene(newValue.geneName);\n              setFocusGeneOption(newValue);\n            }\n            break;\n\n          case 'variant':\n            newFocusElements.variant = newValue;\n            if (focusVariant !== newValue.geneName) {\n              setFocusVariant(newValue.geneName);\n              setFocusVariantOption(newValue);\n            }\n            break;\n\n          default:\n            // eslint-disable-next-line no-console\n            console.warn('Unknown focus element', newValue);\n            break;\n        }\n      });\n      // Unset focus elements\n      if (focusGene && !newFocusElements.gene) clearFocusGene();\n      if (focusVariant && !newFocusElements.variant) clearFocusVariant();\n    } else {\n      clearFocusGene();\n      clearFocusVariant();\n    }\n  };\n\n  const classes = useStyles();\n\n  return (\n    <AppBar position=\"fixed\" className={classes.appBar}>\n      <Toolbar\n        classes={{\n          root: classes.toolbarExtra,\n        }}\n      >\n        <FormControl fullWidth>\n          <SearchField\n            label={\n              <Grid container direction=\"row\" alignItems=\"center\">\n                <SearchIcon fontSize=\"small\" />\n                <span style={{ marginLeft: 3 }}>Gene or Variant</span>\n              </Grid>\n            }\n            customSearch={locationSearch}\n            searchUrl={[\n              { url: GENE_SEARCH_URL, type: 'gene' },\n              { url: VARIANT_SEARCH_URL, type: 'variant' },\n            ]}\n            onChange={focusGeneVariantChangeHandler}\n            value={focusGeneVariantOptions}\n            variant=\"filled\"\n            larger\n            fullWidth\n            multiple\n          />\n        </FormControl>\n      </Toolbar>\n    </AppBar>\n  );\n});\n\nexport default AppTopbar;\n","import React from 'react';\nimport { useRecoilValue } from 'recoil';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport {\n  enhancerRegionsShowInfoState,\n  focusVariantState,\n  focusGeneState,\n} from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n    justifyContent: 'space-between',\n  },\n  text: {\n    fontSize: '0.8rem',\n  },\n  black: {\n    color: 'black',\n  },\n  gray: {\n    color: theme.palette.grey['400'],\n  },\n  pink: {\n    color: '#cc0078',\n  },\n}));\n\nconst EnhancerRegionsInfo = React.memo(function EnhancerRegionsInfo() {\n  const showInfo = useRecoilValue(enhancerRegionsShowInfoState);\n  const focusGene = useRecoilValue(focusGeneState);\n  const focusVariant = useRecoilValue(focusVariantState);\n\n  const classes = useStyles();\n\n  if (!showInfo) return '';\n\n  return (\n    <React.Fragment>\n      {focusGene && focusVariant && (\n        <Typography className={classes.text} noWrap>\n          <span className={classes.pink}></span> Enhancers containing{' '}\n          <em>{focusVariant}</em> and predicted to regulate <em>{focusGene}</em>\n        </Typography>\n      )}\n      {focusGene && !focusVariant && (\n        <Typography className={classes.text} noWrap>\n          <span className={classes.pink}></span> Enhancers predicted to\n          regulate <em>{focusGene}</em>\n        </Typography>\n      )}\n      {!focusGene && focusVariant && (\n        <Typography className={classes.text} noWrap>\n          <span className={classes.pink}></span> Enhancers containing{' '}\n          <em>{focusVariant}</em>\n        </Typography>\n      )}\n      {focusGene || focusVariant ? (\n        <Typography className={classes.text} noWrap>\n          <span className={classes.gray}></span> All other predicted enhancers\n        </Typography>\n      ) : (\n        <Typography className={classes.text} noWrap>\n          <span className={classes.black}></span> All predicted enhancers\n        </Typography>\n      )}\n    </React.Fragment>\n  );\n});\n\nexport default EnhancerRegionsInfo;\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\n\nconst EnhancerRegionsInfo = React.memo(function EnhancerRegionsInfo() {\n  return (\n    <React.Fragment>\n      <Typography>\n        This panel visualizes the predicted enhancers by sample type as a\n        matrix-like track. Each rectangle representes an enhancer. Promoter\n        regions are indicated by translucent light gray overlays.\n      </Typography>\n      <Typography>\n        {' '}\n        You can filter enhancers via their target gene or by variant (the dot\n        plot below the gene annotations). Click on a variant or gene to select\n        it. Selections are shown in pink/red.\n      </Typography>\n    </React.Fragment>\n  );\n});\n\nexport default EnhancerRegionsInfo;\n","import React, { useCallback } from 'react';\nimport Box from '@material-ui/core/Box';\nimport IconButton from '@material-ui/core/IconButton';\nimport RadioButtonCheckedIcon from '@material-ui/icons/RadioButtonChecked';\nimport RadioButtonUncheckedIcon from '@material-ui/icons/RadioButtonUnchecked';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport RadioGroup from '@material-ui/core/RadioGroup';\nimport Switch from '@material-ui/core/Switch';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport {\n  useEnhancerRegionsHideUnfocused,\n  useEnhancerRegionsColorEncoding,\n  useVariantYScale,\n} from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  iconRadioLegend: {\n    margin: theme.spacing(2, 0, 0.25, 0),\n  },\n}));\n\nconst EnhancerRegionsInfo = React.memo(function EnhancerRegionsInfo() {\n  const [variantYScale, setVariantYScale] = useVariantYScale();\n  const [hideUnfocused, setHideUnfocused] = useEnhancerRegionsHideUnfocused();\n  const [colorEncoding, setColorEncoding] = useEnhancerRegionsColorEncoding();\n\n  const hideUnfocusedChangeHandler = useCallback(\n    (event) => {\n      setHideUnfocused(event.target.checked);\n    },\n    [setHideUnfocused]\n  );\n\n  const changeVariantYScale = useCallback(\n    (value) => () => {\n      setVariantYScale(value);\n    },\n    [setVariantYScale]\n  );\n\n  const changeColorEncoding = useCallback(\n    (value) => () => {\n      setColorEncoding(value);\n    },\n    [setColorEncoding]\n  );\n\n  const classes = useStyles();\n\n  return (\n    <React.Fragment>\n      <Box m={1}>\n        <FormControlLabel\n          control={\n            <Switch\n              checked={hideUnfocused}\n              onChange={hideUnfocusedChangeHandler}\n              name=\"hideUnfocused\"\n            />\n          }\n          label=\"Hide unfocused enhancer regions\"\n        />\n      </Box>\n      <Box m={1}>\n        <FormControl component=\"fieldset\">\n          <FormLabel component=\"legend\" className={classes.iconRadioLegend}>\n            Variant y-scale\n          </FormLabel>\n          <RadioGroup\n            aria-label=\"variantYScale\"\n            name=\"variantYScale\"\n            value={variantYScale}\n          >\n            <FormControlLabel\n              label=\"p-value\"\n              value=\"pValue\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeVariantYScale('pValue')}\n                >\n                  {variantYScale === 'pValue' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Posterior probability\"\n              value=\"posteriorProbability\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeVariantYScale('posteriorProbability')}\n                >\n                  {variantYScale === 'posteriorProbability' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n          </RadioGroup>\n        </FormControl>\n      </Box>\n      <Box m={1}>\n        <FormControl component=\"fieldset\">\n          <FormLabel component=\"legend\" className={classes.iconRadioLegend}>\n            Matrix colorEncoding\n          </FormLabel>\n          <RadioGroup\n            aria-label=\"colorEncoding\"\n            name=\"colorEncoding\"\n            value={colorEncoding}\n          >\n            <FormControlLabel\n              label=\"Solid\"\n              value=\"solid\"\n              className={classes.iconRadio}\n              control={\n                <IconButton size=\"small\" onClick={changeColorEncoding('solid')}>\n                  {colorEncoding === 'solid' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Number of predictions\"\n              value=\"frequency\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeColorEncoding('frequency')}\n                >\n                  {colorEncoding === 'frequency' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Highest prediction score\"\n              value=\"highestImportance\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeColorEncoding('highestImportance')}\n                >\n                  {colorEncoding === 'highestImportance' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Closest prediction score\"\n              value=\"closestImportance\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeColorEncoding('closestImportance')}\n                >\n                  {colorEncoding === 'closestImportance' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n          </RadioGroup>\n        </FormControl>\n      </Box>\n    </React.Fragment>\n  );\n});\n\nexport default EnhancerRegionsInfo;\n","import React, { useCallback, useMemo, useState } from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport IconButton from '@material-ui/core/IconButton';\nimport HelpIcon from '@material-ui/icons/Help';\nimport InfoIcon from '@material-ui/icons/Info';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport Popover from '@material-ui/core/Popover';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme) => ({\n  grow: {\n    flexGrow: 1,\n  },\n  bar: {\n    position: 'relative',\n    padding: '2px',\n    fontSize: '0.8rem',\n    background: theme.palette.grey['100'],\n  },\n  title: {\n    fontSize: '0.8rem',\n    padding: '0 2px',\n    fontWeight: 900,\n  },\n  icon: {\n    color: theme.palette.grey['400'],\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  iconActive: {\n    color: theme.palette.grey['600'],\n    '&:hover': {\n      color: 'black',\n    },\n  },\n  popeover: {\n    '& > *': {\n      maxWidth: '20rem',\n      padding: '0.5rem',\n      fontSize: '0.8rem',\n      '&+p': {\n        paddingTop: 0,\n      },\n    },\n  },\n  info: {\n    '&> *': {\n      padding: '0 2px',\n    },\n    '&> *:last-child': {\n      borderBottom: `1px solid ${theme.palette.grey['100']}`,\n    },\n  },\n}));\n\nconst TitleBar = React.memo(function TitleBar({\n  id,\n  title,\n  Info,\n  Help,\n  Settings,\n  useShowInfo,\n  popoverDirection = 'bottom',\n}) {\n  const [showInfo, setShowInfo] = useShowInfo();\n  const [helpAnchorEl, setHelpAnchorEl] = useState();\n  const [settingsAnchorEl, setSettingsAnchorEl] = useState();\n\n  const infoToggleHandler = useCallback(() => {\n    setShowInfo((show) => !(show === true || show === 'true'));\n  }, [setShowInfo]);\n\n  const helpOpenHandler = useCallback((event) => {\n    setHelpAnchorEl(event.currentTarget);\n  }, []);\n\n  const helpCloseHandler = useCallback(() => {\n    setHelpAnchorEl(null);\n  }, []);\n\n  const settingsOpenHandler = useCallback((event) => {\n    setSettingsAnchorEl(event.currentTarget);\n  }, []);\n\n  const settingsCloseHandler = useCallback(() => {\n    setSettingsAnchorEl(null);\n  }, []);\n\n  const helpId = useMemo(() => `${id}-help`, [id]);\n  const settingsId = useMemo(() => `${id}-settings`, [id]);\n\n  const anchorOriginVertical = useMemo(\n    () => (popoverDirection === 'bottom' ? 'bottom' : 'top'),\n    [popoverDirection]\n  );\n  const transformOriginVertical = useMemo(\n    () => (popoverDirection === 'bottom' ? 'top' : 'bottom'),\n    [popoverDirection]\n  );\n\n  // On every render\n  const classes = useStyles();\n\n  const helpOpen = Boolean(helpAnchorEl);\n  const settingsOpen = Boolean(settingsAnchorEl);\n\n  const iconInfoClass = showInfo ? classes.iconActive : classes.icon;\n  const iconHelpClass = helpOpen ? classes.iconActive : classes.icon;\n  const iconSettingsClass = settingsOpen ? classes.iconActive : classes.icon;\n\n  return (\n    <Grid item className={classes.root}>\n      <Grid\n        item\n        className={classes.bar}\n        container\n        alignItems=\"center\"\n        wrap=\"nowrap\"\n      >\n        <Grid\n          item\n          container\n          alignItems=\"center\"\n          wrap=\"nowrap\"\n          className={classes.grow}\n        >\n          <Typography component=\"h3\" className={classes.title} noWrap>\n            {title}:\n          </Typography>\n        </Grid>\n        <Grid item>\n          <Grid container alignItems=\"center\" wrap=\"nowrap\">\n            <IconButton\n              aria-label=\"details\"\n              className={iconInfoClass}\n              size=\"small\"\n              onClick={infoToggleHandler}\n            >\n              <InfoIcon fontSize=\"inherit\" />\n            </IconButton>\n            <IconButton\n              aria-label=\"help\"\n              aria-describedby={helpId}\n              className={iconHelpClass}\n              size=\"small\"\n              onClick={helpOpenHandler}\n            >\n              <HelpIcon fontSize=\"inherit\" />\n            </IconButton>\n            <Popover\n              id={helpId}\n              open={helpOpen}\n              anchorEl={helpAnchorEl}\n              onClose={helpCloseHandler}\n              anchorOrigin={{\n                vertical: anchorOriginVertical,\n                horizontal: 'right',\n              }}\n              transformOrigin={{\n                vertical: transformOriginVertical,\n                horizontal: 'right',\n              }}\n            >\n              <div className={classes.popeover}>\n                <Help />\n              </div>\n            </Popover>\n            <IconButton\n              aria-label=\"settings\"\n              aria-describedby={settingsId}\n              className={iconSettingsClass}\n              size=\"small\"\n              onClick={settingsOpenHandler}\n            >\n              <SettingsIcon fontSize=\"inherit\" />\n            </IconButton>\n            <Popover\n              id={helpId}\n              open={settingsOpen}\n              anchorEl={settingsAnchorEl}\n              onClose={settingsCloseHandler}\n              anchorOrigin={{\n                vertical: anchorOriginVertical,\n                horizontal: 'right',\n              }}\n              transformOrigin={{\n                vertical: transformOriginVertical,\n                horizontal: 'right',\n              }}\n            >\n              <div className={classes.popeover}>\n                <Settings />\n              </div>\n            </Popover>\n          </Grid>\n        </Grid>\n      </Grid>\n      <Grid item className={classes.info}>\n        {showInfo && <Info />}\n      </Grid>\n    </Grid>\n  );\n});\n\nexport default TitleBar;\n","import { deepClone, isFunction } from '@flekschas/utils';\n\nimport { DEFAULT_VARIANT_TRACK_DEF } from './constants';\n\nconst getFocusGeneRegion = (viewConfig) => {\n  return viewConfig.views[0].overlays[1] &&\n    viewConfig.views[0].overlays[1].options.extent &&\n    viewConfig.views[0].overlays[1].options.extent.length\n    ? [...viewConfig.views[0].overlays[1].options.extent[0]]\n    : null;\n};\n\nconst getFocusVariantRegion = (viewConfig) => {\n  const track = viewConfig.views[0].tracks.top[2];\n  let focusRegion = null;\n\n  if (track.type === 'combined') {\n    if (!track.contents[0]) return focusRegion;\n    focusRegion = track.contents[0].options.focusRegion;\n  } else {\n    focusRegion = track.options.focusRegion;\n  }\n\n  return focusRegion ? [...focusRegion] : focusRegion;\n};\n\nexport const updateViewConfigVariantTracks = (variantTrackConfigs) => (\n  viewConfig\n) => {\n  const track = viewConfig.views[0].tracks.top[2];\n\n  if (track.type === 'combined') {\n    track.contents = variantTrackConfigs.reduce((tracks, trackConfig) => {\n      const variantTrack = deepClone(DEFAULT_VARIANT_TRACK_DEF);\n      if (trackConfig.server && trackConfig.tilesetUid) {\n        variantTrack.server = trackConfig.server;\n        variantTrack.tilesetUid = trackConfig.tilesetUid;\n        variantTrack.uid = `variants-${trackConfig.tilesetUid}`;\n        variantTrack.options.name = trackConfig.label || 'Variants';\n        tracks.push(variantTrack);\n      } else if (trackConfig.file) {\n        variantTrack.data = { type: 'localBed', id: trackConfig.file.name };\n        variantTrack.uid = `variants-${trackConfig.file.name}`;\n        variantTrack.options.name = trackConfig.label || 'Variants';\n        tracks.push(variantTrack);\n      }\n      return tracks;\n    }, []);\n\n    track.height = (track.contents.length > 0) * 32;\n  }\n\n  return viewConfig;\n};\n\nexport const updateViewConfigFocusVariant = (position, trackIdxs = []) => (\n  viewConfig\n) => {\n  const delFocusRegion = (track, focusRegion) => {\n    if (track.type === 'combined') {\n      track.contents.forEach((childTrack) => {\n        delete childTrack.options.focusRegion;\n      });\n    } else {\n      delete track.options.focusRegion;\n    }\n  };\n\n  const setFocusRegion = (track, focusRegion) => {\n    if (track.type === 'combined') {\n      track.contents.forEach((childTrack) => {\n        childTrack.options.focusRegion = focusRegion;\n      });\n    } else {\n      track.options.focusRegion = focusRegion;\n    }\n  };\n\n  if (Number.isNaN(+position) || position === null) {\n    trackIdxs.forEach((trackIdx) => {\n      delFocusRegion(viewConfig.views[0].tracks.top[trackIdx]);\n    });\n    viewConfig.views[0].overlays[0].options.extent = [];\n  } else {\n    const focusRegion = [position - 0.5, position + 0.5];\n    trackIdxs.forEach((trackIdx) => {\n      setFocusRegion(viewConfig.views[0].tracks.top[trackIdx], focusRegion);\n    });\n\n    viewConfig.views[0].overlays[0].options.extent = [focusRegion];\n  }\n\n  return viewConfig;\n};\n\nexport const updateViewConfigVariantYScale = (yScale) => (viewConfig) => {\n  const track = viewConfig.views[0].tracks.top[2];\n\n  if (track.type === 'combined') {\n    track.contents.forEach((childTrack) => {\n      childTrack.options.valueColumn = yScale === 'pValue' ? 7 : 8;\n    });\n  } else {\n    track.options.valueColumn = yScale === 'pValue' ? 7 : 8;\n  }\n\n  return viewConfig;\n};\n\nexport const updateViewConfigXDomain = (\n  newXDomainStart,\n  newXDomainEnd,\n  { force = false } = {}\n) => (viewConfig) => {\n  const _force = force === true || (isFunction(force) && force());\n\n  const xDomain = [...viewConfig.views[0].initialXDomain];\n  const focusGeneRegion = getFocusGeneRegion(viewConfig);\n  const focusVariantRegion = getFocusVariantRegion(viewConfig);\n\n  if (!Number.isNaN(+newXDomainStart)) {\n    xDomain[0] = newXDomainStart;\n  }\n  if (!Number.isNaN(+newXDomainEnd)) {\n    xDomain[1] = newXDomainEnd;\n  }\n\n  if (focusGeneRegion && !_force) {\n    xDomain[0] = focusGeneRegion[0] - 100000;\n    xDomain[1] = focusGeneRegion[1] + 100000;\n  }\n\n  if (focusVariantRegion && !_force) {\n    xDomain[0] = Math.min(xDomain[0], focusVariantRegion[0] - 100000);\n    xDomain[1] = Math.max(xDomain[1], focusVariantRegion[1] + 100000);\n  }\n\n  viewConfig.views[0].initialXDomain = xDomain;\n\n  return viewConfig;\n};\n\nexport const updateViewConfigFocusGene = (gene, start, end) => (viewConfig) => {\n  const n = viewConfig.views[0].tracks.top.length;\n\n  if (gene) {\n    viewConfig.views[0].tracks.top[n - 1].options.focusGene = gene;\n    viewConfig.views[0].overlays[1].options.extent = [[start, end]];\n  } else {\n    delete viewConfig.views[0].tracks.top[n - 1].options.focusGene;\n    delete viewConfig.views[0].overlays[1].options.extent;\n  }\n\n  return viewConfig;\n};\n","import React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { useRecoilValue, useSetRecoilState, useRecoilState } from 'recoil';\nimport { HiGlassComponent } from 'higlass';\nimport { debounce, deepClone, isParentOf, pipe, sum } from '@flekschas/utils';\n\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport { useChromInfo } from './ChromInfoProvider';\nimport EnhancerRegionsInfo from './EnhancerRegionsInfo';\nimport EnhancerRegionsHelp from './EnhancerRegionsHelp';\nimport EnhancerRegionsSettings from './EnhancerRegionsSettings';\nimport TitleBar from './TitleBar';\n\nimport {\n  enhancerRegionsColorEncodingState,\n  enhancerRegionsHideUnfocusedState,\n  focusGeneEndWithAssembly,\n  focusGeneOptionState,\n  focusGeneStartWithAssembly,\n  focusVariantOptionState,\n  focusVariantPositionWithAssembly,\n  higlassEnhancerRegionsState,\n  sampleGroupSelectionSizesState,\n  selectedSamplesState,\n  useEnhancerRegionsShowInfos,\n  useFocusGene,\n  useFocusVariant,\n  useXDomainEndWithAssembly,\n  useXDomainStartWithAssembly,\n  variantTracksState,\n  variantYScaleState,\n  xDomainEndAbsWithAssembly,\n  xDomainStartAbsWithAssembly,\n} from './state';\n\nimport {\n  updateViewConfigFocusGene,\n  updateViewConfigFocusVariant,\n  updateViewConfigVariantYScale,\n  updateViewConfigXDomain,\n  updateViewConfigVariantTracks,\n} from './view-config';\n\nimport { DEFAULT_VIEW_CONFIG_ENHANCER } from './constants';\n\nimport 'higlass/dist/hglib.css';\n\nimport './EnhancerRegions.css';\n\nconst useStyles = makeStyles((theme) => ({\n  grow: {\n    flexGrow: 1,\n  },\n  fullWidthHeight: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n  },\n  higlassContainer: {\n    position: 'relative',\n    minHeight: '100%',\n    overflow: 'hidden',\n  },\n  panZoomTip: {\n    position: 'absolute',\n    zIndex: 11,\n    top: 0,\n    left: 0,\n    right: 0,\n    padding: '0 2px',\n    fontSize: '0.8rem',\n    lineHeight: '1.5rem',\n    background: theme.palette.grey['100'],\n    textAlign: 'center',\n    boxShadow: '0 1px 3px 0 rgba(0, 0, 0, 0.1)',\n    opacity: 1,\n    animation: '0.75s ease 3s 1 running forwards fadeout',\n    '-webkit-touch-callout': 'none',\n    '-webkit-user-select': 'none',\n    '-khtml-user-select': 'none',\n    '-moz-user-select': 'none',\n    '-ms-user-select': 'none',\n    userSelect: 'none',\n    transition: '0.25s ease opacity, 0.25s ease transform',\n    '&:hover': {\n      opacity: 0,\n    },\n  },\n  panZoomTipNormal: {\n    color: theme.palette.grey['600'],\n  },\n  panZoomTipNormalHover: {\n    fontWeight: 'bold',\n    color: 'black',\n    background: '#aaa',\n    animation: '0.75s ease 5s 1 running forwards fadeout',\n  },\n  panZoomTipActive: {\n    color: 'white',\n    background: '#dd55a5',\n    animation: '0.75s ease 5s 1 running forwards fadeout',\n  },\n  panZoomTipActiveHover: {\n    fontWeight: 'bold',\n    color: 'white',\n    background: '#cc0078',\n    animation: '0.75s ease 5s 1 running forwards fadeout',\n  },\n}));\n\nconst updateViewConfigFocusStyle = (hideUnfocused) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[4].options.focusStyle = hideUnfocused\n    ? 'filtering'\n    : 'highlighting';\n  viewConfig.views[0].tracks.top[4].options.stratification.axisNoGroupColor = !hideUnfocused;\n\n  return viewConfig;\n};\n\nconst updateViewConfigColorEncoding = (coloring) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[4].options.opacityEncoding = coloring;\n  return viewConfig;\n};\n\nconst updateViewConfigFilter = (selectedSamples) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[3].contents[0].options.filter = {\n    set: selectedSamples,\n    field: 10,\n  };\n  viewConfig.views[0].tracks.top[3].contents[1].options.filter = {\n    set: selectedSamples,\n    field: 10,\n  };\n  viewConfig.views[0].tracks.top[4].options.filter = {\n    set: selectedSamples,\n    field: 10,\n  };\n  return viewConfig;\n};\n\nconst updateViewConfigMatrixHeight = (numSamples) => (viewConfig) => {\n  const matrixTrack = viewConfig.views[0].tracks.top[4];\n  matrixTrack.height = numSamples * matrixTrack.options.markHeight + 14;\n  return viewConfig;\n};\n\nconst EnhancerRegion = React.memo((props) => {\n  const chromInfo = useChromInfo();\n\n  const [focusGeneOption, setFocusGeneOption] = useRecoilState(\n    focusGeneOptionState\n  );\n\n  const setFocusGene = useFocusGene()[1];\n  const setFocusVariant = useFocusVariant()[1];\n  const setXDomainStart = useXDomainStartWithAssembly(chromInfo)[1];\n  const setXDomainEnd = useXDomainEndWithAssembly(chromInfo)[1];\n  const setFocusVariantOption = useSetRecoilState(focusVariantOptionState);\n  const setHiglass = useSetRecoilState(higlassEnhancerRegionsState);\n\n  const variantTracks = useRecoilValue(variantTracksState);\n  const hideUnfocused = useRecoilValue(enhancerRegionsHideUnfocusedState);\n  const variantYScale = useRecoilValue(variantYScaleState);\n  const colorEncoding = useRecoilValue(enhancerRegionsColorEncodingState);\n  const focusVariantPosition = useRecoilValue(\n    focusVariantPositionWithAssembly(chromInfo)\n  );\n  const xDomainStartAbs = useRecoilValue(\n    xDomainStartAbsWithAssembly(chromInfo)\n  );\n  const xDomainEndAbs = useRecoilValue(xDomainEndAbsWithAssembly(chromInfo));\n  const focusGeneStart = useRecoilValue(focusGeneStartWithAssembly(chromInfo));\n  const focusGeneEnd = useRecoilValue(focusGeneEndWithAssembly(chromInfo));\n  const sampleGroupSelectionSizes = useRecoilValue(\n    sampleGroupSelectionSizesState\n  );\n  const selectedSamples = useRecoilValue(selectedSamplesState);\n\n  const [higlassMouseOver, setHiglassMouseOver] = useState(false);\n  const [higlassFocus, setHiglassFocus] = useState(false);\n  const higlassContainerRef = useRef(null);\n  const higlassEnhancerClickSelection = useRef(null);\n  const higlassMouseDown = useRef(false);\n  const higlassNumMouseOver = useRef(0);\n  const higlassNumFocus = useRef(0);\n  const higlassNumFocusMouseOut = useRef(0);\n\n  const shouldSkipUpdatingXDomain = () => {\n    if (higlassEnhancerClickSelection.current) {\n      higlassEnhancerClickSelection.current = false;\n      return true;\n    }\n    return false;\n  };\n\n  const numSamples = useMemo(\n    () => sum(Object.values(sampleGroupSelectionSizes)),\n    [sampleGroupSelectionSizes]\n  );\n\n  useEffect(() => {\n    higlassNumMouseOver.current += higlassMouseOver;\n  }, [higlassMouseOver]);\n\n  useEffect(() => {\n    higlassNumFocus.current += higlassFocus;\n  }, [higlassFocus]);\n\n  useEffect(() => {\n    if (higlassFocus) higlassNumFocusMouseOut.current += !higlassMouseOver;\n    else higlassNumFocusMouseOut.current = 0;\n  }, [higlassFocus, higlassMouseOver]);\n\n  const viewConfig = useMemo(\n    () =>\n      pipe(\n        updateViewConfigVariantTracks(variantTracks),\n        updateViewConfigFocusGene(\n          focusGeneOption ? focusGeneOption.geneName : null,\n          focusGeneStart,\n          focusGeneEnd\n        ),\n        updateViewConfigFocusVariant(focusVariantPosition, [2, 4]),\n        updateViewConfigFocusStyle(hideUnfocused),\n        updateViewConfigColorEncoding(colorEncoding),\n        updateViewConfigVariantYScale(variantYScale),\n        updateViewConfigXDomain(xDomainStartAbs, xDomainEndAbs, {\n          force: shouldSkipUpdatingXDomain,\n        }),\n        updateViewConfigFilter(selectedSamples),\n        updateViewConfigMatrixHeight(numSamples)\n      )(deepClone(DEFAULT_VIEW_CONFIG_ENHANCER)),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [\n      // `xDomainStartAbs` and `xDomainEndAbs` are ommitted on purpose to avoid\n      // updating the view-config on every pan or zoom event.\n      variantTracks,\n      focusGeneOption,\n      focusGeneStart,\n      focusGeneEnd,\n      focusVariantPosition,\n      hideUnfocused,\n      colorEncoding,\n      variantYScale,\n      selectedSamples,\n      numSamples,\n    ]\n  );\n\n  const viewConfigHeight = useMemo(\n    () =>\n      viewConfig.views[0].tracks.top.reduce(\n        (height, track) => height + track.height,\n        0\n      ),\n    [viewConfig]\n  );\n\n  const higlassBlockClasses = useMemo(\n    () => (higlassFocus ? 'higlass-block focus' : 'higlass-block'),\n    [higlassFocus]\n  );\n\n  // HiGlass Functions\n  const higlassClickHandler = (event) => {\n    if (event.type === 'gene-annotation') {\n      setFocusGene(event.payload.name);\n      higlassEnhancerClickSelection.current = true;\n      setFocusGeneOption({\n        chr: event.payload.fields[0],\n        txStart: event.payload.fields[1],\n        txEnd: event.payload.fields[2],\n        geneName: event.payload.name,\n        type: 'gene',\n      });\n    } else if (event.type === 'snp') {\n      setFocusVariant(event.payload.name);\n      higlassEnhancerClickSelection.current = true;\n      setFocusVariantOption({\n        chr: event.payload.fields[0],\n        txStart: event.payload.fields[1],\n        txEnd: event.payload.fields[2],\n        geneName: event.payload.name,\n        score: event.payload.importance,\n        type: 'variant',\n      });\n    } else if (event.type === 'annotation') {\n      console.log('clicked on annotation', event.payload);\n    }\n  };\n\n  const higlassLocationChangeHandler = (event) => {\n    const [newXDomainStart, newXDomainEnd] = event.xDomain.map((absPos) =>\n      chromInfo.absToChr(absPos).slice(0, 2).join(':')\n    );\n    setXDomainStart(newXDomainStart);\n    setXDomainEnd(newXDomainEnd);\n  };\n  const higlassLocationChangeHandlerDb = debounce(\n    higlassLocationChangeHandler,\n    250\n  );\n\n  const windowMouseDownClearHandler = useCallback((e) => {\n    if (!isParentOf(e.target, higlassContainerRef.current)) {\n      setHiglassFocus(false);\n    }\n    higlassMouseDown.current = false;\n  }, []);\n\n  useEffect(\n    () => {\n      window.addEventListener('mouseup', windowMouseDownClearHandler);\n      window.addEventListener('blur', windowMouseDownClearHandler);\n    },\n    // Execute only once on initialization\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n\n  const higlassMouseDownHandler = useCallback(() => {\n    higlassMouseDown.current = true;\n  }, []);\n\n  const higlassInitHandler = useCallback(\n    (higlassInstance) => {\n      if (higlassInstance !== null) {\n        setHiglass(higlassInstance.api);\n        higlassInstance.api.on('click', higlassClickHandler);\n        higlassInstance.api.on(\n          'location',\n          higlassLocationChangeHandlerDb,\n          'context'\n        );\n        higlassInstance.api\n          .getComponent()\n          .element.addEventListener('mousedown', higlassMouseDownHandler);\n      }\n    },\n    // Execute only once on initialization\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n\n  const higlassFocusHandler = () => {\n    setHiglassFocus(true);\n  };\n\n  const higlassBlurHandler = () => {\n    if (!higlassMouseDown.current) {\n      setHiglassFocus(false);\n    }\n  };\n\n  const higlassContainerMouseEnterHandler = () => {\n    setHiglassMouseOver(true);\n  };\n\n  const higlassContainerMouseLeaveHandler = () => {\n    setHiglassMouseOver(false);\n  };\n\n  // Run on every render\n  const classes = useStyles();\n\n  return (\n    <div className={classes.root}>\n      <TitleBar\n        id=\"enhancer-regions\"\n        title=\"Enhancer Regions\"\n        useShowInfo={useEnhancerRegionsShowInfos}\n        Info={EnhancerRegionsInfo}\n        Help={EnhancerRegionsHelp}\n        Settings={EnhancerRegionsSettings}\n      />\n      <div\n        className={`higlass-container ${classes.higlassContainer}`}\n        onMouseEnter={higlassContainerMouseEnterHandler}\n        onMouseLeave={higlassContainerMouseLeaveHandler}\n        ref={higlassContainerRef}\n        style={{ height: `${viewConfigHeight}px` }}\n      >\n        {higlassFocus &&\n          !higlassMouseOver &&\n          higlassNumFocus.current < 2 &&\n          higlassNumFocusMouseOut.current < 1 && (\n            <Typography\n              // Just a hack to trigger a dom rerendering which in turn\n              // triggers the fadeout animation\n              component=\"div\"\n              className={`panZoomTip ${classes.panZoomTip} ${classes.panZoomTipActive}`}\n              noWrap\n            >\n              Click outside to deactivate pan & zoom!\n            </Typography>\n          )}\n        {higlassFocus &&\n          higlassMouseOver &&\n          higlassNumFocus.current < 2 &&\n          higlassNumFocusMouseOut.current < 1 && (\n            <Typography\n              // Just a hack to trigger a dom rerendering which in turn\n              // triggers the fadeout animation\n              component=\"span\"\n              className={`panZoomTip ${classes.panZoomTip} ${classes.panZoomTipActiveHover}`}\n              noWrap\n            >\n              You can now pan & zoom the plot!\n            </Typography>\n          )}\n        {!higlassFocus && higlassMouseOver && higlassNumMouseOver.current < 2 && (\n          <Typography\n            // Just a hack to trigger a dom rerendering which in turn\n            // triggers the fadeout animation\n            component=\"div\"\n            className={`panZoomTip ${classes.panZoomTip} ${classes.panZoomTipNormalHover}`}\n            noWrap\n          >\n            Click to activate pan & zoom!\n          </Typography>\n        )}\n        {!higlassFocus && !higlassMouseOver && higlassNumMouseOver.current < 2 && (\n          <Typography\n            // Just a hack to trigger a dom rerendering which in turn\n            // triggers the fadeout animation\n            component=\"span\"\n            className={`panZoomTip ${classes.panZoomTip} ${classes.panZoomTipNormal}`}\n            noWrap\n          >\n            This plot is interactive!\n          </Typography>\n        )}\n        <div\n          className={higlassBlockClasses}\n          onMouseDown={higlassMouseDownHandler}\n          onFocus={higlassFocusHandler}\n          onBlur={higlassBlurHandler}\n          tabIndex=\"0\"\n        />\n        <HiGlassComponent\n          ref={higlassInitHandler}\n          viewConfig={viewConfig}\n          options={{\n            sizeMode: 'bounded',\n            globalMousePosition: true,\n          }}\n        />\n      </div>\n    </div>\n  );\n});\n\nexport default EnhancerRegion;\n","import React from 'react';\nimport { useRecoilValue } from 'recoil';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport {\n  enhancerGenesCellEncodingState,\n  enhancerGenesShowInfoState,\n  focusVariantState,\n} from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n    justifyContent: 'space-between',\n  },\n  text: {\n    fontSize: '0.8rem',\n    verticalAlign: 'center',\n  },\n  placeholder: {\n    fontStyle: 'italic',\n    color: theme.palette.grey['600'],\n  },\n  small: {\n    fontSize: '0.5em',\n    lineHeight: '2em',\n  },\n  medium: {\n    fontSize: '1em',\n    lineHeight: '1em',\n  },\n  large: {\n    fontSize: '1.5em',\n    lineHeight: '0.6667em',\n    marginLeft: '-0.05rem',\n    marginRight: '0.1rem',\n  },\n}));\n\nconst EnhancerRegionsInfo = React.memo(function EnhancerRegionsInfo() {\n  const showInfo = useRecoilValue(enhancerGenesShowInfoState);\n  const focusVariant = useRecoilValue(focusVariantState);\n  const cellEncoding = useRecoilValue(enhancerGenesCellEncodingState);\n\n  const classes = useStyles();\n\n  if (!showInfo) return '';\n\n  return (\n    <div>\n      {!focusVariant && (\n        <Grid\n          container\n          justify=\"center\"\n          alignItems=\"center\"\n          className={classes.placeholder}\n        >\n          <Typography className={classes.text}>\n            Select a variant to see details\n          </Typography>\n        </Grid>\n      )}\n      {focusVariant && cellEncoding === 'number' && (\n        <React.Fragment>\n          <Typography className={classes.text}>\n            <span className={classes.small}></span>\n            <span className={classes.medium}></span>\n            <span className={classes.large}></span>\n            <strong>Absolute number</strong> of enhancer-gene connections\n            overlapping <em>{focusVariant}</em> by sample groups across\n            up/downstream genes.\n          </Typography>\n        </React.Fragment>\n      )}\n      {focusVariant && cellEncoding === 'percent' && (\n        <React.Fragment>\n          <Typography className={classes.text}>\n            <span className={classes.small}></span>\n            <span className={classes.medium}></span>\n            <span className={classes.large}></span>\n            <strong>Percentage</strong> of enhancer-gene connections overlapping{' '}\n            <em>{focusVariant}</em> within a sample group across up/downstream\n            genes.\n          </Typography>\n        </React.Fragment>\n      )}\n      {focusVariant && cellEncoding === 'distribution' && (\n        <React.Fragment>\n          <Typography className={classes.text}>\n            <strong>Distribution</strong> of the prediction scores of\n            enhancer-gene connections overlapping <em>{focusVariant}</em> by\n            sample group across up/downstream genes.\n          </Typography>\n        </React.Fragment>\n      )}\n      {focusVariant && cellEncoding === 'array' && (\n        <React.Fragment>\n          <Typography className={classes.text}>\n            <span></span>\n            <strong>Presence</strong> of enhancer-gene connections overlapping{' '}\n            <em>{focusVariant}</em> by samples across sample groups and\n            up/downstream genes.\n          </Typography>\n        </React.Fragment>\n      )}\n    </div>\n  );\n});\n\nexport default EnhancerRegionsInfo;\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\n\nconst EnhancerRegionsHelp = React.memo(function EnhancerRegionsHelp() {\n  return (\n    <React.Fragment>\n      <Typography>...</Typography>\n    </React.Fragment>\n  );\n});\n\nexport default EnhancerRegionsHelp;\n","import Switch from '@material-ui/core/Switch';\nimport { withStyles } from '@material-ui/core/styles';\n\nconst AntSwitch = withStyles((theme) => ({\n  root: {\n    width: 36,\n    height: 24,\n    padding: 4,\n    margin: '-4px 0 -4px -4px',\n    display: 'flex',\n    borderRadius: 24,\n    transition: 'background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\n    '&:hover': {\n      backgroundColor: 'rgba(0, 0, 0, 0.04)',\n    },\n  },\n  switchBase: {\n    top: 4,\n    left: 4,\n    padding: 2,\n    color: theme.palette.grey[500],\n    '&$checked': {\n      transform: 'translateX(12px)',\n      color: theme.palette.common.white,\n      '& + $track': {\n        opacity: 1,\n        backgroundColor: theme.palette.primary.main,\n        borderColor: theme.palette.primary.main,\n      },\n    },\n  },\n  thumb: {\n    width: 12,\n    height: 12,\n    boxShadow: 'none',\n  },\n  track: {\n    border: `1px solid ${theme.palette.grey[500]}`,\n    borderRadius: 16 / 2,\n    opacity: 1,\n    backgroundColor: theme.palette.common.white,\n  },\n  checked: {},\n}))(Switch);\n\nexport default AntSwitch;\n","import React from 'react';\nimport Box from '@material-ui/core/Box';\nimport IconButton from '@material-ui/core/IconButton';\nimport RadioButtonCheckedIcon from '@material-ui/icons/RadioButtonChecked';\nimport RadioButtonUncheckedIcon from '@material-ui/icons/RadioButtonUnchecked';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport RadioGroup from '@material-ui/core/RadioGroup';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport AntSwitch from './AntSwitch';\n\nimport { useEnhancerGenesCellEncoding, useEnhancerGenesPadding } from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  iconRadio: {\n    padding: theme.spacing(0.5, 0),\n    marginLeft: -theme.spacing(1) / 2,\n    '& .MuiFormControlLabel-label': {\n      lineHeight: 1.2,\n    },\n  },\n  iconRadioActive: {\n    color: 'black',\n  },\n  iconRadioLegend: {\n    margin: theme.spacing(2, 0, 0.25, 0),\n  },\n  switch: {\n    margin: 0,\n  },\n}));\n\nconst EnhancerGenesSettings = React.memo(function EnhancerGenesSettings() {\n  const [cellEncoding, setCellEncoding] = useEnhancerGenesCellEncoding();\n  const [padding, setPadding] = useEnhancerGenesPadding();\n\n  const changeCellEncoding = (value) => () => {\n    setCellEncoding(value);\n  };\n\n  const changePadding = (event) => {\n    setPadding(event.target.checked);\n  };\n\n  const classes = useStyles();\n\n  return (\n    <React.Fragment>\n      <Box m={1}>\n        <FormControlLabel\n          className={classes.switch}\n          control={\n            <AntSwitch checked={padding} onChange={changePadding} name=\"true\" />\n          }\n          label=\"Gene padding\"\n        />\n      </Box>\n      <Box m={1}>\n        <FormControl component=\"fieldset\">\n          <FormLabel component=\"legend\" className={classes.iconRadioLegend}>\n            Gene Cell Encoding\n          </FormLabel>\n          <RadioGroup\n            aria-label=\"cellEncoding\"\n            name=\"cellEncoding\"\n            value={cellEncoding}\n          >\n            <FormControlLabel\n              label=\"Abs. number of predictions\"\n              value=\"number\"\n              className={classes.iconRadio}\n              control={\n                <IconButton size=\"small\" onClick={changeCellEncoding('number')}>\n                  {cellEncoding === 'number' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Rel. number of predictions per group\"\n              value=\"percent\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeCellEncoding('percent')}\n                >\n                  {cellEncoding === 'percent' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Distribution by prediction score\"\n              value=\"distribution\"\n              className={classes.iconRadio}\n              control={\n                <IconButton\n                  size=\"small\"\n                  onClick={changeCellEncoding('distribution')}\n                >\n                  {cellEncoding === 'distribution' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n            <FormControlLabel\n              label=\"Sample array\"\n              value=\"array\"\n              className={classes.iconRadio}\n              control={\n                <IconButton size=\"small\" onClick={changeCellEncoding('array')}>\n                  {cellEncoding === 'array' ? (\n                    <RadioButtonCheckedIcon\n                      className={classes.iconRadioActive}\n                      fontSize=\"inherit\"\n                    />\n                  ) : (\n                    <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                  )}\n                </IconButton>\n              }\n            />\n          </RadioGroup>\n        </FormControl>\n      </Box>\n    </React.Fragment>\n  );\n});\n\nexport default EnhancerGenesSettings;\n","import React, { createContext, useCallback, useState } from 'react';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst TooltipContext = createContext();\n\nconst useStyles = makeStyles({\n  root: {\n    position: 'fixed',\n    zIndex: 10,\n    width: 1,\n    height: 1,\n    background: 'black',\n    fontWeight: 'normal',\n    pointerEvents: 'none',\n    '& strong': {\n      fontWeight: 'bold',\n    },\n  },\n});\n\nexport default function TooltipProvider({ children }) {\n  const [localState, setLocalState] = useState({\n    show: false,\n    title: '',\n    x: 0,\n    y: 0,\n    arrow: true,\n    placement: 'bottom',\n    classes: {},\n  });\n\n  const showTooltip = useCallback(\n    (\n      x,\n      y,\n      title,\n      { arrow = false, placement = 'bottom', classes = {} } = {}\n    ) => {\n      if (Number.isNaN(+x) || Number.isNaN(+y) || !title) {\n        // Close tooltip\n        setLocalState({\n          show: false,\n          title: '',\n          x: 0,\n          y: 0,\n          arrow: true,\n          placement: 'bottom',\n          classes: {},\n        });\n      } else {\n        // Open tooltip\n        setLocalState({\n          show: true,\n          x,\n          y,\n          title,\n          arrow,\n          placement,\n          classes,\n        });\n      }\n    },\n    []\n  );\n\n  const classes = useStyles();\n\n  return (\n    <TooltipContext.Provider value={showTooltip}>\n      {children}\n      <Tooltip\n        open={localState.show}\n        title={localState.title}\n        arrow={localState.arrow}\n        placement={localState.placement}\n        classes={localState.classes}\n      >\n        <div\n          className={classes.root}\n          style={{\n            top: localState.y,\n            left: localState.x,\n          }}\n        />\n      </Tooltip>\n    </TooltipContext.Provider>\n  );\n}\n\nfunction useShowTooltip() {\n  const context = React.useContext(TooltipContext);\n  if (context === undefined) {\n    throw new Error('useShowTooltip must be used within a TooltipContext');\n  }\n  return context;\n}\n\nexport { useShowTooltip };\n","import { identity } from '@flekschas/utils';\nimport { axisRight, scaleLinear, scaleLog, select } from 'd3';\nimport React, {\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useMemo,\n  useState,\n} from 'react';\nimport { useRecoilValue, useRecoilState } from 'recoil';\nimport TinyQueue from 'tinyqueue';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport { useChromInfo } from './ChromInfoProvider';\nimport { useShowTooltip } from './TooltipProvider';\n\nimport {\n  enhancerGenesCellEncodingState,\n  enhancerGenesPaddingState,\n  enhancerGenesSvgState,\n  focusVariantPositionWithAssembly,\n  focusVariantRelPositionState,\n  focusVariantState,\n  focusVariantStrPositionState,\n  sampleSelectionState,\n  sampleGroupSelectionSizesState,\n} from './state';\n\nimport {\n  DEFAULT_COLOR_MAP,\n  DEFAULT_COLOR_MAP_DARK,\n  DEFAULT_COLOR_MAP_LIGHT,\n  DEFAULT_STRATIFICATION,\n  DEFAULT_VIEW_CONFIG_ENHANCER,\n  SAMPLE_IDX,\n} from './constants';\nimport { scaleBand } from './utils';\nimport usePrevious from './use-previous';\n\nimport './EnhancerGenesPlot.css';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    color: theme.palette.grey['300'],\n    minHeight: '6rem',\n  },\n  plot: {\n    position: 'relative',\n    flexGrow: 1,\n  },\n  plotSvg: {\n    width: '100%',\n    height: '100%',\n  },\n}));\n\nconst useTooltipStyles = DEFAULT_COLOR_MAP_LIGHT.map((color, i) =>\n  makeStyles((theme) => ({\n    arrow: {\n      color,\n    },\n    tooltip: {\n      color: DEFAULT_COLOR_MAP_DARK[i],\n      backgroundColor: color,\n      boxShadow: '0 0 3px 0 rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(0, 0, 0, 0.05)',\n      '& .value': {\n        color: 'white',\n        background: DEFAULT_COLOR_MAP_DARK[i],\n        padding: '0 0.25em',\n        borderRadius: '0.25rem',\n      },\n    },\n  }))\n);\n\nconst {\n  server,\n  tilesetUid: uuid,\n} = DEFAULT_VIEW_CONFIG_ENHANCER.views[0].tracks.top[3].contents[1];\n\nconst fetchTile = async (tileId) => {\n  const response = await fetch(`${server}/tiles/?d=${tileId}`);\n  return response.json();\n};\n\nconst categories = {};\nconst samples = {};\n\nDEFAULT_STRATIFICATION.groups.forEach((group, i) => {\n  categories[group.label] = {\n    name: group.label,\n    size: group.categories.length,\n    index: i,\n  };\n\n  group.categories.forEach((category, j) => {\n    samples[category] = {\n      category: categories[group.label],\n      index: j,\n    };\n  });\n});\n\nconst getTileWidth = (tilesetInfo) =>\n  tilesetInfo.max_width / 2 ** tilesetInfo.max_zoom;\n\nconst filterByPosition = (tile, position) =>\n  tile.filter((entry) => position >= entry.xStart && position <= entry.xEnd);\n\n// From https://observablehq.com/@d3/beeswarm\nconst dodge = (data, radius, yScale) => {\n  const radius2 = radius ** 2;\n  const circles = data\n    .map((d) => ({ y: yScale(d.value), data: d }))\n    .sort((a, b) => a.y - b.y);\n  const epsilon = 1e-3;\n  let head = null;\n  let tail = null;\n\n  // Returns true if circle x,y intersects with any circle in the queue.\n  function intersects(x, y) {\n    let a = head;\n    while (a) {\n      if (radius2 - epsilon > (a.x - x) ** 2 + (a.y - y) ** 2) {\n        return true;\n      }\n      a = a.next;\n    }\n    return false;\n  }\n\n  // Place each circle sequentially.\n  for (const b of circles) {\n    // Remove circles from the queue that cant intersect the new circle b.\n    while (head && head.y < b.y - radius2) head = head.next;\n\n    // Choose the minimum non-intersecting tangent.\n    if (intersects((b.x = 0), b.y)) {\n      let a = head;\n      b.x = Infinity;\n      do {\n        const x = a.x + Math.sqrt(radius2 - (a.y - b.y) ** 2);\n        if (x < b.x && !intersects(x, b.y)) b.x = x;\n        a = a.next;\n      } while (a);\n    }\n\n    // Add b to the queue.\n    b.next = null;\n    // eslint-disable-next-line no-multi-assign\n    if (head === null) head = tail = b;\n    // eslint-disable-next-line no-multi-assign\n    else tail = tail.next = b;\n  }\n\n  return circles;\n};\n\nconst plotEnhancerGeneConnections = (\n  node,\n  width,\n  data,\n  {\n    geneCellEncoding = 'distribution',\n    prevGeneCellEncoding,\n    genePadding = false,\n    showTooltip = identity,\n    tooltipClasses = [],\n    position = '',\n    variant = null,\n  } = {}\n) => {\n  if (!width || !data) return;\n\n  const svg = select(node);\n\n  const paddingTop = 60;\n  const paddingBottom = 60;\n  const circleRadius = 1;\n  const circlePadding = 0.5;\n  const rowHeight = 36;\n  const geneLabelPadding = 3;\n  const beeswarmPadding = 1;\n  const distanceBarWidth = 6;\n  const distPaddingRange = [0, 20];\n  const height =\n    Object.values(categories).length * rowHeight + paddingTop + paddingBottom;\n\n  svg.attr('viewbox', `0 0 ${width} ${height}`).attr('height', height);\n\n  const maxCatgorySize = Object.values(data.categoryAggregation).reduce(\n    (max, cat) => Math.max(max, cat.numEnhancers),\n    0\n  );\n  const categorySizeScale = scaleLog()\n    .domain([1, maxCatgorySize])\n    .range([2, rowHeight])\n    .clamp(true);\n\n  const percentScale = scaleLinear()\n    .domain([0, 1])\n    .range([0, rowHeight])\n    .clamp(true);\n\n  const circleYScalePre = scaleLinear()\n    .domain([0, 1])\n    .range([1, 10])\n    .clamp(true);\n\n  const circleYScalePost = scaleLog()\n    .domain([1, 10])\n    .range([\n      rowHeight - circleRadius - beeswarmPadding,\n      circleRadius + beeswarmPadding,\n    ]);\n\n  const circleYScale = (v) => circleYScalePost(circleYScalePre(v));\n\n  // ---------------------------------------------------------------------------\n  // Gene setup\n  const geneContainerWidth = width / 2 - rowHeight;\n  const maxGenes = Math.floor(geneContainerWidth / rowHeight);\n\n  const genesUpstream = data.genesUpstreamByDist.slice(0, maxGenes).reverse();\n  const genesDownstream = data.genesDownstreamByDist.slice(0, maxGenes);\n\n  const [minRelDistance, maxRelDistance] = [\n    ...genesUpstream,\n    ...genesDownstream,\n  ].reduce(\n    (minMax, gene) => [\n      Math.min(minMax[0], gene.relDistance),\n      Math.max(minMax[1], gene.relDistance),\n    ],\n    [Infinity, 0]\n  );\n\n  const paddingScale = scaleLinear()\n    .domain([minRelDistance, maxRelDistance])\n    .range(distPaddingRange);\n\n  const genesUpstreamPadding = genePadding\n    ? genesUpstream.map((d) => Math.round(paddingScale(d.relDistance)))\n    : [];\n  const genesUpstreamScale = scaleBand()\n    .domain(genesUpstream.map((d) => d.name))\n    .range([0, width / 2 - rowHeight / 2])\n    .paddingInner(genesUpstreamPadding);\n\n  const genesDownstreamPadding = genePadding\n    ? genesDownstream.map((d) => Math.round(paddingScale(d.relDistance)))\n    : [];\n  const genesDownstreamScale = scaleBand()\n    .domain(genesDownstream.map((d) => d.name))\n    .range([0, width / 2 - rowHeight / 2])\n    .paddingInner(genesDownstreamPadding)\n    .paddingInnerZeroBased(true);\n\n  const bandwidth = Math.min(\n    genesUpstreamScale.bandwidth(),\n    genesDownstreamScale.bandwidth()\n  );\n\n  genesUpstreamScale.fixedBandwidth(bandwidth);\n  genesDownstreamScale.fixedBandwidth(bandwidth);\n\n  const genesUpstreamLeftPad = Math.max(\n    0,\n    genesUpstreamScale.rangeSize() - genesUpstreamScale.totalWidth()\n  );\n\n  const minVisibleAbsDist = Math.min(\n    genesUpstream.reduce(\n      (minDist, gene) => Math.min(minDist, gene.absDistance),\n      Infinity\n    ),\n    genesDownstream.reduce(\n      (minDist, gene) => Math.min(minDist, gene.absDistance),\n      Infinity\n    )\n  );\n\n  const maxVisibleAbsDist = Math.max(\n    genesUpstream.reduce(\n      (maxDist, gene) => Math.max(maxDist, gene.absDistance),\n      0\n    ),\n    genesDownstream.reduce(\n      (maxDist, gene) => Math.max(maxDist, gene.absDistance),\n      0\n    )\n  );\n\n  const distanceHeightScale = scaleLinear()\n    .domain([minVisibleAbsDist, maxVisibleAbsDist])\n    .range([2, paddingBottom]);\n\n  const plotBeeswarm = (selection, { isRightAligned = false } = {}) => {\n    selection\n      .attr(\n        'fill',\n        (d, i) => DEFAULT_COLOR_MAP_DARK[i % DEFAULT_COLOR_MAP_DARK.length]\n      )\n      .selectAll('circle')\n      .data((d) => dodge(d, circleRadius * 2 + circlePadding, circleYScale))\n      .join('circle')\n      .attr('cx', (d) =>\n        isRightAligned\n          ? genesUpstreamScale.bandwidth() - (d.x + 2 * beeswarmPadding)\n          : d.x + circleRadius + beeswarmPadding\n      )\n      .attr('cy', (d) => d.y)\n      .attr('r', circleRadius);\n  };\n\n  const getArrayNumCols = (genes) => {\n    const maxSize = Object.values(genes[0].samplesByCategory).reduce(\n      (max, cat) => Math.max(max, cat.size),\n      0\n    );\n    return Math.ceil(Math.sqrt((maxSize * bandwidth) / rowHeight));\n  };\n\n  const plotArray = (\n    selection,\n    numCols,\n    {\n      instanceCache = {},\n      onMouseEnter = identity,\n      onMouseLeave = identity,\n      tooltipTitleGetter = null,\n    } = {}\n  ) => {\n    const cellSize = bandwidth / numCols;\n\n    const indexToX = (index) => (index % numCols) * cellSize;\n    const indexToY = (index) => Math.floor(index / numCols) * cellSize;\n\n    instanceCache.current = selection\n      .attr(\n        'fill',\n        (d, i) => DEFAULT_COLOR_MAP_DARK[i % DEFAULT_COLOR_MAP_DARK.length]\n      )\n      .selectAll('rect')\n      .data(\n        (d) => d,\n        (d) => `${d.gene}|${d.sample}`\n      )\n      .join('rect')\n      .attr('x', (d) => indexToX(samples[d.sample].index))\n      .attr('y', (d) => indexToY(samples[d.sample].index))\n      .attr('width', cellSize)\n      .attr('height', cellSize)\n      .on('mouseenter', (event, d) => {\n        const bBox = event.target.getBoundingClientRect();\n        const title =\n          (tooltipTitleGetter && tooltipTitleGetter(d)) || d.value.toFixed(3);\n        showTooltip(bBox.x + bBox.width / 2, bBox.y, title, {\n          arrow: true,\n          placement: 'top',\n          classes:\n            tooltipClasses[\n              categories[d.sampleCategory].index % tooltipClasses.length\n            ],\n        });\n        onMouseEnter(d);\n      })\n      .on('mouseleave', (d) => {\n        showTooltip();\n        onMouseLeave(d);\n      });\n  };\n\n  const arrayTooltipTitleGetter = (d) => (\n    <React.Fragment>\n      The enhancer overlapping <strong>{position}</strong>\n      {variant ? ` (${variant})` : ''} is predicted to regulate{' '}\n      <strong>{d.gene}</strong> in sample <strong>{d.sample}</strong> with a\n      score of <strong className=\"value\">{d.value.toFixed(3)}</strong>.\n    </React.Fragment>\n  );\n\n  const geneArrayInstances = {\n    upstream: { current: null },\n    downstream: { current: null },\n  };\n\n  const geneArrayInstanceMouseEnterHandler = (dHovering) => {\n    const opacity = (d) => (d.sample === dHovering.sample ? 1 : 0.2);\n    geneArrayInstances.upstream.current.attr('opacity', opacity);\n    geneArrayInstances.downstream.current.attr('opacity', opacity);\n  };\n\n  const geneArrayInstanceMouseLeaveHandler = () => {\n    geneArrayInstances.upstream.current.attr('opacity', 1);\n    geneArrayInstances.downstream.current.attr('opacity', 1);\n  };\n\n  const plotBox = (\n    selection,\n    valueScale,\n    valueGetter,\n    {\n      cellWidth = rowHeight,\n      fillColor = DEFAULT_COLOR_MAP_LIGHT,\n      textColor = DEFAULT_COLOR_MAP_DARK,\n      showText = true,\n      showZero = true,\n      showTooltip: showTooltipOnMouseEnter = false,\n      tooltipTitleGetter = null,\n    } = {}\n  ) => {\n    const bg = selection\n      .selectAll('.bg')\n      .data((d) => [d])\n      .join('rect')\n      .attr('class', 'bg')\n      .attr('fill', (d) => fillColor[d.row % fillColor.length])\n      .attr('x', (d) => (cellWidth - valueScale(valueGetter(d))) / 2)\n      .attr('y', (d) => (rowHeight - valueScale(valueGetter(d))) / 2)\n      .attr('width', (d) => valueScale(valueGetter(d)))\n      .attr('height', (d) => valueScale(valueGetter(d)))\n      .attr('opacity', (d) => +(valueGetter(d) > 0));\n\n    if (showTooltipOnMouseEnter) {\n      bg.on('mouseenter', (event, d) => {\n        const bBox = event.target.getBoundingClientRect();\n        const title =\n          (tooltipTitleGetter && tooltipTitleGetter(d)) || valueGetter(d);\n        showTooltip(bBox.x + bBox.width / 2, bBox.y, title, {\n          arrow: true,\n          placement: 'top',\n          classes: tooltipClasses[d.row % tooltipClasses.length],\n        });\n      }).on('mouseleave', () => {\n        showTooltip();\n      });\n    } else {\n      bg.on('mouseenter', null).on('mouseleave', null);\n    }\n\n    if (showText) {\n      selection\n        .selectAll('.box-text')\n        .data((d) => [d])\n        .join('text')\n        .attr('class', 'box-text')\n        .attr('fill', (d) => textColor[d.row % textColor.length])\n        .attr('style', 'font-size: 12px; font-weight: bold;')\n        .attr('dominant-baseline', 'middle')\n        .attr('text-anchor', 'middle')\n        .attr('x', cellWidth / 2)\n        .attr('y', rowHeight / 2)\n        .attr('opacity', (d) => +(valueGetter(d) > 0 || showZero))\n        .text((d) => valueGetter(d));\n    }\n  };\n\n  const boxTooltipTitleGetter = (d) => (\n    <React.Fragment>\n      <strong className=\"value\">{d.length}</strong> out of {d.size}{' '}\n      <em>{Object.values(categories)[d.row].name}</em> samples have predicted\n      enhancer activity.\n    </React.Fragment>\n  );\n\n  // ---------------------------------------------------------------------------\n  // Category summary\n  const enhancerG = svg\n    .select('#enhancers')\n    .attr('transform', `translate(${width / 2 - rowHeight / 2}, 0)`);\n\n  // Draw background\n  const enhancerGCellG = enhancerG\n    .selectAll('.enhancer-gene-aggregate')\n    .data(\n      Object.values(data.categoryAggregation).map((d, i) => {\n        // Little hacky but necessary unfortunately\n        d.row = i;\n        return d;\n      }),\n      (d) => d.category.name\n    )\n    .join('g')\n    .attr('class', 'enhancer-gene-aggregate')\n    .attr('transform', (d, i) => `translate(0, ${i * rowHeight + paddingTop})`);\n\n  plotBox(enhancerGCellG, categorySizeScale, (d) => d.numEnhancers);\n\n  // Draw border\n  svg\n    .select('#enhancers')\n    .selectAll('.enhancer-box-border')\n    .data(Object.values(categories), (d) => d.name)\n    .join('rect')\n    .attr('class', 'enhancer-box-border')\n    .attr('fill', 'none')\n    .attr(\n      'stroke',\n      (d, i) => DEFAULT_COLOR_MAP_LIGHT[i % DEFAULT_COLOR_MAP_LIGHT.length]\n    )\n    .attr('stroke-width', '1')\n    .attr('x', 0)\n    .attr('y', (d, i) => i * rowHeight + paddingTop)\n    .attr('width', rowHeight)\n    .attr('height', rowHeight);\n\n  // ---------------------------------------------------------------------------\n  // Draw upstream genes\n\n  const genesUpstreamG = svg\n    .select('#genes-upstream')\n    .selectAll('.gene-upstream')\n    .data(genesUpstream, (d) => d.name)\n    .join('g')\n    .attr('class', 'gene-upstream')\n    .attr(\n      'transform',\n      (d) =>\n        `translate(${genesUpstreamLeftPad + genesUpstreamScale(d.name)}, 0)`\n    );\n\n  // Draw labels\n  const geneLabelX = genesUpstreamScale.bandwidth() / 2;\n  const geneLabelY = paddingTop - geneLabelPadding;\n  genesUpstreamG\n    // the join is needed to avoid appending more and more text elements on\n    // subsequent calls of this function, which would happen if we used\n    // `append()` instead.\n    .selectAll('.gene-upstream-label')\n    .data((d) => [d])\n    .join('text')\n    .attr('class', 'gene-label gene-upstream-label')\n    .attr('style', 'font-size: 9px;')\n    .attr('transform', `translate(${geneLabelX},${geneLabelY}) rotate(-90)`)\n    .attr('fill', 'black')\n    .attr('dominant-baseline', 'middle')\n    .text((d) => d.name);\n\n  // Draw cell\n  const genesUpstreamGCellG = genesUpstreamG\n    .selectAll('.gene-upstream-cell')\n    .data(\n      (d) =>\n        Object.values(d.samplesByCategory).map((item, i) => {\n          // Little hacky but necessary unfortunately\n          item.row = i;\n          return item;\n        }),\n      (d) => d.name\n    )\n    .join('g')\n    .attr('class', 'gene-upstream-cell')\n    .attr('transform', (d, i) => `translate(0, ${i * rowHeight + paddingTop})`);\n\n  if (geneCellEncoding !== prevGeneCellEncoding) {\n    genesUpstreamGCellG.selectAll('*').remove();\n  }\n\n  switch (geneCellEncoding) {\n    case 'distribution':\n      plotBeeswarm(genesUpstreamGCellG, { isRightAligned: true });\n      break;\n\n    case 'array':\n      plotArray(genesUpstreamGCellG, getArrayNumCols(genesUpstream), {\n        tooltipTitleGetter: arrayTooltipTitleGetter,\n        instanceCache: geneArrayInstances.upstream,\n        onMouseEnter: geneArrayInstanceMouseEnterHandler,\n        onMouseLeave: geneArrayInstanceMouseLeaveHandler,\n      });\n      break;\n\n    case 'number':\n    case 'percent':\n    default: {\n      const valueScale =\n        geneCellEncoding === 'percent' ? percentScale : categorySizeScale;\n\n      const valueGetter =\n        geneCellEncoding === 'percent'\n          ? (d) => d.length / d.size\n          : (d) => d.length;\n\n      plotBox(genesUpstreamGCellG, valueScale, valueGetter, {\n        showText: false,\n        cellWidth: genesUpstreamScale.bandwidth(),\n        fillColor: DEFAULT_COLOR_MAP,\n        showTooltip: true,\n        tooltipTitleGetter: boxTooltipTitleGetter,\n      });\n\n      break;\n    }\n  }\n\n  // Draw border\n  genesUpstreamG\n    .selectAll('.gene-upstream-border')\n    .data(Object.values(categories), (d) => d.name)\n    .join('rect')\n    .attr('class', 'gene-upstream-border')\n    .attr('fill', 'none')\n    .attr(\n      'stroke',\n      (d, i) => DEFAULT_COLOR_MAP_LIGHT[i % DEFAULT_COLOR_MAP_LIGHT.length]\n    )\n    .attr('stroke-width', '1')\n    .attr('x', 0)\n    .attr('y', (d, i) => i * rowHeight + paddingTop)\n    .attr('width', genesUpstreamScale.bandwidth())\n    .attr('height', rowHeight);\n\n  // Draw distance bars\n  genesUpstreamG\n    // Same reason we're using a join here as for the text labels above\n    .selectAll('.gene-upstream-distance-bar')\n    .data((d) => [d])\n    .join('rect')\n    .attr('class', 'gene-upstream-distance-bar')\n    .attr('fill', '#bbbbbb')\n    .attr('x', genesUpstreamScale.bandwidth() / 2 - distanceBarWidth / 2)\n    .attr('y', Object.values(categories).length * rowHeight + paddingTop)\n    .attr('width', distanceBarWidth)\n    .attr('height', (d) => distanceHeightScale(d.absDistance));\n\n  // ---------------------------------------------------------------------------\n  // Draw downstream genes\n  svg\n    .select('#genes-downstream')\n    .attr('transform', `translate(${width / 2 + rowHeight / 2}, 0)`);\n\n  const genesDownstreamG = svg\n    .select('#genes-downstream')\n    .selectAll('.gene-downstream')\n    .data(genesDownstream, (d) => d.name)\n    .join('g')\n    .attr('class', 'gene-downstream')\n    .attr('transform', (d) => `translate(${genesDownstreamScale(d.name)}, 0)`);\n\n  // Draw labels\n  genesDownstreamG\n    .selectAll('.gene-downstream-label')\n    .data((d) => [d])\n    .join('text')\n    .attr('class', 'gene-label gene-downstream-label')\n    .attr('style', 'font-size: 9px;')\n    .attr('transform', `translate(${geneLabelX},${geneLabelY}) rotate(-90)`)\n    .attr('fill', 'black')\n    .attr('dominant-baseline', 'middle')\n    .text((d) => d.name);\n\n  // Draw cell\n  const genesDownstreamGCellG = genesDownstreamG\n    .selectAll('.gene-downstream-cell')\n    .data(\n      (d) =>\n        Object.values(d.samplesByCategory).map((item, i) => {\n          // Little hacky but necessary unfortunately\n          item.row = i;\n          return item;\n        }),\n      (d) => d.name\n    )\n    .join('g')\n    .attr('class', 'gene-downstream-cell')\n    .attr('transform', (d, i) => `translate(0, ${i * rowHeight + paddingTop})`);\n\n  if (geneCellEncoding !== prevGeneCellEncoding) {\n    genesDownstreamGCellG.selectAll('*').remove();\n  }\n\n  switch (geneCellEncoding) {\n    case 'distribution':\n      plotBeeswarm(genesDownstreamGCellG);\n      break;\n\n    case 'array':\n      plotArray(genesDownstreamGCellG, getArrayNumCols(genesDownstream), {\n        tooltipTitleGetter: arrayTooltipTitleGetter,\n        instanceCache: geneArrayInstances.downstream,\n        onMouseEnter: geneArrayInstanceMouseEnterHandler,\n        onMouseLeave: geneArrayInstanceMouseLeaveHandler,\n      });\n      break;\n\n    case 'number':\n    case 'percent':\n    default: {\n      const valueScale =\n        geneCellEncoding === 'percent' ? percentScale : categorySizeScale;\n\n      const valueGetter =\n        geneCellEncoding === 'percent'\n          ? (d) => d.length / d.size\n          : (d) => d.length;\n\n      plotBox(genesDownstreamGCellG, valueScale, valueGetter, {\n        showText: false,\n        cellWidth: genesDownstreamScale.bandwidth(),\n        fillColor: DEFAULT_COLOR_MAP,\n        showTooltip: true,\n        tooltipTitleGetter: boxTooltipTitleGetter,\n      });\n\n      break;\n    }\n  }\n\n  // Draw border\n  genesDownstreamG\n    .selectAll('.gene-downstream-border')\n    .data(Object.values(categories), (d) => d.name)\n    .join('rect')\n    .attr('class', 'gene-downstream-border')\n    .attr('fill', 'none')\n    .attr(\n      'stroke',\n      (d, i) => DEFAULT_COLOR_MAP_LIGHT[i % DEFAULT_COLOR_MAP_LIGHT.length]\n    )\n    .attr('stroke-width', '1')\n    .attr('x', 0)\n    .attr('y', (d, i) => i * rowHeight + paddingTop)\n    .attr('width', genesDownstreamScale.bandwidth())\n    .attr('height', rowHeight);\n\n  // Draw distance bars\n  genesDownstreamG\n    // Same reason we're using a join here as for the text labels above\n    .selectAll('.gene-downstream-distance-bar')\n    .data((d) => [d])\n    .join('rect')\n    .attr('class', 'gene-downstream-distance-bar')\n    .attr('fill', '#bbbbbb')\n    .attr('x', genesDownstreamScale.bandwidth() / 2 - distanceBarWidth / 2)\n    .attr('y', Object.values(categories).length * rowHeight + paddingTop)\n    .attr('width', distanceBarWidth)\n    .attr('height', (d) => distanceHeightScale(d.absDistance));\n\n  // ---------------------------------------------------------------------------\n  // Draw gene distance axis\n\n  const distRange = Math.ceil((maxVisibleAbsDist - minVisibleAbsDist) / 1e5);\n  const distStep = Math.ceil(distRange / 4);\n  const tickValues =\n    distRange <= 1\n      ? [minVisibleAbsDist, maxVisibleAbsDist]\n      : Array(4)\n          .fill()\n          .map(\n            (v, i) =>\n              Math.ceil(minVisibleAbsDist / 1e5) * 1e5 + i * (distStep * 1e5)\n          );\n\n  svg\n    .select('#gene-distance-axis')\n    .attr(\n      'transform',\n      `translate(0, ${\n        Object.values(categories).length * rowHeight + paddingTop\n      })`\n    )\n    .call(\n      axisRight(distanceHeightScale)\n        .tickSize(width)\n        .tickFormat(function geneDistanceAxisTickFormat(d) {\n          const s = (d / 1e5).toFixed(0);\n          return this.parentNode.nextSibling\n            ? s\n            : `${s} kbps distance to enhancer`;\n        })\n        .tickValues(tickValues)\n    )\n    .call((g) => g.select('.domain').remove())\n    .call((g) =>\n      g\n        .selectAll('.tick line')\n        .attr('stroke', '#bbbbbb')\n        .attr('stroke-width', 0.5)\n        .attr('stroke-dasharray', '4,4')\n    )\n    .call((g) =>\n      g\n        .selectAll('.tick text')\n        .attr('fill', '#bbbbbb')\n        .attr('x', width / 2)\n        .attr('dy', 1)\n        .attr('text-anchor', 'middle')\n        .attr('dominant-baseline', 'hanging')\n    );\n};\n\nconst EnhancerGenesPlot = React.memo(function EnhancerGenesPlot() {\n  const chromInfo = useChromInfo();\n  const showTooltip = useShowTooltip();\n\n  const sampleSelection = useRecoilValue(sampleSelectionState);\n  const sampleGroupSelectionSizes = useRecoilValue(\n    sampleGroupSelectionSizesState\n  );\n  const geneCellEncoding = useRecoilValue(enhancerGenesCellEncodingState);\n  const position = useRecoilValue(focusVariantPositionWithAssembly(chromInfo));\n  const relPosition = useRecoilValue(focusVariantRelPositionState);\n  const strPosition = useRecoilValue(focusVariantStrPositionState);\n  const genePadding = useRecoilValue(enhancerGenesPaddingState);\n  const variant = useRecoilValue(focusVariantState);\n\n  const [plotEl, setPlotEl] = useRecoilState(enhancerGenesSvgState);\n\n  const [tile, setTile] = useState(null);\n  const [isLoadingTile, setIsLoadingTile] = useState(null);\n  const [tilesetInfo, setTilesetInfo] = useState(null);\n  const [width, setWidth] = useState(null);\n  const prevWidth = usePrevious(width);\n  const prevGeneCellEncoding = usePrevious(geneCellEncoding);\n\n  useEffect(() => {\n    let active = true;\n\n    if (position === null || tilesetInfo === null) return undefined;\n\n    const tileWidth = getTileWidth(tilesetInfo);\n    const tileXPos = Math.floor(position / tileWidth);\n    const tileId = `${uuid}.${tilesetInfo.max_zoom}.${tileXPos}`;\n\n    setIsLoadingTile(true);\n    fetchTile(tileId).then((_tile) => {\n      if (active) {\n        setIsLoadingTile(false);\n        setTile(filterByPosition(_tile[tileId], position));\n      }\n    });\n\n    return () => {\n      active = false;\n    };\n  }, [position, tilesetInfo]);\n\n  const plotElRef = useCallback(\n    (node) => {\n      setPlotEl(node);\n    },\n    [setPlotEl]\n  );\n\n  // Derived State\n  const isInit = useMemo(() => !!tilesetInfo, [tilesetInfo]);\n\n  const data = useMemo(\n    () => {\n      if (!tile) return undefined;\n\n      let maxScore = 0;\n      let minAbsDistance = Infinity;\n      let maxAbsDistance = 0;\n      const genes = {};\n      const categoryAggregation = {};\n\n      Object.entries(categories).forEach(([name, category]) => {\n        categoryAggregation[name] = {\n          category,\n          numEnhancers: 0,\n        };\n      });\n\n      const distComparator = (a, b) => a.absDistance - b.absDistance;\n      const genesUpstreamByDist = new TinyQueue([], distComparator);\n      const genesDownstreamByDist = new TinyQueue([], distComparator);\n\n      tile.forEach((entry) => {\n        const sample = entry.fields[10];\n\n        // Exclude samples that have been deselected\n        if (!sampleSelection[SAMPLE_IDX[sample]]) return;\n\n        const geneName = entry.fields[6];\n\n        if (!genes[geneName]) {\n          const relGenePos = +entry.fields[4];\n          const distance = relGenePos - relPosition;\n          const isDownstream = distance > 0;\n          const absDistance = Math.abs(distance);\n          genes[geneName] = {\n            name: geneName,\n            position: relGenePos,\n            absDistance,\n            isDownstream,\n            samplesByCategory: {},\n          };\n\n          Object.values(categories).forEach(({ name, size }) => {\n            genes[geneName].samplesByCategory[name] = [];\n            genes[geneName].samplesByCategory[name].size =\n              sampleGroupSelectionSizes[name];\n          });\n\n          minAbsDistance = Math.min(minAbsDistance, absDistance);\n          maxAbsDistance = Math.max(maxAbsDistance, absDistance);\n\n          if (isDownstream) genesDownstreamByDist.push(genes[geneName]);\n          else genesUpstreamByDist.push(genes[geneName]);\n        }\n\n        genes[geneName].samplesByCategory[samples[sample].category.name].push({\n          gene: geneName,\n          sample,\n          sampleCategory: samples[sample].category.name,\n          value: entry.importance,\n        });\n        maxScore = Math.max(maxScore, entry.importance);\n        categoryAggregation[samples[sample].category.name].numEnhancers++;\n      });\n\n      const genesDownstreamByDistArr = [];\n      while (genesDownstreamByDist.length)\n        genesDownstreamByDistArr.push(genesDownstreamByDist.pop());\n\n      const genesUpstreamByDistArr = [];\n      while (genesUpstreamByDist.length)\n        genesUpstreamByDistArr.push(genesUpstreamByDist.pop());\n\n      genesDownstreamByDistArr.forEach((gene, i) => {\n        const prevGene = genesDownstreamByDistArr[i - 1];\n        gene.relDistance =\n          gene.position - ((prevGene && prevGene.position) || relPosition);\n      });\n\n      genesUpstreamByDistArr.forEach((gene, i) => {\n        const prevGene = genesDownstreamByDistArr[i - 1];\n        gene.relDistance =\n          ((prevGene && prevGene.position) || relPosition) - gene.position;\n      });\n\n      return {\n        minAbsDistance,\n        maxAbsDistance,\n        maxScore,\n        genes,\n        genesDownstreamByDist: genesDownstreamByDistArr,\n        genesUpstreamByDist: genesUpstreamByDistArr,\n        categoryAggregation,\n      };\n    },\n    // `relPosition` is excluded on purpose because `tile` is already updated\n    // when `relPosition` updates\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [tile, sampleGroupSelectionSizes, sampleSelection]\n  );\n\n  // Initialization\n  useEffect(\n    () => {\n      (async () => {\n        const response = await fetch(`${server}/tileset_info/?d=${uuid}`);\n        const results = await response.json();\n\n        if (results[uuid]) setTilesetInfo(results[uuid]);\n      })();\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n\n  // Rendering\n  const classes = useStyles();\n\n  useLayoutEffect(\n    () => {\n      if (!plotEl) return undefined;\n\n      const measure = () =>\n        window.requestAnimationFrame(() => {\n          const currWidth = plotEl.getBoundingClientRect().width;\n          if (currWidth !== prevWidth) setWidth(currWidth);\n        });\n\n      measure();\n\n      window.addEventListener('resize', measure);\n      window.addEventListener('orientationchange', measure);\n\n      return () => {\n        window.removeEventListener('resize', measure);\n        window.removeEventListener('orientationchange', measure);\n      };\n    },\n    // `prevWidth` is ommitted on purpose to avoid circular updates.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [plotEl]\n  );\n\n  const tooltipClasses = [];\n  for (let i = 0; i < useTooltipStyles.length; i++) {\n    tooltipClasses.push(useTooltipStyles[i]());\n  }\n\n  useEffect(\n    () => {\n      plotEnhancerGeneConnections(plotEl, width, data, {\n        geneCellEncoding,\n        prevGeneCellEncoding,\n        genePadding,\n        showTooltip,\n        classes,\n        tooltipClasses,\n        position: strPosition,\n        variant,\n      });\n    },\n    // `prevGeneCellEncoding` is ommitted on purpose to avoid circular updates.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [plotEl, width, data, geneCellEncoding, genePadding, showTooltip]\n  );\n\n  return (\n    <Grid\n      className={classes.root}\n      container\n      justify=\"center\"\n      alignItems=\"center\"\n    >\n      {isInit && !isLoadingTile ? (\n        <Grid item className={classes.plot}>\n          <svg ref={plotElRef} className={classes.plotSvg}>\n            <g id=\"enhancers\"></g>\n            <g id=\"gene-distance-axis\"></g>\n            <g id=\"genes-upstream\"></g>\n            <g id=\"genes-downstream\"></g>\n          </svg>\n        </Grid>\n      ) : (\n        <CircularProgress color=\"inherit\" />\n      )}\n    </Grid>\n  );\n});\n\nexport default EnhancerGenesPlot;\n","import React from 'react';\nimport { useRecoilValue } from 'recoil';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport EnhancerGenesInfo from './EnhancerGenesInfo';\nimport EnhancerGenesHelp from './EnhancerGenesHelp';\nimport EnhancerGenesSettings from './EnhancerGenesSettings';\nimport EnhancerGenesPlot from './EnhancerGenesPlot';\nimport TitleBar from './TitleBar';\n\nimport { focusVariantState, useEnhancerGenesShowInfos } from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    // marginLeft: '-8px',\n  },\n  plot: {\n    minHeight: '6rem',\n  },\n}));\n\nconst EnhancerGenes = React.memo(function EnhancerGenes() {\n  const focusVariant = useRecoilValue(focusVariantState);\n\n  const classes = useStyles();\n\n  return (\n    <div className={classes.root}>\n      <TitleBar\n        id=\"enhancer-gene\"\n        title=\"Enhancer-Gene Connections\"\n        popoverDirection=\"top\"\n        useShowInfo={useEnhancerGenesShowInfos}\n        Info={EnhancerGenesInfo}\n        Help={EnhancerGenesHelp}\n        Settings={EnhancerGenesSettings}\n      />\n      <div className={classes.plot}>\n        {focusVariant && <EnhancerGenesPlot />}\n      </div>\n    </div>\n  );\n});\n\nexport default EnhancerGenes;\n","import React, { useMemo } from 'react';\nimport { useRecoilValue } from 'recoil';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport { useChromInfo } from './ChromInfoProvider';\n\nimport {\n  dnaAccessLabelShowInfoState,\n  focusVariantPositionWithAssembly,\n  xDomainEndAbsWithAssembly,\n  xDomainStartAbsWithAssembly,\n} from './state';\nimport { toFixed } from './utils';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n    justifyContent: 'space-between',\n  },\n  text: {\n    fontSize: '0.8rem',\n  },\n}));\n\nconst DnaAccessibilityInfo = React.memo(function DnaAccessibilityInfo() {\n  const chromInfo = useChromInfo();\n\n  const showInfo = useRecoilValue(dnaAccessLabelShowInfoState);\n  const focusVariantPosition = useRecoilValue(\n    focusVariantPositionWithAssembly(chromInfo)\n  );\n  const xDomainStartAbs = useRecoilValue(\n    xDomainStartAbsWithAssembly(chromInfo)\n  );\n  const xDomainEndAbs = useRecoilValue(xDomainEndAbsWithAssembly(chromInfo));\n\n  const classes = useStyles();\n\n  const dnaAccessibilityRegionSize = useMemo(\n    () =>\n      focusVariantPosition\n        ? 5\n        : Math.round((xDomainEndAbs - xDomainStartAbs) / 1000),\n    [focusVariantPosition, xDomainStartAbs, xDomainEndAbs]\n  );\n\n  if (!showInfo) return '';\n\n  return (\n    <div className={classes.root}>\n      <span></span>\n      <Typography align=\"center\" className={classes.text} noWrap>\n        {toFixed(dnaAccessibilityRegionSize, 1)}{' '}\n        <abbr title=\"kilo base pairs\">kbp</abbr>\n      </Typography>\n      <span></span>\n    </div>\n  );\n});\n\nexport default DnaAccessibilityInfo;\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\n\nconst DnaAccessibilityHelp = React.memo(function DnaAccessibilityHelp() {\n  return (\n    <Typography>\n      This panel visualizes the DNA accessibility of all 131 samples. Each track\n      is individually normalized. Mouse over a track to see the underlying\n      value. To focus on a specific locus specify a focus variant.\n    </Typography>\n  );\n});\n\nexport default DnaAccessibilityHelp;\n","import React from 'react';\nimport Box from '@material-ui/core/Box';\nimport IconButton from '@material-ui/core/IconButton';\nimport RadioButtonCheckedIcon from '@material-ui/icons/RadioButtonChecked';\nimport RadioButtonUncheckedIcon from '@material-ui/icons/RadioButtonUnchecked';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport RadioGroup from '@material-ui/core/RadioGroup';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport AntSwitch from './AntSwitch';\n\nimport { useDnaAccessLabelStyle, useDnaAccessRowNorm } from './state';\n\nconst useStyles = makeStyles((theme) => ({\n  iconRadioLegend: {\n    margin: theme.spacing(2, 0, 0.25, 0),\n  },\n  switch: {\n    margin: 0,\n  },\n}));\n\nconst DnaAccessibilitySettings = React.memo(\n  function DnaAccessibilitySettings() {\n    const [\n      dnaAccessLabelStyle,\n      setDnaAccessLabelStyle,\n    ] = useDnaAccessLabelStyle();\n    const [dnaAccessRowNorm, setDnaAccessRowNorm] = useDnaAccessRowNorm();\n\n    const changeDnaAccessLabelStyle = (value) => () => {\n      setDnaAccessLabelStyle(value);\n    };\n\n    const changeDnaAccessRowNorm = (event) => {\n      setDnaAccessRowNorm(event.target.checked);\n    };\n\n    // On every render\n    const classes = useStyles();\n\n    return (\n      <React.Fragment>\n        <Box m={1}>\n          <FormControlLabel\n            className={classes.switch}\n            control={\n              <AntSwitch\n                checked={dnaAccessRowNorm}\n                onChange={changeDnaAccessRowNorm}\n                name=\"true\"\n              />\n            }\n            label=\"Row-wise normalization\"\n          />\n        </Box>\n        <Box m={1}>\n          <FormControl component=\"fieldset\">\n            <FormLabel component=\"legend\" className={classes.iconRadioLegend}>\n              Labels\n            </FormLabel>\n            <RadioGroup\n              aria-label=\"dnaAccessLabelStyle\"\n              name=\"dnaAccessLabelStyle\"\n              value={dnaAccessLabelStyle}\n            >\n              <FormControlLabel\n                label=\"Indicator\"\n                value=\"indicator\"\n                className={classes.iconRadio}\n                control={\n                  <IconButton\n                    size=\"small\"\n                    onClick={changeDnaAccessLabelStyle('indicator')}\n                  >\n                    {dnaAccessLabelStyle === 'indicator' ? (\n                      <RadioButtonCheckedIcon\n                        className={classes.iconRadioActive}\n                        fontSize=\"inherit\"\n                      />\n                    ) : (\n                      <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                    )}\n                  </IconButton>\n                }\n              />\n              <FormControlLabel\n                label=\"Text\"\n                value=\"text\"\n                className={classes.iconRadio}\n                control={\n                  <IconButton\n                    size=\"small\"\n                    onClick={changeDnaAccessLabelStyle('text')}\n                  >\n                    {dnaAccessLabelStyle === 'text' ? (\n                      <RadioButtonCheckedIcon\n                        className={classes.iconRadioActive}\n                        fontSize=\"inherit\"\n                      />\n                    ) : (\n                      <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                    )}\n                  </IconButton>\n                }\n              />\n              <FormControlLabel\n                label=\"Hidden\"\n                value=\"hidden\"\n                className={classes.iconRadio}\n                control={\n                  <IconButton\n                    size=\"small\"\n                    onClick={changeDnaAccessLabelStyle('hidden')}\n                  >\n                    {dnaAccessLabelStyle === 'hidden' ? (\n                      <RadioButtonCheckedIcon\n                        className={classes.iconRadioActive}\n                        fontSize=\"inherit\"\n                      />\n                    ) : (\n                      <RadioButtonUncheckedIcon fontSize=\"inherit\" />\n                    )}\n                  </IconButton>\n                }\n              />\n            </RadioGroup>\n          </FormControl>\n        </Box>\n      </React.Fragment>\n    );\n  }\n);\n\nexport default DnaAccessibilitySettings;\n","import React, { useCallback, useMemo } from 'react';\nimport { useRecoilValue, useSetRecoilState } from 'recoil';\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { deepClone, pipe } from '@flekschas/utils';\nimport { HiGlassComponent } from 'higlass';\n\nimport { useChromInfo } from './ChromInfoProvider';\nimport DnaAccessibilityInfo from './DnaAccessibilityInfo';\nimport DnaAccessibilityHelp from './DnaAccessibilityHelp';\nimport DnaAccessibilitySettings from './DnaAccessibilitySettings';\n\nimport TitleBar from './TitleBar';\n\nimport {\n  dnaAccessLabelStyleState,\n  dnaAccessRowNormState,\n  focusGeneEndWithAssembly,\n  focusGeneStartWithAssembly,\n  focusVariantPositionWithAssembly,\n  higlassDnaAccessState,\n  sampleSelectionState,\n  useDnaAccessShowInfos,\n  variantTracksState,\n  variantYScaleState,\n  xDomainEndAbsWithAssembly,\n  xDomainStartAbsWithAssembly,\n} from './state';\nimport {\n  DEFAULT_DNA_ACCESSIBILITY_ROW_SELECTION,\n  DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY,\n} from './constants';\nimport useDebounce from './use-debounce';\n\nimport {\n  updateViewConfigFocusVariant,\n  updateViewConfigVariantYScale,\n  updateViewConfigXDomain,\n  updateViewConfigVariantTracks,\n} from './view-config';\n\nimport 'higlass/dist/hglib.css';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n  },\n  grow: {\n    flexGrow: 1,\n  },\n}));\n\nconst updateViewConfigDnaAccessLabels = (labels) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[3].options.showRowLabels =\n    !labels || labels === 'hidden' ? false : labels;\n  return viewConfig;\n};\n\nconst updateViewConfigDnaAccessRowNorm = (rowNorm) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[3].options.rowNormalization = rowNorm;\n  return viewConfig;\n};\n\nconst getDnaAccessXDomain = (\n  focusVariantPosition,\n  focusGeneStart,\n  focusGeneEnd,\n  xDomainStartAbs,\n  xDomainEndAbs\n) => {\n  const enhancerViewRange = xDomainEndAbs - xDomainStartAbs;\n  const enhancerViewCenter = xDomainStartAbs + enhancerViewRange / 2;\n\n  if (focusVariantPosition) {\n    if (\n      enhancerViewRange < 5000 &&\n      Math.abs(enhancerViewCenter - focusVariantPosition) < 1000\n    ) {\n      return [xDomainStartAbs, xDomainEndAbs];\n    }\n    return [focusVariantPosition - 2500, focusVariantPosition + 2500];\n  }\n\n  if (focusGeneStart && focusGeneEnd) {\n    const midPos = focusGeneStart + (focusGeneEnd - focusGeneStart) / 2;\n\n    if (\n      enhancerViewRange < 5000 &&\n      enhancerViewCenter > focusGeneStart &&\n      enhancerViewCenter < focusGeneEnd\n    ) {\n      return [xDomainStartAbs, xDomainEndAbs];\n    }\n\n    return [midPos - 2500, midPos + 2500];\n  }\n\n  return [xDomainStartAbs, xDomainEndAbs];\n};\n\nconst updateViewConfigDnaAccessXDomain = (...args) =>\n  updateViewConfigXDomain(...getDnaAccessXDomain(...args), { force: true });\n\nconst updateViewConfigRowSelection = (selection) => (viewConfig) => {\n  viewConfig.views[0].tracks.top[3].options.rowSelections = DEFAULT_DNA_ACCESSIBILITY_ROW_SELECTION.filter(\n    (rowId, i) => selection[i]\n  );\n  return viewConfig;\n};\n\nconst DnaAccessibility = React.memo(function DnaAccessibility() {\n  const chromInfo = useChromInfo();\n\n  const setHiglassDnaAccess = useSetRecoilState(higlassDnaAccessState);\n\n  const sampleSelection = useRecoilValue(sampleSelectionState);\n  const labelStyle = useRecoilValue(dnaAccessLabelStyleState);\n  const rowNorm = useRecoilValue(dnaAccessRowNormState);\n  const variantYScale = useRecoilValue(variantYScaleState);\n  const variantTracks = useRecoilValue(variantTracksState);\n  const focusGeneStart = useRecoilValue(focusGeneStartWithAssembly(chromInfo));\n  const focusGeneEnd = useRecoilValue(focusGeneEndWithAssembly(chromInfo));\n  const focusVariantPosition = useRecoilValue(\n    focusVariantPositionWithAssembly(chromInfo)\n  );\n\n  const xDomainStartAbsDb = useDebounce(\n    useRecoilValue(xDomainStartAbsWithAssembly(chromInfo)),\n    500\n  );\n  const xDomainEndAbsDb = useDebounce(\n    useRecoilValue(xDomainEndAbsWithAssembly(chromInfo)),\n    500\n  );\n\n  const higlassInitHandler = useCallback(\n    (higlassInstance) => {\n      if (higlassInstance !== null) {\n        setHiglassDnaAccess(higlassInstance.api);\n      }\n    },\n    [setHiglassDnaAccess]\n  );\n\n  const viewConfig = useMemo(\n    () =>\n      pipe(\n        updateViewConfigVariantTracks(variantTracks),\n        updateViewConfigFocusVariant(focusVariantPosition, [2]),\n        updateViewConfigVariantYScale(variantYScale),\n        updateViewConfigDnaAccessLabels(labelStyle),\n        updateViewConfigDnaAccessRowNorm(rowNorm),\n        updateViewConfigDnaAccessXDomain(\n          focusVariantPosition,\n          focusGeneStart,\n          focusGeneEnd,\n          xDomainStartAbsDb,\n          xDomainEndAbsDb\n        ),\n        updateViewConfigRowSelection(sampleSelection)\n      )(deepClone(DEFAULT_VIEW_CONFIG_DNA_ACCESSIBILITY)),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [\n      // `xDomainStartAbs` and `xDomainEndAbs` are ommitted on purpose to avoid\n      // updating the view-config on every pan or zoom event.\n      variantTracks,\n      focusVariantPosition,\n      focusGeneStart,\n      focusGeneEnd,\n      xDomainStartAbsDb,\n      xDomainEndAbsDb,\n      variantYScale,\n      labelStyle,\n      chromInfo,\n      sampleSelection,\n      rowNorm,\n    ]\n  );\n\n  // On every render\n  const classes = useStyles();\n\n  return (\n    <Grid container direction=\"column\" className={classes.root}>\n      <TitleBar\n        id=\"dna-accessibility\"\n        title=\"DNA Accessibility\"\n        useShowInfo={useDnaAccessShowInfos}\n        Info={DnaAccessibilityInfo}\n        Help={DnaAccessibilityHelp}\n        Settings={DnaAccessibilitySettings}\n      />\n      <Grid item container direction=\"column\" className={classes.grow}>\n        <HiGlassComponent\n          ref={higlassInitHandler}\n          viewConfig={viewConfig}\n          options={{\n            sizeMode: 'scroll',\n            pixelPreciseMarginPadding: true,\n            containerPaddingX: 0,\n            containerPaddingY: 0,\n            viewMarginTop: 0,\n            viewMarginBottom: 0,\n            viewMarginLeft: 0,\n            viewMarginRight: 0,\n            viewPaddingTop: 0,\n            viewPaddingBottom: 0,\n            viewPaddingLeft: 0,\n            viewPaddingRight: 16,\n            globalMousePosition: true,\n          }}\n        />\n      </Grid>\n    </Grid>\n  );\n});\n\nexport default DnaAccessibility;\n","import React, { useEffect } from 'react';\nimport { useRecoilState } from 'recoil';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport AppSidebar from './AppSidebar';\nimport AppTopbar from './AppTopbar';\nimport EnhancerRegions from './EnhancerRegions';\nimport EnhancerGenes from './EnhancerGenes';\nimport DnaAccessibility from './DnaAccessibility';\nimport ModalProvider from './ModalProvider';\nimport TooltipProvider from './TooltipProvider';\n\nimport { useChromInfo } from './ChromInfoProvider';\n\nimport {\n  focusGeneOptionState,\n  focusVariantOptionState,\n  useFocusGene,\n  useFocusVariant,\n  useVariantTracksSyncher,\n  useShowWelcomeSyncher,\n  useFocusGeneSyncher,\n  useFocusVariantSyncher,\n  useDnaAccessLabelStyleSyncher,\n  useDnaAccessRowNormSyncher,\n  useDnaAccessShowInfosSyncher,\n  useXDomainStartWithAssemblySyncher,\n  useXDomainEndWithAssemblySyncher,\n  useEnhancerRegionsShowInfosSyncher,\n  useEnhancerRegionsHideUnfocusedSyncher,\n  useEnhancerRegionsColorEncodingSyncher,\n  useEnhancerGenesShowInfosSyncher,\n  useEnhancerGenesPaddingSyncher,\n  useEnhancerGenesCellEncodingSyncher,\n  useVariantYScaleSyncher,\n} from './state';\n\nimport { GENE_SEARCH_URL, VARIANT_SEARCH_URL } from './constants';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    position: 'absolute',\n    display: 'flex',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n  },\n  toolbar: theme.mixins.toolbar,\n  content: {\n    flexGrow: 1,\n    padding: theme.spacing(1),\n    backgroundColor: 'white',\n  },\n  grow: {\n    flexGrow: 1,\n  },\n  separator: {\n    zIndex: 1,\n    margin: `-${theme.spacing(1)}px 0`,\n    width: 1,\n    background: theme.palette.grey['300'],\n  },\n  enhancerWrapper: {\n    position: 'relative',\n    flexGrow: 1,\n    margin: '-8px 0 -8px -8px',\n  },\n  enhancer: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    overflowY: 'auto',\n    '&> div': {\n      minHeight: '100%',\n    },\n  },\n  enhancerRegions: {\n    position: 'relative',\n    flexGrow: 1,\n  },\n  enhancerGenes: {\n    position: 'relative',\n  },\n  dnaAccessibility: {\n    position: 'relative',\n    width: '20rem',\n    margin: '-8px -8px -8px 0',\n  },\n}));\n\nconst AppMain = React.memo(function AppMain() {\n  const chromInfo = useChromInfo();\n\n  // Initialize query strings\n  useVariantTracksSyncher();\n  useShowWelcomeSyncher();\n  useFocusGeneSyncher();\n  useFocusVariantSyncher();\n  useDnaAccessLabelStyleSyncher();\n  useDnaAccessRowNormSyncher();\n  useDnaAccessShowInfosSyncher();\n  useEnhancerRegionsShowInfosSyncher();\n  useEnhancerRegionsHideUnfocusedSyncher();\n  useEnhancerRegionsColorEncodingSyncher();\n  useEnhancerGenesShowInfosSyncher();\n  useEnhancerGenesPaddingSyncher();\n  useEnhancerGenesCellEncodingSyncher();\n  useVariantYScaleSyncher();\n  useXDomainStartWithAssemblySyncher(chromInfo);\n  useXDomainEndWithAssemblySyncher(chromInfo);\n\n  const [focusGene, setFocusGene] = useFocusGene();\n  const [focusVariant, setFocusVariant] = useFocusVariant();\n\n  const [focusGeneOption, setFocusGeneOption] = useRecoilState(\n    focusGeneOptionState\n  );\n  const [focusVariantOption, setFocusVariantOption] = useRecoilState(\n    focusVariantOptionState\n  );\n\n  const clearFocusGene = () => {\n    setFocusGene('');\n    setFocusGeneOption(null);\n  };\n\n  const focusGeneChangeHandler = (newValue) => {\n    if (newValue) {\n      setFocusGene(newValue.geneName);\n      setFocusGeneOption(newValue);\n    } else {\n      clearFocusGene();\n    }\n  };\n\n  const clearFocusVariant = () => {\n    setFocusVariant('');\n    setFocusVariantOption(null);\n  };\n\n  const focusVariantChangeHandler = (newValue) => {\n    if (newValue) {\n      setFocusVariant(newValue.geneName);\n      setFocusVariantOption(newValue);\n    } else {\n      clearFocusVariant();\n    }\n  };\n\n  const classes = useStyles();\n\n  // Initialize focus gene/variant options\n  useEffect(\n    () => {\n      (async () => {\n        if (focusGene && !focusGeneOption) {\n          const r = await fetch(`${GENE_SEARCH_URL}&ac=${focusGene}`);\n          const results = await r.json();\n          const result = results[0];\n          result.type = 'gene';\n          focusGeneChangeHandler(results[0]);\n        }\n        if (focusVariant && !focusVariantOption) {\n          const r = await fetch(`${VARIANT_SEARCH_URL}&ac=${focusVariant}`);\n          const results = await r.json();\n          const result = results[0];\n          result.type = 'variant';\n          focusVariantChangeHandler(results[0]);\n        }\n      })();\n    },\n    // Execute only once on initialization\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n\n  return (\n    <div className={classes.root}>\n      <ModalProvider>\n        <CssBaseline />\n        <AppTopbar />\n        <AppSidebar />\n        <TooltipProvider>\n          <Grid\n            container\n            direction=\"column\"\n            className={classes.content}\n            wrap=\"nowrap\"\n          >\n            <div className={classes.toolbar} />\n            <Grid container className={classes.grow} wrap=\"nowrap\">\n              <div className={classes.enhancerWrapper}>\n                <div className={classes.enhancer}>\n                  <Grid container direction=\"column\">\n                    <Grid item className={classes.enhancerRegions}>\n                      <EnhancerRegions />\n                    </Grid>\n                    <Grid item className={classes.enhancerGenes}>\n                      <EnhancerGenes />\n                    </Grid>\n                  </Grid>\n                </div>\n              </div>\n              <div className={classes.separator} />\n              <div className={classes.dnaAccessibility}>\n                <DnaAccessibility />\n              </div>\n            </Grid>\n          </Grid>\n        </TooltipProvider>\n      </ModalProvider>\n    </div>\n  );\n});\n\nexport default AppMain;\n","import React from 'react';\n\nconst withEither = (ifEitherFn, EitherComponent) => (Component) => (props) =>\n  ifEitherFn(props) ? <EitherComponent {...props} /> : <Component {...props} />;\n\nexport default withEither;\n","import React, { useState, useEffect } from 'react';\nimport { RecoilRoot } from 'recoil';\nimport { ChromosomeInfo } from 'higlass';\nimport { pipe } from '@flekschas/utils';\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\n\nimport AppInitializing from './AppInitializing';\nimport AppError from './AppError';\nimport ChromInfoProvider from './ChromInfoProvider';\nimport AppMain from './AppMain';\nimport withEither from './with-either';\n\nimport './App.css';\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: '#000',\n    },\n    secondary: {\n      main: '#000',\n    },\n  },\n});\n\nconst App = () => {\n  const [chromInfo, setChromInfo] = useState(null);\n\n  useEffect(() => {\n    ChromosomeInfo('https://s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv')\n      .then((_chromInfo) => {\n        if (_chromInfo.totalLength === undefined) {\n          // Monkey patch: chrom sizes were actually unavailable...\n          // Also see https://github.com/higlass/higlass/issues/957\n          setChromInfo(false);\n        } else {\n          setChromInfo(_chromInfo);\n        }\n      })\n      .catch(() => {\n        setChromInfo(false);\n      });\n  }, []);\n\n  const Main = pipe(\n    withEither(() => chromInfo === null, AppInitializing),\n    withEither(() => chromInfo === false, AppError)\n  )(AppMain);\n\n  return (\n    <div className=\"App\">\n      <RecoilRoot>\n        <ThemeProvider theme={theme}>\n          <ChromInfoProvider chromInfo={chromInfo}>\n            <Main />\n          </ChromInfoProvider>\n        </ThemeProvider>\n      </RecoilRoot>\n    </div>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","function createAnnotationOverlayMetaTrack(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  // Services\n  const { pubSub } = HGC.services;\n\n  class AnnotationOverlayMetaTrack {\n    constructor(context, options) {\n      const { definition, getTrackObject, onNewTilesLoaded: animate } = context;\n\n      this.animate = animate;\n      this.options = options;\n\n      this.overlaysTrack = getTrackObject(definition.overlaysTrack);\n\n      if (!this.overlaysTrack) {\n        console.warn(\n          `Overlays track (uid: ${definition.overlaysTrack}) not found`\n        );\n        return;\n      }\n\n      this.annotationTrackIds = new Set();\n      this.annotationTracks = definition.options.annotationTracks\n        .map((uid) => {\n          const track = getTrackObject(uid);\n\n          if (!track) {\n            console.warn(`Child track (uid: ${uid}) not found`);\n          } else {\n            this.annotationTrackIds.add(track.uuid);\n          }\n\n          return track;\n        })\n        .filter((track) => track);\n\n      this.annotationDrawnHandlerBound = this.annotationDrawnHandler.bind(this);\n      this.tilesDrawnEndHandlerBound = this.tilesDrawnEndHandler.bind(this);\n\n      this.drawnAnnotations = new Map();\n      this.tracksDrawingTiles = new Set();\n\n      this.pubSubs = [];\n\n      // Augment annotation tracks\n      this.annotationTracks.forEach((track) => {\n        track.subscribe('annotationDrawn', this.annotationDrawnHandlerBound);\n        track.subscribe('tilesDrawn', this.tilesDrawnEndHandlerBound);\n      });\n    }\n\n    /**\n     * Handles annotation drawn events\n     *\n     * @param  {String}  event.uid  UID of the view that triggered the event.\n     * @param  {Array}  event.viewPos  View position (i.e., [x, y, width, height])\n     *   of the drawn annotation on the screen.\n     * @param  {Array}  event.dataPos  Data position of the drawn annotation. For\n     *   example base pairs (Hi-C), or pixels (gigapixel images), or lng-lat\n     *   (geo json).\n     */\n    annotationDrawnHandler({ xStartAbs, xEndAbs, data }) {\n      this.drawnAnnotations.set(data.uid, [xStartAbs, xEndAbs]);\n    }\n\n    /**\n     * Remove this track.\n     */\n    remove() {\n      this.pubSubs.forEach(pubSub.unsubscribe);\n      this.pubSubs = undefined;\n      this.annotationTracks.forEach((track) => {\n        track.unsubscribe('annotationDrawn', this.annotationDrawnHandlerBound);\n      });\n    }\n\n    tilesDrawnEndHandler({ uuid }) {\n      if (!this.annotationTrackIds.has(uuid)) return;\n\n      this.tracksDrawingTiles.add(uuid);\n\n      if (!(this.tracksDrawingTiles.size % this.annotationTracks.length)) {\n        this.updateOverlays();\n      }\n    }\n\n    updateOverlays() {\n      this.overlaysTrack.options.extent = Array.from(\n        this.drawnAnnotations.values()\n      );\n      this.overlaysTrack.draw();\n      this.tracksDrawingTiles.clear();\n    }\n  }\n\n  return new AnnotationOverlayMetaTrack(...args);\n}\n\ncreateAnnotationOverlayMetaTrack.config = {\n  type: 'annotation-overlay',\n  availableOptions: ['annotationTracks'],\n  defaultOptions: {\n    annotationTracks: [],\n  },\n};\n\nexport default createAnnotationOverlayMetaTrack;\n","import {\n  identity,\n  maxNan,\n  maxVector,\n  meanNan,\n  minNan,\n  sumNan,\n} from '@flekschas/utils';\nimport { line } from 'd3';\n\nimport {\n  DEFAULT_COLOR_MAP,\n  DEFAULT_COLOR_MAP_LIGHT,\n  DEFAULT_COLOR_MAP_DARK,\n} from './constants';\n\nconst FLOAT_BYTES = Float32Array.BYTES_PER_ELEMENT;\n\nconst VS = `precision mediump float;\n\n  attribute vec2 aPrevPosition;\n  attribute vec2 aCurrPosition;\n  attribute vec2 aNextPosition;\n  attribute float aOffsetSign;\n  attribute float aColorIndex;\n\n  uniform sampler2D uAreaColorTex;\n  uniform float uAreaColorTexRes;\n  uniform mat3 projectionMatrix;\n  uniform mat3 translationMatrix;\n\n  uniform vec4 uLineColor;\n  uniform vec4 uNaNColor;\n  uniform float uWidth;\n  uniform int uMiter;\n\n  varying vec4 vColor;\n\n  void main(void)\n  {\n    mat3 model = projectionMatrix * translationMatrix;\n\n    if (aColorIndex <= -0.5) {\n      // Render line\n      vColor = vec4(uLineColor.rgb, 1.0);\n\n      vec4 prevGlPos = vec4((model * vec3(aPrevPosition, 1.0)).xy, 0.0, 1.0);\n      vec4 currGlPos = vec4((model * vec3(aCurrPosition, 1.0)).xy, 0.0, 1.0);\n      vec4 nextGlPos = vec4((model * vec3(aNextPosition, 1.0)).xy, 0.0, 1.0);\n\n      // Calculate the direction\n      vec2 dir = vec2(0.0);\n\n      if (currGlPos == prevGlPos) {\n        // start point uses (next - current)\n        dir = normalize(nextGlPos.xy - currGlPos.xy);\n      }\n      else if (currGlPos == nextGlPos) {\n        // end point uses (current - previous)\n        dir = normalize(currGlPos.xy - prevGlPos.xy);\n      }\n      else {\n        // somewhere in middle, needs a join:\n        // get directions from (C - B) and (B - A)\n        vec2 dirA = normalize((currGlPos.xy - prevGlPos.xy));\n        if (uMiter == 1) {\n          vec2 dirB = normalize((nextGlPos.xy - currGlPos.xy));\n          // now compute the miter join normal and length\n          vec2 tangent = normalize(dirA + dirB);\n          vec2 perp = vec2(-dirA.y, dirA.x);\n          vec2 miter = vec2(-tangent.y, tangent.x);\n          dir = tangent;\n        } else {\n          dir = dirA;\n        }\n      }\n\n      float width = (projectionMatrix * vec3(uWidth, 0.0, 0.0)).x / 2.0;\n\n      vec2 normal = vec2(-dir.y, dir.x) * width;\n      // normal.x /= aspectRatio;\n      vec4 offset = vec4(normal * aOffsetSign, 0.0, 0.0);\n      gl_Position = currGlPos + offset;\n    } else {\n      // Render area\n      float colorRowIndex = aColorIndex / uAreaColorTexRes;\n\n      vec2 colorTexIndex = vec2(\n        (aColorIndex / uAreaColorTexRes) - colorRowIndex,\n        colorRowIndex / uAreaColorTexRes\n      );\n      vColor = texture2D(uAreaColorTex, colorTexIndex);\n\n      gl_Position = vec4((model * vec3(aCurrPosition, 1.0)).xy, 0.0, 1.0);\n    }\n  }\n`;\n\nconst FS = `precision mediump float;\n\n  varying vec4 vColor;\n\n  void main() {\n    gl_FragColor = vColor;\n  }\n`;\n\nconst TILE_SIZE = 256;\n\nconst COLORMAP_GRAYS = Array(127)\n  .fill()\n  .map((x, i) => {\n    const gray = (1 - i / 127) * 0.5 + 0.5;\n    return [gray, gray, gray, 1];\n  });\n\nconst getMax = (fetchedTiles) =>\n  Object.values(fetchedTiles).reduce(\n    (maxValue, tile) => Math.max(maxValue, tile.tileData.maxNonZero),\n    -Infinity\n  );\n\nconst getNumRows = (fetchedTiles) =>\n  Object.values(fetchedTiles)[0].tileData.coarseShape[0];\n\nconst getRowMaxs = (fetchedTiles) =>\n  maxVector(\n    Object.values(fetchedTiles).map((tile) => tile.tileData.maxValueByRow)\n  );\n\nconst scaleGraphics = (graphics, xScale, drawnAtScale) => {\n  const tileK =\n    (drawnAtScale.domain()[1] - drawnAtScale.domain()[0]) /\n    (xScale.domain()[1] - xScale.domain()[0]);\n  const newRange = xScale.domain().map(drawnAtScale);\n\n  const posOffset = newRange[0];\n  graphics.scale.x = tileK;\n  graphics.position.x = -posOffset * tileK;\n};\n\nconst getNumPointsPerRow = (numRows, positions, markArea) =>\n  positions.length / numRows / 4 / (1 + markArea) - 2;\n\nconst createRidgePlotTrack = function createRidgePlotTrack(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  const { PIXI } = HGC.libraries;\n  const { format } = HGC.libraries.d3Format;\n  const { scaleLinear } = HGC.libraries.d3Scale;\n  const { tileProxy } = HGC.services;\n\n  const createColorTexture = (colors) => {\n    const colorTexRes = Math.max(2, Math.ceil(Math.sqrt(colors.length)));\n    const rgba = new Float32Array(colorTexRes ** 2 * 4);\n    colors.forEach((color, i) => {\n      // eslint-disable-next-line prefer-destructuring\n      rgba[i * 4] = color[0]; // r\n      // eslint-disable-next-line prefer-destructuring\n      rgba[i * 4 + 1] = color[1]; // g\n      // eslint-disable-next-line prefer-destructuring\n      rgba[i * 4 + 2] = color[2]; // b\n      // eslint-disable-next-line prefer-destructuring\n      rgba[i * 4 + 3] = color[3]; // a\n    });\n\n    return [\n      PIXI.Texture.fromBuffer(rgba, colorTexRes, colorTexRes),\n      colorTexRes,\n    ];\n  };\n\n  class RidgePlotTrack extends HGC.tracks.HorizontalLine1DPixiTrack {\n    constructor(context, options) {\n      super(context, options);\n      this.updateOptions();\n\n      this.pLoading = new PIXI.Graphics();\n      this.pLoading.position.x = 0;\n      this.pLoading.position.y = 0;\n      this.pMasked.addChild(this.pLoading);\n\n      this.loadIndicator = new PIXI.Text('Loading data...', {\n        fontSize: this.labelSize || 10,\n        fill: 0x808080,\n      });\n      this.pLoading.addChild(this.loadIndicator);\n    }\n\n    initTile(tile) {\n      this.coarsifyTileValues(tile);\n    }\n\n    destroyTile() {}\n\n    binsPerTile() {\n      return this.tilesetInfo.bins_per_dimension || TILE_SIZE;\n    }\n\n    /**\n     * From HeatmapTiledPixiTrack\n     */\n    getTilePosAndDimensions(zoomLevel, tilePos, binsPerTileIn) {\n      const binsPerTile = binsPerTileIn || this.binsPerTile();\n\n      if (this.tilesetInfo.resolutions) {\n        const sortedResolutions = this.tilesetInfo.resolutions\n          .map((x) => +x)\n          .sort((a, b) => b - a);\n\n        const chosenResolution = sortedResolutions[zoomLevel];\n\n        const tileWidth = chosenResolution * binsPerTile;\n        const tileHeight = tileWidth;\n\n        const tileX = chosenResolution * binsPerTile * tilePos[0];\n        const tileY = chosenResolution * binsPerTile * tilePos[1];\n\n        return {\n          tileX,\n          tileY,\n          tileWidth,\n          tileHeight,\n        };\n      }\n\n      const xTilePos = tilePos[0];\n      const yTilePos = tilePos[1];\n\n      const minX = this.tilesetInfo.min_pos[0];\n      const minY = this.options.reverseYAxis\n        ? -this.tilesetInfo.max_pos[1]\n        : this.tilesetInfo.min_pos[1];\n\n      const tileWidth = this.tilesetInfo.max_width / 2 ** zoomLevel;\n      const tileHeight = this.tilesetInfo.max_width / 2 ** zoomLevel;\n\n      const tileX = minX + xTilePos * tileWidth;\n      const tileY = minY + yTilePos * tileHeight;\n\n      return {\n        tileX,\n        tileY,\n        tileWidth,\n        tileHeight,\n      };\n    }\n\n    updateOptions() {\n      this.selectRowsAggregationMode =\n        this.options.selectRowsAggregationMode || 'mean';\n\n      switch (this.selectRowsAggregationMode) {\n        case 'max':\n          this.selectRowsAggregationFn = maxNan;\n          break;\n\n        case 'min':\n          this.selectRowsAggregationFn = minNan;\n          break;\n\n        case 'sum':\n          this.selectRowsAggregationFn = sumNan;\n          break;\n\n        case 'mean':\n        default:\n          this.selectRowsAggregationFn = meanNan;\n          break;\n      }\n\n      this.markArea = !!this.options.markArea;\n\n      this.markAreaColor = 'grays';\n\n      this.markColor = HGC.utils.colorToHex(this.options.markColor || 'black');\n\n      this.markColorRgbNorm = this.options.markColor\n        ? HGC.utils\n            .colorToRgba(this.options.markColor)\n            .slice(0, 3)\n            .map((x) => Math.min(1, Math.max(0, x / 255)))\n        : [0, 0, 0];\n\n      [this.markColorTex, this.markColorTexRes] = createColorTexture([\n        ...COLORMAP_GRAYS,\n      ]);\n\n      this.markNumColors = COLORMAP_GRAYS.length;\n\n      this.markOpacity = Number.isNaN(+this.options.markOpacity)\n        ? 1\n        : Math.min(1, Math.max(0, +this.options.markOpacity));\n\n      this.markSize = this.options.markSize || 2;\n\n      // Number of line segments\n      const oldMarkResolution = this.markResolution;\n      this.markResolution = Math.max(\n        1,\n        Math.min(TILE_SIZE, this.options.markResolution || TILE_SIZE / 4)\n      );\n      // Given 100 (rows) x 256 (tile size). At a resolution of 1 we need:\n      // 100 x (256 / 4) x 4 = 25,600 vertices\n\n      const oldRowHeight = this.rowHeight;\n      this.rowHeight = Number.isNaN(+this.options.rowHeight)\n        ? 'auto'\n        : +this.options.rowHeight;\n\n      const oldRowPadding = this.rowPadding;\n      this.rowPadding =\n        this.rowHeight === 'auto' ? 0 : this.options.rowPadding || 0;\n\n      const oldRowNormalization = this.rowNormalization;\n      this.rowNormalization = this.options.rowNormalization || false;\n\n      const oldRowSelections = this.rowSelections;\n      this.rowSelections =\n        this.options.rowSelections || this.rowSelections || [];\n\n      const oldShowRowLabels = this.showRowLabels;\n      this.showRowLabels = this.options.showRowLabels;\n\n      if (\n        oldMarkResolution !== this.markResolution ||\n        oldRowSelections !== this.rowSelections\n      ) {\n        this.updateTiles();\n        this.updateRowLabels();\n        this.drawLabel();\n      }\n\n      if (\n        oldRowHeight !== this.rowHeight ||\n        oldRowPadding !== this.rowPadding ||\n        oldRowNormalization !== this.rowNormalization\n      ) {\n        this.updateScales();\n      }\n\n      if (oldShowRowLabels !== this.showRowLabels) {\n        this.updateRowLabels();\n        this.drawLabel();\n      }\n\n      this.rowLabelAlign = this.options.rowLabelAlign || 'left';\n      this.rowLabelSize = this.options.rowLabelSize || 12;\n\n      this.rowCategories = this.options.rowCategories || {};\n      this.rowIdToCategory = (id) => id.substring(0, id.length - 14);\n      this.rowIdToCategory = this.options.rowIdToCategory\n        ? (id) =>\n            id[this.options.rowIdToCategory.fn](\n              ...this.options.rowIdToCategory.args\n            )\n        : identity;\n    }\n\n    removeRowLabels() {\n      while (this.pAxis.children.length) {\n        this.pAxis.removeChildAt(0);\n      }\n      if (this.rowLabels) {\n        this.rowLabels.forEach((rowLabel) => {\n          rowLabel.destroy();\n        });\n        this.rowLabels = undefined;\n      }\n    }\n\n    updateRowLabels() {\n      if (!this.tilesetInfo || !this.tilesetInfo.row_infos) return;\n\n      const labels = this.rowSelections.length\n        ? this.rowSelections.map((rowIndex) =>\n            this.tilesetInfo.row_infos[rowIndex] === undefined\n              ? '?'\n              : this.rowIdToCategory(this.tilesetInfo.row_infos[rowIndex].id)\n          )\n        : this.tilesetInfo.row_infos.map(({ id }) => this.rowIdToCategory(id));\n\n      this.removeRowLabels();\n\n      if (this.showRowLabels === 'indicator') {\n        this.rowLabels = labels.map((label) => {\n          const indicator = new PIXI.Sprite(PIXI.Texture.WHITE);\n          indicator.width = this.rowLabelSize / 2;\n          indicator.height = this.rowLabelSize;\n          indicator.tint = this.rowCategories[label]\n            ? HGC.utils.colorToHex(\n                this.rowCategories[label].axisLabelColor ||\n                  DEFAULT_COLOR_MAP[\n                    this.rowCategories[label].index % DEFAULT_COLOR_MAP.length\n                  ]\n              )\n            : 0x808080;\n          return indicator;\n        });\n      } else if (this.showRowLabels) {\n        this.rowLabels = labels.map(\n          (label) =>\n            new PIXI.Text(label, {\n              fontSize: this.rowLabelSize,\n              align: this.rowLabelAlign === 'right' ? 'right' : 'left',\n              fill: this.rowCategories[label]\n                ? HGC.utils.colorToHex(\n                    this.rowCategories[label].axisLabelColor ||\n                      DEFAULT_COLOR_MAP_DARK[\n                        this.rowCategories[label].index %\n                          DEFAULT_COLOR_MAP_DARK.length\n                      ]\n                  )\n                : 0x808080,\n            })\n        );\n      }\n    }\n\n    drawLabel() {\n      if (!this.showRowLabels) {\n        if (this.rowLabels) {\n          while (this.pAxis.children.length) {\n            this.pAxis.removeChildAt(0);\n          }\n        }\n        return;\n      }\n      if (this.showRowLabels && !this.rowLabels) this.updateRowLabels();\n      if (!this.rowLabels) return;\n\n      const [width] = this.dimensions;\n      const [left, top] = this.position;\n\n      this.pAxis.position.x = this.axisAlign === 'right' ? left + width : left;\n      this.pAxis.position.y = top;\n\n      this.pAxis.clear();\n      let yStart = 0;\n\n      const xLabelOffset = this.axisAlign === 'right' ? -3 : 3;\n      const [, rowStepHeight] = this.getRowHeight();\n      const rowStepYCenter = rowStepHeight / 2;\n\n      this.rowLabels.forEach((label, i) => {\n        label.x = xLabelOffset;\n        label.y = yStart - this.rowPadding + rowStepYCenter;\n        label.anchor.x = this.axisAlign === 'right' ? 1 : 0;\n        label.anchor.y = 0.5;\n\n        yStart += rowStepHeight;\n\n        this.pAxis.addChild(label);\n      });\n    }\n\n    rerender(newOptions) {\n      this.options = newOptions;\n      this.updateOptions();\n      this.updateExistingGraphics();\n    }\n\n    hasFetchedTiles() {\n      return Object.values(this.fetchedTiles).length;\n    }\n\n    coarsifyTileValues(tile) {\n      const { tileX, tileWidth } = this.getTilePosAndDimensions(\n        tile.tileData.zoomLevel,\n        tile.tileData.tilePos\n      );\n      const [numRows] = tile.tileData.shape;\n      const binSizePx = Math.floor(TILE_SIZE / this.markResolution);\n      const binSizeBp = tileWidth / this.markResolution;\n      const binSizeBpHalf = binSizeBp / 2;\n\n      // Determine bin boundaries\n      tile.tileData.binXPos = Array(this.markResolution).fill();\n      for (let i = 0; i <= this.markResolution; i++) {\n        tile.tileData.binXPos[i] = tileX + binSizeBp * i + binSizeBpHalf;\n      }\n\n      // 1. Coarsify the dense matrix according to `this.markResolution`\n      tile.tileData.valuesByRow = Array(numRows)\n        .fill()\n        .map(() => []);\n      tile.tileData.maxValueByRow = Array(numRows).fill(-Infinity);\n\n      for (let i = 0; i < numRows; i++) {\n        for (let j = 0; j < TILE_SIZE; j += binSizePx) {\n          const meanValue = meanNan(\n            tile.tileData.dense.subarray(\n              i * TILE_SIZE + j,\n              i * TILE_SIZE + j + binSizePx\n            )\n          );\n          tile.tileData.valuesByRow[i].push(meanValue);\n          tile.tileData.maxValueByRow[i] =\n            meanValue > tile.tileData.maxValueByRow[i]\n              ? meanValue\n              : tile.tileData.maxValueByRow[i];\n        }\n      }\n\n      // 2. Sort rows\n      if (this.rowSelections.length) {\n        tile.tileData.valuesByRow = this.rowSelections\n          .map((rowIdx) => tile.tileData.valuesByRow[rowIdx])\n          .filter(identity);\n        tile.tileData.maxValueByRow = this.rowSelections\n          .map((rowIdx) => tile.tileData.maxValueByRow[rowIdx])\n          .filter(identity);\n      }\n\n      // 3. Set out shape\n      tile.tileData.coarseShape = [\n        tile.tileData.valuesByRow.length,\n        this.markResolution,\n      ];\n    }\n\n    updateTiles() {\n      Object.values(this.fetchedTiles).forEach(\n        this.coarsifyTileValues.bind(this)\n      );\n    }\n\n    updateScales() {\n      const fetchedTiles = Object.values(this.fetchedTiles);\n\n      if (!fetchedTiles.length) return;\n\n      const numRows = getNumRows(fetchedTiles);\n\n      const [rowHeight] = this.getRowHeight();\n\n      const actualTrackHeight = this.getTrackHeight(numRows, rowHeight);\n\n      const globalMax = getMax(this.fetchedTiles);\n\n      this.valueScale = scaleLinear()\n        .domain([0, globalMax])\n        .range([rowHeight, 0]);\n      this.colorIndexScale = scaleLinear()\n        .domain([0, globalMax])\n        .range([0, this.markNumColors])\n        .clamp(true);\n\n      if (this.rowNormalization) {\n        const rowMaxs = getRowMaxs(this.fetchedTiles);\n        this.rowValueScales = {};\n        this.rowColorIndexScales = {};\n        for (let i = 0; i < numRows; i++) {\n          this.rowValueScales[i] = scaleLinear()\n            .domain([0, rowMaxs[i]])\n            .range([rowHeight, 0]);\n          this.rowColorIndexScales[i] = scaleLinear()\n            .domain([0, rowMaxs[i]])\n            .range([0, this.markNumColors])\n            .clamp(true);\n        }\n        this.valueScaleByRow = (value, row) =>\n          Number.isNaN(value) ? rowHeight : this.rowValueScales[row](value);\n        this.colorIndexScaleByRow = (value, row) =>\n          Number.isNaN(value) ? -2 : this.rowColorIndexScales[row](value);\n      } else {\n        this.valueScaleByRow = (value, row) =>\n          Number.isNaN(value) ? rowHeight : this.valueScale(value);\n        this.colorIndexScaleByRow = (value, row) =>\n          Number.isNaN(value) ? -2 : this.colorIndexScale(value);\n      }\n\n      this.rowScale = scaleLinear()\n        .domain([0, numRows])\n        .range([0, actualTrackHeight + this.rowPadding]);\n    }\n\n    tilesToData(tiles, { markArea, maxRows = Infinity, rowHeight } = {}) {\n      if (!tiles.length) return [];\n\n      const numRows = Math.min(maxRows, getNumRows(tiles));\n\n      const positionsByRow = Array(numRows)\n        .fill()\n        .map(() => []);\n      const colorIndicesByRow = Array(numRows)\n        .fill()\n        .map(() => []);\n      const offsetSignsByRow = Array(numRows)\n        .fill()\n        .map(() => []);\n\n      tiles.forEach((tile) => {\n        tile.tileData.valuesByRow.forEach((values, i) => {\n          if (i >= maxRows) return;\n          values.forEach((value, j) => {\n            const x = this._xScale(tile.tileData.binXPos[j]);\n            const yStart = this.rowScale(i);\n            const y = yStart + this.valueScaleByRow(value, i);\n            // We're duplicating the point as for every point on the line we\n            // need two x,y vertices to render triangles.\n            positionsByRow[i].push(x, y, x, y);\n            colorIndicesByRow[i].push(-1, -1); // -1 refers to the line color\n            offsetSignsByRow[i].push(1, -1);\n\n            if (markArea) {\n              positionsByRow[i].push(x, y, x, yStart + rowHeight);\n              colorIndicesByRow[i].push(this.colorIndexScaleByRow(value, i), 0);\n              offsetSignsByRow[i].push(0, 0);\n            }\n          });\n        });\n      });\n\n      const size2d = markArea ? 8 : 4;\n      const size1d = markArea ? 4 : 2;\n\n      // For each row, duplicate the first and last point\n      for (let i = 0; i < numRows; i++) {\n        // Add first point pair to the beginning of the array\n        positionsByRow[i].unshift(...positionsByRow[i].slice(0, size2d));\n\n        // The very first duplicated point positions do not matter as\n        // we offset the buffer reading. Subsequent dupliations need to be\n        // taken into account though.\n        if (i > 0) {\n          colorIndicesByRow[i].unshift(\n            ...colorIndicesByRow[i].slice(0, size1d)\n          );\n          offsetSignsByRow[i].unshift(...offsetSignsByRow[i].slice(0, size1d));\n        }\n\n        // Add last point pair to the end of the array\n        positionsByRow[i].push(...positionsByRow[i].slice(-size2d));\n        colorIndicesByRow[i].push(...colorIndicesByRow[i].slice(-size1d));\n        offsetSignsByRow[i].push(...offsetSignsByRow[i].slice(-size1d));\n      }\n\n      return [\n        new Float32Array(positionsByRow.flatMap(identity)),\n        new Float32Array(colorIndicesByRow.flatMap(identity)),\n        new Float32Array(offsetSignsByRow.flatMap(identity)),\n      ];\n    }\n\n    toLineIndices(numRows, numPointsPerRow, markArea) {\n      const verticesPerLine = markArea ? 12 : 6;\n      const verticesPerPoint = markArea ? 4 : 2;\n      const indices = new Uint32Array(\n        (numPointsPerRow - 1) * numRows * verticesPerLine\n      );\n      let k = 0;\n\n      if (markArea) {\n        // Draw a line and area\n        for (let i = 0; i < numRows; i++) {\n          for (let j = 0; j < numPointsPerRow - 1; j++) {\n            // The `+2` comes from the fact that for each row of points we\n            // duplicate the first and last point.\n            const pointOffset = i * (numPointsPerRow + 2) * verticesPerPoint;\n            const p1a = pointOffset + j * verticesPerPoint;\n            const p1b = p1a + 1;\n            const p1c = p1a + 2;\n            const p1d = p1a + 3;\n            const p2a = p1a + 4;\n            const p2b = p1a + 5;\n            const p2c = p1a + 6;\n            const p2d = p1a + 7;\n\n            const indexOffset = k * verticesPerLine;\n            // Area\n            indices[indexOffset] = p1c;\n            indices[indexOffset + 1] = p1d;\n            indices[indexOffset + 2] = p2c;\n            indices[indexOffset + 3] = p2c;\n            indices[indexOffset + 4] = p1d;\n            indices[indexOffset + 5] = p2d;\n            // Line\n            indices[indexOffset + 6] = p1a;\n            indices[indexOffset + 7] = p1b;\n            indices[indexOffset + 8] = p2a;\n            indices[indexOffset + 9] = p2a;\n            indices[indexOffset + 10] = p1b;\n            indices[indexOffset + 11] = p2b;\n\n            k++;\n          }\n        }\n      } else {\n        // Just draw a line\n        for (let i = 0; i < numRows; i++) {\n          for (let j = 0; j < numPointsPerRow - 1; j++) {\n            // The `+2` comes from the fact that for each row of points we\n            // duplicate the first and last point.\n            const pointOffset = i * (numPointsPerRow + 2) * verticesPerPoint;\n            const p1a = pointOffset + j * verticesPerPoint;\n            const p1b = p1a + 1;\n            const p2a = p1a + 2;\n            const p2b = p1a + 3;\n\n            const indexOffset = k * verticesPerLine;\n            indices[indexOffset] = p1a;\n            indices[indexOffset + 1] = p1b;\n            indices[indexOffset + 2] = p2a;\n            indices[indexOffset + 3] = p2a;\n            indices[indexOffset + 4] = p1b;\n            indices[indexOffset + 5] = p2b;\n\n            k++;\n          }\n        }\n      }\n\n      return indices;\n    }\n\n    getRowHeight(numRows) {\n      const [, visibleTrackHeight] = this.dimensions;\n\n      return this.rowHeight === 'auto'\n        ? [\n            Math.floor(visibleTrackHeight / numRows),\n            Math.floor(visibleTrackHeight / numRows),\n          ]\n        : [this.rowHeight, this.rowHeight + this.rowPadding];\n    }\n\n    getTrackHeight(numRows, rowHeight) {\n      const [, visibleTrackHeight] = this.dimensions;\n\n      return this.rowHeight === 'auto'\n        ? visibleTrackHeight\n        : rowHeight * numRows + this.rowPadding * (numRows - 1);\n    }\n\n    renderLines() {\n      this.drawnAtScale = scaleLinear()\n        .domain([...this.xScale().domain()])\n        .range([...this.xScale().range()]);\n\n      const tiles = Object.values(this.fetchedTiles);\n\n      const numRows = getNumRows(tiles);\n      const [rowHeight] = this.getRowHeight(numRows);\n\n      const [positions, colorIndices, offsetSigns] = this.tilesToData(tiles, {\n        maxRows: numRows,\n        markArea: this.markArea,\n        rowHeight,\n      });\n\n      const numPointsPerRow = getNumPointsPerRow(\n        numRows,\n        positions,\n        this.markArea\n      );\n\n      const indices = this.toLineIndices(\n        numRows,\n        numPointsPerRow,\n        this.markArea\n      );\n\n      const uniforms = new PIXI.UniformGroup({\n        uLineColor: [...this.markColorRgbNorm, 1.0],\n        uNaNColor: [1.0, 1.0, 1.0, 1.0],\n        uAreaColorTex: this.markColorTex,\n        uAreaColorTexRes: this.markColorTexRes,\n        uWidth: 0.25,\n        uMiter: 1,\n      });\n\n      const shader = PIXI.Shader.from(VS, FS, uniforms);\n\n      const geometry = new PIXI.Geometry();\n      const numCoords = 2;\n      const numVerticesPoint = this.markArea ? 4 : 2;\n      geometry.addAttribute(\n        'aPrevPosition',\n        positions,\n        2, // size\n        false, // normalize\n        PIXI.TYPES.FLOAT, // type\n        FLOAT_BYTES * numCoords, // stride\n        0 // offset/start\n      );\n      geometry.addAttribute(\n        'aCurrPosition',\n        positions,\n        2, // size\n        false, // normalize\n        PIXI.TYPES.FLOAT, // type\n        FLOAT_BYTES * numCoords, // stride\n        // note that each point is duplicated, hence we need to skip over the first two\n        FLOAT_BYTES * numCoords * numVerticesPoint // offset/start\n      );\n      geometry.addAttribute(\n        'aNextPosition',\n        positions,\n        2, // size\n        false, // normalize\n        PIXI.TYPES.FLOAT, // type\n        FLOAT_BYTES * 2, // stride\n        // note that each point is duplicated, hence we need to skip over the first four\n        FLOAT_BYTES * numCoords * numVerticesPoint * 2 // offset/start\n      );\n      geometry.addAttribute('aOffsetSign', offsetSigns, 1);\n      geometry.addAttribute('aColorIndex', colorIndices, 1);\n      geometry.addIndex(indices);\n\n      const mesh = new PIXI.Mesh(geometry, shader);\n\n      const newGraphics = new PIXI.Graphics();\n      newGraphics.addChild(mesh);\n\n      // eslint-disable-next-line\n      this.pMain.x = this.position[0];\n\n      if (this.lineGraphics) {\n        this.pMain.removeChild(this.lineGraphics);\n        this.lineGraphics.destroy();\n      }\n\n      this.pMain.addChild(newGraphics);\n      this.lineGraphics = newGraphics;\n\n      scaleGraphics(this.lineGraphics, this._xScale, this.drawnAtScale);\n\n      this.draw();\n      this.animate();\n    }\n\n    // Called whenever a new tile comes in\n    updateExistingGraphics() {\n      this.updateLoadIndicator();\n      if (!this.hasFetchedTiles()) return;\n      this.updateScales();\n      this.renderLines();\n    }\n\n    updateLoadIndicator() {\n      const [left, top] = this.position;\n      this.pLoading.position.x = left + 6;\n      this.pLoading.position.y = top + 6;\n\n      if (this.fetching.size) {\n        this.pLoading.addChild(this.loadIndicator);\n      } else {\n        this.pLoading.removeChild(this.loadIndicator);\n      }\n    }\n\n    refreshTiles() {\n      super.refreshTiles();\n      this.updateLoadIndicator();\n    }\n\n    setPosition(newPosition) {\n      super.setPosition(newPosition);\n\n      [this.pMain.position.x, this.pMain.position.y] = this.position;\n    }\n\n    zoomed(newXScale, newYScale) {\n      this.xScale(newXScale);\n      this.yScale(newYScale);\n\n      if (this.lineGraphics) {\n        scaleGraphics(this.lineGraphics, newXScale, this.drawnAtScale);\n      }\n\n      this.refreshTiles();\n      this.draw();\n    }\n\n    /**\n     * Return the data currently visible at position X and Y\n     *\n     * @param {Number} trackX: The x position relative to the track's start and end\n     * @param {Number} trakcY: The y position relative to the track's start and end\n     */\n    getVisibleData(trackX, trackY) {\n      if (!this.hasFetchedTiles()) return '';\n\n      const zoomLevel = this.calculateZoomLevel();\n\n      const numRows = getNumRows(this.fetchedTiles);\n      const [, rowStepHeight] = this.getRowHeight(numRows);\n\n      // the width of the tile in base pairs\n      const tileWidth = tileProxy.calculateTileWidth(\n        this.tilesetInfo,\n        zoomLevel,\n        this.tilesetInfo.tile_size\n      );\n\n      // the position of the tile containing the query position\n      const tilePos = this._xScale.invert(trackX) / tileWidth;\n\n      // the position of query within the tile\n      let posInTileX =\n        this.tilesetInfo.tile_size * (tilePos - Math.floor(tilePos));\n      // const posInTileYNormalized = trackY / this.dimensions[1];\n      // The first track doesn't apply padding so we have to shift padding\n      // to the mouse position once\n      const rowIndex = Math.floor(\n        Math.max(0, (trackY + this.rowPadding) / rowStepHeight)\n      );\n      const rowSelection = this.rowSelections[rowIndex];\n      const tileId = this.tileToLocalId([zoomLevel, Math.floor(tilePos)]);\n      const fetchedTile = this.fetchedTiles[tileId];\n      const colIndex =\n        Math.floor(posInTileX) / Math.floor(TILE_SIZE / this.markResolution);\n\n      let text = '';\n      let value = '<em>unknown</em>';\n\n      if (rowSelection === undefined) return text;\n\n      if (fetchedTile) {\n        if (!this.tilesetInfo.shape) {\n          posInTileX =\n            fetchedTile.tileData.dense.length * (tilePos - Math.floor(tilePos));\n        }\n\n        let index = null;\n        if (this.tilesetInfo.shape) {\n          // Accomodate data from vector sources\n          if (\n            Array.isArray(rowSelection) &&\n            this.options.selectRowsAggregationMethod === 'client'\n          ) {\n            // Need to aggregate, so `index` will actually be an array.\n            index = rowSelection.map(\n              (rowI) =>\n                this.tilesetInfo.shape[0] * rowI + Math.floor(posInTileX)\n            );\n          } else if (\n            rowSelection &&\n            this.options.selectRowsAggregationMethod === 'client'\n          ) {\n            index =\n              this.tilesetInfo.shape[0] * rowSelection + Math.floor(posInTileX);\n          } else {\n            // No need to aggregate, `index` will contain a single item.\n            index =\n              this.tilesetInfo.shape[0] * rowIndex + Math.floor(posInTileX);\n          }\n        } else {\n          index =\n            fetchedTile.tileData.dense.length * rowIndex +\n            Math.floor(posInTileX);\n        }\n\n        if (Array.isArray(index)) {\n          const values = index.map((i) => fetchedTile.tileData.dense[i]);\n          value = format('.3f')(this.selectRowsAggregationFn(values));\n          text = value;\n\n          text += '<br/>';\n          text += `${index.length}-item ${this.options.selectRowsAggregationMode}`;\n        } else {\n          value = format('.3f')(\n            fetchedTile.tileData.valuesByRow[rowIndex][colIndex]\n          );\n          text = value;\n\n          if (Array.isArray(rowSelection)) {\n            value += '<br/>';\n            value += `${rowSelection.length}-item ${this.options.selectRowsAggregationMode}`;\n          }\n        }\n      }\n\n      // add information about the row\n      if (this.tilesetInfo.row_infos) {\n        let rowInfo = '';\n\n        if (rowSelection !== undefined) {\n          rowInfo = this.tilesetInfo.row_infos[rowSelection];\n        }\n\n        const label =\n          typeof rowInfo === 'object'\n            ? this.rowIdToCategory(rowInfo.id)\n            : rowInfo;\n\n        const color = this.rowCategories[label]\n          ? this.rowCategories[label].axisLabelColor ||\n            DEFAULT_COLOR_MAP_DARK[\n              this.rowCategories[label].index % DEFAULT_COLOR_MAP_DARK.length\n            ]\n          : '#666666';\n\n        const background = this.rowCategories[label]\n          ? this.rowCategories[label].axisLabelColor ||\n            DEFAULT_COLOR_MAP_LIGHT[\n              this.rowCategories[label].index % DEFAULT_COLOR_MAP_LIGHT.length\n            ]\n          : '#ffffff';\n\n        return `<div style=\"margin: -0.25rem; padding: 0 0.25rem; background: ${background}\"><strong style=\"color: ${color};\">${label}:</strong> ${value}</div>`;\n      }\n\n      return text;\n    }\n\n    /**\n     * Get some information to display when the mouse is over this\n     * track\n     *\n     * @param {Number} trackX: the x position of the mouse over the track\n     * @param {Number} trackY: the y position of the mouse over the track\n     *\n     * @return {string}: A HTML string containing the information to display\n     *\n     */\n    getMouseOverHtml(trackX, trackY) {\n      if (!this.tilesetInfo) return '';\n\n      return this.getVisibleData(trackX, trackY);\n    }\n\n    exportSVG() {\n      const svgns = 'http://www.w3.org/2000/svg';\n\n      let track = null;\n      let base = null;\n\n      [base, track] = super.exportSVG();\n\n      base.setAttribute('class', 'ridge-plot-track');\n      const output = document.createElement('g');\n\n      track.appendChild(output);\n      output.setAttribute(\n        'transform',\n        `translate(${this.position[0]}, ${this.position[1]})`\n      );\n\n      const tiles = Object.values(this.fetchedTiles);\n\n      const numRows = getNumRows(tiles);\n      const [rowHeight] = this.getRowHeight(numRows);\n      const stride = this.markArea ? 8 : 4;\n\n      const [positions] = this.tilesToData(tiles, {\n        maxRows: numRows,\n        markArea: this.markArea,\n        rowHeight,\n      });\n\n      const createLine = line()\n        .x((d) => d[0])\n        .y((d) => d[1]);\n\n      const posPerRow = positions.length / numRows;\n\n      const posToPoints = (pos) => {\n        const arr = [];\n        const start = stride;\n        const end = pos.length - stride;\n\n        for (let i = start; i < end; i += stride) {\n          arr.push([pos[i], pos[i + 1]]);\n        }\n\n        return arr;\n      };\n\n      let fill = this.markArea\n        ? (this.options.colorRange && this.options.colorRange[0]) || '#ffffff'\n        : 'none';\n      if (this.markArea && this.options.colorRange) {\n        const numColors = this.options.colorRange.length;\n        const defs = document.createElementNS(svgns, 'defs');\n        const linearGradient = document.createElementNS(\n          svgns,\n          'linearGradient'\n        );\n        linearGradient.setAttribute('id', 'RidgePlotGradient');\n        linearGradient.setAttribute('x1', '0');\n        linearGradient.setAttribute('y1', '1');\n        linearGradient.setAttribute('x2', '0');\n        linearGradient.setAttribute('y2', '0');\n        this.options.colorRange.forEach((color, i) => {\n          const stop = document.createElementNS(svgns, 'stop');\n          stop.setAttribute(\n            'offset',\n            `${Math.round((i / (numColors - 1)) * 100)}%`\n          );\n          stop.setAttribute('stop-color', color);\n          linearGradient.appendChild(stop);\n        });\n        defs.appendChild(linearGradient);\n        base.insertBefore(defs, base.firstChild);\n        fill = 'url(#RidgePlotGradient)';\n      }\n\n      for (let i = 0; i < numRows; i++) {\n        const arr = posToPoints(\n          positions.subarray(i * posPerRow, (i + 1) * posPerRow)\n        );\n\n        const l = document.createElement('path');\n        let d = createLine(arr);\n\n        const y0 = this.rowScale(i) + this.valueScaleByRow(0, i);\n\n        // We extend the line a little to the left and right and anchor them at\n        // y = 0 to avoid weird glitches with the fill.\n        const firstComma = d.indexOf(',');\n        const firstX = +d.substring(1, firstComma);\n        const firstY = +d.substring(firstComma + 1, d.indexOf('L'));\n        d = `M${firstX - 1},${y0}L${firstX - 1},${firstY}L${d.substring(1)}`;\n        const lastComma = d.lastIndexOf(',');\n        const lastX = +d.substring(d.lastIndexOf('L') + 1, lastComma);\n        const lastY = +d.substring(lastComma + 1);\n        d += `L${lastX + 1},${lastY}L${lastX + 1},${y0}`;\n\n        l.setAttribute('d', d);\n        l.setAttribute('fill', fill);\n        l.setAttribute('stroke', this.options.markColor || 'black');\n        l.setAttribute('stroke-width', (this.options.markSize || 2) / 8);\n\n        output.appendChild(l);\n      }\n\n      return [base, track];\n    }\n  }\n\n  return new RidgePlotTrack(...args);\n};\n\ncreateRidgePlotTrack.config = {\n  type: 'ridge-plot',\n  datatype: ['multivec'],\n  orientation: '1d',\n  name: 'RidgePlot',\n};\n\nexport default createRidgePlotTrack;\n","import createIntervalTree from 'interval-tree-1d';\n\nimport {\n  DEFAULT_COLOR_MAP,\n  DEFAULT_COLOR_MAP_DARK,\n  DEFAULT_COLOR_MAP_LIGHT,\n  EPS,\n} from './constants';\nimport { contains, dashedXLineTo, toFixed } from './utils';\n\nconst VS = `\n  precision mediump float;\n  attribute vec2 aPosition;\n  attribute float aOpacity;\n  attribute float aHighlight;\n\n  uniform mat3 projectionMatrix;\n  uniform mat3 translationMatrix;\n  uniform float uPointSize;\n\n  varying float vHighlight;\n  varying float vOpacity;\n\n  void main(void)\n  {\n    vHighlight = aHighlight;\n    vOpacity = aOpacity;\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n    gl_PointSize = uPointSize;\n  }\n`;\n\nconst FS = `\n  precision mediump float;\n\n  uniform vec4 uColor;\n  uniform vec4 uColorHighlight;\n\n  varying float vHighlight;\n  varying float vOpacity;\n\n  void main() {\n    float isNotFocused = 1.0 - vHighlight;\n\n    float r = uColor.r * isNotFocused + uColorHighlight.r * vHighlight;\n    float g = uColor.g * isNotFocused + uColorHighlight.g * vHighlight;\n    float b = uColor.b * isNotFocused + uColorHighlight.b * vHighlight;\n\n    gl_FragColor = vec4(r, g, b, 1.0) * vOpacity;\n  }\n`;\n\n// prettier-ignore\nconst pointToPosition = (pt) => [\n  // top-left\n  pt.cX - pt.widthHalf, pt.y,\n  // top-right\n  pt.cX + pt.widthHalf, pt.y,\n  // bottom-right\n  pt.cX + pt.widthHalf, pt.y + pt.height,\n  // pt.cX + pt.widthHalf, pt.y + pt.height,\n  // bottom-left\n  pt.cX - pt.widthHalf, pt.y + pt.height,\n  // pt.cX - pt.widthHalf, pt.y,\n];\n\nconst pointToIndex = (pt, i) => {\n  const base = i * 4;\n  return [base, base + 1, base + 2, base + 2, base + 3, base];\n};\n\nconst pointToOpacity = (pt) => [pt.opacity, pt.opacity, pt.opacity, pt.opacity];\n\nconst pointToHighlight = (pt) => [\n  pt.highlight,\n  pt.highlight,\n  pt.highlight,\n  pt.highlight,\n];\n\nconst getItemDistance = (item) =>\n  Math.abs(\n    +item.fields[1] +\n      (+item.fields[2] - +item.fields[1]) / 2 -\n      (+item.fields[4] + (+item.fields[4] - +item.fields[5]) / 2)\n  );\n\nconst getMaxDistance = (fetchedTiles) =>\n  Object.values(fetchedTiles).reduce(\n    (maxDist, tile) =>\n      Math.max(\n        maxDist,\n        tile.tileData.reduce(\n          (maxDistItem, item) => Math.max(maxDistItem, item.distance),\n          0\n        )\n      ),\n    0\n  );\n\nconst scaleScalableGraphics = (graphics, xScale, drawnAtScale) => {\n  const tileK =\n    (drawnAtScale.domain()[1] - drawnAtScale.domain()[0]) /\n    (xScale.domain()[1] - xScale.domain()[0]);\n  const newRange = xScale.domain().map(drawnAtScale);\n\n  const posOffset = newRange[0];\n  graphics.scale.x = tileK;\n  graphics.position.x = -posOffset * tileK;\n};\n\nconst getRegionId = (item) =>\n  `${item.fields[0]}:${item.fields[1]}-${item.fields[2]}`;\n\nconst createStratifiedBedTrack = function createStratifiedBedTrack(\n  HGC,\n  ...args\n) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  const { PIXI } = HGC.libraries;\n  const { scaleLinear, scaleLog } = HGC.libraries.d3Scale;\n  const { tileProxy } = HGC.services;\n  const { MAX_CLICK_DELAY } = HGC.configs;\n\n  const opacityLogScale = scaleLog()\n    .domain([1, 10])\n    .range([0.1, 1])\n    .clamp(true);\n\n  class StratifiedBedTrack extends HGC.tracks.HorizontalLine1DPixiTrack {\n    constructor(context, options) {\n      super(context, options);\n\n      this.pLegend = new PIXI.Graphics();\n      this.pMasked.addChild(this.pLegend);\n\n      this.legendMin = Infinity;\n      this.legendMax = -Infinity;\n\n      // Needed for interaction tracking because interaction tracking on the\n      // mesh causes errors...\n      this.bg = new PIXI.Sprite(PIXI.Texture.WHITE);\n      [this.bg.width, this.bg.height] = this.dimensions;\n      this.bg.interactive = true;\n      this.bg.interactiveChildren = false;\n      this.bg.alpha = 0;\n\n      let mousedownTime = performance.now();\n      this.bg.mousedown = () => {\n        mousedownTime = performance.now();\n      };\n      this.bg.mouseup = (e) => {\n        if (performance.now() - mousedownTime < MAX_CLICK_DELAY)\n          this.clickHandler(e);\n      };\n\n      this.updateOptions();\n\n      this.pLoading = new PIXI.Graphics();\n      this.pLoading.position.x = 0;\n      this.pLoading.position.y = 0;\n      this.pMasked.addChild(this.pLoading);\n\n      this.loadIndicator = new PIXI.Text('Loading data...', {\n        fontSize: this.labelSize || 10,\n        fill: 0x808080,\n      });\n      this.pLoading.addChild(this.loadIndicator);\n    }\n\n    initTile(tile) {\n      const intervals = [];\n\n      tile.tileData.forEach((item, i) => {\n        item.distance = getItemDistance(item) || -1;\n        item.cX = item.xStart + (item.xEnd - item.xStart) / 2;\n        item.regionId = getRegionId(item);\n        item.isLeftToRight = item.xStart < item.xEnd;\n        intervals.push([item.xStart, item.xEnd, i]);\n      });\n\n      tile.intervalTree = createIntervalTree(intervals);\n    }\n\n    updateStratificationOption() {\n      if (!this.options.stratification) {\n        this.categoryField = undefined;\n        this.categoryToGroup = undefined;\n        this.groupToColor = undefined;\n        this.numGroups = 0;\n        this.numCategories = 0;\n        this.groupLabels = [];\n        return;\n      }\n\n      this.categoryField = this.options.stratification.categoryField;\n      this.getCategory = (item) =>\n        item.fields[this.categoryField].toLowerCase();\n      this.categoryToGroup = new Map();\n      this.categoryToY = new Map();\n      this.yToCategory = new Map();\n      this.groupToColor = new Map();\n\n      this.groupSizes = this.options.stratification.groups.map(\n        (group) =>\n          group.categories.filter((category) => this.valueFilter(category))\n            .length\n      );\n      this.filteredGroups = this.options.stratification.groups.filter(\n        (group, i) => this.groupSizes[i] > 0\n      );\n      this.numGroups = this.filteredGroups.length;\n      this.numCategories = this.groupSizes.reduce(\n        (numCategories, groupSize) => numCategories + groupSize,\n        0\n      );\n      this.groupLabels = this.options.stratification.groups.map(\n        (group, i) => group.label || `Group ${i}`\n      );\n\n      let k = 0;\n      this.options.stratification.groups.forEach((group, i) => {\n        this.groupToColor.set(i, [\n          HGC.utils.colorToHex(\n            group.color || DEFAULT_COLOR_MAP[i % DEFAULT_COLOR_MAP.length]\n          ),\n          HGC.utils.colorToHex(\n            group.backgroundColor ||\n              DEFAULT_COLOR_MAP_LIGHT[i % DEFAULT_COLOR_MAP.length]\n          ),\n        ]);\n        group.categories\n          .filter((category) => this.valueFilter(category))\n          .forEach((category, j) => {\n            const cat = category.toLowerCase();\n            this.categoryToGroup.set(cat, i);\n            this.categoryToY.set(cat, k + j);\n            this.yToCategory.set(k + j, cat);\n          });\n        k += this.groupSizes[i];\n      });\n\n      this.groupLabelsPixiText = this.groupLabels.map(\n        (label, i) =>\n          new PIXI.Text(label, {\n            fontSize: this.labelSize,\n            align: this.axisAlign === 'right' ? 'right' : 'left',\n            fill: HGC.utils.colorToHex(\n              this.options.stratification.groups[i].axisLabelColor ||\n                DEFAULT_COLOR_MAP_DARK[i % DEFAULT_COLOR_MAP_DARK.length]\n            ),\n          })\n      );\n    }\n\n    updateOptions() {\n      this.axisAlign = this.options.axisAlign || 'left';\n\n      this.labelColor = HGC.utils.colorToHex(\n        this.options.labelColor || 'black'\n      );\n\n      this.labelSize = this.options.labelSize || 12;\n\n      this.markColor = HGC.utils.colorToHex(this.options.markColor || 'black');\n\n      this.markColorRgbNorm = this.options.markColor\n        ? HGC.utils\n            .colorToRgba(this.options.markColor)\n            .slice(0, 3)\n            .map((x) => Math.min(1, Math.max(0, x / 255)))\n        : [0, 0, 0];\n\n      this.markOpacity = Number.isNaN(+this.options.markOpacity)\n        ? 1\n        : Math.min(1, Math.max(0, +this.options.markOpacity));\n\n      this.markSize = this.options.markSize || 2;\n      this.markMinWidth = this.options.markMinWidth || this.markSize;\n      this.markHeight = this.options.markHeight || this.markSize;\n\n      this.rowHeight = this.options.rowHeight || this.markHeight;\n\n      this.markColorHighlight = HGC.utils.colorToHex(\n        this.options.markColorHighlight || 'red'\n      );\n\n      this.markColorHighlightRgbNorm = this.options.markColorHighlight\n        ? HGC.utils\n            .colorToRgba(this.options.markColorHighlight)\n            .slice(0, 3)\n            .map((x) => Math.min(1, Math.max(0, x / 255)))\n        : [1, 0, 0];\n\n      this.markColorDehighlight = HGC.utils.colorToHex(\n        this.options.markColorDehighlight || '#999999'\n      );\n\n      this.markColorDehighlightRgbNorm = this.options.markColorDehighlight\n        ? HGC.utils\n            .colorToRgba(this.options.markColorDehighlight)\n            .slice(0, 3)\n            .map((x) => Math.min(1, Math.max(0, x / 255)))\n        : [0.6, 0.6, 0.6];\n\n      this.markOpacityFocus = Number.isNaN(+this.options.markOpacityFocus)\n        ? this.markOpacity\n        : Math.min(1, Math.max(0, +this.options.markOpacityFocus));\n\n      this.filterSet =\n        this.options.filter && this.options.filter.set\n          ? this.options.filter.set.reduce((s, include) => {\n              s.add(include);\n              return s;\n            }, new Set())\n          : null;\n\n      this.filterField = this.options.filter && this.options.filter.field;\n\n      this.valueFilter = this.filterSet\n        ? (value) => this.filterSet.has(value)\n        : () => true;\n\n      this.itemFilter =\n        this.valueFilter && this.filterField\n          ? (item) => this.valueFilter(item.fields[this.filterField])\n          : () => true;\n\n      this.getImportance = this.options.importanceField\n        ? (item) => +item.fields[this.options.importanceField]\n        : (item) => item.distance;\n\n      this.opacityEncoding = this.options.opacityEncoding || 'solid';\n\n      switch (this.opacityEncoding) {\n        case 'frequency':\n          this.opacityScale = () => 0.1;\n          break;\n\n        case 'highestImportance':\n        case 'closestImportance': {\n          const importanceDomain = this.options.importanceDomain || [1, 1000];\n          const opacityLinearScale = scaleLinear()\n            .domain(importanceDomain)\n            .range([1, 10]);\n          this.opacityScale = (x) => opacityLogScale(opacityLinearScale(x));\n          break;\n        }\n\n        case 'solid':\n        default:\n          this.opacityScale = () => 1;\n          break;\n      }\n\n      this.focusRegion = this.options.focusRegion\n        ? this.options.focusRegion\n        : [Infinity, Infinity];\n\n      this.getRegion = this.options.focusRegion\n        ? (item) => [item.xStart, item.xEnd]\n        : undefined;\n\n      this.focusGene = this.options.focusGene\n        ? this.options.focusGene.toLowerCase()\n        : undefined;\n\n      this.getGene = this.options.geneField\n        ? (item) => item.fields[this.options.geneField].toLowerCase()\n        : undefined;\n\n      this.focusStyle = this.options.focusStyle\n        ? this.options.focusStyle.toLowerCase()\n        : undefined;\n\n      this.minImportance = this.options.minImportance || 0;\n\n      this.updateStratificationOption();\n    }\n\n    rerender(newOptions) {\n      this.options = newOptions;\n      this.updateOptions();\n      this.updateExistingGraphics();\n    }\n\n    hasFetchedTiles() {\n      return Object.values(this.fetchedTiles).length;\n    }\n\n    updateScales() {\n      const fetchedTiles = Object.values(this.fetchedTiles);\n\n      if (!fetchedTiles.length) return;\n\n      const [, height] = this.dimensions;\n\n      this.maxDist = getMaxDistance(this.fetchedTiles);\n\n      this.heightScale = scaleLinear()\n        .domain([0, this.maxDist])\n        .range([Math.min(12, height / 10), height]);\n\n      this.categoryHeightScale = scaleLinear()\n        .domain([0, this.numCategories])\n        .range([0, this.numCategories * this.rowHeight]);\n\n      this.valueScale = scaleLinear()\n        .domain([0, this.maxDist])\n        .range([height, 0]);\n\n      this.valueScaleInverted = scaleLinear()\n        .domain([0, this.maxDist])\n        .range([0, height]);\n    }\n\n    itemToIndicatorCategory(item, isHighlighting) {\n      return {\n        cX: this._xScale(item.cX),\n        y: this.categoryHeightScale(\n          this.categoryToY.get(this.getCategory(item))\n        ),\n        opacity: this.opacityScale(this.getImportance(item)),\n        highlight: isHighlighting && item.__focus,\n        widthHalf: Math.max(\n          this.markMinWidth / 2,\n          Math.abs(this._xScale(item.xStart) - this._xScale(item.xEnd)) / 2\n        ),\n        height: this.markHeight,\n        __item: item,\n      };\n    }\n\n    isItemInFocus() {\n      if (\n        this.getGene &&\n        this.focusGene &&\n        this.getRegion &&\n        this.focusRegion\n      ) {\n        return (item) => {\n          item.__focus =\n            this.getGene(item) === this.focusGene &&\n            contains(this.getRegion(item), this.focusRegion);\n          return item.__focus;\n        };\n      }\n\n      if (this.getGene && this.focusGene) {\n        return (item) => {\n          item.__focus = this.getGene(item) === this.focusGene;\n          return item.__focus;\n        };\n      }\n\n      if (this.getRegion && this.focusRegion) {\n        return (item) => {\n          item.__focus = contains(this.getRegion(item), this.focusRegion);\n          return item.__focus;\n        };\n      }\n\n      return (item) => {\n        item.__focus = false;\n        // If no focus was defined, we include all intervals\n        return true;\n      };\n    }\n\n    itemToIndicatorReducer(focusFilterFn, addFn) {\n      if (this.focusStyle === 'highlighting') {\n        return (filteredItems, item, i) => {\n          focusFilterFn(item);\n          if (this.itemFilter(item)) addFn(filteredItems, item);\n          return filteredItems;\n        };\n      }\n\n      return (filteredItems, item) => {\n        if (focusFilterFn(item) && this.itemFilter(item))\n          addFn(filteredItems, item);\n        return filteredItems;\n      };\n    }\n\n    getPoints(isHighlighting) {\n      let reducerVar = [];\n      let addFn = (accumulator, item) =>\n        accumulator.push(this.itemToIndicatorCategory(item, isHighlighting));\n\n      if (this.opacityEncoding === 'highestImportance') {\n        reducerVar = {};\n        addFn = (accumulator, item) => {\n          if (accumulator[item.regionId]) {\n            const i1 = this.getImportance(accumulator[item.regionId].__item);\n            const i2 = this.getImportance(item);\n            if (i2 > i1) {\n              accumulator[item.regionId] = this.itemToIndicatorCategory(\n                item,\n                isHighlighting\n              );\n            }\n          } else {\n            accumulator[item.regionId] = this.itemToIndicatorCategory(\n              item,\n              isHighlighting\n            );\n          }\n        };\n      } else if (this.opacityEncoding === 'closestImportance') {\n        reducerVar = {};\n        addFn = (accumulator, item) => {\n          if (\n            !accumulator[item.regionId] ||\n            item.distance < accumulator[item.regionId].__item.distance\n          ) {\n            accumulator[item.regionId] = this.itemToIndicatorCategory(\n              item,\n              isHighlighting\n            );\n          }\n        };\n      }\n\n      const focusFilterFn = this.isItemInFocus();\n      const dataToPoint = this.itemToIndicatorReducer(focusFilterFn, addFn);\n\n      return Object.values(this.fetchedTiles).flatMap((tile) =>\n        Object.values(tile.tileData.reduce(dataToPoint, reducerVar))\n      );\n    }\n\n    renderIndicatorPoints() {\n      this.drawnAtScale = scaleLinear()\n        .domain([...this.xScale().domain()])\n        .range([...this.xScale().range()]);\n\n      const isHighlighting = !!(\n        this.focusStyle === 'highlighting' &&\n        ((this.focusGene && this.getGene) ||\n          (this.focusRegion && this.getRegion))\n      );\n\n      const points = this.getPoints(isHighlighting);\n\n      const positions = new Float32Array(points.flatMap(pointToPosition));\n      const indices = new Uint16Array(points.flatMap(pointToIndex));\n      const opacities = new Float32Array(points.flatMap(pointToOpacity));\n      const highlights = new Float32Array(points.flatMap(pointToHighlight));\n\n      const uniforms = new PIXI.UniformGroup({\n        uColor: isHighlighting\n          ? [...this.markColorDehighlightRgbNorm, this.markOpacity]\n          : [...this.markColorRgbNorm, this.markOpacity],\n        uColorHighlight: [...this.markColorHighlightRgbNorm, this.markOpacity],\n        uHighlighting: isHighlighting,\n      });\n\n      const shader = PIXI.Shader.from(VS, FS, uniforms);\n\n      const geometry = new PIXI.Geometry();\n      geometry.addAttribute('aPosition', positions, 2);\n      geometry.addAttribute('aOpacity', opacities, 1);\n      geometry.addAttribute('aHighlight', highlights, 1);\n      geometry.addIndex(indices);\n\n      const mesh = new PIXI.Mesh(geometry, shader);\n\n      const newGraphics = new PIXI.Graphics();\n      newGraphics.addChild(this.bg);\n      newGraphics.addChild(mesh);\n\n      [this.bg.width, this.bg.height] = this.dimensions;\n\n      // eslint-disable-next-line\n      this.pMain.x = this.position[0];\n\n      if (this.indicatorPointGraphics) {\n        this.indicatorPointGraphics.removeChild(this.bg);\n        this.pMain.removeChild(this.indicatorPointGraphics);\n      }\n\n      this.pMain.addChild(newGraphics);\n      this.indicatorPointGraphics = newGraphics;\n\n      scaleScalableGraphics(\n        this.indicatorPointGraphics,\n        this._xScale,\n        this.drawnAtScale\n      );\n\n      this.draw();\n      this.animate();\n    }\n\n    renderIndicatorCategoryAxis() {\n      const [width] = this.dimensions;\n      const [left, top] = this.position;\n\n      this.pAxis.position.x = this.axisAlign === 'right' ? left + width : left;\n      this.pAxis.position.y = top;\n\n      this.pAxis.clear();\n      let yStart = 0;\n      let yEnd = 0;\n\n      const xTickOffset = this.axisAlign === 'right' ? -5 : 5;\n      const xTickEnd = this.axisAlign === 'right' ? -width : width;\n      const xLabelOffset = this.axisAlign === 'right' ? -3 : 3;\n      const numAxisLabels = this.pAxis.children.length;\n\n      this.pAxis.lineStyle(1, 0x000000, 1.0, 0.0);\n\n      this.groupLabelsPixiText.forEach((labelPixiText, i) => {\n        if (numAxisLabels < i + 1) {\n          this.pAxis.addChild(labelPixiText);\n        }\n\n        // Don't ask me why but somehow after `labelPixiText` was added to\n        // `this.pAxis` the object is not the same as `this.pAxis.children[i]`\n        // anymore and subsequent changes were ineffective\n        const text = this.pAxis.children[i];\n\n        if (this.groupSizes[i] === 0) {\n          text.alpha = 0;\n          return;\n        }\n\n        const height = this.categoryHeightScale(this.groupSizes[i]);\n        yEnd += height;\n        text.x = xLabelOffset;\n        text.y = yStart + height / 2;\n        text.anchor.x = this.axisAlign === 'right' ? 1 : 0;\n        text.anchor.y = 0.5;\n        text.alpha = 1;\n\n        if (this.options.focusStyle === 'highlighting') {\n          this.pAxis.beginFill(0xffffff, 0.66);\n        } else {\n          this.pAxis.beginFill(this.groupToColor.get(i)[1], 0.66);\n        }\n\n        this.pAxis.lineStyle(0);\n        if (this.axisAlign === 'right') {\n          this.pAxis.drawRect(\n            text.x - text.width,\n            text.y - text.height / 2,\n            text.width,\n            text.height\n          );\n        } else {\n          this.pAxis.drawRect(\n            text.x,\n            text.y - text.height / 2,\n            text.width,\n            text.height\n          );\n        }\n        this.pAxis.endFill();\n\n        this.pAxis.lineStyle(1, 0x000000, 1.0, 0.0);\n        this.pAxis.moveTo(0, yStart);\n        this.pAxis.lineTo(xTickOffset, yStart);\n\n        if (this.options.stratification.axisShowGroupSeparator) {\n          dashedXLineTo(this.pAxis, 0, xTickEnd, yStart, 5);\n        }\n\n        yStart = yEnd;\n      });\n\n      this.pAxis.moveTo(0, 0);\n      this.pAxis.lineTo(0, yEnd);\n      this.pAxis.lineTo(xTickOffset, yEnd);\n\n      if (this.options.stratification.axisShowGroupSeparator) {\n        dashedXLineTo(this.pAxis, 0, xTickEnd, yEnd, 5);\n      }\n    }\n\n    renderIndicatorLegend() {\n      this.pLegend.clear();\n\n      if (this.opacityEncoding.indexOf('Importance') === -1) {\n        if (this.legendMinText) {\n          this.pLegend.removeChild(this.legendMinText);\n          this.legendMinText.destroy();\n          this.legendMinText = undefined;\n        }\n        if (this.legendMaxText) {\n          this.pLegend.removeChild(this.legendMaxText);\n          this.legendMaxText.destroy();\n          this.legendMaxText = undefined;\n        }\n        return;\n      }\n\n      const padding = 6;\n      const [width] = this.dimensions;\n      const [left, top] = this.position;\n      const [, y] = this.categoryHeightScale.range();\n      const isRightAligned = this.options.legendAlign === 'right';\n      const isHighlighting = !!(\n        this.focusStyle === 'highlighting' &&\n        ((this.focusGene && this.getGene) ||\n          (this.focusRegion && this.getRegion))\n      );\n\n      this.pLegend.position.x = isRightAligned ? left + width : left;\n\n      const [minValue, maxValue] = this.options.importanceDomain || [1, 1000];\n\n      if (Math.abs(minValue - this.legendMin) > EPS) {\n        if (this.legendMinText) {\n          this.pLegend.removeChild(this.legendMinText);\n          this.legendMinText.destroy();\n        }\n        this.legendMinText = new PIXI.Text(toFixed(minValue, 3), {\n          fontSize: this.labelSize,\n          align: isRightAligned ? 'right' : 'left',\n          fill: 0x808080,\n        });\n        this.legendMinText.x = 0;\n        this.legendMinText.y = padding / 2;\n        this.legendMinText.anchor.x = isRightAligned ? 1 : 0;\n        this.pLegend.addChild(this.legendMinText);\n      }\n\n      if (Math.abs(maxValue - this.legendMax) > EPS) {\n        if (this.legendMaxText) {\n          this.pLegend.removeChild(this.legendMaxText);\n          this.legendMaxText.destroy();\n        }\n        this.legendMaxText = new PIXI.Text(toFixed(maxValue, 3), {\n          fontSize: this.labelSize,\n          align: isRightAligned ? 'right' : 'left',\n          fill: 0x808080,\n        });\n        this.legendMaxText.x = 0;\n        this.legendMaxText.y = padding / 2;\n        this.legendMaxText.anchor.x = isRightAligned ? 1 : 0;\n        this.pLegend.addChild(this.legendMaxText);\n      }\n\n      const legendRectWidth = 42;\n      const minTextWidth = this.legendMinText.getBounds().width;\n      const maxTextWidth = this.legendMaxText.getBounds().width;\n      const offset = isRightAligned\n        ? -(maxTextWidth + legendRectWidth + padding)\n        : minTextWidth + 2 * padding;\n\n      const rectHeight = 18 + (isHighlighting * padding) / 2;\n\n      this.pLegend.beginFill(0xffffff);\n      this.pLegend.lineStyle(1, 0xcccccc);\n      if (isRightAligned) {\n        this.legendMinText.x = offset - padding;\n        this.pLegend.drawRoundedRect(\n          -(legendRectWidth + minTextWidth + maxTextWidth + 3 * padding + 0.5),\n          0,\n          legendRectWidth + minTextWidth + maxTextWidth + 3 * padding,\n          rectHeight,\n          3\n        );\n      } else {\n        this.legendMaxText.x = offset + legendRectWidth + 2 * padding;\n        this.pLegend.drawRoundedRect(\n          0.5,\n          0,\n          legendRectWidth + minTextWidth + maxTextWidth + 3 * padding,\n          18 + (isHighlighting * padding) / 2,\n          3\n        );\n      }\n      this.pLegend.endFill();\n      this.pLegend.lineStyle(0);\n\n      for (let i = 0; i < 5; i++) {\n        const opacity = this.opacityScale(minValue + (i / 4) * maxValue);\n\n        this.pLegend.beginFill(this.markColor, opacity);\n        this.pLegend.drawRect(\n          i * 9 + offset,\n          padding / 2 + !isHighlighting * 3,\n          6,\n          6\n        );\n        this.pLegend.endFill();\n\n        if (isHighlighting) {\n          this.pLegend.beginFill(this.markColorHighlight, opacity);\n          this.pLegend.drawRect(i * 9 + offset, padding / 2 + 9, 6, 6);\n          this.pLegend.endFill();\n        }\n      }\n\n      if (isRightAligned) {\n        this.legendMinText.x = offset - padding;\n        this.legendMaxText.x = -padding / 2;\n      } else {\n        this.legendMinText.x = padding / 2;\n        this.legendMaxText.x = offset + legendRectWidth + padding;\n      }\n\n      this.pLegend.position.y = top + y - padding - rectHeight;\n    }\n\n    updateIndicators() {\n      this.renderIndicatorCategoryAxis();\n      this.renderIndicatorLegend();\n      this.renderIndicatorPoints();\n    }\n\n    updateLoadIndicator() {\n      const [left, top] = this.position;\n      this.pLoading.position.x = left + 6;\n      this.pLoading.position.y = top + 6;\n\n      if (this.fetching.size) {\n        this.pLoading.addChild(this.loadIndicator);\n      } else {\n        this.pLoading.removeChild(this.loadIndicator);\n      }\n    }\n\n    // Called whenever a new tile comes in\n    updateExistingGraphics() {\n      this.updateLoadIndicator();\n      if (!this.hasFetchedTiles()) return;\n      this.updateScales();\n      this.updateIndicators();\n    }\n\n    // Gets called on every draw call\n    drawTile(tile) {\n      tile.graphics.clear();\n\n      this.updateLoadIndicator();\n\n      if (!this.options.stratification.axisNoGroupColor) {\n        let yStart = 0;\n        let yEnd = 0;\n        this.groupSizes.forEach((size, i) => {\n          yEnd += this.categoryHeightScale(size);\n\n          tile.graphics.beginFill(this.groupToColor.get(i)[1]);\n          tile.graphics.drawRect(\n            0,\n            yStart,\n            this.dimensions[0],\n            Math.abs(yEnd - yStart)\n          );\n\n          yStart = yEnd;\n        });\n        tile.graphics.endFill();\n      }\n    }\n\n    getElementAtPosition(relX, relY) {\n      if (!this.tilesetInfo) return undefined;\n\n      const zoomLevel = this.calculateZoomLevel();\n      const tileWidth = tileProxy.calculateTileWidth(\n        this.tilesetInfo,\n        zoomLevel,\n        this.tilesetInfo.tile_size\n      );\n\n      // the position of the tile containing the query position\n      const tileId = this.tileToLocalId([\n        zoomLevel,\n        Math.floor(this._xScale.invert(relX) / tileWidth),\n      ]);\n      const fetchedTile = this.fetchedTiles[tileId];\n\n      if (!fetchedTile) return undefined;\n\n      const category = this.yToCategory.get(\n        Math.floor(this.categoryHeightScale.invert(relY))\n      );\n\n      const xAbsLo = this._xScale.invert(relX - 1);\n      const xAbsHi = this._xScale.invert(relX + 1);\n\n      let foundItem;\n      fetchedTile.intervalTree.queryInterval(xAbsLo, xAbsHi, (interval) => {\n        const item = fetchedTile.tileData[interval[2]];\n        if (this.getCategory(item) === category) {\n          foundItem = item;\n          return true;\n        }\n        return false;\n      });\n\n      return {\n        item: foundItem,\n        category,\n        tileId,\n      };\n    }\n\n    getMouseOverHtml(relX, relY) {\n      const element = this.getElementAtPosition(relX, relY);\n\n      if (!element) return '';\n\n      const { item, category } = element;\n\n      if (item) {\n        const [color, bg] = this.groupToColor.get(\n          this.categoryToGroup.get(category)\n        );\n        const colorHex = `#${color.toString(16)}`;\n        const bgHex = `#${bg.toString(16)}`;\n        const value = this.getImportance(item).toFixed(2);\n        return `<div style=\"margin: -0.25rem; padding: 0 0.25rem; background: ${bgHex}\"><strong style=\"color: ${colorHex};\">${category}:</strong> ${value}</div>`;\n      }\n\n      return '';\n    }\n\n    clickHandler(event) {\n      const [offsetX, offsetY] = this.position;\n      const relX = event.data.global.x - offsetX;\n      const relY = event.data.global.y - offsetY;\n\n      const element = this.getElementAtPosition(relX, relY);\n\n      if (element) {\n        this.pubSub.publish('app.click', {\n          type: 'annotation',\n          event,\n          payload: element,\n        });\n      }\n    }\n\n    setPosition(newPosition) {\n      super.setPosition(newPosition);\n\n      [this.pMain.position.x, this.pMain.position.y] = this.position;\n    }\n\n    zoomed(newXScale, newYScale) {\n      this.xScale(newXScale);\n      this.yScale(newYScale);\n\n      if (this.indicatorPointGraphics) {\n        scaleScalableGraphics(\n          this.indicatorPointGraphics,\n          newXScale,\n          this.drawnAtScale\n        );\n      }\n\n      this.refreshTiles();\n      this.draw();\n    }\n\n    refreshTiles() {\n      super.refreshTiles();\n      this.updateLoadIndicator();\n    }\n\n    renderIndicatorCategoryAxisAsSvg() {\n      const gAxis = document.createElement('g');\n      gAxis.setAttribute('id', 'axis');\n\n      const [width] = this.dimensions;\n      const [left, top] = this.position;\n\n      this.pAxis.position.x = this.axisAlign === 'right' ? left + width : left;\n      this.pAxis.position.y = top;\n\n      gAxis.setAttribute(\n        'transform',\n        `translate(${this.pAxis.position.x}, ${this.pAxis.position.y})`\n      );\n\n      let yStart = 0;\n      let yEnd = 0;\n\n      const xTickOffset = this.axisAlign === 'right' ? -5 : 5;\n      const xTickEnd = this.axisAlign === 'right' ? -width : width;\n      const xLabelOffset = this.axisAlign === 'right' ? -3 : 3;\n\n      const createRect = (x, y, w, h, f, o) => {\n        const r = document.createElement('rect');\n\n        r.setAttribute('x', x);\n        r.setAttribute('y', y);\n        r.setAttribute('width', w);\n        r.setAttribute('height', h);\n        r.setAttribute('fill', f);\n        r.setAttribute('fill-opacity', o);\n        r.setAttribute('stroke-width', 0);\n\n        return r;\n      };\n\n      const createText = (pixiText) => {\n        const t = document.createElement('text');\n\n        t.setAttribute('x', pixiText.x);\n        t.setAttribute('y', pixiText.y + pixiText.height / (4 / 1));\n        t.setAttribute('fill', pixiText._style._fill);\n        t.setAttribute(\n          'text-anchor',\n          pixiText._style._align === 'right' ? 'end' : 'start'\n        );\n        t.setAttribute('style', `font: ${pixiText._font};`);\n\n        t.textContent = pixiText.text;\n\n        return t;\n      };\n\n      const createLine = ({\n        stroke = '#000000',\n        strokeWidth = 1,\n        strokeDasharray = null,\n      } = {}) => (x1, y1, x2, y2) => {\n        const l = document.createElement('line');\n\n        l.setAttribute('x1', x1);\n        l.setAttribute('y1', y1);\n        l.setAttribute('x2', x2);\n        l.setAttribute('y2', y2);\n        l.setAttribute('stroke', stroke);\n        l.setAttribute('stroke-width', strokeWidth);\n\n        if (strokeDasharray)\n          l.setAttribute('stroke-dasharray', strokeDasharray);\n\n        return l;\n      };\n\n      const createDashedLine = createLine({ strokeDasharray: '5' });\n\n      const isHighlighting = this.options.focusStyle === 'highlighting';\n      const backgroundOpacity = 0.66;\n\n      this.groupLabelsPixiText.forEach((labelPixiText, i) => {\n        const height = this.categoryHeightScale(this.groupSizes[i]);\n        yEnd += height;\n        labelPixiText.x = xLabelOffset;\n        labelPixiText.y = yStart + height / 2;\n\n        // Background color\n        const backgroundColor = isHighlighting\n          ? '#ffffff'\n          : `#${this.groupToColor.get(i)[1].toString(16)}`;\n\n        if (this.axisAlign === 'right') {\n          gAxis.appendChild(\n            createRect(\n              labelPixiText.x - labelPixiText.width,\n              labelPixiText.y - labelPixiText.height / (4 / 1),\n              labelPixiText.width,\n              labelPixiText.height,\n              backgroundColor,\n              backgroundOpacity\n            )\n          );\n        } else {\n          gAxis.appendChild(\n            createRect(\n              labelPixiText.x,\n              labelPixiText.y - labelPixiText.height / (4 / 1),\n              labelPixiText.width,\n              labelPixiText.height,\n              backgroundColor,\n              backgroundOpacity\n            )\n          );\n        }\n\n        gAxis.appendChild(createText(labelPixiText));\n\n        gAxis.appendChild(createLine()(0, yStart, xTickOffset, yStart));\n\n        if (this.options.stratification.axisShowGroupSeparator) {\n          gAxis.appendChild(createDashedLine(0, yStart, xTickEnd, yStart));\n        }\n\n        yStart = yEnd;\n      });\n\n      gAxis.appendChild(createLine()(0, 0, 0, yEnd));\n\n      if (this.options.stratification.axisShowGroupSeparator) {\n        gAxis.appendChild(createDashedLine(0, yEnd, xTickEnd, yEnd));\n      }\n\n      return gAxis;\n    }\n\n    /**\n     * Export an SVG representation of this track\n     *\n     * @returns {Array} The two returned DOM nodes are both SVG\n     * elements [base,track]. Base is a parent which contains track as a\n     * child. Track is clipped with a clipping rectangle contained in base.\n     *\n     */\n    exportSVG() {\n      let track = null;\n      let base = null;\n\n      [base, track] = super.superSVG();\n\n      base.setAttribute('class', 'exported-stratified-bed-track');\n      const output = document.createElement('g');\n\n      track.appendChild(output);\n      output.setAttribute(\n        'transform',\n        `translate(${this.position[0]},${this.position[1]})`\n      );\n\n      const isHighlighting = !!(\n        this.focusStyle === 'highlighting' &&\n        ((this.focusGene && this.getGene) ||\n          (this.focusRegion && this.getRegion))\n      );\n\n      const points = this.getPoints(isHighlighting);\n      const color = isHighlighting\n        ? this.options.markColorDehighlight || '#999999'\n        : this.options.markColor || 'black';\n      const colorHighlight = this.options.markColorHighlight || 'red';\n\n      points.forEach(({ cX, y, widthHalf, opacity, highlight, height }, i) => {\n        const r = document.createElement('rect');\n\n        r.setAttribute('x', cX - widthHalf);\n        r.setAttribute('y', y);\n        r.setAttribute('width', widthHalf * 2);\n        r.setAttribute('height', height);\n        r.setAttribute('fill', highlight ? colorHighlight : color);\n        r.setAttribute('fill-opacity', opacity);\n        r.setAttribute('stroke-width', 0);\n\n        output.appendChild(r);\n      });\n\n      base.appendChild(this.renderIndicatorCategoryAxisAsSvg());\n\n      return [base, track];\n    }\n  }\n\n  return new StratifiedBedTrack(...args);\n};\n\nconst icon =\n  '<svg viewBox=\"0 0 16 16\" xmlns=\"http://www.w3.org/2000/svg\" fill-rule=\"evenodd\" clip-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"1.5\"><path d=\"M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268\" fill=\"none\" stroke=\"currentColor\"/><path d=\"M10.5 3.5v12\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-dasharray=\"1,2,0,0\"/><path d=\"M5.5 13.5V6\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-width=\".9969299999999999\" stroke-dasharray=\"1.71,3.43,0,0\"/><path d=\"M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z\" fill=\"currentColor\"/><path d=\"M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z\" fill=\"currentColor\"/></svg>';\n\ncreateStratifiedBedTrack.config = {\n  type: 'stratified-bed',\n  datatype: ['arcs', 'bedlike'],\n  orientation: '1d',\n  name: 'Arcs1D',\n  thumbnail: new DOMParser().parseFromString(icon, 'text/xml').documentElement,\n  availableOptions: [\n    'arcStyle',\n    'flip1D',\n    'labelPosition',\n    'labelColor',\n    'labelTextOpacity',\n    'labelBackgroundOpacity',\n    'trackBorderWidth',\n    'trackBorderColor',\n  ],\n  defaultOptions: {\n    arcStyle: 'ellipse',\n    flip1D: 'no',\n    labelColor: 'black',\n    labelPosition: 'hidden',\n    trackBorderWidth: 0,\n    trackBorderColor: 'black',\n  },\n  optionsInfo: {\n    arcStyle: {\n      name: 'Arc Style',\n      inlineOptions: {\n        circle: {\n          name: 'Circle',\n          value: 'circle',\n        },\n        ellipse: {\n          name: 'Ellipse',\n          value: 'ellipse',\n        },\n      },\n    },\n  },\n};\n\nexport default createStratifiedBedTrack;\n","const MAX_RADIUS = 2;\nconst MAX_RADIUS_EXTENSION = 2;\n\n// const VS = `\n//   attribute vec2 aPosition;\n\n//   uniform mat3 projectionMatrix;\n//   uniform mat3 translationMatrix;\n//   uniform float uPointSize;\n//   uniform vec4 uColor;\n\n//   varying vec4 vColor;\n\n//   void main(void)\n//   {\n//     vColor = uColor;\n//     gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n//     gl_PointSize = uPointSize;\n//   }\n// `;\n\n// const FS_ROUND = `\n//   #ifdef GL_OES_standard_derivatives\n//   #extension GL_OES_standard_derivatives : enable\n//   #endif\n\n//   precision mediump float;\n\n//   varying vec4 vColor;\n\n//   void main() {\n//     float r = 0.0, delta = 0.0, alpha = 1.0;\n//     vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n//     r = dot(cxy, cxy);\n\n//     #ifdef GL_OES_standard_derivatives\n//       delta = fwidth(r);\n//       alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n//     #endif\n\n//     gl_FragColor = vec4(vColor.rgb, alpha * vColor.a);\n//   }\n// `;\n\n// const FS_SQUARE = `\n//   precision mediump float;\n//   varying vec4 vColor;\n\n//   void main() {\n//     gl_FragColor = vec4(vColor.rgb, vColor.a);\n//   }\n// `;\n\n// const DEFAULT_GROUP_COLORS = [\n//   '#c17da5',\n//   '#c76526',\n//   '#dca237',\n//   '#eee462',\n//   '#469b76',\n//   '#3170ad',\n//   '#6fb2e4',\n//   '#000000',\n//   '#999999',\n// ];\n\n// const DEFAULT_GROUP_COLORS_DARK = [\n//   '#a1688a',\n//   '#a65420',\n//   '#b7872e',\n//   '#9f9841',\n//   '#3a8162',\n//   '#295d90',\n//   '#4a7798',\n//   '#000000',\n//   '#666666',\n// ];\n\n// const DEFAULT_GROUP_COLORS_LIGHT = [\n//   '#f5e9f0',\n//   '#f6e5db',\n//   '#f9f0de',\n//   '#fcfbe5',\n//   '#e0eee8',\n//   '#dde7f1',\n//   '#e7f2fb',\n//   '#d5d5d5',\n//   '#ffffff',\n// ];\n\n// const scaleScalableGraphics = (graphics, xScale, drawnAtScale) => {\n//   const tileK =\n//     (drawnAtScale.domain()[1] - drawnAtScale.domain()[0]) /\n//     (xScale.domain()[1] - xScale.domain()[0]);\n//   const newRange = xScale.domain().map(drawnAtScale);\n\n//   const posOffset = newRange[0];\n//   graphics.scale.x = tileK;\n//   graphics.position.x = -posOffset * tileK;\n// };\n\nconst createSnpTrack = function createSnpTrack(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  const { range } = HGC.libraries.d3Array;\n  const { scaleBand } = HGC.libraries.d3Scale;\n  const { tileProxy } = HGC.services;\n  const { colorToHex } = HGC.utils;\n\n  class SnpTrack extends HGC.tracks.BedLikeTrack {\n    setValueScale() {\n      this.valueScale = null;\n      if (this.options && this.options.valueColumn) {\n        const min = this.options.colorEncodingRange\n          ? +this.options.colorEncodingRange[0]\n          : this.minVisibleValueInTiles(+this.options.valueColumn);\n        const max = this.options.colorEncodingRange\n          ? +this.options.colorEncodingRange[1]\n          : this.maxVisibleValueInTiles(+this.options.valueColumn);\n\n        if (this.options.valueColumn) {\n          [this.valueScale] = this.makeValueScale(\n            min,\n            this.calculateMedianVisibleValue(+this.options.valueColumn),\n            max,\n            2\n          );\n        }\n      }\n    }\n\n    finalDotYPos(y, r) {\n      return Math.max(r, Math.min(this.dimensions[1] - r, y));\n    }\n\n    drawPoly(tile, xStartPos, xEndPos, rectY, doubleRadius = false) {\n      // prettier-ignore\n      const drawnPoly = [\n        // left top\n        xStartPos, rectY,\n        // right top\n        xEndPos, rectY,\n        // right bottom\n        xEndPos, this.dimensions[1],\n         // left bottom\n        xStartPos, this.dimensions[1]\n      ];\n\n      const anchorRadius = Math.max(MAX_RADIUS, xEndPos - xStartPos);\n      const radius = anchorRadius * (1 + MAX_RADIUS_EXTENSION * doubleRadius);\n\n      tile.rectGraphics.drawCircle(\n        xStartPos,\n        this.finalDotYPos(rectY, anchorRadius),\n        radius\n      );\n\n      return drawnPoly;\n    }\n\n    renderRows(tile, rows, maxRows, startY, endY, fill) {\n      const zoomLevel = +tile.tileId.split('.')[0];\n\n      this.initialize();\n\n      const rowScale = scaleBand()\n        .domain(range(maxRows))\n        .range([startY, endY])\n        .paddingInner(0);\n\n      const focusRegion = this.options.focusRegion || [Infinity, Infinity];\n\n      const circleDraws = [];\n      const circleFocusDraws = [];\n\n      for (let j = 0; j < rows.length; j++) {\n        for (let i = 0; i < rows[j].length; i++) {\n          const td = rows[j][i].value;\n          const geneInfo = td.fields;\n\n          // the returned positions are chromosome-based and they need to\n          // be converted to genome-based\n          const chrOffset = +td.chrOffset;\n          const txStart = +geneInfo[1] + chrOffset;\n          const txEnd = +geneInfo[2] + chrOffset;\n          let yMiddle = rowScale(j) + rowScale.step() / 2;\n\n          if (this.valueScale) {\n            yMiddle = this.valueScale(+geneInfo[+this.options.valueColumn - 1]);\n          }\n\n          const rectY = yMiddle;\n          const xStartPos = this._xScale(txStart);\n          const xEndPos = this._xScale(txEnd);\n\n          // don't draw anything that has already been drawn\n          if (\n            !(\n              zoomLevel in this.drawnRects &&\n              td.uid in this.drawnRects[zoomLevel]\n            )\n          ) {\n            if (!this.drawnRects[zoomLevel]) this.drawnRects[zoomLevel] = {};\n\n            const circleDraw = [xStartPos, xEndPos, rectY, td, txStart, txEnd];\n\n            if (txStart <= focusRegion[1] && txEnd >= focusRegion[0]) {\n              circleFocusDraws.push(circleDraw);\n            } else {\n              circleDraws.push(circleDraw);\n            }\n          }\n        }\n\n        // 1. draw white background to make clicking easier\n        tile.rectGraphics.lineStyle(0);\n        tile.rectGraphics.beginFill(0xffffff);\n        circleDraws.forEach((circleDraw) => {\n          this.drawPoly(\n            tile,\n            circleDraw[0],\n            circleDraw[1],\n            circleDraw[2],\n            true\n          );\n        });\n\n        // 2. Now draw the normal circles\n        let color = this.options.markColor || 'black';\n        let opacity = this.options.fillOpacity || 0.3;\n        tile.rectGraphics.lineStyle(1, colorToHex(color), opacity);\n        tile.rectGraphics.beginFill(colorToHex(color), opacity);\n        circleDraws.forEach((circleDraw) => {\n          const drawnPoly = this.drawPoly(\n            tile,\n            circleDraw[0],\n            circleDraw[1],\n            circleDraw[2]\n          );\n          this.drawnRects[zoomLevel][circleDraw[4].uid] = [\n            drawnPoly,\n            {\n              start: circleDraw[4],\n              end: circleDraw[5],\n              value: circleDraw[3],\n              tile,\n              fill,\n            },\n            tile.tileId,\n          ];\n        });\n\n        // 2. Now draw the focused circles\n        color = this.options.markColorFocus || 'red';\n        opacity = this.options.markOpacityFocus || 0.6;\n        tile.rectGraphics.lineStyle(1, colorToHex(color), opacity);\n        tile.rectGraphics.beginFill(colorToHex(color), opacity);\n        circleFocusDraws.forEach((circleDraw) => {\n          const drawnPoly = this.drawPoly(\n            tile,\n            circleDraw[0],\n            circleDraw[1],\n            circleDraw[2]\n          );\n          this.drawnRects[zoomLevel][circleDraw[4].uid] = [\n            drawnPoly,\n            {\n              start: circleDraw[4],\n              end: circleDraw[5],\n              value: circleDraw[3],\n              tile,\n              fill,\n            },\n            tile.tileId,\n          ];\n        });\n        tile.rectGraphics.endFill();\n      }\n\n      tile.rectGraphics.interactive = true;\n      tile.rectGraphics.buttonMode = true;\n      tile.rectGraphics.mouseup = (event) => {\n        if (this.hoveringSnp) {\n          this.pubSub.publish('app.click', {\n            type: 'snp',\n            event,\n            payload: this.hoveringSnp,\n          });\n        }\n      };\n\n      return [circleDraws, circleFocusDraws];\n    }\n\n    /**\n     * Shows value and type for each bar\n     *\n     * @param trackX relative x-coordinate of mouse\n     * @param trackY relative y-coordinate of mouse\n     * @returns string with embedded values and svg square for color\n     */\n    getMouseOverHtml(trackX, trackY) {\n      this.hoveringSnp = undefined;\n\n      if (!this.tilesetInfo || !this.options.toolTip || !this.valueScale)\n        return '';\n\n      const zoomLevel = this.calculateZoomLevel();\n      const tileWidth = tileProxy.calculateTileWidth(\n        this.tilesetInfo,\n        zoomLevel,\n        this.tilesetInfo.tile_size\n      );\n\n      // the position of the tile containing the query position\n      const genomePos = this._xScale.invert(trackX);\n      const relTilePos = genomePos / tileWidth;\n      const tilePos = Math.floor(relTilePos);\n      const tileId = this.tileToLocalId([zoomLevel, tilePos]);\n      const fetchedTile = this.fetchedTiles[tileId];\n\n      if (!fetchedTile) return '';\n\n      let minDist = 3;\n      fetchedTile.tileData.forEach((item) => {\n        const dist = Math.abs(this._xScale(item.xStart) - trackX);\n        if (dist < minDist) {\n          this.hoveringSnp = item;\n          minDist = dist;\n        }\n      });\n\n      if (!this.hoveringSnp) return '';\n\n      const itemY = this.finalDotYPos(\n        this.valueScale(this.hoveringSnp.importance),\n        2\n      );\n\n      if (\n        Math.abs(itemY - (trackY - 1)) >\n        MAX_RADIUS * (MAX_RADIUS_EXTENSION + 1)\n      )\n        return '';\n\n      const name = this.hoveringSnp.fields[this.options.toolTip.name.field];\n      const value = (+this.hoveringSnp.fields[\n        this.options.toolTip.value.field\n      ]).toFixed(this.options.toolTip.value.numDecimals || 2);\n      let otherStr = '';\n\n      if (this.options.toolTip.other) {\n        this.options.toolTip.other.forEach((other) => {\n          const label = other.label || '';\n          const v = (+this.hoveringSnp.fields[other.field]).toFixed(\n            other.numDecimals || 2\n          );\n          otherStr += `${label}: ${v};`;\n        });\n        otherStr = ` (${otherStr.substr(0, otherStr.length - 1)})`;\n      }\n\n      return `<div><strong>${name}:</strong> ${value}${otherStr}</div>`;\n    }\n\n    /**\n     * Export an SVG representation of this track\n     *\n     * @returns {Array} The two returned DOM nodes are both SVG\n     * elements [base,track]. Base is a parent which contains track as a\n     * child. Track is clipped with a clipping rectangle contained in base.\n     *\n     */\n    exportSVG() {\n      let track = null;\n      let base = null;\n\n      [base, track] = super.exportSVG();\n\n      base.setAttribute('class', 'exported-snp-track');\n      const output = document.createElement('g');\n\n      track.appendChild(output);\n      output.setAttribute(\n        'transform',\n        `translate(${this.position[0]},${this.position[1]})`\n      );\n\n      this.visibleAndFetchedTiles()\n        .filter((tile) => tile.plusStrandRows)\n        .forEach((tile) => {\n          // call drawTile with storePolyStr = true so that\n          // we record path strings to use in the SVG\n          const [circles, focusedCircles] = this.renderRows(\n            tile,\n            tile.plusStrandRows,\n            tile.plusStrandRows.length,\n            0,\n            this.dimensions[1],\n            'blue'\n          );\n\n          circles.forEach((circle) => {\n            const c = document.createElement('circle');\n            c.setAttribute('fill', this.options.markColor || 'black');\n            c.setAttribute('stroke-width', 0);\n            c.setAttribute('opacity', this.options.markOpacity || 0.33);\n            c.setAttribute('r', this.options.markSize);\n            c.setAttribute('cx', circle[0]);\n            c.setAttribute('cy', circle[2]);\n            output.appendChild(c);\n          });\n\n          focusedCircles.forEach((circle) => {\n            const c = document.createElement('circle');\n            c.setAttribute('fill', this.options.markColorFocus || 'red');\n            c.setAttribute('stroke-width', 0);\n            c.setAttribute('opacity', this.options.markOpacityFocus || 0.66);\n            c.setAttribute('r', this.options.markSize + 1);\n            c.setAttribute('cx', circle[0]);\n            c.setAttribute('cy', circle[2]);\n            output.appendChild(c);\n          });\n        });\n\n      const gAxis = document.createElement('g');\n      gAxis.setAttribute('id', 'axis');\n\n      // append the axis to base so that it's not clipped\n      base.appendChild(gAxis);\n      gAxis.setAttribute(\n        'transform',\n        `translate(${this.axis.pAxis.position.x}, ${this.axis.pAxis.position.y})`\n      );\n\n      if (\n        this.options.axisPositionHorizontal === 'left' ||\n        this.options.axisPositionVertical === 'top'\n      ) {\n        const gDrawnAxis = this.axis.exportAxisLeftSVG(\n          this.valueScale,\n          this.dimensions[1]\n        );\n        gAxis.appendChild(gDrawnAxis);\n      } else if (\n        this.options.axisPositionHorizontal === 'right' ||\n        this.options.axisPositionVertical === 'bottom'\n      ) {\n        const gDrawnAxis = this.axis.exportAxisRightSVG(\n          this.valueScale,\n          this.dimensions[1]\n        );\n        gAxis.appendChild(gDrawnAxis);\n      }\n\n      return [base, track];\n    }\n  }\n\n  return new SnpTrack(...args);\n};\n\nconst icon =\n  '<svg viewBox=\"0 0 16 16\" xmlns=\"http://www.w3.org/2000/svg\" fill-rule=\"evenodd\" clip-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"1.5\"><path d=\"M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268\" fill=\"none\" stroke=\"currentColor\"/><path d=\"M10.5 3.5v12\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-dasharray=\"1,2,0,0\"/><path d=\"M5.5 13.5V6\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-width=\".9969299999999999\" stroke-dasharray=\"1.71,3.43,0,0\"/><path d=\"M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z\" fill=\"currentColor\"/><path d=\"M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z\" fill=\"currentColor\"/></svg>';\n\ncreateSnpTrack.config = {\n  type: 'point-annotation',\n  datatype: ['arcs', 'bedlike'],\n  orientation: '1d',\n  name: 'Arcs1D',\n  thumbnail: new DOMParser().parseFromString(icon, 'text/xml').documentElement,\n  availableOptions: [\n    'arcStyle',\n    'flip1D',\n    'labelPosition',\n    'labelColor',\n    'labelTextOpacity',\n    'labelBackgroundOpacity',\n    'strokeColor',\n    'strokeWidth',\n    'trackBorderWidth',\n    'trackBorderColor',\n  ],\n  defaultOptions: {\n    arcStyle: 'ellipse',\n    flip1D: 'no',\n    labelColor: 'black',\n    labelPosition: 'hidden',\n    strokeColor: 'black',\n    strokeWidth: 1,\n    trackBorderWidth: 0,\n    trackBorderColor: 'black',\n  },\n  optionsInfo: {\n    arcStyle: {\n      name: 'Arc Style',\n      inlineOptions: {\n        circle: {\n          name: 'Circle',\n          value: 'circle',\n        },\n        ellipse: {\n          name: 'Ellipse',\n          value: 'ellipse',\n        },\n      },\n    },\n  },\n};\n\nexport default createSnpTrack;\n","import {\n  DEFAULT_COLOR_MAP,\n  DEFAULT_COLOR_MAP_DARK,\n  DEFAULT_COLOR_MAP_LIGHT,\n} from './constants';\nimport { createColorTexture } from './utils';\n\nconst DEFAULT_TILE_SIZE = 1024;\n\nconst DEFAULT_BIN_SIZE = 8; // 8 \"tile-pixels\" make up one bin by default\n\nconst VS = `\nprecision mediump float;\nattribute vec2 aPosition;\nattribute float aColorIdx;\nattribute float aFocused;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform sampler2D uColorMapTex;\nuniform float uColorMapTexRes;\nuniform sampler2D uColorMapFocusTex;\nuniform float uColorMapFocusTexRes;\n\nvarying vec4 vColor;\nvarying vec4 vColorFocused;\nvarying float vFocused;\n\nvoid main(void)\n{\n  // Half a texel (i.e., pixel in texture coordinates)\n  float eps = 0.5 / uColorMapTexRes;\n  float colorRowIndex = floor((aColorIdx + eps) / uColorMapTexRes);\n  vec2 colorTexIndex = vec2(\n    (aColorIdx / uColorMapTexRes) - colorRowIndex + eps,\n    (colorRowIndex / uColorMapTexRes) + eps\n  );\n  vColor = texture2D(uColorMapTex, colorTexIndex);\n\n  float eps2 = 0.5 / uColorMapFocusTexRes;\n  float colorRowIndex2 = floor((aColorIdx + eps2) / uColorMapFocusTexRes);\n  vec2 colorTexIndex2 = vec2(\n    (aColorIdx / uColorMapFocusTexRes) - colorRowIndex2 + eps2,\n    (colorRowIndex2 / uColorMapFocusTexRes) + eps2\n  );\n  vColorFocused = texture2D(uColorMapFocusTex, colorTexIndex2);\n\n  vFocused = aFocused;\n\n  gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n}\n`;\n\nconst FS = `\n  precision mediump float;\n\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vFocused;\n\n  void main() {\n    float isNotFocused = 1.0 - vFocused;\n\n    float r = vColor.r * isNotFocused + vColorFocused.r * vFocused;\n    float g = vColor.g * isNotFocused + vColorFocused.g * vFocused;\n    float b = vColor.b * isNotFocused + vColorFocused.b * vFocused;\n\n    gl_FragColor = vec4(r, g, b, 1.0);\n  }\n`;\n\nconst getIs2d = (tile) =>\n  tile.tileData.length && tile.tileData[0].yStart !== undefined;\n\nconst get1dStart = (item) => item.xStart;\n\nconst get2dStart = (item) => item.xStart + (item.xEnd - item.xStart) / 2;\n\nconst get1dEnd = (item) => item.xEnd;\n\nconst get2dEnd = (item) => item.yStart + (item.yEnd - item.yStart) / 2;\n\nconst getHistMax = (fetchedTiles) =>\n  fetchedTiles.reduce(\n    (histMax, tile) => Math.max(histMax, tile.histogramMax),\n    0\n  );\n\nconst scaleScalableGraphics = (graphics, xScale, drawnAtScale) => {\n  const tileK =\n    (drawnAtScale.domain()[1] - drawnAtScale.domain()[0]) /\n    (xScale.domain()[1] - xScale.domain()[0]);\n  const newRange = xScale.domain().map(drawnAtScale);\n\n  const posOffset = newRange[0];\n  graphics.scale.x = tileK;\n  graphics.position.x = -posOffset * tileK;\n};\n\n// prettier-ignore\nconst segmentToPosition = (segment) => [\n  segment.xStart, segment.yStart,\n  segment.xEnd, segment.yStart,\n  segment.xEnd, segment.yEnd,\n  segment.xStart, segment.yStart,\n  segment.xStart, segment.yEnd,\n  segment.xEnd, segment.yEnd,\n];\n\nconst segmentToColorIdx = (segment) => [\n  segment.colorIdx,\n  segment.colorIdx,\n  segment.colorIdx,\n  segment.colorIdx,\n  segment.colorIdx,\n  segment.colorIdx,\n];\n\nconst segmentToFocused = (segment) => [\n  segment.focused,\n  segment.focused,\n  segment.focused,\n  segment.focused,\n  segment.focused,\n  segment.focused,\n];\n\nconst createStackedBarTrack = function createStackedBarTrack(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  const { PIXI } = HGC.libraries;\n  const { scaleLinear, scaleLog } = HGC.libraries.d3Scale;\n  const { tileProxy } = HGC.services;\n  const { colorToHex } = HGC.utils;\n\n  const opacityLogScale = scaleLog()\n    .domain([1, 10])\n    .range([0.1, 1])\n    .clamp(true);\n\n  const toRgbNorm = (color) =>\n    HGC.utils\n      .colorToRgba(color)\n      .slice(0, 3)\n      .map((x) => Math.min(1, Math.max(0, x / 255)));\n\n  class StackedBarTrack extends HGC.tracks.HorizontalLine1DPixiTrack {\n    constructor(context, options) {\n      super(context, options);\n\n      this.updateOptions();\n\n      this.pLoading = new PIXI.Graphics();\n      this.pLoading.position.x = 0;\n      this.pLoading.position.y = 0;\n      this.pMasked.addChild(this.pLoading);\n\n      this.loadIndicator = new PIXI.Text('Loading data...', {\n        fontSize: this.labelSize || 10,\n        fill: 0x808080,\n      });\n      this.pLoading.addChild(this.loadIndicator);\n    }\n\n    initTile(tile) {\n      const is2d = getIs2d(tile);\n      const getStart = is2d ? get2dStart : get1dStart;\n      const getEnd = is2d ? get2dEnd : get1dEnd;\n\n      tile.tileData.forEach((item) => {\n        item.start = getStart(item);\n        item.end = getEnd(item);\n        item.isLeftToRight = item.start < item.end;\n      });\n\n      tile.histogramMax = 0;\n\n      this.updateTileFocusMap(tile);\n    }\n\n    updateTileHistogram(tile) {\n      const { tileX, tileWidth } = this.getTilePosAndDimensions(\n        tile.tileData.zoomLevel,\n        tile.tileData.tilePos\n      );\n      const binSize = tileWidth / this.numBins;\n\n      tile.binXPos = new Float32Array(this.numBins + 1);\n      tile.histogram1d = new Float32Array(this.numBins);\n      tile.histogram2d = new Float32Array(this.numBins * this.numGroups);\n      tile.histogram2dNumPred = new Uint8Array(this.numBins * this.numGroups);\n\n      let max = 0;\n\n      // Determine bin boundaries\n      for (let i = 0; i <= this.numBins; i++) {\n        tile.binXPos[i] = tileX + binSize * i;\n      }\n\n      const categoryBinHash = new Map();\n      const maxBinId = this.numBins - 1;\n\n      tile.tileData.filter(this.itemFilter).forEach((item) => {\n        const group = this.categoryToGroup.get(\n          item.fields[this.categoryField].toLowerCase()\n        );\n        const binStart = Math.max(\n          0,\n          Math.min(\n            maxBinId,\n            Math.round((this.getStart(item) - tileX) / binSize)\n          )\n        );\n        const binEnd = Math.max(\n          0,\n          Math.min(maxBinId, Math.round((this.getEnd(item) - tileX) / binSize))\n        );\n        const numBins = Math.abs(binEnd - binStart);\n        const score = this.getImportance(item);\n        const category = this.getCategory(item);\n        const base = group * this.numBins;\n\n        for (let i = 0; i <= numBins; i++) {\n          const bin = binStart + i;\n          const histIdx = base + bin;\n\n          const binHash = categoryBinHash.get(category) || {};\n\n          // Make sure we count multiple enhancer predictions of the same\n          // biosample and bin only once (i.e., summing up)\n          if (!binHash[bin]) {\n            binHash[bin] = binHash[bin] || score > 0;\n            tile.histogram2dNumPred[histIdx] += binHash[bin];\n            categoryBinHash.set(category, binHash);\n          }\n\n          tile.histogram2d[histIdx] += score;\n          tile.histogram1d[bin] += score;\n\n          max = Math.max(max, tile.histogram1d[bin]);\n        }\n      });\n\n      tile.histogramMax = max;\n    }\n\n    updateHistograms() {\n      Object.values(this.fetchedTiles).forEach(\n        this.updateTileHistogram.bind(this)\n      );\n    }\n\n    updateTileFocusMap(tile) {\n      tile.focusMap = new Float32Array(this.numBins);\n\n      const { tileX, tileWidth } = this.getTilePosAndDimensions(\n        tile.tileData.zoomLevel,\n        tile.tileData.tilePos\n      );\n\n      if (\n        tileX <= this.focusRegion[1] &&\n        tileX + tileWidth >= this.focusRegion[0]\n      ) {\n        const binSize = tileWidth / this.numBins;\n\n        const binStart = Math.max(\n          0,\n          Math.round((this.focusRegion[0] - tileX) / binSize)\n        );\n        const binEnd = Math.min(\n          this.numBins - 1,\n          Math.round((this.focusRegion[1] - tileX) / binSize)\n        );\n        const numBins = Math.abs(binEnd - binStart);\n\n        for (let i = 0; i <= numBins; i++) {\n          tile.focusMap[i] = 1;\n        }\n      }\n    }\n\n    updateFocusMap() {\n      Object.values(this.fetchedTiles).forEach(\n        this.updateTileFocusMap.bind(this)\n      );\n    }\n\n    updateStratificationOption() {\n      if (!this.options.stratification) {\n        this.categoryField = undefined;\n        this.categoryToGroup = undefined;\n        this.groupToColor = undefined;\n        this.numGroups = 0;\n        this.numFilteredGroups = 0;\n        this.numCategories = 0;\n        this.groupLabels = [];\n        return;\n      }\n\n      this.categoryField = this.options.stratification.categoryField;\n      this.getCategory = (item) =>\n        item.fields[this.categoryField].toLowerCase();\n      this.categoryToGroup = new Map();\n      this.categoryToY = new Map();\n      this.groupToColor = new Map();\n\n      this.groupSizes = this.options.stratification.groups.map(\n        (group) =>\n          group.categories.filter((category) => this.valueFilter(category))\n            .length\n      );\n      this.filteredGroups = this.options.stratification.groups.filter(\n        (group, i) => this.groupSizes[i] > 0\n      );\n      this.numGroups = this.options.stratification.groups.length;\n      this.numFilteredGroups = this.filteredGroups.length;\n      this.numCategories = this.groupSizes.reduce(\n        (numCategories, groupSize) => numCategories + groupSize,\n        0\n      );\n      this.groupLabels = this.options.stratification.groups.map(\n        (group, i) => group.label || `Group ${i}`\n      );\n\n      let k = 0;\n      this.options.stratification.groups.forEach((group, i) => {\n        this.groupToColor.set(i, [\n          colorToHex(\n            group.color || DEFAULT_COLOR_MAP[i % DEFAULT_COLOR_MAP.length]\n          ),\n          colorToHex(\n            group.backgroundColor ||\n              DEFAULT_COLOR_MAP_LIGHT[i % DEFAULT_COLOR_MAP_LIGHT.length]\n          ),\n        ]);\n        group.categories\n          .filter((category) => this.valueFilter(category))\n          .forEach((category, j) => {\n            this.categoryToGroup.set(category.toLowerCase(), i);\n            this.categoryToY.set(category.toLowerCase(), k + j);\n          });\n        k += this.groupSizes[i];\n      });\n\n      this.groupLabelsPixiText = this.groupLabels.map(\n        (label, i) =>\n          new PIXI.Text(label, {\n            fontSize: this.labelSize,\n            // fill: this.labelColor,\n            align: this.axisAlign === 'right' ? 'right' : 'left',\n            fill: colorToHex(\n              this.options.stratification.groups[i].axisLabelColor ||\n                DEFAULT_COLOR_MAP_DARK[i % DEFAULT_COLOR_MAP_DARK.length]\n            ),\n          })\n      );\n    }\n\n    updateOptions() {\n      this.axisAlign = this.options.axisAlign || 'left';\n\n      this.labelColor = colorToHex(this.options.labelColor || 'black');\n\n      this.labelSize = this.options.labelSize || 12;\n\n      this.colorMap = this.options.colorMap || [...DEFAULT_COLOR_MAP];\n\n      this.colorMapRgbNorm = this.colorMap.map(toRgbNorm);\n\n      [this.colorMapTex, this.colorMapTexRes] = createColorTexture(\n        PIXI,\n        this.colorMapRgbNorm\n      );\n\n      this.colorMapFocus = this.options.colorMapFocus || [\n        ...DEFAULT_COLOR_MAP_DARK,\n      ];\n\n      this.colorMapFocusRgbNorm = this.colorMapFocus.map(toRgbNorm);\n\n      [this.colorMapFocusTex, this.colorMapFocusTexRes] = createColorTexture(\n        PIXI,\n        this.colorMapFocusRgbNorm\n      );\n\n      this.markColor = colorToHex(this.options.markColor || 'black');\n\n      this.markColorRgbNorm = this.options.markColor\n        ? toRgbNorm(this.options.markColor)\n        : [0, 0, 0];\n\n      this.markOpacity = Number.isNaN(+this.options.markOpacity)\n        ? 1\n        : Math.min(1, Math.max(0, +this.options.markOpacity));\n\n      this.markSize = this.options.markSize || 2;\n\n      this.markColorFocus = colorToHex(this.options.markColorFocus || 'red');\n\n      this.markColorFocusRgbNorm = this.options.markColorFocus\n        ? toRgbNorm(this.options.markColorFocus)\n        : [1, 0, 0];\n\n      this.markOpacityFocus = Number.isNaN(+this.options.markOpacityFocus)\n        ? this.markOpacity\n        : Math.min(1, Math.max(0, +this.options.markOpacityFocus));\n\n      this.markSizeFocus = this.options.markSizeFocus || this.markSize;\n\n      this.binSize = this.options.binSize || DEFAULT_BIN_SIZE;\n\n      this.numBins = this.tilesetInfo\n        ? Math.round(this.tilesetInfo.tile_size / this.binSize)\n        : DEFAULT_TILE_SIZE / this.binSize;\n\n      this.getOffset = this.options.offsetField\n        ? (item) => this.chromOffsets[item.fields[this.options.offsetField]]\n        : () => 0;\n\n      this.getStart = this.options.startField\n        ? (item) => this.getOffset(item) + +item.fields[this.options.startField]\n        : (item) => item.xStart;\n\n      this.getEnd = this.options.endField\n        ? (item) => this.getOffset(item) + +item.fields[this.options.endField]\n        : (item) => item.xEnd;\n\n      this.getImportance = this.options.importanceField\n        ? (item) => +item.fields[this.options.importanceField]\n        : () => 1;\n\n      const importanceDomain = this.options.importanceDomain || [1000, 1];\n\n      this.filterSet =\n        this.options.filter && this.options.filter.set\n          ? this.options.filter.set.reduce((s, include) => {\n              s.add(include);\n              return s;\n            }, new Set())\n          : null;\n\n      this.filterField = this.options.filter && this.options.filter.field;\n\n      this.valueFilter = this.filterSet\n        ? (value) => this.filterSet.has(value)\n        : () => true;\n\n      this.itemFilter =\n        this.valueFilter && this.filterField\n          ? (item) => this.valueFilter(item.fields[this.filterField])\n          : () => true;\n\n      const opacityLinearScale = scaleLinear()\n        .domain(importanceDomain)\n        .range([1, 10]);\n\n      this.opacityScale = (x) => opacityLogScale(opacityLinearScale(x));\n\n      this.focusRegion = this.options.focusRegion\n        ? this.options.focusRegion\n        : [Infinity, Infinity];\n\n      this.focusGene = this.options.focusGene\n        ? this.options.focusGene.toLowerCase()\n        : undefined;\n\n      this.minImportance = this.options.minImportance || 0;\n\n      this.updateStratificationOption();\n\n      this.updateFocusMap();\n      this.updateHistograms();\n      this.updateScales();\n    }\n\n    updateLoadIndicator() {\n      const [left, top] = this.position;\n      this.pLoading.position.x = left + 6;\n      this.pLoading.position.y = top + 6;\n\n      if (this.fetching.size) {\n        this.pLoading.addChild(this.loadIndicator);\n      } else {\n        this.pLoading.removeChild(this.loadIndicator);\n      }\n    }\n\n    computeChromOffets() {\n      if (!this.tilesetInfo) return;\n      const chroms = this.tilesetInfo.chrom_names.split('\\t');\n      const chromSizes = this.tilesetInfo.chrom_sizes\n        .split('\\t')\n        .map((size) => +size);\n      // eslint-disable-next-line prefer-destructuring\n      this.chromOffsets = chroms.reduce(\n        ([offsets, cumSum], chrom, i) => {\n          offsets[chrom] = cumSum;\n          return [offsets, cumSum + chromSizes[i]];\n        },\n        [{}, 0]\n      )[0];\n    }\n\n    refreshTiles(...brgs) {\n      super.refreshTiles(...brgs);\n      this.computeChromOffets();\n      this.updateLoadIndicator();\n      if (this.tilesetInfo) {\n        const oldNumBins = this.numBins;\n        this.numBins = Math.round(this.tilesetInfo.tile_size / this.binSize);\n        if (oldNumBins !== this.numBins) {\n          this.updateHistograms();\n          this.updateScales();\n        }\n      }\n    }\n\n    rerender(newOptions) {\n      this.options = newOptions;\n      this.updateOptions();\n      this.updateExistingGraphics();\n    }\n\n    updateScales() {\n      const fetchedTiles = Object.values(this.fetchedTiles);\n\n      if (!fetchedTiles.length) return;\n\n      const [, height] = this.dimensions;\n\n      this.histMax = getHistMax(fetchedTiles);\n\n      this.heightScale = scaleLinear()\n        .domain([0, this.histMax])\n        .range([height, 0]);\n\n      this.valueScale = this.heightScale;\n\n      this.valueScaleInverted = scaleLinear()\n        .domain([0, this.histMax])\n        .range([0, height]);\n    }\n\n    itemToPoint(item) {\n      return {\n        xStart: this._xScale(item.start),\n        xEnd: this._xScale(item.start),\n        yStart: this.heightScale(\n          this.categoryToY.get(item.fields[this.categoryField].toLowerCase())\n        ),\n        yEnd: () => {},\n        opacity: this.opacityScale(this.getImportance(item)),\n        focused:\n          item.xStart <= this.focusRegion[1] &&\n          item.xEnd >= this.focusRegion[0],\n      };\n    }\n\n    histToSegments(tile) {\n      const segments = [];\n\n      for (let i = 0; i < this.numBins; i++) {\n        let cumHeight = 0;\n        if (tile.histogram1d[i] > 0) {\n          for (let j = 0; j < this.numGroups; j++) {\n            const height = tile.histogram2d[j * this.numBins + i];\n\n            if (height) {\n              segments.push({\n                xStart: this._xScale(tile.binXPos[i]),\n                xEnd: this._xScale(tile.binXPos[i + 1]),\n                yStart: this.heightScale(cumHeight),\n                yEnd: this.heightScale(cumHeight + height),\n                colorIdx: j % this.colorMap.length,\n                focused: tile.focusMap[i],\n              });\n\n              cumHeight += height;\n            }\n          }\n        }\n      }\n\n      return segments;\n    }\n\n    renderStackedBars() {\n      this.drawnAtScale = scaleLinear()\n        .domain([...this.xScale().domain()])\n        .range([...this.xScale().range()]);\n\n      const segments = Object.values(this.fetchedTiles).flatMap(\n        this.histToSegments.bind(this)\n      );\n\n      const positions = new Float32Array(segments.flatMap(segmentToPosition));\n      const colorIdxs = new Float32Array(segments.flatMap(segmentToColorIdx));\n      const focused = new Float32Array(segments.flatMap(segmentToFocused));\n\n      const uniforms = new PIXI.UniformGroup({\n        uColorMapTex: this.colorMapTex,\n        uColorMapTexRes: this.colorMapTexRes,\n        uColorMapFocus: this.colorMapFocusTex,\n        uColorMapFocusTexRes: this.colorMapFocusTexRes,\n      });\n\n      const shader = PIXI.Shader.from(VS, FS, uniforms);\n\n      const geometry = new PIXI.Geometry();\n      geometry.addAttribute('aPosition', positions, 2);\n      geometry.addAttribute('aColorIdx', colorIdxs, 1);\n      geometry.addAttribute('aFocused', focused, 1);\n\n      const mesh = new PIXI.Mesh(\n        geometry,\n        shader,\n        new PIXI.State(),\n        PIXI.DRAW_MODES.TRIANGLES\n      );\n\n      const newGraphics = new PIXI.Graphics();\n      newGraphics.addChild(mesh);\n\n      // eslint-disable-next-line\n      this.pMain.x = this.position[0];\n\n      if (this.indicatorPointGraphics) {\n        this.pMain.removeChild(this.indicatorPointGraphics);\n      }\n\n      this.pMain.addChild(newGraphics);\n      this.indicatorPointGraphics = newGraphics;\n\n      scaleScalableGraphics(\n        this.indicatorPointGraphics,\n        this._xScale,\n        this.drawnAtScale\n      );\n\n      this.draw();\n      this.animate();\n    }\n\n    renderTrack() {\n      this.drawAxis(this.valueScaleInverted);\n      this.renderStackedBars();\n    }\n\n    hasFetchedTiles() {\n      return Object.values(this.fetchedTiles).length;\n    }\n\n    // Called whenever a new tile comes in\n    updateExistingGraphics() {\n      this.updateLoadIndicator();\n      if (!this.hasFetchedTiles()) return;\n      this.updateHistograms();\n      this.updateScales();\n      this.renderTrack();\n    }\n\n    /**\n     * Shows value and type for each bar\n     *\n     * @param trackX relative x-coordinate of mouse\n     * @param trackY relative y-coordinate of mouse\n     * @returns string with embedded values and svg square for color\n     */\n    getMouseOverHtml(trackX, trackY) {\n      if (!this.tilesetInfo) return '';\n\n      const zoomLevel = this.calculateZoomLevel();\n      const tileWidth = tileProxy.calculateTileWidth(\n        this.tilesetInfo,\n        zoomLevel,\n        this.tilesetInfo.tile_size\n      );\n\n      // the position of the tile containing the query position\n      const relTilePos = this._xScale.invert(trackX) / tileWidth;\n      const tilePos = Math.floor(relTilePos);\n      const tileId = this.tileToLocalId([zoomLevel, tilePos]);\n      const fetchedTile = this.fetchedTiles[tileId];\n\n      if (!fetchedTile) return '';\n\n      const relPos = relTilePos - tilePos;\n      const binXPos = Math.floor(this.numBins * relPos);\n\n      const rowCumSum = [];\n      const rowNumPred = [];\n      let totalPred = 0;\n      let sum = 0;\n      for (let i = 0; i < this.numGroups; i++) {\n        sum += fetchedTile.histogram2d[i * this.numBins + binXPos];\n        const numPred =\n          fetchedTile.histogram2dNumPred[i * this.numBins + binXPos];\n        rowNumPred.push(numPred);\n        totalPred += numPred;\n        rowCumSum.push(sum);\n      }\n\n      const relYPos = this.heightScale.invert(trackY);\n      const group = rowCumSum.findIndex((cumHeight) => cumHeight > relYPos);\n\n      if (group >= 0) {\n        const [color, bg] = this.groupToColor.get(group);\n        const colorHex = `#${color.toString(16)}`;\n        const bgHex = `#${bg.toString(16)}`;\n        const value =\n          fetchedTile.histogram2dNumPred[group * this.numBins + binXPos];\n        return `<div style=\"margin: -0.25rem; padding: 0 0.25rem; background: ${bgHex}\"><strong style=\"color: ${colorHex};\">${this.groupLabels[group]}:</strong> ${value} of ${totalPred} samples</div>`;\n      }\n\n      return '';\n    }\n\n    setPosition(newPosition) {\n      super.setPosition(newPosition);\n\n      [this.pMain.position.x, this.pMain.position.y] = this.position;\n    }\n\n    zoomed(newXScale, newYScale) {\n      this.xScale(newXScale);\n      this.yScale(newYScale);\n\n      if (this.indicatorPointGraphics) {\n        scaleScalableGraphics(\n          this.indicatorPointGraphics,\n          newXScale,\n          this.drawnAtScale\n        );\n      }\n\n      this.refreshTiles();\n      this.draw();\n    }\n\n    /**\n     * Export an SVG representation of this track\n     *\n     * @returns {Array} The two returned DOM nodes are both SVG\n     * elements [base,track]. Base is a parent which contains track as a\n     * child. Track is clipped with a clipping rectangle contained in base.\n     *\n     */\n    exportSVG() {\n      let track = null;\n      let base = null;\n\n      [base, track] = super.superSVG();\n\n      base.setAttribute('class', 'exported-stacked-bar-track');\n      const output = document.createElement('g');\n\n      track.appendChild(output);\n      output.setAttribute(\n        'transform',\n        `translate(${this.position[0]},${this.position[1]})`\n      );\n\n      const segments = Object.values(this.fetchedTiles).flatMap(\n        this.histToSegments.bind(this)\n      );\n\n      segments.forEach(({ xStart, xEnd, yStart, yEnd, colorIdx }) => {\n        const r = document.createElement('rect');\n\n        r.setAttribute('x', xEnd);\n        r.setAttribute('y', yEnd);\n        r.setAttribute('width', Math.abs(xEnd - xStart));\n        r.setAttribute('height', Math.abs(yEnd - yStart));\n        r.setAttribute('fill', this.colorMap[colorIdx]);\n        r.setAttribute('stroke-width', 0);\n\n        output.appendChild(r);\n      });\n\n      const gAxis = document.createElement('g');\n      gAxis.setAttribute('id', 'axis');\n\n      // append the axis to base so that it's not clipped\n      base.appendChild(gAxis);\n      gAxis.setAttribute(\n        'transform',\n        `translate(${this.axis.pAxis.position.x}, ${this.axis.pAxis.position.y})`\n      );\n\n      if (\n        this.options.axisPositionHorizontal === 'left' ||\n        this.options.axisPositionVertical === 'top'\n      ) {\n        const gDrawnAxis = this.axis.exportAxisLeftSVG(\n          this.valueScale,\n          this.dimensions[1]\n        );\n        gAxis.appendChild(gDrawnAxis);\n      } else if (\n        this.options.axisPositionHorizontal === 'right' ||\n        this.options.axisPositionVertical === 'bottom'\n      ) {\n        const gDrawnAxis = this.axis.exportAxisRightSVG(\n          this.valueScale,\n          this.dimensions[1]\n        );\n        gAxis.appendChild(gDrawnAxis);\n      }\n\n      return [base, track];\n    }\n  }\n\n  return new StackedBarTrack(...args);\n};\n\nconst icon =\n  '<svg viewBox=\"0 0 16 16\" xmlns=\"http://www.w3.org/2000/svg\" fill-rule=\"evenodd\" clip-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"1.5\"><path d=\"M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268\" fill=\"none\" stroke=\"currentColor\"/><path d=\"M10.5 3.5v12\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-dasharray=\"1,2,0,0\"/><path d=\"M5.5 13.5V6\" fill=\"none\" stroke=\"currentColor\" stroke-opacity=\".33\" stroke-width=\".9969299999999999\" stroke-dasharray=\"1.71,3.43,0,0\"/><path d=\"M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z\" fill=\"currentColor\"/><path d=\"M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z\" fill=\"currentColor\"/></svg>';\n\ncreateStackedBarTrack.config = {\n  type: 'stacked-bar',\n  datatype: ['bedlike'],\n  orientation: '1d',\n  name: 'Advanced Stacked Bars Track',\n  thumbnail: new DOMParser().parseFromString(icon, 'text/xml').documentElement,\n  availableOptions: [\n    'flip1D',\n    'labelPosition',\n    'labelColor',\n    'labelTextOpacity',\n    'labelBackgroundOpacity',\n    'strokeColor',\n    'strokeWidth',\n    'trackBorderWidth',\n    'trackBorderColor',\n  ],\n  defaultOptions: {\n    flip1D: 'no',\n    labelColor: 'black',\n    labelPosition: 'hidden',\n    strokeColor: 'black',\n    strokeWidth: 1,\n    trackBorderWidth: 0,\n    trackBorderColor: 'black',\n  },\n};\n\nexport default createStackedBarTrack;\n","import createPubSub from 'pub-sub-es';\n\nfunction createTssTrack(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  class TssTrack extends HGC.tracks.BedLikeTrack {\n    constructor(context, options) {\n      super(context, options);\n\n      const { publish, subscribe, unsubscribe } = createPubSub();\n      this.publish = publish;\n      this.subscribe = subscribe;\n      this.unsubscribe = unsubscribe;\n    }\n\n    drawPoly(tile, xStartPos, xEndPos, rectY, doubleRadius = false) {\n      // prettier-ignore\n      const drawnPoly = [\n        // left top\n        xStartPos, rectY,\n        // right top\n        xEndPos, rectY,\n        // right bottom\n        xEndPos, this.dimensions[1],\n         // left bottom\n        xStartPos, this.dimensions[1]\n      ];\n\n      const anchorRadius = 1;\n      const radius = 2;\n\n      tile.rectGraphics.drawCircle(\n        xStartPos,\n        this.finalDotYPos(rectY, anchorRadius),\n        radius\n      );\n\n      return drawnPoly;\n    }\n\n    renderRows(tile, rows, maxRows, startY, endY, fill) {\n      const zoomLevel = +tile.tileId.split('.')[0];\n\n      this.initialize();\n\n      const focusRegion = this.options.focusRegion || [Infinity, Infinity];\n\n      const circleDraws = [];\n      const circleFocusDraws = [];\n\n      for (let j = 0; j < rows.length; j++) {\n        for (let i = 0; i < rows[j].length; i++) {\n          const td = rows[j][i].value;\n          const geneInfo = td.fields;\n\n          // the returned positions are chromosome-based and they need to\n          // be converted to genome-based\n          const chrOffset = +td.chrOffset;\n          const txStart = +geneInfo[1] + chrOffset;\n          const txEnd = +geneInfo[2] + chrOffset;\n\n          const xStartPos = this._xScale(txStart);\n          const xEndPos = this._xScale(txEnd);\n\n          // don't draw anything that has already been drawn\n          if (\n            !(\n              zoomLevel in this.drawnRects &&\n              td.uid in this.drawnRects[zoomLevel]\n            )\n          ) {\n            if (!this.drawnRects[zoomLevel]) this.drawnRects[zoomLevel] = {};\n\n            const circleDraw = {\n              xStartScreen: xStartPos,\n              xEndScreen: xEndPos,\n              xStartAbs: txStart,\n              xEndAbs: txEnd,\n              data: td,\n            };\n\n            if (txStart <= focusRegion[1] && txEnd >= focusRegion[0]) {\n              circleFocusDraws.push(circleDraw);\n            } else {\n              circleDraws.push(circleDraw);\n            }\n          }\n        }\n\n        circleDraws.forEach((circleDraw) => {\n          this.publish('annotationDrawn', circleDraw);\n        });\n      }\n    }\n\n    rerender() {\n      // Monkey patch because TiledPixiTrack doesn't always fire correctly\n      this.draw();\n      this.publish('tilesDrawn', { uuid: this.uuid });\n    }\n\n    updateExistingGraphics() {\n      super.updateExistingGraphics();\n      this.publish('tilesDrawn', { uuid: this.uuid });\n    }\n\n    getMouseOverHtml() {\n      return '';\n    }\n  }\n\n  return new TssTrack(...args);\n}\n\ncreateTssTrack.config = {\n  type: 'tss',\n  datatype: ['bedlike'],\n};\n\nexport default createTssTrack;\n","import { globalPubSub } from 'pub-sub-es';\n\n// Timeout requests after 10 seconds\nconst T_TIMEOUT = 10000;\n\nconst LocalCsvDataFetcher = function LocalCsvDataFetcher(HGC, ...args) {\n  if (!new.target) {\n    throw new Error(\n      'Uncaught TypeError: Class constructor cannot be invoked without \"new\"'\n    );\n  }\n\n  const createRandomId = () => Math.random().toString(36).substring(2);\n\n  class LocalBedDataFetcherClass {\n    constructor(dataConfig) {\n      this.dataConfig = dataConfig;\n    }\n\n    tilesetInfo(callback) {\n      this.tilesetInfoLoading = true;\n\n      if (!this.tilesetInfoData) {\n        this.tilesetInfoData = new Promise((resolve, reject) => {\n          const requestId = createRandomId();\n          const timeoutId = setTimeout(\n            () =>\n              reject(\n                new Error(\n                  `Could not load tileset info for ${this.dataConfig.id}`\n                )\n              ),\n            T_TIMEOUT\n          );\n          globalPubSub.subscribe(\n            `localBed:tilesetInfo:${requestId}`,\n            (tilesetInfo) => {\n              clearTimeout(timeoutId);\n              this.tilesetInfoLoading = false;\n              resolve(tilesetInfo);\n            },\n            1\n          );\n          globalPubSub.publish('localBed:requestTilesetInfo', {\n            fileId: this.dataConfig.id,\n            requestId,\n          });\n        });\n      }\n\n      this.tilesetInfoData.then((tilesetInfoData) => {\n        callback(tilesetInfoData);\n      });\n    }\n\n    /** We expect there to be a tilesetUid in the provided tilesetInfo\n     * and tiles data since tileResponseToData needs it\n     *\n     * It is also easier for users to paste in request responses for debugging.\n     */\n    fetchTilesDebounced(loadHandler, tileIds) {\n      Promise.all(tileIds.map((tileId) => this.tile(tileId.split('.')))).then(\n        (tiles) => {\n          loadHandler(\n            tiles.reduce((response, tile, i) => {\n              response[tileIds[i]] = tile;\n              return response;\n            }, {})\n          );\n        }\n      );\n    }\n\n    tile([z, x]) {\n      return new Promise((resolve, reject) => {\n        const requestId = createRandomId();\n        const timeoutId = setTimeout(\n          () =>\n            reject(\n              new Error(\n                `Could not load tile ${z}.${x} for ${this.dataConfig.id} (request: ${requestId})`\n              )\n            ),\n          T_TIMEOUT\n        );\n        globalPubSub.subscribe(\n          `localBed:tile:${requestId}`,\n          (tile) => {\n            clearTimeout(timeoutId);\n            resolve(tile);\n          },\n          1\n        );\n        globalPubSub.publish('localBed:requestTile', {\n          fileId: this.dataConfig.id,\n          z: +z,\n          x: +x,\n          requestId,\n        });\n      });\n    }\n  }\n\n  return new LocalBedDataFetcherClass(...args);\n};\n\nLocalCsvDataFetcher.config = {\n  type: 'localBed',\n};\n\nexport default LocalCsvDataFetcher;\n","import register from 'higlass-register';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'higlass-arcs';\n\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nimport createAnnotationOverlayMetaTrack from './annotation-overlay-meta-track';\nimport createRidgePlotTrack from './ridge-plot-track';\nimport createStratifiedBedTrack from './stratified-bed-track';\nimport createSnpTrack from './snp-track';\nimport createStackedBarTrack from './stacked-bar-track';\nimport createTssTrack from './tss-track';\n\nimport createLocalBedDataFetcher from './local-bed-data-fetcher';\n\nimport './index.css';\n\nregister(\n  {\n    dataFetcher: createLocalBedDataFetcher,\n    config: createLocalBedDataFetcher.config,\n  },\n  { pluginType: 'dataFetcher' }\n);\n\nregister({\n  track: createRidgePlotTrack,\n  config: createRidgePlotTrack.config,\n});\n\nregister({\n  track: createStratifiedBedTrack,\n  config: createStratifiedBedTrack.config,\n});\n\nregister({\n  track: createSnpTrack,\n  config: createSnpTrack.config,\n});\n\nregister({\n  track: createStackedBarTrack,\n  config: createStackedBarTrack.config,\n});\n\nregister({\n  track: createTssTrack,\n  config: createTssTrack.config,\n});\n\nregister({\n  track: createAnnotationOverlayMetaTrack,\n  config: createAnnotationOverlayMetaTrack.config,\n  isMetaTrack: true,\n});\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}