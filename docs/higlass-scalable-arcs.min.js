!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["higlass-scalable-arcs"]=e():t["higlass-scalable-arcs"]=e()}(window,(function(){return function(t){var e={};function i(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(o,n,function(e){return t[e]}.bind(null,n));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e),window.higlassTracks=window.higlassTracks||{},window.higlassTracksByType=window.higlassTracksByType||{};var o=t=>{window.higlassTracks[t.name]=t,window.higlassTracksByType[t.config.type]=t},n=function(t,e,i,o,n){for(var r=i-e,a=Math.sign(r),s=Math.abs(r),c=2*n,l=Math.ceil(s/c),u=0;u<l;u++)t.moveTo(e+u*c*a,o),t.lineTo(e+(u*c+n)*a,o)};function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e,i){return(a=S()?Reflect.construct:function(t,e,i){var o=[null];o.push.apply(o,e);var n=new(Function.bind.apply(t,o));return i&&v(n,i.prototype),n}).apply(null,arguments)}function s(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=u(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var o=0,n=function(){};return{s:n,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,r=t},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw r}}}}function c(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||u(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],o=!0,n=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(i.push(a.value),!e||i.length!==e);o=!0);}catch(t){n=!0,r=t}finally{try{o||null==s.return||s.return()}finally{if(n)throw r}}return i}(t,e)||u(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){if(t){if("string"==typeof t)return h(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function p(t,e,i){return e&&d(t.prototype,e),i&&d(t,i),t}function y(t,e,i){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=k(t)););return t}(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(i):n.value}})(t,e,i||t)}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function g(t){var e=S();return function(){var i,o=k(t);if(e){var n=k(this).constructor;i=Reflect.construct(o,arguments,n)}else i=o.apply(this,arguments);return b(this,i)}}function b(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function S(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var x="\n  precision mediump float;\n  attribute vec2 aPosition;\n  attribute float aOpacity;\n  attribute float aFocused;\n\n  uniform mat3 projectionMatrix;\n  uniform mat3 translationMatrix;\n  uniform float uPointSize;\n  uniform vec4 uColor;\n  uniform vec4 uColorFocused;\n\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vOpacity;\n  varying float vFocused;\n\n  void main(void)\n  {\n    vColor = uColor;\n    vColorFocused = uColorFocused;\n    vOpacity = aOpacity;\n    vFocused = aFocused;\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aPosition, 1.0)).xy, 0.0, 1.0);\n    gl_PointSize = uPointSize;\n  }\n",w="\n  #ifdef GL_OES_standard_derivatives\n  #extension GL_OES_standard_derivatives : enable\n  #endif\n\n  precision mediump float;\n\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vOpacity;\n  varying float vFocused;\n\n  void main() {\n    float r = 0.0, delta = 0.0, alpha = 1.0;\n    vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n    r = dot(cxy, cxy);\n\n    #ifdef GL_OES_standard_derivatives\n      delta = fwidth(r);\n      alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n    #endif\n\n    gl_FragColor = vec4(vColor.rgb, alpha * vColor.a);\n  }\n",C="\n  precision mediump float;\n  varying vec4 vColor;\n  varying vec4 vColorFocused;\n  varying float vOpacity;\n  varying float vFocused;\n\n  void main() {\n    float isNotFocused = 1.0 - vFocused;\n\n    float r = vColor.r * isNotFocused + vColorFocused.r * vFocused;\n    float g = vColor.g * isNotFocused + vColorFocused.g * vFocused;\n    float b = vColor.b * isNotFocused + vColorFocused.b * vFocused;\n\n    gl_FragColor = vec4(r, g, b, 1.0) * vOpacity;\n  }\n",T=["#c76526","#dca237","#eee462","#469b76","#3170ad","#6fb2e4","#000000","#999999"],M=["#a65420","#b7872e","#9f9841","#3a8162","#295d90","#4a7798","#000000","#666666"],O=["#f6e5db","#f9f0de","#fcfbe5","#e0eee8","#dde7f1","#e7f2fb","#d5d5d5","#ffffff"],A=function(t){return t.tileData.length&&void 0!==t.tileData[0].yStart},F=function(t){return t.xEnd-t.xStart},I=function(t){return Math.abs(t.xStart+(t.xEnd-t.xStart)/2-(t.yStart+(t.yEnd-t.yStart)/2))},P=function(t){return t.xStart},R=function(t){return t.xStart+(t.xEnd-t.xStart)/2},z=function(t){return t.xEnd},E=function(t){return t.yStart+(t.yEnd-t.yStart)/2},_=function(t){return Object.values(t).reduce((function(t,e){return Math.max(t,e.tileData.reduce((function(t,e){return Math.max(t,e.width)}),0))}),0)},j=function(t,e,i){var o=(i.domain()[1]-i.domain()[0])/(e.domain()[1]-e.domain()[0]),n=e.domain().map(i)[0];t.scale.x=o,t.position.x=-n*o},H=function(t){for(var e=t.libraries.PIXI,i=t.libraries.d3Scale,o=i.scaleLinear,r=i.scaleLog,u=r().domain([1,10]).range([.1,1]).clamp(!0),h=function(i){m(a,i);var r=g(a);function a(t,e){var i;return f(this,a),(i=r.call(this,t,e)).updateOptions(),i}return p(a,[{key:"initTile",value:function(t){var e=A(t),i=e?I:F,o=e?R:P,n=e?E:z;t.tileData.forEach((function(t){t.width=i(t),t.start=o(t),t.end=n(t),t.isLeftToRight=t.start<t.end}))}},{key:"updateTileWidthHistogram",value:function(t){var e=Math.max(this.dimensions[1]/this.pointSize),i=this.maxWidth/e,o=0;t.widthHistogramLeft=new Uint32Array(e),t.widthHistogramRight=new Uint32Array(e),t.tileData.forEach((function(e){var n=Math.round(e.width/i);e.histPos=e.isLeftToRight?t.widthHistogramRight[n]++:t.widthHistogramLeft[n]++,o=o>e.histPos?o:e.histPos})),t.widthHistogramMax=o}},{key:"updateWidthHistograms",value:function(){Object.values(this.fetchedTiles).forEach(this.updateTileWidthHistogram.bind(this))}},{key:"updateStratificationOption",value:function(){var i=this;if(!this.options.stratification)return this.categoryField=void 0,this.categoryToGroup=void 0,this.groupToColor=void 0,this.numGroups=0,this.numCategories=0,void(this.groupLabels=[]);this.categoryField=this.options.stratification.categoryField,this.categoryToGroup=new Map,this.categoryToY=new Map,this.groupToColor=new Map,this.numGroups=this.options.stratification.groups.length,this.groupSizes=this.options.stratification.groups.map((function(t){return t.categories.length})),this.numCategories=this.groupSizes.reduce((function(t,e){return t+e}),0),this.groupLabels=this.options.stratification.groups.map((function(t,e){return t.label||"Group ".concat(e)}));var o=0;this.options.stratification.groups.forEach((function(e,n){i.groupToColor.set(n,[t.utils.colorToHex(e.color||T[n%T.length]),t.utils.colorToHex(e.backgroundColor||O[n%T.length])]),e.categories.forEach((function(t,e){i.categoryToGroup.set(t.toLowerCase(),n),i.categoryToY.set(t.toLowerCase(),o+e)})),o+=e.categories.length})),this.groupLabelsPixiText=this.groupLabels.map((function(o,n){return new e.Text(o,{fontSize:i.labelSize,align:"right"===i.axisAlign?"right":"left",fill:t.utils.colorToHex(i.options.stratification.groups[n].axisLabelColor||M[n%M.length])})}))}},{key:"updateOptions",value:function(){var e=this;this.axisAlign=this.options.axisAlign||"left",this.labelColor=t.utils.colorToHex(this.options.labelColor||"black"),this.labelSize=this.options.labelSize||12,this.markColor=t.utils.colorToHex(this.options.markColor||"black"),this.markColorRgbNorm=this.options.markColor?t.utils.colorToRgba(this.options.markColor).slice(0,3).map((function(t){return Math.min(1,Math.max(0,t/255))})):[0,0,0],this.markOpacity=Number.isNaN(+this.options.markOpacity)?1:Math.min(1,Math.max(0,+this.options.markOpacity)),this.markSize=this.options.markSize||2,this.markColorFocus=t.utils.colorToHex(this.options.markColorFocus||"red"),this.markColorFocusRgbNorm=this.options.markColorFocus?t.utils.colorToRgba(this.options.markColorFocus).slice(0,3).map((function(t){return Math.min(1,Math.max(0,t/255))})):[1,0,0],this.markOpacityFocus=Number.isNaN(+this.options.markOpacityFocus)?this.markOpacity:Math.min(1,Math.max(0,+this.options.markOpacityFocus)),this.markSizeFocus=this.options.markSizeFocus||this.markSize,this.strokeColor=this.markColor||t.utils.colorToHex(this.options.strokeColor||"black"),this.strokeWidth=this.options.strokeWidth||this.markSize,this.getImportance=this.options.importanceField?function(t){return+t.fields[e.options.importanceField]}:function(t){return t.width};var i=this.options.importanceDomain||[1e3,1],n=o().domain(i).range([1,10]);this.opacityScale=function(t){return u(n(t))},this.focusRegion=this.options.focusRegion?this.options.focusRegion:[1/0,1/0],this.focusGene=this.options.focusGene?this.options.focusGene.toLowerCase():void 0,this.getGene=this.options.geneField?function(t){return t.fields[e.options.geneField].toLowerCase()}:void 0,this.minImportance=this.options.minImportance||0,this.updateStratificationOption(),this.updateWidthHistograms()}},{key:"rerender",value:function(t){this.options=t,this.updateOptions(),this.updateExistingGraphics()}},{key:"updateScales",value:function(){var t=Object.values(this.fetchedTiles);if(t.length){t[0].tileData.yStart;var e=l(this.dimensions,2)[1],i=this.markSize/2;this.maxWidth=_(this.fetchedTiles),this.heightScale=o().domain([0,this.maxWidth]).range([Math.min(12,this.dimensions[1]/10),e]),this.fullHeightScale=o().domain([this.maxWidth,0]).range([Math.min(i,e/10),Math.max(e-i,9*e/10)]),this.fullHeightScaleInverted=o().domain([0,this.maxWidth]).range([Math.min(i,e/10),Math.max(e-i,9*e/10)]),this.incomingHeightScale=o().domain([0,this.maxWidth]).range([e/2,e]),this.outgoingHeightScale=o().domain([0,this.maxWidth]).range([e/2,0]),this.categoryHeightScale=o().domain([0,this.numCategories]).range([0,this.numCategories*this.markSize]),this.valueScale=o().domain([0,this.maxWidth]).range([e,0]),this.valueScaleInverted=o().domain([0,this.maxWidth]).range([0,e])}}},{key:"itemToIndicatorDiverging",value:function(t){return{startX:this._xScale(t.start),endX:this._xScale(t.end),startY:this.outgoingHeightScale(t.width),endY:this.incomingHeightScale(t.width),opacity:this.opacityScale(this.getImportance(t)),size:this.markSize}}},{key:"itemToIndicatorStart",value:function(t){return{x:this._xScale(t.start),y:this.fullHeightScale(t.width),opacity:this.opacityScale(this.getImportance(t)),size:this.markSize}}},{key:"itemToIndicatorEnd",value:function(t){return{x:this._xScale(t.end),y:this.fullHeightScaleInverted(t.width),opacity:this.opacityScale(this.getImportance(t)),size:this.markSize}}},{key:"itemToIndicatorCategory",value:function(t){return{cX:this._xScale(t.start),cY:this.categoryHeightScale(this.categoryToY.get(t.fields[this.categoryField].toLowerCase())),wHalf:Math.max(this.markSize/2,Math.abs(this._xScale(t.xStart)-this._xScale(t.xEnd))/2),opacity:this.opacityScale(this.getImportance(t)),focused:t.xStart<=this.focusRegion[1]&&t.xEnd>=this.focusRegion[0],size:this.markSize,sizeHalf:this.markSize/2}}},{key:"itemToIndicatorReducer",value:function(t){var e=this;return this.getGene&&this.focusGene?function(i,o){return e.getGene(o)===e.focusGene&&i.push(t(o)),i}:function(e,i){return e.push(t(i)),e}}},{key:"renderIndicatorPoints",value:function(t,i,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=a.vertexShader,l=void 0===s?x:s,u=a.fragmentShader,h=void 0===u?w:u,f=a.drawTriangles,d=void 0!==f&&f;this.drawnAtScale=o().domain(c(this.xScale().domain())).range(c(this.xScale().range()));var p=Object.values(this.fetchedTiles).flatMap((function(e){return e.tileData.reduce(t,[])})),y=new Float32Array(p.flatMap(i)),m=new Float32Array(p.flatMap(n)),v=new Float32Array(p.flatMap(r)),g=new e.UniformGroup({uPointSize:this.markSize,uColor:[].concat(c(this.markColorRgbNorm),[this.markOpacity]),uColorFocused:[].concat(c(this.markColorFocusRgbNorm),[this.markOpacity])}),b=e.Shader.from(l,h,g),S=new e.Geometry;S.addAttribute("aPosition",y,2),S.addAttribute("aOpacity",m,1),S.addAttribute("aFocused",v,1);var k=new e.Mesh(S,b,new e.State,d?e.DRAW_MODES.TRIANGLES:e.DRAW_MODES.POINTS),C=new e.Graphics;C.addChild(k),this.pMain.x=this.position[0],this.indicatorPointGraphics&&this.pMain.removeChild(this.indicatorPointGraphics),this.pMain.addChild(C),this.indicatorPointGraphics=C,j(this.indicatorPointGraphics,this._xScale,this.drawnAtScale),this.draw(),this.animate()}},{key:"renderIndicatorDistanceAxis",value:function(t){this.drawAxis(t)}},{key:"renderIndicatorCategoryAxis",value:function(){var t=this,e=l(this.dimensions,1)[0],i=l(this.position,2),o=i[0],r=i[1];this.pAxis.position.x="right"===this.axisAlign?o+e:o,this.pAxis.position.y=r,this.pAxis.clear();var a=0,s=0,c="right"===this.axisAlign?-5:5,u="right"===this.axisAlign?-e:e,h="right"===this.axisAlign?-3:3,f=this.pAxis.children.length;this.pAxis.lineStyle(1,0,1,0),this.groupLabelsPixiText.forEach((function(e,i){var o=t.categoryHeightScale(t.groupSizes[i]);s+=o,e.x=h,e.y=a+o/2,e.anchor.x="right"===t.axisAlign?1:0,e.anchor.y=.5,f<i+1&&t.pAxis.addChild(e),t.pAxis.moveTo(0,a),t.pAxis.lineTo(c,a),t.options.stratification.axisShowGroupSeparator&&n(t.pAxis,0,u,a,5),a=s})),this.pAxis.moveTo(0,0),this.pAxis.lineTo(0,s),this.pAxis.lineTo(c,s),this.options.stratification.axisShowGroupSeparator&&n(this.pAxis,0,u,s,5)}},{key:"updateIndicators",value:function(){var t=this.itemToIndicatorDiverging.bind(this),e=function(t){return[t.startX,t.startY,t.endX,t.endY]},i=function(t){return t.opacity},o=function(t){return t.focused},n=w,r=!1;"category"===this.options.indicatorStyle?(t=this.itemToIndicatorCategory.bind(this),e=function(t){return[t.cX,t.cY]},n=C,this.renderIndicatorCategoryAxis(this.valueScaleInverted)):"category-rect"===this.options.indicatorStyle?(t=this.itemToIndicatorCategory.bind(this),e=function(t){return[t.cX-t.wHalf,t.cY,t.cX+t.wHalf,t.cY,t.cX+t.wHalf,t.cY+t.size,t.cX+t.wHalf,t.cY+t.size,t.cX-t.wHalf,t.cY+t.size,t.cX-t.wHalf,t.cY]},i=function(t){return[t.opacity,t.opacity,t.opacity,t.opacity,t.opacity,t.opacity]},o=function(t){return[t.focused,t.focused,t.focused,t.focused,t.focused,t.focused]},n=C,r=!0,this.renderIndicatorCategoryAxis(this.valueScaleInverted)):"start-only"===this.options.indicatorStyle?(t=this.itemToIndicatorStart.bind(this),e=function(t){return[t.x,t.y]},this.renderIndicatorDistanceAxis(this.valueScale)):"end-only"===this.options.indicatorStyle&&(t=this.itemToIndicatorEnd.bind(this),e=function(t){return[t.x,t.y]},this.renderIndicatorDistanceAxis(this.valueScaleInverted)),t=this.itemToIndicatorReducer(t),this.renderIndicatorPoints(t,e,i,o,{fragmentShader:n,drawTriangles:r})}},{key:"updateExistingGraphics",value:function(){this.updateScales(),this.updateWidthHistograms(),"indicator"===this.options.arcStyle&&this.updateIndicators()}},{key:"drawTile",value:function(t,e){var i=this;if(t.graphics.clear(),t.tileData.length){if("indicator"===this.options.arcStyle){var o=l(this.dimensions,2),n=o[0],r=o[1];if(this.options.indicatorStyle.startsWith("category")){if(!this.options.stratification.axisNoGroupColor){var a=0,s=0;this.groupSizes.forEach((function(e,o){s+=i.categoryHeightScale(e),t.graphics.beginFill(i.groupToColor.get(o)[1]),t.graphics.drawRect(0,a,n,Math.abs(s-a)),a=s})),t.graphics.endFill()}}else{var c=Math.round(r/2)-.5;"start-only"===this.options.indicatorStyle?c=r-.5:"end-only"===this.options.indicatorStyle&&(c=.5),t.graphics.lineStyle(1,0,.2),t.graphics.moveTo(0,c),t.graphics.lineTo(n,c)}}for(var u=0;u<t.tileData.length;u++){var h=t.tileData[u];"circle"===this.options.arcStyle?this.drawCircle(t.graphics,h,e):"indicator"===this.options.arcStyle||this.drawEllipse(t.graphics,h,e)}}}},{key:"drawIndicator",value:function(t,e){var i=this._xScale(e.start),o=this._xScale(e.end),n=this.outgoingHeightScale(e.width),r=this.incomingHeightScale(e.width),a=this.opacityScale(this.getImportance(e));t.lineStyle(0,0,0),t.beginFill(4033753,a),t.drawCircle(i,n,this.pointSize),t.endFill(),t.beginFill(12680613,a),t.drawCircle(o,r,this.pointSize),t.endFill(),e.start<=this.focusRegion[1]&&e.end>=this.focusRegion[0]&&(e.start>=this.focusRegion[0]||e.end<=this.focusRegion[1])&&(t.lineStyle(this.pointSize,12680613,a),t.moveTo(i,r),t.lineTo(o,r),t.endFill())}},{key:"drawCircle",value:function(t,e,i,n){var r=this._xScale(e.start),a=this._xScale(e.end),s=l(this.dimensions,2),c=s[0],u=s[1],h=l(this.position,2)[1],f=(a-r)/2,d=(a-r)/2,p=(d*d+f*f)/(2*f),y=(r+a)/2,m=u-f+p,v="";n&&(v+="M".concat(r,",").concat(h+u)),t.moveTo(r,h+u);var g=Math.max(0,r),b=Math.min(c,a),S=this.markColor,k=this.markSize,x=this.markOpacity;e.start<=this.focusRegion[1]&&e.end>=this.focusRegion[0]&&(e.start>=this.focusRegion[0]||e.end<=this.focusRegion[1])&&(S=this.markColorFocus,k=this.markSizeFocus,x=this.markOpacityFocus),t.lineStyle(k,S,x);var w=Math.acos(Math.min(Math.max(-(g-y)/p,-1),1)),C=Math.acos(Math.min(Math.max(-(b-y)/p,-1),1));this.options.flip&&(m=0,C=-Math.PI,t.moveTo(r,0),n&&(v+="M".concat(r,",0")));for(var T=o().domain([0,9]).range([w,C]),M=0;M<10;M++){var O=y-p*Math.cos(T(M)),A=m-p*Math.sin(T(M));t.lineTo(O,A),n&&(v+="L".concat(O,",").concat(A))}n&&this.polys.push({polyStr:v,opacity:x})}},{key:"drawEllipse",value:function(t,e,i,n,r){var a=this._xScale(e.start),s=this._xScale(e.end),c=l(this.dimensions,2)[1],u=this.heightScale(e.width),h=s-a,f=h/2,d=(a+s)/2,p=c,y=Math.PI,m="";r&&(m+="M".concat(a,",").concat(c)),t.moveTo(a,c),this.options.flip&&(p=0,y=-Math.PI,t.moveTo(a,0),r&&(m+="M".concat(a,",0")));var v=this.markColor,g=this.markSize,b=this.markOpacity;e.start<=this.focusRegion[1]&&e.end>=this.focusRegion[0]&&(e.start>=this.focusRegion[0]||e.end<=this.focusRegion[1])&&(v=this.markColorFocus,g=this.markSizeFocus,b=this.markOpacityFocus),t.lineStyle(g,v,b);for(var S=10*Math.round(Math.abs(h)/200),k=o().domain([0,S-1]).range([0,y]),x=0;x<S;x++){var w=d-f*Math.cos(k(x)),C=p-u*Math.sin(k(x));t.lineTo(w,C),r&&(m+="L".concat(w,",").concat(C))}r&&this.polys.push({polyStr:m,opacity:b})}},{key:"getMouseOverHtml",value:function(){}},{key:"setPosition",value:function(t){y(k(a.prototype),"setPosition",this).call(this,t);var e=l(this.position,2);this.pMain.position.x=e[0],this.pMain.position.y=e[1]}},{key:"zoomed",value:function(t,e){this.xScale(t),this.yScale(e),this.indicatorPointGraphics&&j(this.indicatorPointGraphics,t,this.drawnAtScale),this.refreshTiles(),this.draw()}},{key:"exportSVG",value:function(){var t=this,e=null,i=null,o=l(y(k(a.prototype),"superSVG",this).call(this),2);i=o[0],e=o[1],i.setAttribute("class","exported-arcs-track");var n=document.createElement("g");e.appendChild(n),n.setAttribute("transform","translate(".concat(this.position[0],",").concat(this.position[1],")"));var r=this.options.strokeColor?this.options.strokeColor:"blue",c=this.options.strokeWidth?this.options.strokeWidth:2;return this.visibleAndFetchedTiles().forEach((function(e){t.polys=[],t.drawTile(e,!0);var i,o=s(t.polys);try{for(o.s();!(i=o.n()).done;){var a=i.value,l=a.polyStr,u=a.opacity,h=document.createElement("path");h.setAttribute("fill","transparent"),h.setAttribute("stroke",r),h.setAttribute("stroke-width",c),h.setAttribute("opacity",u),h.setAttribute("d",l),n.appendChild(h)}}catch(t){o.e(t)}finally{o.f()}})),[i,e]}}]),a}(t.tracks.HorizontalLine1DPixiTrack),d=arguments.length,v=new Array(d>1?d-1:0),b=1;b<d;b++)v[b-1]=arguments[b];return a(h,v)};H.config={type:"1d-arcs",datatype:["arcs","bedlike"],orientation:"1d",name:"Arcs1D",thumbnail:(new DOMParser).parseFromString('<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5"><path d="M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268" fill="none" stroke="currentColor"/><path d="M10.5 3.5v12" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-dasharray="1,2,0,0"/><path d="M5.5 13.5V6" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-width=".9969299999999999" stroke-dasharray="1.71,3.43,0,0"/><path d="M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z" fill="currentColor"/><path d="M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z" fill="currentColor"/></svg>',"text/xml").documentElement,availableOptions:["arcStyle","flip1D","labelPosition","labelColor","labelTextOpacity","labelBackgroundOpacity","strokeColor","strokeWidth","trackBorderWidth","trackBorderColor"],defaultOptions:{arcStyle:"ellipse",flip1D:"no",labelColor:"black",labelPosition:"hidden",strokeColor:"black",strokeWidth:1,trackBorderWidth:0,trackBorderColor:"black"},optionsInfo:{arcStyle:{name:"Arc Style",inlineOptions:{circle:{name:"Circle",value:"circle"},ellipse:{name:"Ellipse",value:"ellipse"}}}}};var G=H;function D(t){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function L(t,e,i){return(L=Z()?Reflect.construct:function(t,e,i){var o=[null];o.push.apply(o,e);var n=new(Function.bind.apply(t,o));return i&&J(n,i.prototype),n}).apply(null,arguments)}function W(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=B(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var o=0,n=function(){};return{s:n,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,r=t},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw r}}}}function N(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],o=!0,n=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(i.push(a.value),!e||i.length!==e);o=!0);}catch(t){n=!0,r=t}finally{try{o||null==s.return||s.return()}finally{if(n)throw r}}return i}(t,e)||B(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(t,e){if(t){if("string"==typeof t)return V(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?V(t,e):void 0}}function V(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}function Y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function X(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function U(t,e,i){return e&&X(t.prototype,e),i&&X(t,i),t}function $(t,e,i){return($="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=tt(t)););return t}(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(i):n.value}})(t,e,i||t)}function q(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&J(t,e)}function J(t,e){return(J=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function K(t){var e=Z();return function(){var i,o=tt(t);if(e){var n=tt(this).constructor;i=Reflect.construct(o,arguments,n)}else i=o.apply(this,arguments);return Q(this,i)}}function Q(t,e){return!e||"object"!==D(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Z(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function tt(t){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var et=function(t){for(var e=function(t){q(i,t);var e=K(i);function i(){return Y(this,i),e.apply(this,arguments)}return U(i,[{key:"setValueScale",value:function(){if(this.valueScale=null,this.options&&this.options.valueColumn){var t=this.options.colorEncodingRange?+this.options.colorEncodingRange[0]:this.minVisibleValueInTiles(+this.options.valueColumn),e=this.options.colorEncodingRange?+this.options.colorEncodingRange[1]:this.maxVisibleValueInTiles(+this.options.valueColumn);if(this.options.valueColumn){var i=N(this.makeValueScale(t,this.calculateMedianVisibleValue(+this.options.valueColumn),e,2),1);this.valueScale=i[0]}}}},{key:"drawPoly",value:function(t,e,i,o){var n=[e,o,i,o,i,this.dimensions[1],e,this.dimensions[1]],r=Math.max(2,i-e);return t.rectGraphics.drawCircle(e,Math.max(r,Math.min(this.dimensions[1]-r,o)),r),n}},{key:"exportSVG",value:function(){var t=this,e=null,o=null,n=N($(tt(i.prototype),"superSVG",this).call(this),2);o=n[0],e=n[1],o.setAttribute("class","exported-arcs-track");var r=document.createElement("g");e.appendChild(r),r.setAttribute("transform","translate(".concat(this.position[0],",").concat(this.position[1],")"));var a=this.options.strokeColor?this.options.strokeColor:"blue",s=this.options.strokeWidth?this.options.strokeWidth:2;return this.visibleAndFetchedTiles().forEach((function(e){t.polys=[],t.drawTile(e,!0);var i,o=W(t.polys);try{for(o.s();!(i=o.n()).done;){var n=i.value,c=n.polyStr,l=n.opacity,u=document.createElement("path");u.setAttribute("fill","transparent"),u.setAttribute("stroke",a),u.setAttribute("stroke-width",s),u.setAttribute("opacity",l),u.setAttribute("d",c),r.appendChild(u)}}catch(t){o.e(t)}finally{o.f()}})),[o,e]}}]),i}(t.tracks.BedLikeTrack),i=arguments.length,o=new Array(i>1?i-1:0),n=1;n<i;n++)o[n-1]=arguments[n];return L(e,o)};et.config={type:"point-annotation",datatype:["arcs","bedlike"],orientation:"1d",name:"Arcs1D",thumbnail:(new DOMParser).parseFromString('<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5"><path d="M4 2.1L.5 3.5v12l5-2 5 2 5-2v-12l-5 2-3.17-1.268" fill="none" stroke="currentColor"/><path d="M10.5 3.5v12" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-dasharray="1,2,0,0"/><path d="M5.5 13.5V6" fill="none" stroke="currentColor" stroke-opacity=".33" stroke-width=".9969299999999999" stroke-dasharray="1.71,3.43,0,0"/><path d="M9.03 5l.053.003.054.006.054.008.054.012.052.015.052.017.05.02.05.024 4 2 .048.026.048.03.046.03.044.034.042.037.04.04.037.04.036.042.032.045.03.047.028.048.025.05.022.05.02.053.016.053.014.055.01.055.007.055.005.055v.056l-.002.056-.005.055-.008.055-.01.055-.015.054-.017.054-.02.052-.023.05-.026.05-.028.048-.03.046-.035.044-.035.043-.038.04-4 4-.04.037-.04.036-.044.032-.045.03-.046.03-.048.024-.05.023-.05.02-.052.016-.052.015-.053.012-.054.01-.054.005-.055.003H8.97l-.053-.003-.054-.006-.054-.008-.054-.012-.052-.015-.052-.017-.05-.02-.05-.024-4-2-.048-.026-.048-.03-.046-.03-.044-.034-.042-.037-.04-.04-.037-.04-.036-.042-.032-.045-.03-.047-.028-.048-.025-.05-.022-.05-.02-.053-.016-.053-.014-.055-.01-.055-.007-.055L4 10.05v-.056l.002-.056.005-.055.008-.055.01-.055.015-.054.017-.054.02-.052.023-.05.026-.05.028-.048.03-.046.035-.044.035-.043.038-.04 4-4 .04-.037.04-.036.044-.032.045-.03.046-.03.048-.024.05-.023.05-.02.052-.016.052-.015.053-.012.054-.01.054-.005L8.976 5h.054zM5 10l4 2 4-4-4-2-4 4z" fill="currentColor"/><path d="M7.124 0C7.884 0 8.5.616 8.5 1.376v3.748c0 .76-.616 1.376-1.376 1.376H3.876c-.76 0-1.376-.616-1.376-1.376V1.376C2.5.616 3.116 0 3.876 0h3.248zm.56 5.295L5.965 1H5.05L3.375 5.295h.92l.354-.976h1.716l.375.975h.945zm-1.596-1.7l-.592-1.593-.58 1.594h1.172z" fill="currentColor"/></svg>',"text/xml").documentElement,availableOptions:["arcStyle","flip1D","labelPosition","labelColor","labelTextOpacity","labelBackgroundOpacity","strokeColor","strokeWidth","trackBorderWidth","trackBorderColor"],defaultOptions:{arcStyle:"ellipse",flip1D:"no",labelColor:"black",labelPosition:"hidden",strokeColor:"black",strokeWidth:1,trackBorderWidth:0,trackBorderColor:"black"},optionsInfo:{arcStyle:{name:"Arc Style",inlineOptions:{circle:{name:"Circle",value:"circle"},ellipse:{name:"Ellipse",value:"ellipse"}}}}};var it=et;o({name:"ScalableArcs1dTrack",track:G,config:G.config}),o({name:"SnpTrack",track:it,config:it.config})}])}));